import{d as rv,e as EP,a as U,t as J,c as Ee,b as vs}from"./disclose-version.DE3B7_8X.js";import{U as c2,ae as h2,a7 as PP,k as Dn,H as bu,C as u2,B as RP,G as gm,h as d2,a4 as p2,af as QP,ag as nv,Z as U0,l as ao,a1 as FP,ax as _u,ah as m2,i as X1,ai as $P,V as DP,D as iv,ay as V1,az as sv,aA as q1,aB as NP,O as MP,aC as IP,j as g2,aD as O2,R as LP,aE as BP,K as ZP,a9 as av,aF as WP,Y as x2,a2 as UP,a0 as XP,aG as VP,aH as qP,aI as jP,aJ as zP,b as v2,ak as y2,aj as w2,p as gt,y as ne,w as Q,x as R,aK as Kt,q as Ot,g as C,z as H,N as Se,o as be,v as Me,f as kl,n as dc,a as j1,aL as GP}from"./runtime.CfgX6eQG.js";import{b as HP,l as z1,d as vr,s as Ge,e as YP,r as l0}from"./render.DWIGZODM.js";import{d as KP,p as ge,i as ce,a as Y,c as JP,s as ov,b as b2,e as e3,f as t3}from"./props.CQel5Sq1.js";import{o as Ut,a as Ua}from"./index-client.BCAZJJkF.js";import{s as pc}from"./snippet.Dt_8T1af.js";import{w as ss}from"./index.CX0t67y6.js";import"./legacy.CNaPTmXt.js";const r3=[];function gr(r,e=!1){return ku(r,new Map,"",r3)}function ku(r,e,t,n,i=null){if(typeof r=="object"&&r!==null){var s=e.get(r);if(s!==void 0)return s;if(r instanceof Map)return new Map(r);if(r instanceof Set)return new Set(r);if(c2(r)){var a=Array(r.length);e.set(r,a),i!==null&&e.set(i,a);for(var o=0;o<r.length;o+=1){var l=r[o];o in r&&(a[o]=ku(l,e,t,n))}return a}if(h2(r)===PP){a={},e.set(r,a),i!==null&&e.set(i,a);for(var f in r)a[f]=ku(r[f],e,t,n);return a}if(r instanceof Date)return structuredClone(r);if(typeof r.toJSON=="function")return ku(r.toJSON(),e,t,n,r)}if(r instanceof EventTarget)return r;try{return structuredClone(r)}catch{return r}}function Qr(r,e){return e}function n3(r,e,t,n){for(var i=[],s=e.length,a=0;a<s;a++)NP(e[a].e,i,!0);var o=s>0&&i.length===0&&t!==null;if(o){var l=t.parentNode;MP(l),l.append(t),n.clear(),pa(r,e[0].prev,e[s-1].next)}IP(i,()=>{for(var f=0;f<s;f++){var c=e[f];o||(n.delete(c.k),pa(r,c.prev,c.next)),g2(c.e,!o)}})}function _r(r,e,t,n,i,s=null){var a=r,o={flags:e,items:new Map,first:null},l=(e&O2)!==0;if(l){var f=r;a=Dn?bu(u2(f)):f.appendChild(RP())}Dn&&gm();var c=null,h=!1;d2(()=>{var u=t(),d=c2(u)?u:u==null?[]:p2(u),p=d.length;if(h&&p===0)return;h=p===0;let m=!1;if(Dn){var g=a.data===QP;g!==(p===0)&&(a=nv(),bu(a),U0(!1),m=!0)}if(Dn){for(var O=null,w,v=0;v<p;v++){if(ao.nodeType===8&&ao.data===FP){a=ao,m=!0,U0(!1);break}var S=d[v],y=n(S,v);w=_2(ao,o,O,null,S,y,v,i,e),o.items.set(y,w),O=w}p>0&&bu(nv())}if(!Dn){var b=LP;i3(d,o,a,i,e,(b.f&_u)!==0,n)}s!==null&&(p===0?c?m2(c):c=X1(()=>s(a)):c!==null&&$P(c,()=>{c=null})),m&&U0(!0),t()}),Dn&&(a=ao)}function i3(r,e,t,n,i,s,a,o){var z,ee,ae,xe;var l=(i&BP)!==0,f=(i&(V1|q1))!==0,c=r.length,h=e.items,u=e.first,d=u,p,m=null,g,O=[],w=[],v,S,y,b;if(l)for(b=0;b<c;b+=1)v=r[b],S=a(v,b),y=h.get(S),y!==void 0&&((z=y.a)==null||z.measure(),(g??(g=new Set)).add(y));for(b=0;b<c;b+=1){if(v=r[b],S=a(v,b),y=h.get(S),y===void 0){var x=d?d.e.nodes_start:t;m=_2(x,e,m,m===null?e.first:m.next,v,S,b,n,i),h.set(S,m),O=[],w=[],d=m.next;continue}if(f&&s3(y,v,b,i),y.e.f&_u&&(m2(y.e),l&&((ee=y.a)==null||ee.unfix(),(g??(g=new Set)).delete(y))),y!==d){if(p!==void 0&&p.has(y)){if(O.length<w.length){var A=w[0],k;m=A.prev;var E=O[0],T=O[O.length-1];for(k=0;k<O.length;k+=1)lv(O[k],A,t);for(k=0;k<w.length;k+=1)p.delete(w[k]);pa(e,E.prev,T.next),pa(e,m,E),pa(e,T,A),d=A,m=T,b-=1,O=[],w=[]}else p.delete(y),lv(y,d,t),pa(e,y.prev,y.next),pa(e,y,m===null?e.first:m.next),pa(e,m,y),m=y;continue}for(O=[],w=[];d!==null&&d.k!==S;)(s||!(d.e.f&_u))&&(p??(p=new Set)).add(d),w.push(d),d=d.next;if(d===null)continue;y=d}O.push(y),m=y,d=y.next}if(d!==null||p!==void 0){for(var _=p===void 0?[]:p2(p);d!==null;)(s||!(d.e.f&_u))&&_.push(d),d=d.next;var N=_.length;if(N>0){var Z=i&O2&&c===0?t:null;if(l){for(b=0;b<N;b+=1)(ae=_[b].a)==null||ae.measure();for(b=0;b<N;b+=1)(xe=_[b].a)==null||xe.fix()}n3(e,_,Z,h)}}l&&DP(()=>{var V;if(g!==void 0)for(y of g)(V=y.a)==null||V.apply()}),iv.first=e.first&&e.first.e,iv.last=m&&m.e}function s3(r,e,t,n){n&V1&&sv(r.v,e),n&q1?sv(r.i,t):r.i=t}function _2(r,e,t,n,i,s,a,o,l,f){var c=(l&V1)!==0,h=(l&WP)===0,u=c?h?ZP(i):av(i):i,d=l&q1?av(a):a,p={i:d,v:u,k:s,a:null,e:null,prev:t,next:n};try{return p.e=X1(()=>o(r,u,d),Dn),p.e.prev=t&&t.e,p.e.next=n&&n.e,t===null?e.first=p:(t.next=p,t.e.next=p.e),n!==null&&(n.prev=p,n.e.prev=p.e),p}finally{}}function lv(r,e,t){for(var n=r.next?r.next.e.nodes_start:t,i=e?e.e.nodes_start:t,s=r.e.nodes_start;s!==n;){var a=x2(s);i.before(s),s=a}}function pa(r,e,t){e===null?r.first=t:(e.next=t,e.e.next=t&&t.e),t!==null&&(t.prev=e,t.e.prev=e&&e.e)}function a3(r,e,t,n,i){var s=r,a="",o;d2(()=>{if(a===(a=e()??"")){Dn&&gm();return}o!==void 0&&(g2(o),o=void 0),a!==""&&(o=X1(()=>{if(Dn){ao.data;for(var l=gm(),f=l;l!==null&&(l.nodeType!==8||l.data!=="");)f=l,l=x2(l);if(l===null)throw UP(),XP;rv(ao,f),s=bu(l);return}var c=a+"",h=EP(c);rv(u2(h),h.lastChild),s.before(h)}))})}function k2(r){var e,t,n="";if(typeof r=="string"||typeof r=="number")n+=r;else if(typeof r=="object")if(Array.isArray(r)){var i=r.length;for(e=0;e<i;e++)r[e]&&(t=k2(r[e]))&&(n&&(n+=" "),n+=t)}else for(t in r)r[t]&&(n&&(n+=" "),n+=t);return n}function o3(){for(var r,e,t=0,n="",i=arguments.length;t<i;t++)(r=arguments[t])&&(e=k2(r))&&(n&&(n+=" "),n+=e);return n}function Qi(r){return typeof r=="object"?o3(r):r??""}function wt(r){if(Dn){var e=!1,t=()=>{if(!e){if(e=!0,r.hasAttribute("value")){var n=r.value;Ea(r,"value",null),r.value=n}if(r.hasAttribute("checked")){var i=r.checked;Ea(r,"checked",null),r.checked=i}}};r.__on_r=t,jP(t),HP()}}function Jo(r,e){var t=r.__attributes??(r.__attributes={});t.checked!==(t.checked=e??void 0)&&(r.checked=e)}function l3(r,e){e?r.hasAttribute("selected")||r.setAttribute("selected",""):r.removeAttribute("selected")}function Ea(r,e,t,n){var i=r.__attributes??(r.__attributes={});Dn&&(i[e]=r.getAttribute(e),e==="src"||e==="srcset"||e==="href"&&r.nodeName==="LINK")||i[e]!==(i[e]=t)&&(e==="style"&&"__styles"in r&&(r.__styles={}),e==="loading"&&(r[VP]=t),t==null?r.removeAttribute(e):typeof t!="string"&&f3(r).includes(e)?r[e]=t:r.setAttribute(e,t))}var fv=new Map;function f3(r){var e=fv.get(r.nodeName);if(e)return e;fv.set(r.nodeName,e=[]);for(var t,n=r,i=Element.prototype;i!==n;){t=qP(n);for(var s in t)t[s].set&&e.push(s);n=h2(n)}return e}function ht(r,e,t){var n=r.__className,i=c3(e,t);Dn&&r.className===i?r.__className=i:(n!==i||Dn&&r.className!==i)&&(e==null&&!t?r.removeAttribute("class"):r.className=i,r.__className=i)}function c3(r,e){return(r??"")+(e?" "+e:"")}function S2(r,e,t){if(t){if(r.classList.contains(e))return;r.classList.add(e)}else{if(!r.classList.contains(e))return;r.classList.remove(e)}}function Jt(r,e,t=e){var n=zP();z1(r,"input",i=>{var s=i?r.defaultValue:r.value;if(s=X0(r)?V0(s):s,t(s),n&&s!==(s=e())){var a=r.selectionStart,o=r.selectionEnd;r.value=s??"",o!==null&&(r.selectionStart=a,r.selectionEnd=Math.min(o,r.value.length))}}),(Dn&&r.defaultValue!==r.value||v2(e)==null&&r.value)&&t(X0(r)?V0(r.value):r.value),y2(()=>{var i=e();X0(r)&&i===V0(r.value)||r.type==="date"&&!i&&!r.value||i!==r.value&&(r.value=i??"")})}function oo(r,e,t=e){z1(r,"change",n=>{var i=n?r.defaultChecked:r.checked;t(i)}),(Dn&&r.defaultChecked!==r.checked||v2(e)==null)&&t(r.checked),y2(()=>{var n=e();r.checked=!!n})}function X0(r){var e=r.type;return e==="number"||e==="range"}function V0(r){return r===""?null:+r}function T2(r,e,t){if(r.multiple)return u3(r,e);for(var n of r.options){var i=Gf(n);if(KP(i,e)){n.selected=!0;return}}(!t||e!==void 0)&&(r.selectedIndex=-1)}function h3(r,e){w2(()=>{var t=new MutationObserver(()=>{var n=r.__value;T2(r,n)});return t.observe(r,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{t.disconnect()}})}function Sl(r,e,t=e){var n=!0;z1(r,"change",i=>{var s=i?"[selected]":":checked",a;if(r.multiple)a=[].map.call(r.querySelectorAll(s),Gf);else{var o=r.querySelector(s)??r.querySelector("option:not([disabled])");a=o&&Gf(o)}t(a)}),w2(()=>{var i=e();if(T2(r,i,n),n&&i===void 0){var s=r.querySelector(":checked");s!==null&&(i=Gf(s),t(i))}r.__value=i,n=!1}),h3(r)}function u3(r,e){for(var t of r.options)t.selected=~e.indexOf(Gf(t))}function Gf(r){return"__value"in r?r.__value:r.value}var cv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function d3(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var Ph={exports:{}},hv;function p3(){return hv||(hv=1,function(r,e){var t=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof cv<"u")return cv;throw new Error("unable to locate global object")},n=t();r.exports=e=n.fetch,n.fetch&&(e.default=n.fetch.bind(n)),e.Headers=n.Headers,e.Request=n.Request,e.Response=n.Response}(Ph,Ph.exports)),Ph.exports}let Hf;typeof window<"u"?Hf=window.fetch:Hf=p3();class m3{constructor(e=void 0,t=void 0){this._redirect_in_unauthorized_internal=t,this._basic_authentication,this._bearer_authentication,this._url=e,this._defaultHeaders=new Map}SetBasicAuthorization(e,t){return e&&t?(this._basic_authentication="Basic "+Buffer.from(e+":"+t).toString("base64"),this._bearer_authentication=void 0):this._basic_authentication=void 0,this}ClearAuthorizationHeader(){this._basic_authentication=void 0,this._bearer_authentication=void 0}SetBasicAuthentication(e,t){return this.SetBasicAuthorization(e,t)}setBearerAuthorization(e){return e?(this._bearer_authentication="Bearer "+e,this._basic_authentication=void 0):this._bearer_authentication=void 0,this}_addAuthorizationHeader(e){return this._basic_authentication?e.Authorization=this._basic_authentication:this._bearer_authentication?e.Authorization=this._bearer_authentication:delete e.Authorization,e}addHeader(e,t){this._defaultHeaders.set(e,t)}async request(e,t,n,i={}){let s,a=t?t.toUpperCase():"GET",o=e&&e.length>0?e:this._url;if(!(a=="GET"||a=="POST"||a=="HEAD"||a=="PUT"||a=="DELETE"||a=="CONNECT"||a=="OPTIONS"||a=="TRACE"||a=="PATCH"))throw"Invalid method";i||(i={"Content-Type":"application/json"}),i=this._addAuthorizationHeader(i);for(const[f,c]of this._defaultHeaders)i[f]=c,!l&&f.toUpperCase()=="Content-Type".toUpperCase()&&(l=!0);let l=!1;for(const[f,c]of Object.entries(i))if(!l&&f.toUpperCase()=="Content-Type".toUpperCase()){l=!0;break}l||(i["Content-Type"]="application/json");try{switch(a){case"POST":s=await Hf(o,{method:a,body:JSON.stringify(n),headers:i});break;case"PUT":s=await Hf(o,{method:a,body:JSON.stringify(n),headers:i});break;default:let f=new URLSearchParams(n);o=o+"?"+f.toString(),s=await Hf(o,{method:a,headers:i});break}return typeof window<"u"&&this._redirect_in_unauthorized&&s.status==401&&(window.location.href=this._redirect_in_unauthorized),s}catch(f){if(console.error(f),s)return s;throw f}}async put(e=void 0,t=void 0,n=void 0){return console.warn("Method put deprecated. Use new method PUT"),this.request(e,"PUT",t,n)}PUT(e={}){return this.request(e.url,"PUT",e.data,e.headers)}async delete(e=void 0,t=void 0,n=void 0){return this.request(e,"DELETE",t,n)}DELETE(e={}){return console.warn("Method delete deprecated. Use new method DELETE"),this.request(e.url,"DELETE",e.data,e.headers)}async post(e=void 0,t=void 0,n=void 0){return console.warn("Method post deprecated. Use new method POST"),this.request(e,"POST",t,n)}POST(e={}){return this.request(e.url,"POST",e.data,e.headers)}async get(e=void 0,t=void 0,n=void 0){return console.warn("Method get deprecated. Use new method GET"),this.request(e,"GET",t,n)}GET(e={}){return this.request(e.url,"GET",e.data,e.headers)}async patch(e=void 0,t=void 0,n=void 0){return console.warn("Method patch deprecated. Use new method PATCH"),this.request(e,"PATCH",t,n)}PATCH(e={}){return this.request(e.url,"PATCH",e.data,e.headers)}}var g3=m3;const as=d3(g3),Un=v3(""),wn={getfunctions:Un+"/api/system/api/function_names/prd",getHandler:Un+"/api/system/system/handler/0.01/prd",Methods:Un+"/api/system/system/method/0.01/prd",listEnv:Un+"/api/system/system/environment/0.01/prd",listApps:Un+"/api/system/api/apps/0.01/prd",getApp:Un+"/api/system/api/app/0.01/prd",saveApp:Un+"/api/system/api/app/0.01/prd",saveMethod:Un+"/api/system/system/method/0.01/prd",login:Un+"/api/system/system/login/0.01/prd",getCacheSize:Un+"/api/system/cache/response/size/prd",clearCache:Un+"/api/system/cache/clear/prd",getUsersList:Un+"/api/system/users/list/prd",getResponsesCountStatusCode:Un+"/api/system/responses/status_code/count/prd",getLogs:Un+"/api/system/system/log/prd"},sd=ss({}),Om=ss({}),xm=ss({}),vm=ss({}),ym=ss({}),wm=ss({}),Cf=ss({}),C2=ss({}),Su=ss({}),A2=ss({}),O3=async r=>{let e=new as;e.setBearerAuthorization(r);try{let n=await(await e.GET({url:wn.getUsersList})).json();n&&Array.isArray(n)?Su.set(n):Su.set([])}catch(t){console.error(t),Su.set([])}},x3=async(r,e)=>{let t=new as;t.setBearerAuthorization(r);try{let i=await(await t.GET({url:wn.getfunctions,data:{appName:e,environment:"dev"}})).json();if(i&&Array.isArray(i)){let s=i.map(a=>({id:a,value:a}));vm.set(s)}}catch(n){console.error(n),vm.set([])}try{let i=await(await t.GET({url:wn.getfunctions,data:{appName:e,environment:"qa"}})).json();if(i&&Array.isArray(i)){let s=i.map(a=>({id:a,value:a}));ym.set(s)}}catch(n){console.error(n),ym.set([])}try{let i=await(await t.GET({url:wn.getfunctions,data:{appName:e,environment:"prd"}})).json();if(i&&Array.isArray(i)){let s=i.map(a=>({id:a,value:a}));wm.set(s)}}catch(n){console.error(n),wm.set([])}};function v3(r){try{const e=new URL(r);return e.protocol==="http:"||e.protocol==="https:"?r:""}catch{return""}}const y3=async r=>{let e=new as;e.setBearerAuthorization(r);try{let n=await(await e.GET({url:wn.getHandler})).json();if(n&&Array.isArray(n)){let i=n.map(s=>({id:s.handler,value:s.label,enabled:s.enabled,description:s.description}));xm.set(i)}}catch(t){console.error(t),xm.set([])}},w3=async r=>{let e=new as;e.setBearerAuthorization(r);try{let n=await(await e.GET({url:wn.Methods})).json();if(n&&Array.isArray(n)){let i=n.map(s=>({id:s.method,value:s.label,enabled:s.enabled,description:""}));Om.set(i)}}catch(t){console.error(t),Om.set([])}},b3=async(r,e)=>{let t=new as;try{if(r){let i=await(await t.GET({url:wn.getCacheSize,data:{appName:r}})).json();C2.set(i)}}catch(n){console.trace(n)}},uv=r=>(r==null&&(r={app:"",params:{telegram:{}}}),r&&r.idapp==null&&(r.idapp=0),r&&r.app==null&&(r.app=""),r&&r.environment==null&&(r.environment="dev"),r&&r.description==null&&(r.description=""),r&&r.endpoints==null&&(r.endpoints=[]),r&&r.params==null&&(r.params={telegram:{idgroup:""}}),r&&r.params.telegram==null&&(r.params.telegram={idgroup:""}),r&&r.params.telegram&&r.params.telegram.idgroup==null&&(r.params.telegram.idgroup=""),r&&r.vars==null&&(r.vars={}),r),q0=r=>(r==null&&(r={}),r&&r.idendpoint==null&&(r.idendpoint=void 0),r&&r.enabled==null&&(r.enabled=!1),r&&r.access==null&&(r.access=0),r&&r.environment==null&&(r.environment="dev"),r&&r.resource==null&&(r.resource=""),r&&r.method==null&&(r.method="GET"),r&&r.handler==null&&(r.handler="NA"),r&&r.cors==null&&(r.cors={}),r&&r.code==null&&(r.code=""),r&&r.description==null&&(r.description=""),r&&r.description==null&&(r.description=""),r&&r.headers_test==null&&(r.headers_test={}),r&&r.data_test==null&&(r.data_test={}),r&&r.rowkey==null&&(r.rowkey=0),r&&r.cache_time==null&&(r.cache_time=0),r&&!r.environment&&(r.environment="?"),r&&!r.endpoint&&(r.endpoint=""),r&&!r.method&&(r.method=""),r&&!r.handler&&(r.handler=""),r&&r.ctrl==null&&(r.ctrl={}),r&&r.ctrl.users==null&&(r.ctrl.users=[]),r&&r.ctrl.log==null&&(r.ctrl.log={}),r&&r.data_test==null&&(r.data_test={query:{},body:{},headers:{},auth:{}}),r&&r.data_test.query==null&&(r.data_test.query={}),r&&r.data_test.body==null&&(r.data_test.body={}),r&&r.data_test.headers==null&&(r.data_test.headers={}),r&&r.data_test.auth==null&&(r.data_test.auth={}),r),_3=async(r,e)=>{let t=new as;try{if(r){let i=await(await t.GET({url:wn.getResponsesCountStatusCode,data:{appName:r}})).json();A2.set(i)}}catch(n){console.error(n)}};function k3(r){return!!/^\/[a-zA-Z0-9\-._~%]+(\/[a-zA-Z0-9\-._~%]+)*\/?$/.test(r)}function S3(r,e,t,n){return`${r=="WS"?"/ws/":"/api/"}${e}${t}/${n}`}const E2=[{value:"Public",id:0},{value:"Basic",id:1},{value:"Bearer",id:2},{value:"Basic & Bearer",id:3}],P2={GET:{color:"primary",icon:"fa-brands fa-get-pocket"},POST:{color:"link",icon:"fa-solid fa-signs-post"},DELETE:{color:"danger",icon:"fa-solid fa-trash"},PUT:{color:"info",icon:"fa-solid fa-file-pen"},WS:{color:"warning",icon:"fa-solid fa-tower-broadcast"}},bm={JS:{color:"success",icon:"fa-brands fa-js",label:"Javascript"},SQL:{color:"link",icon:"fa-solid fa-database",label:"SQL"},SQL_BULK_I:{color:"danger",icon:"fa-solid fa-database",label:"SQL BULK INSERT"},HANA:{color:"",icon:"fa-solid fa-database",label:"Hana"},FETCH:{color:"primary",icon:"fa-solid fa-globe",label:"Fetch"},SOAP:{color:"info",icon:"fa-solid fa-soap",label:"SOAP"},TEXT:{color:"warning",icon:"fa-regular fa-file-lines",label:"Text"},FUNCTION:{color:"danger",icon:"fa-solid fa-robot",label:"Function"}},Yf={prd:{color:" has-text-success ",background:"success",icon:" fa-solid fa-gear fa-spin ",label:"Production"},qa:{color:" has-text-link ",background:"link",icon:" fa-solid fa-eye ",label:"Quality"},dev:{color:" has-text-danger ",background:"danger",icon:" fa-solid fa-bug ",label:"Development"}},T3="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAABwRJREFUWEeNl1tsXNUVhr+195mZYztxlCo3gngiKFWwhFQqpVGT2M7F5ELpQ2ugQUV9gaoqvfDQIKWFxA4EikMCTVtQCmpJo8Z1EuOmoiShVGrVhz4godL0pRdBLpCQW6P4NuOZOavZ+5yZOWPPAJZGPnPOnr3+9a9//WsfmVwuTxqjq9WAWFSMaGTAWDQSxWTw34k/6u9bUOGvuUH6pJew0MoBAuaIQbGo2mS9FcSoaiCKKNg4htvHrwn4ueSXsxlhGEvggyQLqtfx9+S+gNE4CBwLh/gaX6e1YDmFZZ4YUCMqgapLyK1zoPx1EO+jVtRY//xcMaJHdAm5/HxeF0N3HQBLAcsFLBGCOuQqyUYOvfDH3CDf5Uu0TM3jhBrm1kCLe+6AoAYrloVqMTEAt5dEWH02fJwBtyX5FWzAMoKQqTJgmRDDC1nlF5SZcOtoh1F/AYUyU/OPua+CbtG5oxmMY3lWBnXPR0Mkl2URlq2RsNlYjGMiBsC50hQ9s57mI0FAbyVXWMgbGDo9APdx0CwlLG9JxLbscf7hlibxZ/xzy+MfgXZpMNHBpiBgmxpZitFUCVARngn7GXBr4184FlbJXYiOYMiI4d9qacP4DBz1F0UYyE7xijnJ+PTocfD4b/wRFlvlMTXcL5acWKLI8C8JWITQjuGDsmV9Wx8X6gDoRnKFMY7fyHgVhtMKD5ks31bLBsQLtIThzRJsbxvhXcdGOvDbD5PpEHoQ+rDc5uttGDMBLxPwT4V9GhCI4elwJ7t96uoYSO1SWOm1cFQtWTH0XbnKnnkLeaBs2CaWmxKROWEOXFdeXXCYMZfFxIPcbAK2SsAWFXJOuGrkHQLtu3CNvy2ex281kFUYPV8qsnbWQJx9wkANwallZJcs4ASWlSqcCQ0rOMmlsc18Nmvpx7JB43Yti/CnkrDd5rjlBrAdCLe5PlfLKEb2hzn9iezlav5R1mnAb8QSRIanWnfxXK2ELn8fvwJCKHSynkBfUyGrhv7wJE8Jomd7tWV+mQdV2FplI+CaGnJiJIdV167vRFl2tCzgz7KDSHvJFm5hyIs74MOyYV3bLs6nNVQVYeWmLiObX8QfxP3IcKYorJh9gouV56Nf4fZswHaEHg3IeFczjBrh5WzIHnmR/8XaVvLfp0cMBxPWdrX8mN11beTtIi2CSkd0cxeWI1hyKmwPj/NMugXP9NIyP+AHxvBYZMmXlS1tt/Km9BFV2NSHyRRaOewSUcv5clHWtj2vddlXos/oab2TTOEz/B7DGnVtM8UXZr3lTKPWbvkHuFtUBiPLWLGkHe2HuJyubf472oPloGvrCPpb97C3kYfUSlCTgY+S72GjCEMefVl6207o39Mb5O/jbgIGI8NYqUQCoNJbwuQjfAPDTrE6VrJ0p5UfE69JG84oQbzJ23eSWTaPR42Ro+Eb+t/p6D0Ay6B6BuiYc4jL6frqDszYVTqDgAXhHoZ8CdMUVtuwwc2qIMEPuAhk/B4WzDrGR1XnTBhwZuMAtA9y2SVV7iIYv505s3/GlUaUp7OPNTADQNWiPEWXvsjs9rl8C0tvSfly2zH50Ct8OoBEA5PfZK0E0lcWfbb1Aq/LEcoNgaTCTHtej2hiE8utceNWQoz+KDfCc47ORgC88g3DYlmNkf9k0W7ZJ9cr9U6LtCLneh9oUA7fEYsZQtiI5YNI6Gwd5lwjAMWHWFOyDInxbvlk+NOa5zcuR2oaVozZjzUPy+UZy6q4iXXlDMOupTA8ER6Vgfx96rvAacB1wekS15fMZRhhNZbTU+PS1f6qNtZBKlH5GA1WQXsWbuYwhg0EnI2KrDEhdxDIoBodKxbpCNq4QwxDzvNvnAj7w5fSnp8aPf6y1i8zrLgZVcV76C5bfneD2gDLTuAUGTnkAEQZPmeFVzCsxPBeTllj9nO5bl7XUZyw7Mdx3V/tXOMxpujxg6XMEYT1GM5i2YNltyuBBnzPGF5MwG0PX5rmes1oTgZBs6RT8eMdJr9KlygjWD8p3xVLhxryYnkfy1Is72dzrDH7uDR94jU7ywlOBYnYGg2m9Ea+za54AN3J2dG/K3ikgX9neCK7v7HnV1VQCZe4cQMjaupfXjrFXjrLgjs75ipnfQ/CyOmcapf5JZfqJZbKfXqy7n3l48NVdFAromNh6poH0K3xy4Y/RUfK462/4vmm9WzyoApgmvyqo6LqWAl1bt3EvXSL4SgBueRAcrZUpnP2r93B5dM0dtoT06ZQ16EzMNR8oYugcJOMYNW9TTmOfxge4IV4QSMAlTyTcqTmwIwSfBr8bs3kFtbhzguGi6HKajmo1WNbcyAz6+CdsN6bPlEVPsfIueNSf2D5S8tB9n7SO1MzUIkVN887DXD6qvH7+XxrlvfkQIPZX1ncdGvXgMr/Adgcxpok5CivAAAAAElFTkSuQmCC";var C3=(r,e)=>{e()},A3=J('<div class="modal is-active"><div class="modal-background"></div> <div class="modal-content"><div class="box"><div class="media t1 svelte-fhc20z"><div class="media-left"><figure class="image is-48x48"><img alt="OpenFusionAPI"></figure></div> <div class="media-content"><p class="title is-family-sans-serif">Open Fusion API</p></div></div> <div class="field"><p class="control has-icons-left has-icons-right"><input class="input" type="text" placeholder="Username"> <span class="icon is-small is-left"><i class="fa-solid fa-user"></i></span></p></div> <div class="field"><p class="control has-icons-left"><input class="input" type="password" placeholder="Password"> <span class="icon is-small is-left"><i class="fas fa-lock"></i></span></p></div> <div class="field"><p class="control"><button class="button is-success">Login</button></p></div></div></div></div>');function Xse(r,e){gt(e,!0);let t=ge(e,"onlogin",3,()=>{}),n=Se(""),i=Se(""),s=new as;async function a(){try{let A=await(await s.POST({url:wn.login,data:{username:C(n),password:C(i)}})).json();A.login?(sd.set(A),await w3(A.token),await y3(A.token),t()({login:A.login})):alert("Invalid credentials")}catch(x){console.trace(x),alert(x.message)}}Ut(()=>{});var o=A3(),l=ne(Q(o),2),f=Q(l),c=Q(f),h=Q(c),u=Q(h),d=Q(u);Ea(d,"src",T3),R(u),R(h),Kt(2),R(c);var p=ne(c,2),m=Q(p),g=Q(m);wt(g),Kt(2),R(m),R(p);var O=ne(p,2),w=Q(O),v=Q(w);wt(v),Kt(2),R(w),R(O);var S=ne(O,2),y=Q(S),b=Q(y);b.__click=[C3,a],R(y),R(S),R(f),R(l),R(o),Jt(g,()=>C(n),x=>H(n,x)),Jt(v,()=>C(i),x=>H(i,x)),U(r,o),Ot()}vr(["click"]);var E3=(r,e,t)=>{e.editInline&&t(!t())},P3=J("<i></i>"),R3=J("<i></i>"),Q3=J("<span> </span>"),F3=J("<span> </span>"),$3=J('<td><span><span class="icon"><!></span> <!></span></td>'),D3=J('<input type="checkbox">'),N3=r=>{r.preventDefault()},M3=J('<input type="checkbox">'),I3=J("<td><!></td>");function mc(r,e){gt(e,!0);let t=ge(e,"value",15),n=ge(e,"css_cell",3,"has-text-centered"),i={ontrue:{label:"",iconClass:"fa-regular fa-square-check",iconColorClass:" has-text-success ",css_cell:"has-text-centered"},onfalse:{label:"",iconClass:"fa-regular fa-square",iconColorClass:" has-text-danger ",css_cell:"has-text-centered"}};var s=Ee(),a=be(s);{var o=f=>{var c=$3();c.__click=function(...v){var S;(S=e.onclick_cell)==null||S.apply(this,v)};var h=Q(c);h.__click=[E3,e,t];var u=Q(h),d=Q(u);{var p=v=>{var S=P3();Me(()=>{var y,b,x,A,k,E;return ht(S,`${((y=e.custom.ontrue)!=null&&y.iconClass?(b=e.custom.ontrue)==null?void 0:b.iconClass:(x=i.ontrue)==null?void 0:x.iconClass)??""} ${((A=e.custom.ontrue)!=null&&A.iconColorClass?(k=e.custom.ontrue)==null?void 0:k.iconColorClass:(E=i.ontrue)==null?void 0:E.iconColorClass)??""}`)}),U(v,S)},m=v=>{var S=R3();Me(()=>{var y,b,x,A,k,E;return ht(S,`${((y=e.custom.onfalse)!=null&&y.iconClass?(b=e.custom.onfalse)==null?void 0:b.iconClass:(x=i.onfalse)==null?void 0:x.iconClass)??""} ${((A=e.custom.onfalse)!=null&&A.iconColorClass?(k=e.custom.onfalse)==null?void 0:k.iconColorClass:(E=i.onfalse)==null?void 0:E.iconColorClass)??""}`)}),U(v,S)};ce(d,v=>{t()?v(p):v(m,!1)})}R(u);var g=ne(u,2);{var O=v=>{var S=Q3(),y=Q(S,!0);R(S),Me(()=>{var b;return Ge(y,(b=e.custom.ontrue)!=null&&b.label?e.custom.ontrue.label:i.ontrue.label)}),U(v,S)},w=v=>{var S=F3(),y=Q(S,!0);R(S),Me(()=>{var b;return Ge(y,(b=e.custom.onfalse)!=null&&b.label?e.custom.onfalse.label:i.onfalse.label)}),U(v,S)};ce(g,v=>{t()?v(O):v(w,!1)})}R(h),R(c),Me(()=>{var v,S;ht(c,Qi(t()?(v=e.custom.ontrue)!=null&&v.css_cell?e.custom.ontrue.css_cell:n():(S=e.custom.onfalse)!=null&&S.css_cell?e.custom.onfalse.css_cell:n())),ht(h,`icon-text ${(e.editInline?"is-clickable":"")??""}`)}),U(f,c)},l=f=>{var c=I3();c.__click=function(...p){var m;(m=e.onclick_cell)==null||m.apply(this,p)};var h=Q(c);{var u=p=>{var m=D3();wt(m),oo(m,t),U(p,m)},d=p=>{var m=M3();wt(m),m.__click=[N3],Me(()=>Jo(m,t())),U(p,m)};ce(h,p=>{e.editInline?p(u):p(d,!1)})}R(c),Me(()=>ht(c,Qi(n()))),U(f,c)};ce(a,f=>{e.custom?f(o):f(l,!1)})}U(r,s),Ot()}vr(["click"]);vr(["click"]);class Mo extends Error{}class L3 extends Mo{constructor(e){super(`Invalid DateTime: ${e.toMessage()}`)}}class B3 extends Mo{constructor(e){super(`Invalid Interval: ${e.toMessage()}`)}}class Z3 extends Mo{constructor(e){super(`Invalid Duration: ${e.toMessage()}`)}}class Af extends Mo{}class R2 extends Mo{constructor(e){super(`Invalid unit ${e}`)}}class Ti extends Mo{}class ua extends Mo{constructor(){super("Zone is an abstract class")}}const Xe="numeric",es="short",pi="long",_m={year:Xe,month:Xe,day:Xe},Q2={year:Xe,month:es,day:Xe},W3={year:Xe,month:es,day:Xe,weekday:es},F2={year:Xe,month:pi,day:Xe},$2={year:Xe,month:pi,day:Xe,weekday:pi},D2={hour:Xe,minute:Xe},N2={hour:Xe,minute:Xe,second:Xe},M2={hour:Xe,minute:Xe,second:Xe,timeZoneName:es},I2={hour:Xe,minute:Xe,second:Xe,timeZoneName:pi},L2={hour:Xe,minute:Xe,hourCycle:"h23"},B2={hour:Xe,minute:Xe,second:Xe,hourCycle:"h23"},Z2={hour:Xe,minute:Xe,second:Xe,hourCycle:"h23",timeZoneName:es},W2={hour:Xe,minute:Xe,second:Xe,hourCycle:"h23",timeZoneName:pi},U2={year:Xe,month:Xe,day:Xe,hour:Xe,minute:Xe},X2={year:Xe,month:Xe,day:Xe,hour:Xe,minute:Xe,second:Xe},V2={year:Xe,month:es,day:Xe,hour:Xe,minute:Xe},q2={year:Xe,month:es,day:Xe,hour:Xe,minute:Xe,second:Xe},U3={year:Xe,month:es,day:Xe,weekday:es,hour:Xe,minute:Xe},j2={year:Xe,month:pi,day:Xe,hour:Xe,minute:Xe,timeZoneName:es},z2={year:Xe,month:pi,day:Xe,hour:Xe,minute:Xe,second:Xe,timeZoneName:es},G2={year:Xe,month:pi,day:Xe,weekday:pi,hour:Xe,minute:Xe,timeZoneName:pi},H2={year:Xe,month:pi,day:Xe,weekday:pi,hour:Xe,minute:Xe,second:Xe,timeZoneName:pi};function kt(r){return typeof r>"u"}function mo(r){return typeof r=="number"}function f0(r){return typeof r=="number"&&r%1===0}function X3(r){return typeof r=="string"}function V3(r){return Object.prototype.toString.call(r)==="[object Date]"}function Y2(){try{return typeof Intl<"u"&&!!Intl.RelativeTimeFormat}catch{return!1}}function q3(r){return Array.isArray(r)?r:[r]}function dv(r,e,t){if(r.length!==0)return r.reduce((n,i)=>{const s=[e(i),i];return n&&t(n[0],s[0])===n[0]?n:s},null)[1]}function j3(r,e){return e.reduce((t,n)=>(t[n]=r[n],t),{})}function Tl(r,e){return Object.prototype.hasOwnProperty.call(r,e)}function Vs(r,e,t){return f0(r)&&r>=e&&r<=t}function z3(r,e){return r-e*Math.floor(r/e)}function Lr(r,e=2){const t=r<0;let n;return t?n="-"+(""+-r).padStart(e,"0"):n=(""+r).padStart(e,"0"),n}function ma(r){if(!(kt(r)||r===null||r===""))return parseInt(r,10)}function eo(r){if(!(kt(r)||r===null||r===""))return parseFloat(r)}function G1(r){if(!(kt(r)||r===null||r==="")){const e=parseFloat("0."+r)*1e3;return Math.floor(e)}}function H1(r,e,t=!1){const n=10**e;return(t?Math.trunc:Math.round)(r*n)/n}function ah(r){return r%4===0&&(r%100!==0||r%400===0)}function Kf(r){return ah(r)?366:365}function ad(r,e){const t=z3(e-1,12)+1,n=r+(e-t)/12;return t===2?ah(n)?29:28:[31,null,31,30,31,30,31,31,30,31,30,31][t-1]}function Y1(r){let e=Date.UTC(r.year,r.month-1,r.day,r.hour,r.minute,r.second,r.millisecond);return r.year<100&&r.year>=0&&(e=new Date(e),e.setUTCFullYear(e.getUTCFullYear()-1900)),+e}function od(r){const e=(r+Math.floor(r/4)-Math.floor(r/100)+Math.floor(r/400))%7,t=r-1,n=(t+Math.floor(t/4)-Math.floor(t/100)+Math.floor(t/400))%7;return e===4||n===3?53:52}function km(r){return r>99?r:r>60?1900+r:2e3+r}function K2(r,e,t,n=null){const i=new Date(r),s={hourCycle:"h23",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"};n&&(s.timeZone=n);const a={timeZoneName:e,...s},o=new Intl.DateTimeFormat(t,a).formatToParts(i).find(l=>l.type.toLowerCase()==="timezonename");return o?o.value:null}function c0(r,e){let t=parseInt(r,10);Number.isNaN(t)&&(t=0);const n=parseInt(e,10)||0,i=t<0||Object.is(t,-0)?-n:n;return t*60+i}function J2(r){const e=Number(r);if(typeof r=="boolean"||r===""||Number.isNaN(e))throw new Ti(`Invalid unit value ${r}`);return e}function ld(r,e){const t={};for(const n in r)if(Tl(r,n)){const i=r[n];if(i==null)continue;t[e(n)]=J2(i)}return t}function Jf(r,e){const t=Math.trunc(Math.abs(r/60)),n=Math.trunc(Math.abs(r%60)),i=r>=0?"+":"-";switch(e){case"short":return`${i}${Lr(t,2)}:${Lr(n,2)}`;case"narrow":return`${i}${t}${n>0?`:${n}`:""}`;case"techie":return`${i}${Lr(t,2)}${Lr(n,2)}`;default:throw new RangeError(`Value format ${e} is out of range for property format`)}}function h0(r){return j3(r,["hour","minute","second","millisecond"])}const ek=/[A-Za-z_+-]{1,256}(?::?\/[A-Za-z0-9_+-]{1,256}(?:\/[A-Za-z0-9_+-]{1,256})?)?/,G3=["January","February","March","April","May","June","July","August","September","October","November","December"],tk=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],H3=["J","F","M","A","M","J","J","A","S","O","N","D"];function rk(r){switch(r){case"narrow":return[...H3];case"short":return[...tk];case"long":return[...G3];case"numeric":return["1","2","3","4","5","6","7","8","9","10","11","12"];case"2-digit":return["01","02","03","04","05","06","07","08","09","10","11","12"];default:return null}}const nk=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],ik=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],Y3=["M","T","W","T","F","S","S"];function sk(r){switch(r){case"narrow":return[...Y3];case"short":return[...ik];case"long":return[...nk];case"numeric":return["1","2","3","4","5","6","7"];default:return null}}const ak=["AM","PM"],K3=["Before Christ","Anno Domini"],J3=["BC","AD"],e5=["B","A"];function ok(r){switch(r){case"narrow":return[...e5];case"short":return[...J3];case"long":return[...K3];default:return null}}function t5(r){return ak[r.hour<12?0:1]}function r5(r,e){return sk(e)[r.weekday-1]}function n5(r,e){return rk(e)[r.month-1]}function i5(r,e){return ok(e)[r.year<0?0:1]}function s5(r,e,t="always",n=!1){const i={years:["year","yr."],quarters:["quarter","qtr."],months:["month","mo."],weeks:["week","wk."],days:["day","day","days"],hours:["hour","hr."],minutes:["minute","min."],seconds:["second","sec."]},s=["hours","minutes","seconds"].indexOf(r)===-1;if(t==="auto"&&s){const h=r==="days";switch(e){case 1:return h?"tomorrow":`next ${i[r][0]}`;case-1:return h?"yesterday":`last ${i[r][0]}`;case 0:return h?"today":`this ${i[r][0]}`}}const a=Object.is(e,-0)||e<0,o=Math.abs(e),l=o===1,f=i[r],c=n?l?f[1]:f[2]||f[1]:l?i[r][0]:r;return a?`${o} ${c} ago`:`in ${o} ${c}`}function pv(r,e){let t="";for(const n of r)n.literal?t+=n.val:t+=e(n.val);return t}const a5={D:_m,DD:Q2,DDD:F2,DDDD:$2,t:D2,tt:N2,ttt:M2,tttt:I2,T:L2,TT:B2,TTT:Z2,TTTT:W2,f:U2,ff:V2,fff:j2,ffff:G2,F:X2,FF:q2,FFF:z2,FFFF:H2};class Gn{static create(e,t={}){return new Gn(e,t)}static parseFormat(e){let t=null,n="",i=!1;const s=[];for(let a=0;a<e.length;a++){const o=e.charAt(a);o==="'"?(n.length>0&&s.push({literal:i,val:n}),t=null,n="",i=!i):i||o===t?n+=o:(n.length>0&&s.push({literal:!1,val:n}),n=o,t=o)}return n.length>0&&s.push({literal:i,val:n}),s}static macroTokenToFormatOpts(e){return a5[e]}constructor(e,t){this.opts=t,this.loc=e,this.systemLoc=null}formatWithSystemDefault(e,t){return this.systemLoc===null&&(this.systemLoc=this.loc.redefaultToSystem()),this.systemLoc.dtFormatter(e,{...this.opts,...t}).format()}formatDateTime(e,t={}){return this.loc.dtFormatter(e,{...this.opts,...t}).format()}formatDateTimeParts(e,t={}){return this.loc.dtFormatter(e,{...this.opts,...t}).formatToParts()}resolvedOptions(e,t={}){return this.loc.dtFormatter(e,{...this.opts,...t}).resolvedOptions()}num(e,t=0){if(this.opts.forceSimple)return Lr(e,t);const n={...this.opts};return t>0&&(n.padTo=t),this.loc.numberFormatter(n).format(e)}formatDateTimeFromString(e,t){const n=this.loc.listingMode()==="en",i=this.loc.outputCalendar&&this.loc.outputCalendar!=="gregory",s=(d,p)=>this.loc.extract(e,d,p),a=d=>e.isOffsetFixed&&e.offset===0&&d.allowZ?"Z":e.isValid?e.zone.formatOffset(e.ts,d.format):"",o=()=>n?t5(e):s({hour:"numeric",hourCycle:"h12"},"dayperiod"),l=(d,p)=>n?n5(e,d):s(p?{month:d}:{month:d,day:"numeric"},"month"),f=(d,p)=>n?r5(e,d):s(p?{weekday:d}:{weekday:d,month:"long",day:"numeric"},"weekday"),c=d=>{const p=Gn.macroTokenToFormatOpts(d);return p?this.formatWithSystemDefault(e,p):d},h=d=>n?i5(e,d):s({era:d},"era"),u=d=>{switch(d){case"S":return this.num(e.millisecond);case"u":case"SSS":return this.num(e.millisecond,3);case"s":return this.num(e.second);case"ss":return this.num(e.second,2);case"uu":return this.num(Math.floor(e.millisecond/10),2);case"uuu":return this.num(Math.floor(e.millisecond/100));case"m":return this.num(e.minute);case"mm":return this.num(e.minute,2);case"h":return this.num(e.hour%12===0?12:e.hour%12);case"hh":return this.num(e.hour%12===0?12:e.hour%12,2);case"H":return this.num(e.hour);case"HH":return this.num(e.hour,2);case"Z":return a({format:"narrow",allowZ:this.opts.allowZ});case"ZZ":return a({format:"short",allowZ:this.opts.allowZ});case"ZZZ":return a({format:"techie",allowZ:this.opts.allowZ});case"ZZZZ":return e.zone.offsetName(e.ts,{format:"short",locale:this.loc.locale});case"ZZZZZ":return e.zone.offsetName(e.ts,{format:"long",locale:this.loc.locale});case"z":return e.zoneName;case"a":return o();case"d":return i?s({day:"numeric"},"day"):this.num(e.day);case"dd":return i?s({day:"2-digit"},"day"):this.num(e.day,2);case"c":return this.num(e.weekday);case"ccc":return f("short",!0);case"cccc":return f("long",!0);case"ccccc":return f("narrow",!0);case"E":return this.num(e.weekday);case"EEE":return f("short",!1);case"EEEE":return f("long",!1);case"EEEEE":return f("narrow",!1);case"L":return i?s({month:"numeric",day:"numeric"},"month"):this.num(e.month);case"LL":return i?s({month:"2-digit",day:"numeric"},"month"):this.num(e.month,2);case"LLL":return l("short",!0);case"LLLL":return l("long",!0);case"LLLLL":return l("narrow",!0);case"M":return i?s({month:"numeric"},"month"):this.num(e.month);case"MM":return i?s({month:"2-digit"},"month"):this.num(e.month,2);case"MMM":return l("short",!1);case"MMMM":return l("long",!1);case"MMMMM":return l("narrow",!1);case"y":return i?s({year:"numeric"},"year"):this.num(e.year);case"yy":return i?s({year:"2-digit"},"year"):this.num(e.year.toString().slice(-2),2);case"yyyy":return i?s({year:"numeric"},"year"):this.num(e.year,4);case"yyyyyy":return i?s({year:"numeric"},"year"):this.num(e.year,6);case"G":return h("short");case"GG":return h("long");case"GGGGG":return h("narrow");case"kk":return this.num(e.weekYear.toString().slice(-2),2);case"kkkk":return this.num(e.weekYear,4);case"W":return this.num(e.weekNumber);case"WW":return this.num(e.weekNumber,2);case"o":return this.num(e.ordinal);case"ooo":return this.num(e.ordinal,3);case"q":return this.num(e.quarter);case"qq":return this.num(e.quarter,2);case"X":return this.num(Math.floor(e.ts/1e3));case"x":return this.num(e.ts);default:return c(d)}};return pv(Gn.parseFormat(t),u)}formatDurationFromString(e,t){const n=l=>{switch(l[0]){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":return"hour";case"d":return"day";case"w":return"week";case"M":return"month";case"y":return"year";default:return null}},i=l=>f=>{const c=n(f);return c?this.num(l.get(c),f.length):f},s=Gn.parseFormat(t),a=s.reduce((l,{literal:f,val:c})=>f?l:l.concat(c),[]),o=e.shiftTo(...a.map(n).filter(l=>l));return pv(s,i(o))}}class Vi{constructor(e,t){this.reason=e,this.explanation=t}toMessage(){return this.explanation?`${this.reason}: ${this.explanation}`:this.reason}}class oh{get type(){throw new ua}get name(){throw new ua}get ianaName(){return this.name}get isUniversal(){throw new ua}offsetName(e,t){throw new ua}formatOffset(e,t){throw new ua}offset(e){throw new ua}equals(e){throw new ua}get isValid(){throw new ua}}let j0=null;class K1 extends oh{static get instance(){return j0===null&&(j0=new K1),j0}get type(){return"system"}get name(){return new Intl.DateTimeFormat().resolvedOptions().timeZone}get isUniversal(){return!1}offsetName(e,{format:t,locale:n}){return K2(e,t,n)}formatOffset(e,t){return Jf(this.offset(e),t)}offset(e){return-new Date(e).getTimezoneOffset()}equals(e){return e.type==="system"}get isValid(){return!0}}let Tu={};function o5(r){return Tu[r]||(Tu[r]=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:r,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",era:"short"})),Tu[r]}const l5={year:0,month:1,day:2,era:3,hour:4,minute:5,second:6};function f5(r,e){const t=r.format(e).replace(/\u200E/g,""),n=/(\d+)\/(\d+)\/(\d+) (AD|BC),? (\d+):(\d+):(\d+)/.exec(t),[,i,s,a,o,l,f,c]=n;return[a,i,s,o,l,f,c]}function c5(r,e){const t=r.formatToParts(e),n=[];for(let i=0;i<t.length;i++){const{type:s,value:a}=t[i],o=l5[s];s==="era"?n[o]=a:kt(o)||(n[o]=parseInt(a,10))}return n}let Rh={};class Hs extends oh{static create(e){return Rh[e]||(Rh[e]=new Hs(e)),Rh[e]}static resetCache(){Rh={},Tu={}}static isValidSpecifier(e){return this.isValidZone(e)}static isValidZone(e){if(!e)return!1;try{return new Intl.DateTimeFormat("en-US",{timeZone:e}).format(),!0}catch{return!1}}constructor(e){super(),this.zoneName=e,this.valid=Hs.isValidZone(e)}get type(){return"iana"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(e,{format:t,locale:n}){return K2(e,t,n,this.name)}formatOffset(e,t){return Jf(this.offset(e),t)}offset(e){const t=new Date(e);if(isNaN(t))return NaN;const n=o5(this.name);let[i,s,a,o,l,f,c]=n.formatToParts?c5(n,t):f5(n,t);o==="BC"&&(i=-Math.abs(i)+1);const u=Y1({year:i,month:s,day:a,hour:l===24?0:l,minute:f,second:c,millisecond:0});let d=+t;const p=d%1e3;return d-=p>=0?p:1e3+p,(u-d)/(60*1e3)}equals(e){return e.type==="iana"&&e.name===this.name}get isValid(){return this.valid}}let z0=null;class Nn extends oh{static get utcInstance(){return z0===null&&(z0=new Nn(0)),z0}static instance(e){return e===0?Nn.utcInstance:new Nn(e)}static parseSpecifier(e){if(e){const t=e.match(/^utc(?:([+-]\d{1,2})(?::(\d{2}))?)?$/i);if(t)return new Nn(c0(t[1],t[2]))}return null}constructor(e){super(),this.fixed=e}get type(){return"fixed"}get name(){return this.fixed===0?"UTC":`UTC${Jf(this.fixed,"narrow")}`}get ianaName(){return this.fixed===0?"Etc/UTC":`Etc/GMT${Jf(-this.fixed,"narrow")}`}offsetName(){return this.name}formatOffset(e,t){return Jf(this.fixed,t)}get isUniversal(){return!0}offset(){return this.fixed}equals(e){return e.type==="fixed"&&e.fixed===this.fixed}get isValid(){return!0}}class h5 extends oh{constructor(e){super(),this.zoneName=e}get type(){return"invalid"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(){return null}formatOffset(){return""}offset(){return NaN}equals(){return!1}get isValid(){return!1}}function va(r,e){if(kt(r)||r===null)return e;if(r instanceof oh)return r;if(X3(r)){const t=r.toLowerCase();return t==="local"||t==="system"?e:t==="utc"||t==="gmt"?Nn.utcInstance:Nn.parseSpecifier(t)||Hs.create(r)}else return mo(r)?Nn.instance(r):typeof r=="object"&&r.offset&&typeof r.offset=="number"?r:new h5(r)}let mv=()=>Date.now(),gv="system",Ov=null,xv=null,vv=null,yv;class Zr{static get now(){return mv}static set now(e){mv=e}static set defaultZone(e){gv=e}static get defaultZone(){return va(gv,K1.instance)}static get defaultLocale(){return Ov}static set defaultLocale(e){Ov=e}static get defaultNumberingSystem(){return xv}static set defaultNumberingSystem(e){xv=e}static get defaultOutputCalendar(){return vv}static set defaultOutputCalendar(e){vv=e}static get throwOnInvalid(){return yv}static set throwOnInvalid(e){yv=e}static resetCaches(){Or.resetCache(),Hs.resetCache()}}let wv={};function u5(r,e={}){const t=JSON.stringify([r,e]);let n=wv[t];return n||(n=new Intl.ListFormat(r,e),wv[t]=n),n}let Sm={};function Tm(r,e={}){const t=JSON.stringify([r,e]);let n=Sm[t];return n||(n=new Intl.DateTimeFormat(r,e),Sm[t]=n),n}let Cm={};function d5(r,e={}){const t=JSON.stringify([r,e]);let n=Cm[t];return n||(n=new Intl.NumberFormat(r,e),Cm[t]=n),n}let Am={};function p5(r,e={}){const{base:t,...n}=e,i=JSON.stringify([r,n]);let s=Am[i];return s||(s=new Intl.RelativeTimeFormat(r,e),Am[i]=s),s}let Ef=null;function m5(){return Ef||(Ef=new Intl.DateTimeFormat().resolvedOptions().locale,Ef)}function g5(r){const e=r.indexOf("-u-");if(e===-1)return[r];{let t;const n=r.substring(0,e);try{t=Tm(r).resolvedOptions()}catch{t=Tm(n).resolvedOptions()}const{numberingSystem:i,calendar:s}=t;return[n,i,s]}}function O5(r,e,t){return(t||e)&&(r+="-u",t&&(r+=`-ca-${t}`),e&&(r+=`-nu-${e}`)),r}function x5(r){const e=[];for(let t=1;t<=12;t++){const n=nt.utc(2016,t,1);e.push(r(n))}return e}function v5(r){const e=[];for(let t=1;t<=7;t++){const n=nt.utc(2016,11,13+t);e.push(r(n))}return e}function Qh(r,e,t,n,i){const s=r.listingMode(t);return s==="error"?null:s==="en"?n(e):i(e)}function y5(r){return r.numberingSystem&&r.numberingSystem!=="latn"?!1:r.numberingSystem==="latn"||!r.locale||r.locale.startsWith("en")||new Intl.DateTimeFormat(r.intl).resolvedOptions().numberingSystem==="latn"}class w5{constructor(e,t,n){this.padTo=n.padTo||0,this.floor=n.floor||!1;const{padTo:i,floor:s,...a}=n;if(!t||Object.keys(a).length>0){const o={useGrouping:!1,...n};n.padTo>0&&(o.minimumIntegerDigits=n.padTo),this.inf=d5(e,o)}}format(e){if(this.inf){const t=this.floor?Math.floor(e):e;return this.inf.format(t)}else{const t=this.floor?Math.floor(e):H1(e,3);return Lr(t,this.padTo)}}}class b5{constructor(e,t,n){this.opts=n;let i;if(e.zone.isUniversal){const a=-1*(e.offset/60),o=a>=0?`Etc/GMT+${a}`:`Etc/GMT${a}`;e.offset!==0&&Hs.create(o).valid?(i=o,this.dt=e):(i="UTC",n.timeZoneName?this.dt=e:this.dt=e.offset===0?e:nt.fromMillis(e.ts+e.offset*60*1e3))}else e.zone.type==="system"?this.dt=e:(this.dt=e,i=e.zone.name);const s={...this.opts};i&&(s.timeZone=i),this.dtf=Tm(t,s)}format(){return this.dtf.format(this.dt.toJSDate())}formatToParts(){return this.dtf.formatToParts(this.dt.toJSDate())}resolvedOptions(){return this.dtf.resolvedOptions()}}class _5{constructor(e,t,n){this.opts={style:"long",...n},!t&&Y2()&&(this.rtf=p5(e,n))}format(e,t){return this.rtf?this.rtf.format(e,t):s5(t,e,this.opts.numeric,this.opts.style!=="long")}formatToParts(e,t){return this.rtf?this.rtf.formatToParts(e,t):[]}}class Or{static fromOpts(e){return Or.create(e.locale,e.numberingSystem,e.outputCalendar,e.defaultToEN)}static create(e,t,n,i=!1){const s=e||Zr.defaultLocale,a=s||(i?"en-US":m5()),o=t||Zr.defaultNumberingSystem,l=n||Zr.defaultOutputCalendar;return new Or(a,o,l,s)}static resetCache(){Ef=null,Sm={},Cm={},Am={}}static fromObject({locale:e,numberingSystem:t,outputCalendar:n}={}){return Or.create(e,t,n)}constructor(e,t,n,i){const[s,a,o]=g5(e);this.locale=s,this.numberingSystem=t||a||null,this.outputCalendar=n||o||null,this.intl=O5(this.locale,this.numberingSystem,this.outputCalendar),this.weekdaysCache={format:{},standalone:{}},this.monthsCache={format:{},standalone:{}},this.meridiemCache=null,this.eraCache={},this.specifiedLocale=i,this.fastNumbersCached=null}get fastNumbers(){return this.fastNumbersCached==null&&(this.fastNumbersCached=y5(this)),this.fastNumbersCached}listingMode(){const e=this.isEnglish(),t=(this.numberingSystem===null||this.numberingSystem==="latn")&&(this.outputCalendar===null||this.outputCalendar==="gregory");return e&&t?"en":"intl"}clone(e){return!e||Object.getOwnPropertyNames(e).length===0?this:Or.create(e.locale||this.specifiedLocale,e.numberingSystem||this.numberingSystem,e.outputCalendar||this.outputCalendar,e.defaultToEN||!1)}redefaultToEN(e={}){return this.clone({...e,defaultToEN:!0})}redefaultToSystem(e={}){return this.clone({...e,defaultToEN:!1})}months(e,t=!1,n=!0){return Qh(this,e,n,rk,()=>{const i=t?{month:e,day:"numeric"}:{month:e},s=t?"format":"standalone";return this.monthsCache[s][e]||(this.monthsCache[s][e]=x5(a=>this.extract(a,i,"month"))),this.monthsCache[s][e]})}weekdays(e,t=!1,n=!0){return Qh(this,e,n,sk,()=>{const i=t?{weekday:e,year:"numeric",month:"long",day:"numeric"}:{weekday:e},s=t?"format":"standalone";return this.weekdaysCache[s][e]||(this.weekdaysCache[s][e]=v5(a=>this.extract(a,i,"weekday"))),this.weekdaysCache[s][e]})}meridiems(e=!0){return Qh(this,void 0,e,()=>ak,()=>{if(!this.meridiemCache){const t={hour:"numeric",hourCycle:"h12"};this.meridiemCache=[nt.utc(2016,11,13,9),nt.utc(2016,11,13,19)].map(n=>this.extract(n,t,"dayperiod"))}return this.meridiemCache})}eras(e,t=!0){return Qh(this,e,t,ok,()=>{const n={era:e};return this.eraCache[e]||(this.eraCache[e]=[nt.utc(-40,1,1),nt.utc(2017,1,1)].map(i=>this.extract(i,n,"era"))),this.eraCache[e]})}extract(e,t,n){const i=this.dtFormatter(e,t),s=i.formatToParts(),a=s.find(o=>o.type.toLowerCase()===n);return a?a.value:null}numberFormatter(e={}){return new w5(this.intl,e.forceSimple||this.fastNumbers,e)}dtFormatter(e,t={}){return new b5(e,this.intl,t)}relFormatter(e={}){return new _5(this.intl,this.isEnglish(),e)}listFormatter(e={}){return u5(this.intl,e)}isEnglish(){return this.locale==="en"||this.locale.toLowerCase()==="en-us"||new Intl.DateTimeFormat(this.intl).resolvedOptions().locale.startsWith("en-us")}equals(e){return this.locale===e.locale&&this.numberingSystem===e.numberingSystem&&this.outputCalendar===e.outputCalendar}}function Hl(...r){const e=r.reduce((t,n)=>t+n.source,"");return RegExp(`^${e}$`)}function Yl(...r){return e=>r.reduce(([t,n,i],s)=>{const[a,o,l]=s(e,i);return[{...t,...a},o||n,l]},[{},null,1]).slice(0,2)}function Kl(r,...e){if(r==null)return[null,null];for(const[t,n]of e){const i=t.exec(r);if(i)return n(i)}return[null,null]}function lk(...r){return(e,t)=>{const n={};let i;for(i=0;i<r.length;i++)n[r[i]]=ma(e[t+i]);return[n,null,t+i]}}const fk=/(?:(Z)|([+-]\d\d)(?::?(\d\d))?)/,k5=`(?:${fk.source}?(?:\\[(${ek.source})\\])?)?`,J1=/(\d\d)(?::?(\d\d)(?::?(\d\d)(?:[.,](\d{1,30}))?)?)?/,ck=RegExp(`${J1.source}${k5}`),eO=RegExp(`(?:T${ck.source})?`),S5=/([+-]\d{6}|\d{4})(?:-?(\d\d)(?:-?(\d\d))?)?/,T5=/(\d{4})-?W(\d\d)(?:-?(\d))?/,C5=/(\d{4})-?(\d{3})/,A5=lk("weekYear","weekNumber","weekDay"),E5=lk("year","ordinal"),P5=/(\d{4})-(\d\d)-(\d\d)/,hk=RegExp(`${J1.source} ?(?:${fk.source}|(${ek.source}))?`),R5=RegExp(`(?: ${hk.source})?`);function hl(r,e,t){const n=r[e];return kt(n)?t:ma(n)}function Q5(r,e){return[{year:hl(r,e),month:hl(r,e+1,1),day:hl(r,e+2,1)},null,e+3]}function Jl(r,e){return[{hours:hl(r,e,0),minutes:hl(r,e+1,0),seconds:hl(r,e+2,0),milliseconds:G1(r[e+3])},null,e+4]}function lh(r,e){const t=!r[e]&&!r[e+1],n=c0(r[e+1],r[e+2]),i=t?null:Nn.instance(n);return[{},i,e+3]}function fh(r,e){const t=r[e]?Hs.create(r[e]):null;return[{},t,e+1]}const F5=RegExp(`^T?${J1.source}$`),$5=/^-?P(?:(?:(-?\d{1,20}(?:\.\d{1,20})?)Y)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20}(?:\.\d{1,20})?)W)?(?:(-?\d{1,20}(?:\.\d{1,20})?)D)?(?:T(?:(-?\d{1,20}(?:\.\d{1,20})?)H)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20})(?:[.,](-?\d{1,20}))?S)?)?)$/;function D5(r){const[e,t,n,i,s,a,o,l,f]=r,c=e[0]==="-",h=l&&l[0]==="-",u=(d,p=!1)=>d!==void 0&&(p||d&&c)?-d:d;return[{years:u(eo(t)),months:u(eo(n)),weeks:u(eo(i)),days:u(eo(s)),hours:u(eo(a)),minutes:u(eo(o)),seconds:u(eo(l),l==="-0"),milliseconds:u(G1(f),h)}]}const N5={GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function tO(r,e,t,n,i,s,a){const o={year:e.length===2?km(ma(e)):ma(e),month:tk.indexOf(t)+1,day:ma(n),hour:ma(i),minute:ma(s)};return a&&(o.second=ma(a)),r&&(o.weekday=r.length>3?nk.indexOf(r)+1:ik.indexOf(r)+1),o}const M5=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|(?:([+-]\d\d)(\d\d)))$/;function I5(r){const[,e,t,n,i,s,a,o,l,f,c,h]=r,u=tO(e,i,n,t,s,a,o);let d;return l?d=N5[l]:f?d=0:d=c0(c,h),[u,new Nn(d)]}function L5(r){return r.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim()}const B5=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d\d) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d\d):(\d\d):(\d\d) GMT$/,Z5=/^(Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday), (\d\d)-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d\d) (\d\d):(\d\d):(\d\d) GMT$/,W5=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( \d|\d\d) (\d\d):(\d\d):(\d\d) (\d{4})$/;function bv(r){const[,e,t,n,i,s,a,o]=r;return[tO(e,i,n,t,s,a,o),Nn.utcInstance]}function U5(r){const[,e,t,n,i,s,a,o]=r;return[tO(e,o,t,n,i,s,a),Nn.utcInstance]}const X5=Hl(S5,eO),V5=Hl(T5,eO),q5=Hl(C5,eO),j5=Hl(ck),uk=Yl(Q5,Jl,lh,fh),z5=Yl(A5,Jl,lh,fh),G5=Yl(E5,Jl,lh,fh),H5=Yl(Jl,lh,fh);function Y5(r){return Kl(r,[X5,uk],[V5,z5],[q5,G5],[j5,H5])}function K5(r){return Kl(L5(r),[M5,I5])}function J5(r){return Kl(r,[B5,bv],[Z5,bv],[W5,U5])}function eR(r){return Kl(r,[$5,D5])}const tR=Yl(Jl);function rR(r){return Kl(r,[F5,tR])}const nR=Hl(P5,R5),iR=Hl(hk),sR=Yl(Jl,lh,fh);function aR(r){return Kl(r,[nR,uk],[iR,sR])}const oR="Invalid Duration",dk={weeks:{days:7,hours:7*24,minutes:7*24*60,seconds:7*24*60*60,milliseconds:7*24*60*60*1e3},days:{hours:24,minutes:24*60,seconds:24*60*60,milliseconds:24*60*60*1e3},hours:{minutes:60,seconds:60*60,milliseconds:60*60*1e3},minutes:{seconds:60,milliseconds:60*1e3},seconds:{milliseconds:1e3}},lR={years:{quarters:4,months:12,weeks:52,days:365,hours:365*24,minutes:365*24*60,seconds:365*24*60*60,milliseconds:365*24*60*60*1e3},quarters:{months:3,weeks:13,days:91,hours:91*24,minutes:91*24*60,seconds:91*24*60*60,milliseconds:91*24*60*60*1e3},months:{weeks:4,days:30,hours:30*24,minutes:30*24*60,seconds:30*24*60*60,milliseconds:30*24*60*60*1e3},...dk},vi=146097/400,jo=146097/4800,fR={years:{quarters:4,months:12,weeks:vi/7,days:vi,hours:vi*24,minutes:vi*24*60,seconds:vi*24*60*60,milliseconds:vi*24*60*60*1e3},quarters:{months:3,weeks:vi/28,days:vi/4,hours:vi*24/4,minutes:vi*24*60/4,seconds:vi*24*60*60/4,milliseconds:vi*24*60*60*1e3/4},months:{weeks:jo/7,days:jo,hours:jo*24,minutes:jo*24*60,seconds:jo*24*60*60,milliseconds:jo*24*60*60*1e3},...dk},io=["years","quarters","months","weeks","days","hours","minutes","seconds","milliseconds"],cR=io.slice(0).reverse();function to(r,e,t=!1){const n={values:t?e.values:{...r.values,...e.values||{}},loc:r.loc.clone(e.loc),conversionAccuracy:e.conversionAccuracy||r.conversionAccuracy};return new Tt(n)}function hR(r){return r<0?Math.floor(r):Math.ceil(r)}function pk(r,e,t,n,i){const s=r[i][t],a=e[t]/s,o=Math.sign(a)===Math.sign(n[i]),l=!o&&n[i]!==0&&Math.abs(a)<=1?hR(a):Math.trunc(a);n[i]+=l,e[t]-=l*s}function uR(r,e){cR.reduce((t,n)=>kt(e[n])?t:(t&&pk(r,e,t,e,n),n),null)}class Tt{constructor(e){const t=e.conversionAccuracy==="longterm"||!1;this.values=e.values,this.loc=e.loc||Or.create(),this.conversionAccuracy=t?"longterm":"casual",this.invalid=e.invalid||null,this.matrix=t?fR:lR,this.isLuxonDuration=!0}static fromMillis(e,t){return Tt.fromObject({milliseconds:e},t)}static fromObject(e,t={}){if(e==null||typeof e!="object")throw new Ti(`Duration.fromObject: argument expected to be an object, got ${e===null?"null":typeof e}`);return new Tt({values:ld(e,Tt.normalizeUnit),loc:Or.fromObject(t),conversionAccuracy:t.conversionAccuracy})}static fromDurationLike(e){if(mo(e))return Tt.fromMillis(e);if(Tt.isDuration(e))return e;if(typeof e=="object")return Tt.fromObject(e);throw new Ti(`Unknown duration argument ${e} of type ${typeof e}`)}static fromISO(e,t){const[n]=eR(e);return n?Tt.fromObject(n,t):Tt.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static fromISOTime(e,t){const[n]=rR(e);return n?Tt.fromObject(n,t):Tt.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static invalid(e,t=null){if(!e)throw new Ti("need to specify a reason the Duration is invalid");const n=e instanceof Vi?e:new Vi(e,t);if(Zr.throwOnInvalid)throw new Z3(n);return new Tt({invalid:n})}static normalizeUnit(e){const t={year:"years",years:"years",quarter:"quarters",quarters:"quarters",month:"months",months:"months",week:"weeks",weeks:"weeks",day:"days",days:"days",hour:"hours",hours:"hours",minute:"minutes",minutes:"minutes",second:"seconds",seconds:"seconds",millisecond:"milliseconds",milliseconds:"milliseconds"}[e&&e.toLowerCase()];if(!t)throw new R2(e);return t}static isDuration(e){return e&&e.isLuxonDuration||!1}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}toFormat(e,t={}){const n={...t,floor:t.round!==!1&&t.floor!==!1};return this.isValid?Gn.create(this.loc,n).formatDurationFromString(this,e):oR}toHuman(e={}){const t=io.map(n=>{const i=this.values[n];return kt(i)?null:this.loc.numberFormatter({style:"unit",unitDisplay:"long",...e,unit:n.slice(0,-1)}).format(i)}).filter(n=>n);return this.loc.listFormatter({type:"conjunction",style:e.listStyle||"narrow",...e}).format(t)}toObject(){return this.isValid?{...this.values}:{}}toISO(){if(!this.isValid)return null;let e="P";return this.years!==0&&(e+=this.years+"Y"),(this.months!==0||this.quarters!==0)&&(e+=this.months+this.quarters*3+"M"),this.weeks!==0&&(e+=this.weeks+"W"),this.days!==0&&(e+=this.days+"D"),(this.hours!==0||this.minutes!==0||this.seconds!==0||this.milliseconds!==0)&&(e+="T"),this.hours!==0&&(e+=this.hours+"H"),this.minutes!==0&&(e+=this.minutes+"M"),(this.seconds!==0||this.milliseconds!==0)&&(e+=H1(this.seconds+this.milliseconds/1e3,3)+"S"),e==="P"&&(e+="T0S"),e}toISOTime(e={}){if(!this.isValid)return null;const t=this.toMillis();if(t<0||t>=864e5)return null;e={suppressMilliseconds:!1,suppressSeconds:!1,includePrefix:!1,format:"extended",...e};const n=this.shiftTo("hours","minutes","seconds","milliseconds");let i=e.format==="basic"?"hhmm":"hh:mm";(!e.suppressSeconds||n.seconds!==0||n.milliseconds!==0)&&(i+=e.format==="basic"?"ss":":ss",(!e.suppressMilliseconds||n.milliseconds!==0)&&(i+=".SSS"));let s=n.toFormat(i);return e.includePrefix&&(s="T"+s),s}toJSON(){return this.toISO()}toString(){return this.toISO()}toMillis(){return this.as("milliseconds")}valueOf(){return this.toMillis()}plus(e){if(!this.isValid)return this;const t=Tt.fromDurationLike(e),n={};for(const i of io)(Tl(t.values,i)||Tl(this.values,i))&&(n[i]=t.get(i)+this.get(i));return to(this,{values:n},!0)}minus(e){if(!this.isValid)return this;const t=Tt.fromDurationLike(e);return this.plus(t.negate())}mapUnits(e){if(!this.isValid)return this;const t={};for(const n of Object.keys(this.values))t[n]=J2(e(this.values[n],n));return to(this,{values:t},!0)}get(e){return this[Tt.normalizeUnit(e)]}set(e){if(!this.isValid)return this;const t={...this.values,...ld(e,Tt.normalizeUnit)};return to(this,{values:t})}reconfigure({locale:e,numberingSystem:t,conversionAccuracy:n}={}){const i=this.loc.clone({locale:e,numberingSystem:t}),s={loc:i};return n&&(s.conversionAccuracy=n),to(this,s)}as(e){return this.isValid?this.shiftTo(e).get(e):NaN}normalize(){if(!this.isValid)return this;const e=this.toObject();return uR(this.matrix,e),to(this,{values:e},!0)}shiftTo(...e){if(!this.isValid)return this;if(e.length===0)return this;e=e.map(a=>Tt.normalizeUnit(a));const t={},n={},i=this.toObject();let s;for(const a of io)if(e.indexOf(a)>=0){s=a;let o=0;for(const f in n)o+=this.matrix[f][a]*n[f],n[f]=0;mo(i[a])&&(o+=i[a]);const l=Math.trunc(o);t[a]=l,n[a]=(o*1e3-l*1e3)/1e3;for(const f in i)io.indexOf(f)>io.indexOf(a)&&pk(this.matrix,i,f,t,a)}else mo(i[a])&&(n[a]=i[a]);for(const a in n)n[a]!==0&&(t[s]+=a===s?n[a]:n[a]/this.matrix[s][a]);return to(this,{values:t},!0).normalize()}negate(){if(!this.isValid)return this;const e={};for(const t of Object.keys(this.values))e[t]=this.values[t]===0?0:-this.values[t];return to(this,{values:e},!0)}get years(){return this.isValid?this.values.years||0:NaN}get quarters(){return this.isValid?this.values.quarters||0:NaN}get months(){return this.isValid?this.values.months||0:NaN}get weeks(){return this.isValid?this.values.weeks||0:NaN}get days(){return this.isValid?this.values.days||0:NaN}get hours(){return this.isValid?this.values.hours||0:NaN}get minutes(){return this.isValid?this.values.minutes||0:NaN}get seconds(){return this.isValid?this.values.seconds||0:NaN}get milliseconds(){return this.isValid?this.values.milliseconds||0:NaN}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}equals(e){if(!this.isValid||!e.isValid||!this.loc.equals(e.loc))return!1;function t(n,i){return n===void 0||n===0?i===void 0||i===0:n===i}for(const n of io)if(!t(this.values[n],e.values[n]))return!1;return!0}}const cf="Invalid Interval";function dR(r,e){return!r||!r.isValid?wr.invalid("missing or invalid start"):!e||!e.isValid?wr.invalid("missing or invalid end"):e<r?wr.invalid("end before start",`The end of an interval must be after its start, but you had start=${r.toISO()} and end=${e.toISO()}`):null}class wr{constructor(e){this.s=e.start,this.e=e.end,this.invalid=e.invalid||null,this.isLuxonInterval=!0}static invalid(e,t=null){if(!e)throw new Ti("need to specify a reason the Interval is invalid");const n=e instanceof Vi?e:new Vi(e,t);if(Zr.throwOnInvalid)throw new B3(n);return new wr({invalid:n})}static fromDateTimes(e,t){const n=df(e),i=df(t),s=dR(n,i);return s??new wr({start:n,end:i})}static after(e,t){const n=Tt.fromDurationLike(t),i=df(e);return wr.fromDateTimes(i,i.plus(n))}static before(e,t){const n=Tt.fromDurationLike(t),i=df(e);return wr.fromDateTimes(i.minus(n),i)}static fromISO(e,t){const[n,i]=(e||"").split("/",2);if(n&&i){let s,a;try{s=nt.fromISO(n,t),a=s.isValid}catch{a=!1}let o,l;try{o=nt.fromISO(i,t),l=o.isValid}catch{l=!1}if(a&&l)return wr.fromDateTimes(s,o);if(a){const f=Tt.fromISO(i,t);if(f.isValid)return wr.after(s,f)}else if(l){const f=Tt.fromISO(n,t);if(f.isValid)return wr.before(o,f)}}return wr.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static isInterval(e){return e&&e.isLuxonInterval||!1}get start(){return this.isValid?this.s:null}get end(){return this.isValid?this.e:null}get isValid(){return this.invalidReason===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}length(e="milliseconds"){return this.isValid?this.toDuration(e).get(e):NaN}count(e="milliseconds"){if(!this.isValid)return NaN;const t=this.start.startOf(e),n=this.end.startOf(e);return Math.floor(n.diff(t,e).get(e))+1}hasSame(e){return this.isValid?this.isEmpty()||this.e.minus(1).hasSame(this.s,e):!1}isEmpty(){return this.s.valueOf()===this.e.valueOf()}isAfter(e){return this.isValid?this.s>e:!1}isBefore(e){return this.isValid?this.e<=e:!1}contains(e){return this.isValid?this.s<=e&&this.e>e:!1}set({start:e,end:t}={}){return this.isValid?wr.fromDateTimes(e||this.s,t||this.e):this}splitAt(...e){if(!this.isValid)return[];const t=e.map(df).filter(a=>this.contains(a)).sort(),n=[];let{s:i}=this,s=0;for(;i<this.e;){const a=t[s]||this.e,o=+a>+this.e?this.e:a;n.push(wr.fromDateTimes(i,o)),i=o,s+=1}return n}splitBy(e){const t=Tt.fromDurationLike(e);if(!this.isValid||!t.isValid||t.as("milliseconds")===0)return[];let{s:n}=this,i=1,s;const a=[];for(;n<this.e;){const o=this.start.plus(t.mapUnits(l=>l*i));s=+o>+this.e?this.e:o,a.push(wr.fromDateTimes(n,s)),n=s,i+=1}return a}divideEqually(e){return this.isValid?this.splitBy(this.length()/e).slice(0,e):[]}overlaps(e){return this.e>e.s&&this.s<e.e}abutsStart(e){return this.isValid?+this.e==+e.s:!1}abutsEnd(e){return this.isValid?+e.e==+this.s:!1}engulfs(e){return this.isValid?this.s<=e.s&&this.e>=e.e:!1}equals(e){return!this.isValid||!e.isValid?!1:this.s.equals(e.s)&&this.e.equals(e.e)}intersection(e){if(!this.isValid)return this;const t=this.s>e.s?this.s:e.s,n=this.e<e.e?this.e:e.e;return t>=n?null:wr.fromDateTimes(t,n)}union(e){if(!this.isValid)return this;const t=this.s<e.s?this.s:e.s,n=this.e>e.e?this.e:e.e;return wr.fromDateTimes(t,n)}static merge(e){const[t,n]=e.sort((i,s)=>i.s-s.s).reduce(([i,s],a)=>s?s.overlaps(a)||s.abutsStart(a)?[i,s.union(a)]:[i.concat([s]),a]:[i,a],[[],null]);return n&&t.push(n),t}static xor(e){let t=null,n=0;const i=[],s=e.map(l=>[{time:l.s,type:"s"},{time:l.e,type:"e"}]),a=Array.prototype.concat(...s),o=a.sort((l,f)=>l.time-f.time);for(const l of o)n+=l.type==="s"?1:-1,n===1?t=l.time:(t&&+t!=+l.time&&i.push(wr.fromDateTimes(t,l.time)),t=null);return wr.merge(i)}difference(...e){return wr.xor([this].concat(e)).map(t=>this.intersection(t)).filter(t=>t&&!t.isEmpty())}toString(){return this.isValid?`[${this.s.toISO()}  ${this.e.toISO()})`:cf}toISO(e){return this.isValid?`${this.s.toISO(e)}/${this.e.toISO(e)}`:cf}toISODate(){return this.isValid?`${this.s.toISODate()}/${this.e.toISODate()}`:cf}toISOTime(e){return this.isValid?`${this.s.toISOTime(e)}/${this.e.toISOTime(e)}`:cf}toFormat(e,{separator:t="  "}={}){return this.isValid?`${this.s.toFormat(e)}${t}${this.e.toFormat(e)}`:cf}toDuration(e,t){return this.isValid?this.e.diff(this.s,e,t):Tt.invalid(this.invalidReason)}mapEndpoints(e){return wr.fromDateTimes(e(this.s),e(this.e))}}class Fh{static hasDST(e=Zr.defaultZone){const t=nt.now().setZone(e).set({month:12});return!e.isUniversal&&t.offset!==t.set({month:6}).offset}static isValidIANAZone(e){return Hs.isValidZone(e)}static normalizeZone(e){return va(e,Zr.defaultZone)}static months(e="long",{locale:t=null,numberingSystem:n=null,locObj:i=null,outputCalendar:s="gregory"}={}){return(i||Or.create(t,n,s)).months(e)}static monthsFormat(e="long",{locale:t=null,numberingSystem:n=null,locObj:i=null,outputCalendar:s="gregory"}={}){return(i||Or.create(t,n,s)).months(e,!0)}static weekdays(e="long",{locale:t=null,numberingSystem:n=null,locObj:i=null}={}){return(i||Or.create(t,n,null)).weekdays(e)}static weekdaysFormat(e="long",{locale:t=null,numberingSystem:n=null,locObj:i=null}={}){return(i||Or.create(t,n,null)).weekdays(e,!0)}static meridiems({locale:e=null}={}){return Or.create(e).meridiems()}static eras(e="short",{locale:t=null}={}){return Or.create(t,null,"gregory").eras(e)}static features(){return{relative:Y2()}}}function _v(r,e){const t=i=>i.toUTC(0,{keepLocalTime:!0}).startOf("day").valueOf(),n=t(e)-t(r);return Math.floor(Tt.fromMillis(n).as("days"))}function pR(r,e,t){const n=[["years",(o,l)=>l.year-o.year],["quarters",(o,l)=>l.quarter-o.quarter],["months",(o,l)=>l.month-o.month+(l.year-o.year)*12],["weeks",(o,l)=>{const f=_v(o,l);return(f-f%7)/7}],["days",_v]],i={};let s,a;for(const[o,l]of n)if(t.indexOf(o)>=0){s=o;let f=l(r,e);a=r.plus({[o]:f}),a>e?(r=r.plus({[o]:f-1}),f-=1):r=a,i[o]=f}return[r,i,a,s]}function mR(r,e,t,n){let[i,s,a,o]=pR(r,e,t);const l=e-i,f=t.filter(h=>["hours","minutes","seconds","milliseconds"].indexOf(h)>=0);f.length===0&&(a<e&&(a=i.plus({[o]:1})),a!==i&&(s[o]=(s[o]||0)+l/(a-i)));const c=Tt.fromObject(s,n);return f.length>0?Tt.fromMillis(l,n).shiftTo(...f).plus(c):c}const rO={arab:"[-]",arabext:"[-]",bali:"[-]",beng:"[-]",deva:"[-]",fullwide:"[-]",gujr:"[-]",hanidec:"[|||||||||]",khmr:"[-]",knda:"[-]",laoo:"[-]",limb:"[-]",mlym:"[-]",mong:"[-]",mymr:"[-]",orya:"[-]",tamldec:"[-]",telu:"[-]",thai:"[-]",tibt:"[-]",latn:"\\d"},kv={arab:[1632,1641],arabext:[1776,1785],bali:[6992,7001],beng:[2534,2543],deva:[2406,2415],fullwide:[65296,65303],gujr:[2790,2799],khmr:[6112,6121],knda:[3302,3311],laoo:[3792,3801],limb:[6470,6479],mlym:[3430,3439],mong:[6160,6169],mymr:[4160,4169],orya:[2918,2927],tamldec:[3046,3055],telu:[3174,3183],thai:[3664,3673],tibt:[3872,3881]},gR=rO.hanidec.replace(/[\[|\]]/g,"").split("");function OR(r){let e=parseInt(r,10);if(isNaN(e)){e="";for(let t=0;t<r.length;t++){const n=r.charCodeAt(t);if(r[t].search(rO.hanidec)!==-1)e+=gR.indexOf(r[t]);else for(const i in kv){const[s,a]=kv[i];n>=s&&n<=a&&(e+=n-s)}}return parseInt(e,10)}else return e}function Zi({numberingSystem:r},e=""){return new RegExp(`${rO[r||"latn"]}${e}`)}const xR="missing Intl.DateTimeFormat.formatToParts support";function Dt(r,e=t=>t){return{regex:r,deser:([t])=>e(OR(t))}}const vR="",mk=`[ ${vR}]`,gk=new RegExp(mk,"g");function yR(r){return r.replace(/\./g,"\\.?").replace(gk,mk)}function Sv(r){return r.replace(/\./g,"").replace(gk," ").toLowerCase()}function Wi(r,e){return r===null?null:{regex:RegExp(r.map(yR).join("|")),deser:([t])=>r.findIndex(n=>Sv(t)===Sv(n))+e}}function Tv(r,e){return{regex:r,deser:([,t,n])=>c0(t,n),groups:e}}function G0(r){return{regex:r,deser:([e])=>e}}function wR(r){return r.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function bR(r,e){const t=Zi(e),n=Zi(e,"{2}"),i=Zi(e,"{3}"),s=Zi(e,"{4}"),a=Zi(e,"{6}"),o=Zi(e,"{1,2}"),l=Zi(e,"{1,3}"),f=Zi(e,"{1,6}"),c=Zi(e,"{1,9}"),h=Zi(e,"{2,4}"),u=Zi(e,"{4,6}"),d=g=>({regex:RegExp(wR(g.val)),deser:([O])=>O,literal:!0}),m=(g=>{if(r.literal)return d(g);switch(g.val){case"G":return Wi(e.eras("short",!1),0);case"GG":return Wi(e.eras("long",!1),0);case"y":return Dt(f);case"yy":return Dt(h,km);case"yyyy":return Dt(s);case"yyyyy":return Dt(u);case"yyyyyy":return Dt(a);case"M":return Dt(o);case"MM":return Dt(n);case"MMM":return Wi(e.months("short",!0,!1),1);case"MMMM":return Wi(e.months("long",!0,!1),1);case"L":return Dt(o);case"LL":return Dt(n);case"LLL":return Wi(e.months("short",!1,!1),1);case"LLLL":return Wi(e.months("long",!1,!1),1);case"d":return Dt(o);case"dd":return Dt(n);case"o":return Dt(l);case"ooo":return Dt(i);case"HH":return Dt(n);case"H":return Dt(o);case"hh":return Dt(n);case"h":return Dt(o);case"mm":return Dt(n);case"m":return Dt(o);case"q":return Dt(o);case"qq":return Dt(n);case"s":return Dt(o);case"ss":return Dt(n);case"S":return Dt(l);case"SSS":return Dt(i);case"u":return G0(c);case"uu":return G0(o);case"uuu":return Dt(t);case"a":return Wi(e.meridiems(),0);case"kkkk":return Dt(s);case"kk":return Dt(h,km);case"W":return Dt(o);case"WW":return Dt(n);case"E":case"c":return Dt(t);case"EEE":return Wi(e.weekdays("short",!1,!1),1);case"EEEE":return Wi(e.weekdays("long",!1,!1),1);case"ccc":return Wi(e.weekdays("short",!0,!1),1);case"cccc":return Wi(e.weekdays("long",!0,!1),1);case"Z":case"ZZ":return Tv(new RegExp(`([+-]${o.source})(?::(${n.source}))?`),2);case"ZZZ":return Tv(new RegExp(`([+-]${o.source})(${n.source})?`),2);case"z":return G0(/[a-z_+-/]{1,256}?/i);default:return d(g)}})(r)||{invalidReason:xR};return m.token=r,m}const _R={year:{"2-digit":"yy",numeric:"yyyyy"},month:{numeric:"M","2-digit":"MM",short:"MMM",long:"MMMM"},day:{numeric:"d","2-digit":"dd"},weekday:{short:"EEE",long:"EEEE"},dayperiod:"a",dayPeriod:"a",hour:{numeric:"h","2-digit":"hh"},minute:{numeric:"m","2-digit":"mm"},second:{numeric:"s","2-digit":"ss"}};function kR(r,e,t){const{type:n,value:i}=r;if(n==="literal")return{literal:!0,val:i};const s=t[n];let a=_R[n];if(typeof a=="object"&&(a=a[s]),a)return{literal:!1,val:a}}function SR(r){return[`^${r.map(t=>t.regex).reduce((t,n)=>`${t}(${n.source})`,"")}$`,r]}function TR(r,e,t){const n=r.match(e);if(n){const i={};let s=1;for(const a in t)if(Tl(t,a)){const o=t[a],l=o.groups?o.groups+1:1;!o.literal&&o.token&&(i[o.token.val[0]]=o.deser(n.slice(s,s+l))),s+=l}return[n,i]}else return[n,{}]}function CR(r){const e=s=>{switch(s){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":case"H":return"hour";case"d":return"day";case"o":return"ordinal";case"L":case"M":return"month";case"y":return"year";case"E":case"c":return"weekday";case"W":return"weekNumber";case"k":return"weekYear";case"q":return"quarter";default:return null}};let t=null,n;return kt(r.z)||(t=Hs.create(r.z)),kt(r.Z)||(t||(t=new Nn(r.Z)),n=r.Z),kt(r.q)||(r.M=(r.q-1)*3+1),kt(r.h)||(r.h<12&&r.a===1?r.h+=12:r.h===12&&r.a===0&&(r.h=0)),r.G===0&&r.y&&(r.y=-r.y),kt(r.u)||(r.S=G1(r.u)),[Object.keys(r).reduce((s,a)=>{const o=e(a);return o&&(s[o]=r[a]),s},{}),t,n]}let H0=null;function AR(){return H0||(H0=nt.fromMillis(1555555555555)),H0}function ER(r,e){if(r.literal)return r;const t=Gn.macroTokenToFormatOpts(r.val);if(!t)return r;const s=Gn.create(e,t).formatDateTimeParts(AR()).map(a=>kR(a,e,t));return s.includes(void 0)?r:s}function PR(r,e){return Array.prototype.concat(...r.map(t=>ER(t,e)))}function Ok(r,e,t){const n=PR(Gn.parseFormat(t),r),i=n.map(a=>bR(a,r)),s=i.find(a=>a.invalidReason);if(s)return{input:e,tokens:n,invalidReason:s.invalidReason};{const[a,o]=SR(i),l=RegExp(a,"i"),[f,c]=TR(e,l,o),[h,u,d]=c?CR(c):[null,null,void 0];if(Tl(c,"a")&&Tl(c,"H"))throw new Af("Can't include meridiem when specifying 24-hour format");return{input:e,tokens:n,regex:l,rawMatches:f,matches:c,result:h,zone:u,specificOffset:d}}}function RR(r,e,t){const{result:n,zone:i,specificOffset:s,invalidReason:a}=Ok(r,e,t);return[n,i,s,a]}const xk=[0,31,59,90,120,151,181,212,243,273,304,334],vk=[0,31,60,91,121,152,182,213,244,274,305,335];function Ai(r,e){return new Vi("unit out of range",`you specified ${e} (of type ${typeof e}) as a ${r}, which is invalid`)}function yk(r,e,t){const n=new Date(Date.UTC(r,e-1,t));r<100&&r>=0&&n.setUTCFullYear(n.getUTCFullYear()-1900);const i=n.getUTCDay();return i===0?7:i}function wk(r,e,t){return t+(ah(r)?vk:xk)[e-1]}function bk(r,e){const t=ah(r)?vk:xk,n=t.findIndex(s=>s<e),i=e-t[n];return{month:n+1,day:i}}function Em(r){const{year:e,month:t,day:n}=r,i=wk(e,t,n),s=yk(e,t,n);let a=Math.floor((i-s+10)/7),o;return a<1?(o=e-1,a=od(o)):a>od(e)?(o=e+1,a=1):o=e,{weekYear:o,weekNumber:a,weekday:s,...h0(r)}}function Cv(r){const{weekYear:e,weekNumber:t,weekday:n}=r,i=yk(e,1,4),s=Kf(e);let a=t*7+n-i-3,o;a<1?(o=e-1,a+=Kf(o)):a>s?(o=e+1,a-=Kf(e)):o=e;const{month:l,day:f}=bk(o,a);return{year:o,month:l,day:f,...h0(r)}}function Y0(r){const{year:e,month:t,day:n}=r,i=wk(e,t,n);return{year:e,ordinal:i,...h0(r)}}function Av(r){const{year:e,ordinal:t}=r,{month:n,day:i}=bk(e,t);return{year:e,month:n,day:i,...h0(r)}}function QR(r){const e=f0(r.weekYear),t=Vs(r.weekNumber,1,od(r.weekYear)),n=Vs(r.weekday,1,7);return e?t?n?!1:Ai("weekday",r.weekday):Ai("week",r.week):Ai("weekYear",r.weekYear)}function FR(r){const e=f0(r.year),t=Vs(r.ordinal,1,Kf(r.year));return e?t?!1:Ai("ordinal",r.ordinal):Ai("year",r.year)}function _k(r){const e=f0(r.year),t=Vs(r.month,1,12),n=Vs(r.day,1,ad(r.year,r.month));return e?t?n?!1:Ai("day",r.day):Ai("month",r.month):Ai("year",r.year)}function kk(r){const{hour:e,minute:t,second:n,millisecond:i}=r,s=Vs(e,0,23)||e===24&&t===0&&n===0&&i===0,a=Vs(t,0,59),o=Vs(n,0,59),l=Vs(i,0,999);return s?a?o?l?!1:Ai("millisecond",i):Ai("second",n):Ai("minute",t):Ai("hour",e)}const K0="Invalid DateTime",$R=864e13;function $h(r){return new Vi("unsupported zone",`the zone "${r.name}" is not supported`)}function J0(r){return r.weekData===null&&(r.weekData=Em(r.c)),r.weekData}function hf(r,e){const t={ts:r.ts,zone:r.zone,c:r.c,o:r.o,loc:r.loc,invalid:r.invalid};return new nt({...t,...e,old:t})}function Sk(r,e,t){let n=r-e*60*1e3;const i=t.offset(n);if(e===i)return[n,e];n-=(i-e)*60*1e3;const s=t.offset(n);return i===s?[n,i]:[r-Math.min(i,s)*60*1e3,Math.max(i,s)]}function Ev(r,e){r+=e*60*1e3;const t=new Date(r);return{year:t.getUTCFullYear(),month:t.getUTCMonth()+1,day:t.getUTCDate(),hour:t.getUTCHours(),minute:t.getUTCMinutes(),second:t.getUTCSeconds(),millisecond:t.getUTCMilliseconds()}}function Cu(r,e,t){return Sk(Y1(r),e,t)}function Pv(r,e){const t=r.o,n=r.c.year+Math.trunc(e.years),i=r.c.month+Math.trunc(e.months)+Math.trunc(e.quarters)*3,s={...r.c,year:n,month:i,day:Math.min(r.c.day,ad(n,i))+Math.trunc(e.days)+Math.trunc(e.weeks)*7},a=Tt.fromObject({years:e.years-Math.trunc(e.years),quarters:e.quarters-Math.trunc(e.quarters),months:e.months-Math.trunc(e.months),weeks:e.weeks-Math.trunc(e.weeks),days:e.days-Math.trunc(e.days),hours:e.hours,minutes:e.minutes,seconds:e.seconds,milliseconds:e.milliseconds}).as("milliseconds"),o=Y1(s);let[l,f]=Sk(o,t,r.zone);return a!==0&&(l+=a,f=r.zone.offset(l)),{ts:l,o:f}}function uf(r,e,t,n,i,s){const{setZone:a,zone:o}=t;if(r&&Object.keys(r).length!==0){const l=e||o,f=nt.fromObject(r,{...t,zone:l,specificOffset:s});return a?f:f.setZone(o)}else return nt.invalid(new Vi("unparsable",`the input "${i}" can't be parsed as ${n}`))}function Dh(r,e,t=!0){return r.isValid?Gn.create(Or.create("en-US"),{allowZ:t,forceSimple:!0}).formatDateTimeFromString(r,e):null}function ep(r,e){const t=r.c.year>9999||r.c.year<0;let n="";return t&&r.c.year>=0&&(n+="+"),n+=Lr(r.c.year,t?6:4),e?(n+="-",n+=Lr(r.c.month),n+="-",n+=Lr(r.c.day)):(n+=Lr(r.c.month),n+=Lr(r.c.day)),n}function Rv(r,e,t,n,i,s){let a=Lr(r.c.hour);return e?(a+=":",a+=Lr(r.c.minute),(r.c.second!==0||!t)&&(a+=":")):a+=Lr(r.c.minute),(r.c.second!==0||!t)&&(a+=Lr(r.c.second),(r.c.millisecond!==0||!n)&&(a+=".",a+=Lr(r.c.millisecond,3))),i&&(r.isOffsetFixed&&r.offset===0&&!s?a+="Z":r.o<0?(a+="-",a+=Lr(Math.trunc(-r.o/60)),a+=":",a+=Lr(Math.trunc(-r.o%60))):(a+="+",a+=Lr(Math.trunc(r.o/60)),a+=":",a+=Lr(Math.trunc(r.o%60)))),s&&(a+="["+r.zone.ianaName+"]"),a}const Tk={month:1,day:1,hour:0,minute:0,second:0,millisecond:0},DR={weekNumber:1,weekday:1,hour:0,minute:0,second:0,millisecond:0},NR={ordinal:1,hour:0,minute:0,second:0,millisecond:0},Ck=["year","month","day","hour","minute","second","millisecond"],MR=["weekYear","weekNumber","weekday","hour","minute","second","millisecond"],IR=["year","ordinal","hour","minute","second","millisecond"];function Qv(r){const e={year:"year",years:"year",month:"month",months:"month",day:"day",days:"day",hour:"hour",hours:"hour",minute:"minute",minutes:"minute",quarter:"quarter",quarters:"quarter",second:"second",seconds:"second",millisecond:"millisecond",milliseconds:"millisecond",weekday:"weekday",weekdays:"weekday",weeknumber:"weekNumber",weeksnumber:"weekNumber",weeknumbers:"weekNumber",weekyear:"weekYear",weekyears:"weekYear",ordinal:"ordinal"}[r.toLowerCase()];if(!e)throw new R2(r);return e}function Fv(r,e){const t=va(e.zone,Zr.defaultZone),n=Or.fromObject(e),i=Zr.now();let s,a;if(kt(r.year))s=i;else{for(const f of Ck)kt(r[f])&&(r[f]=Tk[f]);const o=_k(r)||kk(r);if(o)return nt.invalid(o);const l=t.offset(i);[s,a]=Cu(r,l,t)}return new nt({ts:s,zone:t,loc:n,o:a})}function $v(r,e,t){const n=kt(t.round)?!0:t.round,i=(a,o)=>(a=H1(a,n||t.calendary?0:2,!0),e.loc.clone(t).relFormatter(t).format(a,o)),s=a=>t.calendary?e.hasSame(r,a)?0:e.startOf(a).diff(r.startOf(a),a).get(a):e.diff(r,a).get(a);if(t.unit)return i(s(t.unit),t.unit);for(const a of t.units){const o=s(a);if(Math.abs(o)>=1)return i(o,a)}return i(r>e?-0:0,t.units[t.units.length-1])}function Dv(r){let e={},t;return r.length>0&&typeof r[r.length-1]=="object"?(e=r[r.length-1],t=Array.from(r).slice(0,r.length-1)):t=Array.from(r),[e,t]}class nt{constructor(e){const t=e.zone||Zr.defaultZone;let n=e.invalid||(Number.isNaN(e.ts)?new Vi("invalid input"):null)||(t.isValid?null:$h(t));this.ts=kt(e.ts)?Zr.now():e.ts;let i=null,s=null;if(!n)if(e.old&&e.old.ts===this.ts&&e.old.zone.equals(t))[i,s]=[e.old.c,e.old.o];else{const o=t.offset(this.ts);i=Ev(this.ts,o),n=Number.isNaN(i.year)?new Vi("invalid input"):null,i=n?null:i,s=n?null:o}this._zone=t,this.loc=e.loc||Or.create(),this.invalid=n,this.weekData=null,this.c=i,this.o=s,this.isLuxonDateTime=!0}static now(){return new nt({})}static local(){const[e,t]=Dv(arguments),[n,i,s,a,o,l,f]=t;return Fv({year:n,month:i,day:s,hour:a,minute:o,second:l,millisecond:f},e)}static utc(){const[e,t]=Dv(arguments),[n,i,s,a,o,l,f]=t;return e.zone=Nn.utcInstance,Fv({year:n,month:i,day:s,hour:a,minute:o,second:l,millisecond:f},e)}static fromJSDate(e,t={}){const n=V3(e)?e.valueOf():NaN;if(Number.isNaN(n))return nt.invalid("invalid input");const i=va(t.zone,Zr.defaultZone);return i.isValid?new nt({ts:n,zone:i,loc:Or.fromObject(t)}):nt.invalid($h(i))}static fromMillis(e,t={}){if(mo(e))return e<-864e13||e>$R?nt.invalid("Timestamp out of range"):new nt({ts:e,zone:va(t.zone,Zr.defaultZone),loc:Or.fromObject(t)});throw new Ti(`fromMillis requires a numerical input, but received a ${typeof e} with value ${e}`)}static fromSeconds(e,t={}){if(mo(e))return new nt({ts:e*1e3,zone:va(t.zone,Zr.defaultZone),loc:Or.fromObject(t)});throw new Ti("fromSeconds requires a numerical input")}static fromObject(e,t={}){e=e||{};const n=va(t.zone,Zr.defaultZone);if(!n.isValid)return nt.invalid($h(n));const i=Zr.now(),s=kt(t.specificOffset)?n.offset(i):t.specificOffset,a=ld(e,Qv),o=!kt(a.ordinal),l=!kt(a.year),f=!kt(a.month)||!kt(a.day),c=l||f,h=a.weekYear||a.weekNumber,u=Or.fromObject(t);if((c||o)&&h)throw new Af("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(f&&o)throw new Af("Can't mix ordinal dates with month/day");const d=h||a.weekday&&!c;let p,m,g=Ev(i,s);d?(p=MR,m=DR,g=Em(g)):o?(p=IR,m=NR,g=Y0(g)):(p=Ck,m=Tk);let O=!1;for(const A of p){const k=a[A];kt(k)?O?a[A]=m[A]:a[A]=g[A]:O=!0}const w=d?QR(a):o?FR(a):_k(a),v=w||kk(a);if(v)return nt.invalid(v);const S=d?Cv(a):o?Av(a):a,[y,b]=Cu(S,s,n),x=new nt({ts:y,zone:n,o:b,loc:u});return a.weekday&&c&&e.weekday!==x.weekday?nt.invalid("mismatched weekday",`you can't specify both a weekday of ${a.weekday} and a date of ${x.toISO()}`):x}static fromISO(e,t={}){const[n,i]=Y5(e);return uf(n,i,t,"ISO 8601",e)}static fromRFC2822(e,t={}){const[n,i]=K5(e);return uf(n,i,t,"RFC 2822",e)}static fromHTTP(e,t={}){const[n,i]=J5(e);return uf(n,i,t,"HTTP",t)}static fromFormat(e,t,n={}){if(kt(e)||kt(t))throw new Ti("fromFormat requires an input string and a format");const{locale:i=null,numberingSystem:s=null}=n,a=Or.fromOpts({locale:i,numberingSystem:s,defaultToEN:!0}),[o,l,f,c]=RR(a,e,t);return c?nt.invalid(c):uf(o,l,n,`format ${t}`,e,f)}static fromString(e,t,n={}){return nt.fromFormat(e,t,n)}static fromSQL(e,t={}){const[n,i]=aR(e);return uf(n,i,t,"SQL",e)}static invalid(e,t=null){if(!e)throw new Ti("need to specify a reason the DateTime is invalid");const n=e instanceof Vi?e:new Vi(e,t);if(Zr.throwOnInvalid)throw new L3(n);return new nt({invalid:n})}static isDateTime(e){return e&&e.isLuxonDateTime||!1}get(e){return this[e]}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}get outputCalendar(){return this.isValid?this.loc.outputCalendar:null}get zone(){return this._zone}get zoneName(){return this.isValid?this.zone.name:null}get year(){return this.isValid?this.c.year:NaN}get quarter(){return this.isValid?Math.ceil(this.c.month/3):NaN}get month(){return this.isValid?this.c.month:NaN}get day(){return this.isValid?this.c.day:NaN}get hour(){return this.isValid?this.c.hour:NaN}get minute(){return this.isValid?this.c.minute:NaN}get second(){return this.isValid?this.c.second:NaN}get millisecond(){return this.isValid?this.c.millisecond:NaN}get weekYear(){return this.isValid?J0(this).weekYear:NaN}get weekNumber(){return this.isValid?J0(this).weekNumber:NaN}get weekday(){return this.isValid?J0(this).weekday:NaN}get ordinal(){return this.isValid?Y0(this.c).ordinal:NaN}get monthShort(){return this.isValid?Fh.months("short",{locObj:this.loc})[this.month-1]:null}get monthLong(){return this.isValid?Fh.months("long",{locObj:this.loc})[this.month-1]:null}get weekdayShort(){return this.isValid?Fh.weekdays("short",{locObj:this.loc})[this.weekday-1]:null}get weekdayLong(){return this.isValid?Fh.weekdays("long",{locObj:this.loc})[this.weekday-1]:null}get offset(){return this.isValid?+this.o:NaN}get offsetNameShort(){return this.isValid?this.zone.offsetName(this.ts,{format:"short",locale:this.locale}):null}get offsetNameLong(){return this.isValid?this.zone.offsetName(this.ts,{format:"long",locale:this.locale}):null}get isOffsetFixed(){return this.isValid?this.zone.isUniversal:null}get isInDST(){return this.isOffsetFixed?!1:this.offset>this.set({month:1,day:1}).offset||this.offset>this.set({month:5}).offset}get isInLeapYear(){return ah(this.year)}get daysInMonth(){return ad(this.year,this.month)}get daysInYear(){return this.isValid?Kf(this.year):NaN}get weeksInWeekYear(){return this.isValid?od(this.weekYear):NaN}resolvedLocaleOptions(e={}){const{locale:t,numberingSystem:n,calendar:i}=Gn.create(this.loc.clone(e),e).resolvedOptions(this);return{locale:t,numberingSystem:n,outputCalendar:i}}toUTC(e=0,t={}){return this.setZone(Nn.instance(e),t)}toLocal(){return this.setZone(Zr.defaultZone)}setZone(e,{keepLocalTime:t=!1,keepCalendarTime:n=!1}={}){if(e=va(e,Zr.defaultZone),e.equals(this.zone))return this;if(e.isValid){let i=this.ts;if(t||n){const s=e.offset(this.ts),a=this.toObject();[i]=Cu(a,s,e)}return hf(this,{ts:i,zone:e})}else return nt.invalid($h(e))}reconfigure({locale:e,numberingSystem:t,outputCalendar:n}={}){const i=this.loc.clone({locale:e,numberingSystem:t,outputCalendar:n});return hf(this,{loc:i})}setLocale(e){return this.reconfigure({locale:e})}set(e){if(!this.isValid)return this;const t=ld(e,Qv),n=!kt(t.weekYear)||!kt(t.weekNumber)||!kt(t.weekday),i=!kt(t.ordinal),s=!kt(t.year),a=!kt(t.month)||!kt(t.day),o=s||a,l=t.weekYear||t.weekNumber;if((o||i)&&l)throw new Af("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(a&&i)throw new Af("Can't mix ordinal dates with month/day");let f;n?f=Cv({...Em(this.c),...t}):kt(t.ordinal)?(f={...this.toObject(),...t},kt(t.day)&&(f.day=Math.min(ad(f.year,f.month),f.day))):f=Av({...Y0(this.c),...t});const[c,h]=Cu(f,this.o,this.zone);return hf(this,{ts:c,o:h})}plus(e){if(!this.isValid)return this;const t=Tt.fromDurationLike(e);return hf(this,Pv(this,t))}minus(e){if(!this.isValid)return this;const t=Tt.fromDurationLike(e).negate();return hf(this,Pv(this,t))}startOf(e){if(!this.isValid)return this;const t={},n=Tt.normalizeUnit(e);switch(n){case"years":t.month=1;case"quarters":case"months":t.day=1;case"weeks":case"days":t.hour=0;case"hours":t.minute=0;case"minutes":t.second=0;case"seconds":t.millisecond=0;break}if(n==="weeks"&&(t.weekday=1),n==="quarters"){const i=Math.ceil(this.month/3);t.month=(i-1)*3+1}return this.set(t)}endOf(e){return this.isValid?this.plus({[e]:1}).startOf(e).minus(1):this}toFormat(e,t={}){return this.isValid?Gn.create(this.loc.redefaultToEN(t)).formatDateTimeFromString(this,e):K0}toLocaleString(e=_m,t={}){return this.isValid?Gn.create(this.loc.clone(t),e).formatDateTime(this):K0}toLocaleParts(e={}){return this.isValid?Gn.create(this.loc.clone(e),e).formatDateTimeParts(this):[]}toISO({format:e="extended",suppressSeconds:t=!1,suppressMilliseconds:n=!1,includeOffset:i=!0,extendedZone:s=!1}={}){if(!this.isValid)return null;const a=e==="extended";let o=ep(this,a);return o+="T",o+=Rv(this,a,t,n,i,s),o}toISODate({format:e="extended"}={}){return this.isValid?ep(this,e==="extended"):null}toISOWeekDate(){return Dh(this,"kkkk-'W'WW-c")}toISOTime({suppressMilliseconds:e=!1,suppressSeconds:t=!1,includeOffset:n=!0,includePrefix:i=!1,extendedZone:s=!1,format:a="extended"}={}){return this.isValid?(i?"T":"")+Rv(this,a==="extended",t,e,n,s):null}toRFC2822(){return Dh(this,"EEE, dd LLL yyyy HH:mm:ss ZZZ",!1)}toHTTP(){return Dh(this.toUTC(),"EEE, dd LLL yyyy HH:mm:ss 'GMT'")}toSQLDate(){return this.isValid?ep(this,!0):null}toSQLTime({includeOffset:e=!0,includeZone:t=!1,includeOffsetSpace:n=!0}={}){let i="HH:mm:ss.SSS";return(t||e)&&(n&&(i+=" "),t?i+="z":e&&(i+="ZZ")),Dh(this,i,!0)}toSQL(e={}){return this.isValid?`${this.toSQLDate()} ${this.toSQLTime(e)}`:null}toString(){return this.isValid?this.toISO():K0}valueOf(){return this.toMillis()}toMillis(){return this.isValid?this.ts:NaN}toSeconds(){return this.isValid?this.ts/1e3:NaN}toUnixInteger(){return this.isValid?Math.floor(this.ts/1e3):NaN}toJSON(){return this.toISO()}toBSON(){return this.toJSDate()}toObject(e={}){if(!this.isValid)return{};const t={...this.c};return e.includeConfig&&(t.outputCalendar=this.outputCalendar,t.numberingSystem=this.loc.numberingSystem,t.locale=this.loc.locale),t}toJSDate(){return new Date(this.isValid?this.ts:NaN)}diff(e,t="milliseconds",n={}){if(!this.isValid||!e.isValid)return Tt.invalid("created by diffing an invalid DateTime");const i={locale:this.locale,numberingSystem:this.numberingSystem,...n},s=q3(t).map(Tt.normalizeUnit),a=e.valueOf()>this.valueOf(),o=a?this:e,l=a?e:this,f=mR(o,l,s,i);return a?f.negate():f}diffNow(e="milliseconds",t={}){return this.diff(nt.now(),e,t)}until(e){return this.isValid?wr.fromDateTimes(this,e):this}hasSame(e,t){if(!this.isValid)return!1;const n=e.valueOf(),i=this.setZone(e.zone,{keepLocalTime:!0});return i.startOf(t)<=n&&n<=i.endOf(t)}equals(e){return this.isValid&&e.isValid&&this.valueOf()===e.valueOf()&&this.zone.equals(e.zone)&&this.loc.equals(e.loc)}toRelative(e={}){if(!this.isValid)return null;const t=e.base||nt.fromObject({},{zone:this.zone}),n=e.padding?this<t?-e.padding:e.padding:0;let i=["years","months","days","hours","minutes","seconds"],s=e.unit;return Array.isArray(e.unit)&&(i=e.unit,s=void 0),$v(t,this.plus(n),{...e,numeric:"always",units:i,unit:s})}toRelativeCalendar(e={}){return this.isValid?$v(e.base||nt.fromObject({},{zone:this.zone}),this,{...e,numeric:"auto",units:["years","months","days"],calendary:!0}):null}static min(...e){if(!e.every(nt.isDateTime))throw new Ti("min requires all arguments be DateTimes");return dv(e,t=>t.valueOf(),Math.min)}static max(...e){if(!e.every(nt.isDateTime))throw new Ti("max requires all arguments be DateTimes");return dv(e,t=>t.valueOf(),Math.max)}static fromFormatExplain(e,t,n={}){const{locale:i=null,numberingSystem:s=null}=n,a=Or.fromOpts({locale:i,numberingSystem:s,defaultToEN:!0});return Ok(a,e,t)}static fromStringExplain(e,t,n={}){return nt.fromFormatExplain(e,t,n)}static get DATE_SHORT(){return _m}static get DATE_MED(){return Q2}static get DATE_MED_WITH_WEEKDAY(){return W3}static get DATE_FULL(){return F2}static get DATE_HUGE(){return $2}static get TIME_SIMPLE(){return D2}static get TIME_WITH_SECONDS(){return N2}static get TIME_WITH_SHORT_OFFSET(){return M2}static get TIME_WITH_LONG_OFFSET(){return I2}static get TIME_24_SIMPLE(){return L2}static get TIME_24_WITH_SECONDS(){return B2}static get TIME_24_WITH_SHORT_OFFSET(){return Z2}static get TIME_24_WITH_LONG_OFFSET(){return W2}static get DATETIME_SHORT(){return U2}static get DATETIME_SHORT_WITH_SECONDS(){return X2}static get DATETIME_MED(){return V2}static get DATETIME_MED_WITH_SECONDS(){return q2}static get DATETIME_MED_WITH_WEEKDAY(){return U3}static get DATETIME_FULL(){return j2}static get DATETIME_FULL_WITH_SECONDS(){return z2}static get DATETIME_HUGE(){return G2}static get DATETIME_HUGE_WITH_SECONDS(){return H2}}function df(r){if(nt.isDateTime(r))return r;if(r&&r.valueOf&&mo(r.valueOf()))return nt.fromJSDate(r);if(r&&typeof r=="object")return nt.fromObject(r);throw new Ti(`Unknown datetime argument: ${r}, of type ${typeof r}`)}var LR=J('<span class="icon-text"><span class="icon"><i class="fas fa-exclamation-triangle"></i></span> <span> </span></span>'),BR=J("<td><!></td>");function ZR(r,e){gt(e,!0);let t=ge(e,"onclick_cell",3,()=>{}),n=ge(e,"format",3,"yyyy-MM-dd HH:mm:ss"),i=ge(e,"fromFormat",3,"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'"),s=ge(e,"HighlightIsntToday",3,!1);ge(e,"editInline",3,!1),ge(e,"css_cell",3,"");let a=kl(()=>s()&&nt.fromISO(e.value).toFormat("yyyy-MM-dd")!==nt.local().toFormat("yyyy-MM-dd")),o=kl(l);function l(){try{return nt.fromFormat(e.value,i()).toLocal().toFormat(n())}catch{return""}}var f=BR();f.__click=function(...d){var p;(p=t())==null||p.apply(this,d)};var c=Q(f);{var h=d=>{var p=LR(),m=ne(Q(p),2),g=Q(m,!0);R(m),R(p),Me(()=>Ge(g,e.value)),U(d,p)},u=d=>{var p=vs();Me(()=>Ge(p,C(o))),U(d,p)};ce(c,d=>{C(a)?d(h):d(u,!1)})}R(f),Me(()=>S2(f,"has-text-danger",C(a))),U(r,f),Ot()}vr(["click"]);var WR=J('<li class="svelte-1p0q13"><!></li>'),UR=J('<li class="svelte-1p0q13"><!></li>'),XR=J('<ul class="svelte-1p0q13"><!></ul>'),VR=J("<details><summary><b> </b> </summary> <!></details>"),qR=J('<li style="list-style: disc; margin: 0.2em 0 0 1em;" class="svelte-1p0q13"><b> </b> </li>');function Pm(r,e){let t=ge(e,"key",3,"");var n=Ee(),i=be(n);{var s=o=>{var l=VR(),f=Q(l),c=Q(f),h=Q(c,!0);R(c);var u=ne(c);Me(()=>Ge(u,` ${(typeof e.value!="object"||e.value===null?String(e.value):"")??""}`)),R(f);var d=ne(f,2);{var p=g=>{var O=XR(),w=Q(O);{var v=y=>{var b=Ee(),x=be(b);_r(x,17,()=>e.value,Qr,(A,k,E)=>{var T=WR(),_=Q(T);Pm(_,{key:`[${E}]`,get value(){return C(k)}}),R(T),U(A,T)}),U(y,b)},S=y=>{var b=Ee(),x=be(b);_r(x,17,()=>Object.entries(e.value),Qr,(A,k)=>{let E=()=>C(k)[0],T=()=>C(k)[1];var _=UR(),N=Q(_);Pm(N,{get key(){return E()},get value(){return T()}}),R(_),U(A,_)}),U(y,b)};ce(w,y=>{Array.isArray(e.value)?y(v):y(S,!1)})}R(O),U(g,O)},m=g=>{var O=vs("hhhh");U(g,O)};ce(d,g=>{typeof e.value=="object"&&e.value!==null?g(p):g(m,!1)})}R(l),Me(()=>Ge(h,t())),U(o,l)},a=o=>{var l=qR(),f=Q(l),c=Q(f);R(f);var h=ne(f);R(l),Me(()=>{Ge(c,`${t()??""}:`),Ge(h,` ${e.value??""}`)}),U(o,l)};ce(i,o=>{typeof e.value=="object"&&e.value!==null?o(s):o(a,!1)})}U(r,n)}var jR=J('<td><details class="left_space"><summary><b>root</b></summary> <ul class="svelte-il86sa"></ul></details></td>');function zR(r,e){let t=ge(e,"onclick_cell",3,()=>{}),n=ge(e,"css_cell",3,"");var i=jR();i.__click=function(...o){var l;(l=t())==null||l.apply(this,o)};var s=Q(i),a=ne(Q(s),2);_r(a,21,()=>Object.entries(e.value),Qr,(o,l)=>{let f=()=>C(l)[0],c=()=>C(l)[1];Pm(o,{get key(){return f()},get value(){return c()}})}),R(a),R(s),R(i),Me(()=>ht(i,Qi(n()),"svelte-il86sa")),U(r,i)}vr(["click"]);var GR=J('<input class="input is-small" type="number" placeholder="Input">'),HR=J('<div class="text_end svelte-1ea09en"> </div>'),YR=J("<td><!></td>"),KR=J('<input class="input is-small" type="text" placeholder="Input">'),JR=J("<div> </div>"),eQ=J("<td><!></td>"),tQ=J("<td><span> </span></td>");function Rm(r,e){let t=ge(e,"value",15),n=ge(e,"row",15),i=ge(e,"editInline",3,!1);var s=Ee(),a=be(s);{var o=f=>{zR(f,{get value(){return t()},get editInline(){return i()},get css_cell(){return e.css_cell}})},l=f=>{var c=Ee(),h=be(c);{var u=p=>{mc(p,{get editInline(){return i()},get css_cell(){return e.css_cell},get value(){return t()},set value(m){t(m)},get row(){return n()},set row(m){n(m)}})},d=p=>{var m=Ee(),g=be(m);{var O=v=>{var S=YR();S.__click=function(...A){var k;(k=e.onclickcell)==null||k.apply(this,A)};var y=Q(S);{var b=A=>{var k=GR();wt(k),Jt(k,t),U(A,k)},x=A=>{var k=HR(),E=Q(k,!0);R(k),Me(()=>Ge(E,t())),U(A,k)};ce(y,A=>{i()?A(b):A(x,!1)})}R(S),U(v,S)},w=v=>{var S=Ee(),y=be(S);{var b=A=>{var k=eQ();k.__click=function(...N){var Z;(Z=e.onclickcell)==null||Z.apply(this,N)};var E=Q(k);{var T=N=>{var Z=KR();wt(Z),Jt(Z,t),U(N,Z)},_=N=>{var Z=JR(),z=Q(Z,!0);R(Z),Me(()=>Ge(z,t())),U(N,Z)};ce(E,N=>{i()?N(T):N(_,!1)})}R(k),U(A,k)},x=A=>{var k=tQ();k.__click=function(..._){var N;(N=e.onclickcell)==null||N.apply(this,_)};var E=Q(k),T=Q(E,!0);Me(()=>Ge(T,JSON.stringify(t()))),R(E),R(k),U(A,k)};ce(y,A=>{typeof t()=="string"?A(b):A(x,!1)},!0)}U(v,S)};ce(g,v=>{typeof t()=="number"||typeof t()=="bigint"?v(O):v(w,!1)},!0)}U(p,m)};ce(h,p=>{typeof t()=="boolean"?p(u):p(d,!1)},!0)}U(f,c)};ce(a,f=>{t()&&(typeof t()=="object"||Array.isArray(t()))?f(o):f(l,!1)})}U(r,s)}vr(["click"]);var Ak={exports:{}},ul=typeof Reflect=="object"?Reflect:null,Nv=ul&&typeof ul.apply=="function"?ul.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)},Au;ul&&typeof ul.ownKeys=="function"?Au=ul.ownKeys:Object.getOwnPropertySymbols?Au=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Au=function(e){return Object.getOwnPropertyNames(e)};function rQ(r){console&&console.warn&&console.warn(r)}var Ek=Number.isNaN||function(e){return e!==e};function Wt(){Wt.init.call(this)}Ak.exports=Wt;Ak.exports.once=aQ;Wt.EventEmitter=Wt;Wt.prototype._events=void 0;Wt.prototype._eventsCount=0;Wt.prototype._maxListeners=void 0;var Mv=10;function u0(r){if(typeof r!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof r)}Object.defineProperty(Wt,"defaultMaxListeners",{enumerable:!0,get:function(){return Mv},set:function(r){if(typeof r!="number"||r<0||Ek(r))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+r+".");Mv=r}});Wt.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Wt.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||Ek(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function Pk(r){return r._maxListeners===void 0?Wt.defaultMaxListeners:r._maxListeners}Wt.prototype.getMaxListeners=function(){return Pk(this)};Wt.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var i=e==="error",s=this._events;if(s!==void 0)i=i&&s.error===void 0;else if(!i)return!1;if(i){var a;if(t.length>0&&(a=t[0]),a instanceof Error)throw a;var o=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw o.context=a,o}var l=s[e];if(l===void 0)return!1;if(typeof l=="function")Nv(l,this,t);else for(var f=l.length,c=Dk(l,f),n=0;n<f;++n)Nv(c[n],this,t);return!0};function Rk(r,e,t,n){var i,s,a;if(u0(t),s=r._events,s===void 0?(s=r._events=Object.create(null),r._eventsCount=0):(s.newListener!==void 0&&(r.emit("newListener",e,t.listener?t.listener:t),s=r._events),a=s[e]),a===void 0)a=s[e]=t,++r._eventsCount;else if(typeof a=="function"?a=s[e]=n?[t,a]:[a,t]:n?a.unshift(t):a.push(t),i=Pk(r),i>0&&a.length>i&&!a.warned){a.warned=!0;var o=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");o.name="MaxListenersExceededWarning",o.emitter=r,o.type=e,o.count=a.length,rQ(o)}return r}Wt.prototype.addListener=function(e,t){return Rk(this,e,t,!1)};Wt.prototype.on=Wt.prototype.addListener;Wt.prototype.prependListener=function(e,t){return Rk(this,e,t,!0)};function nQ(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Qk(r,e,t){var n={fired:!1,wrapFn:void 0,target:r,type:e,listener:t},i=nQ.bind(n);return i.listener=t,n.wrapFn=i,i}Wt.prototype.once=function(e,t){return u0(t),this.on(e,Qk(this,e,t)),this};Wt.prototype.prependOnceListener=function(e,t){return u0(t),this.prependListener(e,Qk(this,e,t)),this};Wt.prototype.removeListener=function(e,t){var n,i,s,a,o;if(u0(t),i=this._events,i===void 0)return this;if(n=i[e],n===void 0)return this;if(n===t||n.listener===t)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||t));else if(typeof n!="function"){for(s=-1,a=n.length-1;a>=0;a--)if(n[a]===t||n[a].listener===t){o=n[a].listener,s=a;break}if(s<0)return this;s===0?n.shift():iQ(n,s),n.length===1&&(i[e]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",e,o||t)}return this};Wt.prototype.off=Wt.prototype.removeListener;Wt.prototype.removeAllListeners=function(e){var t,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var s=Object.keys(n),a;for(i=0;i<s.length;++i)a=s[i],a!=="removeListener"&&this.removeAllListeners(a);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=n[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this};function Fk(r,e,t){var n=r._events;if(n===void 0)return[];var i=n[e];return i===void 0?[]:typeof i=="function"?t?[i.listener||i]:[i]:t?sQ(i):Dk(i,i.length)}Wt.prototype.listeners=function(e){return Fk(this,e,!0)};Wt.prototype.rawListeners=function(e){return Fk(this,e,!1)};Wt.listenerCount=function(r,e){return typeof r.listenerCount=="function"?r.listenerCount(e):$k.call(r,e)};Wt.prototype.listenerCount=$k;function $k(r){var e=this._events;if(e!==void 0){var t=e[r];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}Wt.prototype.eventNames=function(){return this._eventsCount>0?Au(this._events):[]};function Dk(r,e){for(var t=new Array(e),n=0;n<e;++n)t[n]=r[n];return t}function iQ(r,e){for(;e+1<r.length;e++)r[e]=r[e+1];r.pop()}function sQ(r){for(var e=new Array(r.length),t=0;t<e.length;++t)e[t]=r[t].listener||r[t];return e}function aQ(r,e){return new Promise(function(t,n){function i(a){r.removeListener(e,s),n(a)}function s(){typeof r.removeListener=="function"&&r.removeListener("error",i),t([].slice.call(arguments))}Nk(r,e,s,{once:!0}),e!=="error"&&oQ(r,i,{once:!0})})}function oQ(r,e,t){typeof r.on=="function"&&Nk(r,"error",e,t)}function Nk(r,e,t,n){if(typeof r.on=="function")n.once?r.once(e,t):r.on(e,t);else if(typeof r.addEventListener=="function")r.addEventListener(e,function i(s){n.once&&r.removeEventListener(e,i),t(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof r)}const lQ=ss({});var fQ=J('<span class="slot_padding svelte-mjwhk5"><!></span>'),cQ=J('<span class="slot_padding svelte-mjwhk5"><!></span>'),hQ=J(`<nav class="nav_margin svelte-mjwhk5"><div class="columns is-multiline is-mobile"><div class="column is-full-mobile
    is-half-tablet
    is-half-desktop
    is-half-widescreen
    is-half-fullhd"><div class="container_left svelte-mjwhk5"><!></div></div> <div class="column is-full-mobile
    is-half-tablet
    is-half-desktop
    is-half-widescreen
    is-half-fullhd"><div class="container_right svelte-mjwhk5"><!></div></div></div></nav>`);function Cl(r,e){var t=hQ(),n=Q(t),i=Q(n),s=Q(i),a=Q(s);{var o=u=>{var d=Ee(),p=be(d);_r(p,17,()=>e.left,Qr,(m,g)=>{var O=fQ(),w=Q(O);pc(w,()=>C(g)??dc),R(O),U(m,O)}),U(u,d)};ce(a,u=>{Array.isArray(e.left)&&u(o)})}R(s),R(i);var l=ne(i,2),f=Q(l),c=Q(f);{var h=u=>{var d=Ee(),p=be(d);_r(p,17,()=>e.right,Qr,(m,g)=>{var O=cQ(),w=Q(O);pc(w,()=>C(g)??dc),R(O),U(m,O)}),U(u,d)};ce(c,u=>{Array.isArray(e.right)&&u(h)})}R(f),R(l),R(n),R(t),U(r,t)}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var gc={};gc.version="0.18.5";var mi=1200,ko=1252,uQ=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],nO={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},d0=function(r){uQ.indexOf(r)!=-1&&(ko=nO[0]=r)};function dQ(){d0(1252)}var Ei=function(r){mi=r,d0(r)};function p0(){Ei(1200),dQ()}function fd(r){for(var e=[],t=0,n=r.length;t<n;++t)e[t]=r.charCodeAt(t);return e}function pQ(r){for(var e=[],t=0;t<r.length>>1;++t)e[t]=String.fromCharCode(r.charCodeAt(2*t)+(r.charCodeAt(2*t+1)<<8));return e.join("")}function Mk(r){for(var e=[],t=0;t<r.length>>1;++t)e[t]=String.fromCharCode(r.charCodeAt(2*t+1)+(r.charCodeAt(2*t)<<8));return e.join("")}var nl=function(r){var e=r.charCodeAt(0),t=r.charCodeAt(1);return e==255&&t==254?pQ(r.slice(2)):e==254&&t==255?Mk(r.slice(2)):e==65279?r.slice(1):r},Pf=function(e){return String.fromCharCode(e)},Qm=function(e){return String.fromCharCode(e)},St;function mQ(r){St=r,Ei=function(e){mi=e,d0(e)},nl=function(e){return e.charCodeAt(0)===255&&e.charCodeAt(1)===254?St.utils.decode(1200,fd(e.slice(2))):e},Pf=function(t){return mi===1200?String.fromCharCode(t):St.utils.decode(mi,[t&255,t>>8])[0]},Qm=function(t){return St.utils.decode(ko,[t])[0]},uS()}var wa="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Oc(r){for(var e="",t=0,n=0,i=0,s=0,a=0,o=0,l=0,f=0;f<r.length;)t=r.charCodeAt(f++),s=t>>2,n=r.charCodeAt(f++),a=(t&3)<<4|n>>4,i=r.charCodeAt(f++),o=(n&15)<<2|i>>6,l=i&63,isNaN(n)?o=l=64:isNaN(i)&&(l=64),e+=wa.charAt(s)+wa.charAt(a)+wa.charAt(o)+wa.charAt(l);return e}function gi(r){var e="",t=0,n=0,i=0,s=0,a=0,o=0,l=0;r=r.replace(/[^\w\+\/\=]/g,"");for(var f=0;f<r.length;)s=wa.indexOf(r.charAt(f++)),a=wa.indexOf(r.charAt(f++)),t=s<<2|a>>4,e+=String.fromCharCode(t),o=wa.indexOf(r.charAt(f++)),n=(a&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(n)),l=wa.indexOf(r.charAt(f++)),i=(o&3)<<6|l,l!==64&&(e+=String.fromCharCode(i));return e}var dt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),na=function(){if(typeof Buffer<"u"){var r=!Buffer.from;if(!r)try{Buffer.from("foo","utf8")}catch{r=!0}return r?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function Ra(r){return dt?Buffer.alloc?Buffer.alloc(r):new Buffer(r):typeof Uint8Array<"u"?new Uint8Array(r):new Array(r)}function Iv(r){return dt?Buffer.allocUnsafe?Buffer.allocUnsafe(r):new Buffer(r):typeof Uint8Array<"u"?new Uint8Array(r):new Array(r)}var oi=function(e){return dt?na(e,"binary"):e.split("").map(function(t){return t.charCodeAt(0)&255})};function ch(r){if(typeof ArrayBuffer>"u")return oi(r);for(var e=new ArrayBuffer(r.length),t=new Uint8Array(e),n=0;n!=r.length;++n)t[n]=r.charCodeAt(n)&255;return e}function Xa(r){if(Array.isArray(r))return r.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],t=0;t<r.length;++t)e[t]=String.fromCharCode(r[t]);return e.join("")}function gQ(r){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(r)}function iO(r){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(r instanceof ArrayBuffer)return iO(new Uint8Array(r));for(var e=new Array(r.length),t=0;t<r.length;++t)e[t]=r[t];return e}var Kr=dt?function(r){return Buffer.concat(r.map(function(e){return Buffer.isBuffer(e)?e:na(e)}))}:function(r){if(typeof Uint8Array<"u"){var e=0,t=0;for(e=0;e<r.length;++e)t+=r[e].length;var n=new Uint8Array(t),i=0;for(e=0,t=0;e<r.length;t+=i,++e)if(i=r[e].length,r[e]instanceof Uint8Array)n.set(r[e],t);else{if(typeof r[e]=="string")throw"wtf";n.set(new Uint8Array(r[e]),t)}return n}return[].concat.apply([],r.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function OQ(r){for(var e=[],t=0,n=r.length+250,i=Ra(r.length+255),s=0;s<r.length;++s){var a=r.charCodeAt(s);if(a<128)i[t++]=a;else if(a<2048)i[t++]=192|a>>6&31,i[t++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=r.charCodeAt(++s)&1023;i[t++]=240|a>>8&7,i[t++]=128|a>>2&63,i[t++]=128|o>>6&15|(a&3)<<4,i[t++]=128|o&63}else i[t++]=224|a>>12&15,i[t++]=128|a>>6&63,i[t++]=128|a&63;t>n&&(e.push(i.slice(0,t)),t=0,i=Ra(65535),n=65530)}return e.push(i.slice(0,t)),Kr(e)}var Sn=/\u0000/g,Rf=/[\u0001-\u0006]/g;function dl(r){for(var e="",t=r.length-1;t>=0;)e+=r.charAt(t--);return e}function qi(r,e){var t=""+r;return t.length>=e?t:br("0",e-t.length)+t}function sO(r,e){var t=""+r;return t.length>=e?t:br(" ",e-t.length)+t}function cd(r,e){var t=""+r;return t.length>=e?t:t+br(" ",e-t.length)}function xQ(r,e){var t=""+Math.round(r);return t.length>=e?t:br("0",e-t.length)+t}function vQ(r,e){var t=""+r;return t.length>=e?t:br("0",e-t.length)+t}var Lv=Math.pow(2,32);function zo(r,e){if(r>Lv||r<-Lv)return xQ(r,e);var t=Math.round(r);return vQ(t,e)}function hd(r,e){return e=e||0,r.length>=7+e&&(r.charCodeAt(e)|32)===103&&(r.charCodeAt(e+1)|32)===101&&(r.charCodeAt(e+2)|32)===110&&(r.charCodeAt(e+3)|32)===101&&(r.charCodeAt(e+4)|32)===114&&(r.charCodeAt(e+5)|32)===97&&(r.charCodeAt(e+6)|32)===108}var Bv=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],tp=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function yQ(r){return r||(r={}),r[0]="General",r[1]="0",r[2]="0.00",r[3]="#,##0",r[4]="#,##0.00",r[9]="0%",r[10]="0.00%",r[11]="0.00E+00",r[12]="# ?/?",r[13]="# ??/??",r[14]="m/d/yy",r[15]="d-mmm-yy",r[16]="d-mmm",r[17]="mmm-yy",r[18]="h:mm AM/PM",r[19]="h:mm:ss AM/PM",r[20]="h:mm",r[21]="h:mm:ss",r[22]="m/d/yy h:mm",r[37]="#,##0 ;(#,##0)",r[38]="#,##0 ;[Red](#,##0)",r[39]="#,##0.00;(#,##0.00)",r[40]="#,##0.00;[Red](#,##0.00)",r[45]="mm:ss",r[46]="[h]:mm:ss",r[47]="mmss.0",r[48]="##0.0E+0",r[49]="@",r[56]='"/ "hh""mm""ss" "',r}var Ke={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Zv={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},wQ={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function ud(r,e,t){for(var n=r<0?-1:1,i=r*n,s=0,a=1,o=0,l=1,f=0,c=0,h=Math.floor(i);f<e&&(h=Math.floor(i),o=h*a+s,c=h*f+l,!(i-h<5e-8));)i=1/(i-h),s=a,a=o,l=f,f=c;if(c>e&&(f>e?(c=l,o=s):(c=f,o=a)),!t)return[0,n*o,c];var u=Math.floor(n*o/c);return[u,n*o-u*c,c]}function ba(r,e,t){if(r>2958465||r<0)return null;var n=r|0,i=Math.floor(86400*(r-n)),s=0,a=[],o={D:n,T:i,u:86400*(r-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++n,++o.D)),n===60)a=t?[1317,10,29]:[1900,2,29],s=3;else if(n===0)a=t?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),a=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),n<60&&(s=(s+6)%7),t&&(s=CQ(l,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=s,o}var Ik=new Date(1899,11,31,0,0,0),bQ=Ik.getTime(),_Q=new Date(1900,2,1,0,0,0);function Lk(r,e){var t=r.getTime();return e?t-=1461*24*60*60*1e3:r>=_Q&&(t+=24*60*60*1e3),(t-(bQ+(r.getTimezoneOffset()-Ik.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function aO(r){return r.indexOf(".")==-1?r:r.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function kQ(r){return r.indexOf("E")==-1?r:r.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function SQ(r){var e=r<0?12:11,t=aO(r.toFixed(12));return t.length<=e||(t=r.toPrecision(10),t.length<=e)?t:r.toExponential(5)}function TQ(r){var e=aO(r.toFixed(11));return e.length>(r<0?12:11)||e==="0"||e==="-0"?r.toPrecision(6):e}function xc(r){var e=Math.floor(Math.log(Math.abs(r))*Math.LOG10E),t;return e>=-4&&e<=-1?t=r.toPrecision(10+e):Math.abs(e)<=9?t=SQ(r):e===10?t=r.toFixed(10).substr(0,12):t=TQ(r),aO(kQ(t.toUpperCase()))}function So(r,e){switch(typeof r){case"string":return r;case"boolean":return r?"TRUE":"FALSE";case"number":return(r|0)===r?r.toString(10):xc(r);case"undefined":return"";case"object":if(r==null)return"";if(r instanceof Date)return Oi(14,Lk(r,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+r)}function CQ(r,e){e[0]-=581;var t=r.getDay();return r<60&&(t=(t+6)%7),t}function AQ(r,e,t,n){var i="",s=0,a=0,o=t.y,l,f=0;switch(r){case 98:o=t.y+543;case 121:switch(e.length){case 1:case 2:l=o%100,f=2;break;default:l=o%1e4,f=4;break}break;case 109:switch(e.length){case 1:case 2:l=t.m,f=e.length;break;case 3:return tp[t.m-1][1];case 5:return tp[t.m-1][0];default:return tp[t.m-1][2]}break;case 100:switch(e.length){case 1:case 2:l=t.d,f=e.length;break;case 3:return Bv[t.q][0];default:return Bv[t.q][1]}break;case 104:switch(e.length){case 1:case 2:l=1+(t.H+11)%12,f=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:l=t.H,f=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:l=t.M,f=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return t.u===0&&(e=="s"||e=="ss")?qi(t.S,e.length):(n>=2?a=n===3?1e3:100:a=n===1?10:1,s=Math.round(a*(t.S+t.u)),s>=60*a&&(s=0),e==="s"?s===0?"0":""+s/a:(i=qi(s,2+n),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":l=t.D*24+t.H;break;case"[m]":case"[mm]":l=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":l=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+e}f=e.length===3?1:2;break;case 101:l=o,f=1;break}var c=f>0?qi(l,f):"";return c}function _a(r){var e=3;if(r.length<=e)return r;for(var t=r.length%e,n=r.substr(0,t);t!=r.length;t+=e)n+=(n.length>0?",":"")+r.substr(t,e);return n}var Bk=/%/g;function EQ(r,e,t){var n=e.replace(Bk,""),i=e.length-n.length;return js(r,n,t*Math.pow(10,2*i))+br("%",i)}function PQ(r,e,t){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return js(r,e.substr(0,n),t/Math.pow(10,3*(e.length-n)))}function Zk(r,e){var t,n=r.indexOf("E")-r.indexOf(".")-1;if(r.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+Zk(r,-e);var i=r.indexOf(".");i===-1&&(i=r.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),t=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),t.indexOf("e")===-1){var a=Math.floor(Math.log(e)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(a-t.length+s):t+="E+"+(a-s);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,i)+"."+t.substr(2+i),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,f,c){return l+f+c.substr(0,(i+s)%i)+"."+c.substr(s)+"E"})}else t=e.toExponential(n);return r.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),r.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var Wk=/# (\?+)( ?)\/( ?)(\d+)/;function RQ(r,e,t){var n=parseInt(r[4],10),i=Math.round(e*n),s=Math.floor(i/n),a=i-s*n,o=n;return t+(s===0?"":""+s)+" "+(a===0?br(" ",r[1].length+1+r[4].length):sO(a,r[1].length)+r[2]+"/"+r[3]+qi(o,r[4].length))}function QQ(r,e,t){return t+(e===0?"":""+e)+br(" ",r[1].length+2+r[4].length)}var Uk=/^#*0*\.([0#]+)/,Xk=/\).*[0#]/,Vk=/\(###\) ###\\?-####/;function Fn(r){for(var e="",t,n=0;n!=r.length;++n)switch(t=r.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(t)}return e}function Wv(r,e){var t=Math.pow(10,e);return""+Math.round(r*t)/t}function Uv(r,e){var t=r-Math.floor(r),n=Math.pow(10,e);return e<(""+Math.round(t*n)).length?0:Math.round(t*n)}function FQ(r,e){return e<(""+Math.round((r-Math.floor(r))*Math.pow(10,e))).length?1:0}function $Q(r){return r<2147483647&&r>-2147483648?""+(r>=0?r|0:r-1|0):""+Math.floor(r)}function wi(r,e,t){if(r.charCodeAt(0)===40&&!e.match(Xk)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?wi("n",n,t):"("+wi("n",n,-t)+")"}if(e.charCodeAt(e.length-1)===44)return PQ(r,e,t);if(e.indexOf("%")!==-1)return EQ(r,e,t);if(e.indexOf("E")!==-1)return Zk(e,t);if(e.charCodeAt(0)===36)return"$"+wi(r,e.substr(e.charAt(1)==" "?2:1),t);var i,s,a,o,l=Math.abs(t),f=t<0?"-":"";if(e.match(/^00+$/))return f+zo(l,e.length);if(e.match(/^[#?]+$/))return i=zo(t,0),i==="0"&&(i=""),i.length>e.length?i:Fn(e.substr(0,e.length-i.length))+i;if(s=e.match(Wk))return RQ(s,l,f);if(e.match(/^#+0+$/))return f+zo(l,e.length-e.indexOf("0"));if(s=e.match(Uk))return i=Wv(t,s[1].length).replace(/^([^\.]+)$/,"$1."+Fn(s[1])).replace(/\.$/,"."+Fn(s[1])).replace(/\.(\d*)$/,function(p,m){return"."+m+br("0",Fn(s[1]).length-m.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return f+Wv(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return f+_a(zo(l,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+wi(r,e,-t):_a(""+(Math.floor(t)+FQ(t,s[1].length)))+"."+qi(Uv(t,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return wi(r,e.replace(/^#,#*,/,""),t);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=dl(wi(r,e.replace(/[\\-]/g,""),t)),a=0,dl(dl(e.replace(/\\/g,"")).replace(/[0#]/g,function(p){return a<i.length?i.charAt(a++):p==="0"?"0":""}));if(e.match(Vk))return i=wi(r,"##########",t),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var c="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=ud(l,Math.pow(10,a)-1,!1),i=""+f,c=js("n",s[1],o[1]),c.charAt(c.length-1)==" "&&(c=c.substr(0,c.length-1)+"0"),i+=c+s[2]+"/"+s[3],c=cd(o[2],a),c.length<s[4].length&&(c=Fn(s[4].substr(s[4].length-c.length))+c),i+=c,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=ud(l,Math.pow(10,a)-1,!0),f+(o[0]||(o[1]?"":"0"))+" "+(o[1]?sO(o[1],a)+s[2]+"/"+s[3]+cd(o[2],a):br(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=zo(t,0),e.length<=i.length?i:Fn(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var h=e.indexOf(".")-a,u=e.length-i.length-h;return Fn(e.substr(0,h)+i+e.substr(e.length-u))}if(s=e.match(/^00,000\.([#0]*0)$/))return a=Uv(t,s[1].length),t<0?"-"+wi(r,e,-t):_a($Q(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?qi(0,3-p.length):"")+p})+"."+qi(a,s[1].length);switch(e){case"###,##0.00":return wi(r,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var d=_a(zo(l,0));return d!=="0"?f+d:"";case"###,###.00":return wi(r,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return wi(r,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function DQ(r,e,t){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return js(r,e.substr(0,n),t/Math.pow(10,3*(e.length-n)))}function NQ(r,e,t){var n=e.replace(Bk,""),i=e.length-n.length;return js(r,n,t*Math.pow(10,2*i))+br("%",i)}function qk(r,e){var t,n=r.indexOf("E")-r.indexOf(".")-1;if(r.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+qk(r,-e);var i=r.indexOf(".");i===-1&&(i=r.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),t=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!t.match(/[Ee]/)){var a=Math.floor(Math.log(e)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(a-t.length+s):t+="E+"+(a-s),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,f,c){return l+f+c.substr(0,(i+s)%i)+"."+c.substr(s)+"E"})}else t=e.toExponential(n);return r.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),r.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function ds(r,e,t){if(r.charCodeAt(0)===40&&!e.match(Xk)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?ds("n",n,t):"("+ds("n",n,-t)+")"}if(e.charCodeAt(e.length-1)===44)return DQ(r,e,t);if(e.indexOf("%")!==-1)return NQ(r,e,t);if(e.indexOf("E")!==-1)return qk(e,t);if(e.charCodeAt(0)===36)return"$"+ds(r,e.substr(e.charAt(1)==" "?2:1),t);var i,s,a,o,l=Math.abs(t),f=t<0?"-":"";if(e.match(/^00+$/))return f+qi(l,e.length);if(e.match(/^[#?]+$/))return i=""+t,t===0&&(i=""),i.length>e.length?i:Fn(e.substr(0,e.length-i.length))+i;if(s=e.match(Wk))return QQ(s,l,f);if(e.match(/^#+0+$/))return f+qi(l,e.length-e.indexOf("0"));if(s=e.match(Uk))return i=(""+t).replace(/^([^\.]+)$/,"$1."+Fn(s[1])).replace(/\.$/,"."+Fn(s[1])),i=i.replace(/\.(\d*)$/,function(p,m){return"."+m+br("0",Fn(s[1]).length-m.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return f+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return f+_a(""+l);if(s=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+ds(r,e,-t):_a(""+t)+"."+br("0",s[1].length);if(s=e.match(/^#,#*,#0/))return ds(r,e.replace(/^#,#*,/,""),t);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=dl(ds(r,e.replace(/[\\-]/g,""),t)),a=0,dl(dl(e.replace(/\\/g,"")).replace(/[0#]/g,function(p){return a<i.length?i.charAt(a++):p==="0"?"0":""}));if(e.match(Vk))return i=ds(r,"##########",t),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var c="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=ud(l,Math.pow(10,a)-1,!1),i=""+f,c=js("n",s[1],o[1]),c.charAt(c.length-1)==" "&&(c=c.substr(0,c.length-1)+"0"),i+=c+s[2]+"/"+s[3],c=cd(o[2],a),c.length<s[4].length&&(c=Fn(s[4].substr(s[4].length-c.length))+c),i+=c,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=ud(l,Math.pow(10,a)-1,!0),f+(o[0]||(o[1]?"":"0"))+" "+(o[1]?sO(o[1],a)+s[2]+"/"+s[3]+cd(o[2],a):br(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=""+t,e.length<=i.length?i:Fn(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0]+)\.([#0]+)$/)){i=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var h=e.indexOf(".")-a,u=e.length-i.length-h;return Fn(e.substr(0,h)+i+e.substr(e.length-u))}if(s=e.match(/^00,000\.([#0]*0)$/))return t<0?"-"+ds(r,e,-t):_a(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?qi(0,3-p.length):"")+p})+"."+qi(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var d=_a(""+l);return d!=="0"?f+d:"";default:if(e.match(/\.[0#?]*$/))return ds(r,e.slice(0,e.lastIndexOf(".")),t)+Fn(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function js(r,e,t){return(t|0)===t?ds(r,e,t):wi(r,e,t)}function MQ(r){for(var e=[],t=!1,n=0,i=0;n<r.length;++n)switch(r.charCodeAt(n)){case 34:t=!t;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=r.substr(i,n-i),i=n+1}if(e[e.length]=r.substr(i),t===!0)throw new Error("Format |"+r+"| unterminated string ");return e}var jk=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Io(r){for(var e=0,t="",n="";e<r.length;)switch(t=r.charAt(e)){case"G":hd(r,e)&&(e+=6),e++;break;case'"':for(;r.charCodeAt(++e)!==34&&e<r.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(r.charAt(e+1)==="1"||r.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(r.substr(e,3).toUpperCase()==="A/P"||r.substr(e,5).toUpperCase()==="AM/PM"||r.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=t;r.charAt(e++)!=="]"&&e<r.length;)n+=r.charAt(e);if(n.match(jk))return!0;break;case".":case"0":case"#":for(;e<r.length&&("0#?.,E+-%".indexOf(t=r.charAt(++e))>-1||t=="\\"&&r.charAt(e+1)=="-"&&"0#".indexOf(r.charAt(e+2))>-1););break;case"?":for(;r.charAt(++e)===t;);break;case"*":++e,(r.charAt(e)==" "||r.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<r.length&&"0123456789".indexOf(r.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function IQ(r,e,t,n){for(var i=[],s="",a=0,o="",l="t",f,c,h,u="H";a<r.length;)switch(o=r.charAt(a)){case"G":if(!hd(r,a))throw new Error("unrecognized character "+o+" in "+r);i[i.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(h=r.charCodeAt(++a))!==34&&a<r.length;)s+=String.fromCharCode(h);i[i.length]={t:"t",v:s},++a;break;case"\\":var d=r.charAt(++a),p=d==="("||d===")"?d:"t";i[i.length]={t:p,v:d},++a;break;case"_":i[i.length]={t:"t",v:" "},a+=2;break;case"@":i[i.length]={t:"T",v:e},++a;break;case"B":case"b":if(r.charAt(a+1)==="1"||r.charAt(a+1)==="2"){if(f==null&&(f=ba(e,t,r.charAt(a+1)==="2"),f==null))return"";i[i.length]={t:"X",v:r.substr(a,2)},l=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||f==null&&(f=ba(e,t),f==null))return"";for(s=o;++a<r.length&&r.charAt(a).toLowerCase()===o;)s+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=u),i[i.length]={t:o,v:s},l=o;break;case"A":case"a":case"":var m={t:o,v:o};if(f==null&&(f=ba(e,t)),r.substr(a,3).toUpperCase()==="A/P"?(f!=null&&(m.v=f.H>=12?"P":"A"),m.t="T",u="h",a+=3):r.substr(a,5).toUpperCase()==="AM/PM"?(f!=null&&(m.v=f.H>=12?"PM":"AM"),m.t="T",a+=5,u="h"):r.substr(a,5).toUpperCase()==="/"?(f!=null&&(m.v=f.H>=12?"":""),m.t="T",a+=5,u="h"):(m.t="t",++a),f==null&&m.t==="T")return"";i[i.length]=m,l=o;break;case"[":for(s=o;r.charAt(a++)!=="]"&&a<r.length;)s+=r.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(jk)){if(f==null&&(f=ba(e,t),f==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",Io(r)||(i[i.length]={t:"t",v:s}));break;case".":if(f!=null){for(s=o;++a<r.length&&(o=r.charAt(a))==="0";)s+=o;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++a<r.length&&"0#?.,E+-%".indexOf(o=r.charAt(a))>-1;)s+=o;i[i.length]={t:"n",v:s};break;case"?":for(s=o;r.charAt(++a)===o;)s+=o;i[i.length]={t:o,v:s},l=o;break;case"*":++a,(r.charAt(a)==" "||r.charAt(a)=="*")&&++a;break;case"(":case")":i[i.length]={t:n===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;a<r.length&&"0123456789".indexOf(r.charAt(++a))>-1;)s+=r.charAt(a);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:o,v:o},++a;break;case"$":i[i.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+r);i[i.length]={t:"t",v:o},++a;break}var g=0,O=0,w;for(a=i.length-1,l="t";a>=0;--a)switch(i[a].t){case"h":case"H":i[a].t=u,l="h",g<1&&(g=1);break;case"s":(w=i[a].v.match(/\.0+$/))&&(O=Math.max(O,w[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":l=i[a].t;break;case"m":l==="s"&&(i[a].t="M",g<2&&(g=2));break;case"X":break;case"Z":g<1&&i[a].v.match(/[Hh]/)&&(g=1),g<2&&i[a].v.match(/[Mm]/)&&(g=2),g<3&&i[a].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M),f.M>=60&&(f.M=0,++f.H);break;case 2:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M);break}var v="",S;for(a=0;a<i.length;++a)switch(i[a].t){case"t":case"T":case" ":case"D":break;case"X":i[a].v="",i[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[a].v=AQ(i[a].t.charCodeAt(0),i[a].v,f,O),i[a].t="t";break;case"n":case"?":for(S=a+1;i[S]!=null&&((o=i[S].t)==="?"||o==="D"||(o===" "||o==="t")&&i[S+1]!=null&&(i[S+1].t==="?"||i[S+1].t==="t"&&i[S+1].v==="/")||i[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[S].v==="/"||i[S].v===" "&&i[S+1]!=null&&i[S+1].t=="?"));)i[a].v+=i[S].v,i[S]={v:"",t:";"},++S;v+=i[a].v,a=S-1;break;case"G":i[a].t="t",i[a].v=So(e,t);break}var y="",b,x;if(v.length>0){v.charCodeAt(0)==40?(b=e<0&&v.charCodeAt(0)===45?-e:e,x=js("n",v,b)):(b=e<0&&n>1?-e:e,x=js("n",v,b),b<0&&i[0]&&i[0].t=="t"&&(x=x.substr(1),i[0].v="-"+i[0].v)),S=x.length-1;var A=i.length;for(a=0;a<i.length;++a)if(i[a]!=null&&i[a].t!="t"&&i[a].v.indexOf(".")>-1){A=a;break}var k=i.length;if(A===i.length&&x.indexOf("E")===-1){for(a=i.length-1;a>=0;--a)i[a]==null||"n?".indexOf(i[a].t)===-1||(S>=i[a].v.length-1?(S-=i[a].v.length,i[a].v=x.substr(S+1,i[a].v.length)):S<0?i[a].v="":(i[a].v=x.substr(0,S+1),S=-1),i[a].t="t",k=a);S>=0&&k<i.length&&(i[k].v=x.substr(0,S+1)+i[k].v)}else if(A!==i.length&&x.indexOf("E")===-1){for(S=x.indexOf(".")-1,a=A;a>=0;--a)if(!(i[a]==null||"n?".indexOf(i[a].t)===-1)){for(c=i[a].v.indexOf(".")>-1&&a===A?i[a].v.indexOf(".")-1:i[a].v.length-1,y=i[a].v.substr(c+1);c>=0;--c)S>=0&&(i[a].v.charAt(c)==="0"||i[a].v.charAt(c)==="#")&&(y=x.charAt(S--)+y);i[a].v=y,i[a].t="t",k=a}for(S>=0&&k<i.length&&(i[k].v=x.substr(0,S+1)+i[k].v),S=x.indexOf(".")+1,a=A;a<i.length;++a)if(!(i[a]==null||"n?(".indexOf(i[a].t)===-1&&a!==A)){for(c=i[a].v.indexOf(".")>-1&&a===A?i[a].v.indexOf(".")+1:0,y=i[a].v.substr(0,c);c<i[a].v.length;++c)S<x.length&&(y+=x.charAt(S++));i[a].v=y,i[a].t="t",k=a}}}for(a=0;a<i.length;++a)i[a]!=null&&"n?".indexOf(i[a].t)>-1&&(b=n>1&&e<0&&a>0&&i[a-1].v==="-"?-e:e,i[a].v=js(i[a].t,i[a].v,b),i[a].t="t");var E="";for(a=0;a!==i.length;++a)i[a]!=null&&(E+=i[a].v);return E}var Xv=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Vv(r,e){if(e==null)return!1;var t=parseFloat(e[2]);switch(e[1]){case"=":if(r==t)return!0;break;case">":if(r>t)return!0;break;case"<":if(r<t)return!0;break;case"<>":if(r!=t)return!0;break;case">=":if(r>=t)return!0;break;case"<=":if(r<=t)return!0;break}return!1}function LQ(r,e){var t=MQ(r),n=t.length,i=t[n-1].indexOf("@");if(n<4&&i>-1&&--n,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof e!="number")return[4,t.length===4||i>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=i>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=i>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=i>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var s=e>0?t[0]:e<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[n,s];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var a=t[0].match(Xv),o=t[1].match(Xv);return Vv(e,a)?[n,t[0]]:Vv(e,o)?[n,t[1]]:[n,t[a!=null&&o!=null?2:1]]}return[n,s]}function Oi(r,e,t){t==null&&(t={});var n="";switch(typeof r){case"string":r=="m/d/yy"&&t.dateNF?n=t.dateNF:n=r;break;case"number":r==14&&t.dateNF?n=t.dateNF:n=(t.table!=null?t.table:Ke)[r],n==null&&(n=t.table&&t.table[Zv[r]]||Ke[Zv[r]]),n==null&&(n=wQ[r]||"General");break}if(hd(n,0))return So(e,t);e instanceof Date&&(e=Lk(e,t.date1904));var i=LQ(n,e);if(hd(i[1]))return So(e,t);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return IQ(i[1],e,t,i[0])}function ks(r,e){if(typeof e!="number"){e=+e||-1;for(var t=0;t<392;++t){if(Ke[t]==null){e<0&&(e=t);continue}if(Ke[t]==r){e=t;break}}e<0&&(e=391)}return Ke[e]=r,e}function hh(r){for(var e=0;e!=392;++e)r[e]!==void 0&&ks(r[e],e)}function ef(){Ke=yQ()}var zk={format:Oi,load:ks,_table:Ke,load_table:hh,parse_date_code:ba,is_date:Io,get_table:function(){return zk._table=Ke}},BQ={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Gk=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function ZQ(r){var e=typeof r=="number"?Ke[r]:r;return e=e.replace(Gk,"(\\d+)"),new RegExp("^"+e+"$")}function WQ(r,e,t){var n=-1,i=-1,s=-1,a=-1,o=-1,l=-1;(e.match(Gk)||[]).forEach(function(h,u){var d=parseInt(t[u+1],10);switch(h.toLowerCase().charAt(0)){case"y":n=d;break;case"d":s=d;break;case"h":a=d;break;case"s":l=d;break;case"m":a>=0?o=d:i=d;break}}),l>=0&&o==-1&&i>=0&&(o=i,i=-1);var f=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);f.length==7&&(f="0"+f),f.length==8&&(f="20"+f);var c=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return a==-1&&o==-1&&l==-1?f:n==-1&&i==-1&&s==-1?c:f+"T"+c}var UQ=function(){var r={};r.version="1.2.0";function e(){for(var x=0,A=new Array(256),k=0;k!=256;++k)x=k,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,A[k]=x;return typeof Int32Array<"u"?new Int32Array(A):A}var t=e();function n(x){var A=0,k=0,E=0,T=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(E=0;E!=256;++E)T[E]=x[E];for(E=0;E!=256;++E)for(k=x[E],A=256+E;A<4096;A+=256)k=T[A]=k>>>8^x[k&255];var _=[];for(E=1;E!=16;++E)_[E-1]=typeof Int32Array<"u"?T.subarray(E*256,E*256+256):T.slice(E*256,E*256+256);return _}var i=n(t),s=i[0],a=i[1],o=i[2],l=i[3],f=i[4],c=i[5],h=i[6],u=i[7],d=i[8],p=i[9],m=i[10],g=i[11],O=i[12],w=i[13],v=i[14];function S(x,A){for(var k=A^-1,E=0,T=x.length;E<T;)k=k>>>8^t[(k^x.charCodeAt(E++))&255];return~k}function y(x,A){for(var k=A^-1,E=x.length-15,T=0;T<E;)k=v[x[T++]^k&255]^w[x[T++]^k>>8&255]^O[x[T++]^k>>16&255]^g[x[T++]^k>>>24]^m[x[T++]]^p[x[T++]]^d[x[T++]]^u[x[T++]]^h[x[T++]]^c[x[T++]]^f[x[T++]]^l[x[T++]]^o[x[T++]]^a[x[T++]]^s[x[T++]]^t[x[T++]];for(E+=15;T<E;)k=k>>>8^t[(k^x[T++])&255];return~k}function b(x,A){for(var k=A^-1,E=0,T=x.length,_=0,N=0;E<T;)_=x.charCodeAt(E++),_<128?k=k>>>8^t[(k^_)&255]:_<2048?(k=k>>>8^t[(k^(192|_>>6&31))&255],k=k>>>8^t[(k^(128|_&63))&255]):_>=55296&&_<57344?(_=(_&1023)+64,N=x.charCodeAt(E++)&1023,k=k>>>8^t[(k^(240|_>>8&7))&255],k=k>>>8^t[(k^(128|_>>2&63))&255],k=k>>>8^t[(k^(128|N>>6&15|(_&3)<<4))&255],k=k>>>8^t[(k^(128|N&63))&255]):(k=k>>>8^t[(k^(224|_>>12&15))&255],k=k>>>8^t[(k^(128|_>>6&63))&255],k=k>>>8^t[(k^(128|_&63))&255]);return~k}return r.table=t,r.bstr=S,r.buf=y,r.str=b,r}(),Ye=function(){var e={};e.version="1.2.1";function t(F,j){for(var D=F.split("/"),M=j.split("/"),X=0,G=0,oe=Math.min(D.length,M.length);X<oe;++X){if(G=D[X].length-M[X].length)return G;if(D[X]!=M[X])return D[X]<M[X]?-1:1}return D.length-M.length}function n(F){if(F.charAt(F.length-1)=="/")return F.slice(0,-1).indexOf("/")===-1?F:n(F.slice(0,-1));var j=F.lastIndexOf("/");return j===-1?F:F.slice(0,j+1)}function i(F){if(F.charAt(F.length-1)=="/")return i(F.slice(0,-1));var j=F.lastIndexOf("/");return j===-1?F:F.slice(j+1)}function s(F,j){typeof j=="string"&&(j=new Date(j));var D=j.getHours();D=D<<6|j.getMinutes(),D=D<<5|j.getSeconds()>>>1,F.write_shift(2,D);var M=j.getFullYear()-1980;M=M<<4|j.getMonth()+1,M=M<<5|j.getDate(),F.write_shift(2,M)}function a(F){var j=F.read_shift(2)&65535,D=F.read_shift(2)&65535,M=new Date,X=D&31;D>>>=5;var G=D&15;D>>>=4,M.setMilliseconds(0),M.setFullYear(D+1980),M.setMonth(G-1),M.setDate(X);var oe=j&31;j>>>=5;var he=j&63;return j>>>=6,M.setHours(j),M.setMinutes(he),M.setSeconds(oe<<1),M}function o(F){sn(F,0);for(var j={},D=0;F.l<=F.length-4;){var M=F.read_shift(2),X=F.read_shift(2),G=F.l+X,oe={};switch(M){case 21589:D=F.read_shift(1),D&1&&(oe.mtime=F.read_shift(4)),X>5&&(D&2&&(oe.atime=F.read_shift(4)),D&4&&(oe.ctime=F.read_shift(4))),oe.mtime&&(oe.mt=new Date(oe.mtime*1e3));break}F.l=G,j[M]=oe}return j}var l;function f(){return l||(l={})}function c(F,j){if(F[0]==80&&F[1]==75)return Je(F,j);if((F[0]|32)==109&&(F[1]|32)==105)return cr(F,j);if(F.length<512)throw new Error("CFB file size "+F.length+" < 512");var D=3,M=512,X=0,G=0,oe=0,he=0,te=0,se=[],le=F.slice(0,512);sn(le,0);var we=h(le);switch(D=we[0],D){case 3:M=512;break;case 4:M=4096;break;case 0:if(we[1]==0)return Je(F,j);default:throw new Error("Major Version: Expected 3 or 4 saw "+D)}M!==512&&(le=F.slice(0,M),sn(le,28));var ye=F.slice(0,M);u(le,D);var Pe=le.read_shift(4,"i");if(D===3&&Pe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Pe);le.l+=4,oe=le.read_shift(4,"i"),le.l+=4,le.chk("00100000","Mini Stream Cutoff Size: "),he=le.read_shift(4,"i"),X=le.read_shift(4,"i"),te=le.read_shift(4,"i"),G=le.read_shift(4,"i");for(var ke=-1,Ie=0;Ie<109&&(ke=le.read_shift(4,"i"),!(ke<0));++Ie)se[Ie]=ke;var He=d(F,M);g(te,G,He,M,se);var ut=w(He,oe,se,M);ut[oe].name="!Directory",X>0&&he!==N&&(ut[he].name="!MiniFAT"),ut[se[0]].name="!FAT",ut.fat_addrs=se,ut.ssz=M;var mt={},Xt=[],Qn=[],Er=[];v(oe,ut,He,Xt,X,mt,Qn,he),p(Qn,Er,Xt),Xt.shift();var Bn={FileIndex:Qn,FullPaths:Er};return j&&j.raw&&(Bn.raw={header:ye,sectors:He}),Bn}function h(F){if(F[F.l]==80&&F[F.l+1]==75)return[0,0];F.chk(Z,"Header Signature: "),F.l+=16;var j=F.read_shift(2,"u");return[F.read_shift(2,"u"),j]}function u(F,j){var D=9;switch(F.l+=2,D=F.read_shift(2)){case 9:if(j!=3)throw new Error("Sector Shift: Expected 9 saw "+D);break;case 12:if(j!=4)throw new Error("Sector Shift: Expected 12 saw "+D);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+D)}F.chk("0600","Mini Sector Shift: "),F.chk("000000000000","Reserved: ")}function d(F,j){for(var D=Math.ceil(F.length/j)-1,M=[],X=1;X<D;++X)M[X-1]=F.slice(X*j,(X+1)*j);return M[D-1]=F.slice(D*j),M}function p(F,j,D){for(var M=0,X=0,G=0,oe=0,he=0,te=D.length,se=[],le=[];M<te;++M)se[M]=le[M]=M,j[M]=D[M];for(;he<le.length;++he)M=le[he],X=F[M].L,G=F[M].R,oe=F[M].C,se[M]===M&&(X!==-1&&se[X]!==X&&(se[M]=se[X]),G!==-1&&se[G]!==G&&(se[M]=se[G])),oe!==-1&&(se[oe]=M),X!==-1&&M!=se[M]&&(se[X]=se[M],le.lastIndexOf(X)<he&&le.push(X)),G!==-1&&M!=se[M]&&(se[G]=se[M],le.lastIndexOf(G)<he&&le.push(G));for(M=1;M<te;++M)se[M]===M&&(G!==-1&&se[G]!==G?se[M]=se[G]:X!==-1&&se[X]!==X&&(se[M]=se[X]));for(M=1;M<te;++M)if(F[M].type!==0){if(he=M,he!=se[he])do he=se[he],j[M]=j[he]+"/"+j[M];while(he!==0&&se[he]!==-1&&he!=se[he]);se[M]=-1}for(j[0]+="/",M=1;M<te;++M)F[M].type!==2&&(j[M]+="/")}function m(F,j,D){for(var M=F.start,X=F.size,G=[],oe=M;D&&X>0&&oe>=0;)G.push(j.slice(oe*_,oe*_+_)),X-=_,oe=lo(D,oe*4);return G.length===0?me(0):Kr(G).slice(0,F.size)}function g(F,j,D,M,X){var G=N;if(F===N){if(j!==0)throw new Error("DIFAT chain shorter than expected")}else if(F!==-1){var oe=D[F],he=(M>>>2)-1;if(!oe)return;for(var te=0;te<he&&(G=lo(oe,te*4))!==N;++te)X.push(G);g(lo(oe,M-4),j-1,D,M,X)}}function O(F,j,D,M,X){var G=[],oe=[];X||(X=[]);var he=M-1,te=0,se=0;for(te=j;te>=0;){X[te]=!0,G[G.length]=te,oe.push(F[te]);var le=D[Math.floor(te*4/M)];if(se=te*4&he,M<4+se)throw new Error("FAT boundary crossed: "+te+" 4 "+M);if(!F[le])break;te=lo(F[le],se)}return{nodes:G,data:ny([oe])}}function w(F,j,D,M){var X=F.length,G=[],oe=[],he=[],te=[],se=M-1,le=0,we=0,ye=0,Pe=0;for(le=0;le<X;++le)if(he=[],ye=le+j,ye>=X&&(ye-=X),!oe[ye]){te=[];var ke=[];for(we=ye;we>=0;){ke[we]=!0,oe[we]=!0,he[he.length]=we,te.push(F[we]);var Ie=D[Math.floor(we*4/M)];if(Pe=we*4&se,M<4+Pe)throw new Error("FAT boundary crossed: "+we+" 4 "+M);if(!F[Ie]||(we=lo(F[Ie],Pe),ke[we]))break}G[ye]={nodes:he,data:ny([te])}}return G}function v(F,j,D,M,X,G,oe,he){for(var te=0,se=M.length?2:0,le=j[F].data,we=0,ye=0,Pe;we<le.length;we+=128){var ke=le.slice(we,we+128);sn(ke,64),ye=ke.read_shift(2),Pe=x0(ke,0,ye-se),M.push(Pe);var Ie={name:Pe,type:ke.read_shift(1),color:ke.read_shift(1),L:ke.read_shift(4,"i"),R:ke.read_shift(4,"i"),C:ke.read_shift(4,"i"),clsid:ke.read_shift(16),state:ke.read_shift(4,"i"),start:0,size:0},He=ke.read_shift(2)+ke.read_shift(2)+ke.read_shift(2)+ke.read_shift(2);He!==0&&(Ie.ct=S(ke,ke.l-8));var ut=ke.read_shift(2)+ke.read_shift(2)+ke.read_shift(2)+ke.read_shift(2);ut!==0&&(Ie.mt=S(ke,ke.l-8)),Ie.start=ke.read_shift(4,"i"),Ie.size=ke.read_shift(4,"i"),Ie.size<0&&Ie.start<0&&(Ie.size=Ie.type=0,Ie.start=N,Ie.name=""),Ie.type===5?(te=Ie.start,X>0&&te!==N&&(j[te].name="!StreamData")):Ie.size>=4096?(Ie.storage="fat",j[Ie.start]===void 0&&(j[Ie.start]=O(D,Ie.start,j.fat_addrs,j.ssz)),j[Ie.start].name=Ie.name,Ie.content=j[Ie.start].data.slice(0,Ie.size)):(Ie.storage="minifat",Ie.size<0?Ie.size=0:te!==N&&Ie.start!==N&&j[te]&&(Ie.content=m(Ie,j[te].data,(j[he]||{}).data))),Ie.content&&sn(Ie.content,0),G[Pe]=Ie,oe.push(Ie)}}function S(F,j){return new Date((Hr(F,j+4)/1e7*Math.pow(2,32)+Hr(F,j)/1e7-11644473600)*1e3)}function y(F,j){return f(),c(l.readFileSync(F),j)}function b(F,j){var D=j&&j.type;switch(D||dt&&Buffer.isBuffer(F)&&(D="buffer"),D||"base64"){case"file":return y(F,j);case"base64":return c(oi(gi(F)),j);case"binary":return c(oi(F),j)}return c(F,j)}function x(F,j){var D=j||{},M=D.root||"Root Entry";if(F.FullPaths||(F.FullPaths=[]),F.FileIndex||(F.FileIndex=[]),F.FullPaths.length!==F.FileIndex.length)throw new Error("inconsistent CFB structure");F.FullPaths.length===0&&(F.FullPaths[0]=M+"/",F.FileIndex[0]={name:M,type:5}),D.CLSID&&(F.FileIndex[0].clsid=D.CLSID),A(F)}function A(F){var j="Sh33tJ5";if(!Ye.find(F,"/"+j)){var D=me(4);D[0]=55,D[1]=D[3]=50,D[2]=54,F.FileIndex.push({name:j,type:2,content:D,size:4,L:69,R:69,C:69}),F.FullPaths.push(F.FullPaths[0]+j),k(F)}}function k(F,j){x(F);for(var D=!1,M=!1,X=F.FullPaths.length-1;X>=0;--X){var G=F.FileIndex[X];switch(G.type){case 0:M?D=!0:(F.FileIndex.pop(),F.FullPaths.pop());break;case 1:case 2:case 5:M=!0,isNaN(G.R*G.L*G.C)&&(D=!0),G.R>-1&&G.L>-1&&G.R==G.L&&(D=!0);break;default:D=!0;break}}if(!(!D&&!j)){var oe=new Date(1987,1,19),he=0,te=Object.create?Object.create(null):{},se=[];for(X=0;X<F.FullPaths.length;++X)te[F.FullPaths[X]]=!0,F.FileIndex[X].type!==0&&se.push([F.FullPaths[X],F.FileIndex[X]]);for(X=0;X<se.length;++X){var le=n(se[X][0]);M=te[le],M||(se.push([le,{name:i(le).replace("/",""),type:1,clsid:ee,ct:oe,mt:oe,content:null}]),te[le]=!0)}for(se.sort(function(Pe,ke){return t(Pe[0],ke[0])}),F.FullPaths=[],F.FileIndex=[],X=0;X<se.length;++X)F.FullPaths[X]=se[X][0],F.FileIndex[X]=se[X][1];for(X=0;X<se.length;++X){var we=F.FileIndex[X],ye=F.FullPaths[X];if(we.name=i(ye).replace("/",""),we.L=we.R=we.C=-(we.color=1),we.size=we.content?we.content.length:0,we.start=0,we.clsid=we.clsid||ee,X===0)we.C=se.length>1?1:-1,we.size=0,we.type=5;else if(ye.slice(-1)=="/"){for(he=X+1;he<se.length&&n(F.FullPaths[he])!=ye;++he);for(we.C=he>=se.length?-1:he,he=X+1;he<se.length&&n(F.FullPaths[he])!=n(ye);++he);we.R=he>=se.length?-1:he,we.type=1}else n(F.FullPaths[X+1]||"")==n(ye)&&(we.R=X+1),we.type=2}}}function E(F,j){var D=j||{};if(D.fileType=="mad")return hr(F,D);switch(k(F),D.fileType){case"zip":return Ht(F,D)}var M=function(Pe){for(var ke=0,Ie=0,He=0;He<Pe.FileIndex.length;++He){var ut=Pe.FileIndex[He];if(ut.content){var mt=ut.content.length;mt>0&&(mt<4096?ke+=mt+63>>6:Ie+=mt+511>>9)}}for(var Xt=Pe.FullPaths.length+3>>2,Qn=ke+7>>3,Er=ke+127>>7,Bn=Qn+Ie+Xt+Er,Zn=Bn+127>>7,$r=Zn<=109?0:Math.ceil((Zn-109)/127);Bn+Zn+$r+127>>7>Zn;)$r=++Zn<=109?0:Math.ceil((Zn-109)/127);var ft=[1,$r,Zn,Er,Xt,Ie,ke,0];return Pe.FileIndex[0].size=ke<<6,ft[7]=(Pe.FileIndex[0].start=ft[0]+ft[1]+ft[2]+ft[3]+ft[4]+ft[5])+(ft[6]+7>>3),ft}(F),X=me(M[7]<<9),G=0,oe=0;{for(G=0;G<8;++G)X.write_shift(1,z[G]);for(G=0;G<8;++G)X.write_shift(2,0);for(X.write_shift(2,62),X.write_shift(2,3),X.write_shift(2,65534),X.write_shift(2,9),X.write_shift(2,6),G=0;G<3;++G)X.write_shift(2,0);for(X.write_shift(4,0),X.write_shift(4,M[2]),X.write_shift(4,M[0]+M[1]+M[2]+M[3]-1),X.write_shift(4,0),X.write_shift(4,4096),X.write_shift(4,M[3]?M[0]+M[1]+M[2]-1:N),X.write_shift(4,M[3]),X.write_shift(-4,M[1]?M[0]-1:N),X.write_shift(4,M[1]),G=0;G<109;++G)X.write_shift(-4,G<M[2]?M[1]+G:-1)}if(M[1])for(oe=0;oe<M[1];++oe){for(;G<236+oe*127;++G)X.write_shift(-4,G<M[2]?M[1]+G:-1);X.write_shift(-4,oe===M[1]-1?N:oe+1)}var he=function(Pe){for(oe+=Pe;G<oe-1;++G)X.write_shift(-4,G+1);Pe&&(++G,X.write_shift(-4,N))};for(oe=G=0,oe+=M[1];G<oe;++G)X.write_shift(-4,ae.DIFSECT);for(oe+=M[2];G<oe;++G)X.write_shift(-4,ae.FATSECT);he(M[3]),he(M[4]);for(var te=0,se=0,le=F.FileIndex[0];te<F.FileIndex.length;++te)le=F.FileIndex[te],le.content&&(se=le.content.length,!(se<4096)&&(le.start=oe,he(se+511>>9)));for(he(M[6]+7>>3);X.l&511;)X.write_shift(-4,ae.ENDOFCHAIN);for(oe=G=0,te=0;te<F.FileIndex.length;++te)le=F.FileIndex[te],le.content&&(se=le.content.length,!(!se||se>=4096)&&(le.start=oe,he(se+63>>6)));for(;X.l&511;)X.write_shift(-4,ae.ENDOFCHAIN);for(G=0;G<M[4]<<2;++G){var we=F.FullPaths[G];if(!we||we.length===0){for(te=0;te<17;++te)X.write_shift(4,0);for(te=0;te<3;++te)X.write_shift(4,-1);for(te=0;te<12;++te)X.write_shift(4,0);continue}le=F.FileIndex[G],G===0&&(le.start=le.size?le.start-1:N);var ye=G===0&&D.root||le.name;if(se=2*(ye.length+1),X.write_shift(64,ye,"utf16le"),X.write_shift(2,se),X.write_shift(1,le.type),X.write_shift(1,le.color),X.write_shift(-4,le.L),X.write_shift(-4,le.R),X.write_shift(-4,le.C),le.clsid)X.write_shift(16,le.clsid,"hex");else for(te=0;te<4;++te)X.write_shift(4,0);X.write_shift(4,le.state||0),X.write_shift(4,0),X.write_shift(4,0),X.write_shift(4,0),X.write_shift(4,0),X.write_shift(4,le.start),X.write_shift(4,le.size),X.write_shift(4,0)}for(G=1;G<F.FileIndex.length;++G)if(le=F.FileIndex[G],le.size>=4096)if(X.l=le.start+1<<9,dt&&Buffer.isBuffer(le.content))le.content.copy(X,X.l,0,le.size),X.l+=le.size+511&-512;else{for(te=0;te<le.size;++te)X.write_shift(1,le.content[te]);for(;te&511;++te)X.write_shift(1,0)}for(G=1;G<F.FileIndex.length;++G)if(le=F.FileIndex[G],le.size>0&&le.size<4096)if(dt&&Buffer.isBuffer(le.content))le.content.copy(X,X.l,0,le.size),X.l+=le.size+63&-64;else{for(te=0;te<le.size;++te)X.write_shift(1,le.content[te]);for(;te&63;++te)X.write_shift(1,0)}if(dt)X.l=X.length;else for(;X.l<X.length;)X.write_shift(1,0);return X}function T(F,j){var D=F.FullPaths.map(function(te){return te.toUpperCase()}),M=D.map(function(te){var se=te.split("/");return se[se.length-(te.slice(-1)=="/"?2:1)]}),X=!1;j.charCodeAt(0)===47?(X=!0,j=D[0].slice(0,-1)+j):X=j.indexOf("/")!==-1;var G=j.toUpperCase(),oe=X===!0?D.indexOf(G):M.indexOf(G);if(oe!==-1)return F.FileIndex[oe];var he=!G.match(Rf);for(G=G.replace(Sn,""),he&&(G=G.replace(Rf,"!")),oe=0;oe<D.length;++oe)if((he?D[oe].replace(Rf,"!"):D[oe]).replace(Sn,"")==G||(he?M[oe].replace(Rf,"!"):M[oe]).replace(Sn,"")==G)return F.FileIndex[oe];return null}var _=64,N=-2,Z="d0cf11e0a1b11ae1",z=[208,207,17,224,161,177,26,225],ee="00000000000000000000000000000000",ae={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:N,FREESECT:-1,HEADER_SIGNATURE:Z,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ee,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function xe(F,j,D){f();var M=E(F,D);l.writeFileSync(j,M)}function V(F){for(var j=new Array(F.length),D=0;D<F.length;++D)j[D]=String.fromCharCode(F[D]);return j.join("")}function ue(F,j){var D=E(F,j);switch(j&&j.type||"buffer"){case"file":return f(),l.writeFileSync(j.filename,D),D;case"binary":return typeof D=="string"?D:V(D);case"base64":return Oc(typeof D=="string"?D:V(D));case"buffer":if(dt)return Buffer.isBuffer(D)?D:na(D);case"array":return typeof D=="string"?oi(D):D}return D}var ie;function P(F){try{var j=F.InflateRaw,D=new j;if(D._processChunk(new Uint8Array([3,0]),D._finishFlushFlag),D.bytesRead)ie=F;else throw new Error("zlib does not expose bytesRead")}catch(M){console.error("cannot use native zlib: "+(M.message||M))}}function I(F,j){if(!ie)return Ka(F,j);var D=ie.InflateRaw,M=new D,X=M._processChunk(F.slice(F.l),M._finishFlushFlag);return F.l+=M.bytesRead,X}function B(F){return ie?ie.deflateRawSync(F):at(F)}var W=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],K=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],re=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function pe(F){var j=(F<<1|F<<11)&139536|(F<<5|F<<15)&558144;return(j>>16|j>>8|j)&255}for(var fe=typeof Uint8Array<"u",de=fe?new Uint8Array(256):[],Ue=0;Ue<256;++Ue)de[Ue]=pe(Ue);function q(F,j){var D=de[F&255];return j<=8?D>>>8-j:(D=D<<8|de[F>>8&255],j<=16?D>>>16-j:(D=D<<8|de[F>>16&255],D>>>24-j))}function ze(F,j){var D=j&7,M=j>>>3;return(F[M]|(D<=6?0:F[M+1]<<8))>>>D&3}function Qe(F,j){var D=j&7,M=j>>>3;return(F[M]|(D<=5?0:F[M+1]<<8))>>>D&7}function De(F,j){var D=j&7,M=j>>>3;return(F[M]|(D<=4?0:F[M+1]<<8))>>>D&15}function Fe(F,j){var D=j&7,M=j>>>3;return(F[M]|(D<=3?0:F[M+1]<<8))>>>D&31}function ve(F,j){var D=j&7,M=j>>>3;return(F[M]|(D<=1?0:F[M+1]<<8))>>>D&127}function it(F,j,D){var M=j&7,X=j>>>3,G=(1<<D)-1,oe=F[X]>>>M;return D<8-M||(oe|=F[X+1]<<8-M,D<16-M)||(oe|=F[X+2]<<16-M,D<24-M)||(oe|=F[X+3]<<24-M),oe&G}function ot(F,j,D){var M=j&7,X=j>>>3;return M<=5?F[X]|=(D&7)<<M:(F[X]|=D<<M&255,F[X+1]=(D&7)>>8-M),j+3}function bt(F,j,D){var M=j&7,X=j>>>3;return D=(D&1)<<M,F[X]|=D,j+1}function $t(F,j,D){var M=j&7,X=j>>>3;return D<<=M,F[X]|=D&255,D>>>=8,F[X+1]=D,j+8}function Ce(F,j,D){var M=j&7,X=j>>>3;return D<<=M,F[X]|=D&255,D>>>=8,F[X+1]=D&255,F[X+2]=D>>>8,j+16}function Ve(F,j){var D=F.length,M=2*D>j?2*D:j+5,X=0;if(D>=j)return F;if(dt){var G=Iv(M);if(F.copy)F.copy(G);else for(;X<F.length;++X)G[X]=F[X];return G}else if(fe){var oe=new Uint8Array(M);if(oe.set)oe.set(F);else for(;X<D;++X)oe[X]=F[X];return oe}return F.length=M,F}function Ae(F){for(var j=new Array(F),D=0;D<F;++D)j[D]=0;return j}function Te(F,j,D){var M=1,X=0,G=0,oe=0,he=0,te=F.length,se=fe?new Uint16Array(32):Ae(32);for(G=0;G<32;++G)se[G]=0;for(G=te;G<D;++G)F[G]=0;te=F.length;var le=fe?new Uint16Array(te):Ae(te);for(G=0;G<te;++G)se[X=F[G]]++,M<X&&(M=X),le[G]=0;for(se[0]=0,G=1;G<=M;++G)se[G+16]=he=he+se[G-1]<<1;for(G=0;G<te;++G)he=F[G],he!=0&&(le[G]=se[he+16]++);var we=0;for(G=0;G<te;++G)if(we=F[G],we!=0)for(he=q(le[G],M)>>M-we,oe=(1<<M+4-we)-1;oe>=0;--oe)j[he|oe<<we]=we&15|G<<4;return M}var Re=fe?new Uint16Array(512):Ae(512),Nt=fe?new Uint16Array(32):Ae(32);if(!fe){for(var yr=0;yr<512;++yr)Re[yr]=0;for(yr=0;yr<32;++yr)Nt[yr]=0}(function(){for(var F=[],j=0;j<32;j++)F.push(5);Te(F,Nt,32);var D=[];for(j=0;j<=143;j++)D.push(8);for(;j<=255;j++)D.push(9);for(;j<=279;j++)D.push(7);for(;j<=287;j++)D.push(8);Te(D,Re,288)})();var qr=function(){for(var j=fe?new Uint8Array(32768):[],D=0,M=0;D<re.length-1;++D)for(;M<re[D+1];++M)j[M]=D;for(;M<32768;++M)j[M]=29;var X=fe?new Uint8Array(259):[];for(D=0,M=0;D<K.length-1;++D)for(;M<K[D+1];++M)X[M]=D;function G(he,te){for(var se=0;se<he.length;){var le=Math.min(65535,he.length-se),we=se+le==he.length;for(te.write_shift(1,+we),te.write_shift(2,le),te.write_shift(2,~le&65535);le-- >0;)te[te.l++]=he[se++]}return te.l}function oe(he,te){for(var se=0,le=0,we=fe?new Uint16Array(32768):[];le<he.length;){var ye=Math.min(65535,he.length-le);if(ye<10){for(se=ot(te,se,+(le+ye==he.length)),se&7&&(se+=8-(se&7)),te.l=se/8|0,te.write_shift(2,ye),te.write_shift(2,~ye&65535);ye-- >0;)te[te.l++]=he[le++];se=te.l*8;continue}se=ot(te,se,+(le+ye==he.length)+2);for(var Pe=0;ye-- >0;){var ke=he[le];Pe=(Pe<<5^ke)&32767;var Ie=-1,He=0;if((Ie=we[Pe])&&(Ie|=le&-32768,Ie>le&&(Ie-=32768),Ie<le))for(;he[Ie+He]==he[le+He]&&He<250;)++He;if(He>2){ke=X[He],ke<=22?se=$t(te,se,de[ke+1]>>1)-1:($t(te,se,3),se+=5,$t(te,se,de[ke-23]>>5),se+=3);var ut=ke<8?0:ke-4>>2;ut>0&&(Ce(te,se,He-K[ke]),se+=ut),ke=j[le-Ie],se=$t(te,se,de[ke]>>3),se-=3;var mt=ke<4?0:ke-2>>1;mt>0&&(Ce(te,se,le-Ie-re[ke]),se+=mt);for(var Xt=0;Xt<He;++Xt)we[Pe]=le&32767,Pe=(Pe<<5^he[le])&32767,++le;ye-=He-1}else ke<=143?ke=ke+48:se=bt(te,se,1),se=$t(te,se,de[ke]),we[Pe]=le&32767,++le}se=$t(te,se,0)-1}return te.l=(se+7)/8|0,te.l}return function(te,se){return te.length<8?G(te,se):oe(te,se)}}();function at(F){var j=me(50+Math.floor(F.length*1.1)),D=qr(F,j);return j.slice(0,D)}var Mt=fe?new Uint16Array(32768):Ae(32768),jr=fe?new Uint16Array(32768):Ae(32768),Gt=fe?new Uint16Array(128):Ae(128),Bi=1,la=1;function Vo(F,j){var D=Fe(F,j)+257;j+=5;var M=Fe(F,j)+1;j+=5;var X=De(F,j)+4;j+=4;for(var G=0,oe=fe?new Uint8Array(19):Ae(19),he=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],te=1,se=fe?new Uint8Array(8):Ae(8),le=fe?new Uint8Array(8):Ae(8),we=oe.length,ye=0;ye<X;++ye)oe[W[ye]]=G=Qe(F,j),te<G&&(te=G),se[G]++,j+=3;var Pe=0;for(se[0]=0,ye=1;ye<=te;++ye)le[ye]=Pe=Pe+se[ye-1]<<1;for(ye=0;ye<we;++ye)(Pe=oe[ye])!=0&&(he[ye]=le[Pe]++);var ke=0;for(ye=0;ye<we;++ye)if(ke=oe[ye],ke!=0){Pe=de[he[ye]]>>8-ke;for(var Ie=(1<<7-ke)-1;Ie>=0;--Ie)Gt[Pe|Ie<<ke]=ke&7|ye<<3}var He=[];for(te=1;He.length<D+M;)switch(Pe=Gt[ve(F,j)],j+=Pe&7,Pe>>>=3){case 16:for(G=3+ze(F,j),j+=2,Pe=He[He.length-1];G-- >0;)He.push(Pe);break;case 17:for(G=3+Qe(F,j),j+=3;G-- >0;)He.push(0);break;case 18:for(G=11+ve(F,j),j+=7;G-- >0;)He.push(0);break;default:He.push(Pe),te<Pe&&(te=Pe);break}var ut=He.slice(0,D),mt=He.slice(D);for(ye=D;ye<286;++ye)ut[ye]=0;for(ye=M;ye<30;++ye)mt[ye]=0;return Bi=Te(ut,Mt,286),la=Te(mt,jr,30),j}function fa(F,j){if(F[0]==3&&!(F[1]&3))return[Ra(j),2];for(var D=0,M=0,X=Iv(j||1<<18),G=0,oe=X.length>>>0,he=0,te=0;!(M&1);){if(M=Qe(F,D),D+=3,M>>>1)M>>1==1?(he=9,te=5):(D=Vo(F,D),he=Bi,te=la);else{D&7&&(D+=8-(D&7));var se=F[D>>>3]|F[(D>>>3)+1]<<8;if(D+=32,se>0)for(!j&&oe<G+se&&(X=Ve(X,G+se),oe=X.length);se-- >0;)X[G++]=F[D>>>3],D+=8;continue}for(;;){!j&&oe<G+32767&&(X=Ve(X,G+32767),oe=X.length);var le=it(F,D,he),we=M>>>1==1?Re[le]:Mt[le];if(D+=we&15,we>>>=4,!(we>>>8&255))X[G++]=we;else{if(we==256)break;we-=257;var ye=we<8?0:we-4>>2;ye>5&&(ye=0);var Pe=G+K[we];ye>0&&(Pe+=it(F,D,ye),D+=ye),le=it(F,D,te),we=M>>>1==1?Nt[le]:jr[le],D+=we&15,we>>>=4;var ke=we<4?0:we-2>>1,Ie=re[we];for(ke>0&&(Ie+=it(F,D,ke),D+=ke),!j&&oe<Pe&&(X=Ve(X,Pe+100),oe=X.length);G<Pe;)X[G]=X[G-Ie],++G}}}return j?[X,D+7>>>3]:[X.slice(0,G),D+7>>>3]}function Ka(F,j){var D=F.slice(F.l||0),M=fa(D,j);return F.l+=M[1],M[0]}function Le(F,j){if(F)typeof console<"u"&&console.error(j);else throw new Error(j)}function Je(F,j){var D=F;sn(D,0);var M=[],X=[],G={FileIndex:M,FullPaths:X};x(G,{root:j.root});for(var oe=D.length-4;(D[oe]!=80||D[oe+1]!=75||D[oe+2]!=5||D[oe+3]!=6)&&oe>=0;)--oe;D.l=oe+4,D.l+=4;var he=D.read_shift(2);D.l+=6;var te=D.read_shift(4);for(D.l=te,oe=0;oe<he;++oe){D.l+=20;var se=D.read_shift(4),le=D.read_shift(4),we=D.read_shift(2),ye=D.read_shift(2),Pe=D.read_shift(2);D.l+=8;var ke=D.read_shift(4),Ie=o(D.slice(D.l+we,D.l+we+ye));D.l+=we+ye+Pe;var He=D.l;D.l=ke+4,lr(D,se,le,G,Ie),D.l=He}return G}function lr(F,j,D,M,X){F.l+=2;var G=F.read_shift(2),oe=F.read_shift(2),he=a(F);if(G&8257)throw new Error("Unsupported ZIP encryption");for(var te=F.read_shift(4),se=F.read_shift(4),le=F.read_shift(4),we=F.read_shift(2),ye=F.read_shift(2),Pe="",ke=0;ke<we;++ke)Pe+=String.fromCharCode(F[F.l++]);if(ye){var Ie=o(F.slice(F.l,F.l+ye));(Ie[21589]||{}).mt&&(he=Ie[21589].mt),((X||{})[21589]||{}).mt&&(he=X[21589].mt)}F.l+=ye;var He=F.slice(F.l,F.l+se);switch(oe){case 8:He=I(F,le);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+oe)}var ut=!1;G&8&&(te=F.read_shift(4),te==134695760&&(te=F.read_shift(4),ut=!0),se=F.read_shift(4),le=F.read_shift(4)),se!=j&&Le(ut,"Bad compressed size: "+j+" != "+se),le!=D&&Le(ut,"Bad uncompressed size: "+D+" != "+le),vt(M,Pe,He,{unsafe:!0,mt:he})}function Ht(F,j){var D=j||{},M=[],X=[],G=me(1),oe=D.compression?8:0,he=0,te=0,se=0,le=0,we=0,ye=F.FullPaths[0],Pe=ye,ke=F.FileIndex[0],Ie=[],He=0;for(te=1;te<F.FullPaths.length;++te)if(Pe=F.FullPaths[te].slice(ye.length),ke=F.FileIndex[te],!(!ke.size||!ke.content||Pe=="Sh33tJ5")){var ut=le,mt=me(Pe.length);for(se=0;se<Pe.length;++se)mt.write_shift(1,Pe.charCodeAt(se)&127);mt=mt.slice(0,mt.l),Ie[we]=UQ.buf(ke.content,0);var Xt=ke.content;oe==8&&(Xt=B(Xt)),G=me(30),G.write_shift(4,67324752),G.write_shift(2,20),G.write_shift(2,he),G.write_shift(2,oe),ke.mt?s(G,ke.mt):G.write_shift(4,0),G.write_shift(-4,Ie[we]),G.write_shift(4,Xt.length),G.write_shift(4,ke.content.length),G.write_shift(2,mt.length),G.write_shift(2,0),le+=G.length,M.push(G),le+=mt.length,M.push(mt),le+=Xt.length,M.push(Xt),G=me(46),G.write_shift(4,33639248),G.write_shift(2,0),G.write_shift(2,20),G.write_shift(2,he),G.write_shift(2,oe),G.write_shift(4,0),G.write_shift(-4,Ie[we]),G.write_shift(4,Xt.length),G.write_shift(4,ke.content.length),G.write_shift(2,mt.length),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(4,0),G.write_shift(4,ut),He+=G.l,X.push(G),He+=mt.length,X.push(mt),++we}return G=me(22),G.write_shift(4,101010256),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(2,we),G.write_shift(2,we),G.write_shift(4,He),G.write_shift(4,le),G.write_shift(2,0),Kr([Kr(M),Kr(X),G])}var fr={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ei(F,j){if(F.ctype)return F.ctype;var D=F.name||"",M=D.match(/\.([^\.]+)$/);return M&&fr[M[1]]||j&&(M=(D=j).match(/[\.\\]([^\.\\])+$/),M&&fr[M[1]])?fr[M[1]]:"application/octet-stream"}function xi(F){for(var j=Oc(F),D=[],M=0;M<j.length;M+=76)D.push(j.slice(M,M+76));return D.join(`\r
`)+`\r
`}function ti(F){var j=F.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(se){var le=se.charCodeAt(0).toString(16).toUpperCase();return"="+(le.length==1?"0"+le:le)});j=j.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),j.charAt(0)==`
`&&(j="=0D"+j.slice(1)),j=j.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var D=[],M=j.split(`\r
`),X=0;X<M.length;++X){var G=M[X];if(G.length==0){D.push("");continue}for(var oe=0;oe<G.length;){var he=76,te=G.slice(oe,oe+he);te.charAt(he-1)=="="?he--:te.charAt(he-2)=="="?he-=2:te.charAt(he-3)=="="&&(he-=3),te=G.slice(oe,oe+he),oe+=he,oe<G.length&&(te+="="),D.push(te)}}return D.join(`\r
`)}function Ar(F){for(var j=[],D=0;D<F.length;++D){for(var M=F[D];D<=F.length&&M.charAt(M.length-1)=="=";)M=M.slice(0,M.length-1)+F[++D];j.push(M)}for(var X=0;X<j.length;++X)j[X]=j[X].replace(/[=][0-9A-Fa-f]{2}/g,function(G){return String.fromCharCode(parseInt(G.slice(1),16))});return oi(j.join(`\r
`))}function Rt(F,j,D){for(var M="",X="",G="",oe,he=0;he<10;++he){var te=j[he];if(!te||te.match(/^\s*$/))break;var se=te.match(/^(.*?):\s*([^\s].*)$/);if(se)switch(se[1].toLowerCase()){case"content-location":M=se[2].trim();break;case"content-type":G=se[2].trim();break;case"content-transfer-encoding":X=se[2].trim();break}}switch(++he,X.toLowerCase()){case"base64":oe=oi(gi(j.slice(he).join("")));break;case"quoted-printable":oe=Ar(j.slice(he));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+X)}var le=vt(F,M.slice(D.length),oe,{unsafe:!0});G&&(le.ctype=G)}function cr(F,j){if(V(F.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var D=j&&j.root||"",M=(dt&&Buffer.isBuffer(F)?F.toString("binary"):V(F)).split(`\r
`),X=0,G="";for(X=0;X<M.length;++X)if(G=M[X],!!/^Content-Location:/i.test(G)&&(G=G.slice(G.indexOf("file")),D||(D=G.slice(0,G.lastIndexOf("/")+1)),G.slice(0,D.length)!=D))for(;D.length>0&&(D=D.slice(0,D.length-1),D=D.slice(0,D.lastIndexOf("/")+1),G.slice(0,D.length)!=D););var oe=(M[1]||"").match(/boundary="(.*?)"/);if(!oe)throw new Error("MAD cannot find boundary");var he="--"+(oe[1]||""),te=[],se=[],le={FileIndex:te,FullPaths:se};x(le);var we,ye=0;for(X=0;X<M.length;++X){var Pe=M[X];Pe!==he&&Pe!==he+"--"||(ye++&&Rt(le,M.slice(we,X),D),we=X)}return le}function hr(F,j){var D=j||{},M=D.boundary||"SheetJS";M="------="+M;for(var X=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+M.slice(2)+'"',"","",""],G=F.FullPaths[0],oe=G,he=F.FileIndex[0],te=1;te<F.FullPaths.length;++te)if(oe=F.FullPaths[te].slice(G.length),he=F.FileIndex[te],!(!he.size||!he.content||oe=="Sh33tJ5")){oe=oe.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(He){return"_x"+He.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(He){return"_u"+He.charCodeAt(0).toString(16)+"_"});for(var se=he.content,le=dt&&Buffer.isBuffer(se)?se.toString("binary"):V(se),we=0,ye=Math.min(1024,le.length),Pe=0,ke=0;ke<=ye;++ke)(Pe=le.charCodeAt(ke))>=32&&Pe<128&&++we;var Ie=we>=ye*4/5;X.push(M),X.push("Content-Location: "+(D.root||"file:///C:/SheetJS/")+oe),X.push("Content-Transfer-Encoding: "+(Ie?"quoted-printable":"base64")),X.push("Content-Type: "+ei(he,oe)),X.push(""),X.push(Ie?ti(le):xi(le))}return X.push(M+`--\r
`),X.join(`\r
`)}function xt(F){var j={};return x(j,F),j}function vt(F,j,D,M){var X=M&&M.unsafe;X||x(F);var G=!X&&Ye.find(F,j);if(!G){var oe=F.FullPaths[0];j.slice(0,oe.length)==oe?oe=j:(oe.slice(-1)!="/"&&(oe+="/"),oe=(oe+j).replace("//","/")),G={name:i(j),type:2},F.FileIndex.push(G),F.FullPaths.push(oe),X||Ye.utils.cfb_gc(F)}return G.content=D,G.size=D?D.length:0,M&&(M.CLSID&&(G.clsid=M.CLSID),M.mt&&(G.mt=M.mt),M.ct&&(G.ct=M.ct)),G}function mr(F,j){x(F);var D=Ye.find(F,j);if(D){for(var M=0;M<F.FileIndex.length;++M)if(F.FileIndex[M]==D)return F.FileIndex.splice(M,1),F.FullPaths.splice(M,1),!0}return!1}function zr(F,j,D){x(F);var M=Ye.find(F,j);if(M){for(var X=0;X<F.FileIndex.length;++X)if(F.FileIndex[X]==M)return F.FileIndex[X].name=i(D),F.FullPaths[X]=D,!0}return!1}function mn(F){k(F,!0)}return e.find=T,e.read=b,e.parse=c,e.write=ue,e.writeFile=xe,e.utils={cfb_new:xt,cfb_add:vt,cfb_del:mr,cfb_mov:zr,cfb_gc:mn,ReadShift:ec,CheckField:dS,prep_blob:sn,bconcat:Kr,use_zlib:P,_deflateRaw:at,_inflateRaw:Ka,consts:ae},e}();let ka;function XQ(r){ka=r}function VQ(r){return typeof r=="string"?ch(r):Array.isArray(r)?gQ(r):r}function uh(r,e,t){if(typeof ka<"u"&&ka.writeFileSync)return t?ka.writeFileSync(r,e,t):ka.writeFileSync(r,e);if(typeof Deno<"u"){if(t&&typeof e=="string")switch(t){case"utf8":e=new TextEncoder(t).encode(e);break;case"binary":e=ch(e);break;default:throw new Error("Unsupported encoding "+t)}return Deno.writeFileSync(r,e)}var n=t=="utf8"?ys(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,r);if(typeof Blob<"u"){var i=new Blob([VQ(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,r);if(typeof saveAs<"u")return saveAs(i,r);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:r,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=r,a.href=s,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(r);return o.open("w"),o.encoding="binary",Array.isArray(e)&&(e=Xa(e)),o.write(e),o.close(),e}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+r)}function qQ(r){if(typeof ka<"u")return ka.readFileSync(r);if(typeof Deno<"u")return Deno.readFileSync(r);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(r);e.open("r"),e.encoding="binary";var t=e.read();return e.close(),t}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+r)}function Tr(r){for(var e=Object.keys(r),t=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(r,e[n])&&t.push(e[n]);return t}function qv(r,e){for(var t=[],n=Tr(r),i=0;i!==n.length;++i)t[r[n[i]][e]]==null&&(t[r[n[i]][e]]=n[i]);return t}function m0(r){for(var e=[],t=Tr(r),n=0;n!==t.length;++n)e[r[t[n]]]=t[n];return e}function g0(r){for(var e=[],t=Tr(r),n=0;n!==t.length;++n)e[r[t[n]]]=parseInt(t[n],10);return e}function jQ(r){for(var e=[],t=Tr(r),n=0;n!==t.length;++n)e[r[t[n]]]==null&&(e[r[t[n]]]=[]),e[r[t[n]]].push(t[n]);return e}var dd=new Date(1899,11,30,0,0,0);function Xr(r,e){var t=r.getTime(),n=dd.getTime()+(r.getTimezoneOffset()-dd.getTimezoneOffset())*6e4;return(t-n)/(24*60*60*1e3)}var Hk=new Date,zQ=dd.getTime()+(Hk.getTimezoneOffset()-dd.getTimezoneOffset())*6e4,jv=Hk.getTimezoneOffset();function O0(r){var e=new Date;return e.setTime(r*24*60*60*1e3+zQ),e.getTimezoneOffset()!==jv&&e.setTime(e.getTime()+(e.getTimezoneOffset()-jv)*6e4),e}function GQ(r){var e=0,t=0,n=!1,i=r.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+r+"| is not an ISO8601 Duration");for(var s=1;s!=i.length;++s)if(i[s]){switch(t=1,s>3&&(n=!0),i[s].slice(i[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[s].slice(i[s].length-1));case"D":t*=24;case"H":t*=60;case"M":if(n)t*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=t*parseInt(i[s],10)}return e}var zv=new Date("2017-02-19T19:06:09.000Z"),Yk=isNaN(zv.getFullYear())?new Date("2/19/17"):zv,HQ=Yk.getFullYear()==2017;function or(r,e){var t=new Date(r);if(HQ)return e>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):e<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(r instanceof Date)return r;if(Yk.getFullYear()==1917&&!isNaN(t.getFullYear())){var n=t.getFullYear();return r.indexOf(""+n)>-1||t.setFullYear(t.getFullYear()+100),t}var i=r.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return r.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function To(r,e){if(dt&&Buffer.isBuffer(r)){if(e){if(r[0]==255&&r[1]==254)return ys(r.slice(2).toString("utf16le"));if(r[1]==254&&r[2]==255)return ys(Mk(r.slice(2).toString("binary")))}return r.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(r[0]==255&&r[1]==254)return ys(new TextDecoder("utf-16le").decode(r.slice(2)));if(r[0]==254&&r[1]==255)return ys(new TextDecoder("utf-16be").decode(r.slice(2)))}var t={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(r)&&(r=new Uint8Array(r)),new TextDecoder("latin1").decode(r).replace(/[]/g,function(s){return t[s]||s})}catch{}for(var n=[],i=0;i!=r.length;++i)n.push(String.fromCharCode(r[i]));return n.join("")}function jt(r){if(typeof JSON<"u"&&!Array.isArray(r))return JSON.parse(JSON.stringify(r));if(typeof r!="object"||r==null)return r;if(r instanceof Date)return new Date(r.getTime());var e={};for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=jt(r[t]));return e}function br(r,e){for(var t="";t.length<e;)t+=r;return t}function Yi(r){var e=Number(r);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(r))return e;var t=1,n=r.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return t=-t,s}),!isNaN(e=Number(n)))?e/t:e}var YQ=["january","february","march","april","may","june","july","august","september","october","november","december"];function Al(r){var e=new Date(r),t=new Date(NaN),n=e.getYear(),i=e.getMonth(),s=e.getDate();if(isNaN(s))return t;var a=r.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&YQ.indexOf(a)==-1)return t}else if(a.match(/[a-z]/))return t;return n<0||n>8099?t:(i>0||s>1)&&n!=101?e:r.match(/[^-0-9:,\/\\]/)?t:e}var KQ=function(){var r="abacaba".split(/(:?b)/i).length==5;return function(t,n,i){if(r||typeof n=="string")return t.split(n);for(var s=t.split(n),a=[s[0]],o=1;o<s.length;++o)a.push(i),a.push(s[o]);return a}}();function Kk(r){return r?r.content&&r.type?To(r.content,!0):r.data?nl(r.data):r.asNodeBuffer&&dt?nl(r.asNodeBuffer().toString("binary")):r.asBinary?nl(r.asBinary()):r._data&&r._data.getContent?nl(To(Array.prototype.slice.call(r._data.getContent(),0))):null:null}function Jk(r){if(!r)return null;if(r.data)return fd(r.data);if(r.asNodeBuffer&&dt)return r.asNodeBuffer();if(r._data&&r._data.getContent){var e=r._data.getContent();return typeof e=="string"?fd(e):Array.prototype.slice.call(e)}return r.content&&r.type?r.content:null}function JQ(r){return r&&r.name.slice(-4)===".bin"?Jk(r):Kk(r)}function ki(r,e){for(var t=r.FullPaths||Tr(r.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),s=0;s<t.length;++s){var a=t[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==a||i==a)return r.files?r.files[t[s]]:r.FileIndex[s]}return null}function oO(r,e){var t=ki(r,e);if(t==null)throw new Error("Cannot find file "+e+" in zip");return t}function Nr(r,e,t){if(!t)return JQ(oO(r,e));if(!e)return null;try{return Nr(r,e)}catch{return null}}function li(r,e,t){if(!t)return Kk(oO(r,e));if(!e)return null;try{return li(r,e)}catch{return null}}function eF(r,e,t){return Jk(oO(r,e))}function Gv(r){for(var e=r.FullPaths||Tr(r.files),t=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&t.push(e[n].replace(/^Root Entry[\/]/,""));return t.sort()}function ct(r,e,t){if(r.FullPaths){if(typeof t=="string"){var n;return dt?n=na(t):n=OQ(t),Ye.utils.cfb_add(r,e,n)}Ye.utils.cfb_add(r,e,t)}else r.file(e,t)}function lO(){return Ye.utils.cfb_new()}function eS(r,e){switch(e.type){case"base64":return Ye.read(r,{type:"base64"});case"binary":return Ye.read(r,{type:"binary"});case"buffer":case"array":return Ye.read(r,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function Qf(r,e){if(r.charAt(0)=="/")return r.slice(1);var t=e.split("/");e.slice(-1)!="/"&&t.pop();for(var n=r.split("/");n.length!==0;){var i=n.shift();i===".."?t.pop():i!=="."&&t.push(i)}return t.join("/")}var Fr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,tF=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Hv=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,rF=/<[^>]*>/g,Pn=Fr.match(Hv)?Hv:rF,nF=/<\w*:/,iF=/<(\/?)\w+:/;function tt(r,e,t){for(var n={},i=0,s=0;i!==r.length&&!((s=r.charCodeAt(i))===32||s===10||s===13);++i);if(e||(n[0]=r.slice(0,i)),i===r.length)return n;var a=r.match(tF),o=0,l="",f=0,c="",h="",u=1;if(a)for(f=0;f!=a.length;++f){for(h=a[f],s=0;s!=h.length&&h.charCodeAt(s)!==61;++s);for(c=h.slice(0,s).trim();h.charCodeAt(s+1)==32;)++s;for(u=(i=h.charCodeAt(s+1))==34||i==39?1:0,l=h.slice(s+1+u,h.length-u),o=0;o!=c.length&&c.charCodeAt(o)!==58;++o);if(o===c.length)c.indexOf("_")>0&&(c=c.slice(0,c.indexOf("_"))),n[c]=l,n[c.toLowerCase()]=l;else{var d=(o===5&&c.slice(0,5)==="xmlns"?"xmlns":"")+c.slice(o+1);if(n[d]&&c.slice(o-3,o)=="ext")continue;n[d]=l,n[d.toLowerCase()]=l}}return n}function Ds(r){return r.replace(iF,"<$1")}var tS={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},fO=m0(tS),At=function(){var r=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function t(n){var i=n+"",s=i.indexOf("<![CDATA[");if(s==-1)return i.replace(r,function(o,l){return tS[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(e,function(o,l){return String.fromCharCode(parseInt(l,16))});var a=i.indexOf("]]>");return t(i.slice(0,s))+i.slice(s+9,a)+t(i.slice(a+3))}}(),cO=/[&<>'"]/g,sF=/[\u0000-\u0008\u000b-\u001f]/g;function Bt(r){var e=r+"";return e.replace(cO,function(t){return fO[t]}).replace(sF,function(t){return"_x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Yv(r){return Bt(r).replace(/ /g,"_x0020_")}var rS=/[\u0000-\u001f]/g;function hO(r){var e=r+"";return e.replace(cO,function(t){return fO[t]}).replace(/\n/g,"<br/>").replace(rS,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}function aF(r){var e=r+"";return e.replace(cO,function(t){return fO[t]}).replace(rS,function(t){return"&#x"+t.charCodeAt(0).toString(16).toUpperCase()+";"})}var Kv=function(){var r=/&#(\d+);/g;function e(t,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(r,e)}}();function oF(r){return r.replace(/(\r\n|[\r\n])/g,"&#10;")}function sr(r){switch(r){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function rp(r){for(var e="",t=0,n=0,i=0,s=0,a=0,o=0;t<r.length;){if(n=r.charCodeAt(t++),n<128){e+=String.fromCharCode(n);continue}if(i=r.charCodeAt(t++),n>191&&n<224){a=(n&31)<<6,a|=i&63,e+=String.fromCharCode(a);continue}if(s=r.charCodeAt(t++),n<240){e+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}a=r.charCodeAt(t++),o=((n&7)<<18|(i&63)<<12|(s&63)<<6|a&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function Jv(r){var e=Ra(2*r.length),t,n,i=1,s=0,a=0,o;for(n=0;n<r.length;n+=i)i=1,(o=r.charCodeAt(n))<128?t=o:o<224?(t=(o&31)*64+(r.charCodeAt(n+1)&63),i=2):o<240?(t=(o&15)*4096+(r.charCodeAt(n+1)&63)*64+(r.charCodeAt(n+2)&63),i=3):(i=4,t=(o&7)*262144+(r.charCodeAt(n+1)&63)*4096+(r.charCodeAt(n+2)&63)*64+(r.charCodeAt(n+3)&63),t-=65536,a=55296+(t>>>10&1023),t=56320+(t&1023)),a!==0&&(e[s++]=a&255,e[s++]=a>>>8,a=0),e[s++]=t%256,e[s++]=t>>>8;return e.slice(0,s).toString("ucs2")}function ey(r){return na(r,"binary").toString("utf8")}var Nh="foo bar baz",Zt=dt&&(ey(Nh)==rp(Nh)&&ey||Jv(Nh)==rp(Nh)&&Jv)||rp,ys=dt?function(r){return na(r,"utf8").toString("binary")}:function(r){for(var e=[],t=0,n=0,i=0;t<r.length;)switch(n=r.charCodeAt(t++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=r.charCodeAt(t++)-56320+(n<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},vc=function(){var r={};return function(t,n){var i=t+"|"+(n||"");return r[i]?r[i]:r[i]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",n||"")}}(),nS=function(){var r=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(t){for(var n=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<r.length;++i)n=n.replace(r[i][0],r[i][1]);return n}}(),lF=function(){var r={};return function(t){return r[t]!==void 0?r[t]:r[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}}(),fF=/<\/?(?:vt:)?variant>/g,cF=/<(?:vt:)([^>]*)>([\s\S]*)</;function ty(r,e){var t=tt(r),n=r.match(lF(t.baseType))||[],i=[];if(n.length!=t.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+t.size);return i}return n.forEach(function(s){var a=s.replace(fF,"").match(cF);a&&i.push({v:Zt(a[2]),t:a[1]})}),i}var iS=/(^\s|\s$|\n)/;function un(r,e){return"<"+r+(e.match(iS)?' xml:space="preserve"':"")+">"+e+"</"+r+">"}function yc(r){return Tr(r).map(function(e){return" "+e+'="'+r[e]+'"'}).join("")}function $e(r,e,t){return"<"+r+(t!=null?yc(t):"")+(e!=null?(e.match(iS)?' xml:space="preserve"':"")+">"+e+"</"+r:"/")+">"}function Fm(r,e){try{return r.toISOString().replace(/\.\d*/,"")}catch(t){if(e)throw t}return""}function hF(r,e){switch(typeof r){case"string":var t=$e("vt:lpwstr",Bt(r));return t=t.replace(/&quot;/g,"_x0022_"),t;case"number":return $e((r|0)==r?"vt:i4":"vt:r8",Bt(String(r)));case"boolean":return $e("vt:bool",r?"true":"false")}if(r instanceof Date)return $e("vt:filetime",Fm(r));throw new Error("Unable to serialize "+r)}function uO(r){if(dt&&Buffer.isBuffer(r))return r.toString("utf8");if(typeof r=="string")return r;if(typeof Uint8Array<"u"&&r instanceof Uint8Array)return Zt(Xa(iO(r)));throw new Error("Bad input format: expected Buffer or string")}var wc=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Ur={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Lo=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],ai={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function uF(r,e){for(var t=1-2*(r[e+7]>>>7),n=((r[e+7]&127)<<4)+(r[e+6]>>>4&15),i=r[e+6]&15,s=5;s>=0;--s)i=i*256+r[e+s];return n==2047?i==0?t*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),t*Math.pow(2,n-52)*i)}function dF(r,e,t){var n=(e<0||1/e==-1/0?1:0)<<7,i=0,s=0,a=n?-e:e;isFinite(a)?a==0?i=s=0:(i=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(e)?26985:0);for(var o=0;o<=5;++o,s/=256)r[t+o]=s&255;r[t+6]=(i&15)<<4|s&15,r[t+7]=i>>4|n}var ry=function(r){for(var e=[],t=10240,n=0;n<r[0].length;++n)if(r[0][n])for(var i=0,s=r[0][n].length;i<s;i+=t)e.push.apply(e,r[0][n].slice(i,i+t));return e},ny=dt?function(r){return r[0].length>0&&Buffer.isBuffer(r[0][0])?Buffer.concat(r[0].map(function(e){return Buffer.isBuffer(e)?e:na(e)})):ry(r)}:ry,iy=function(r,e,t){for(var n=[],i=e;i<t;i+=2)n.push(String.fromCharCode(qs(r,i)));return n.join("").replace(Sn,"")},x0=dt?function(r,e,t){return Buffer.isBuffer(r)?r.toString("utf16le",e,t).replace(Sn,""):iy(r,e,t)}:iy,sy=function(r,e,t){for(var n=[],i=e;i<e+t;++i)n.push(("0"+r[i].toString(16)).slice(-2));return n.join("")},sS=dt?function(r,e,t){return Buffer.isBuffer(r)?r.toString("hex",e,e+t):sy(r,e,t)}:sy,ay=function(r,e,t){for(var n=[],i=e;i<t;i++)n.push(String.fromCharCode(el(r,i)));return n.join("")},tf=dt?function(e,t,n){return Buffer.isBuffer(e)?e.toString("utf8",t,n):ay(e,t,n)}:ay,aS=function(r,e){var t=Hr(r,e);return t>0?tf(r,e+4,e+4+t-1):""},dO=aS,oS=function(r,e){var t=Hr(r,e);return t>0?tf(r,e+4,e+4+t-1):""},pO=oS,lS=function(r,e){var t=2*Hr(r,e);return t>0?tf(r,e+4,e+4+t-1):""},mO=lS,fS=function(e,t){var n=Hr(e,t);return n>0?x0(e,t+4,t+4+n):""},gO=fS,cS=function(r,e){var t=Hr(r,e);return t>0?tf(r,e+4,e+4+t):""},OO=cS,hS=function(r,e){return uF(r,e)},pd=hS,xO=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};dt&&(dO=function(e,t){if(!Buffer.isBuffer(e))return aS(e,t);var n=e.readUInt32LE(t);return n>0?e.toString("utf8",t+4,t+4+n-1):""},pO=function(e,t){if(!Buffer.isBuffer(e))return oS(e,t);var n=e.readUInt32LE(t);return n>0?e.toString("utf8",t+4,t+4+n-1):""},mO=function(e,t){if(!Buffer.isBuffer(e))return lS(e,t);var n=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+n-1)},gO=function(e,t){if(!Buffer.isBuffer(e))return fS(e,t);var n=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+n)},OO=function(e,t){if(!Buffer.isBuffer(e))return cS(e,t);var n=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+n)},pd=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):hS(e,t)},xO=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});function uS(){x0=function(r,e,t){return St.utils.decode(1200,r.slice(e,t)).replace(Sn,"")},tf=function(r,e,t){return St.utils.decode(65001,r.slice(e,t))},dO=function(r,e){var t=Hr(r,e);return t>0?St.utils.decode(ko,r.slice(e+4,e+4+t-1)):""},pO=function(r,e){var t=Hr(r,e);return t>0?St.utils.decode(mi,r.slice(e+4,e+4+t-1)):""},mO=function(r,e){var t=2*Hr(r,e);return t>0?St.utils.decode(1200,r.slice(e+4,e+4+t-1)):""},gO=function(r,e){var t=Hr(r,e);return t>0?St.utils.decode(1200,r.slice(e+4,e+4+t)):""},OO=function(r,e){var t=Hr(r,e);return t>0?St.utils.decode(65001,r.slice(e+4,e+4+t)):""}}typeof St<"u"&&uS();var el=function(r,e){return r[e]},qs=function(r,e){return r[e+1]*256+r[e]},pF=function(r,e){var t=r[e+1]*256+r[e];return t<32768?t:(65535-t+1)*-1},Hr=function(r,e){return r[e+3]*(1<<24)+(r[e+2]<<16)+(r[e+1]<<8)+r[e]},lo=function(r,e){return r[e+3]<<24|r[e+2]<<16|r[e+1]<<8|r[e]},mF=function(r,e){return r[e]<<24|r[e+1]<<16|r[e+2]<<8|r[e+3]};function ec(r,e){var t="",n,i,s=[],a,o,l,f;switch(e){case"dbcs":if(f=this.l,dt&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*r).toString("utf16le");else for(l=0;l<r;++l)t+=String.fromCharCode(qs(this,f)),f+=2;r*=2;break;case"utf8":t=tf(this,this.l,this.l+r);break;case"utf16le":r*=2,t=x0(this,this.l,this.l+r);break;case"wstr":if(typeof St<"u")t=St.utils.decode(mi,this.slice(this.l,this.l+2*r));else return ec.call(this,r,"dbcs");r=2*r;break;case"lpstr-ansi":t=dO(this,this.l),r=4+Hr(this,this.l);break;case"lpstr-cp":t=pO(this,this.l),r=4+Hr(this,this.l);break;case"lpwstr":t=mO(this,this.l),r=4+2*Hr(this,this.l);break;case"lpp4":r=4+Hr(this,this.l),t=gO(this,this.l),r&2&&(r+=2);break;case"8lpp4":r=4+Hr(this,this.l),t=OO(this,this.l),r&3&&(r+=4-(r&3));break;case"cstr":for(r=0,t="";(a=el(this,this.l+r++))!==0;)s.push(Pf(a));t=s.join("");break;case"_wstr":for(r=0,t="";(a=qs(this,this.l+r))!==0;)s.push(Pf(a)),r+=2;r+=2,t=s.join("");break;case"dbcs-cont":for(t="",f=this.l,l=0;l<r;++l){if(this.lens&&this.lens.indexOf(f)!==-1)return a=el(this,f),this.l=f+1,o=ec.call(this,r-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Pf(qs(this,f))),f+=2}t=s.join(""),r*=2;break;case"cpstr":if(typeof St<"u"){t=St.utils.decode(mi,this.slice(this.l,this.l+r));break}case"sbcs-cont":for(t="",f=this.l,l=0;l!=r;++l){if(this.lens&&this.lens.indexOf(f)!==-1)return a=el(this,f),this.l=f+1,o=ec.call(this,r-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Pf(el(this,f))),f+=1}t=s.join("");break;default:switch(r){case 1:return n=el(this,this.l),this.l++,n;case 2:return n=(e==="i"?pF:qs)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(n=(r>0?lo:mF)(this,this.l),this.l+=4,n):(i=Hr(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return r==8?i=pd(this,this.l):i=pd([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;r=8;case 16:t=sS(this,this.l,r);break}}return this.l+=r,t}var gF=function(r,e,t){r[t]=e&255,r[t+1]=e>>>8&255,r[t+2]=e>>>16&255,r[t+3]=e>>>24&255},OF=function(r,e,t){r[t]=e&255,r[t+1]=e>>8&255,r[t+2]=e>>16&255,r[t+3]=e>>24&255},xF=function(r,e,t){r[t]=e&255,r[t+1]=e>>>8&255};function vF(r,e,t){var n=0,i=0;if(t==="dbcs"){for(i=0;i!=e.length;++i)xF(this,e.charCodeAt(i),this.l+2*i);n=2*e.length}else if(t==="sbcs"){if(typeof St<"u"&&ko==874)for(i=0;i!=e.length;++i){var s=St.utils.encode(ko,e.charAt(i));this[this.l+i]=s[0]}else for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;n=e.length}else if(t==="hex"){for(;i<r;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(t==="utf16le"){var a=Math.min(this.l+r,this.length);for(i=0;i<Math.min(e.length,r);++i){var o=e.charCodeAt(i);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(r){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,gF(this,e,this.l);break;case 8:if(n=8,t==="f"){dF(this,e,this.l);break}case 16:break;case-4:n=4,OF(this,e,this.l);break}return this.l+=n,this}function dS(r,e){var t=sS(this,this.l,r.length>>1);if(t!==r)throw new Error(e+"Expected "+r+" saw "+t);this.l+=r.length>>1}function sn(r,e){r.l=e,r.read_shift=ec,r.chk=dS,r.write_shift=vF}function Cn(r,e){r.l+=e}function me(r){var e=Ra(r);return sn(e,0),e}function ia(r,e,t){if(r){var n,i,s;sn(r,r.l||0);for(var a=r.length,o=0,l=0;r.l<a;){o=r.read_shift(1),o&128&&(o=(o&127)+((r.read_shift(1)&127)<<7));var f=Cc[o]||Cc[65535];for(n=r.read_shift(1),s=n&127,i=1;i<4&&n&128;++i)s+=((n=r.read_shift(1))&127)<<7*i;l=r.l+s;var c=f.f&&f.f(r,s,t);if(r.l=l,e(c,f,o))return}}}function Kn(){var r=[],e=dt?256:2048,t=function(f){var c=me(f);return sn(c,0),c},n=t(e),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&r.push(n),n=null)},s=function(f){return n&&f<n.length-n.l?n:(i(),n=t(Math.max(f+1,e)))},a=function(){return i(),Kr(r)},o=function(f){i(),n=f,n.l==null&&(n.l=n.length),s(e)};return{next:s,push:o,end:a,_bufs:r}}function _e(r,e,t,n){var i=+e,s;if(!isNaN(i)){n||(n=Cc[i].p||(t||[]).length||0),s=1+(i>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var a=r.next(s);i<=127?a.write_shift(1,i):(a.write_shift(1,(i&127)+128),a.write_shift(1,i>>7));for(var o=0;o!=4;++o)if(n>=128)a.write_shift(1,(n&127)+128),n>>=7;else{a.write_shift(1,n);break}n>0&&xO(t)&&r.push(t)}}function tc(r,e,t){var n=jt(r);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!t||t.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function oy(r,e,t){var n=jt(r);return n.s=tc(n.s,e.s,t),n.e=tc(n.e,e.s,t),n}function rc(r,e){if(r.cRel&&r.c<0)for(r=jt(r);r.c<0;)r.c+=e>8?16384:256;if(r.rRel&&r.r<0)for(r=jt(r);r.r<0;)r.r+=e>8?1048576:e>5?65536:16384;var t=et(r);return!r.cRel&&r.cRel!=null&&(t=bF(t)),!r.rRel&&r.rRel!=null&&(t=yF(t)),t}function np(r,e){return r.s.r==0&&!r.s.rRel&&r.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!r.e.rRel?(r.s.cRel?"":"$")+ar(r.s.c)+":"+(r.e.cRel?"":"$")+ar(r.e.c):r.s.c==0&&!r.s.cRel&&r.e.c==(e.biff>=12?16383:255)&&!r.e.cRel?(r.s.rRel?"":"$")+kr(r.s.r)+":"+(r.e.rRel?"":"$")+kr(r.e.r):rc(r.s,e.biff)+":"+rc(r.e,e.biff)}function vO(r){return parseInt(wF(r),10)-1}function kr(r){return""+(r+1)}function yF(r){return r.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function wF(r){return r.replace(/\$(\d+)$/,"$1")}function yO(r){for(var e=_F(r),t=0,n=0;n!==e.length;++n)t=26*t+e.charCodeAt(n)-64;return t-1}function ar(r){if(r<0)throw new Error("invalid column "+r);var e="";for(++r;r;r=Math.floor((r-1)/26))e=String.fromCharCode((r-1)%26+65)+e;return e}function bF(r){return r.replace(/^([A-Z])/,"$$$1")}function _F(r){return r.replace(/^\$([A-Z])/,"$1")}function kF(r){return r.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function xr(r){for(var e=0,t=0,n=0;n<r.length;++n){var i=r.charCodeAt(n);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(t=26*t+(i-64))}return{c:t-1,r:e-1}}function et(r){for(var e=r.c+1,t="";e;e=(e-1)/26|0)t=String.fromCharCode((e-1)%26+65)+t;return t+(r.r+1)}function Ln(r){var e=r.indexOf(":");return e==-1?{s:xr(r),e:xr(r)}:{s:xr(r.slice(0,e)),e:xr(r.slice(e+1))}}function lt(r,e){return typeof e>"u"||typeof e=="number"?lt(r.s,r.e):(typeof r!="string"&&(r=et(r)),typeof e!="string"&&(e=et(e)),r==e?r:r+":"+e)}function yt(r){var e={s:{c:0,r:0},e:{c:0,r:0}},t=0,n=0,i=0,s=r.length;for(t=0;n<s&&!((i=r.charCodeAt(n)-64)<1||i>26);++n)t=26*t+i;for(e.s.c=--t,t=0;n<s&&!((i=r.charCodeAt(n)-48)<0||i>9);++n)t=10*t+i;if(e.s.r=--t,n===s||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,t=0;n!=s&&!((i=r.charCodeAt(n)-64)<1||i>26);++n)t=26*t+i;for(e.e.c=--t,t=0;n!=s&&!((i=r.charCodeAt(n)-48)<0||i>9);++n)t=10*t+i;return e.e.r=--t,e}function ly(r,e){var t=r.t=="d"&&e instanceof Date;if(r.z!=null)try{return r.w=Oi(r.z,t?Xr(e):e)}catch{}try{return r.w=Oi((r.XF||{}).numFmtId||(t?14:0),t?Xr(e):e)}catch{return""+e}}function As(r,e,t){return r==null||r.t==null||r.t=="z"?"":r.w!==void 0?r.w:(r.t=="d"&&!r.z&&t&&t.dateNF&&(r.z=t.dateNF),r.t=="e"?sa[r.v]||r.v:e==null?ly(r,r.v):ly(r,e))}function Va(r,e){var t=e&&e.sheet?e.sheet:"Sheet1",n={};return n[t]=r,{SheetNames:[t],Sheets:n}}function pS(r,e,t){var n=t||{},i=r?Array.isArray(r):n.dense,s=r||(i?[]:{}),a=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?xr(n.origin):n.origin;a=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var f={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var c=yt(s["!ref"]);f.s.c=c.s.c,f.s.r=c.s.r,f.e.c=Math.max(f.e.c,c.e.c),f.e.r=Math.max(f.e.r,c.e.r),a==-1&&(f.e.r=a=c.e.r+1)}for(var h=0;h!=e.length;++h)if(e[h]){if(!Array.isArray(e[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var u=0;u!=e[h].length;++u)if(!(typeof e[h][u]>"u")){var d={v:e[h][u]},p=a+h,m=o+u;if(f.s.r>p&&(f.s.r=p),f.s.c>m&&(f.s.c=m),f.e.r<p&&(f.e.r=p),f.e.c<m&&(f.e.c=m),e[h][u]&&typeof e[h][u]=="object"&&!Array.isArray(e[h][u])&&!(e[h][u]instanceof Date))d=e[h][u];else if(Array.isArray(d.v)&&(d.f=e[h][u][1],d.v=d.v[0]),d.v===null)if(d.f)d.t="n";else if(n.nullError)d.t="e",d.v=0;else if(n.sheetStubs)d.t="z";else continue;else typeof d.v=="number"?d.t="n":typeof d.v=="boolean"?d.t="b":d.v instanceof Date?(d.z=n.dateNF||Ke[14],n.cellDates?(d.t="d",d.w=Oi(d.z,Xr(d.v))):(d.t="n",d.v=Xr(d.v),d.w=Oi(d.z,d.v))):d.t="s";if(i)s[p]||(s[p]=[]),s[p][m]&&s[p][m].z&&(d.z=s[p][m].z),s[p][m]=d;else{var g=et({c:m,r:p});s[g]&&s[g].z&&(d.z=s[g].z),s[g]=d}}}return f.s.c<1e7&&(s["!ref"]=lt(f)),s}function rf(r,e){return pS(null,r,e)}function SF(r){return r.read_shift(4,"i")}function Ki(r,e){return e||(e=me(4)),e.write_shift(4,r),e}function Tn(r){var e=r.read_shift(4);return e===0?"":r.read_shift(e,"dbcs")}function en(r,e){var t=!1;return e==null&&(t=!0,e=me(4+2*r.length)),e.write_shift(4,r.length),r.length>0&&e.write_shift(0,r,"dbcs"),t?e.slice(0,e.l):e}function TF(r){return{ich:r.read_shift(2),ifnt:r.read_shift(2)}}function CF(r,e){return e||(e=me(4)),e.write_shift(2,0),e.write_shift(2,0),e}function wO(r,e){var t=r.l,n=r.read_shift(1),i=Tn(r),s=[],a={t:i,h:i};if(n&1){for(var o=r.read_shift(4),l=0;l!=o;++l)s.push(TF(r));a.r=s}else a.r=[{ich:0,ifnt:0}];return r.l=t+e,a}function AF(r,e){var t=!1;return e==null&&(t=!0,e=me(15+4*r.t.length)),e.write_shift(1,0),en(r.t,e),t?e.slice(0,e.l):e}var EF=wO;function PF(r,e){var t=!1;return e==null&&(t=!0,e=me(23+4*r.t.length)),e.write_shift(1,1),en(r.t,e),e.write_shift(4,1),CF({ich:0,ifnt:0},e),t?e.slice(0,e.l):e}function Ii(r){var e=r.read_shift(4),t=r.read_shift(2);return t+=r.read_shift(1)<<16,r.l++,{c:e,iStyleRef:t}}function Bo(r,e){return e==null&&(e=me(8)),e.write_shift(-4,r.c),e.write_shift(3,r.iStyleRef||r.s),e.write_shift(1,0),e}function Zo(r){var e=r.read_shift(2);return e+=r.read_shift(1)<<16,r.l++,{c:-1,iStyleRef:e}}function Wo(r,e){return e==null&&(e=me(4)),e.write_shift(3,r.iStyleRef||r.s),e.write_shift(1,0),e}var RF=Tn,mS=en;function bO(r){var e=r.read_shift(4);return e===0||e===4294967295?"":r.read_shift(e,"dbcs")}function md(r,e){var t=!1;return e==null&&(t=!0,e=me(127)),e.write_shift(4,r.length>0?r.length:4294967295),r.length>0&&e.write_shift(0,r,"dbcs"),t?e.slice(0,e.l):e}var QF=Tn,$m=bO,_O=md;function kO(r){var e=r.slice(r.l,r.l+4),t=e[0]&1,n=e[0]&2;r.l+=4;var i=n===0?pd([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):lo(e,0)>>2;return t?i/100:i}function gS(r,e){e==null&&(e=me(4));var t=0,n=0,i=r*100;if(r==(r|0)&&r>=-536870912&&r<1<<29?n=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(n=1,t=1),n)e.write_shift(-4,((t?i:r)<<2)+(t+2));else throw new Error("unsupported RkNumber "+r)}function OS(r){var e={s:{},e:{}};return e.s.r=r.read_shift(4),e.e.r=r.read_shift(4),e.s.c=r.read_shift(4),e.e.c=r.read_shift(4),e}function FF(r,e){return e||(e=me(16)),e.write_shift(4,r.s.r),e.write_shift(4,r.e.r),e.write_shift(4,r.s.c),e.write_shift(4,r.e.c),e}var Uo=OS,nf=FF;function bn(r){if(r.length-r.l<8)throw"XLS Xnum Buffer underflow";return r.read_shift(8,"f")}function Co(r,e){return(e||me(8)).write_shift(8,r,"f")}function $F(r){var e={},t=r.read_shift(1),n=t>>>1,i=r.read_shift(1),s=r.read_shift(2,"i"),a=r.read_shift(1),o=r.read_shift(1),l=r.read_shift(1);switch(r.l++,n){case 0:e.auto=1;break;case 1:e.index=i;var f=go[i];f&&(e.rgb=_c(f));break;case 2:e.rgb=_c([a,o,l]);break;case 3:e.theme=i;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function gd(r,e){if(e||(e=me(8)),!r||r.auto)return e.write_shift(4,0),e.write_shift(4,0),e;r.index!=null?(e.write_shift(1,2),e.write_shift(1,r.index)):r.theme!=null?(e.write_shift(1,6),e.write_shift(1,r.theme)):(e.write_shift(1,5),e.write_shift(1,0));var t=r.tint||0;if(t>0?t*=32767:t<0&&(t*=32768),e.write_shift(2,t),!r.rgb||r.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=r.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function DF(r){var e=r.read_shift(1);r.l++;var t={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return t}function NF(r,e){e||(e=me(2));var t=(r.italic?2:0)|(r.strike?8:0)|(r.outline?16:0)|(r.shadow?32:0)|(r.condense?64:0)|(r.extend?128:0);return e.write_shift(1,t),e.write_shift(1,0),e}function xS(r,e){var t={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=r.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return t[r.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return r.l-=4,r.read_shift(0,e==1?"lpstr":"lpwstr")}function MF(r){return xS(r,1)}function IF(r){return xS(r,2)}var SO=2,Vn=3,Mh=11,fy=12,Od=19,Ih=64,LF=65,BF=71,ZF=4108,WF=4126,Gr=80,vS=81,UF=[Gr,vS],Dm={1:{n:"CodePage",t:SO},2:{n:"Category",t:Gr},3:{n:"PresentationFormat",t:Gr},4:{n:"ByteCount",t:Vn},5:{n:"LineCount",t:Vn},6:{n:"ParagraphCount",t:Vn},7:{n:"SlideCount",t:Vn},8:{n:"NoteCount",t:Vn},9:{n:"HiddenCount",t:Vn},10:{n:"MultimediaClipCount",t:Vn},11:{n:"ScaleCrop",t:Mh},12:{n:"HeadingPairs",t:ZF},13:{n:"TitlesOfParts",t:WF},14:{n:"Manager",t:Gr},15:{n:"Company",t:Gr},16:{n:"LinksUpToDate",t:Mh},17:{n:"CharacterCount",t:Vn},19:{n:"SharedDoc",t:Mh},22:{n:"HyperlinksChanged",t:Mh},23:{n:"AppVersion",t:Vn,p:"version"},24:{n:"DigSig",t:LF},26:{n:"ContentType",t:Gr},27:{n:"ContentStatus",t:Gr},28:{n:"Language",t:Gr},29:{n:"Version",t:Gr},255:{},2147483648:{n:"Locale",t:Od},2147483651:{n:"Behavior",t:Od},1919054434:{}},Nm={1:{n:"CodePage",t:SO},2:{n:"Title",t:Gr},3:{n:"Subject",t:Gr},4:{n:"Author",t:Gr},5:{n:"Keywords",t:Gr},6:{n:"Comments",t:Gr},7:{n:"Template",t:Gr},8:{n:"LastAuthor",t:Gr},9:{n:"RevNumber",t:Gr},10:{n:"EditTime",t:Ih},11:{n:"LastPrinted",t:Ih},12:{n:"CreatedDate",t:Ih},13:{n:"ModifiedDate",t:Ih},14:{n:"PageCount",t:Vn},15:{n:"WordCount",t:Vn},16:{n:"CharCount",t:Vn},17:{n:"Thumbnail",t:BF},18:{n:"Application",t:Gr},19:{n:"DocSecurity",t:Vn},255:{},2147483648:{n:"Locale",t:Od},2147483651:{n:"Behavior",t:Od},1919054434:{}},cy={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},XF=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function VF(r){return r.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var qF=VF([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),go=jt(qF),sa={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},yS={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Mm={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Lh={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function TO(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function jF(r){var e=TO();if(!r||!r.match)return e;var t={};if((r.match(Pn)||[]).forEach(function(n){var i=tt(n);switch(i[0].replace(nF,"<")){case"<?xml":break;case"<Types":e.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":t[i.Extension]=i.ContentType;break;case"<Override":e[Mm[i.ContentType]]!==void 0&&e[Mm[i.ContentType]].push(i.PartName);break}}),e.xmlns!==Ur.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=t,delete e.calcchains,e}function wS(r,e){var t=jQ(Mm),n=[],i;n[n.length]=Fr,n[n.length]=$e("Types",null,{xmlns:Ur.CT,"xmlns:xsd":Ur.xsd,"xmlns:xsi":Ur.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return $e("Default",null,{Extension:l[0],ContentType:l[1]})}));var s=function(l){r[l]&&r[l].length>0&&(i=r[l][0],n[n.length]=$e("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:Lh[l][e.bookType]||Lh[l].xlsx}))},a=function(l){(r[l]||[]).forEach(function(f){n[n.length]=$e("Override",null,{PartName:(f[0]=="/"?"":"/")+f,ContentType:Lh[l][e.bookType]||Lh[l].xlsx})})},o=function(l){(r[l]||[]).forEach(function(f){n[n.length]=$e("Override",null,{PartName:(f[0]=="/"?"":"/")+f,ContentType:t[l][0]})})};return s("workbooks"),a("sheets"),a("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),a("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var pt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function bc(r){var e=r.lastIndexOf("/");return r.slice(0,e+1)+"_rels/"+r.slice(e+1)+".rels"}function nc(r,e){var t={"!id":{}};if(!r)return t;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(r.match(Pn)||[]).forEach(function(i){var s=tt(i);if(s[0]==="<Relationship"){var a={};a.Type=s.Type,a.Target=s.Target,a.Id=s.Id,s.TargetMode&&(a.TargetMode=s.TargetMode);var o=s.TargetMode==="External"?s.Target:Qf(s.Target,e);t[o]=a,n[s.Id]=a}}),t["!id"]=n,t}function pl(r){var e=[Fr,$e("Relationships",null,{xmlns:Ur.RELS})];return Tr(r["!id"]).forEach(function(t){e[e.length]=$e("Relationship",null,r["!id"][t])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function Lt(r,e,t,n,i,s){if(i||(i={}),r["!id"]||(r["!id"]={}),r["!idx"]||(r["!idx"]=1),e<0)for(e=r["!idx"];r["!id"]["rId"+e];++e);if(r["!idx"]=e+1,i.Id="rId"+e,i.Type=n,i.Target=t,[pt.HLINK,pt.XPATH,pt.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),r["!id"][i.Id])throw new Error("Cannot rewrite rId "+e);return r["!id"][i.Id]=i,r[("/"+i.Target).replace("//","/")]=i,e}var zF="application/vnd.oasis.opendocument.spreadsheet";function GF(r,e){for(var t=uO(r),n,i;n=wc.exec(t);)switch(n[3]){case"manifest":break;case"file-entry":if(i=tt(n[0],!1),i.path=="/"&&i.type!==zF)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}function HF(r){var e=[Fr];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var t=0;t<r.length;++t)e.push('  <manifest:file-entry manifest:full-path="'+r[t][0]+'" manifest:media-type="'+r[t][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function hy(r,e,t){return['  <rdf:Description rdf:about="'+r+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(t||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function YF(r,e){return['  <rdf:Description rdf:about="'+r+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function KF(r){var e=[Fr];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var t=0;t!=r.length;++t)e.push(hy(r[t][0],r[t][1])),e.push(YF("",r[t][0]));return e.push(hy("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function bS(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+gc.version+"</meta:generator></office:meta></office:document-meta>"}var Fi=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],JF=function(){for(var r=new Array(Fi.length),e=0;e<Fi.length;++e){var t=Fi[e],n="(?:"+t[0].slice(0,t[0].indexOf(":"))+":)"+t[0].slice(t[0].indexOf(":")+1);r[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return r}();function _S(r){var e={};r=Zt(r);for(var t=0;t<Fi.length;++t){var n=Fi[t],i=r.match(JF[t]);i!=null&&i.length>0&&(e[n[1]]=At(i[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=or(e[n[1]]))}return e}function ip(r,e,t,n,i){i[r]!=null||e==null||e===""||(i[r]=e,e=Bt(e),n[n.length]=t?$e(r,e,t):un(r,e))}function kS(r,e){var t=e||{},n=[Fr,$e("cp:coreProperties",null,{"xmlns:cp":Ur.CORE_PROPS,"xmlns:dc":Ur.dc,"xmlns:dcterms":Ur.dcterms,"xmlns:dcmitype":Ur.dcmitype,"xmlns:xsi":Ur.xsi})],i={};if(!r&&!t.Props)return n.join("");r&&(r.CreatedDate!=null&&ip("dcterms:created",typeof r.CreatedDate=="string"?r.CreatedDate:Fm(r.CreatedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),r.ModifiedDate!=null&&ip("dcterms:modified",typeof r.ModifiedDate=="string"?r.ModifiedDate:Fm(r.ModifiedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var s=0;s!=Fi.length;++s){var a=Fi[s],o=t.Props&&t.Props[a[1]]!=null?t.Props[a[1]]:r?r[a[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&ip(a[0],o,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Oo=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],SS=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function TS(r,e,t,n){var i=[];if(typeof r=="string")i=ty(r,n);else for(var s=0;s<r.length;++s)i=i.concat(r[s].map(function(c){return{v:c}}));var a=typeof e=="string"?ty(e,n).map(function(c){return c.v}):e,o=0,l=0;if(a.length>0)for(var f=0;f!==i.length;f+=2){switch(l=+i[f+1].v,i[f].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":t.Worksheets=l,t.SheetNames=a.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":t.NamedRanges=l,t.DefinedNames=a.slice(o,o+l);break;case"Charts":case"Diagramme":t.Chartsheets=l,t.ChartNames=a.slice(o,o+l);break}o+=l}}function e$(r,e,t){var n={};return e||(e={}),r=Zt(r),Oo.forEach(function(i){var s=(r.match(vc(i[0]))||[])[1];switch(i[2]){case"string":s&&(e[i[1]]=At(s));break;case"bool":e[i[1]]=s==="true";break;case"raw":var a=r.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));a&&a.length>0&&(n[i[1]]=a[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&TS(n.HeadingPairs,n.TitlesOfParts,e,t),e}function CS(r){var e=[],t=$e;return r||(r={}),r.Application="SheetJS",e[e.length]=Fr,e[e.length]=$e("Properties",null,{xmlns:Ur.EXT_PROPS,"xmlns:vt":Ur.vt}),Oo.forEach(function(n){if(r[n[1]]!==void 0){var i;switch(n[2]){case"string":i=Bt(String(r[n[1]]));break;case"bool":i=r[n[1]]?"true":"false";break}i!==void 0&&(e[e.length]=t(n[0],i))}}),e[e.length]=t("HeadingPairs",t("vt:vector",t("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+t("vt:variant",t("vt:i4",String(r.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=t("TitlesOfParts",t("vt:vector",r.SheetNames.map(function(n){return"<vt:lpstr>"+Bt(n)+"</vt:lpstr>"}).join(""),{size:r.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var t$=/<[^>]+>[^<]*/g;function r$(r,e){var t={},n="",i=r.match(t$);if(i)for(var s=0;s!=i.length;++s){var a=i[s],o=tt(a);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=At(o.name);break;case"</property>":n=null;break;default:if(a.indexOf("<vt:")===0){var l=a.split(">"),f=l[0].slice(4),c=l[1];switch(f){case"lpstr":case"bstr":case"lpwstr":t[n]=At(c);break;case"bool":t[n]=sr(c);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":t[n]=parseInt(c,10);break;case"r4":case"r8":case"decimal":t[n]=parseFloat(c);break;case"filetime":case"date":t[n]=or(c);break;case"cy":case"error":t[n]=At(c);break;default:if(f.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",a,f,l)}}else if(a.slice(0,2)!=="</"){if(e.WTF)throw new Error(a)}}}return t}function AS(r){var e=[Fr,$e("Properties",null,{xmlns:Ur.CUST_PROPS,"xmlns:vt":Ur.vt})];if(!r)return e.join("");var t=1;return Tr(r).forEach(function(i){++t,e[e.length]=$e("property",hF(r[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:t,name:Bt(i)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var Im={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},sp;function n$(r,e,t){sp||(sp=m0(Im)),e=sp[e]||e,r[e]=t}function i$(r,e){var t=[];return Tr(Im).map(function(n){for(var i=0;i<Fi.length;++i)if(Fi[i][1]==n)return Fi[i];for(i=0;i<Oo.length;++i)if(Oo[i][1]==n)return Oo[i];throw n}).forEach(function(n){if(r[n[1]]!=null){var i=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:r[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),t.push(un(Im[n[1]]||n[1],i))}}),$e("DocumentProperties",t.join(""),{xmlns:ai.o})}function s$(r,e){var t=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return r&&Tr(r).forEach(function(s){if(Object.prototype.hasOwnProperty.call(r,s)){for(var a=0;a<Fi.length;++a)if(s==Fi[a][1])return;for(a=0;a<Oo.length;++a)if(s==Oo[a][1])return;for(a=0;a<t.length;++a)if(s==t[a])return;var o=r[s],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),i.push($e(Yv(s),o,{"dt:dt":l}))}}),e&&Tr(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)&&!(r&&Object.prototype.hasOwnProperty.call(r,s))){var a=e[s],o="string";typeof a=="number"?(o="float",a=String(a)):a===!0||a===!1?(o="boolean",a=a?"1":"0"):a instanceof Date?(o="dateTime.tz",a=a.toISOString()):a=String(a),i.push($e(Yv(s),a,{"dt:dt":o}))}}),"<"+n+' xmlns="'+ai.o+'">'+i.join("")+"</"+n+">"}function CO(r){var e=r.read_shift(4),t=r.read_shift(4);return new Date((t/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function a$(r){var e=typeof r=="string"?new Date(Date.parse(r)):r,t=e.getTime()/1e3+11644473600,n=t%Math.pow(2,32),i=(t-n)/Math.pow(2,32);n*=1e7,i*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),i+=s);var a=me(8);return a.write_shift(4,n),a.write_shift(4,i),a}function ES(r,e,t){var n=r.l,i=r.read_shift(0,"lpstr-cp");if(t)for(;r.l-n&3;)++r.l;return i}function PS(r,e,t){var n=r.read_shift(0,"lpwstr");return n}function RS(r,e,t){return e===31?PS(r):ES(r,e,t)}function Lm(r,e,t){return RS(r,e,t===!1?0:4)}function o$(r,e){if(!e)throw new Error("VtUnalignedString must have positive length");return RS(r,e,0)}function l$(r){for(var e=r.read_shift(4),t=[],n=0;n!=e;++n){var i=r.l;t[n]=r.read_shift(0,"lpwstr").replace(Sn,""),r.l-i&2&&(r.l+=2)}return t}function f$(r){for(var e=r.read_shift(4),t=[],n=0;n!=e;++n)t[n]=r.read_shift(0,"lpstr-cp").replace(Sn,"");return t}function c$(r){var e=r.l,t=xd(r,vS);r[r.l]==0&&r[r.l+1]==0&&r.l-e&2&&(r.l+=2);var n=xd(r,Vn);return[t,n]}function h$(r){for(var e=r.read_shift(4),t=[],n=0;n<e/2;++n)t.push(c$(r));return t}function uy(r,e){for(var t=r.read_shift(4),n={},i=0;i!=t;++i){var s=r.read_shift(4),a=r.read_shift(4);n[s]=r.read_shift(a,e===1200?"utf16le":"utf8").replace(Sn,"").replace(Rf,"!"),e===1200&&a%2&&(r.l+=2)}return r.l&3&&(r.l=r.l>>3<<2),n}function QS(r){var e=r.read_shift(4),t=r.slice(r.l,r.l+e);return r.l+=e,(e&3)>0&&(r.l+=4-(e&3)&3),t}function u$(r){var e={};return e.Size=r.read_shift(4),r.l+=e.Size+3-(e.Size-1)%4,e}function xd(r,e,t){var n=r.read_shift(2),i,s=t||{};if(r.l+=2,e!==fy&&n!==e&&UF.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===fy?n:e){case 2:return i=r.read_shift(2,"i"),s.raw||(r.l+=2),i;case 3:return i=r.read_shift(4,"i"),i;case 11:return r.read_shift(4)!==0;case 19:return i=r.read_shift(4),i;case 30:return ES(r,n,4).replace(Sn,"");case 31:return PS(r);case 64:return CO(r);case 65:return QS(r);case 71:return u$(r);case 80:return Lm(r,n,!s.raw).replace(Sn,"");case 81:return o$(r,n).replace(Sn,"");case 4108:return h$(r);case 4126:case 4127:return n==4127?l$(r):f$(r);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function dy(r,e){var t=me(4),n=me(4);switch(t.write_shift(4,r==80?31:r),r){case 3:n.write_shift(-4,e);break;case 5:n=me(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=a$(e);break;case 31:case 80:for(n=me(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+r+" "+e)}return Kr([t,n])}function py(r,e){var t=r.l,n=r.read_shift(4),i=r.read_shift(4),s=[],a=0,o=0,l=-1,f={};for(a=0;a!=i;++a){var c=r.read_shift(4),h=r.read_shift(4);s[a]=[c,h+t]}s.sort(function(w,v){return w[1]-v[1]});var u={};for(a=0;a!=i;++a){if(r.l!==s[a][1]){var d=!0;if(a>0&&e)switch(e[s[a-1][0]].t){case 2:r.l+2===s[a][1]&&(r.l+=2,d=!1);break;case 80:r.l<=s[a][1]&&(r.l=s[a][1],d=!1);break;case 4108:r.l<=s[a][1]&&(r.l=s[a][1],d=!1);break}if((!e||a==0)&&r.l<=s[a][1]&&(d=!1,r.l=s[a][1]),d)throw new Error("Read Error: Expected address "+s[a][1]+" at "+r.l+" :"+a)}if(e){var p=e[s[a][0]];if(u[p.n]=xd(r,p.t,{raw:!0}),p.p==="version"&&(u[p.n]=String(u[p.n]>>16)+"."+("0000"+String(u[p.n]&65535)).slice(-4)),p.n=="CodePage")switch(u[p.n]){case 0:u[p.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Ei(o=u[p.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+u[p.n])}}else if(s[a][0]===1){if(o=u.CodePage=xd(r,SO),Ei(o),l!==-1){var m=r.l;r.l=s[l][1],f=uy(r,o),r.l=m}}else if(s[a][0]===0){if(o===0){l=a,r.l=s[a+1][1];continue}f=uy(r,o)}else{var g=f[s[a][0]],O;switch(r[r.l]){case 65:r.l+=4,O=QS(r);break;case 30:r.l+=4,O=Lm(r,r[r.l-4]).replace(/\u0000+$/,"");break;case 31:r.l+=4,O=Lm(r,r[r.l-4]).replace(/\u0000+$/,"");break;case 3:r.l+=4,O=r.read_shift(4,"i");break;case 19:r.l+=4,O=r.read_shift(4);break;case 5:r.l+=4,O=r.read_shift(8,"f");break;case 11:r.l+=4,O=Pr(r,4);break;case 64:r.l+=4,O=or(CO(r));break;default:throw new Error("unparsed value: "+r[r.l])}u[g]=O}}return r.l=t+n,u}var FS=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function d$(r){switch(typeof r){case"boolean":return 11;case"number":return(r|0)==r?3:5;case"string":return 31;case"object":if(r instanceof Date)return 64;break}return-1}function my(r,e,t){var n=me(8),i=[],s=[],a=8,o=0,l=me(8),f=me(8);if(l.write_shift(4,2),l.write_shift(4,1200),f.write_shift(4,1),s.push(l),i.push(f),a+=8+l.length,!e){f=me(8),f.write_shift(4,0),i.unshift(f);var c=[me(4)];for(c[0].write_shift(4,r.length),o=0;o<r.length;++o){var h=r[o][0];for(l=me(8+2*(h.length+1)+(h.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,h.length+1),l.write_shift(0,h,"dbcs");l.l!=l.length;)l.write_shift(1,0);c.push(l)}l=Kr(c),s.unshift(l),a+=8+l.length}for(o=0;o<r.length;++o)if(!(e&&!e[r[o][0]])&&!(FS.indexOf(r[o][0])>-1||SS.indexOf(r[o][0])>-1)&&r[o][1]!=null){var u=r[o][1],d=0;if(e){d=+e[r[o][0]];var p=t[d];if(p.p=="version"&&typeof u=="string"){var m=u.split(".");u=(+m[0]<<16)+(+m[1]||0)}l=dy(p.t,u)}else{var g=d$(u);g==-1&&(g=31,u=String(u)),l=dy(g,u)}s.push(l),f=me(8),f.write_shift(4,e?d:2+o),i.push(f),a+=8+l.length}var O=8*(s.length+1);for(o=0;o<s.length;++o)i[o].write_shift(4,O),O+=s[o].length;return n.write_shift(4,a),n.write_shift(4,s.length),Kr([n].concat(i).concat(s))}function gy(r,e,t){var n=r.content;if(!n)return{};sn(n,0);var i,s,a,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var f=n.read_shift(4),c=n.read_shift(16);if(c!==Ye.utils.consts.HEADER_CLSID&&c!==t)throw new Error("Bad PropertySet CLSID "+c);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(s=n.read_shift(16),o=n.read_shift(4),i===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);i===2&&(a=n.read_shift(16),l=n.read_shift(4));var h=py(n,e),u={SystemIdentifier:f};for(var d in h)u[d]=h[d];if(u.FMTID=s,i===1)return u;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var p;try{p=py(n,null)}catch{}for(d in p)u[d]=p[d];return u.FMTID=[s,a],u}function Oy(r,e,t,n,i,s){var a=me(i?68:48),o=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,Ye.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,i?2:1),a.write_shift(16,e,"hex"),a.write_shift(4,i?68:48);var l=my(r,t,n);if(o.push(l),i){var f=my(i,null,null);a.write_shift(16,s,"hex"),a.write_shift(4,68+l.length),o.push(f)}return Kr(o)}function da(r,e){return r.read_shift(e),null}function p$(r,e){e||(e=me(r));for(var t=0;t<r;++t)e.write_shift(1,0);return e}function m$(r,e,t){for(var n=[],i=r.l+e;r.l<i;)n.push(t(r,i-r.l));if(i!==r.l)throw new Error("Slurp error");return n}function Pr(r,e){return r.read_shift(e)===1}function $n(r,e){return e||(e=me(2)),e.write_shift(2,+!!r),e}function Mr(r){return r.read_shift(2,"u")}function Si(r,e){return e||(e=me(2)),e.write_shift(2,r),e}function $S(r,e){return m$(r,e,Mr)}function g$(r){var e=r.read_shift(1),t=r.read_shift(1);return t===1?e:e===1}function DS(r,e,t){return t||(t=me(2)),t.write_shift(1,e=="e"?+r:+!!r),t.write_shift(1,e=="e"?1:0),t}function dh(r,e,t){var n=r.read_shift(t&&t.biff>=12?2:1),i="sbcs-cont",s=mi;if(t&&t.biff>=8&&(mi=1200),!t||t.biff==8){var a=r.read_shift(1);a&&(i="dbcs-cont")}else t.biff==12&&(i="wstr");t.biff>=2&&t.biff<=5&&(i="cpstr");var o=n?r.read_shift(n,i):"";return mi=s,o}function O$(r){var e=mi;mi=1200;var t=r.read_shift(2),n=r.read_shift(1),i=n&4,s=n&8,a=1+(n&1),o=0,l,f={};s&&(o=r.read_shift(2)),i&&(l=r.read_shift(4));var c=a==2?"dbcs-cont":"sbcs-cont",h=t===0?"":r.read_shift(t,c);return s&&(r.l+=4*o),i&&(r.l+=l),f.t=h,s||(f.raw="<t>"+f.t+"</t>",f.r=f.t),mi=e,f}function x$(r){var e=r.t||"",t=me(3);t.write_shift(2,e.length),t.write_shift(1,1);var n=me(2*e.length);n.write_shift(2*e.length,e,"utf16le");var i=[t,n];return Kr(i)}function Ao(r,e,t){var n;if(t){if(t.biff>=2&&t.biff<=5)return r.read_shift(e,"cpstr");if(t.biff>=12)return r.read_shift(e,"dbcs-cont")}var i=r.read_shift(1);return i===0?n=r.read_shift(e,"sbcs-cont"):n=r.read_shift(e,"dbcs-cont"),n}function ph(r,e,t){var n=r.read_shift(t&&t.biff==2?1:2);return n===0?(r.l++,""):Ao(r,n,t)}function Xo(r,e,t){if(t.biff>5)return ph(r,e,t);var n=r.read_shift(1);return n===0?(r.l++,""):r.read_shift(n,t.biff<=4||!r.lens?"cpstr":"sbcs-cont")}function NS(r,e,t){return t||(t=me(3+2*r.length)),t.write_shift(2,r.length),t.write_shift(1,1),t.write_shift(31,r,"utf16le"),t}function v$(r){var e=r.read_shift(1);r.l++;var t=r.read_shift(2);return r.l+=2,[e,t]}function y$(r){var e=r.read_shift(4),t=r.l,n=!1;e>24&&(r.l+=e-24,r.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),r.l=t);var i=r.read_shift((n?e-24:e)>>1,"utf16le").replace(Sn,"");return n&&(r.l+=24),i}function w$(r){for(var e=r.read_shift(2),t="";e-- >0;)t+="../";var n=r.read_shift(0,"lpstr-ansi");if(r.l+=2,r.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=r.read_shift(4);if(i===0)return t+n.replace(/\\/g,"/");var s=r.read_shift(4);if(r.read_shift(2)!=3)throw new Error("Bad FileMoniker");var a=r.read_shift(s>>1,"utf16le").replace(Sn,"");return t+a}function b$(r,e){var t=r.read_shift(16);switch(t){case"e0c9ea79f9bace118c8200aa004ba90b":return y$(r);case"0303000000000000c000000000000046":return w$(r);default:throw new Error("Unsupported Moniker "+t)}}function Bh(r){var e=r.read_shift(4),t=e>0?r.read_shift(e,"utf16le").replace(Sn,""):"";return t}function xy(r,e){e||(e=me(6+r.length*2)),e.write_shift(4,1+r.length);for(var t=0;t<r.length;++t)e.write_shift(2,r.charCodeAt(t));return e.write_shift(2,0),e}function _$(r,e){var t=r.l+e,n=r.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=r.read_shift(2);r.l+=2;var s,a,o,l,f="",c,h;i&16&&(s=Bh(r,t-r.l)),i&128&&(a=Bh(r,t-r.l)),(i&257)===257&&(o=Bh(r,t-r.l)),(i&257)===1&&(l=b$(r,t-r.l)),i&8&&(f=Bh(r,t-r.l)),i&32&&(c=r.read_shift(16)),i&64&&(h=CO(r)),r.l=t;var u=a||o||l||"";u&&f&&(u+="#"+f),u||(u="#"+f),i&2&&u.charAt(0)=="/"&&u.charAt(1)!="/"&&(u="file://"+u);var d={Target:u};return c&&(d.guid=c),h&&(d.time=h),s&&(d.Tooltip=s),d}function k$(r){var e=me(512),t=0,n=r.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),s=i>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}e.write_shift(4,2),e.write_shift(4,s);var a=[8,6815827,6619237,4849780,83];for(t=0;t<a.length;++t)e.write_shift(4,a[t]);if(s==28)n=n.slice(1),xy(n,e);else if(s&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),t=0;t<a.length;++t)e.write_shift(1,parseInt(a[t],16));var o=i>-1?n.slice(0,i):n;for(e.write_shift(4,2*(o.length+1)),t=0;t<o.length;++t)e.write_shift(2,o.charCodeAt(t));e.write_shift(2,0),s&8&&xy(i>-1?n.slice(i+1):"",e)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),t=0;t<a.length;++t)e.write_shift(1,parseInt(a[t],16));for(var l=0;n.slice(l*3,l*3+3)=="../"||n.slice(l*3,l*3+3)=="..\\";)++l;for(e.write_shift(2,l),e.write_shift(4,n.length-3*l+1),t=0;t<n.length-3*l;++t)e.write_shift(1,n.charCodeAt(t+3*l)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),t=0;t<6;++t)e.write_shift(4,0)}return e.slice(0,e.l)}function MS(r){var e=r.read_shift(1),t=r.read_shift(1),n=r.read_shift(1),i=r.read_shift(1);return[e,t,n,i]}function IS(r,e){var t=MS(r);return t[3]=0,t}function Ns(r){var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(2);return{r:e,c:t,ixfe:n}}function Eo(r,e,t,n){return n||(n=me(6)),n.write_shift(2,r),n.write_shift(2,e),n.write_shift(2,t||0),n}function S$(r){var e=r.read_shift(2),t=r.read_shift(2);return r.l+=8,{type:e,flags:t}}function T$(r,e,t){return e===0?"":Xo(r,e,t)}function C$(r,e,t){var n=t.biff>8?4:2,i=r.read_shift(n),s=r.read_shift(n,"i"),a=r.read_shift(n,"i");return[i,s,a]}function LS(r){var e=r.read_shift(2),t=kO(r);return[e,t]}function A$(r,e,t){r.l+=4,e-=4;var n=r.l+e,i=dh(r,e,t),s=r.read_shift(2);if(n-=r.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return r.l+=s,i}function v0(r){var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(2),i=r.read_shift(2);return{s:{c:n,r:e},e:{c:i,r:t}}}function BS(r,e){return e||(e=me(8)),e.write_shift(2,r.s.r),e.write_shift(2,r.e.r),e.write_shift(2,r.s.c),e.write_shift(2,r.e.c),e}function ZS(r){var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(1),i=r.read_shift(1);return{s:{c:n,r:e},e:{c:i,r:t}}}var E$=ZS;function WS(r){r.l+=4;var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(2);return r.l+=12,[t,e,n]}function P$(r){var e={};return r.l+=4,r.l+=16,e.fSharedNote=r.read_shift(2),r.l+=4,e}function R$(r){var e={};return r.l+=4,r.cf=r.read_shift(2),e}function gn(r){r.l+=2,r.l+=r.read_shift(2)}var Q$={0:gn,4:gn,5:gn,6:gn,7:R$,8:gn,9:gn,10:gn,11:gn,12:gn,13:P$,14:gn,15:gn,16:gn,17:gn,18:gn,19:gn,20:gn,21:WS};function F$(r,e){for(var t=r.l+e,n=[];r.l<t;){var i=r.read_shift(2);r.l-=2;try{n.push(Q$[i](r,t-r.l))}catch{return r.l=t,n}}return r.l!=t&&(r.l=t),n}function Zh(r,e){var t={BIFFVer:0,dt:0};switch(t.BIFFVer=r.read_shift(2),e-=2,e>=2&&(t.dt=r.read_shift(2),r.l-=2),t.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+t.BIFFVer)}return r.read_shift(e),t}function AO(r,e,t){var n=1536,i=16;switch(t.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=me(i);return s.write_shift(2,n),s.write_shift(2,e),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function $$(r,e){return e===0||r.read_shift(2),1200}function D$(r,e,t){if(t.enc)return r.l+=e,"";var n=r.l,i=Xo(r,0,t);return r.read_shift(e+n-r.l),i}function N$(r,e){var t=!e||e.biff==8,n=me(t?112:54);for(n.write_shift(e.biff==8?2:1,7),t&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(t?0:536870912));n.l<n.length;)n.write_shift(1,t?0:32);return n}function M$(r,e,t){var n=t&&t.biff==8||e==2?r.read_shift(2):(r.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function I$(r,e,t){var n=r.read_shift(4),i=r.read_shift(1)&3,s=r.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var a=dh(r,0,t);return a.length===0&&(a="Sheet1"),{pos:n,hs:i,dt:s,name:a}}function L$(r,e){var t=!e||e.biff>=8?2:1,n=me(8+t*r.name.length);n.write_shift(4,r.pos),n.write_shift(1,r.hs||0),n.write_shift(1,r.dt),n.write_shift(1,r.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(t*r.name.length,r.name,e.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function B$(r,e){for(var t=r.l+e,n=r.read_shift(4),i=r.read_shift(4),s=[],a=0;a!=i&&r.l<t;++a)s.push(O$(r));return s.Count=n,s.Unique=i,s}function Z$(r,e){var t=me(8);t.write_shift(4,r.Count),t.write_shift(4,r.Unique);for(var n=[],i=0;i<r.length;++i)n[i]=x$(r[i]);var s=Kr([t].concat(n));return s.parts=[t.length].concat(n.map(function(a){return a.length})),s}function W$(r,e){var t={};return t.dsst=r.read_shift(2),r.l+=e-2,t}function U$(r){var e={};e.r=r.read_shift(2),e.c=r.read_shift(2),e.cnt=r.read_shift(2)-e.c;var t=r.read_shift(2);r.l+=4;var n=r.read_shift(1);return r.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=t/20),e}function X$(r){var e=S$(r);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var t=r.read_shift(4);return t!==0}function V$(r){return r.read_shift(2),r.read_shift(4)}function vy(r,e,t){var n=0;t&&t.biff==2||(n=r.read_shift(2));var i=r.read_shift(2);t&&t.biff==2&&(n=1-(i>>15),i&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,i]}function q$(r){var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(2),i=r.read_shift(2),s=r.read_shift(2),a=r.read_shift(2),o=r.read_shift(2),l=r.read_shift(2),f=r.read_shift(2);return{Pos:[e,t],Dim:[n,i],Flags:s,CurTab:a,FirstTab:o,Selected:l,TabRatio:f}}function j$(){var r=me(18);return r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,29280),r.write_shift(2,17600),r.write_shift(2,56),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,1),r.write_shift(2,500),r}function z$(r,e,t){if(t&&t.biff>=2&&t.biff<5)return{};var n=r.read_shift(2);return{RTL:n&64}}function G$(r){var e=me(18),t=1718;return r&&r.RTL&&(t|=64),e.write_shift(2,t),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function H$(){}function Y$(r,e,t){var n={dyHeight:r.read_shift(2),fl:r.read_shift(2)};switch(t&&t.biff||8){case 2:break;case 3:case 4:r.l+=2;break;default:r.l+=10;break}return n.name=dh(r,0,t),n}function K$(r,e){var t=r.name||"Arial",n=e.biff==5,i=n?15+t.length:16+2*t.length,s=me(i);return s.write_shift(2,(r.sz||12)*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,t.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*t.length,t,n?"sbcs":"utf16le"),s}function J$(r){var e=Ns(r);return e.isst=r.read_shift(4),e}function eD(r,e,t,n){var i=me(10);return Eo(r,e,n,i),i.write_shift(4,t),i}function tD(r,e,t){t.biffguess&&t.biff==2&&(t.biff=5);var n=r.l+e,i=Ns(r);t.biff==2&&r.l++;var s=ph(r,n-r.l,t);return i.val=s,i}function rD(r,e,t,n,i){var s=!i||i.biff==8,a=me(8+ +s+(1+s)*t.length);return Eo(r,e,n,a),a.write_shift(2,t.length),s&&a.write_shift(1,1),a.write_shift((1+s)*t.length,t,s?"utf16le":"sbcs"),a}function nD(r,e,t){var n=r.read_shift(2),i=Xo(r,0,t);return[n,i]}function iD(r,e,t,n){var i=t.biff==5;n||(n=me(i?3+e.length:5+2*e.length)),n.write_shift(2,r),n.write_shift(i?1:2,e.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*e.length,e,i?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}var sD=Xo;function yy(r,e,t){var n=r.l+e,i=t.biff==8||!t.biff?4:2,s=r.read_shift(i),a=r.read_shift(i),o=r.read_shift(2),l=r.read_shift(2);return r.l=n,{s:{r:s,c:o},e:{r:a,c:l}}}function aD(r,e){var t=e.biff==8||!e.biff?4:2,n=me(2*t+6);return n.write_shift(t,r.s.r),n.write_shift(t,r.e.r+1),n.write_shift(2,r.s.c),n.write_shift(2,r.e.c+1),n.write_shift(2,0),n}function oD(r){var e=r.read_shift(2),t=r.read_shift(2),n=LS(r);return{r:e,c:t,ixfe:n[0],rknum:n[1]}}function lD(r,e){for(var t=r.l+e-2,n=r.read_shift(2),i=r.read_shift(2),s=[];r.l<t;)s.push(LS(r));if(r.l!==t)throw new Error("MulRK read error");var a=r.read_shift(2);if(s.length!=a-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:a,rkrec:s}}function fD(r,e){for(var t=r.l+e-2,n=r.read_shift(2),i=r.read_shift(2),s=[];r.l<t;)s.push(r.read_shift(2));if(r.l!==t)throw new Error("MulBlank read error");var a=r.read_shift(2);if(s.length!=a-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:a,ixfe:s}}function cD(r,e,t,n){var i={},s=r.read_shift(4),a=r.read_shift(4),o=r.read_shift(4),l=r.read_shift(2);return i.patternType=XF[o>>26],n.cellStyles&&(i.alc=s&7,i.fWrap=s>>3&1,i.alcV=s>>4&7,i.fJustLast=s>>7&1,i.trot=s>>8&255,i.cIndent=s>>16&15,i.fShrinkToFit=s>>20&1,i.iReadOrder=s>>22&2,i.fAtrNum=s>>26&1,i.fAtrFnt=s>>27&1,i.fAtrAlc=s>>28&1,i.fAtrBdr=s>>29&1,i.fAtrPat=s>>30&1,i.fAtrProt=s>>31&1,i.dgLeft=a&15,i.dgRight=a>>4&15,i.dgTop=a>>8&15,i.dgBottom=a>>12&15,i.icvLeft=a>>16&127,i.icvRight=a>>23&127,i.grbitDiag=a>>30&3,i.icvTop=o&127,i.icvBottom=o>>7&127,i.icvDiag=o>>14&127,i.dgDiag=o>>21&15,i.icvFore=l&127,i.icvBack=l>>7&127,i.fsxButton=l>>14&1),i}function hD(r,e,t){var n={};return n.ifnt=r.read_shift(2),n.numFmtId=r.read_shift(2),n.flags=r.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=cD(r,e,n.fStyle,t),n}function wy(r,e,t,n){var i=t.biff==5;n||(n=me(i?16:20)),n.write_shift(2,0),r.style?(n.write_shift(2,r.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,r.numFmtId||0),n.write_shift(2,e<<4));var s=0;return r.numFmtId>0&&i&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function uD(r){r.l+=4;var e=[r.read_shift(2),r.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function dD(r){var e=me(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function by(r,e,t){var n=Ns(r);(t.biff==2||e==9)&&++r.l;var i=g$(r);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function pD(r,e,t,n,i,s){var a=me(8);return Eo(r,e,n,a),DS(t,s,a),a}function mD(r,e,t){t.biffguess&&t.biff==2&&(t.biff=5);var n=Ns(r),i=bn(r);return n.val=i,n}function gD(r,e,t,n){var i=me(14);return Eo(r,e,n,i),Co(t,i),i}var _y=T$;function OD(r,e,t){var n=r.l+e,i=r.read_shift(2),s=r.read_shift(2);if(t.sbcch=s,s==1025||s==14849)return[s,i];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var a=Ao(r,s),o=[];n>r.l;)o.push(ph(r));return[s,i,a,o]}function ky(r,e,t){var n=r.read_shift(2),i,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return t.sbcch===14849&&(i=A$(r,e-2,t)),s.body=i||r.read_shift(e-2),typeof i=="string"&&(s.Name=i),s}var xD=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Sy(r,e,t){var n=r.l+e,i=r.read_shift(2),s=r.read_shift(1),a=r.read_shift(1),o=r.read_shift(t&&t.biff==2?1:2),l=0;(!t||t.biff>=5)&&(t.biff!=5&&(r.l+=2),l=r.read_shift(2),t.biff==5&&(r.l+=2),r.l+=4);var f=Ao(r,a,t);i&32&&(f=xD[f.charCodeAt(0)]);var c=n-r.l;t&&t.biff==2&&--c;var h=n==r.l||o===0||!(c>0)?[]:FM(r,c,t,o);return{chKey:s,Name:f,itab:l,rgce:h}}function US(r,e,t){if(t.biff<8)return vD(r,e,t);for(var n=[],i=r.l+e,s=r.read_shift(t.biff>8?4:2);s--!==0;)n.push(C$(r,t.biff>8?12:6,t));if(r.l!=i)throw new Error("Bad ExternSheet: "+r.l+" != "+i);return n}function vD(r,e,t){r[r.l+1]==3&&r[r.l]++;var n=dh(r,e,t);return n.charCodeAt(0)==3?n.slice(1):n}function yD(r,e,t){if(t.biff<8){r.l+=e;return}var n=r.read_shift(2),i=r.read_shift(2),s=Ao(r,n,t),a=Ao(r,i,t);return[s,a]}function wD(r,e,t){var n=ZS(r);r.l++;var i=r.read_shift(1);return e-=8,[$M(r,e,t),i,n]}function Ty(r,e,t){var n=E$(r);switch(t.biff){case 2:r.l++,e-=7;break;case 3:case 4:r.l+=2,e-=8;break;default:r.l+=6,e-=12}return[n,RM(r,e,t)]}function bD(r){var e=r.read_shift(4)!==0,t=r.read_shift(4)!==0,n=r.read_shift(4);return[e,t,n]}function _D(r,e,t){if(!(t.biff<8)){var n=r.read_shift(2),i=r.read_shift(2),s=r.read_shift(2),a=r.read_shift(2),o=Xo(r,0,t);return t.biff<8&&r.read_shift(1),[{r:n,c:i},o,a,s]}}function kD(r,e,t){return _D(r,e,t)}function SD(r,e){for(var t=[],n=r.read_shift(2);n--;)t.push(v0(r));return t}function TD(r){var e=me(2+r.length*8);e.write_shift(2,r.length);for(var t=0;t<r.length;++t)BS(r[t],e);return e}function CD(r,e,t){if(t&&t.biff<8)return ED(r,e,t);var n=WS(r),i=F$(r,e-22,n[1]);return{cmo:n,ft:i}}var AD={8:function(r,e){var t=r.l+e;r.l+=10;var n=r.read_shift(2);r.l+=4,r.l+=2,r.l+=2,r.l+=2,r.l+=4;var i=r.read_shift(1);return r.l+=i,r.l=t,{fmt:n}}};function ED(r,e,t){r.l+=4;var n=r.read_shift(2),i=r.read_shift(2),s=r.read_shift(2);r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=6,e-=36;var a=[];return a.push((AD[n]||Cn)(r,e,t)),{cmo:[i,n,s],ft:a}}function PD(r,e,t){var n=r.l,i="";try{r.l+=4;var s=(t.lastobj||{cmo:[0,0]}).cmo[1],a;[0,5,7,11,12,14].indexOf(s)==-1?r.l+=6:a=v$(r,6,t);var o=r.read_shift(2);r.read_shift(2),Mr(r,2);var l=r.read_shift(2);r.l+=l;for(var f=1;f<r.lens.length-1;++f){if(r.l-n!=r.lens[f])throw new Error("TxO: bad continue record");var c=r[r.l],h=Ao(r,r.lens[f+1]-r.lens[f]-1);if(i+=h,i.length>=(c?o:2*o))break}if(i.length!==o&&i.length!==o*2)throw new Error("cchText: "+o+" != "+i.length);return r.l=n+e,{t:i}}catch{return r.l=n+e,{t:i}}}function RD(r,e){var t=v0(r);r.l+=16;var n=_$(r,e-24);return[t,n]}function QD(r){var e=me(24),t=xr(r[0]);e.write_shift(2,t.r),e.write_shift(2,t.r),e.write_shift(2,t.c),e.write_shift(2,t.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)e.write_shift(1,parseInt(n[i],16));return Kr([e,k$(r[1])])}function FD(r,e){r.read_shift(2);var t=v0(r),n=r.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(Sn,""),[t,n]}function $D(r){var e=r[1].Tooltip,t=me(10+2*(e.length+1));t.write_shift(2,2048);var n=xr(r[0]);t.write_shift(2,n.r),t.write_shift(2,n.r),t.write_shift(2,n.c),t.write_shift(2,n.c);for(var i=0;i<e.length;++i)t.write_shift(2,e.charCodeAt(i));return t.write_shift(2,0),t}function DD(r){var e=[0,0],t;return t=r.read_shift(2),e[0]=cy[t]||t,t=r.read_shift(2),e[1]=cy[t]||t,e}function ND(r){return r||(r=me(4)),r.write_shift(2,1),r.write_shift(2,1),r}function MD(r){for(var e=r.read_shift(2),t=[];e-- >0;)t.push(IS(r));return t}function ID(r){for(var e=r.read_shift(2),t=[];e-- >0;)t.push(IS(r));return t}function LD(r){r.l+=2;var e={cxfs:0,crc:0};return e.cxfs=r.read_shift(2),e.crc=r.read_shift(4),e}function XS(r,e,t){if(!t.cellStyles)return Cn(r,e);var n=t&&t.biff>=12?4:2,i=r.read_shift(n),s=r.read_shift(n),a=r.read_shift(n),o=r.read_shift(n),l=r.read_shift(2);n==2&&(r.l+=2);var f={s:i,e:s,w:a,ixfe:o,flags:l};return(t.biff>=5||!t.biff)&&(f.level=l>>8&7),f}function BD(r,e){var t=me(12);t.write_shift(2,e),t.write_shift(2,e),t.write_shift(2,r.width*256),t.write_shift(2,0);var n=0;return r.hidden&&(n|=1),t.write_shift(1,n),n=r.level||0,t.write_shift(1,n),t.write_shift(2,0),t}function ZD(r,e){var t={};return e<32||(r.l+=16,t.header=bn(r),t.footer=bn(r),r.l+=2),t}function WD(r,e,t){var n={area:!1};if(t.biff!=5)return r.l+=e,n;var i=r.read_shift(1);return r.l+=3,i&16&&(n.area=!0),n}function UD(r){for(var e=me(2*r),t=0;t<r;++t)e.write_shift(2,t+1);return e}var XD=Ns,VD=$S,qD=ph;function jD(r){var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(4),i={fmt:e,env:t,len:n,data:r.slice(r.l,r.l+n)};return r.l+=n,i}function zD(r,e,t){t.biffguess&&t.biff==5&&(t.biff=2);var n=Ns(r);++r.l;var i=Xo(r,e-7,t);return n.t="str",n.val=i,n}function GD(r){var e=Ns(r);++r.l;var t=bn(r);return e.t="n",e.val=t,e}function HD(r,e,t){var n=me(15);return xh(n,r,e),n.write_shift(8,t,"f"),n}function YD(r){var e=Ns(r);++r.l;var t=r.read_shift(2);return e.t="n",e.val=t,e}function KD(r,e,t){var n=me(9);return xh(n,r,e),n.write_shift(2,t),n}function JD(r){var e=r.read_shift(1);return e===0?(r.l++,""):r.read_shift(e,"sbcs-cont")}function eN(r,e){r.l+=6,r.l+=2,r.l+=1,r.l+=3,r.l+=1,r.l+=e-13}function tN(r,e,t){var n=r.l+e,i=Ns(r),s=r.read_shift(2),a=Ao(r,s,t);return r.l=n,i.t="str",i.val=a,i}var rN=[2,3,48,49,131,139,140,245],Bm=function(){var r={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=m0({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(o,l){var f=[],c=Ra(1);switch(l.type){case"base64":c=oi(gi(o));break;case"binary":c=oi(o);break;case"buffer":case"array":c=o;break}sn(c,0);var h=c.read_shift(1),u=!!(h&136),d=!1,p=!1;switch(h){case 2:break;case 3:break;case 48:d=!0,u=!0;break;case 49:d=!0,u=!0;break;case 131:break;case 139:break;case 140:p=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var m=0,g=521;h==2&&(m=c.read_shift(2)),c.l+=3,h!=2&&(m=c.read_shift(4)),m>1048576&&(m=1e6),h!=2&&(g=c.read_shift(2));var O=c.read_shift(2),w=l.codepage||1252;h!=2&&(c.l+=16,c.read_shift(1),c[c.l]!==0&&(w=r[c[c.l]]),c.l+=1,c.l+=2),p&&(c.l+=36);for(var v=[],S={},y=Math.min(c.length,h==2?521:g-10-(d?264:0)),b=p?32:11;c.l<y&&c[c.l]!=13;)switch(S={},S.name=St.utils.decode(w,c.slice(c.l,c.l+b)).replace(/[\u0000\r\n].*$/g,""),c.l+=b,S.type=String.fromCharCode(c.read_shift(1)),h!=2&&!p&&(S.offset=c.read_shift(4)),S.len=c.read_shift(1),h==2&&(S.offset=c.read_shift(2)),S.dec=c.read_shift(1),S.name.length&&v.push(S),h!=2&&(c.l+=p?13:14),S.type){case"B":(!d||S.len!=8)&&l.WTF&&console.log("Skipping "+S.name+":"+S.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+S.name+":"+S.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+S.type)}if(c[c.l]!==13&&(c.l=g-1),c.read_shift(1)!==13)throw new Error("DBF Terminator not found "+c.l+" "+c[c.l]);c.l=g;var x=0,A=0;for(f[0]=[],A=0;A!=v.length;++A)f[0][A]=v[A].name;for(;m-- >0;){if(c[c.l]===42){c.l+=O;continue}for(++c.l,f[++x]=[],A=0,A=0;A!=v.length;++A){var k=c.slice(c.l,c.l+v[A].len);c.l+=v[A].len,sn(k,0);var E=St.utils.decode(w,k);switch(v[A].type){case"C":E.trim().length&&(f[x][A]=E.replace(/\s+$/,""));break;case"D":E.length===8?f[x][A]=new Date(+E.slice(0,4),+E.slice(4,6)-1,+E.slice(6,8)):f[x][A]=E;break;case"F":f[x][A]=parseFloat(E.trim());break;case"+":case"I":f[x][A]=p?k.read_shift(-4,"i")^2147483648:k.read_shift(4,"i");break;case"L":switch(E.trim().toUpperCase()){case"Y":case"T":f[x][A]=!0;break;case"N":case"F":f[x][A]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+E+"|")}break;case"M":if(!u)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));f[x][A]="##MEMO##"+(p?parseInt(E.trim(),10):k.read_shift(4));break;case"N":E=E.replace(/\u0000/g,"").trim(),E&&E!="."&&(f[x][A]=+E||0);break;case"@":f[x][A]=new Date(k.read_shift(-8,"f")-621356832e5);break;case"T":f[x][A]=new Date((k.read_shift(4)-2440588)*864e5+k.read_shift(4));break;case"Y":f[x][A]=k.read_shift(4,"i")/1e4+k.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":f[x][A]=-k.read_shift(-8,"f");break;case"B":if(d&&v[A].len==8){f[x][A]=k.read_shift(8,"f");break}case"G":case"P":k.l+=v[A].len;break;case"0":if(v[A].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+v[A].type)}}}if(h!=2&&c.l<c.length&&c[c.l++]!=26)throw new Error("DBF EOF Marker missing "+(c.l-1)+" of "+c.length+" "+c[c.l-1].toString(16));return l.sheetRows&&(f=f.slice(0,l.sheetRows)),l.DBF=v,f}function n(o,l){var f=l||{};f.dateNF||(f.dateNF="yyyymmdd");var c=rf(t(o,f),f);return c["!cols"]=f.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete f.DBF,c}function i(o,l){try{return Va(n(o,l),l)}catch(f){if(l&&l.WTF)throw f}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,l){var f=l||{};if(+f.codepage>=0&&Ei(+f.codepage),f.type=="string")throw new Error("Cannot write DBF to JS string");var c=Kn(),h=bd(o,{header:1,raw:!0,cellDates:!0}),u=h[0],d=h.slice(1),p=o["!cols"]||[],m=0,g=0,O=0,w=1;for(m=0;m<u.length;++m){if(((p[m]||{}).DBF||{}).name){u[m]=p[m].DBF.name,++O;continue}if(u[m]!=null){if(++O,typeof u[m]=="number"&&(u[m]=u[m].toString(10)),typeof u[m]!="string")throw new Error("DBF Invalid column name "+u[m]+" |"+typeof u[m]+"|");if(u.indexOf(u[m])!==m){for(g=0;g<1024;++g)if(u.indexOf(u[m]+"_"+g)==-1){u[m]+="_"+g;break}}}}var v=yt(o["!ref"]),S=[],y=[],b=[];for(m=0;m<=v.e.c-v.s.c;++m){var x="",A="",k=0,E=[];for(g=0;g<d.length;++g)d[g][m]!=null&&E.push(d[g][m]);if(E.length==0||u[m]==null){S[m]="?";continue}for(g=0;g<E.length;++g){switch(typeof E[g]){case"number":A="B";break;case"string":A="C";break;case"boolean":A="L";break;case"object":A=E[g]instanceof Date?"D":"C";break;default:A="C"}k=Math.max(k,String(E[g]).length),x=x&&x!=A?"C":A}k>250&&(k=250),A=((p[m]||{}).DBF||{}).type,A=="C"&&p[m].DBF.len>k&&(k=p[m].DBF.len),x=="B"&&A=="N"&&(x="N",b[m]=p[m].DBF.dec,k=p[m].DBF.len),y[m]=x=="C"||A=="N"?k:s[x]||0,w+=y[m],S[m]=x}var T=c.next(32);for(T.write_shift(4,318902576),T.write_shift(4,d.length),T.write_shift(2,296+32*O),T.write_shift(2,w),m=0;m<4;++m)T.write_shift(4,0);for(T.write_shift(4,0|(+e[ko]||3)<<8),m=0,g=0;m<u.length;++m)if(u[m]!=null){var _=c.next(32),N=(u[m].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);_.write_shift(1,N,"sbcs"),_.write_shift(1,S[m]=="?"?"C":S[m],"sbcs"),_.write_shift(4,g),_.write_shift(1,y[m]||s[S[m]]||0),_.write_shift(1,b[m]||0),_.write_shift(1,2),_.write_shift(4,0),_.write_shift(1,0),_.write_shift(4,0),_.write_shift(4,0),g+=y[m]||s[S[m]]||0}var Z=c.next(264);for(Z.write_shift(4,13),m=0;m<65;++m)Z.write_shift(4,0);for(m=0;m<d.length;++m){var z=c.next(w);for(z.write_shift(1,0),g=0;g<u.length;++g)if(u[g]!=null)switch(S[g]){case"L":z.write_shift(1,d[m][g]==null?63:d[m][g]?84:70);break;case"B":z.write_shift(8,d[m][g]||0,"f");break;case"N":var ee="0";for(typeof d[m][g]=="number"&&(ee=d[m][g].toFixed(b[g]||0)),O=0;O<y[g]-ee.length;++O)z.write_shift(1,32);z.write_shift(1,ee,"sbcs");break;case"D":d[m][g]?(z.write_shift(4,("0000"+d[m][g].getFullYear()).slice(-4),"sbcs"),z.write_shift(2,("00"+(d[m][g].getMonth()+1)).slice(-2),"sbcs"),z.write_shift(2,("00"+d[m][g].getDate()).slice(-2),"sbcs")):z.write_shift(8,"00000000","sbcs");break;case"C":var ae=String(d[m][g]!=null?d[m][g]:"").slice(0,y[g]);for(z.write_shift(1,ae,"sbcs"),O=0;O<y[g]-ae.length;++O)z.write_shift(1,32);break}}return c.next(1).write_shift(1,26),c.end()}return{to_workbook:i,to_sheet:n,from_sheet:a}}(),VS=function(){var r={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Tr(r).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(u,d){var p=r[d];return typeof p=="number"?Qm(p):p},n=function(u,d,p){var m=d.charCodeAt(0)-32<<4|p.charCodeAt(0)-48;return m==59?u:Qm(m)};r["|"]=254;function i(u,d){switch(d.type){case"base64":return s(gi(u),d);case"binary":return s(u,d);case"buffer":return s(dt&&Buffer.isBuffer(u)?u.toString("binary"):Xa(u),d);case"array":return s(To(u),d)}throw new Error("Unrecognized type "+d.type)}function s(u,d){var p=u.split(/[\n\r]+/),m=-1,g=-1,O=0,w=0,v=[],S=[],y=null,b={},x=[],A=[],k=[],E=0,T;for(+d.codepage>=0&&Ei(+d.codepage);O!==p.length;++O){E=0;var _=p[O].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,t),N=_.replace(/;;/g,"\0").split(";").map(function(W){return W.replace(/\u0000/g,";")}),Z=N[0],z;if(_.length>0)switch(Z){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":N[1].charAt(0)=="P"&&S.push(_.slice(3).replace(/;;/g,";"));break;case"C":var ee=!1,ae=!1,xe=!1,V=!1,ue=-1,ie=-1;for(w=1;w<N.length;++w)switch(N[w].charAt(0)){case"A":break;case"X":g=parseInt(N[w].slice(1))-1,ae=!0;break;case"Y":for(m=parseInt(N[w].slice(1))-1,ae||(g=0),T=v.length;T<=m;++T)v[T]=[];break;case"K":z=N[w].slice(1),z.charAt(0)==='"'?z=z.slice(1,z.length-1):z==="TRUE"?z=!0:z==="FALSE"?z=!1:isNaN(Yi(z))?isNaN(Al(z).getDate())||(z=or(z)):(z=Yi(z),y!==null&&Io(y)&&(z=O0(z))),typeof St<"u"&&typeof z=="string"&&(d||{}).type!="string"&&(d||{}).codepage&&(z=St.utils.decode(d.codepage,z)),ee=!0;break;case"E":V=!0;var P=ml(N[w].slice(1),{r:m,c:g});v[m][g]=[v[m][g],P];break;case"S":xe=!0,v[m][g]=[v[m][g],"S5S"];break;case"G":break;case"R":ue=parseInt(N[w].slice(1))-1;break;case"C":ie=parseInt(N[w].slice(1))-1;break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+_)}if(ee&&(v[m][g]&&v[m][g].length==2?v[m][g][0]=z:v[m][g]=z,y=null),xe){if(V)throw new Error("SYLK shared formula cannot have own formula");var I=ue>-1&&v[ue][ie];if(!I||!I[1])throw new Error("SYLK shared formula cannot find base");v[m][g][1]=fT(I[1],{r:m-ue,c:g-ie})}break;case"F":var B=0;for(w=1;w<N.length;++w)switch(N[w].charAt(0)){case"X":g=parseInt(N[w].slice(1))-1,++B;break;case"Y":for(m=parseInt(N[w].slice(1))-1,T=v.length;T<=m;++T)v[T]=[];break;case"M":E=parseInt(N[w].slice(1))/20;break;case"F":break;case"G":break;case"P":y=S[parseInt(N[w].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(k=N[w].slice(1).split(" "),T=parseInt(k[0],10);T<=parseInt(k[1],10);++T)E=parseInt(k[2],10),A[T-1]=E===0?{hidden:!0}:{wch:E},Qa(A[T-1]);break;case"C":g=parseInt(N[w].slice(1))-1,A[g]||(A[g]={});break;case"R":m=parseInt(N[w].slice(1))-1,x[m]||(x[m]={}),E>0?(x[m].hpt=E,x[m].hpx=Pl(E)):E===0&&(x[m].hidden=!0);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+_)}B<1&&(y=null);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+_)}}return x.length>0&&(b["!rows"]=x),A.length>0&&(b["!cols"]=A),d&&d.sheetRows&&(v=v.slice(0,d.sheetRows)),[v,b]}function a(u,d){var p=i(u,d),m=p[0],g=p[1],O=rf(m,d);return Tr(g).forEach(function(w){O[w]=g[w]}),O}function o(u,d){return Va(a(u,d),d)}function l(u,d,p,m){var g="C;Y"+(p+1)+";X"+(m+1)+";K";switch(u.t){case"n":g+=u.v||0,u.f&&!u.F&&(g+=";E"+$O(u.f,{r:p,c:m}));break;case"b":g+=u.v?"TRUE":"FALSE";break;case"e":g+=u.w||u.v;break;case"d":g+='"'+(u.w||u.v)+'"';break;case"s":g+='"'+u.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return g}function f(u,d){d.forEach(function(p,m){var g="F;W"+(m+1)+" "+(m+1)+" ";p.hidden?g+="0":(typeof p.width=="number"&&!p.wpx&&(p.wpx=kc(p.width)),typeof p.wpx=="number"&&!p.wch&&(p.wch=Sc(p.wpx)),typeof p.wch=="number"&&(g+=Math.round(p.wch))),g.charAt(g.length-1)!=" "&&u.push(g)})}function c(u,d){d.forEach(function(p,m){var g="F;";p.hidden?g+="M0;":p.hpt?g+="M"+20*p.hpt+";":p.hpx&&(g+="M"+20*Tc(p.hpx)+";"),g.length>2&&u.push(g+"R"+(m+1))})}function h(u,d){var p=["ID;PWXL;N;E"],m=[],g=yt(u["!ref"]),O,w=Array.isArray(u),v=`\r
`;p.push("P;PGeneral"),p.push("F;P0;DG0G8;M255"),u["!cols"]&&f(p,u["!cols"]),u["!rows"]&&c(p,u["!rows"]),p.push("B;Y"+(g.e.r-g.s.r+1)+";X"+(g.e.c-g.s.c+1)+";D"+[g.s.c,g.s.r,g.e.c,g.e.r].join(" "));for(var S=g.s.r;S<=g.e.r;++S)for(var y=g.s.c;y<=g.e.c;++y){var b=et({r:S,c:y});O=w?(u[S]||[])[y]:u[b],!(!O||O.v==null&&(!O.f||O.F))&&m.push(l(O,u,S,y))}return p.join(v)+v+m.join(v)+v+"E"+v}return{to_workbook:o,to_sheet:a,from_sheet:h}}(),qS=function(){function r(s,a){switch(a.type){case"base64":return e(gi(s),a);case"binary":return e(s,a);case"buffer":return e(dt&&Buffer.isBuffer(s)?s.toString("binary"):Xa(s),a);case"array":return e(To(s),a)}throw new Error("Unrecognized type "+a.type)}function e(s,a){for(var o=s.split(`
`),l=-1,f=-1,c=0,h=[];c!==o.length;++c){if(o[c].trim()==="BOT"){h[++l]=[],f=0;continue}if(!(l<0)){var u=o[c].trim().split(","),d=u[0],p=u[1];++c;for(var m=o[c]||"";(m.match(/["]/g)||[]).length&1&&c<o.length-1;)m+=`
`+o[++c];switch(m=m.trim(),+d){case-1:if(m==="BOT"){h[++l]=[],f=0;continue}else if(m!=="EOD")throw new Error("Unrecognized DIF special command "+m);break;case 0:m==="TRUE"?h[l][f]=!0:m==="FALSE"?h[l][f]=!1:isNaN(Yi(p))?isNaN(Al(p).getDate())?h[l][f]=p:h[l][f]=or(p):h[l][f]=Yi(p),++f;break;case 1:m=m.slice(1,m.length-1),m=m.replace(/""/g,'"'),m&&m.match(/^=".*"$/)&&(m=m.slice(2,-1)),h[l][f++]=m!==""?m:null;break}if(m==="EOD")break}}return a&&a.sheetRows&&(h=h.slice(0,a.sheetRows)),h}function t(s,a){return rf(r(s,a),a)}function n(s,a){return Va(t(s,a),a)}var i=function(){var s=function(l,f,c,h,u){l.push(f),l.push(c+","+h),l.push('"'+u.replace(/"/g,'""')+'"')},a=function(l,f,c,h){l.push(f+","+c),l.push(f==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(l){var f=[],c=yt(l["!ref"]),h,u=Array.isArray(l);s(f,"TABLE",0,1,"sheetjs"),s(f,"VECTORS",0,c.e.r-c.s.r+1,""),s(f,"TUPLES",0,c.e.c-c.s.c+1,""),s(f,"DATA",0,0,"");for(var d=c.s.r;d<=c.e.r;++d){a(f,-1,0,"BOT");for(var p=c.s.c;p<=c.e.c;++p){var m=et({r:d,c:p});if(h=u?(l[d]||[])[p]:l[m],!h){a(f,1,0,"");continue}switch(h.t){case"n":var g=h.w;!g&&h.v!=null&&(g=h.v),g==null?h.f&&!h.F?a(f,1,0,"="+h.f):a(f,1,0,""):a(f,0,g,"V");break;case"b":a(f,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":a(f,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=Oi(h.z||Ke[14],Xr(or(h.v)))),a(f,0,h.w,"V");break;default:a(f,1,0,"")}}}a(f,-1,0,"EOD");var O=`\r
`,w=f.join(O);return w}}();return{to_workbook:n,to_sheet:t,from_sheet:i}}(),jS=function(){function r(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(h,u){for(var d=h.split(`
`),p=-1,m=-1,g=0,O=[];g!==d.length;++g){var w=d[g].trim().split(":");if(w[0]==="cell"){var v=xr(w[1]);if(O.length<=v.r)for(p=O.length;p<=v.r;++p)O[p]||(O[p]=[]);switch(p=v.r,m=v.c,w[2]){case"t":O[p][m]=r(w[3]);break;case"v":O[p][m]=+w[3];break;case"vtf":var S=w[w.length-1];case"vtc":switch(w[3]){case"nl":O[p][m]=!!+w[4];break;default:O[p][m]=+w[4];break}w[2]=="vtf"&&(O[p][m]=[O[p][m],S])}}}return u&&u.sheetRows&&(O=O.slice(0,u.sheetRows)),O}function n(h,u){return rf(t(h,u),u)}function i(h,u){return Va(n(h,u),u)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function f(h){if(!h||!h["!ref"])return"";for(var u=[],d=[],p,m="",g=Ln(h["!ref"]),O=Array.isArray(h),w=g.s.r;w<=g.e.r;++w)for(var v=g.s.c;v<=g.e.c;++v)if(m=et({r:w,c:v}),p=O?(h[w]||[])[v]:h[m],!(!p||p.v==null||p.t==="z")){switch(d=["cell",m,"t"],p.t){case"s":case"str":d.push(e(p.v));break;case"n":p.f?(d[2]="vtf",d[3]="n",d[4]=p.v,d[5]=e(p.f)):(d[2]="v",d[3]=p.v);break;case"b":d[2]="vt"+(p.f?"f":"c"),d[3]="nl",d[4]=p.v?"1":"0",d[5]=e(p.f||(p.v?"TRUE":"FALSE"));break;case"d":var S=Xr(or(p.v));d[2]="vtc",d[3]="nd",d[4]=""+S,d[5]=p.w||Oi(p.z||Ke[14],S);break;case"e":continue}u.push(d.join(":"))}return u.push("sheet:c:"+(g.e.c-g.s.c+1)+":r:"+(g.e.r-g.s.r+1)+":tvf:1"),u.push("valueformat:1:text-wiki"),u.join(`
`)}function c(h){return[s,a,o,a,f(h),l].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:c}}(),El=function(){function r(c,h,u,d,p){p.raw?h[u][d]=c:c===""||(c==="TRUE"?h[u][d]=!0:c==="FALSE"?h[u][d]=!1:isNaN(Yi(c))?isNaN(Al(c).getDate())?h[u][d]=c:h[u][d]=or(c):h[u][d]=Yi(c))}function e(c,h){var u=h||{},d=[];if(!c||c.length===0)return d;for(var p=c.split(/[\r\n]/),m=p.length-1;m>=0&&p[m].length===0;)--m;for(var g=10,O=0,w=0;w<=m;++w)O=p[w].indexOf(" "),O==-1?O=p[w].length:O++,g=Math.max(g,O);for(w=0;w<=m;++w){d[w]=[];var v=0;for(r(p[w].slice(0,g).trim(),d,w,v,u),v=1;v<=(p[w].length-g)/10+1;++v)r(p[w].slice(g+(v-1)*10,g+v*10).trim(),d,w,v,u)}return u.sheetRows&&(d=d.slice(0,u.sheetRows)),d}var t={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(c){for(var h={},u=!1,d=0,p=0;d<c.length;++d)(p=c.charCodeAt(d))==34?u=!u:!u&&p in t&&(h[p]=(h[p]||0)+1);p=[];for(d in h)Object.prototype.hasOwnProperty.call(h,d)&&p.push([h[d],d]);if(!p.length){h=n;for(d in h)Object.prototype.hasOwnProperty.call(h,d)&&p.push([h[d],d])}return p.sort(function(m,g){return m[0]-g[0]||n[m[1]]-n[g[1]]}),t[p.pop()[1]]||44}function s(c,h){var u=h||{},d="",p=u.dense?[]:{},m={s:{c:0,r:0},e:{c:0,r:0}};c.slice(0,4)=="sep="?c.charCodeAt(5)==13&&c.charCodeAt(6)==10?(d=c.charAt(4),c=c.slice(7)):c.charCodeAt(5)==13||c.charCodeAt(5)==10?(d=c.charAt(4),c=c.slice(6)):d=i(c.slice(0,1024)):u.FS?d=u.FS:d=i(c.slice(0,1024));var g=0,O=0,w=0,v=0,S=0,y=d.charCodeAt(0),b=!1,x=0,A=c.charCodeAt(0);c=c.replace(/\r\n/mg,`
`);var k=u.dateNF!=null?ZQ(u.dateNF):null;function E(){var T=c.slice(v,S),_={};if(T.charAt(0)=='"'&&T.charAt(T.length-1)=='"'&&(T=T.slice(1,-1).replace(/""/g,'"')),T.length===0)_.t="z";else if(u.raw)_.t="s",_.v=T;else if(T.trim().length===0)_.t="s",_.v=T;else if(T.charCodeAt(0)==61)T.charCodeAt(1)==34&&T.charCodeAt(T.length-1)==34?(_.t="s",_.v=T.slice(2,-1).replace(/""/g,'"')):O8(T)?(_.t="n",_.f=T.slice(1)):(_.t="s",_.v=T);else if(T=="TRUE")_.t="b",_.v=!0;else if(T=="FALSE")_.t="b",_.v=!1;else if(!isNaN(w=Yi(T)))_.t="n",u.cellText!==!1&&(_.w=T),_.v=w;else if(!isNaN(Al(T).getDate())||k&&T.match(k)){_.z=u.dateNF||Ke[14];var N=0;k&&T.match(k)&&(T=WQ(T,u.dateNF,T.match(k)||[]),N=1),u.cellDates?(_.t="d",_.v=or(T,N)):(_.t="n",_.v=Xr(or(T,N))),u.cellText!==!1&&(_.w=Oi(_.z,_.v instanceof Date?Xr(_.v):_.v)),u.cellNF||delete _.z}else _.t="s",_.v=T;if(_.t=="z"||(u.dense?(p[g]||(p[g]=[]),p[g][O]=_):p[et({c:O,r:g})]=_),v=S+1,A=c.charCodeAt(v),m.e.c<O&&(m.e.c=O),m.e.r<g&&(m.e.r=g),x==y)++O;else if(O=0,++g,u.sheetRows&&u.sheetRows<=g)return!0}e:for(;S<c.length;++S)switch(x=c.charCodeAt(S)){case 34:A===34&&(b=!b);break;case y:case 10:case 13:if(!b&&E())break e;break}return S-v>0&&E(),p["!ref"]=lt(m),p}function a(c,h){return!(h&&h.PRN)||h.FS||c.slice(0,4)=="sep="||c.indexOf("	")>=0||c.indexOf(",")>=0||c.indexOf(";")>=0?s(c,h):rf(e(c,h),h)}function o(c,h){var u="",d=h.type=="string"?[0,0,0,0]:UO(c,h);switch(h.type){case"base64":u=gi(c);break;case"binary":u=c;break;case"buffer":h.codepage==65001?u=c.toString("utf8"):h.codepage&&typeof St<"u"?u=St.utils.decode(h.codepage,c):u=dt&&Buffer.isBuffer(c)?c.toString("binary"):Xa(c);break;case"array":u=To(c);break;case"string":u=c;break;default:throw new Error("Unrecognized type "+h.type)}return d[0]==239&&d[1]==187&&d[2]==191?u=Zt(u.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?u=Zt(u):h.type=="binary"&&typeof St<"u"&&h.codepage&&(u=St.utils.decode(h.codepage,St.utils.encode(28591,u))),u.slice(0,19)=="socialcalc:version:"?jS.to_sheet(h.type=="string"?u:Zt(u),h):a(u,h)}function l(c,h){return Va(o(c,h),h)}function f(c){for(var h=[],u=yt(c["!ref"]),d,p=Array.isArray(c),m=u.s.r;m<=u.e.r;++m){for(var g=[],O=u.s.c;O<=u.e.c;++O){var w=et({r:m,c:O});if(d=p?(c[m]||[])[O]:c[w],!d||d.v==null){g.push("          ");continue}for(var v=(d.w||(As(d),d.w)||"").slice(0,10);v.length<10;)v+=" ";g.push(v+(O===0?" ":""))}h.push(g.join(""))}return h.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:f}}();function nN(r,e){var t=e||{},n=!!t.WTF;t.WTF=!0;try{var i=VS.to_workbook(r,t);return t.WTF=n,i}catch(s){if(t.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return El.to_workbook(r,e)}}var xo=function(){function r(P,I,B){if(P){sn(P,P.l||0);for(var W=B.Enum||ue;P.l<P.length;){var K=P.read_shift(2),re=W[K]||W[65535],pe=P.read_shift(2),fe=P.l+pe,de=re.f&&re.f(P,pe,B);if(P.l=fe,I(de,re,K))return}}}function e(P,I){switch(I.type){case"base64":return t(oi(gi(P)),I);case"binary":return t(oi(P),I);case"buffer":case"array":return t(P,I)}throw"Unsupported type "+I.type}function t(P,I){if(!P)return P;var B=I||{},W=B.dense?[]:{},K="Sheet1",re="",pe=0,fe={},de=[],Ue=[],q={s:{r:0,c:0},e:{r:0,c:0}},ze=B.sheetRows||0;if(P[2]==0&&(P[3]==8||P[3]==9)&&P.length>=16&&P[14]==5&&P[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(P[2]==2)B.Enum=ue,r(P,function(ve,it,ot){switch(ot){case 0:B.vers=ve,ve>=4096&&(B.qpro=!0);break;case 6:q=ve;break;case 204:ve&&(re=ve);break;case 222:re=ve;break;case 15:case 51:B.qpro||(ve[1].v=ve[1].v.slice(1));case 13:case 14:case 16:ot==14&&(ve[2]&112)==112&&(ve[2]&15)>1&&(ve[2]&15)<15&&(ve[1].z=B.dateNF||Ke[14],B.cellDates&&(ve[1].t="d",ve[1].v=O0(ve[1].v))),B.qpro&&ve[3]>pe&&(W["!ref"]=lt(q),fe[K]=W,de.push(K),W=B.dense?[]:{},q={s:{r:0,c:0},e:{r:0,c:0}},pe=ve[3],K=re||"Sheet"+(pe+1),re="");var bt=B.dense?(W[ve[0].r]||[])[ve[0].c]:W[et(ve[0])];if(bt){bt.t=ve[1].t,bt.v=ve[1].v,ve[1].z!=null&&(bt.z=ve[1].z),ve[1].f!=null&&(bt.f=ve[1].f);break}B.dense?(W[ve[0].r]||(W[ve[0].r]=[]),W[ve[0].r][ve[0].c]=ve[1]):W[et(ve[0])]=ve[1];break}},B);else if(P[2]==26||P[2]==14)B.Enum=ie,P[2]==14&&(B.qpro=!0,P.l=0),r(P,function(ve,it,ot){switch(ot){case 204:K=ve;break;case 22:ve[1].v=ve[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ve[3]>pe&&(W["!ref"]=lt(q),fe[K]=W,de.push(K),W=B.dense?[]:{},q={s:{r:0,c:0},e:{r:0,c:0}},pe=ve[3],K="Sheet"+(pe+1)),ze>0&&ve[0].r>=ze)break;B.dense?(W[ve[0].r]||(W[ve[0].r]=[]),W[ve[0].r][ve[0].c]=ve[1]):W[et(ve[0])]=ve[1],q.e.c<ve[0].c&&(q.e.c=ve[0].c),q.e.r<ve[0].r&&(q.e.r=ve[0].r);break;case 27:ve[14e3]&&(Ue[ve[14e3][0]]=ve[14e3][1]);break;case 1537:Ue[ve[0]]=ve[1],ve[0]==pe&&(K=ve[1]);break}},B);else throw new Error("Unrecognized LOTUS BOF "+P[2]);if(W["!ref"]=lt(q),fe[re||K]=W,de.push(re||K),!Ue.length)return{SheetNames:de,Sheets:fe};for(var Qe={},De=[],Fe=0;Fe<Ue.length;++Fe)fe[de[Fe]]?(De.push(Ue[Fe]||de[Fe]),Qe[Ue[Fe]]=fe[Ue[Fe]]||fe[de[Fe]]):(De.push(Ue[Fe]),Qe[Ue[Fe]]={"!ref":"A1"});return{SheetNames:De,Sheets:Qe}}function n(P,I){var B=I||{};if(+B.codepage>=0&&Ei(+B.codepage),B.type=="string")throw new Error("Cannot write WK1 to JS string");var W=Kn(),K=yt(P["!ref"]),re=Array.isArray(P),pe=[];Ne(W,0,s(1030)),Ne(W,6,l(K));for(var fe=Math.min(K.e.r,8191),de=K.s.r;de<=fe;++de)for(var Ue=kr(de),q=K.s.c;q<=K.e.c;++q){de===K.s.r&&(pe[q]=ar(q));var ze=pe[q]+Ue,Qe=re?(P[de]||[])[q]:P[ze];if(!(!Qe||Qe.t=="z"))if(Qe.t=="n")(Qe.v|0)==Qe.v&&Qe.v>=-32768&&Qe.v<=32767?Ne(W,13,d(de,q,Qe.v)):Ne(W,14,m(de,q,Qe.v));else{var De=As(Qe);Ne(W,15,h(de,q,De.slice(0,239)))}}return Ne(W,1),W.end()}function i(P,I){var B=I||{};if(+B.codepage>=0&&Ei(+B.codepage),B.type=="string")throw new Error("Cannot write WK3 to JS string");var W=Kn();Ne(W,0,a(P));for(var K=0,re=0;K<P.SheetNames.length;++K)(P.Sheets[P.SheetNames[K]]||{})["!ref"]&&Ne(W,27,V(P.SheetNames[K],re++));var pe=0;for(K=0;K<P.SheetNames.length;++K){var fe=P.Sheets[P.SheetNames[K]];if(!(!fe||!fe["!ref"])){for(var de=yt(fe["!ref"]),Ue=Array.isArray(fe),q=[],ze=Math.min(de.e.r,8191),Qe=de.s.r;Qe<=ze;++Qe)for(var De=kr(Qe),Fe=de.s.c;Fe<=de.e.c;++Fe){Qe===de.s.r&&(q[Fe]=ar(Fe));var ve=q[Fe]+De,it=Ue?(fe[Qe]||[])[Fe]:fe[ve];if(!(!it||it.t=="z"))if(it.t=="n")Ne(W,23,E(Qe,Fe,pe,it.v));else{var ot=As(it);Ne(W,22,x(Qe,Fe,pe,ot.slice(0,239)))}}++pe}}return Ne(W,1),W.end()}function s(P){var I=me(2);return I.write_shift(2,P),I}function a(P){var I=me(26);I.write_shift(2,4096),I.write_shift(2,4),I.write_shift(4,0);for(var B=0,W=0,K=0,re=0;re<P.SheetNames.length;++re){var pe=P.SheetNames[re],fe=P.Sheets[pe];if(!(!fe||!fe["!ref"])){++K;var de=Ln(fe["!ref"]);B<de.e.r&&(B=de.e.r),W<de.e.c&&(W=de.e.c)}}return B>8191&&(B=8191),I.write_shift(2,B),I.write_shift(1,K),I.write_shift(1,W),I.write_shift(2,0),I.write_shift(2,0),I.write_shift(1,1),I.write_shift(1,2),I.write_shift(4,0),I.write_shift(4,0),I}function o(P,I,B){var W={s:{c:0,r:0},e:{c:0,r:0}};return I==8&&B.qpro?(W.s.c=P.read_shift(1),P.l++,W.s.r=P.read_shift(2),W.e.c=P.read_shift(1),P.l++,W.e.r=P.read_shift(2),W):(W.s.c=P.read_shift(2),W.s.r=P.read_shift(2),I==12&&B.qpro&&(P.l+=2),W.e.c=P.read_shift(2),W.e.r=P.read_shift(2),I==12&&B.qpro&&(P.l+=2),W.s.c==65535&&(W.s.c=W.e.c=W.s.r=W.e.r=0),W)}function l(P){var I=me(8);return I.write_shift(2,P.s.c),I.write_shift(2,P.s.r),I.write_shift(2,P.e.c),I.write_shift(2,P.e.r),I}function f(P,I,B){var W=[{c:0,r:0},{t:"n",v:0},0,0];return B.qpro&&B.vers!=20768?(W[0].c=P.read_shift(1),W[3]=P.read_shift(1),W[0].r=P.read_shift(2),P.l+=2):(W[2]=P.read_shift(1),W[0].c=P.read_shift(2),W[0].r=P.read_shift(2)),W}function c(P,I,B){var W=P.l+I,K=f(P,I,B);if(K[1].t="s",B.vers==20768){P.l++;var re=P.read_shift(1);return K[1].v=P.read_shift(re,"utf8"),K}return B.qpro&&P.l++,K[1].v=P.read_shift(W-P.l,"cstr"),K}function h(P,I,B){var W=me(7+B.length);W.write_shift(1,255),W.write_shift(2,I),W.write_shift(2,P),W.write_shift(1,39);for(var K=0;K<W.length;++K){var re=B.charCodeAt(K);W.write_shift(1,re>=128?95:re)}return W.write_shift(1,0),W}function u(P,I,B){var W=f(P,I,B);return W[1].v=P.read_shift(2,"i"),W}function d(P,I,B){var W=me(7);return W.write_shift(1,255),W.write_shift(2,I),W.write_shift(2,P),W.write_shift(2,B,"i"),W}function p(P,I,B){var W=f(P,I,B);return W[1].v=P.read_shift(8,"f"),W}function m(P,I,B){var W=me(13);return W.write_shift(1,255),W.write_shift(2,I),W.write_shift(2,P),W.write_shift(8,B,"f"),W}function g(P,I,B){var W=P.l+I,K=f(P,I,B);if(K[1].v=P.read_shift(8,"f"),B.qpro)P.l=W;else{var re=P.read_shift(2);S(P.slice(P.l,P.l+re),K),P.l+=re}return K}function O(P,I,B){var W=I&32768;return I&=-32769,I=(W?P:0)+(I>=8192?I-16384:I),(W?"":"$")+(B?ar(I):kr(I))}var w={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},v=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function S(P,I){sn(P,0);for(var B=[],W=0,K="",re="",pe="",fe="";P.l<P.length;){var de=P[P.l++];switch(de){case 0:B.push(P.read_shift(8,"f"));break;case 1:re=O(I[0].c,P.read_shift(2),!0),K=O(I[0].r,P.read_shift(2),!1),B.push(re+K);break;case 2:{var Ue=O(I[0].c,P.read_shift(2),!0),q=O(I[0].r,P.read_shift(2),!1);re=O(I[0].c,P.read_shift(2),!0),K=O(I[0].r,P.read_shift(2),!1),B.push(Ue+q+":"+re+K)}break;case 3:if(P.l<P.length){console.error("WK1 premature formula end");return}break;case 4:B.push("("+B.pop()+")");break;case 5:B.push(P.read_shift(2));break;case 6:{for(var ze="";de=P[P.l++];)ze+=String.fromCharCode(de);B.push('"'+ze.replace(/"/g,'""')+'"')}break;case 8:B.push("-"+B.pop());break;case 23:B.push("+"+B.pop());break;case 22:B.push("NOT("+B.pop()+")");break;case 20:case 21:fe=B.pop(),pe=B.pop(),B.push(["AND","OR"][de-20]+"("+pe+","+fe+")");break;default:if(de<32&&v[de])fe=B.pop(),pe=B.pop(),B.push(pe+v[de]+fe);else if(w[de]){if(W=w[de][1],W==69&&(W=P[P.l++]),W>B.length){console.error("WK1 bad formula parse 0x"+de.toString(16)+":|"+B.join("|")+"|");return}var Qe=B.slice(-W);B.length-=W,B.push(w[de][0]+"("+Qe.join(",")+")")}else return de<=7?console.error("WK1 invalid opcode "+de.toString(16)):de<=24?console.error("WK1 unsupported op "+de.toString(16)):de<=30?console.error("WK1 invalid opcode "+de.toString(16)):de<=115?console.error("WK1 unsupported function opcode "+de.toString(16)):console.error("WK1 unrecognized opcode "+de.toString(16))}}B.length==1?I[1].f=""+B[0]:console.error("WK1 bad formula parse |"+B.join("|")+"|")}function y(P){var I=[{c:0,r:0},{t:"n",v:0},0];return I[0].r=P.read_shift(2),I[3]=P[P.l++],I[0].c=P[P.l++],I}function b(P,I){var B=y(P);return B[1].t="s",B[1].v=P.read_shift(I-4,"cstr"),B}function x(P,I,B,W){var K=me(6+W.length);K.write_shift(2,P),K.write_shift(1,B),K.write_shift(1,I),K.write_shift(1,39);for(var re=0;re<W.length;++re){var pe=W.charCodeAt(re);K.write_shift(1,pe>=128?95:pe)}return K.write_shift(1,0),K}function A(P,I){var B=y(P);B[1].v=P.read_shift(2);var W=B[1].v>>1;if(B[1].v&1)switch(W&7){case 0:W=(W>>3)*5e3;break;case 1:W=(W>>3)*500;break;case 2:W=(W>>3)/20;break;case 3:W=(W>>3)/200;break;case 4:W=(W>>3)/2e3;break;case 5:W=(W>>3)/2e4;break;case 6:W=(W>>3)/16;break;case 7:W=(W>>3)/64;break}return B[1].v=W,B}function k(P,I){var B=y(P),W=P.read_shift(4),K=P.read_shift(4),re=P.read_shift(2);if(re==65535)return W===0&&K===3221225472?(B[1].t="e",B[1].v=15):W===0&&K===3489660928?(B[1].t="e",B[1].v=42):B[1].v=0,B;var pe=re&32768;return re=(re&32767)-16446,B[1].v=(1-pe*2)*(K*Math.pow(2,re+32)+W*Math.pow(2,re)),B}function E(P,I,B,W){var K=me(14);if(K.write_shift(2,P),K.write_shift(1,B),K.write_shift(1,I),W==0)return K.write_shift(4,0),K.write_shift(4,0),K.write_shift(2,65535),K;var re=0,pe=0,fe=0,de=0;return W<0&&(re=1,W=-W),pe=Math.log2(W)|0,W/=Math.pow(2,pe-31),de=W>>>0,de&2147483648||(W/=2,++pe,de=W>>>0),W-=de,de|=2147483648,de>>>=0,W*=Math.pow(2,32),fe=W>>>0,K.write_shift(4,fe),K.write_shift(4,de),pe+=16383+(re?32768:0),K.write_shift(2,pe),K}function T(P,I){var B=k(P);return P.l+=I-14,B}function _(P,I){var B=y(P),W=P.read_shift(4);return B[1].v=W>>6,B}function N(P,I){var B=y(P),W=P.read_shift(8,"f");return B[1].v=W,B}function Z(P,I){var B=N(P);return P.l+=I-10,B}function z(P,I){return P[P.l+I-1]==0?P.read_shift(I,"cstr"):""}function ee(P,I){var B=P[P.l++];B>I-1&&(B=I-1);for(var W="";W.length<B;)W+=String.fromCharCode(P[P.l++]);return W}function ae(P,I,B){if(!(!B.qpro||I<21)){var W=P.read_shift(1);P.l+=17,P.l+=1,P.l+=2;var K=P.read_shift(I-21,"cstr");return[W,K]}}function xe(P,I){for(var B={},W=P.l+I;P.l<W;){var K=P.read_shift(2);if(K==14e3){for(B[K]=[0,""],B[K][0]=P.read_shift(2);P[P.l];)B[K][1]+=String.fromCharCode(P[P.l]),P.l++;P.l++}}return B}function V(P,I){var B=me(5+P.length);B.write_shift(2,14e3),B.write_shift(2,I);for(var W=0;W<P.length;++W){var K=P.charCodeAt(W);B[B.l++]=K>127?95:K}return B[B.l++]=0,B}var ue={0:{n:"BOF",f:Mr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:u},14:{n:"NUMBER",f:p},15:{n:"LABEL",f:c},16:{n:"FORMULA",f:g},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:c},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:z},222:{n:"SHEETNAMELP",f:ee},65535:{n:""}},ie={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:b},23:{n:"NUMBER17",f:k},24:{n:"NUMBER18",f:A},25:{n:"FORMULA19",f:T},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:xe},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:_},38:{n:"??"},39:{n:"NUMBER27",f:N},40:{n:"FORMULA28",f:Z},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:z},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ae},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:e}}();function iN(r){var e={},t=r.match(Pn),n=0,i=!1;if(t)for(;n!=t.length;++n){var s=tt(t[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;e.cp=nO[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=s.val;break;case"<sz":e.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":s.rgb&&(e.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+s[0])}}return e}var sN=function(){var r=vc("t"),e=vc("rPr");function t(s){var a=s.match(r);if(!a)return{t:"s",v:""};var o={t:"s",v:At(a[1])},l=s.match(e);return l&&(o.s=iN(l[1])),o}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(a){return a.replace(n,"").split(i).map(t).filter(function(o){return o.v})}}(),aN=function(){var e=/(\r\n|\n)/g;function t(i,s,a){var o=[];i.u&&o.push("text-decoration: underline;"),i.uval&&o.push("text-underline-style:"+i.uval+";"),i.sz&&o.push("font-size:"+i.sz+"pt;"),i.outline&&o.push("text-effect: outline;"),i.shadow&&o.push("text-shadow: auto;"),s.push('<span style="'+o.join("")+'">'),i.b&&(s.push("<b>"),a.push("</b>")),i.i&&(s.push("<i>"),a.push("</i>")),i.strike&&(s.push("<s>"),a.push("</s>"));var l=i.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(s.push("<"+l+">"),a.push("</"+l+">")),a.push("</span>"),i}function n(i){var s=[[],i.v,[]];return i.v?(i.s&&t(i.s,s[0],s[2]),s[0].join("")+s[1].replace(e,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),oN=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,lN=/<(?:\w+:)?r>/,fN=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function EO(r,e){var t=e?e.cellHTML:!0,n={};return r?(r.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=At(Zt(r.slice(r.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Zt(r),t&&(n.h=hO(n.t))):r.match(lN)&&(n.r=Zt(r),n.t=At(Zt((r.replace(fN,"").match(oN)||[]).join("").replace(Pn,""))),t&&(n.h=aN(sN(n.r)))),n):{t:""}}var cN=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,hN=/<(?:\w+:)?(?:si|sstItem)>/g,uN=/<\/(?:\w+:)?(?:si|sstItem)>/;function dN(r,e){var t=[],n="";if(!r)return t;var i=r.match(cN);if(i){n=i[2].replace(hN,"").split(uN);for(var s=0;s!=n.length;++s){var a=EO(n[s].trim(),e);a!=null&&(t[t.length]=a)}i=tt(i[1]),t.Count=i.count,t.Unique=i.uniqueCount}return t}var pN=/^\s|\s$|[\t\n\r]/;function zS(r,e){if(!e.bookSST)return"";var t=[Fr];t[t.length]=$e("sst",null,{xmlns:Lo[0],count:r.Count,uniqueCount:r.Unique});for(var n=0;n!=r.length;++n)if(r[n]!=null){var i=r[n],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(pN)&&(s+=' xml:space="preserve"'),s+=">"+Bt(i.t)+"</t>"),s+="</si>",t[t.length]=s}return t.length>2&&(t[t.length]="</sst>",t[1]=t[1].replace("/>",">")),t.join("")}function mN(r){return[r.read_shift(4),r.read_shift(4)]}function gN(r,e){var t=[],n=!1;return ia(r,function(s,a,o){switch(o){case 159:t.Count=s[0],t.Unique=s[1];break;case 19:t.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(a.T,!n||e.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),t}function ON(r,e){return e||(e=me(8)),e.write_shift(4,r.Count),e.write_shift(4,r.Unique),e}var xN=AF;function vN(r){var e=Kn();_e(e,159,ON(r));for(var t=0;t<r.length;++t)_e(e,19,xN(r[t]));return _e(e,160),e.end()}function GS(r){if(typeof St<"u")return St.utils.encode(ko,r);for(var e=[],t=r.split(""),n=0;n<t.length;++n)e[n]=t[n].charCodeAt(0);return e}function zs(r,e){var t={};return t.Major=r.read_shift(2),t.Minor=r.read_shift(2),e>=4&&(r.l+=e-4),t}function yN(r){var e={};return e.id=r.read_shift(0,"lpp4"),e.R=zs(r,4),e.U=zs(r,4),e.W=zs(r,4),e}function wN(r){for(var e=r.read_shift(4),t=r.l+e-4,n={},i=r.read_shift(4),s=[];i-- >0;)s.push({t:r.read_shift(4),v:r.read_shift(0,"lpp4")});if(n.name=r.read_shift(0,"lpp4"),n.comps=s,r.l!=t)throw new Error("Bad DataSpaceMapEntry: "+r.l+" != "+t);return n}function bN(r){var e=[];r.l+=4;for(var t=r.read_shift(4);t-- >0;)e.push(wN(r));return e}function _N(r){var e=[];r.l+=4;for(var t=r.read_shift(4);t-- >0;)e.push(r.read_shift(0,"lpp4"));return e}function kN(r){var e={};return r.read_shift(4),r.l+=4,e.id=r.read_shift(0,"lpp4"),e.name=r.read_shift(0,"lpp4"),e.R=zs(r,4),e.U=zs(r,4),e.W=zs(r,4),e}function SN(r){var e=kN(r);if(e.ename=r.read_shift(0,"8lpp4"),e.blksz=r.read_shift(4),e.cmode=r.read_shift(4),r.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function HS(r,e){var t=r.l+e,n={};n.Flags=r.read_shift(4)&63,r.l+=4,n.AlgID=r.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=r.read_shift(4),n.KeySize=r.read_shift(4),n.ProviderType=r.read_shift(4),r.l+=8,n.CSPName=r.read_shift(t-r.l>>1,"utf16le"),r.l=t,n}function YS(r,e){var t={},n=r.l+e;return r.l+=4,t.Salt=r.slice(r.l,r.l+16),r.l+=16,t.Verifier=r.slice(r.l,r.l+16),r.l+=16,r.read_shift(4),t.VerifierHash=r.slice(r.l,n),r.l=n,t}function TN(r){var e=zs(r);switch(e.Minor){case 2:return[e.Minor,CN(r)];case 3:return[e.Minor,AN()];case 4:return[e.Minor,EN(r)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function CN(r){var e=r.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var t=r.read_shift(4),n=HS(r,t),i=YS(r,r.length-r.l);return{t:"Std",h:n,v:i}}function AN(){throw new Error("File is password-protected: ECMA-376 Extensible")}function EN(r){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];r.l+=4;var t=r.read_shift(r.length-r.l,"utf8"),n={};return t.replace(Pn,function(s){var a=tt(s);switch(Ds(a[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(o){n[o]=a[o]});break;case"<dataIntegrity":n.encryptedHmacKey=a.encryptedHmacKey,n.encryptedHmacValue=a.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=a.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(a);break;default:throw a[0]}}),n}function PN(r,e){var t={},n=t.EncryptionVersionInfo=zs(r,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);t.Flags=r.read_shift(4),e-=4;var i=r.read_shift(4);return e-=4,t.EncryptionHeader=HS(r,i),e-=i,t.EncryptionVerifier=YS(r,e),t}function RN(r){var e={},t=e.EncryptionVersionInfo=zs(r,4);if(t.Major!=1||t.Minor!=1)throw"unrecognized version code "+t.Major+" : "+t.Minor;return e.Salt=r.read_shift(16),e.EncryptedVerifier=r.read_shift(16),e.EncryptedVerifierHash=r.read_shift(16),e}function PO(r){var e=0,t,n=GS(r),i=n.length+1,s,a,o,l,f;for(t=Ra(i),t[0]=n.length,s=1;s!=i;++s)t[s]=n[s-1];for(s=i-1;s>=0;--s)a=t[s],o=e&16384?1:0,l=e<<1&32767,f=o|l,e=f^a;return e^52811}var KS=function(){var r=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],t=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(a){return(a/2|a*128)&255},i=function(a,o){return n(a^o)},s=function(a){for(var o=e[a.length-1],l=104,f=a.length-1;f>=0;--f)for(var c=a[f],h=0;h!=7;++h)c&64&&(o^=t[l]),c*=2,--l;return o};return function(a){for(var o=GS(a),l=s(o),f=o.length,c=Ra(16),h=0;h!=16;++h)c[h]=0;var u,d,p;for((f&1)===1&&(u=l>>8,c[f]=i(r[0],u),--f,u=l&255,d=o[o.length-1],c[f]=i(d,u));f>0;)--f,u=l>>8,c[f]=i(o[f],u),--f,u=l&255,c[f]=i(o[f],u);for(f=15,p=15-o.length;p>0;)u=l>>8,c[f]=i(r[p],u),--f,--p,u=l&255,c[f]=i(o[f],u),--f,--p;return c}}(),QN=function(r,e,t,n,i){i||(i=e),n||(n=KS(r));var s,a;for(s=0;s!=e.length;++s)a=e[s],a^=n[t],a=(a>>5|a<<3)&255,i[s]=a,++t;return[i,t,n]},FN=function(r){var e=0,t=KS(r);return function(n){var i=QN("",n,e,t);return e=i[1],i[0]}};function $N(r,e,t,n){var i={key:Mr(r),verificationBytes:Mr(r)};return t.password&&(i.verifier=PO(t.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=FN(t.password)),i}function DN(r,e,t){var n=t;return n.Info=r.read_shift(2),r.l-=2,n.Info===1?n.Data=RN(r):n.Data=PN(r,e),n}function NN(r,e,t){var n={Type:t.biff>=8?r.read_shift(2):0};return n.Type?DN(r,e-2,n):$N(r,t.biff>=8?e:e-2,t,n),n}var JS=function(){function r(i,s){switch(s.type){case"base64":return e(gi(i),s);case"binary":return e(i,s);case"buffer":return e(dt&&Buffer.isBuffer(i)?i.toString("binary"):Xa(i),s);case"array":return e(To(i),s)}throw new Error("Unrecognized type "+s.type)}function e(i,s){var a=s||{},o=a.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var f={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(c,h){Array.isArray(o)&&(o[h]=[]);for(var u=/\\\w+\b/g,d=0,p,m=-1;p=u.exec(c);){switch(p[0]){case"\\cell":var g=c.slice(d,u.lastIndex-p[0].length);if(g[0]==" "&&(g=g.slice(1)),++m,g.length){var O={v:g,t:"s"};Array.isArray(o)?o[h][m]=O:o[et({r:h,c:m})]=O}break}d=u.lastIndex}m>f.e.c&&(f.e.c=m)}),o["!ref"]=lt(f),o}function t(i,s){return Va(r(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],a=yt(i["!ref"]),o,l=Array.isArray(i),f=a.s.r;f<=a.e.r;++f){s.push("\\trowd\\trautofit1");for(var c=a.s.c;c<=a.e.c;++c)s.push("\\cellx"+(c+1));for(s.push("\\pard\\intbl"),c=a.s.c;c<=a.e.c;++c){var h=et({r:f,c});o=l?(i[f]||[])[c]:i[h],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(As(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:t,to_sheet:r,from_sheet:n}}();function MN(r){var e=r.slice(r[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function _c(r){for(var e=0,t=1;e!=3;++e)t=t*256+(r[e]>255?255:r[e]<0?0:r[e]);return t.toString(16).toUpperCase().slice(1)}function IN(r){var e=r[0]/255,t=r[1]/255,n=r[2]/255,i=Math.max(e,t,n),s=Math.min(e,t,n),a=i-s;if(a===0)return[0,0,e];var o=0,l=0,f=i+s;switch(l=a/(f>1?2-f:f),i){case e:o=((t-n)/a+6)%6;break;case t:o=(n-e)/a+2;break;case n:o=(e-t)/a+4;break}return[o/6,l,f/2]}function LN(r){var e=r[0],t=r[1],n=r[2],i=t*2*(n<.5?n:1-n),s=n-i/2,a=[s,s,s],o=6*e,l;if(t!==0)switch(o|0){case 0:case 6:l=i*o,a[0]+=i,a[1]+=l;break;case 1:l=i*(2-o),a[0]+=l,a[1]+=i;break;case 2:l=i*(o-2),a[1]+=i,a[2]+=l;break;case 3:l=i*(4-o),a[1]+=l,a[2]+=i;break;case 4:l=i*(o-4),a[2]+=i,a[0]+=l;break;case 5:l=i*(6-o),a[2]+=l,a[0]+=i;break}for(var f=0;f!=3;++f)a[f]=Math.round(a[f]*255);return a}function vd(r,e){if(e===0)return r;var t=IN(MN(r));return e<0?t[2]=t[2]*(1+e):t[2]=1-(1-t[2])*(1-e),_c(LN(t))}var eT=6,BN=15,ZN=1,yn=eT;function kc(r){return Math.floor((r+Math.round(128/yn)/256)*yn)}function Sc(r){return Math.floor((r-5)/yn*100+.5)/100}function yd(r){return Math.round((r*yn+5)/yn*256)/256}function ap(r){return yd(Sc(kc(r)))}function RO(r){var e=Math.abs(r-ap(r)),t=yn;if(e>.005)for(yn=ZN;yn<BN;++yn)Math.abs(r-ap(r))<=e&&(e=Math.abs(r-ap(r)),t=yn);yn=t}function Qa(r){r.width?(r.wpx=kc(r.width),r.wch=Sc(r.wpx),r.MDW=yn):r.wpx?(r.wch=Sc(r.wpx),r.width=yd(r.wch),r.MDW=yn):typeof r.wch=="number"&&(r.width=yd(r.wch),r.wpx=kc(r.width),r.MDW=yn),r.customWidth&&delete r.customWidth}var WN=96,tT=WN;function Tc(r){return r*96/tT}function Pl(r){return r*tT/96}var UN={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function XN(r,e,t,n){e.Borders=[];var i={},s=!1;(r[0].match(Pn)||[]).forEach(function(a){var o=tt(a);switch(Ds(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},o.diagonalUp&&(i.diagonalUp=sr(o.diagonalUp)),o.diagonalDown&&(i.diagonalDown=sr(o.diagonalDown)),e.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in borders")}})}function VN(r,e,t,n){e.Fills=[];var i={},s=!1;(r[0].match(Pn)||[]).forEach(function(a){var o=tt(a);switch(Ds(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},e.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":o.patternType&&(i.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),o.indexed&&(i.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(i.bgColor.theme=parseInt(o.theme,10)),o.tint&&(i.bgColor.tint=parseFloat(o.tint)),o.rgb&&(i.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),o.theme&&(i.fgColor.theme=parseInt(o.theme,10)),o.tint&&(i.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(i.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fills")}})}function qN(r,e,t,n){e.Fonts=[];var i={},s=!1;(r[0].match(Pn)||[]).forEach(function(a){var o=tt(a);switch(Ds(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(i),i={};break;case"<name":o.val&&(i.name=Zt(o.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=o.val?sr(o.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=o.val?sr(o.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(o.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=o.val?sr(o.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=o.val?sr(o.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=o.val?sr(o.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=o.val?sr(o.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=o.val?sr(o.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":o.val&&(i.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(i.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(i.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(i.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=nO[parseInt(o.val,10)];break;case"<color":if(i.color||(i.color={}),o.auto&&(i.color.auto=sr(o.auto)),o.rgb)i.color.rgb=o.rgb.slice(-6);else if(o.indexed){i.color.index=parseInt(o.indexed,10);var l=go[i.color.index];i.color.index==81&&(l=go[1]),l||(l=go[1]),i.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(i.color.theme=parseInt(o.theme,10),o.tint&&(i.color.tint=parseFloat(o.tint)),o.theme&&t.themeElements&&t.themeElements.clrScheme&&(i.color.rgb=vd(t.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fonts")}})}function jN(r,e,t){e.NumberFmt=[];for(var n=Tr(Ke),i=0;i<n.length;++i)e.NumberFmt[n[i]]=Ke[n[i]];var s=r[0].match(Pn);if(s)for(i=0;i<s.length;++i){var a=tt(s[i]);switch(Ds(a[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=At(Zt(a.formatCode)),l=parseInt(a.numFmtId,10);if(e.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&e.NumberFmt[l]!=null;--l);e.NumberFmt[l]=o}ks(o,l)}}break;case"</numFmt>":break;default:if(t.WTF)throw new Error("unrecognized "+a[0]+" in numFmts")}}}function zN(r){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var n=t[0];n<=t[1];++n)r[n]!=null&&(e[e.length]=$e("numFmt",null,{numFmtId:n,formatCode:Bt(r[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=$e("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var Wh=["numFmtId","fillId","fontId","borderId","xfId"],Uh=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function GN(r,e,t){e.CellXf=[];var n,i=!1;(r[0].match(Pn)||[]).forEach(function(s){var a=tt(s),o=0;switch(Ds(a[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=a,delete n[0],o=0;o<Wh.length;++o)n[Wh[o]]&&(n[Wh[o]]=parseInt(n[Wh[o]],10));for(o=0;o<Uh.length;++o)n[Uh[o]]&&(n[Uh[o]]=sr(n[Uh[o]]));if(e.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[o]){n.numFmtId=o;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};a.vertical&&(l.vertical=a.vertical),a.horizontal&&(l.horizontal=a.horizontal),a.textRotation!=null&&(l.textRotation=a.textRotation),a.indent&&(l.indent=a.indent),a.wrapText&&(l.wrapText=sr(a.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(t&&t.WTF&&!i)throw new Error("unrecognized "+a[0]+" in cellXfs")}})}function HN(r){var e=[];return e[e.length]=$e("cellXfs",null),r.forEach(function(t){e[e.length]=$e("xf",null,t)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=$e("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var YN=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,f){var c={};if(!o)return c;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var h;return(h=o.match(e))&&jN(h,c,f),(h=o.match(i))&&qN(h,c,l,f),(h=o.match(n))&&VN(h,c,l,f),(h=o.match(s))&&XN(h,c,l,f),(h=o.match(t))&&GN(h,c,f),c}}();function rT(r,e){var t=[Fr,$e("styleSheet",null,{xmlns:Lo[0],"xmlns:vt":Ur.vt})],n;return r.SSF&&(n=zN(r.SSF))!=null&&(t[t.length]=n),t[t.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',t[t.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',t[t.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',t[t.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=HN(e.cellXfs))&&(t[t.length]=n),t[t.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',t[t.length]='<dxfs count="0"/>',t[t.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',t.length>2&&(t[t.length]="</styleSheet>",t[1]=t[1].replace("/>",">")),t.join("")}function KN(r,e){var t=r.read_shift(2),n=Tn(r);return[t,n]}function JN(r,e,t){t||(t=me(6+4*e.length)),t.write_shift(2,r),en(e,t);var n=t.length>t.l?t.slice(0,t.l):t;return t.l==null&&(t.l=t.length),n}function e6(r,e,t){var n={};n.sz=r.read_shift(2)/20;var i=DF(r);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=r.read_shift(2);switch(s===700&&(n.bold=1),r.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var a=r.read_shift(1);a!=0&&(n.underline=a);var o=r.read_shift(1);o>0&&(n.family=o);var l=r.read_shift(1);switch(l>0&&(n.charset=l),r.l++,n.color=$F(r),r.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Tn(r),n}function t6(r,e){e||(e=me(25+4*32)),e.write_shift(2,r.sz*20),NF(r,e),e.write_shift(2,r.bold?700:400);var t=0;r.vertAlign=="superscript"?t=1:r.vertAlign=="subscript"&&(t=2),e.write_shift(2,t),e.write_shift(1,r.underline||0),e.write_shift(1,r.family||0),e.write_shift(1,r.charset||0),e.write_shift(1,0),gd(r.color,e);var n=0;return r.scheme=="major"&&(n=1),r.scheme=="minor"&&(n=2),e.write_shift(1,n),en(r.name,e),e.length>e.l?e.slice(0,e.l):e}var r6=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],op,n6=Cn;function Cy(r,e){e||(e=me(4*3+8*7+16*1)),op||(op=m0(r6));var t=op[r.patternType];t==null&&(t=40),e.write_shift(4,t);var n=0;if(t!=40)for(gd({auto:1},e),gd({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function i6(r,e){var t=r.l+e,n=r.read_shift(2),i=r.read_shift(2);return r.l=t,{ixfe:n,numFmtId:i}}function nT(r,e,t){t||(t=me(16)),t.write_shift(2,e||0),t.write_shift(2,r.numFmtId||0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);var n=0;return t.write_shift(1,n),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t}function pf(r,e){return e||(e=me(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var s6=Cn;function a6(r,e){return e||(e=me(51)),e.write_shift(1,0),pf(null,e),pf(null,e),pf(null,e),pf(null,e),pf(null,e),e.length>e.l?e.slice(0,e.l):e}function o6(r,e){return e||(e=me(12+4*10)),e.write_shift(4,r.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),md(r.name||"",e),e.length>e.l?e.slice(0,e.l):e}function l6(r,e,t){var n=me(2052);return n.write_shift(4,r),md(e,n),md(t,n),n.length>n.l?n.slice(0,n.l):n}function f6(r,e,t){var n={};n.NumberFmt=[];for(var i in Ke)n.NumberFmt[i]=Ke[i];n.CellXf=[],n.Fonts=[];var s=[],a=!1;return ia(r,function(l,f,c){switch(c){case 44:n.NumberFmt[l[0]]=l[1],ks(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(l.color.rgb=vd(e.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:s.push(c),a=!0;break;case 38:s.pop(),a=!1;break;default:if(f.T>0)s.push(c);else if(f.T<0)s.pop();else if(!a||t.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+c.toString(16))}}),n}function c6(r,e){if(e){var t=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&++t}),t!=0&&(_e(r,615,Ki(t)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&_e(r,44,JN(i,e[i]))}),_e(r,616))}}function h6(r){var e=1;_e(r,611,Ki(e)),_e(r,43,t6({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),_e(r,612)}function u6(r){var e=2;_e(r,603,Ki(e)),_e(r,45,Cy({patternType:"none"})),_e(r,45,Cy({patternType:"gray125"})),_e(r,604)}function d6(r){var e=1;_e(r,613,Ki(e)),_e(r,46,a6()),_e(r,614)}function p6(r){var e=1;_e(r,626,Ki(e)),_e(r,47,nT({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),_e(r,627)}function m6(r,e){_e(r,617,Ki(e.length)),e.forEach(function(t){_e(r,47,nT(t,0))}),_e(r,618)}function g6(r){var e=1;_e(r,619,Ki(e)),_e(r,48,o6({xfId:0,builtinId:0,name:"Normal"})),_e(r,620)}function O6(r){var e=0;_e(r,505,Ki(e)),_e(r,506)}function x6(r){var e=0;_e(r,508,l6(e,"TableStyleMedium9","PivotStyleMedium4")),_e(r,509)}function v6(r,e){var t=Kn();return _e(t,278),c6(t,r.SSF),h6(t),u6(t),d6(t),p6(t),m6(t,e.cellXfs),g6(t),O6(t),x6(t),_e(t,279),t.end()}var y6=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function w6(r,e,t){e.themeElements.clrScheme=[];var n={};(r[0].match(Pn)||[]).forEach(function(i){var s=tt(i);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(e.themeElements.clrScheme[y6.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(t&&t.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function b6(){}function _6(){}var k6=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,S6=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,T6=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function C6(r,e,t){e.themeElements={};var n;[["clrScheme",k6,w6],["fontScheme",S6,b6],["fmtScheme",T6,_6]].forEach(function(i){if(!(n=r.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,e,t)})}var A6=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function iT(r,e){(!r||r.length===0)&&(r=QO());var t,n={};if(!(t=r.match(A6)))throw new Error("themeElements not found in theme");return C6(t[0],n,e),n.raw=r,n}function QO(r,e){if(e&&e.themeXLSX)return e.themeXLSX;if(r&&typeof r.raw=="string")return r.raw;var t=[Fr];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function E6(r,e,t){var n=r.l+e,i=r.read_shift(4);if(i!==124226){if(!t.cellStyles){r.l=n;return}var s=r.slice(r.l);r.l=n;var a;try{a=eS(s,{type:"array"})}catch{return}var o=li(a,"theme/theme/theme1.xml",!0);if(o)return iT(o,t)}}function P6(r){return r.read_shift(4)}function R6(r){var e={};switch(e.xclrType=r.read_shift(2),e.nTintShade=r.read_shift(2),e.xclrType){case 0:r.l+=4;break;case 1:e.xclrValue=Q6(r,4);break;case 2:e.xclrValue=MS(r);break;case 3:e.xclrValue=P6(r);break;case 4:r.l+=4;break}return r.l+=8,e}function Q6(r,e){return Cn(r,e)}function F6(r,e){return Cn(r,e)}function $6(r){var e=r.read_shift(2),t=r.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=R6(r);break;case 6:n[1]=F6(r,t);break;case 14:case 15:n[1]=r.read_shift(t===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+t)}return n}function D6(r,e){var t=r.l+e;r.l+=2;var n=r.read_shift(2);r.l+=2;for(var i=r.read_shift(2),s=[];i-- >0;)s.push($6(r,t-r.l));return{ixfe:n,ext:s}}function N6(r,e){e.forEach(function(t){switch(t[0]){}})}function M6(r,e){return{flags:r.read_shift(4),version:r.read_shift(4),name:Tn(r)}}function I6(r){var e=me(12+2*r.name.length);return e.write_shift(4,r.flags),e.write_shift(4,r.version),en(r.name,e),e.slice(0,e.l)}function L6(r){for(var e=[],t=r.read_shift(4);t-- >0;)e.push([r.read_shift(4),r.read_shift(4)]);return e}function B6(r){var e=me(4+8*r.length);e.write_shift(4,r.length);for(var t=0;t<r.length;++t)e.write_shift(4,r[t][0]),e.write_shift(4,r[t][1]);return e}function Z6(r,e){var t=me(8+2*e.length);return t.write_shift(4,r),en(e,t),t.slice(0,t.l)}function W6(r){return r.l+=4,r.read_shift(4)!=0}function U6(r,e){var t=me(8);return t.write_shift(4,r),t.write_shift(4,1),t}function X6(r,e,t){var n={Types:[],Cell:[],Value:[]},i=t||{},s=[],a=!1,o=2;return ia(r,function(l,f,c){switch(c){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(h){o==1?n.Cell.push({type:n.Types[h[0]-1].name,index:h[1]}):o==0&&n.Value.push({type:n.Types[h[0]-1].name,index:h[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:s.push(c),a=!0;break;case 36:s.pop(),a=!1;break;default:if(!f.T){if(!a||i.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+c.toString(16))}}}),n}function V6(){var r=Kn();return _e(r,332),_e(r,334,Ki(1)),_e(r,335,I6({name:"XLDAPR",version:12e4,flags:3496657072})),_e(r,336),_e(r,339,Z6(1,"XLDAPR")),_e(r,52),_e(r,35,Ki(514)),_e(r,4096,Ki(0)),_e(r,4097,Si(1)),_e(r,36),_e(r,53),_e(r,340),_e(r,337,U6(1)),_e(r,51,B6([[1,0]])),_e(r,338),_e(r,333),r.end()}function q6(r,e,t){var n={Types:[],Cell:[],Value:[]};if(!r)return n;var i=!1,s=2,a;return r.replace(Pn,function(o){var l=tt(o);switch(Ds(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var f=0;f<n.Types.length;++f)n.Types[f].name==l.name&&(a=n.Types[f]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):s==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!a)break;a.offsets||(a.offsets=[]),a.offsets.push(+l.i);break;default:if(!i&&t.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function sT(){var r=[Fr];return r.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),r.join("")}function j6(r){var e=[];if(!r)return e;var t=1;return(r.match(Pn)||[]).forEach(function(n){var i=tt(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?t=i.i:i.i=t,e.push(i);break}}),e}function z6(r){var e={};e.i=r.read_shift(4);var t={};t.r=r.read_shift(4),t.c=r.read_shift(4),e.r=et(t);var n=r.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function G6(r,e,t){var n=[];return ia(r,function(s,a,o){switch(o){case 63:n.push(s);break;default:if(!a.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function H6(r,e,t,n){if(!r)return r;var i=n||{},s=!1;ia(r,function(o,l,f){switch(f){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!l.T){if(!s||i.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}},i)}function Y6(r,e){if(!r)return"??";var t=(r.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][t].Target}var il=1024;function aT(r,e){for(var t=[21600,21600],n=["m0,0l0",t[1],t[0],t[1],t[0],"0xe"].join(","),i=[$e("xml",null,{"xmlns:v":ai.v,"xmlns:o":ai.o,"xmlns:x":ai.x,"xmlns:mv":ai.mv}).replace(/\/>/,">"),$e("o:shapelayout",$e("o:idmap",null,{"v:ext":"edit",data:r}),{"v:ext":"edit"}),$e("v:shapetype",[$e("v:stroke",null,{joinstyle:"miter"}),$e("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:t.join(","),path:n})];il<r*1e3;)il+=1e3;return e.forEach(function(s){var a=xr(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?$e("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,f=$e("v:fill",l,o),c={on:"t",obscured:"t"};++il,i=i.concat(["<v:shape"+yc({id:"_x0000_s"+il,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",f,$e("v:shadow",null,c),$e("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",un("x:Anchor",[a.c+1,0,a.r+1,0,a.c+3,20,a.r+5,20].join(",")),un("x:AutoFill","False"),un("x:Row",String(a.r)),un("x:Column",String(a.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function Ay(r,e,t,n){var i=Array.isArray(r),s;e.forEach(function(a){var o=xr(a.ref);if(i?(r[o.r]||(r[o.r]=[]),s=r[o.r][o.c]):s=r[a.ref],!s){s={t:"z"},i?r[o.r][o.c]=s:r[a.ref]=s;var l=yt(r["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var f=lt(l);f!==r["!ref"]&&(r["!ref"]=f)}s.c||(s.c=[]);var c={a:a.author,t:a.t,r:a.r,T:t};a.h&&(c.h=a.h);for(var h=s.c.length-1;h>=0;--h){if(!t&&s.c[h].T)return;t&&!s.c[h].T&&s.c.splice(h,1)}if(t&&n){for(h=0;h<n.length;++h)if(c.a==n[h].id){c.a=n[h].name||c.a;break}}s.c.push(c)})}function K6(r,e){if(r.match(/<(?:\w+:)?comments *\/>/))return[];var t=[],n=[],i=r.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&t.push(o[1])}});var s=r.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=tt(o[0]),f={author:l.authorId&&t[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},c=xr(l.ref);if(!(e.sheetRows&&e.sheetRows<=c.r)){var h=a.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),u=!!h&&!!h[1]&&EO(h[1])||{r:"",t:"",h:""};f.r=u.r,u.r=="<t></t>"&&(u.t=u.h=""),f.t=(u.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(f.h=u.h),n.push(f)}}}}),n}function oT(r){var e=[Fr,$e("comments",null,{xmlns:Lo[0]})],t=[];return e.push("<authors>"),r.forEach(function(n){n[1].forEach(function(i){var s=Bt(i.a);t.indexOf(s)==-1&&(t.push(s),e.push("<author>"+s+"</author>")),i.T&&i.ID&&t.indexOf("tc="+i.ID)==-1&&(t.push("tc="+i.ID),e.push("<author>tc="+i.ID+"</author>"))})}),t.length==0&&(t.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),r.forEach(function(n){var i=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=t.indexOf("tc="+n[1][0].ID):n[1].forEach(function(l){l.a&&(i=t.indexOf(Bt(l.a))),s.push(l.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),s.length<=1)e.push(un("t",Bt(s[0]||"")));else{for(var a=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)a+=`Reply:
    `+s[o]+`
`;e.push(un("t",Bt(a)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function J6(r,e){var t=[],n=!1,i={},s=0;return r.replace(Pn,function(o,l){var f=tt(o);switch(Ds(f[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:f.personId,guid:f.id,ref:f.ref,T:1};break;case"</threadedComment>":i.t!=null&&t.push(i);break;case"<text>":case"<text":s=l+o.length;break;case"</text>":i.t=r.slice(s,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+f[0]+" in threaded comments")}return o}),t}function e8(r,e,t){var n=[Fr,$e("ThreadedComments",null,{xmlns:Ur.TCMNT}).replace(/[\/]>/,">")];return r.forEach(function(i){var s="";(i[1]||[]).forEach(function(a,o){if(!a.T){delete a.ID;return}a.a&&e.indexOf(a.a)==-1&&e.push(a.a);var l={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+t.tcid++).slice(-12)+"}"};o==0?s=l.id:l.parentId=s,a.ID=l.id,a.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(a.a)).slice(-12)+"}"),n.push($e("threadedComment",un("text",a.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function t8(r,e){var t=[],n=!1;return r.replace(Pn,function(s){var a=tt(s);switch(Ds(a[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":t.push({name:a.displayname,id:a.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+a[0]+" in threaded comments")}return s}),t}function r8(r){var e=[Fr,$e("personList",null,{xmlns:Ur.TCMNT,"xmlns:x":Lo[0]}).replace(/[\/]>/,">")];return r.forEach(function(t,n){e.push($e("person",null,{displayName:t,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:t,providerId:"None"}))}),e.push("</personList>"),e.join("")}function n8(r){var e={};e.iauthor=r.read_shift(4);var t=Uo(r);return e.rfx=t.s,e.ref=et(t.s),r.l+=16,e}function i8(r,e){return e==null&&(e=me(36)),e.write_shift(4,r[1].iauthor),nf(r[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var s8=Tn;function a8(r){return en(r.slice(0,54))}function o8(r,e){var t=[],n=[],i={},s=!1;return ia(r,function(o,l,f){switch(f){case 632:n.push(o);break;case 635:i=o;break;case 637:i.t=o.t,i.h=o.h,i.r=o.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,e.sheetRows&&i.rfx&&e.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,t.push(i);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!s||e.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}),t}function l8(r){var e=Kn(),t=[];return _e(e,628),_e(e,630),r.forEach(function(n){n[1].forEach(function(i){t.indexOf(i.a)>-1||(t.push(i.a.slice(0,54)),_e(e,632,a8(i.a)))})}),_e(e,631),_e(e,633),r.forEach(function(n){n[1].forEach(function(i){i.iauthor=t.indexOf(i.a);var s={s:xr(n[0]),e:xr(n[0])};_e(e,635,i8([s,i])),i.t&&i.t.length>0&&_e(e,637,PF(i)),_e(e,636),delete i.iauthor})}),_e(e,634),_e(e,629),e.end()}var f8="application/vnd.ms-office.vbaProject";function c8(r){var e=Ye.utils.cfb_new({root:"R"});return r.FullPaths.forEach(function(t,n){if(!(t.slice(-1)==="/"||!t.match(/_VBA_PROJECT_CUR/))){var i=t.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Ye.utils.cfb_add(e,i,r.FileIndex[n].content)}}),Ye.write(e)}function h8(r,e){e.FullPaths.forEach(function(t,n){if(n!=0){var i=t.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&Ye.utils.cfb_add(r,i,e.FileIndex[n].content)}})}var lT=["xlsb","xlsm","xlam","biff8","xla"];function u8(){return{"!type":"dialog"}}function d8(){return{"!type":"dialog"}}function p8(){return{"!type":"macro"}}function m8(){return{"!type":"macro"}}var ml=function(){var r=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function t(n,i,s,a){var o=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var f=s.length>0?parseInt(s,10)|0:0,c=a.length>0?parseInt(a,10)|0:0;return o?c+=e.c:--c,l?f+=e.r:--f,i+(o?"":"$")+ar(c)+(l?"":"$")+kr(f)}return function(i,s){return e=s,i.replace(r,t)}}(),FO=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,$O=function(){return function(e,t){return e.replace(FO,function(n,i,s,a,o,l){var f=yO(a)-(s?0:t.c),c=vO(l)-(o?0:t.r),h=c==0?"":o?c+1:"["+c+"]",u=f==0?"":s?f+1:"["+f+"]";return i+"R"+h+"C"+u})}}();function fT(r,e){return r.replace(FO,function(t,n,i,s,a,o){return n+(i=="$"?i+s:ar(yO(s)+e.c))+(a=="$"?a+o:kr(vO(o)+e.r))})}function g8(r,e,t){var n=Ln(e),i=n.s,s=xr(t),a={r:s.r-i.r,c:s.c-i.c};return fT(r,a)}function O8(r){return r.length!=1}function Ey(r){return r.replace(/_xlfn\./g,"")}function Dr(r){r.l+=1}function Fa(r,e){var t=r.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function cT(r,e,t){var n=2;if(t){if(t.biff>=2&&t.biff<=5)return hT(r);t.biff==12&&(n=4)}var i=r.read_shift(n),s=r.read_shift(n),a=Fa(r),o=Fa(r);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function hT(r){var e=Fa(r),t=Fa(r),n=r.read_shift(1),i=r.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:t[0],c:i,cRel:t[1],rRel:t[2]}}}function x8(r,e,t){if(t.biff<8)return hT(r);var n=r.read_shift(t.biff==12?4:2),i=r.read_shift(t.biff==12?4:2),s=Fa(r),a=Fa(r);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:a[0],cRel:a[1],rRel:a[2]}}}function uT(r,e,t){if(t&&t.biff>=2&&t.biff<=5)return v8(r);var n=r.read_shift(t&&t.biff==12?4:2),i=Fa(r);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function v8(r){var e=Fa(r),t=r.read_shift(1);return{r:e[0],c:t,cRel:e[1],rRel:e[2]}}function y8(r){var e=r.read_shift(2),t=r.read_shift(2);return{r:e,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function w8(r,e,t){var n=t&&t.biff?t.biff:8;if(n>=2&&n<=5)return b8(r);var i=r.read_shift(n>=12?4:2),s=r.read_shift(2),a=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;i>524287;)i-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:a,rRel:o}}function b8(r){var e=r.read_shift(2),t=r.read_shift(1),n=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),i==1&&t>=128&&(t=t-256),{r:e,c:t,cRel:i,rRel:n}}function _8(r,e,t){var n=(r[r.l++]&96)>>5,i=cT(r,t.biff>=2&&t.biff<=5?6:8,t);return[n,i]}function k8(r,e,t){var n=(r[r.l++]&96)>>5,i=r.read_shift(2,"i"),s=8;if(t)switch(t.biff){case 5:r.l+=12,s=6;break;case 12:s=12;break}var a=cT(r,s,t);return[n,i,a]}function S8(r,e,t){var n=(r[r.l++]&96)>>5;return r.l+=t&&t.biff>8?12:t.biff<8?6:8,[n]}function T8(r,e,t){var n=(r[r.l++]&96)>>5,i=r.read_shift(2),s=8;if(t)switch(t.biff){case 5:r.l+=12,s=6;break;case 12:s=12;break}return r.l+=s,[n,i]}function C8(r,e,t){var n=(r[r.l++]&96)>>5,i=x8(r,e-1,t);return[n,i]}function A8(r,e,t){var n=(r[r.l++]&96)>>5;return r.l+=t.biff==2?6:t.biff==12?14:7,[n]}function Py(r){var e=r[r.l+1]&1,t=1;return r.l+=4,[e,t]}function E8(r,e,t){r.l+=2;for(var n=r.read_shift(t&&t.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(r.read_shift(t&&t.biff==2?1:2));return i}function P8(r,e,t){var n=r[r.l+1]&255?1:0;return r.l+=2,[n,r.read_shift(t&&t.biff==2?1:2)]}function R8(r,e,t){var n=r[r.l+1]&255?1:0;return r.l+=2,[n,r.read_shift(t&&t.biff==2?1:2)]}function Q8(r){var e=r[r.l+1]&255?1:0;return r.l+=2,[e,r.read_shift(2)]}function F8(r,e,t){var n=r[r.l+1]&255?1:0;return r.l+=t&&t.biff==2?3:4,[n]}function dT(r){var e=r.read_shift(1),t=r.read_shift(1);return[e,t]}function $8(r){return r.read_shift(2),dT(r)}function D8(r){return r.read_shift(2),dT(r)}function N8(r,e,t){var n=(r[r.l]&96)>>5;r.l+=1;var i=uT(r,0,t);return[n,i]}function M8(r,e,t){var n=(r[r.l]&96)>>5;r.l+=1;var i=w8(r,0,t);return[n,i]}function I8(r,e,t){var n=(r[r.l]&96)>>5;r.l+=1;var i=r.read_shift(2);t&&t.biff==5&&(r.l+=12);var s=uT(r,0,t);return[n,i,s]}function L8(r,e,t){var n=(r[r.l]&96)>>5;r.l+=1;var i=r.read_shift(t&&t.biff<=3?1:2);return[WM[i],gT[i],n]}function B8(r,e,t){var n=r[r.l++],i=r.read_shift(1),s=t&&t.biff<=3?[n==88?-1:0,r.read_shift(1)]:Z8(r);return[i,(s[0]===0?gT:ZM)[s[1]]]}function Z8(r){return[r[r.l+1]>>7,r.read_shift(2)&32767]}function W8(r,e,t){r.l+=t&&t.biff==2?3:4}function U8(r,e,t){if(r.l++,t&&t.biff==12)return[r.read_shift(4,"i"),0];var n=r.read_shift(2),i=r.read_shift(t&&t.biff==2?1:2);return[n,i]}function X8(r){return r.l++,sa[r.read_shift(1)]}function V8(r){return r.l++,r.read_shift(2)}function q8(r){return r.l++,r.read_shift(1)!==0}function j8(r){return r.l++,bn(r)}function z8(r,e,t){return r.l++,dh(r,e-1,t)}function G8(r,e){var t=[r.read_shift(1)];if(e==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=Pr(r,1)?"TRUE":"FALSE",e!=12&&(r.l+=7);break;case 37:case 16:t[1]=sa[r[r.l]],r.l+=e==12?4:8;break;case 0:r.l+=8;break;case 1:t[1]=bn(r);break;case 2:t[1]=Xo(r,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function H8(r,e,t){for(var n=r.read_shift(t.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((t.biff==12?Uo:v0)(r));return i}function Y8(r,e,t){var n=0,i=0;t.biff==12?(n=r.read_shift(4),i=r.read_shift(4)):(i=1+r.read_shift(1),n=1+r.read_shift(2)),t.biff>=2&&t.biff<8&&(--n,--i==0&&(i=256));for(var s=0,a=[];s!=n&&(a[s]=[]);++s)for(var o=0;o!=i;++o)a[s][o]=G8(r,t.biff);return a}function K8(r,e,t){var n=r.read_shift(1)>>>5&3,i=!t||t.biff>=8?4:2,s=r.read_shift(i);switch(t.biff){case 2:r.l+=5;break;case 3:case 4:r.l+=8;break;case 5:r.l+=12;break}return[n,0,s]}function J8(r,e,t){if(t.biff==5)return eM(r);var n=r.read_shift(1)>>>5&3,i=r.read_shift(2),s=r.read_shift(4);return[n,i,s]}function eM(r){var e=r.read_shift(1)>>>5&3,t=r.read_shift(2,"i");r.l+=8;var n=r.read_shift(2);return r.l+=12,[e,t,n]}function tM(r,e,t){var n=r.read_shift(1)>>>5&3;r.l+=t&&t.biff==2?3:4;var i=r.read_shift(t&&t.biff==2?1:2);return[n,i]}function rM(r,e,t){var n=r.read_shift(1)>>>5&3,i=r.read_shift(t&&t.biff==2?1:2);return[n,i]}function nM(r,e,t){var n=r.read_shift(1)>>>5&3;return r.l+=4,t.biff<8&&r.l--,t.biff==12&&(r.l+=2),[n]}function iM(r,e,t){var n=(r[r.l++]&96)>>5,i=r.read_shift(2),s=4;if(t)switch(t.biff){case 5:s=15;break;case 12:s=6;break}return r.l+=s,[n,i]}var sM=Cn,aM=Cn,oM=Cn;function mh(r,e,t){return r.l+=2,[y8(r)]}function DO(r){return r.l+=6,[]}var lM=mh,fM=DO,cM=DO,hM=mh;function pT(r){return r.l+=2,[Mr(r),r.read_shift(2)&1]}var uM=mh,dM=pT,pM=DO,mM=mh,gM=mh,OM=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function xM(r){r.l+=2;var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(4),i=r.read_shift(2),s=r.read_shift(2),a=OM[t>>2&31];return{ixti:e,coltype:t&3,rt:a,idx:n,c:i,C:s}}function vM(r){return r.l+=2,[r.read_shift(4)]}function yM(r,e,t){return r.l+=5,r.l+=2,r.l+=t.biff==2?1:4,["PTGSHEET"]}function wM(r,e,t){return r.l+=t.biff==2?4:5,["PTGENDSHEET"]}function bM(r){var e=r.read_shift(1)>>>5&3,t=r.read_shift(2);return[e,t]}function _M(r){var e=r.read_shift(1)>>>5&3,t=r.read_shift(2);return[e,t]}function kM(r){return r.l+=4,[0,0]}var Ry={1:{n:"PtgExp",f:U8},2:{n:"PtgTbl",f:oM},3:{n:"PtgAdd",f:Dr},4:{n:"PtgSub",f:Dr},5:{n:"PtgMul",f:Dr},6:{n:"PtgDiv",f:Dr},7:{n:"PtgPower",f:Dr},8:{n:"PtgConcat",f:Dr},9:{n:"PtgLt",f:Dr},10:{n:"PtgLe",f:Dr},11:{n:"PtgEq",f:Dr},12:{n:"PtgGe",f:Dr},13:{n:"PtgGt",f:Dr},14:{n:"PtgNe",f:Dr},15:{n:"PtgIsect",f:Dr},16:{n:"PtgUnion",f:Dr},17:{n:"PtgRange",f:Dr},18:{n:"PtgUplus",f:Dr},19:{n:"PtgUminus",f:Dr},20:{n:"PtgPercent",f:Dr},21:{n:"PtgParen",f:Dr},22:{n:"PtgMissArg",f:Dr},23:{n:"PtgStr",f:z8},26:{n:"PtgSheet",f:yM},27:{n:"PtgEndSheet",f:wM},28:{n:"PtgErr",f:X8},29:{n:"PtgBool",f:q8},30:{n:"PtgInt",f:V8},31:{n:"PtgNum",f:j8},32:{n:"PtgArray",f:A8},33:{n:"PtgFunc",f:L8},34:{n:"PtgFuncVar",f:B8},35:{n:"PtgName",f:K8},36:{n:"PtgRef",f:N8},37:{n:"PtgArea",f:_8},38:{n:"PtgMemArea",f:tM},39:{n:"PtgMemErr",f:sM},40:{n:"PtgMemNoMem",f:aM},41:{n:"PtgMemFunc",f:rM},42:{n:"PtgRefErr",f:nM},43:{n:"PtgAreaErr",f:S8},44:{n:"PtgRefN",f:M8},45:{n:"PtgAreaN",f:C8},46:{n:"PtgMemAreaN",f:bM},47:{n:"PtgMemNoMemN",f:_M},57:{n:"PtgNameX",f:J8},58:{n:"PtgRef3d",f:I8},59:{n:"PtgArea3d",f:k8},60:{n:"PtgRefErr3d",f:iM},61:{n:"PtgAreaErr3d",f:T8},255:{}},SM={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},TM={1:{n:"PtgElfLel",f:pT},2:{n:"PtgElfRw",f:mM},3:{n:"PtgElfCol",f:lM},6:{n:"PtgElfRwV",f:gM},7:{n:"PtgElfColV",f:hM},10:{n:"PtgElfRadical",f:uM},11:{n:"PtgElfRadicalS",f:pM},13:{n:"PtgElfColS",f:fM},15:{n:"PtgElfColSV",f:cM},16:{n:"PtgElfRadicalLel",f:dM},25:{n:"PtgList",f:xM},29:{n:"PtgSxName",f:vM},255:{}},CM={0:{n:"PtgAttrNoop",f:kM},1:{n:"PtgAttrSemi",f:F8},2:{n:"PtgAttrIf",f:R8},4:{n:"PtgAttrChoose",f:E8},8:{n:"PtgAttrGoto",f:P8},16:{n:"PtgAttrSum",f:W8},32:{n:"PtgAttrBaxcel",f:Py},33:{n:"PtgAttrBaxcel",f:Py},64:{n:"PtgAttrSpace",f:$8},65:{n:"PtgAttrSpaceSemi",f:D8},128:{n:"PtgAttrIfError",f:Q8},255:{}};function gh(r,e,t,n){if(n.biff<8)return Cn(r,e);for(var i=r.l+e,s=[],a=0;a!==t.length;++a)switch(t[a][0]){case"PtgArray":t[a][1]=Y8(r,0,n),s.push(t[a][1]);break;case"PtgMemArea":t[a][2]=H8(r,t[a][1],n),s.push(t[a][2]);break;case"PtgExp":n&&n.biff==12&&(t[a][1][1]=r.read_shift(4),s.push(t[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[a][0]}return e=i-r.l,e!==0&&s.push(Cn(r,e)),s}function Oh(r,e,t){for(var n=r.l+e,i,s,a=[];n!=r.l;)e=n-r.l,s=r[r.l],i=Ry[s]||Ry[SM[s]],(s===24||s===25)&&(i=(s===24?TM:CM)[r[r.l+1]]),!i||!i.f?Cn(r,e):a.push([i.n,i.f(r,e,t)]);return a}function AM(r){for(var e=[],t=0;t<r.length;++t){for(var n=r[t],i=[],s=0;s<n.length;++s){var a=n[s];if(a)switch(a[0]){case 2:i.push('"'+a[1].replace(/"/g,'""')+'"');break;default:i.push(a[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var EM={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function PM(r,e){if(!r&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(r)?"'"+r+"'":r}function mT(r,e,t){if(!r)return"SH33TJSERR0";if(t.biff>8&&(!r.XTI||!r.XTI[e]))return r.SheetNames[e];if(!r.XTI)return"SH33TJSERR6";var n=r.XTI[e];if(t.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":r.XTI[e-1];if(!n)return"SH33TJSERR1";var i="";if(t.biff>8)switch(r[n[0]][0]){case 357:return i=n[1]==-1?"#REF":r.SheetNames[n[1]],n[1]==n[2]?i:i+":"+r.SheetNames[n[2]];case 358:return t.SID!=null?r.SheetNames[t.SID]:"SH33TJSSAME"+r[n[0]][0];case 355:default:return"SH33TJSSRC"+r[n[0]][0]}switch(r[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":r.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+r.SheetNames[n[2]];case 14849:return r[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return r[n[0]][0][3]?(i=n[1]==-1?"#REF":r[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+r[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Qy(r,e,t){var n=mT(r,e,t);return n=="#REF"?n:PM(n,t)}function xn(r,e,t,n,i){var s=i&&i.biff||8,a={s:{c:0,r:0},e:{c:0,r:0}},o=[],l,f,c,h=0,u=0,d,p="";if(!r[0]||!r[0][0])return"";for(var m=-1,g="",O=0,w=r[0].length;O<w;++O){var v=r[0][O];switch(v[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),f=o.pop(),m>=0){switch(r[0][m][1][0]){case 0:g=br(" ",r[0][m][1][1]);break;case 1:g=br("\r",r[0][m][1][1]);break;default:if(g="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+r[0][m][1][0])}f=f+g,m=-1}o.push(f+EM[v[0]]+l);break;case"PtgIsect":l=o.pop(),f=o.pop(),o.push(f+" "+l);break;case"PtgUnion":l=o.pop(),f=o.pop(),o.push(f+","+l);break;case"PtgRange":l=o.pop(),f=o.pop(),o.push(f+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":c=tc(v[1][1],a,i),o.push(rc(c,s));break;case"PtgRefN":c=t?tc(v[1][1],t,i):v[1][1],o.push(rc(c,s));break;case"PtgRef3d":h=v[1][1],c=tc(v[1][2],a,i),p=Qy(n,h,i),o.push(p+"!"+rc(c,s));break;case"PtgFunc":case"PtgFuncVar":var S=v[1][0],y=v[1][1];S||(S=0),S&=127;var b=S==0?[]:o.slice(-S);o.length-=S,y==="User"&&(y=b.shift()),o.push(y+"("+b.join(",")+")");break;case"PtgBool":o.push(v[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(v[1]);break;case"PtgNum":o.push(String(v[1]));break;case"PtgStr":o.push('"'+v[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(v[1]);break;case"PtgAreaN":d=oy(v[1][1],t?{s:t}:a,i),o.push(np(d,i));break;case"PtgArea":d=oy(v[1][1],a,i),o.push(np(d,i));break;case"PtgArea3d":h=v[1][1],d=v[1][2],p=Qy(n,h,i),o.push(p+"!"+np(d,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":u=v[1][2];var x=(n.names||[])[u-1]||(n[0]||[])[u],A=x?x.Name:"SH33TJSNAME"+String(u);A&&A.slice(0,6)=="_xlfn."&&!i.xlfn&&(A=A.slice(6)),o.push(A);break;case"PtgNameX":var k=v[1][1];u=v[1][2];var E;if(i.biff<=5)k<0&&(k=-k),n[k]&&(E=n[k][u]);else{var T="";if(((n[k]||[])[0]||[])[0]==14849||(((n[k]||[])[0]||[])[0]==1025?n[k][u]&&n[k][u].itab>0&&(T=n.SheetNames[n[k][u].itab-1]+"!"):T=n.SheetNames[u-1]+"!"),n[k]&&n[k][u])T+=n[k][u].Name;else if(n[0]&&n[0][u])T+=n[0][u].Name;else{var _=(mT(n,k,i)||"").split(";;");_[u-1]?T=_[u-1]:T+="SH33TJSERRX"}o.push(T);break}E||(E={Name:"SH33TJSERRY"}),o.push(E.Name);break;case"PtgParen":var N="(",Z=")";if(m>=0){switch(g="",r[0][m][1][0]){case 2:N=br(" ",r[0][m][1][1])+N;break;case 3:N=br("\r",r[0][m][1][1])+N;break;case 4:Z=br(" ",r[0][m][1][1])+Z;break;case 5:Z=br("\r",r[0][m][1][1])+Z;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+r[0][m][1][0])}m=-1}o.push(N+o.pop()+Z);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":c={c:v[1][1],r:v[1][0]};var z={c:t.c,r:t.r};if(n.sharedf[et(c)]){var ee=n.sharedf[et(c)];o.push(xn(ee,a,z,n,i))}else{var ae=!1;for(l=0;l!=n.arrayf.length;++l)if(f=n.arrayf[l],!(c.c<f[0].s.c||c.c>f[0].e.c)&&!(c.r<f[0].s.r||c.r>f[0].e.r)){o.push(xn(f[1],a,z,n,i)),ae=!0;break}ae||o.push(v[1])}break;case"PtgArray":o.push("{"+AM(v[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=O;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+v[1].idx+"[#"+v[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(v));default:throw new Error("Unrecognized Formula Token: "+String(v))}var xe=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&m>=0&&xe.indexOf(r[0][O][0])==-1){v=r[0][m];var V=!0;switch(v[1][0]){case 4:V=!1;case 0:g=br(" ",v[1][1]);break;case 5:V=!1;case 1:g=br("\r",v[1][1]);break;default:if(g="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+v[1][0])}o.push((V?g:"")+o.pop()+(V?"":g)),m=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function RM(r,e,t){var n=r.l+e,i=t.biff==2?1:2,s,a=r.read_shift(i);if(a==65535)return[[],Cn(r,e-2)];var o=Oh(r,a,t);return e!==a+i&&(s=gh(r,e-a-i,o,t)),r.l=n,[o,s]}function QM(r,e,t){var n=r.l+e,i=t.biff==2?1:2,s,a=r.read_shift(i);if(a==65535)return[[],Cn(r,e-2)];var o=Oh(r,a,t);return e!==a+i&&(s=gh(r,e-a-i,o,t)),r.l=n,[o,s]}function FM(r,e,t,n){var i=r.l+e,s=Oh(r,n,t),a;return i!==r.l&&(a=gh(r,i-r.l,s,t)),[s,a]}function $M(r,e,t){var n=r.l+e,i,s=r.read_shift(2),a=Oh(r,s,t);return s==65535?[[],Cn(r,e-2)]:(e!==s+2&&(i=gh(r,n-s-2,a,t)),[a,i])}function DM(r){var e;if(qs(r,r.l+6)!==65535)return[bn(r),"n"];switch(r[r.l]){case 0:return r.l+=8,["String","s"];case 1:return e=r[r.l+2]===1,r.l+=8,[e,"b"];case 2:return e=r[r.l+2],r.l+=8,[e,"e"];case 3:return r.l+=8,["","s"]}return[]}function NM(r){if(r==null){var e=me(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof r=="number")return Co(r);return Co(0)}function lp(r,e,t){var n=r.l+e,i=Ns(r);t.biff==2&&++r.l;var s=DM(r),a=r.read_shift(1);t.biff!=2&&(r.read_shift(1),t.biff>=5&&r.read_shift(4));var o=QM(r,n-r.l,t);return{cell:i,val:s[0],formula:o,shared:a>>3&1,tt:s[1]}}function MM(r,e,t,n,i){var s=Eo(e,t,i),a=NM(r.v),o=me(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var f=me(r.bf.length),c=0;c<r.bf.length;++c)f[c]=r.bf[c];var h=Kr([s,a,o,f]);return h}function y0(r,e,t){var n=r.read_shift(4),i=Oh(r,n,t),s=r.read_shift(4),a=s>0?gh(r,s,i,t):null;return[i,a]}var IM=y0,w0=y0,LM=y0,BM=y0,ZM={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},gT={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},WM={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Fy(r){return r.slice(0,3)=="of:"&&(r=r.slice(3)),r.charCodeAt(0)==61&&(r=r.slice(1),r.charCodeAt(0)==61&&(r=r.slice(1))),r=r.replace(/COM\.MICROSOFT\./g,""),r=r.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,t){return t.replace(/\./g,"")}),r=r.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),r.replace(/[;~]/g,",").replace(/\|/g,";")}function UM(r){var e="of:="+r.replace(FO,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function fp(r){var e=r.split(":"),t=e[0].split(".")[0];return[t,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function XM(r){return r.replace(/\./,"!")}var ic={},gl={},sc=typeof Map<"u";function NO(r,e,t){var n=0,i=r.length;if(t){if(sc?t.has(e):Object.prototype.hasOwnProperty.call(t,e)){for(var s=sc?t.get(e):t[e];n<s.length;++n)if(r[s[n]].t===e)return r.Count++,s[n]}}else for(;n<i;++n)if(r[n].t===e)return r.Count++,n;return r[i]={t:e},r.Count++,r.Unique++,t&&(sc?(t.has(e)||t.set(e,[]),t.get(e).push(i)):(Object.prototype.hasOwnProperty.call(t,e)||(t[e]=[]),t[e].push(i))),i}function b0(r,e){var t={min:r+1,max:r+1},n=-1;return e.MDW&&(yn=e.MDW),e.width!=null?t.customWidth=1:e.wpx!=null?n=Sc(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(t.width=yd(n),t.customWidth=1):e.width!=null&&(t.width=e.width),e.hidden&&(t.hidden=!0),e.level!=null&&(t.outlineLevel=t.level=e.level),t}function vo(r,e){if(r){var t=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(t=[1,1,1,1,.5,.5]),r.left==null&&(r.left=t[0]),r.right==null&&(r.right=t[1]),r.top==null&&(r.top=t[2]),r.bottom==null&&(r.bottom=t[3]),r.header==null&&(r.header=t[4]),r.footer==null&&(r.footer=t[5])}}function qa(r,e,t){var n=t.revssf[e.z!=null?e.z:"General"],i=60,s=r.length;if(n==null&&t.ssf){for(;i<392;++i)if(t.ssf[i]==null){ks(e.z,i),t.ssf[i]=e.z,t.revssf[e.z]=n=i;break}}for(i=0;i!=s;++i)if(r[i].numFmtId===n)return i;return r[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function OT(r,e,t,n,i,s){try{n.cellNF&&(r.z=Ke[e])}catch(o){if(n.WTF)throw o}if(!(r.t==="z"&&!n.cellStyles)){if(r.t==="d"&&typeof r.v=="string"&&(r.v=or(r.v)),(!n||n.cellText!==!1)&&r.t!=="z")try{if(Ke[e]==null&&ks(BQ[e]||"General",e),r.t==="e")r.w=r.w||sa[r.v];else if(e===0)if(r.t==="n")(r.v|0)===r.v?r.w=r.v.toString(10):r.w=xc(r.v);else if(r.t==="d"){var a=Xr(r.v);(a|0)===a?r.w=a.toString(10):r.w=xc(a)}else{if(r.v===void 0)return"";r.w=So(r.v,gl)}else r.t==="d"?r.w=Oi(e,Xr(r.v),gl):r.w=Oi(e,r.v,gl)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&t!=null)try{r.s=s.Fills[t],r.s.fgColor&&r.s.fgColor.theme&&!r.s.fgColor.rgb&&(r.s.fgColor.rgb=vd(i.themeElements.clrScheme[r.s.fgColor.theme].rgb,r.s.fgColor.tint||0),n.WTF&&(r.s.fgColor.raw_rgb=i.themeElements.clrScheme[r.s.fgColor.theme].rgb)),r.s.bgColor&&r.s.bgColor.theme&&(r.s.bgColor.rgb=vd(i.themeElements.clrScheme[r.s.bgColor.theme].rgb,r.s.bgColor.tint||0),n.WTF&&(r.s.bgColor.raw_rgb=i.themeElements.clrScheme[r.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&s.Fills)throw o}}}function VM(r,e,t){if(r&&r["!ref"]){var n=yt(r["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+t+"): "+r["!ref"])}}function qM(r,e){var t=yt(e);t.s.r<=t.e.r&&t.s.c<=t.e.c&&t.s.r>=0&&t.s.c>=0&&(r["!ref"]=lt(t))}var jM=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,zM=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,GM=/<(?:\w:)?hyperlink [^>]*>/mg,HM=/"(\w*:\w*)"/,YM=/<(?:\w:)?col\b[^>]*[\/]?>/g,KM=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,JM=/<(?:\w:)?pageMargins[^>]*\/>/g,xT=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,eI=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,tI=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function rI(r,e,t,n,i,s,a){if(!r)return r;n||(n={"!id":{}});var o=e.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},f="",c="",h=r.match(zM);h?(f=r.slice(0,h.index),c=r.slice(h.index+h[0].length)):f=c=r;var u=f.match(xT);u?MO(u[0],o,i,t):(u=f.match(eI))&&iI(u[0],u[1]||"",o,i,t);var d=(f.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(d>0){var p=f.slice(d,d+50).match(HM);p&&qM(o,p[1])}var m=f.match(tI);m&&m[1]&&OI(m[1],i);var g=[];if(e.cellStyles){var O=f.match(YM);O&&uI(g,O)}h&&yI(h[1],o,e,l,s,a);var w=c.match(KM);w&&(o["!autofilter"]=pI(w[0]));var v=[],S=c.match(jM);if(S)for(d=0;d!=S.length;++d)v[d]=yt(S[d].slice(S[d].indexOf('"')+1));var y=c.match(GM);y&&fI(o,y,n);var b=c.match(JM);if(b&&(o["!margins"]=cI(tt(b[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=lt(l)),e.sheetRows>0&&o["!ref"]){var x=yt(o["!ref"]);e.sheetRows<=+x.e.r&&(x.e.r=e.sheetRows-1,x.e.r>l.e.r&&(x.e.r=l.e.r),x.e.r<x.s.r&&(x.s.r=x.e.r),x.e.c>l.e.c&&(x.e.c=l.e.c),x.e.c<x.s.c&&(x.s.c=x.e.c),o["!fullref"]=o["!ref"],o["!ref"]=lt(x))}return g.length>0&&(o["!cols"]=g),v.length>0&&(o["!merges"]=v),o}function nI(r){if(r.length===0)return"";for(var e='<mergeCells count="'+r.length+'">',t=0;t!=r.length;++t)e+='<mergeCell ref="'+lt(r[t])+'"/>';return e+"</mergeCells>"}function MO(r,e,t,n){var i=tt(r);t.Sheets[n]||(t.Sheets[n]={}),i.codeName&&(t.Sheets[n].CodeName=At(Zt(i.codeName)))}function iI(r,e,t,n,i){MO(r.slice(0,r.indexOf(">")),t,n,i)}function sI(r,e,t,n,i){var s=!1,a={},o=null;if(n.bookType!=="xlsx"&&e.vbaraw){var l=e.SheetNames[t];try{e.Workbook&&(l=e.Workbook.Sheets[t].CodeName||l)}catch{}s=!0,a.codeName=ys(Bt(l))}if(r&&r["!outline"]){var f={summaryBelow:1,summaryRight:1};r["!outline"].above&&(f.summaryBelow=0),r["!outline"].left&&(f.summaryRight=0),o=(o||"")+$e("outlinePr",null,f)}!s&&!o||(i[i.length]=$e("sheetPr",o,a))}var aI=["objects","scenarios","selectLockedCells","selectUnlockedCells"],oI=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function lI(r){var e={sheet:1};return aI.forEach(function(t){r[t]!=null&&r[t]&&(e[t]="1")}),oI.forEach(function(t){r[t]!=null&&!r[t]&&(e[t]="0")}),r.password&&(e.password=PO(r.password).toString(16).toUpperCase()),$e("sheetProtection",null,e)}function fI(r,e,t){for(var n=Array.isArray(r),i=0;i!=e.length;++i){var s=tt(Zt(e[i]),!0);if(!s.ref)return;var a=((t||{})["!id"]||[])[s.id];a?(s.Target=a.Target,s.location&&(s.Target+="#"+At(s.location))):(s.Target="#"+At(s.location),a={Target:s.Target,TargetMode:"Internal"}),s.Rel=a,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=yt(s.ref),l=o.s.r;l<=o.e.r;++l)for(var f=o.s.c;f<=o.e.c;++f){var c=et({c:f,r:l});n?(r[l]||(r[l]=[]),r[l][f]||(r[l][f]={t:"z",v:void 0}),r[l][f].l=s):(r[c]||(r[c]={t:"z",v:void 0}),r[c].l=s)}}}function cI(r){var e={};return["left","right","top","bottom","header","footer"].forEach(function(t){r[t]&&(e[t]=parseFloat(r[t]))}),e}function hI(r){return vo(r),$e("pageMargins",null,r)}function uI(r,e){for(var t=!1,n=0;n!=e.length;++n){var i=tt(e[n],!0);i.hidden&&(i.hidden=sr(i.hidden));var s=parseInt(i.min,10)-1,a=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!t&&i.width&&(t=!0,RO(i.width)),Qa(i);s<=a;)r[s++]=jt(i)}}function dI(r,e){for(var t=["<cols>"],n,i=0;i!=e.length;++i)(n=e[i])&&(t[t.length]=$e("col",null,b0(i,n)));return t[t.length]="</cols>",t.join("")}function pI(r){var e={ref:(r.match(/ref="([^"]*)"/)||[])[1]};return e}function mI(r,e,t,n){var i=typeof r.ref=="string"?r.ref:lt(r.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var s=t.Workbook.Names,a=Ln(i);a.s.r==a.e.r&&(a.e.r=Ln(e["!ref"]).e.r,i=lt(a));for(var o=0;o<s.length;++o){var l=s[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+t.SheetNames[n]+"'!"+i;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+t.SheetNames[n]+"'!"+i}),$e("autoFilter",null,{ref:i})}var gI=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function OI(r,e){e.Views||(e.Views=[{}]),(r.match(gI)||[]).forEach(function(t,n){var i=tt(t);e.Views[n]||(e.Views[n]={}),+i.zoomScale&&(e.Views[n].zoom=+i.zoomScale),sr(i.rightToLeft)&&(e.Views[n].RTL=!0)})}function xI(r,e,t,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),$e("sheetViews",$e("sheetView",null,i),{})}function vI(r,e,t,n){if(r.c&&t["!comments"].push([e,r.c]),r.v===void 0&&typeof r.f!="string"||r.t==="z"&&!r.f)return"";var i="",s=r.t,a=r.v;if(r.t!=="z")switch(r.t){case"b":i=r.v?"1":"0";break;case"n":i=""+r.v;break;case"e":i=sa[r.v];break;case"d":n&&n.cellDates?i=or(r.v,-1).toISOString():(r=jt(r),r.t="n",i=""+(r.v=Xr(or(r.v)))),typeof r.z>"u"&&(r.z=Ke[14]);break;default:i=r.v;break}var o=un("v",Bt(i)),l={r:e},f=qa(n.cellXfs,r,n);switch(f!==0&&(l.s=f),r.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(r.v==null){delete r.t;break}if(r.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=un("v",""+NO(n.Strings,r.v,n.revStrings)),l.t="s";break}l.t="str";break}if(r.t!=s&&(r.t=s,r.v=a),typeof r.f=="string"&&r.f){var c=r.F&&r.F.slice(0,e.length)==e?{t:"array",ref:r.F}:null;o=$e("f",Bt(r.f),c)+(r.v!=null?o:"")}return r.l&&t["!links"].push([e,r.l]),r.D&&(l.cm=1),$e("c",o,l)}var yI=function(){var r=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,t=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,s=vc("v"),a=vc("f");return function(l,f,c,h,u,d){for(var p=0,m="",g=[],O=[],w=0,v=0,S=0,y="",b,x,A=0,k=0,E,T,_=0,N=0,Z=Array.isArray(d.CellXf),z,ee=[],ae=[],xe=Array.isArray(f),V=[],ue={},ie=!1,P=!!c.sheetStubs,I=l.split(e),B=0,W=I.length;B!=W;++B){m=I[B].trim();var K=m.length;if(K!==0){var re=0;e:for(p=0;p<K;++p)switch(m[p]){case">":if(m[p-1]!="/"){++p;break e}if(c&&c.cellStyles){if(x=tt(m.slice(re,p),!0),A=x.r!=null?parseInt(x.r,10):A+1,k=-1,c.sheetRows&&c.sheetRows<A)continue;ue={},ie=!1,x.ht&&(ie=!0,ue.hpt=parseFloat(x.ht),ue.hpx=Pl(ue.hpt)),x.hidden=="1"&&(ie=!0,ue.hidden=!0),x.outlineLevel!=null&&(ie=!0,ue.level=+x.outlineLevel),ie&&(V[A-1]=ue)}break;case"<":re=p;break}if(re>=p)break;if(x=tt(m.slice(re,p),!0),A=x.r!=null?parseInt(x.r,10):A+1,k=-1,!(c.sheetRows&&c.sheetRows<A)){h.s.r>A-1&&(h.s.r=A-1),h.e.r<A-1&&(h.e.r=A-1),c&&c.cellStyles&&(ue={},ie=!1,x.ht&&(ie=!0,ue.hpt=parseFloat(x.ht),ue.hpx=Pl(ue.hpt)),x.hidden=="1"&&(ie=!0,ue.hidden=!0),x.outlineLevel!=null&&(ie=!0,ue.level=+x.outlineLevel),ie&&(V[A-1]=ue)),g=m.slice(p).split(r);for(var pe=0;pe!=g.length&&g[pe].trim().charAt(0)=="<";++pe);for(g=g.slice(pe),p=0;p!=g.length;++p)if(m=g[p].trim(),m.length!==0){if(O=m.match(t),w=p,v=0,S=0,m="<c "+(m.slice(0,1)=="<"?">":"")+m,O!=null&&O.length===2){for(w=0,y=O[1],v=0;v!=y.length&&!((S=y.charCodeAt(v)-64)<1||S>26);++v)w=26*w+S;--w,k=w}else++k;for(v=0;v!=m.length&&m.charCodeAt(v)!==62;++v);if(++v,x=tt(m.slice(0,v),!0),x.r||(x.r=et({r:A-1,c:k})),y=m.slice(v),b={t:""},(O=y.match(s))!=null&&O[1]!==""&&(b.v=At(O[1])),c.cellFormula){if((O=y.match(a))!=null&&O[1]!==""){if(b.f=At(Zt(O[1])).replace(/\r\n/g,`
`),c.xlfn||(b.f=Ey(b.f)),O[0].indexOf('t="array"')>-1)b.F=(y.match(i)||[])[1],b.F.indexOf(":")>-1&&ee.push([yt(b.F),b.F]);else if(O[0].indexOf('t="shared"')>-1){T=tt(O[0]);var fe=At(Zt(O[1]));c.xlfn||(fe=Ey(fe)),ae[parseInt(T.si,10)]=[T,fe,x.r]}}else(O=y.match(/<f[^>]*\/>/))&&(T=tt(O[0]),ae[T.si]&&(b.f=g8(ae[T.si][1],ae[T.si][2],x.r)));var de=xr(x.r);for(v=0;v<ee.length;++v)de.r>=ee[v][0].s.r&&de.r<=ee[v][0].e.r&&de.c>=ee[v][0].s.c&&de.c<=ee[v][0].e.c&&(b.F=ee[v][1])}if(x.t==null&&b.v===void 0)if(b.f||b.F)b.v=0,b.t="n";else if(P)b.t="z";else continue;else b.t=x.t||"n";switch(h.s.c>k&&(h.s.c=k),h.e.c<k&&(h.e.c=k),b.t){case"n":if(b.v==""||b.v==null){if(!P)continue;b.t="z"}else b.v=parseFloat(b.v);break;case"s":if(typeof b.v>"u"){if(!P)continue;b.t="z"}else E=ic[parseInt(b.v,10)],b.v=E.t,b.r=E.r,c.cellHTML&&(b.h=E.h);break;case"str":b.t="s",b.v=b.v!=null?Zt(b.v):"",c.cellHTML&&(b.h=hO(b.v));break;case"inlineStr":O=y.match(n),b.t="s",O!=null&&(E=EO(O[1]))?(b.v=E.t,c.cellHTML&&(b.h=E.h)):b.v="";break;case"b":b.v=sr(b.v);break;case"d":c.cellDates?b.v=or(b.v,1):(b.v=Xr(or(b.v,1)),b.t="n");break;case"e":(!c||c.cellText!==!1)&&(b.w=b.v),b.v=yS[b.v];break}if(_=N=0,z=null,Z&&x.s!==void 0&&(z=d.CellXf[x.s],z!=null&&(z.numFmtId!=null&&(_=z.numFmtId),c.cellStyles&&z.fillId!=null&&(N=z.fillId))),OT(b,_,N,c,u,d),c.cellDates&&Z&&b.t=="n"&&Io(Ke[_])&&(b.t="d",b.v=O0(b.v)),x.cm&&c.xlmeta){var Ue=(c.xlmeta.Cell||[])[+x.cm-1];Ue&&Ue.type=="XLDAPR"&&(b.D=!0)}if(xe){var q=xr(x.r);f[q.r]||(f[q.r]=[]),f[q.r][q.c]=b}else f[x.r]=b}}}}V.length>0&&(f["!rows"]=V)}}();function wI(r,e,t,n){var i=[],s=[],a=yt(r["!ref"]),o="",l,f="",c=[],h=0,u=0,d=r["!rows"],p=Array.isArray(r),m={r:f},g,O=-1;for(u=a.s.c;u<=a.e.c;++u)c[u]=ar(u);for(h=a.s.r;h<=a.e.r;++h){for(s=[],f=kr(h),u=a.s.c;u<=a.e.c;++u){l=c[u]+f;var w=p?(r[h]||[])[u]:r[l];w!==void 0&&(o=vI(w,l,r,e))!=null&&s.push(o)}(s.length>0||d&&d[h])&&(m={r:f},d&&d[h]&&(g=d[h],g.hidden&&(m.hidden=1),O=-1,g.hpx?O=Tc(g.hpx):g.hpt&&(O=g.hpt),O>-1&&(m.ht=O,m.customHeight=1),g.level&&(m.outlineLevel=g.level)),i[i.length]=$e("row",s.join(""),m))}if(d)for(;h<d.length;++h)d&&d[h]&&(m={r:h+1},g=d[h],g.hidden&&(m.hidden=1),O=-1,g.hpx?O=Tc(g.hpx):g.hpt&&(O=g.hpt),O>-1&&(m.ht=O,m.customHeight=1),g.level&&(m.outlineLevel=g.level),i[i.length]=$e("row","",m));return i.join("")}function vT(r,e,t,n){var i=[Fr,$e("worksheet",null,{xmlns:Lo[0],"xmlns:r":Ur.r})],s=t.SheetNames[r],a=0,o="",l=t.Sheets[s];l==null&&(l={});var f=l["!ref"]||"A1",c=yt(f);if(c.e.c>16383||c.e.r>1048575){if(e.WTF)throw new Error("Range "+f+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575),f=lt(c)}n||(n={}),l["!comments"]=[];var h=[];sI(l,t,r,e,i),i[i.length]=$e("dimension",null,{ref:f}),i[i.length]=xI(l,e,r,t),e.sheetFormat&&(i[i.length]=$e("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(i[i.length]=dI(l,l["!cols"])),i[a=i.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=wI(l,e),o.length>0&&(i[i.length]=o)),i.length>a+1&&(i[i.length]="</sheetData>",i[a]=i[a].replace("/>",">")),l["!protect"]&&(i[i.length]=lI(l["!protect"])),l["!autofilter"]!=null&&(i[i.length]=mI(l["!autofilter"],l,t,r)),l["!merges"]!=null&&l["!merges"].length>0&&(i[i.length]=nI(l["!merges"]));var u=-1,d,p=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(m){m[1].Target&&(d={ref:m[0]},m[1].Target.charAt(0)!="#"&&(p=Lt(n,-1,Bt(m[1].Target).replace(/#.*$/,""),pt.HLINK),d["r:id"]="rId"+p),(u=m[1].Target.indexOf("#"))>-1&&(d.location=Bt(m[1].Target.slice(u+1))),m[1].Tooltip&&(d.tooltip=Bt(m[1].Tooltip)),i[i.length]=$e("hyperlink",null,d))}),i[i.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(i[i.length]=hI(l["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(i[i.length]=un("ignoredErrors",$e("ignoredError",null,{numberStoredAsText:1,sqref:f}))),h.length>0&&(p=Lt(n,-1,"../drawings/drawing"+(r+1)+".xml",pt.DRAW),i[i.length]=$e("drawing",null,{"r:id":"rId"+p}),l["!drawing"]=h),l["!comments"].length>0&&(p=Lt(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",pt.VML),i[i.length]=$e("legacyDrawing",null,{"r:id":"rId"+p}),l["!legacy"]=p),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function bI(r,e){var t={},n=r.l+e;t.r=r.read_shift(4),r.l+=4;var i=r.read_shift(2);r.l+=1;var s=r.read_shift(1);return r.l=n,s&7&&(t.level=s&7),s&16&&(t.hidden=!0),s&32&&(t.hpt=i/20),t}function _I(r,e,t){var n=me(145),i=(t["!rows"]||[])[r]||{};n.write_shift(4,r),n.write_shift(4,0);var s=320;i.hpx?s=Tc(i.hpx)*20:i.hpt&&(s=i.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var a=0;i.level&&(a|=i.level),i.hidden&&(a|=16),(i.hpx||i.hpt)&&(a|=32),n.write_shift(1,a),n.write_shift(1,0);var o=0,l=n.l;n.l+=4;for(var f={r,c:0},c=0;c<16;++c)if(!(e.s.c>c+1<<10||e.e.c<c<<10)){for(var h=-1,u=-1,d=c<<10;d<c+1<<10;++d){f.c=d;var p=Array.isArray(t)?(t[f.r]||[])[f.c]:t[et(f)];p&&(h<0&&(h=d),u=d)}h<0||(++o,n.write_shift(4,h),n.write_shift(4,u))}var m=n.l;return n.l=l,n.write_shift(4,o),n.l=m,n.length>n.l?n.slice(0,n.l):n}function kI(r,e,t,n){var i=_I(n,t,e);(i.length>17||(e["!rows"]||[])[n])&&_e(r,0,i)}var SI=Uo,TI=nf;function CI(){}function AI(r,e){var t={},n=r[r.l];return++r.l,t.above=!(n&64),t.left=!(n&128),r.l+=18,t.name=RF(r),t}function EI(r,e,t){t==null&&(t=me(84+4*r.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),t.write_shift(1,n);for(var i=1;i<3;++i)t.write_shift(1,0);return gd({auto:1},t),t.write_shift(-4,-1),t.write_shift(-4,-1),mS(r,t),t.slice(0,t.l)}function PI(r){var e=Ii(r);return[e]}function RI(r,e,t){return t==null&&(t=me(8)),Bo(e,t)}function QI(r){var e=Zo(r);return[e]}function FI(r,e,t){return t==null&&(t=me(4)),Wo(e,t)}function $I(r){var e=Ii(r),t=r.read_shift(1);return[e,t,"b"]}function DI(r,e,t){return t==null&&(t=me(9)),Bo(e,t),t.write_shift(1,r.v?1:0),t}function NI(r){var e=Zo(r),t=r.read_shift(1);return[e,t,"b"]}function MI(r,e,t){return t==null&&(t=me(5)),Wo(e,t),t.write_shift(1,r.v?1:0),t}function II(r){var e=Ii(r),t=r.read_shift(1);return[e,t,"e"]}function LI(r,e,t){return t==null&&(t=me(9)),Bo(e,t),t.write_shift(1,r.v),t}function BI(r){var e=Zo(r),t=r.read_shift(1);return[e,t,"e"]}function ZI(r,e,t){return t==null&&(t=me(8)),Wo(e,t),t.write_shift(1,r.v),t.write_shift(2,0),t.write_shift(1,0),t}function WI(r){var e=Ii(r),t=r.read_shift(4);return[e,t,"s"]}function UI(r,e,t){return t==null&&(t=me(12)),Bo(e,t),t.write_shift(4,e.v),t}function XI(r){var e=Zo(r),t=r.read_shift(4);return[e,t,"s"]}function VI(r,e,t){return t==null&&(t=me(8)),Wo(e,t),t.write_shift(4,e.v),t}function qI(r){var e=Ii(r),t=bn(r);return[e,t,"n"]}function jI(r,e,t){return t==null&&(t=me(16)),Bo(e,t),Co(r.v,t),t}function yT(r){var e=Zo(r),t=bn(r);return[e,t,"n"]}function zI(r,e,t){return t==null&&(t=me(12)),Wo(e,t),Co(r.v,t),t}function GI(r){var e=Ii(r),t=kO(r);return[e,t,"n"]}function HI(r,e,t){return t==null&&(t=me(12)),Bo(e,t),gS(r.v,t),t}function YI(r){var e=Zo(r),t=kO(r);return[e,t,"n"]}function KI(r,e,t){return t==null&&(t=me(8)),Wo(e,t),gS(r.v,t),t}function JI(r){var e=Ii(r),t=wO(r);return[e,t,"is"]}function eL(r){var e=Ii(r),t=Tn(r);return[e,t,"str"]}function tL(r,e,t){return t==null&&(t=me(12+4*r.v.length)),Bo(e,t),en(r.v,t),t.length>t.l?t.slice(0,t.l):t}function rL(r){var e=Zo(r),t=Tn(r);return[e,t,"str"]}function nL(r,e,t){return t==null&&(t=me(8+4*r.v.length)),Wo(e,t),en(r.v,t),t.length>t.l?t.slice(0,t.l):t}function iL(r,e,t){var n=r.l+e,i=Ii(r);i.r=t["!row"];var s=r.read_shift(1),a=[i,s,"b"];if(t.cellFormula){r.l+=2;var o=w0(r,n-r.l,t);a[3]=xn(o,null,i,t.supbooks,t)}else r.l=n;return a}function sL(r,e,t){var n=r.l+e,i=Ii(r);i.r=t["!row"];var s=r.read_shift(1),a=[i,s,"e"];if(t.cellFormula){r.l+=2;var o=w0(r,n-r.l,t);a[3]=xn(o,null,i,t.supbooks,t)}else r.l=n;return a}function aL(r,e,t){var n=r.l+e,i=Ii(r);i.r=t["!row"];var s=bn(r),a=[i,s,"n"];if(t.cellFormula){r.l+=2;var o=w0(r,n-r.l,t);a[3]=xn(o,null,i,t.supbooks,t)}else r.l=n;return a}function oL(r,e,t){var n=r.l+e,i=Ii(r);i.r=t["!row"];var s=Tn(r),a=[i,s,"str"];if(t.cellFormula){r.l+=2;var o=w0(r,n-r.l,t);a[3]=xn(o,null,i,t.supbooks,t)}else r.l=n;return a}var lL=Uo,fL=nf;function cL(r,e){return e==null&&(e=me(4)),e.write_shift(4,r),e}function hL(r,e){var t=r.l+e,n=Uo(r),i=bO(r),s=Tn(r),a=Tn(r),o=Tn(r);r.l=t;var l={rfx:n,relId:i,loc:s,display:o};return a&&(l.Tooltip=a),l}function uL(r,e){var t=me(50+4*(r[1].Target.length+(r[1].Tooltip||"").length));nf({s:xr(r[0]),e:xr(r[0])},t),_O("rId"+e,t);var n=r[1].Target.indexOf("#"),i=n==-1?"":r[1].Target.slice(n+1);return en(i||"",t),en(r[1].Tooltip||"",t),en("",t),t.slice(0,t.l)}function dL(){}function pL(r,e,t){var n=r.l+e,i=OS(r),s=r.read_shift(1),a=[i];if(a[2]=s,t.cellFormula){var o=IM(r,n-r.l,t);a[1]=o}else r.l=n;return a}function mL(r,e,t){var n=r.l+e,i=Uo(r),s=[i];if(t.cellFormula){var a=BM(r,n-r.l,t);s[1]=a,r.l=n}else r.l=n;return s}function gL(r,e,t){t==null&&(t=me(18));var n=b0(r,e);t.write_shift(-4,r),t.write_shift(-4,r),t.write_shift(4,(n.width||10)*256),t.write_shift(4,0);var i=0;return e.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),e.level&&(i|=e.level<<8),t.write_shift(2,i),t}var wT=["left","right","top","bottom","header","footer"];function OL(r){var e={};return wT.forEach(function(t){e[t]=bn(r)}),e}function xL(r,e){return e==null&&(e=me(6*8)),vo(r),wT.forEach(function(t){Co(r[t],e)}),e}function vL(r){var e=r.read_shift(2);return r.l+=28,{RTL:e&32}}function yL(r,e,t){t==null&&(t=me(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),t.write_shift(2,n),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,100),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(4,0),t}function wL(r){var e=me(24);return e.write_shift(4,4),e.write_shift(4,1),nf(r,e),e}function bL(r,e){return e==null&&(e=me(16*4+2)),e.write_shift(2,r.password?PO(r.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(t){t[1]?e.write_shift(4,r[t[0]]!=null&&!r[t[0]]?1:0):e.write_shift(4,r[t[0]]!=null&&r[t[0]]?0:1)}),e}function _L(){}function kL(){}function SL(r,e,t,n,i,s,a){if(!r)return r;var o=e||{};n||(n={"!id":{}});var l=o.dense?[]:{},f,c={s:{r:2e6,c:2e6},e:{r:0,c:0}},h=!1,u=!1,d,p,m,g,O,w,v,S,y,b=[];o.biff=12,o["!row"]=0;var x=0,A=!1,k=[],E={},T=o.supbooks||i.supbooks||[[]];if(T.sharedf=E,T.arrayf=k,T.SheetNames=i.SheetNames||i.Sheets.map(function(xe){return xe.name}),!o.supbooks&&(o.supbooks=T,i.Names))for(var _=0;_<i.Names.length;++_)T[0][_+1]=i.Names[_];var N=[],Z=[],z=!1;Cc[16]={n:"BrtShortReal",f:yT};var ee;if(ia(r,function(V,ue,ie){if(!u)switch(ie){case 148:f=V;break;case 0:d=V,o.sheetRows&&o.sheetRows<=d.r&&(u=!0),S=kr(g=d.r),o["!row"]=d.r,(V.hidden||V.hpt||V.level!=null)&&(V.hpt&&(V.hpx=Pl(V.hpt)),Z[V.r]=V);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(p={t:V[2]},V[2]){case"n":p.v=V[1];break;case"s":v=ic[V[1]],p.v=v.t,p.r=v.r;break;case"b":p.v=!!V[1];break;case"e":p.v=V[1],o.cellText!==!1&&(p.w=sa[p.v]);break;case"str":p.t="s",p.v=V[1];break;case"is":p.t="s",p.v=V[1].t;break}if((m=a.CellXf[V[0].iStyleRef])&&OT(p,m.numFmtId,null,o,s,a),O=V[0].c==-1?O+1:V[0].c,o.dense?(l[g]||(l[g]=[]),l[g][O]=p):l[ar(O)+S]=p,o.cellFormula){for(A=!1,x=0;x<k.length;++x){var P=k[x];d.r>=P[0].s.r&&d.r<=P[0].e.r&&O>=P[0].s.c&&O<=P[0].e.c&&(p.F=lt(P[0]),A=!0)}!A&&V.length>3&&(p.f=V[3])}if(c.s.r>d.r&&(c.s.r=d.r),c.s.c>O&&(c.s.c=O),c.e.r<d.r&&(c.e.r=d.r),c.e.c<O&&(c.e.c=O),o.cellDates&&m&&p.t=="n"&&Io(Ke[m.numFmtId])){var I=ba(p.v);I&&(p.t="d",p.v=new Date(I.y,I.m-1,I.d,I.H,I.M,I.S,I.u))}ee&&(ee.type=="XLDAPR"&&(p.D=!0),ee=void 0);break;case 1:case 12:if(!o.sheetStubs||h)break;p={t:"z",v:void 0},O=V[0].c==-1?O+1:V[0].c,o.dense?(l[g]||(l[g]=[]),l[g][O]=p):l[ar(O)+S]=p,c.s.r>d.r&&(c.s.r=d.r),c.s.c>O&&(c.s.c=O),c.e.r<d.r&&(c.e.r=d.r),c.e.c<O&&(c.e.c=O),ee&&(ee.type=="XLDAPR"&&(p.D=!0),ee=void 0);break;case 176:b.push(V);break;case 49:ee=((o.xlmeta||{}).Cell||[])[V-1];break;case 494:var B=n["!id"][V.relId];for(B?(V.Target=B.Target,V.loc&&(V.Target+="#"+V.loc),V.Rel=B):V.relId==""&&(V.Target="#"+V.loc),g=V.rfx.s.r;g<=V.rfx.e.r;++g)for(O=V.rfx.s.c;O<=V.rfx.e.c;++O)o.dense?(l[g]||(l[g]=[]),l[g][O]||(l[g][O]={t:"z",v:void 0}),l[g][O].l=V):(w=et({c:O,r:g}),l[w]||(l[w]={t:"z",v:void 0}),l[w].l=V);break;case 426:if(!o.cellFormula)break;k.push(V),y=o.dense?l[g][O]:l[ar(O)+S],y.f=xn(V[1],c,{r:d.r,c:O},T,o),y.F=lt(V[0]);break;case 427:if(!o.cellFormula)break;E[et(V[0].s)]=V[1],y=o.dense?l[g][O]:l[ar(O)+S],y.f=xn(V[1],c,{r:d.r,c:O},T,o);break;case 60:if(!o.cellStyles)break;for(;V.e>=V.s;)N[V.e--]={width:V.w/256,hidden:!!(V.flags&1),level:V.level},z||(z=!0,RO(V.w/256)),Qa(N[V.e+1]);break;case 161:l["!autofilter"]={ref:lt(V)};break;case 476:l["!margins"]=V;break;case 147:i.Sheets[t]||(i.Sheets[t]={}),V.name&&(i.Sheets[t].CodeName=V.name),(V.above||V.left)&&(l["!outline"]={above:V.above,left:V.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),V.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:h=!0;break;case 36:h=!1;break;case 37:h=!0;break;case 38:h=!1;break;default:if(!ue.T){if(!h||o.WTF)throw new Error("Unexpected record 0x"+ie.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(c.s.r<2e6||f&&(f.e.r>0||f.e.c>0||f.s.r>0||f.s.c>0))&&(l["!ref"]=lt(f||c)),o.sheetRows&&l["!ref"]){var ae=yt(l["!ref"]);o.sheetRows<=+ae.e.r&&(ae.e.r=o.sheetRows-1,ae.e.r>c.e.r&&(ae.e.r=c.e.r),ae.e.r<ae.s.r&&(ae.s.r=ae.e.r),ae.e.c>c.e.c&&(ae.e.c=c.e.c),ae.e.c<ae.s.c&&(ae.s.c=ae.e.c),l["!fullref"]=l["!ref"],l["!ref"]=lt(ae))}return b.length>0&&(l["!merges"]=b),N.length>0&&(l["!cols"]=N),Z.length>0&&(l["!rows"]=Z),l}function TL(r,e,t,n,i,s,a){if(e.v===void 0)return!1;var o="";switch(e.t){case"b":o=e.v?"1":"0";break;case"d":e=jt(e),e.z=e.z||Ke[14],e.v=Xr(or(e.v)),e.t="n";break;case"n":case"e":o=""+e.v;break;default:o=e.v;break}var l={r:t,c:n};switch(l.s=qa(i.cellXfs,e,i),e.l&&s["!links"].push([et(l),e.l]),e.c&&s["!comments"].push([et(l),e.c]),e.t){case"s":case"str":return i.bookSST?(o=NO(i.Strings,e.v,i.revStrings),l.t="s",l.v=o,a?_e(r,18,VI(e,l)):_e(r,7,UI(e,l))):(l.t="str",a?_e(r,17,nL(e,l)):_e(r,6,tL(e,l))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?a?_e(r,13,KI(e,l)):_e(r,2,HI(e,l)):a?_e(r,16,zI(e,l)):_e(r,5,jI(e,l)),!0;case"b":return l.t="b",a?_e(r,15,MI(e,l)):_e(r,4,DI(e,l)),!0;case"e":return l.t="e",a?_e(r,14,ZI(e,l)):_e(r,3,LI(e,l)),!0}return a?_e(r,12,FI(e,l)):_e(r,1,RI(e,l)),!0}function CL(r,e,t,n){var i=yt(e["!ref"]||"A1"),s,a="",o=[];_e(r,145);var l=Array.isArray(e),f=i.e.r;e["!rows"]&&(f=Math.max(i.e.r,e["!rows"].length-1));for(var c=i.s.r;c<=f;++c){a=kr(c),kI(r,e,i,c);var h=!1;if(c<=i.e.r)for(var u=i.s.c;u<=i.e.c;++u){c===i.s.r&&(o[u]=ar(u)),s=o[u]+a;var d=l?(e[c]||[])[u]:e[s];if(!d){h=!1;continue}h=TL(r,d,c,u,n,e,h)}}_e(r,146)}function AL(r,e){!e||!e["!merges"]||(_e(r,177,cL(e["!merges"].length)),e["!merges"].forEach(function(t){_e(r,176,fL(t))}),_e(r,178))}function EL(r,e){!e||!e["!cols"]||(_e(r,390),e["!cols"].forEach(function(t,n){t&&_e(r,60,gL(n,t))}),_e(r,391))}function PL(r,e){!e||!e["!ref"]||(_e(r,648),_e(r,649,wL(yt(e["!ref"]))),_e(r,650))}function RL(r,e,t){e["!links"].forEach(function(n){if(n[1].Target){var i=Lt(t,-1,n[1].Target.replace(/#.*$/,""),pt.HLINK);_e(r,494,uL(n,i))}}),delete e["!links"]}function QL(r,e,t,n){if(e["!comments"].length>0){var i=Lt(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",pt.VML);_e(r,551,_O("rId"+i)),e["!legacy"]=i}}function FL(r,e,t,n){if(e["!autofilter"]){var i=e["!autofilter"],s=typeof i.ref=="string"?i.ref:lt(i.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var a=t.Workbook.Names,o=Ln(s);o.s.r==o.e.r&&(o.e.r=Ln(e["!ref"]).e.r,s=lt(o));for(var l=0;l<a.length;++l){var f=a[l];if(f.Name=="_xlnm._FilterDatabase"&&f.Sheet==n){f.Ref="'"+t.SheetNames[n]+"'!"+s;break}}l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+t.SheetNames[n]+"'!"+s}),_e(r,161,nf(yt(s))),_e(r,162)}}function $L(r,e,t){_e(r,133),_e(r,137,yL(e,t)),_e(r,138),_e(r,134)}function DL(r,e){e["!protect"]&&_e(r,535,bL(e["!protect"]))}function NL(r,e,t,n){var i=Kn(),s=t.SheetNames[r],a=t.Sheets[s]||{},o=s;try{t&&t.Workbook&&(o=t.Workbook.Sheets[r].CodeName||o)}catch{}var l=yt(a["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(e.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],_e(i,129),(t.vbaraw||a["!outline"])&&_e(i,147,EI(o,a["!outline"])),_e(i,148,TI(l)),$L(i,a,t.Workbook),EL(i,a),CL(i,a,r,e),DL(i,a),FL(i,a,t,r),AL(i,a),RL(i,a,n),a["!margins"]&&_e(i,476,xL(a["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&PL(i,a),QL(i,a,r,n),_e(i,130),i.end()}function ML(r){var e=[],t=r.match(/^<c:numCache>/),n;(r.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var a=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);a&&(e[+a[1]]=t?+a[2]:a[2])});var i=At((r.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(r.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[e,i,n]}function IL(r,e,t,n,i,s){var a=s||{"!type":"chart"};if(!r)return s;var o=0,l=0,f="A",c={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(r.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(h){var u=ML(h);c.s.r=c.s.c=0,c.e.c=o,f=ar(o),u[0].forEach(function(d,p){a[f+kr(p)]={t:"n",v:d,z:u[1]},l=p}),c.e.r<l&&(c.e.r=l),++o}),o>0&&(a["!ref"]=lt(c)),a}function LL(r,e,t,n,i){if(!r)return r;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a,o=r.match(xT);return o&&MO(o[0],s,i,t),(a=r.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=a[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function BL(r,e){r.l+=10;var t=Tn(r);return{name:t}}function ZL(r,e,t,n,i){if(!r)return r;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a=!1;return ia(r,function(l,f,c){switch(c){case 550:s["!rel"]=l;break;case 651:i.Sheets[t]||(i.Sheets[t]={}),l.name&&(i.Sheets[t].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!(f.T>0)){if(!(f.T<0)){if(!a||e.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}},e),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var IO=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],WL=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],UL=[],XL=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function $y(r,e){for(var t=0;t!=r.length;++t)for(var n=r[t],i=0;i!=e.length;++i){var s=e[i];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=sr(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function Dy(r,e){for(var t=0;t!=e.length;++t){var n=e[t];if(r[n[0]]==null)r[n[0]]=n[1];else switch(n[2]){case"bool":typeof r[n[0]]=="string"&&(r[n[0]]=sr(r[n[0]]));break;case"int":typeof r[n[0]]=="string"&&(r[n[0]]=parseInt(r[n[0]],10));break}}}function bT(r){Dy(r.WBProps,IO),Dy(r.CalcPr,XL),$y(r.WBView,WL),$y(r.Sheets,UL),gl.date1904=sr(r.WBProps.date1904)}function VL(r){return!r.Workbook||!r.Workbook.WBProps?"false":sr(r.Workbook.WBProps.date1904)?"true":"false"}var qL="][*?/\\".split("");function _T(r,e){if(r.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return qL.forEach(function(n){if(r.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}function jL(r,e,t){r.forEach(function(n,i){_T(n);for(var s=0;s<i;++s)if(n==r[s])throw new Error("Duplicate Sheet Name: "+n);if(t){var a=e[i]&&e[i].CodeName||n;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function kT(r){if(!r||!r.SheetNames||!r.Sheets)throw new Error("Invalid Workbook");if(!r.SheetNames.length)throw new Error("Workbook is empty");var e=r.Workbook&&r.Workbook.Sheets||[];jL(r.SheetNames,e,!!r.vbaraw);for(var t=0;t<r.SheetNames.length;++t)VM(r.Sheets[r.SheetNames[t]],r.SheetNames[t],t)}var zL=/<\w+:workbook/;function GL(r,e){if(!r)throw new Error("Could not find file");var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",s={},a=0;if(r.replace(Pn,function(l,f){var c=tt(l);switch(Ds(c[0])){case"<?xml":break;case"<workbook":l.match(zL)&&(i="xmlns"+l.match(/<(\w+):/)[1]),t.xmlns=c[i];break;case"</workbook>":break;case"<fileVersion":delete c[0],t.AppVersion=c;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":IO.forEach(function(h){if(c[h[0]]!=null)switch(h[2]){case"bool":t.WBProps[h[0]]=sr(c[h[0]]);break;case"int":t.WBProps[h[0]]=parseInt(c[h[0]],10);break;default:t.WBProps[h[0]]=c[h[0]]}}),c.codeName&&(t.WBProps.CodeName=Zt(c.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete c[0],t.WBView.push(c);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(c.state){case"hidden":c.Hidden=1;break;case"veryHidden":c.Hidden=2;break;default:c.Hidden=0}delete c.state,c.name=At(Zt(c.name)),delete c[0],t.Sheets.push(c);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=Zt(c.name),c.comment&&(s.Comment=c.comment),c.localSheetId&&(s.Sheet=+c.localSheetId),sr(c.hidden||"0")&&(s.Hidden=!0),a=f+l.length;break;case"</definedName>":s.Ref=At(Zt(r.slice(a,f))),t.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete c[0],t.CalcPr=c;break;case"<calcPr/>":delete c[0],t.CalcPr=c;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+c[0]+" in workbook")}return l}),Lo.indexOf(t.xmlns)===-1)throw new Error("Unknown Namespace: "+t.xmlns);return bT(t),t}function ST(r){var e=[Fr];e[e.length]=$e("workbook",null,{xmlns:Lo[0],"xmlns:r":Ur.r});var t=r.Workbook&&(r.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};r.Workbook&&r.Workbook.WBProps&&(IO.forEach(function(o){r.Workbook.WBProps[o[0]]!=null&&r.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=r.Workbook.WBProps[o[0]])}),r.Workbook.WBProps.CodeName&&(n.codeName=r.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=$e("workbookPr",null,n);var i=r.Workbook&&r.Workbook.Sheets||[],s=0;if(i[0]&&i[0].Hidden){for(e[e.length]="<bookViews>",s=0;s!=r.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==r.SheetNames.length&&(s=0),e[e.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",s=0;s!=r.SheetNames.length;++s){var a={name:Bt(r.SheetNames[s].slice(0,31))};if(a.sheetId=""+(s+1),a["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}e[e.length]=$e("sheet",null,a)}return e[e.length]="</sheets>",t&&(e[e.length]="<definedNames>",r.Workbook&&r.Workbook.Names&&r.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(e[e.length]=$e("definedName",Bt(o.Ref),l))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function HL(r,e){var t={};return t.Hidden=r.read_shift(4),t.iTabID=r.read_shift(4),t.strRelID=$m(r),t.name=Tn(r),t}function YL(r,e){return e||(e=me(127)),e.write_shift(4,r.Hidden),e.write_shift(4,r.iTabID),_O(r.strRelID,e),en(r.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function KL(r,e){var t={},n=r.read_shift(4);t.defaultThemeVersion=r.read_shift(4);var i=e>8?Tn(r):"";return i.length>0&&(t.CodeName=i),t.autoCompressPictures=!!(n&65536),t.backupFile=!!(n&64),t.checkCompatibility=!!(n&4096),t.date1904=!!(n&1),t.filterPrivacy=!!(n&8),t.hidePivotFieldList=!!(n&1024),t.promptedSolutions=!!(n&16),t.publishItems=!!(n&2048),t.refreshAllConnections=!!(n&262144),t.saveExternalLinkValues=!!(n&128),t.showBorderUnselectedTables=!!(n&4),t.showInkAnnotation=!!(n&32),t.showObjects=["all","placeholders","none"][n>>13&3],t.showPivotChartFilter=!!(n&32768),t.updateLinks=["userSet","never","always"][n>>8&3],t}function JL(r,e){e||(e=me(72));var t=0;return r&&r.filterPrivacy&&(t|=8),e.write_shift(4,t),e.write_shift(4,0),mS(r&&r.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function eB(r,e){var t={};return r.read_shift(4),t.ArchID=r.read_shift(4),r.l+=e-8,t}function tB(r,e,t){var n=r.l+e;r.l+=4,r.l+=1;var i=r.read_shift(4),s=QF(r),a=LM(r,0,t),o=bO(r);r.l=n;var l={Name:s,Ptg:a};return i<268435455&&(l.Sheet=i),o&&(l.Comment=o),l}function rB(r,e){var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;e||(e={}),e.biff=12;var s=[],a=[[]];return a.SheetNames=[],a.XTI=[],Cc[16]={n:"BrtFRTArchID$",f:eB},ia(r,function(l,f,c){switch(c){case 156:a.SheetNames.push(l.name),t.Sheets.push(l);break;case 153:t.WBProps=l;break;case 39:l.Sheet!=null&&(e.SID=l.Sheet),l.Ref=xn(l.Ptg,null,null,a,e),delete e.SID,delete l.Ptg,s.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:a[0].length?a.push([c,l]):a[0]=[c,l],a[a.length-1].XTI=[];break;case 362:a.length===0&&(a[0]=[],a[0].XTI=[]),a[a.length-1].XTI=a[a.length-1].XTI.concat(l),a.XTI=a.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(c),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(c),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!f.T){if(!i||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+c.toString(16))}}},e),bT(t),t.Names=s,t.supbooks=a,t}function nB(r,e){_e(r,143);for(var t=0;t!=e.SheetNames.length;++t){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[t]&&e.Workbook.Sheets[t].Hidden||0,i={Hidden:n,iTabID:t+1,strRelID:"rId"+(t+1),name:e.SheetNames[t]};_e(r,156,YL(i))}_e(r,144)}function iB(r,e){e||(e=me(127));for(var t=0;t!=4;++t)e.write_shift(4,0);return en("SheetJS",e),en(gc.version,e),en(gc.version,e),en("7262",e),e.length>e.l?e.slice(0,e.l):e}function sB(r,e){e||(e=me(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,r),e.write_shift(4,r);var t=120;return e.write_shift(1,t),e.length>e.l?e.slice(0,e.l):e}function aB(r,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var t=e.Workbook.Sheets,n=0,i=-1,s=-1;n<t.length;++n)!t[n]||!t[n].Hidden&&i==-1?i=n:t[n].Hidden==1&&s==-1&&(s=n);s>i||(_e(r,135),_e(r,158,sB(i)),_e(r,136))}}function oB(r,e){var t=Kn();return _e(t,131),_e(t,128,iB()),_e(t,153,JL(r.Workbook&&r.Workbook.WBProps||null)),aB(t,r),nB(t,r),_e(t,132),t.end()}function lB(r,e,t){return e.slice(-4)===".bin"?rB(r,t):GL(r,t)}function fB(r,e,t,n,i,s,a,o){return e.slice(-4)===".bin"?SL(r,n,t,i,s,a,o):rI(r,n,t,i,s,a,o)}function cB(r,e,t,n,i,s,a,o){return e.slice(-4)===".bin"?ZL(r,n,t,i,s):LL(r,n,t,i,s)}function hB(r,e,t,n,i,s,a,o){return e.slice(-4)===".bin"?p8():m8()}function uB(r,e,t,n,i,s,a,o){return e.slice(-4)===".bin"?u8():d8()}function dB(r,e,t,n){return e.slice(-4)===".bin"?f6(r,t,n):YN(r,t,n)}function pB(r,e,t){return iT(r,t)}function mB(r,e,t){return e.slice(-4)===".bin"?gN(r,t):dN(r,t)}function gB(r,e,t){return e.slice(-4)===".bin"?o8(r,t):K6(r,t)}function OB(r,e,t){return e.slice(-4)===".bin"?G6(r):j6(r)}function xB(r,e,t,n){return t.slice(-4)===".bin"?H6(r,e,t,n):void 0}function vB(r,e,t){return e.slice(-4)===".bin"?X6(r,e,t):q6(r,e,t)}function yB(r,e,t){return(e.slice(-4)===".bin"?oB:ST)(r)}function wB(r,e,t,n,i){return(e.slice(-4)===".bin"?NL:vT)(r,t,n,i)}function bB(r,e,t){return(e.slice(-4)===".bin"?v6:rT)(r,t)}function _B(r,e,t){return(e.slice(-4)===".bin"?vN:zS)(r,t)}function kB(r,e,t){return(e.slice(-4)===".bin"?l8:oT)(r)}function SB(r){return(r.slice(-4)===".bin"?V6:sT)()}var TT=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,CT=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Ui(r,e){var t=r.split(/\s+/),n=[];if(n[0]=t[0],t.length===1)return n;var i=r.match(TT),s,a,o,l;if(i)for(l=0;l!=i.length;++l)s=i[l].match(CT),(a=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(a+1),n[o]=s[2].slice(1,s[2].length-1));return n}function TB(r){var e=r.split(/\s+/),t={};if(e.length===1)return t;var n=r.match(TT),i,s,a,o;if(n)for(o=0;o!=n.length;++o)i=n[o].match(CT),(s=i[1].indexOf(":"))===-1?t[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?a="xmlns"+i[1].slice(6):a=i[1].slice(s+1),t[a]=i[2].slice(1,i[2].length-1));return t}var ac;function CB(r,e){var t=ac[r]||At(r);return t==="General"?So(e):Oi(t,e)}function AB(r,e,t,n){var i=n;switch((t[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=sr(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=or(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+t[0])}r[At(e)]=i}function EB(r,e,t){if(r.t!=="z"){if(!t||t.cellText!==!1)try{r.t==="e"?r.w=r.w||sa[r.v]:e==="General"?r.t==="n"?(r.v|0)===r.v?r.w=r.v.toString(10):r.w=xc(r.v):r.w=So(r.v):r.w=CB(e||"General",r.v)}catch(s){if(t.WTF)throw s}try{var n=ac[e]||e||"General";if(t.cellNF&&(r.z=n),t.cellDates&&r.t=="n"&&Io(n)){var i=ba(r.v);i&&(r.t="d",r.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(s){if(t.WTF)throw s}}}function PB(r,e,t){if(t.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=UN[n.Pattern]||n.Pattern)}r[e.ID]=e}function RB(r,e,t,n,i,s,a,o,l,f){var c="General",h=n.StyleID,u={};f=f||{};var d=[],p=0;for(h===void 0&&o&&(h=o.StyleID),h===void 0&&a&&(h=a.StyleID);s[h]!==void 0&&(s[h].nf&&(c=s[h].nf),s[h].Interior&&d.push(s[h].Interior),!!s[h].Parent);)h=s[h].Parent;switch(t.Type){case"Boolean":n.t="b",n.v=sr(r);break;case"String":n.t="s",n.r=Kv(At(r)),n.v=r.indexOf("<")>-1?At(e||r).replace(/<.*?>/g,""):n.r;break;case"DateTime":r.slice(-1)!="Z"&&(r+="Z"),n.v=(or(r)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=At(r):n.v<60&&(n.v=n.v-1),(!c||c=="General")&&(c="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+r),n.t||(n.t="n");break;case"Error":n.t="e",n.v=yS[r],f.cellText!==!1&&(n.w=r);break;default:r==""&&e==""?n.t="z":(n.t="s",n.v=Kv(e||r));break}if(EB(n,c,f),f.cellFormula!==!1)if(n.Formula){var m=At(n.Formula);m.charCodeAt(0)==61&&(m=m.slice(1)),n.f=ml(m,i),delete n.Formula,n.ArrayRange=="RC"?n.F=ml("RC:RC",i):n.ArrayRange&&(n.F=ml(n.ArrayRange,i),l.push([yt(n.F),n.F]))}else for(p=0;p<l.length;++p)i.r>=l[p][0].s.r&&i.r<=l[p][0].e.r&&i.c>=l[p][0].s.c&&i.c<=l[p][0].e.c&&(n.F=l[p][1]);f.cellStyles&&(d.forEach(function(g){!u.patternType&&g.patternType&&(u.patternType=g.patternType)}),n.s=u),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function QB(r){r.t=r.v||"",r.t=r.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),r.v=r.w=r.ixfe=void 0}function cp(r,e){var t=e||{};ef();var n=nl(uO(r));(t.type=="binary"||t.type=="array"||t.type=="base64")&&(typeof St<"u"?n=St.utils.decode(65001,fd(n)):n=Zt(n));var i=n.slice(0,1024).toLowerCase(),s=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var a=jt(t);return a.type="string",El.to_workbook(n,a)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(it){i.indexOf("<"+it)>=0&&(s=!0)}),s)return p7(n,t);ac={"General Number":"General","General Date":Ke[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Ke[15],"Short Date":Ke[14],"Long Time":Ke[19],"Medium Time":Ke[18],"Short Time":Ke[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Ke[2],Standard:Ke[4],Percent:Ke[10],Scientific:Ke[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],f,c={},h=[],u=t.dense?[]:{},d="",p={},m={},g=Ui('<Data ss:Type="String">'),O=0,w=0,v=0,S={s:{r:2e6,c:2e6},e:{r:0,c:0}},y={},b={},x="",A=0,k=[],E={},T={},_=0,N=[],Z=[],z={},ee=[],ae,xe=!1,V=[],ue=[],ie={},P=0,I=0,B={Sheets:[],WBProps:{date1904:!1}},W={};wc.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var K="";o=wc.exec(n);)switch(o[3]=(K=o[3]).toLowerCase()){case"data":if(K=="data"){if(o[1]==="/"){if((f=l.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?RB(n.slice(O,o.index),x,g,l[l.length-1][0]=="comment"?z:p,{c:w,r:v},y,ee[w],m,V,t):(x="",g=Ui(o[0]),O=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(Z.length>0&&(p.c=Z),(!t.sheetRows||t.sheetRows>v)&&p.v!==void 0&&(t.dense?(u[v]||(u[v]=[]),u[v][w]=p):u[ar(w)+kr(v)]=p),p.HRef&&(p.l={Target:At(p.HRef)},p.HRefScreenTip&&(p.l.Tooltip=p.HRefScreenTip),delete p.HRef,delete p.HRefScreenTip),(p.MergeAcross||p.MergeDown)&&(P=w+(parseInt(p.MergeAcross,10)|0),I=v+(parseInt(p.MergeDown,10)|0),k.push({s:{c:w,r:v},e:{c:P,r:I}})),!t.sheetStubs)p.MergeAcross?w=P+1:++w;else if(p.MergeAcross||p.MergeDown){for(var re=w;re<=P;++re)for(var pe=v;pe<=I;++pe)(re>w||pe>v)&&(t.dense?(u[pe]||(u[pe]=[]),u[pe][re]={t:"z"}):u[ar(re)+kr(pe)]={t:"z"});w=P+1}else++w;else p=TB(o[0]),p.Index&&(w=+p.Index-1),w<S.s.c&&(S.s.c=w),w>S.e.c&&(S.e.c=w),o[0].slice(-2)==="/>"&&++w,Z=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(v<S.s.r&&(S.s.r=v),v>S.e.r&&(S.e.r=v),o[0].slice(-2)==="/>"&&(m=Ui(o[0]),m.Index&&(v=+m.Index-1)),w=0,++v):(m=Ui(o[0]),m.Index&&(v=+m.Index-1),ie={},(m.AutoFitHeight=="0"||m.Height)&&(ie.hpx=parseInt(m.Height,10),ie.hpt=Tc(ie.hpx),ue[v]=ie),m.Hidden=="1"&&(ie.hidden=!0,ue[v]=ie));break;case"worksheet":if(o[1]==="/"){if((f=l.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"));h.push(d),S.s.r<=S.e.r&&S.s.c<=S.e.c&&(u["!ref"]=lt(S),t.sheetRows&&t.sheetRows<=S.e.r&&(u["!fullref"]=u["!ref"],S.e.r=t.sheetRows-1,u["!ref"]=lt(S))),k.length&&(u["!merges"]=k),ee.length>0&&(u["!cols"]=ee),ue.length>0&&(u["!rows"]=ue),c[d]=u}else S={s:{r:2e6,c:2e6},e:{r:0,c:0}},v=w=0,l.push([o[3],!1]),f=Ui(o[0]),d=At(f.Name),u=t.dense?[]:{},k=[],V=[],ue=[],W={name:d,Hidden:0},B.Sheets.push(W);break;case"table":if(o[1]==="/"){if((f=l.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),ee=[],xe=!1}break;case"style":o[1]==="/"?PB(y,b,t):b=Ui(o[0]);break;case"numberformat":b.nf=At(Ui(o[0]).Format||"General"),ac[b.nf]&&(b.nf=ac[b.nf]);for(var fe=0;fe!=392&&Ke[fe]!=b.nf;++fe);if(fe==392){for(fe=57;fe!=392;++fe)if(Ke[fe]==null){ks(b.nf,fe);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(ae=Ui(o[0]),ae.Hidden&&(ae.hidden=!0,delete ae.Hidden),ae.Width&&(ae.wpx=parseInt(ae.Width,10)),!xe&&ae.wpx>10){xe=!0,yn=eT;for(var de=0;de<ee.length;++de)ee[de]&&Qa(ee[de])}xe&&Qa(ae),ee[ae.Index-1||ee.length]=ae;for(var Ue=0;Ue<+ae.Span;++Ue)ee[ee.length]=jt(ae);break;case"namedrange":if(o[1]==="/")break;B.Names||(B.Names=[]);var q=tt(o[0]),ze={Name:q.Name,Ref:ml(q.RefersTo.slice(1),{r:0,c:0})};B.Sheets.length>0&&(ze.Sheet=B.Sheets.length-1),B.Names.push(ze);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?x+=n.slice(A,o.index):A=o.index+o[0].length;break;case"interior":if(!t.cellStyles)break;b.Interior=Ui(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?n$(E,K,n.slice(_,o.index)):_=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((f=l.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((f=l.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"));QB(z),Z.push(z)}else l.push([o[3],!1]),f=Ui(o[0]),z={a:f.Author};break;case"autofilter":if(o[1]==="/"){if((f=l.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var Qe=Ui(o[0]);u["!autofilter"]={ref:ml(Qe.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((f=l.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((f=l.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return By(n,t);var De=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:De=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:De=!1}break;case"excelworkbook":switch(o[3]){case"date1904":B.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:De=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:De=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(_,o.index)){case"SheetHidden":W.Hidden=1;break;case"SheetVeryHidden":W.Hidden=2;break}else _=o.index+o[0].length;break;case"header":u["!margins"]||vo(u["!margins"]={},"xlml"),isNaN(+tt(o[0]).Margin)||(u["!margins"].header=+tt(o[0]).Margin);break;case"footer":u["!margins"]||vo(u["!margins"]={},"xlml"),isNaN(+tt(o[0]).Margin)||(u["!margins"].footer=+tt(o[0]).Margin);break;case"pagemargins":var Fe=tt(o[0]);u["!margins"]||vo(u["!margins"]={},"xlml"),isNaN(+Fe.Top)||(u["!margins"].top=+Fe.Top),isNaN(+Fe.Left)||(u["!margins"].left=+Fe.Left),isNaN(+Fe.Right)||(u["!margins"].right=+Fe.Right),isNaN(+Fe.Bottom)||(u["!margins"].bottom=+Fe.Bottom);break;case"displayrighttoleft":B.Views||(B.Views=[]),B.Views[0]||(B.Views[0]={}),B.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":u["!outline"]||(u["!outline"]={}),u["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":u["!outline"]||(u["!outline"]={}),u["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:De=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:De=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:De=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:De=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:De=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:De=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:De=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:De=!1}break;case"smarttags":break;default:De=!1;break}if(De||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?AB(T,K,N,n.slice(_,o.index)):(N=o,_=o.index+o[0].length);break}if(t.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var ve={};return!t.bookSheets&&!t.bookProps&&(ve.Sheets=c),ve.SheetNames=h,ve.Workbook=B,ve.SSF=jt(Ke),ve.Props=E,ve.Custprops=T,ve}function Zm(r,e){switch(ZO(e=e||{}),e.type||"base64"){case"base64":return cp(gi(r),e);case"binary":case"buffer":case"file":return cp(r,e);case"array":return cp(Xa(r),e)}}function FB(r,e){var t=[];return r.Props&&t.push(i$(r.Props,e)),r.Custprops&&t.push(s$(r.Props,r.Custprops)),t.join("")}function $B(){return""}function DB(r,e){var t=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,i){var s=[];s.push($e("NumberFormat",null,{"ss:Format":Bt(Ke[n.numFmtId])}));var a={"ss:ID":"s"+(21+i)};t.push($e("Style",s.join(""),a))}),$e("Styles",t.join(""))}function AT(r){return $e("NamedRange",null,{"ss:Name":r.Name,"ss:RefersTo":"="+$O(r.Ref,{r:0,c:0})})}function NB(r){if(!((r||{}).Workbook||{}).Names)return"";for(var e=r.Workbook.Names,t=[],n=0;n<e.length;++n){var i=e[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||t.push(AT(i)))}return $e("Names",t.join(""))}function MB(r,e,t,n){if(!r||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,s=[],a=0;a<i.length;++a){var o=i[a];o.Sheet==t&&(o.Name.match(/^_xlfn\./)||s.push(AT(o)))}return s.join("")}function IB(r,e,t,n){if(!r)return"";var i=[];if(r["!margins"]&&(i.push("<PageSetup>"),r["!margins"].header&&i.push($e("Header",null,{"x:Margin":r["!margins"].header})),r["!margins"].footer&&i.push($e("Footer",null,{"x:Margin":r["!margins"].footer})),i.push($e("PageMargins",null,{"x:Bottom":r["!margins"].bottom||"0.75","x:Left":r["!margins"].left||"0.7","x:Right":r["!margins"].right||"0.7","x:Top":r["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[t])if(n.Workbook.Sheets[t].Hidden)i.push($e("Visible",n.Workbook.Sheets[t].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<t&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==t&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),r["!protect"]&&(i.push(un("ProtectContents","True")),r["!protect"].objects&&i.push(un("ProtectObjects","True")),r["!protect"].scenarios&&i.push(un("ProtectScenarios","True")),r["!protect"].selectLockedCells!=null&&!r["!protect"].selectLockedCells?i.push(un("EnableSelection","NoSelection")):r["!protect"].selectUnlockedCells!=null&&!r["!protect"].selectUnlockedCells&&i.push(un("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){r["!protect"][a[0]]&&i.push("<"+a[1]+"/>")})),i.length==0?"":$e("WorksheetOptions",i.join(""),{xmlns:ai.x})}function LB(r){return r.map(function(e){var t=oF(e.t||""),n=$e("ss:Data",t,{xmlns:"http://www.w3.org/TR/REC-html40"});return $e("Comment",n,{"ss:Author":e.a})}).join("")}function BB(r,e,t,n,i,s,a){if(!r||r.v==null&&r.f==null)return"";var o={};if(r.f&&(o["ss:Formula"]="="+Bt($O(r.f,a))),r.F&&r.F.slice(0,e.length)==e){var l=xr(r.F.slice(e.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==a.r?"":"["+(l.r-a.r)+"]")+"C"+(l.c==a.c?"":"["+(l.c-a.c)+"]")}if(r.l&&r.l.Target&&(o["ss:HRef"]=Bt(r.l.Target),r.l.Tooltip&&(o["x:HRefScreenTip"]=Bt(r.l.Tooltip))),t["!merges"])for(var f=t["!merges"],c=0;c!=f.length;++c)f[c].s.c!=a.c||f[c].s.r!=a.r||(f[c].e.c>f[c].s.c&&(o["ss:MergeAcross"]=f[c].e.c-f[c].s.c),f[c].e.r>f[c].s.r&&(o["ss:MergeDown"]=f[c].e.r-f[c].s.r));var h="",u="";switch(r.t){case"z":if(!n.sheetStubs)return"";break;case"n":h="Number",u=String(r.v);break;case"b":h="Boolean",u=r.v?"1":"0";break;case"e":h="Error",u=sa[r.v];break;case"d":h="DateTime",u=new Date(r.v).toISOString(),r.z==null&&(r.z=r.z||Ke[14]);break;case"s":h="String",u=aF(r.v||"");break}var d=qa(n.cellXfs,r,n);o["ss:StyleID"]="s"+(21+d),o["ss:Index"]=a.c+1;var p=r.v!=null?u:"",m=r.t=="z"?"":'<Data ss:Type="'+h+'">'+p+"</Data>";return(r.c||[]).length>0&&(m+=LB(r.c)),$e("Cell",m,o)}function ZB(r,e){var t='<Row ss:Index="'+(r+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=Pl(e.hpt)),e.hpx&&(t+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(t+=' ss:Hidden="1"')),t+">"}function WB(r,e,t,n){if(!r["!ref"])return"";var i=yt(r["!ref"]),s=r["!merges"]||[],a=0,o=[];r["!cols"]&&r["!cols"].forEach(function(g,O){Qa(g);var w=!!g.width,v=b0(O,g),S={"ss:Index":O+1};w&&(S["ss:Width"]=kc(v.width)),g.hidden&&(S["ss:Hidden"]="1"),o.push($e("Column",null,S))});for(var l=Array.isArray(r),f=i.s.r;f<=i.e.r;++f){for(var c=[ZB(f,(r["!rows"]||[])[f])],h=i.s.c;h<=i.e.c;++h){var u=!1;for(a=0;a!=s.length;++a)if(!(s[a].s.c>h)&&!(s[a].s.r>f)&&!(s[a].e.c<h)&&!(s[a].e.r<f)){(s[a].s.c!=h||s[a].s.r!=f)&&(u=!0);break}if(!u){var d={r:f,c:h},p=et(d),m=l?(r[f]||[])[h]:r[p];c.push(BB(m,p,r,e,t,n,d))}}c.push("</Row>"),c.length>2&&o.push(c.join(""))}return o.join("")}function UB(r,e,t){var n=[],i=t.SheetNames[r],s=t.Sheets[i],a=s?MB(s,e,r,t):"";return a.length>0&&n.push("<Names>"+a+"</Names>"),a=s?WB(s,e,r,t):"",a.length>0&&n.push("<Table>"+a+"</Table>"),n.push(IB(s,e,r,t)),n.join("")}function XB(r,e){e||(e={}),r.SSF||(r.SSF=jt(Ke)),r.SSF&&(ef(),hh(r.SSF),e.revssf=g0(r.SSF),e.revssf[r.SSF[65535]]=0,e.ssf=r.SSF,e.cellXfs=[],qa(e.cellXfs,{},{revssf:{General:0}}));var t=[];t.push(FB(r,e)),t.push($B()),t.push(""),t.push("");for(var n=0;n<r.SheetNames.length;++n)t.push($e("Worksheet",UB(n,e,r),{"ss:Name":Bt(r.SheetNames[n])}));return t[2]=DB(r,e),t[3]=NB(r),Fr+$e("Workbook",t.join(""),{xmlns:ai.ss,"xmlns:o":ai.o,"xmlns:x":ai.x,"xmlns:ss":ai.ss,"xmlns:dt":ai.dt,"xmlns:html":ai.html})}function VB(r){var e={},t=r.content;if(t.l=28,e.AnsiUserType=t.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=MF(t),t.length-t.l<=4)return e;var n=t.read_shift(4);if(n==0||n>40||(t.l-=4,e.Reserved1=t.read_shift(0,"lpstr-ansi"),t.length-t.l<=4)||(n=t.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=IF(t),n=t.read_shift(4),n==0||n>40))return e;t.l-=4,e.Reserved2=t.read_shift(0,"lpwstr")}var qB=[60,1084,2066,2165,2175];function jB(r,e,t,n,i){var s=n,a=[],o=t.slice(t.l,t.l+s);if(i.enc&&i.enc.insitu&&o.length>0)switch(r){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(o)}a.push(o),t.l+=s;for(var l=qs(t,t.l),f=Wm[l],c=0;f!=null&&qB.indexOf(l)>-1;)s=qs(t,t.l+2),c=t.l+4,l==2066?c+=4:(l==2165||l==2175)&&(c+=12),o=t.slice(c,t.l+4+s),a.push(o),t.l+=4+s,f=Wm[l=qs(t,t.l)];var h=Kr(a);sn(h,0);var u=0;h.lens=[];for(var d=0;d<a.length;++d)h.lens.push(u),u+=a[d].length;if(h.length<n)throw"XLS Record 0x"+r.toString(16)+" Truncated: "+h.length+" < "+n;return e.f(h,h.length,i)}function fs(r,e,t){if(r.t!=="z"&&r.XF){var n=0;try{n=r.z||r.XF.numFmtId||0,e.cellNF&&(r.z=Ke[n])}catch(s){if(e.WTF)throw s}if(!e||e.cellText!==!1)try{r.t==="e"?r.w=r.w||sa[r.v]:n===0||n=="General"?r.t==="n"?(r.v|0)===r.v?r.w=r.v.toString(10):r.w=xc(r.v):r.w=So(r.v):r.w=Oi(n,r.v,{date1904:!!t,dateNF:e&&e.dateNF})}catch(s){if(e.WTF)throw s}if(e.cellDates&&n&&r.t=="n"&&Io(Ke[n]||String(n))){var i=ba(r.v);i&&(r.t="d",r.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function Xh(r,e,t){return{v:r,ixfe:e,t}}function zB(r,e){var t={opts:{}},n={},i=e.dense?[]:{},s={},a={},o=null,l=[],f="",c={},h,u="",d,p,m,g,O={},w=[],v,S,y=[],b=[],x={Sheets:[],WBProps:{date1904:!1},Views:[{}]},A={},k=function(at){return at<8?go[at]:at<64&&b[at-8]||go[at]},E=function(at,Mt,jr){var Gt=Mt.XF.data;if(!(!Gt||!Gt.patternType||!jr||!jr.cellStyles)){Mt.s={},Mt.s.patternType=Gt.patternType;var Bi;(Bi=_c(k(Gt.icvFore)))&&(Mt.s.fgColor={rgb:Bi}),(Bi=_c(k(Gt.icvBack)))&&(Mt.s.bgColor={rgb:Bi})}},T=function(at,Mt,jr){if(!(ie>1)&&!(jr.sheetRows&&at.r>=jr.sheetRows)){if(jr.cellStyles&&Mt.XF&&Mt.XF.data&&E(at,Mt,jr),delete Mt.ixfe,delete Mt.XF,h=at,u=et(at),(!a||!a.s||!a.e)&&(a={s:{r:0,c:0},e:{r:0,c:0}}),at.r<a.s.r&&(a.s.r=at.r),at.c<a.s.c&&(a.s.c=at.c),at.r+1>a.e.r&&(a.e.r=at.r+1),at.c+1>a.e.c&&(a.e.c=at.c+1),jr.cellFormula&&Mt.f){for(var Gt=0;Gt<w.length;++Gt)if(!(w[Gt][0].s.c>at.c||w[Gt][0].s.r>at.r)&&!(w[Gt][0].e.c<at.c||w[Gt][0].e.r<at.r)){Mt.F=lt(w[Gt][0]),(w[Gt][0].s.c!=at.c||w[Gt][0].s.r!=at.r)&&delete Mt.f,Mt.f&&(Mt.f=""+xn(w[Gt][1],a,at,V,_));break}}jr.dense?(i[at.r]||(i[at.r]=[]),i[at.r][at.c]=Mt):i[u]=Mt}},_={enc:!1,sbcch:0,snames:[],sharedf:O,arrayf:w,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(_.password=e.password);var N,Z=[],z=[],ee=[],ae=[],xe=!1,V=[];V.SheetNames=_.snames,V.sharedf=_.sharedf,V.arrayf=_.arrayf,V.names=[],V.XTI=[];var ue=0,ie=0,P=0,I=[],B=[],W;_.codepage=1200,Ei(1200);for(var K=!1;r.l<r.length-1;){var re=r.l,pe=r.read_shift(2);if(pe===0&&ue===10)break;var fe=r.l===r.length?0:r.read_shift(2),de=Wm[pe];if(de&&de.f){if(e.bookSheets&&ue===133&&pe!==133)break;if(ue=pe,de.r===2||de.r==12){var Ue=r.read_shift(2);if(fe-=2,!_.enc&&Ue!==pe&&((Ue&255)<<8|Ue>>8)!==pe)throw new Error("rt mismatch: "+Ue+"!="+pe);de.r==12&&(r.l+=10,fe-=10)}var q={};if(pe===10?q=de.f(r,fe,_):q=jB(pe,de,r,fe,_),ie==0&&[9,521,1033,2057].indexOf(ue)===-1)continue;switch(pe){case 34:t.opts.Date1904=x.WBProps.date1904=q;break;case 134:t.opts.WriteProtect=!0;break;case 47:if(_.enc||(r.l=0),_.enc=q,!e.password)throw new Error("File is password-protected");if(q.valid==null)throw new Error("Encryption scheme unsupported");if(!q.valid)throw new Error("Password is incorrect");break;case 92:_.lastuser=q;break;case 66:var ze=Number(q);switch(ze){case 21010:ze=1200;break;case 32768:ze=1e4;break;case 32769:ze=1252;break}Ei(_.codepage=ze),K=!0;break;case 317:_.rrtabid=q;break;case 25:_.winlocked=q;break;case 439:t.opts.RefreshAll=q;break;case 12:t.opts.CalcCount=q;break;case 16:t.opts.CalcDelta=q;break;case 17:t.opts.CalcIter=q;break;case 13:t.opts.CalcMode=q;break;case 14:t.opts.CalcPrecision=q;break;case 95:t.opts.CalcSaveRecalc=q;break;case 15:_.CalcRefMode=q;break;case 2211:t.opts.FullCalc=q;break;case 129:q.fDialog&&(i["!type"]="dialog"),q.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),q.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:y.push(q);break;case 430:V.push([q]),V[V.length-1].XTI=[];break;case 35:case 547:V[V.length-1].push(q);break;case 24:case 536:W={Name:q.Name,Ref:xn(q.rgce,a,null,V,_)},q.itab>0&&(W.Sheet=q.itab-1),V.names.push(W),V[0]||(V[0]=[],V[0].XTI=[]),V[V.length-1].push(q),q.Name=="_xlnm._FilterDatabase"&&q.itab>0&&q.rgce&&q.rgce[0]&&q.rgce[0][0]&&q.rgce[0][0][0]=="PtgArea3d"&&(B[q.itab-1]={ref:lt(q.rgce[0][0][1][2])});break;case 22:_.ExternCount=q;break;case 23:V.length==0&&(V[0]=[],V[0].XTI=[]),V[V.length-1].XTI=V[V.length-1].XTI.concat(q),V.XTI=V.XTI.concat(q);break;case 2196:if(_.biff<8)break;W!=null&&(W.Comment=q[1]);break;case 18:i["!protect"]=q;break;case 19:q!==0&&_.WTF&&console.error("Password verifier: "+q);break;case 133:s[q.pos]=q,_.snames.push(q.name);break;case 10:{if(--ie)break;if(a.e){if(a.e.r>0&&a.e.c>0){if(a.e.r--,a.e.c--,i["!ref"]=lt(a),e.sheetRows&&e.sheetRows<=a.e.r){var Qe=a.e.r;a.e.r=e.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=lt(a),a.e.r=Qe}a.e.r++,a.e.c++}Z.length>0&&(i["!merges"]=Z),z.length>0&&(i["!objects"]=z),ee.length>0&&(i["!cols"]=ee),ae.length>0&&(i["!rows"]=ae),x.Sheets.push(A)}f===""?c=i:n[f]=i,i=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(_.biff===8&&(_.biff={9:2,521:3,1033:4}[pe]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[q.BIFFVer]||8),_.biffguess=q.BIFFVer==0,q.BIFFVer==0&&q.dt==4096&&(_.biff=5,K=!0,Ei(_.codepage=28591)),_.biff==8&&q.BIFFVer==0&&q.dt==16&&(_.biff=2),ie++)break;if(i=e.dense?[]:{},_.biff<8&&!K&&(K=!0,Ei(_.codepage=e.codepage||1252)),_.biff<5||q.BIFFVer==0&&q.dt==4096){f===""&&(f="Sheet1"),a={s:{r:0,c:0},e:{r:0,c:0}};var De={pos:r.l-fe,name:f};s[De.pos]=De,_.snames.push(f)}else f=(s[re]||{name:""}).name;q.dt==32&&(i["!type"]="chart"),q.dt==64&&(i["!type"]="macro"),Z=[],z=[],_.arrayf=w=[],ee=[],ae=[],xe=!1,A={Hidden:(s[re]||{hs:0}).hs,name:f}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(e.dense?(i[q.r]||[])[q.c]:i[et({c:q.c,r:q.r})])&&++q.c,v={ixfe:q.ixfe,XF:y[q.ixfe]||{},v:q.val,t:"n"},P>0&&(v.z=I[v.ixfe>>8&63]),fs(v,e,t.opts.Date1904),T({c:q.c,r:q.r},v,e);break;case 5:case 517:v={ixfe:q.ixfe,XF:y[q.ixfe],v:q.val,t:q.t},P>0&&(v.z=I[v.ixfe>>8&63]),fs(v,e,t.opts.Date1904),T({c:q.c,r:q.r},v,e);break;case 638:v={ixfe:q.ixfe,XF:y[q.ixfe],v:q.rknum,t:"n"},P>0&&(v.z=I[v.ixfe>>8&63]),fs(v,e,t.opts.Date1904),T({c:q.c,r:q.r},v,e);break;case 189:for(var Fe=q.c;Fe<=q.C;++Fe){var ve=q.rkrec[Fe-q.c][0];v={ixfe:ve,XF:y[ve],v:q.rkrec[Fe-q.c][1],t:"n"},P>0&&(v.z=I[v.ixfe>>8&63]),fs(v,e,t.opts.Date1904),T({c:Fe,r:q.r},v,e)}break;case 6:case 518:case 1030:{if(q.val=="String"){o=q;break}if(v=Xh(q.val,q.cell.ixfe,q.tt),v.XF=y[v.ixfe],e.cellFormula){var it=q.formula;if(it&&it[0]&&it[0][0]&&it[0][0][0]=="PtgExp"){var ot=it[0][0][1][0],bt=it[0][0][1][1],$t=et({r:ot,c:bt});O[$t]?v.f=""+xn(q.formula,a,q.cell,V,_):v.F=((e.dense?(i[ot]||[])[bt]:i[$t])||{}).F}else v.f=""+xn(q.formula,a,q.cell,V,_)}P>0&&(v.z=I[v.ixfe>>8&63]),fs(v,e,t.opts.Date1904),T(q.cell,v,e),o=q}break;case 7:case 519:if(o)o.val=q,v=Xh(q,o.cell.ixfe,"s"),v.XF=y[v.ixfe],e.cellFormula&&(v.f=""+xn(o.formula,a,o.cell,V,_)),P>0&&(v.z=I[v.ixfe>>8&63]),fs(v,e,t.opts.Date1904),T(o.cell,v,e),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{w.push(q);var Ce=et(q[0].s);if(d=e.dense?(i[q[0].s.r]||[])[q[0].s.c]:i[Ce],e.cellFormula&&d){if(!o||!Ce||!d)break;d.f=""+xn(q[1],a,q[0],V,_),d.F=lt(q[0])}}break;case 1212:{if(!e.cellFormula)break;if(u){if(!o)break;O[et(o.cell)]=q[0],d=e.dense?(i[o.cell.r]||[])[o.cell.c]:i[et(o.cell)],(d||{}).f=""+xn(q[0],a,h,V,_)}}break;case 253:v=Xh(l[q.isst].t,q.ixfe,"s"),l[q.isst].h&&(v.h=l[q.isst].h),v.XF=y[v.ixfe],P>0&&(v.z=I[v.ixfe>>8&63]),fs(v,e,t.opts.Date1904),T({c:q.c,r:q.r},v,e);break;case 513:e.sheetStubs&&(v={ixfe:q.ixfe,XF:y[q.ixfe],t:"z"},P>0&&(v.z=I[v.ixfe>>8&63]),fs(v,e,t.opts.Date1904),T({c:q.c,r:q.r},v,e));break;case 190:if(e.sheetStubs)for(var Ve=q.c;Ve<=q.C;++Ve){var Ae=q.ixfe[Ve-q.c];v={ixfe:Ae,XF:y[Ae],t:"z"},P>0&&(v.z=I[v.ixfe>>8&63]),fs(v,e,t.opts.Date1904),T({c:Ve,r:q.r},v,e)}break;case 214:case 516:case 4:v=Xh(q.val,q.ixfe,"s"),v.XF=y[v.ixfe],P>0&&(v.z=I[v.ixfe>>8&63]),fs(v,e,t.opts.Date1904),T({c:q.c,r:q.r},v,e);break;case 0:case 512:ie===1&&(a=q);break;case 252:l=q;break;case 1054:if(_.biff==4){I[P++]=q[1];for(var Te=0;Te<P+163&&Ke[Te]!=q[1];++Te);Te>=163&&ks(q[1],P+163)}else ks(q[1],q[0]);break;case 30:{I[P++]=q;for(var Re=0;Re<P+163&&Ke[Re]!=q;++Re);Re>=163&&ks(q,P+163)}break;case 229:Z=Z.concat(q);break;case 93:z[q.cmo[0]]=_.lastobj=q;break;case 438:_.lastobj.TxO=q;break;case 127:_.lastobj.ImData=q;break;case 440:for(g=q[0].s.r;g<=q[0].e.r;++g)for(m=q[0].s.c;m<=q[0].e.c;++m)d=e.dense?(i[g]||[])[m]:i[et({c:m,r:g})],d&&(d.l=q[1]);break;case 2048:for(g=q[0].s.r;g<=q[0].e.r;++g)for(m=q[0].s.c;m<=q[0].e.c;++m)d=e.dense?(i[g]||[])[m]:i[et({c:m,r:g})],d&&d.l&&(d.l.Tooltip=q[1]);break;case 28:{if(_.biff<=5&&_.biff>=2)break;d=e.dense?(i[q[0].r]||[])[q[0].c]:i[et(q[0])];var Nt=z[q[2]];d||(e.dense?(i[q[0].r]||(i[q[0].r]=[]),d=i[q[0].r][q[0].c]={t:"z"}):d=i[et(q[0])]={t:"z"},a.e.r=Math.max(a.e.r,q[0].r),a.s.r=Math.min(a.s.r,q[0].r),a.e.c=Math.max(a.e.c,q[0].c),a.s.c=Math.min(a.s.c,q[0].c)),d.c||(d.c=[]),p={a:q[1],t:Nt.TxO.t},d.c.push(p)}break;case 2173:N6(y[q.ixfe],q.ext);break;case 125:{if(!_.cellStyles)break;for(;q.e>=q.s;)ee[q.e--]={width:q.w/256,level:q.level||0,hidden:!!(q.flags&1)},xe||(xe=!0,RO(q.w/256)),Qa(ee[q.e+1])}break;case 520:{var yr={};q.level!=null&&(ae[q.r]=yr,yr.level=q.level),q.hidden&&(ae[q.r]=yr,yr.hidden=!0),q.hpt&&(ae[q.r]=yr,yr.hpt=q.hpt,yr.hpx=Pl(q.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||vo(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[pe]]=q;break;case 161:i["!margins"]||vo(i["!margins"]={}),i["!margins"].header=q.header,i["!margins"].footer=q.footer;break;case 574:q.RTL&&(x.Views[0].RTL=!0);break;case 146:b=q;break;case 2198:N=q;break;case 140:S=q;break;case 442:f?A.CodeName=q||A.name:x.WBProps.CodeName=q||"ThisWorkbook";break}}else de||console.error("Missing Info for XLS Record 0x"+pe.toString(16)),r.l+=fe}return t.SheetNames=Tr(s).sort(function(qr,at){return Number(qr)-Number(at)}).map(function(qr){return s[qr].name}),e.bookSheets||(t.Sheets=n),!t.SheetNames.length&&c["!ref"]?(t.SheetNames.push("Sheet1"),t.Sheets&&(t.Sheets.Sheet1=c)):t.Preamble=c,t.Sheets&&B.forEach(function(qr,at){t.Sheets[t.SheetNames[at]]["!autofilter"]=qr}),t.Strings=l,t.SSF=jt(Ke),_.enc&&(t.Encryption=_.enc),N&&(t.Themes=N),t.Metadata={},S!==void 0&&(t.Metadata.Country=S),V.names.length>0&&(x.Names=V.names),t.Workbook=x,t}var oc={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function GB(r,e,t){var n=Ye.find(r,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=gy(n,Dm,oc.DSI);for(var s in i)e[s]=i[s]}catch(f){if(t.WTF)throw f}var a=Ye.find(r,"/!SummaryInformation");if(a&&a.size>0)try{var o=gy(a,Nm,oc.SI);for(var l in o)e[l]==null&&(e[l]=o[l])}catch(f){if(t.WTF)throw f}e.HeadingPairs&&e.TitlesOfParts&&(TS(e.HeadingPairs,e.TitlesOfParts,e,t),delete e.HeadingPairs,delete e.TitlesOfParts)}function HB(r,e){var t=[],n=[],i=[],s=0,a,o=qv(Dm,"n"),l=qv(Nm,"n");if(r.Props)for(a=Tr(r.Props),s=0;s<a.length;++s)(Object.prototype.hasOwnProperty.call(o,a[s])?t:Object.prototype.hasOwnProperty.call(l,a[s])?n:i).push([a[s],r.Props[a[s]]]);if(r.Custprops)for(a=Tr(r.Custprops),s=0;s<a.length;++s)Object.prototype.hasOwnProperty.call(r.Props||{},a[s])||(Object.prototype.hasOwnProperty.call(o,a[s])?t:Object.prototype.hasOwnProperty.call(l,a[s])?n:i).push([a[s],r.Custprops[a[s]]]);var f=[];for(s=0;s<i.length;++s)FS.indexOf(i[s][0])>-1||SS.indexOf(i[s][0])>-1||i[s][1]!=null&&f.push(i[s]);n.length&&Ye.utils.cfb_add(e,"/SummaryInformation",Oy(n,oc.SI,l,Nm)),(t.length||f.length)&&Ye.utils.cfb_add(e,"/DocumentSummaryInformation",Oy(t,oc.DSI,o,Dm,f.length?f:null,oc.UDI))}function LO(r,e){e||(e={}),ZO(e),p0(),e.codepage&&d0(e.codepage);var t,n;if(r.FullPaths){if(Ye.find(r,"/encryption"))throw new Error("File is password-protected");t=Ye.find(r,"!CompObj"),n=Ye.find(r,"/Workbook")||Ye.find(r,"/Book")}else{switch(e.type){case"base64":r=oi(gi(r));break;case"binary":r=oi(r);break;case"buffer":break;case"array":Array.isArray(r)||(r=Array.prototype.slice.call(r));break}sn(r,0),n={content:r}}var i,s;if(t&&VB(t),e.bookProps&&!e.bookSheets)i={};else{var a=dt?"buffer":"array";if(n&&n.content)i=zB(n.content,e);else if((s=Ye.find(r,"PerfectOffice_MAIN"))&&s.content)i=xo.to_workbook(s.content,(e.type=a,e));else if((s=Ye.find(r,"NativeContent_MAIN"))&&s.content)i=xo.to_workbook(s.content,(e.type=a,e));else throw(s=Ye.find(r,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&r.FullPaths&&Ye.find(r,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=c8(r))}var o={};return r.FullPaths&&GB(r,o,e),i.Props=i.Custprops=o,e.bookFiles&&(i.cfb=r),i}function YB(r,e){var t=e,n=Ye.utils.cfb_new({root:"R"}),i="/Workbook";switch(t.bookType||"xls"){case"xls":t.bookType="biff8";case"xla":t.bookType||(t.bookType="xla");case"biff8":i="/Workbook",t.biff=8;break;case"biff5":i="/Book",t.biff=5;break;default:throw new Error("invalid type "+t.bookType+" for XLS CFB")}return Ye.utils.cfb_add(n,i,ET(r,t)),t.biff==8&&(r.Props||r.Custprops)&&HB(r,n),t.biff==8&&r.vbaraw&&h8(n,Ye.read(r.vbaraw,{type:typeof r.vbaraw=="string"?"binary":"buffer"})),n}var Cc={0:{f:bI},1:{f:PI},2:{f:GI},3:{f:II},4:{f:$I},5:{f:qI},6:{f:eL},7:{f:WI},8:{f:oL},9:{f:aL},10:{f:iL},11:{f:sL},12:{f:QI},13:{f:YI},14:{f:BI},15:{f:NI},16:{f:yT},17:{f:rL},18:{f:XI},19:{f:wO},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:tB},40:{},42:{},43:{f:e6},44:{f:KN},45:{f:n6},46:{f:s6},47:{f:i6},48:{},49:{f:SF},50:{},51:{f:L6},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:XS},62:{f:JI},63:{f:z6},64:{f:_L},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Cn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:vL},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:AI},148:{f:SI,p:16},151:{f:dL},152:{},153:{f:KL},154:{},155:{},156:{f:HL},157:{},158:{},159:{T:1,f:mN},160:{T:-1},161:{T:1,f:Uo},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:lL},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:M6},336:{T:-1},337:{f:W6,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:$m},357:{},358:{},359:{},360:{T:1},361:{},362:{f:US},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:pL},427:{f:mL},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:OL},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:CI},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:hL},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:$m},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:s8},633:{T:1},634:{T:-1},635:{T:1,f:n8},636:{T:-1},637:{f:EF},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:BL},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:kL},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Wm={6:{f:lp},10:{f:da},12:{f:Mr},13:{f:Mr},14:{f:Pr},15:{f:Pr},16:{f:bn},17:{f:Pr},18:{f:Pr},19:{f:Mr},20:{f:_y},21:{f:_y},23:{f:US},24:{f:Sy},25:{f:Pr},26:{},27:{},28:{f:kD},29:{},34:{f:Pr},35:{f:ky},38:{f:bn},39:{f:bn},40:{f:bn},41:{f:bn},42:{f:Pr},43:{f:Pr},47:{f:NN},49:{f:Y$},51:{f:Mr},60:{},61:{f:q$},64:{f:Pr},65:{f:H$},66:{f:Mr},77:{},80:{},81:{},82:{},85:{f:Mr},89:{},90:{},91:{},92:{f:D$},93:{f:CD},94:{},95:{f:Pr},96:{},97:{},99:{f:Pr},125:{f:XS},128:{f:uD},129:{f:M$},130:{f:Mr},131:{f:Pr},132:{f:Pr},133:{f:I$},134:{},140:{f:DD},141:{f:Mr},144:{},146:{f:ID},151:{},152:{},153:{},154:{},155:{},156:{f:Mr},157:{},158:{},160:{f:VD},161:{f:ZD},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:lD},190:{f:fD},193:{f:da},197:{},198:{},199:{},200:{},201:{},202:{f:Pr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Mr},220:{},221:{f:Pr},222:{},224:{f:hD},225:{f:$$},226:{f:da},227:{},229:{f:SD},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:B$},253:{f:J$},255:{f:W$},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:$S},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Pr},353:{f:da},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:OD},431:{f:Pr},432:{},433:{},434:{},437:{},438:{f:PD},439:{f:Pr},440:{f:RD},441:{},442:{f:ph},443:{},444:{f:Mr},445:{},446:{},448:{f:da},449:{f:V$,r:2},450:{f:da},512:{f:yy},513:{f:XD},515:{f:mD},516:{f:tD},517:{f:by},519:{f:qD},520:{f:U$},523:{},545:{f:Ty},549:{f:vy},566:{},574:{f:z$},638:{f:oD},659:{},1048:{},1054:{f:nD},1084:{},1212:{f:wD},2048:{f:FD},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Zh},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:da},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:LD,r:12},2173:{f:D6,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Pr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:yD,r:12},2197:{},2198:{f:E6,r:12},2199:{},2200:{},2201:{},2202:{f:bD,r:12},2203:{f:da},2204:{},2205:{},2206:{},2207:{},2211:{f:X$},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Mr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:WD},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:MD},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:yy},1:{},2:{f:YD},3:{f:GD},4:{f:zD},5:{f:by},7:{f:JD},8:{},9:{f:Zh},11:{},22:{f:Mr},30:{f:sD},31:{},32:{},33:{f:Ty},36:{},37:{f:vy},50:{f:eN},62:{},52:{},67:{},68:{f:Mr},69:{},86:{},126:{},127:{f:jD},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:tN},223:{},234:{},354:{},421:{},518:{f:lp},521:{f:Zh},536:{f:Sy},547:{f:ky},561:{},579:{},1030:{f:lp},1033:{f:Zh},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Ne(r,e,t,n){var i=e;if(!isNaN(i)){var s=n||(t||[]).length||0,a=r.next(4);a.write_shift(2,i),a.write_shift(2,s),s>0&&xO(t)&&r.push(t)}}function KB(r,e,t,n){var i=(t||[]).length||0;if(i<=8224)return Ne(r,e,t,i);var s=e;if(!isNaN(s)){for(var a=t.parts||[],o=0,l=0,f=0;f+(a[o]||8224)<=8224;)f+=a[o]||8224,o++;var c=r.next(4);for(c.write_shift(2,s),c.write_shift(2,f),r.push(t.slice(l,l+f)),l+=f;l<i;){for(c=r.next(4),c.write_shift(2,60),f=0;f+(a[o]||8224)<=8224;)f+=a[o]||8224,o++;c.write_shift(2,f),r.push(t.slice(l,l+f)),l+=f}}}function xh(r,e,t){return r||(r=me(7)),r.write_shift(2,e),r.write_shift(2,t),r.write_shift(2,0),r.write_shift(1,0),r}function JB(r,e,t,n){var i=me(9);return xh(i,r,e),DS(t,n||"b",i),i}function e7(r,e,t){var n=me(8+2*t.length);return xh(n,r,e),n.write_shift(1,t.length),n.write_shift(t.length,t,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function t7(r,e,t,n){if(e.v!=null)switch(e.t){case"d":case"n":var i=e.t=="d"?Xr(or(e.v)):e.v;i==(i|0)&&i>=0&&i<65536?Ne(r,2,KD(t,n,i)):Ne(r,3,HD(t,n,i));return;case"b":case"e":Ne(r,5,JB(t,n,e.v,e.t));return;case"s":case"str":Ne(r,4,e7(t,n,(e.v||"").slice(0,255)));return}Ne(r,1,xh(null,t,n))}function r7(r,e,t,n){var i=Array.isArray(e),s=yt(e["!ref"]||"A1"),a,o="",l=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),a=lt(s)}for(var f=s.s.r;f<=s.e.r;++f){o=kr(f);for(var c=s.s.c;c<=s.e.c;++c){f===s.s.r&&(l[c]=ar(c)),a=l[c]+o;var h=i?(e[f]||[])[c]:e[a];h&&t7(r,h,f,c)}}}function n7(r,e){for(var t=e||{},n=Kn(),i=0,s=0;s<r.SheetNames.length;++s)r.SheetNames[s]==t.sheet&&(i=s);if(i==0&&t.sheet&&r.SheetNames[0]!=t.sheet)throw new Error("Sheet not found: "+t.sheet);return Ne(n,t.biff==4?1033:t.biff==3?521:9,AO(r,16,t)),r7(n,r.Sheets[r.SheetNames[i]],i,t),Ne(n,10),n.end()}function i7(r,e,t){Ne(r,49,K$({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},t))}function s7(r,e,t){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&Ne(r,1054,iD(i,e[i],t))})}function a7(r,e){var t=me(19);t.write_shift(4,2151),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,1),t.write_shift(4,0),Ne(r,2151,t),t=me(39),t.write_shift(4,2152),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(2,1),t.write_shift(4,4),t.write_shift(2,0),BS(yt(e["!ref"]||"A1"),t),t.write_shift(4,4),Ne(r,2152,t)}function o7(r,e){for(var t=0;t<16;++t)Ne(r,224,wy({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){Ne(r,224,wy(n,0,e))})}function l7(r,e){for(var t=0;t<e["!links"].length;++t){var n=e["!links"][t];Ne(r,440,QD(n)),n[1].Tooltip&&Ne(r,2048,$D(n))}delete e["!links"]}function f7(r,e){if(e){var t=0;e.forEach(function(n,i){++t<=256&&n&&Ne(r,125,BD(b0(i,n),i))})}}function c7(r,e,t,n,i){var s=16+qa(i.cellXfs,e,i);if(e.v==null&&!e.bf){Ne(r,513,Eo(t,n,s));return}if(e.bf)Ne(r,6,MM(e,t,n,i,s));else switch(e.t){case"d":case"n":var a=e.t=="d"?Xr(or(e.v)):e.v;Ne(r,515,gD(t,n,a,s));break;case"b":case"e":Ne(r,517,pD(t,n,e.v,s,i,e.t));break;case"s":case"str":if(i.bookSST){var o=NO(i.Strings,e.v,i.revStrings);Ne(r,253,eD(t,n,o,s))}else Ne(r,516,rD(t,n,(e.v||"").slice(0,255),s,i));break;default:Ne(r,513,Eo(t,n,s))}}function h7(r,e,t){var n=Kn(),i=t.SheetNames[r],s=t.Sheets[i]||{},a=(t||{}).Workbook||{},o=(a.Sheets||[])[r]||{},l=Array.isArray(s),f=e.biff==8,c,h="",u=[],d=yt(s["!ref"]||"A1"),p=f?65536:16384;if(d.e.c>255||d.e.r>=p){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");d.e.c=Math.min(d.e.c,255),d.e.r=Math.min(d.e.c,p-1)}Ne(n,2057,AO(t,16,e)),Ne(n,13,Si(1)),Ne(n,12,Si(100)),Ne(n,15,$n(!0)),Ne(n,17,$n(!1)),Ne(n,16,Co(.001)),Ne(n,95,$n(!0)),Ne(n,42,$n(!1)),Ne(n,43,$n(!1)),Ne(n,130,Si(1)),Ne(n,128,dD()),Ne(n,131,$n(!1)),Ne(n,132,$n(!1)),f&&f7(n,s["!cols"]),Ne(n,512,aD(d,e)),f&&(s["!links"]=[]);for(var m=d.s.r;m<=d.e.r;++m){h=kr(m);for(var g=d.s.c;g<=d.e.c;++g){m===d.s.r&&(u[g]=ar(g)),c=u[g]+h;var O=l?(s[m]||[])[g]:s[c];O&&(c7(n,O,m,g,e),f&&O.l&&s["!links"].push([c,O.l]))}}var w=o.CodeName||o.name||i;return f&&Ne(n,574,G$((a.Views||[])[0])),f&&(s["!merges"]||[]).length&&Ne(n,229,TD(s["!merges"])),f&&l7(n,s),Ne(n,442,NS(w)),f&&a7(n,s),Ne(n,10),n.end()}function u7(r,e,t){var n=Kn(),i=(r||{}).Workbook||{},s=i.Sheets||[],a=i.WBProps||{},o=t.biff==8,l=t.biff==5;if(Ne(n,2057,AO(r,5,t)),t.bookType=="xla"&&Ne(n,135),Ne(n,225,o?Si(1200):null),Ne(n,193,p$(2)),l&&Ne(n,191),l&&Ne(n,192),Ne(n,226),Ne(n,92,N$("SheetJS",t)),Ne(n,66,Si(o?1200:1252)),o&&Ne(n,353,Si(0)),o&&Ne(n,448),Ne(n,317,UD(r.SheetNames.length)),o&&r.vbaraw&&Ne(n,211),o&&r.vbaraw){var f=a.CodeName||"ThisWorkbook";Ne(n,442,NS(f))}Ne(n,156,Si(17)),Ne(n,25,$n(!1)),Ne(n,18,$n(!1)),Ne(n,19,Si(0)),o&&Ne(n,431,$n(!1)),o&&Ne(n,444,Si(0)),Ne(n,61,j$()),Ne(n,64,$n(!1)),Ne(n,141,Si(0)),Ne(n,34,$n(VL(r)=="true")),Ne(n,14,$n(!0)),o&&Ne(n,439,$n(!1)),Ne(n,218,Si(0)),i7(n,r,t),s7(n,r.SSF,t),o7(n,t),o&&Ne(n,352,$n(!1));var c=n.end(),h=Kn();o&&Ne(h,140,ND()),o&&t.Strings&&KB(h,252,Z$(t.Strings)),Ne(h,10);var u=h.end(),d=Kn(),p=0,m=0;for(m=0;m<r.SheetNames.length;++m)p+=(o?12:11)+(o?2:1)*r.SheetNames[m].length;var g=c.length+p+u.length;for(m=0;m<r.SheetNames.length;++m){var O=s[m]||{};Ne(d,133,L$({pos:g,hs:O.Hidden||0,dt:0,name:r.SheetNames[m]},t)),g+=e[m].length}var w=d.end();if(p!=w.length)throw new Error("BS8 "+p+" != "+w.length);var v=[];return c.length&&v.push(c),w.length&&v.push(w),u.length&&v.push(u),Kr(v)}function d7(r,e){var t=e||{},n=[];r&&!r.SSF&&(r.SSF=jt(Ke)),r&&r.SSF&&(ef(),hh(r.SSF),t.revssf=g0(r.SSF),t.revssf[r.SSF[65535]]=0,t.ssf=r.SSF),t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,WO(t),t.cellXfs=[],qa(t.cellXfs,{},{revssf:{General:0}}),r.Props||(r.Props={});for(var i=0;i<r.SheetNames.length;++i)n[n.length]=h7(i,t,r);return n.unshift(u7(r,n,t)),Kr(n)}function ET(r,e){for(var t=0;t<=r.SheetNames.length;++t){var n=r.Sheets[r.SheetNames[t]];if(!(!n||!n["!ref"])){var i=Ln(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+r.SheetNames[t]+"' extends beyond column IV (255).  Data may be lost.")}}var s=e||{};switch(s.biff||2){case 8:case 5:return d7(r,e);case 4:case 3:case 2:return n7(r,e)}throw new Error("invalid type "+s.bookType+" for BIFF")}function Ny(r,e){var t=e,n=t.dense?[]:{};r=r.replace(/<!--.*?-->/g,"");var i=r.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var s=r.match(/<\/table/i),a=i.index,o=s&&s.index||r.length,l=KQ(r.slice(a,o),/(:?<tr[^>]*>)/i,"<tr>"),f=-1,c=0,h=0,u=0,d={s:{r:1e7,c:1e7},e:{r:0,c:0}},p=[];for(a=0;a<l.length;++a){var m=l[a].trim(),g=m.slice(0,3).toLowerCase();if(g=="<tr"){if(++f,t.sheetRows&&t.sheetRows<=f){--f;break}c=0;continue}if(!(g!="<td"&&g!="<th")){var O=m.split(/<\/t[dh]>/i);for(o=0;o<O.length;++o){var w=O[o].trim();if(w.match(/<t[dh]/i)){for(var v=w,S=0;v.charAt(0)=="<"&&(S=v.indexOf(">"))>-1;)v=v.slice(S+1);for(var y=0;y<p.length;++y){var b=p[y];b.s.c==c&&b.s.r<f&&f<=b.e.r&&(c=b.e.c+1,y=-1)}var x=tt(w.slice(0,w.indexOf(">")));u=x.colspan?+x.colspan:1,((h=+x.rowspan)>1||u>1)&&p.push({s:{r:f,c},e:{r:f+(h||1)-1,c:c+u-1}});var A=x.t||x["data-t"]||"";if(!v.length){c+=u;continue}if(v=nS(v),d.s.r>f&&(d.s.r=f),d.e.r<f&&(d.e.r=f),d.s.c>c&&(d.s.c=c),d.e.c<c&&(d.e.c=c),!v.length){c+=u;continue}var k={t:"s",v};t.raw||!v.trim().length||A=="s"||(v==="TRUE"?k={t:"b",v:!0}:v==="FALSE"?k={t:"b",v:!1}:isNaN(Yi(v))?isNaN(Al(v).getDate())||(k={t:"d",v:or(v)},t.cellDates||(k={t:"n",v:Xr(k.v)}),k.z=t.dateNF||Ke[14]):k={t:"n",v:Yi(v)}),t.dense?(n[f]||(n[f]=[]),n[f][c]=k):n[et({r:f,c})]=k,c+=u}}}}return n["!ref"]=lt(d),p.length&&(n["!merges"]=p),n}function PT(r,e,t,n){for(var i=r["!merges"]||[],s=[],a=e.s.c;a<=e.e.c;++a){for(var o=0,l=0,f=0;f<i.length;++f)if(!(i[f].s.r>t||i[f].s.c>a)&&!(i[f].e.r<t||i[f].e.c<a)){if(i[f].s.r<t||i[f].s.c<a){o=-1;break}o=i[f].e.r-i[f].s.r+1,l=i[f].e.c-i[f].s.c+1;break}if(!(o<0)){var c=et({r:t,c:a}),h=n.dense?(r[t]||[])[a]:r[c],u=h&&h.v!=null&&(h.h||hO(h.w||(As(h),h.w)||""))||"",d={};o>1&&(d.rowspan=o),l>1&&(d.colspan=l),n.editable?u='<span contenteditable="true">'+u+"</span>":h&&(d["data-t"]=h&&h.t||"z",h.v!=null&&(d["data-v"]=h.v),h.z!=null&&(d["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(u='<a href="'+h.l.Target+'">'+u+"</a>")),d.id=(n.id||"sjs")+"-"+c,s.push($e("td",u,d))}}var p="<tr>";return p+s.join("")+"</tr>"}var RT='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',QT="</body></html>";function p7(r,e){var t=r.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!t||t.length==0)throw new Error("Invalid HTML: could not find <table>");if(t.length==1)return Va(Ny(t[0],e),e);var n=jO();return t.forEach(function(i,s){zO(n,Ny(i,e),"Sheet"+(s+1))}),n}function FT(r,e,t){var n=[];return n.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function $T(r,e){var t=e||{},n=t.header!=null?t.header:RT,i=t.footer!=null?t.footer:QT,s=[n],a=Ln(r["!ref"]);t.dense=Array.isArray(r),s.push(FT(r,a,t));for(var o=a.s.r;o<=a.e.r;++o)s.push(PT(r,a,o,t));return s.push("</table>"+i),s.join("")}function DT(r,e,t){var n=t||{},i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var a=typeof n.origin=="string"?xr(n.origin):n.origin;i=a.r,s=a.c}var o=e.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),f={s:{r:0,c:0},e:{r:i,c:s}};if(r["!ref"]){var c=Ln(r["!ref"]);f.s.r=Math.min(f.s.r,c.s.r),f.s.c=Math.min(f.s.c,c.s.c),f.e.r=Math.max(f.e.r,c.e.r),f.e.c=Math.max(f.e.c,c.e.c),i==-1&&(f.e.r=i=c.e.r+1)}var h=[],u=0,d=r["!rows"]||(r["!rows"]=[]),p=0,m=0,g=0,O=0,w=0,v=0;for(r["!cols"]||(r["!cols"]=[]);p<o.length&&m<l;++p){var S=o[p];if(My(S)){if(n.display)continue;d[m]={hidden:!0}}var y=S.children;for(g=O=0;g<y.length;++g){var b=y[g];if(!(n.display&&My(b))){var x=b.hasAttribute("data-v")?b.getAttribute("data-v"):b.hasAttribute("v")?b.getAttribute("v"):nS(b.innerHTML),A=b.getAttribute("data-z")||b.getAttribute("z");for(u=0;u<h.length;++u){var k=h[u];k.s.c==O+s&&k.s.r<m+i&&m+i<=k.e.r&&(O=k.e.c+1-s,u=-1)}v=+b.getAttribute("colspan")||1,((w=+b.getAttribute("rowspan")||1)>1||v>1)&&h.push({s:{r:m+i,c:O+s},e:{r:m+i+(w||1)-1,c:O+s+(v||1)-1}});var E={t:"s",v:x},T=b.getAttribute("data-t")||b.getAttribute("t")||"";x!=null&&(x.length==0?E.t=T||"z":n.raw||x.trim().length==0||T=="s"||(x==="TRUE"?E={t:"b",v:!0}:x==="FALSE"?E={t:"b",v:!1}:isNaN(Yi(x))?isNaN(Al(x).getDate())||(E={t:"d",v:or(x)},n.cellDates||(E={t:"n",v:Xr(E.v)}),E.z=n.dateNF||Ke[14]):E={t:"n",v:Yi(x)})),E.z===void 0&&A!=null&&(E.z=A);var _="",N=b.getElementsByTagName("A");if(N&&N.length)for(var Z=0;Z<N.length&&!(N[Z].hasAttribute("href")&&(_=N[Z].getAttribute("href"),_.charAt(0)!="#"));++Z);_&&_.charAt(0)!="#"&&(E.l={Target:_}),n.dense?(r[m+i]||(r[m+i]=[]),r[m+i][O+s]=E):r[et({c:O+s,r:m+i})]=E,f.e.c<O+s&&(f.e.c=O+s),O+=v}}++m}return h.length&&(r["!merges"]=(r["!merges"]||[]).concat(h)),f.e.r=Math.max(f.e.r,m-1+i),r["!ref"]=lt(f),m>=l&&(r["!fullref"]=lt((f.e.r=o.length-p+m-1+i,f))),r}function NT(r,e){var t=e||{},n=t.dense?[]:{};return DT(n,r,e)}function m7(r,e){return Va(NT(r,e),e)}function My(r){var e="",t=g7(r);return t&&(e=t(r).getPropertyValue("display")),e||(e=r.style&&r.style.display),e==="none"}function g7(r){return r.ownerDocument.defaultView&&typeof r.ownerDocument.defaultView.getComputedStyle=="function"?r.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function O7(r){var e=r.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),t=At(e.replace(/<[^>]*>/g,""));return[t]}var Iy={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function MT(r,e){var t=e||{},n=uO(r),i=[],s,a,o={name:""},l="",f=0,c,h,u={},d=[],p=t.dense?[]:{},m,g,O={value:""},w="",v=0,S=[],y=-1,b=-1,x={s:{r:1e6,c:1e7},e:{r:0,c:0}},A=0,k={},E=[],T={},_=0,N=0,Z=[],z=1,ee=1,ae=[],xe={Names:[]},V={},ue=["",""],ie=[],P={},I="",B=0,W=!1,K=!1,re=0;for(wc.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");m=wc.exec(n);)switch(m[3]=m[3].replace(/_.*$/,"")){case"table":case"":m[1]==="/"?(x.e.c>=x.s.c&&x.e.r>=x.s.r?p["!ref"]=lt(x):p["!ref"]="A1:A1",t.sheetRows>0&&t.sheetRows<=x.e.r&&(p["!fullref"]=p["!ref"],x.e.r=t.sheetRows-1,p["!ref"]=lt(x)),E.length&&(p["!merges"]=E),Z.length&&(p["!rows"]=Z),c.name=c.||c.name,typeof JSON<"u"&&JSON.stringify(c),d.push(c.name),u[c.name]=p,K=!1):m[0].charAt(m[0].length-2)!=="/"&&(c=tt(m[0],!1),y=b=-1,x.s.r=x.s.c=1e7,x.e.r=x.e.c=0,p=t.dense?[]:{},E=[],Z=[],K=!0);break;case"table-row-group":m[1]==="/"?--A:++A;break;case"table-row":case"":if(m[1]==="/"){y+=z,z=1;break}if(h=tt(m[0],!1),h.?y=h.-1:y==-1&&(y=0),z=+h["number-rows-repeated"]||1,z<10)for(re=0;re<z;++re)A>0&&(Z[y+re]={level:A});b=-1;break;case"covered-table-cell":m[1]!=="/"&&++b,t.sheetStubs&&(t.dense?(p[y]||(p[y]=[]),p[y][b]={t:"z"}):p[et({r:y,c:b})]={t:"z"}),w="",S=[];break;case"table-cell":case"":if(m[0].charAt(m[0].length-2)==="/")++b,O=tt(m[0],!1),ee=parseInt(O["number-columns-repeated"]||"1",10),g={t:"z",v:null},O.formula&&t.cellFormula!=!1&&(g.f=Fy(At(O.formula))),(O.||O["value-type"])=="string"&&(g.t="s",g.v=At(O["string-value"]||""),t.dense?(p[y]||(p[y]=[]),p[y][b]=g):p[et({r:y,c:b})]=g),b+=ee-1;else if(m[1]!=="/"){++b,w="",v=0,S=[],ee=1;var pe=z?y+z-1:y;if(b>x.e.c&&(x.e.c=b),b<x.s.c&&(x.s.c=b),y<x.s.r&&(x.s.r=y),pe>x.e.r&&(x.e.r=pe),O=tt(m[0],!1),ie=[],P={},g={t:O.||O["value-type"],v:null},t.cellFormula)if(O.formula&&(O.formula=At(O.formula)),O["number-matrix-columns-spanned"]&&O["number-matrix-rows-spanned"]&&(_=parseInt(O["number-matrix-rows-spanned"],10)||0,N=parseInt(O["number-matrix-columns-spanned"],10)||0,T={s:{r:y,c:b},e:{r:y+_-1,c:b+N-1}},g.F=lt(T),ae.push([T,g.F])),O.formula)g.f=Fy(O.formula);else for(re=0;re<ae.length;++re)y>=ae[re][0].s.r&&y<=ae[re][0].e.r&&b>=ae[re][0].s.c&&b<=ae[re][0].e.c&&(g.F=ae[re][1]);switch((O["number-columns-spanned"]||O["number-rows-spanned"])&&(_=parseInt(O["number-rows-spanned"],10)||0,N=parseInt(O["number-columns-spanned"],10)||0,T={s:{r:y,c:b},e:{r:y+_-1,c:b+N-1}},E.push(T)),O["number-columns-repeated"]&&(ee=parseInt(O["number-columns-repeated"],10)),g.t){case"boolean":g.t="b",g.v=sr(O["boolean-value"]);break;case"float":g.t="n",g.v=parseFloat(O.value);break;case"percentage":g.t="n",g.v=parseFloat(O.value);break;case"currency":g.t="n",g.v=parseFloat(O.value);break;case"date":g.t="d",g.v=or(O["date-value"]),t.cellDates||(g.t="n",g.v=Xr(g.v)),g.z="m/d/yy";break;case"time":g.t="n",g.v=GQ(O["time-value"])/86400,t.cellDates&&(g.t="d",g.v=O0(g.v)),g.z="HH:MM:SS";break;case"number":g.t="n",g.v=parseFloat(O.);break;default:if(g.t==="string"||g.t==="text"||!g.t)g.t="s",O["string-value"]!=null&&(w=At(O["string-value"]),S=[]);else throw new Error("Unsupported value type "+g.t)}}else{if(W=!1,g.t==="s"&&(g.v=w||"",S.length&&(g.R=S),W=v==0),V.Target&&(g.l=V),ie.length>0&&(g.c=ie,ie=[]),w&&t.cellText!==!1&&(g.w=w),W&&(g.t="z",delete g.v),(!W||t.sheetStubs)&&!(t.sheetRows&&t.sheetRows<=y))for(var fe=0;fe<z;++fe){if(ee=parseInt(O["number-columns-repeated"]||"1",10),t.dense)for(p[y+fe]||(p[y+fe]=[]),p[y+fe][b]=fe==0?g:jt(g);--ee>0;)p[y+fe][b+ee]=jt(g);else for(p[et({r:y+fe,c:b})]=g;--ee>0;)p[et({r:y+fe,c:b+ee})]=jt(g);x.e.c<=b&&(x.e.c=b)}ee=parseInt(O["number-columns-repeated"]||"1",10),b+=ee-1,ee=0,g={},w="",S=[]}V={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(m[1]==="/"){if((s=i.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&i.push([m[3],!0]);break;case"annotation":if(m[1]==="/"){if((s=i.pop())[0]!==m[3])throw"Bad state: "+s;P.t=w,S.length&&(P.R=S),P.a=I,ie.push(P)}else m[0].charAt(m[0].length-2)!=="/"&&i.push([m[3],!1]);I="",B=0,w="",v=0,S=[];break;case"creator":m[1]==="/"?I=n.slice(B,m.index):B=m.index+m[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(m[1]==="/"){if((s=i.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&i.push([m[3],!1]);w="",v=0,S=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(m[1]==="/"){if(k[o.name]=l,(s=i.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&(l="",o=tt(m[0],!1),i.push([m[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":a=tt(m[0],!1),l+=Iy[m[3]][a.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":a=tt(m[0],!1),l+=Iy[m[3]][a.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(m[0].slice(-2)==="/>")break;if(m[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(f,m.index);break}else f=m.index+m[0].length;break;case"named-range":a=tt(m[0],!1),ue=fp(a["cell-range-address"]);var de={Name:a.name,Ref:ue[0]+"!"+ue[1]};K&&(de.Sheet=d.length),xe.Names.push(de);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(m[1]==="/"&&(!O||!O["string-value"])){var Ue=O7(n.slice(v,m.index));w=(w.length>0?w+`
`:"")+Ue[0]}else tt(m[0],!1),v=m.index+m[0].length;break;case"s":break;case"database-range":if(m[1]==="/")break;try{ue=fp(tt(m[0])["target-range-address"]),u[ue[0]]["!autofilter"]={ref:ue[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(m[1]!=="/"){if(V=tt(m[0],!1),!V.href)break;V.Target=At(V.href),delete V.href,V.Target.charAt(0)=="#"&&V.Target.indexOf(".")>-1?(ue=fp(V.Target.slice(1)),V.Target="#"+ue[0]+"!"+ue[1]):V.Target.match(/^\.\.[\\\/]/)&&(V.Target=V.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(m[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(t.WTF)throw new Error(m)}}var q={Sheets:u,SheetNames:d,Workbook:xe};return t.bookSheets&&delete q.Sheets,q}function Ly(r,e){e=e||{},ki(r,"META-INF/manifest.xml")&&GF(Nr(r,"META-INF/manifest.xml"),e);var t=li(r,"content.xml");if(!t)throw new Error("Missing content.xml in ODS / UOF file");var n=MT(Zt(t),e);return ki(r,"meta.xml")&&(n.Props=_S(Nr(r,"meta.xml"))),n}function By(r,e){return MT(r,e)}var x7=function(){var r=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+yc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+r+"</office:document-styles>";return function(){return Fr+e}}(),Zy=function(){var r=function(s){return Bt(s).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,t=`          <table:covered-table-cell/>
`,n=function(s,a,o){var l=[];l.push('      <table:table table:name="'+Bt(a.SheetNames[o])+`" table:style-name="ta1">
`);var f=0,c=0,h=Ln(s["!ref"]||"A1"),u=s["!merges"]||[],d=0,p=Array.isArray(s);if(s["!cols"])for(c=0;c<=h.e.c;++c)l.push("        <table:table-column"+(s["!cols"][c]?' table:style-name="co'+s["!cols"][c].ods+'"':"")+`></table:table-column>
`);var m="",g=s["!rows"]||[];for(f=0;f<h.s.r;++f)m=g[f]?' table:style-name="ro'+g[f].ods+'"':"",l.push("        <table:table-row"+m+`></table:table-row>
`);for(;f<=h.e.r;++f){for(m=g[f]?' table:style-name="ro'+g[f].ods+'"':"",l.push("        <table:table-row"+m+`>
`),c=0;c<h.s.c;++c)l.push(e);for(;c<=h.e.c;++c){var O=!1,w={},v="";for(d=0;d!=u.length;++d)if(!(u[d].s.c>c)&&!(u[d].s.r>f)&&!(u[d].e.c<c)&&!(u[d].e.r<f)){(u[d].s.c!=c||u[d].s.r!=f)&&(O=!0),w["table:number-columns-spanned"]=u[d].e.c-u[d].s.c+1,w["table:number-rows-spanned"]=u[d].e.r-u[d].s.r+1;break}if(O){l.push(t);continue}var S=et({r:f,c}),y=p?(s[f]||[])[c]:s[S];if(y&&y.f&&(w["table:formula"]=Bt(UM(y.f)),y.F&&y.F.slice(0,S.length)==S)){var b=Ln(y.F);w["table:number-matrix-columns-spanned"]=b.e.c-b.s.c+1,w["table:number-matrix-rows-spanned"]=b.e.r-b.s.r+1}if(!y){l.push(e);continue}switch(y.t){case"b":v=y.v?"TRUE":"FALSE",w["office:value-type"]="boolean",w["office:boolean-value"]=y.v?"true":"false";break;case"n":v=y.w||String(y.v||0),w["office:value-type"]="float",w["office:value"]=y.v||0;break;case"s":case"str":v=y.v==null?"":y.v,w["office:value-type"]="string";break;case"d":v=y.w||or(y.v).toISOString(),w["office:value-type"]="date",w["office:date-value"]=or(y.v).toISOString(),w["table:style-name"]="ce1";break;default:l.push(e);continue}var x=r(v);if(y.l&&y.l.Target){var A=y.l.Target;A=A.charAt(0)=="#"?"#"+XM(A.slice(1)):A,A.charAt(0)!="#"&&!A.match(/^\w+:/)&&(A="../"+A),x=$e("text:a",x,{"xlink:href":A.replace(/&/g,"&amp;")})}l.push("          "+$e("table:table-cell",$e("text:p",x,{}),w)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},i=function(s,a){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;a.SheetNames.map(function(f){return a.Sheets[f]}).forEach(function(f){if(f&&f["!cols"]){for(var c=0;c<f["!cols"].length;++c)if(f["!cols"][c]){var h=f["!cols"][c];if(h.width==null&&h.wpx==null&&h.wch==null)continue;Qa(h),h.ods=o;var u=f["!cols"][c].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+u+`"/>
`),s.push(`  </style:style>
`),++o}}});var l=0;a.SheetNames.map(function(f){return a.Sheets[f]}).forEach(function(f){if(f&&f["!rows"]){for(var c=0;c<f["!rows"].length;++c)if(f["!rows"][c]){f["!rows"][c].ods=l;var h=f["!rows"][c].hpx+"px";s.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+h+`"/>
`),s.push(`  </style:style>
`),++l}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(a,o){var l=[Fr],f=yc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),c=yc({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+f+c+`>
`),l.push(bS().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+f+`>
`),i(l,a),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var h=0;h!=a.SheetNames.length;++h)l.push(n(a.Sheets[a.SheetNames[h]],a,h));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function IT(r,e){if(e.bookType=="fods")return Zy(r,e);var t=lO(),n="",i=[],s=[];return n="mimetype",ct(t,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",ct(t,n,Zy(r,e)),i.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",ct(t,n,x7(r,e)),i.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",ct(t,n,Fr+bS()),i.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",ct(t,n,KF(s)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",ct(t,n,HF(i)),t}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Po(r){return new DataView(r.buffer,r.byteOffset,r.byteLength)}function Um(r){return typeof TextDecoder<"u"?new TextDecoder().decode(r):Zt(Xa(r))}function v7(r){return typeof TextEncoder<"u"?new TextEncoder().encode(r):oi(ys(r))}function y7(r,e){e:for(var t=0;t<=r.length-e.length;++t){for(var n=0;n<e.length;++n)if(r[t+n]!=e[n])continue e;return!0}return!1}function $a(r){var e=r.reduce(function(i,s){return i+s.length},0),t=new Uint8Array(e),n=0;return r.forEach(function(i){t.set(i,n),n+=i.length}),t}function Wy(r){return r-=r>>1&1431655765,r=(r&858993459)+(r>>2&858993459),(r+(r>>4)&252645135)*16843009>>>24}function w7(r,e){for(var t=(r[e+15]&127)<<7|r[e+14]>>1,n=r[e+14]&1,i=e+13;i>=e;--i)n=n*256+r[i];return(r[e+15]&128?-n:n)*Math.pow(10,t-6176)}function b7(r,e,t){var n=Math.floor(t==0?0:Math.LOG10E*Math.log(Math.abs(t)))+6176-20,i=t/Math.pow(10,n-6176);r[e+15]|=n>>7,r[e+14]|=(n&127)<<1;for(var s=0;i>=1;++s,i/=256)r[e+s]=i&255;r[e+15]|=t>=0?0:128}function Ac(r,e){var t=e?e[0]:0,n=r[t]&127;e:if(r[t++]>=128&&(n|=(r[t]&127)<<7,r[t++]<128||(n|=(r[t]&127)<<14,r[t++]<128)||(n|=(r[t]&127)<<21,r[t++]<128)||(n+=(r[t]&127)*Math.pow(2,28),++t,r[t++]<128)||(n+=(r[t]&127)*Math.pow(2,35),++t,r[t++]<128)||(n+=(r[t]&127)*Math.pow(2,42),++t,r[t++]<128)))break e;return e&&(e[0]=t),n}function It(r){var e=new Uint8Array(7);e[0]=r&127;var t=1;e:if(r>127){if(e[t-1]|=128,e[t]=r>>7&127,++t,r<=16383||(e[t-1]|=128,e[t]=r>>14&127,++t,r<=2097151)||(e[t-1]|=128,e[t]=r>>21&127,++t,r<=268435455)||(e[t-1]|=128,e[t]=r/256>>>21&127,++t,r<=34359738367)||(e[t-1]|=128,e[t]=r/65536>>>21&127,++t,r<=4398046511103))break e;e[t-1]|=128,e[t]=r/16777216>>>21&127,++t}return e.slice(0,t)}function Sr(r){var e=0,t=r[e]&127;e:if(r[e++]>=128){if(t|=(r[e]&127)<<7,r[e++]<128||(t|=(r[e]&127)<<14,r[e++]<128)||(t|=(r[e]&127)<<21,r[e++]<128))break e;t|=(r[e]&127)<<28}return t}function Qt(r){for(var e=[],t=[0];t[0]<r.length;){var n=t[0],i=Ac(r,t),s=i&7;i=Math.floor(i/8);var a=0,o;if(i==0)break;switch(s){case 0:{for(var l=t[0];r[t[0]++]>=128;);o=r.slice(l,t[0])}break;case 5:a=4,o=r.slice(t[0],t[0]+a),t[0]+=a;break;case 1:a=8,o=r.slice(t[0],t[0]+a),t[0]+=a;break;case 2:a=Ac(r,t),o=r.slice(t[0],t[0]+a),t[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var f={data:o,type:s};e[i]==null?e[i]=[f]:e[i].push(f)}return e}function rn(r){var e=[];return r.forEach(function(t,n){t.forEach(function(i){i.data&&(e.push(It(n*8+i.type)),i.type==2&&e.push(It(i.data.length)),e.push(i.data))})}),$a(e)}function BO(r,e){return(r==null?void 0:r.map(function(t){return e(t.data)}))||[]}function bi(r){for(var e,t=[],n=[0];n[0]<r.length;){var i=Ac(r,n),s=Qt(r.slice(n[0],n[0]+i));n[0]+=i;var a={id:Sr(s[1][0].data),messages:[]};s[2].forEach(function(o){var l=Qt(o.data),f=Sr(l[3][0].data);a.messages.push({meta:l,data:r.slice(n[0],n[0]+f)}),n[0]+=f}),(e=s[3])!=null&&e[0]&&(a.merge=Sr(s[3][0].data)>>>0>0),t.push(a)}return t}function Go(r){var e=[];return r.forEach(function(t){var n=[];n[1]=[{data:It(t.id),type:0}],n[2]=[],t.merge!=null&&(n[3]=[{data:It(+!!t.merge),type:0}]);var i=[];t.messages.forEach(function(a){i.push(a.data),a.meta[3]=[{type:0,data:It(a.data.length)}],n[2].push({data:rn(a.meta),type:2})});var s=rn(n);e.push(It(s.length)),e.push(s),i.forEach(function(a){return e.push(a)})}),$a(e)}function _7(r,e){if(r!=0)throw new Error("Unexpected Snappy chunk type ".concat(r));for(var t=[0],n=Ac(e,t),i=[];t[0]<e.length;){var s=e[t[0]]&3;if(s==0){var a=e[t[0]++]>>2;if(a<60)++a;else{var o=a-59;a=e[t[0]],o>1&&(a|=e[t[0]+1]<<8),o>2&&(a|=e[t[0]+2]<<16),o>3&&(a|=e[t[0]+3]<<24),a>>>=0,a++,t[0]+=o}i.push(e.slice(t[0],t[0]+a)),t[0]+=a;continue}else{var l=0,f=0;if(s==1?(f=(e[t[0]]>>2&7)+4,l=(e[t[0]++]&224)<<3,l|=e[t[0]++]):(f=(e[t[0]++]>>2)+1,s==2?(l=e[t[0]]|e[t[0]+1]<<8,t[0]+=2):(l=(e[t[0]]|e[t[0]+1]<<8|e[t[0]+2]<<16|e[t[0]+3]<<24)>>>0,t[0]+=4)),i=[$a(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(f>=l)for(i.push(i[0].slice(-l)),f-=l;f>=i[i.length-1].length;)i.push(i[i.length-1]),f-=i[i.length-1].length;i.push(i[0].slice(-l,-l+f))}}var c=$a(i);if(c.length!=n)throw new Error("Unexpected length: ".concat(c.length," != ").concat(n));return c}function _i(r){for(var e=[],t=0;t<r.length;){var n=r[t++],i=r[t]|r[t+1]<<8|r[t+2]<<16;t+=3,e.push(_7(n,r.slice(t,t+i))),t+=i}if(t!==r.length)throw new Error("data is not a valid framed stream!");return $a(e)}function Ho(r){for(var e=[],t=0;t<r.length;){var n=Math.min(r.length-t,268435455),i=new Uint8Array(4);e.push(i);var s=It(n),a=s.length;e.push(s),n<=60?(a++,e.push(new Uint8Array([n-1<<2]))):n<=256?(a+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(a+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(a+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(a+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(r.slice(t,t+n)),a+=n,i[0]=0,i[1]=a&255,i[2]=a>>8&255,i[3]=a>>16&255,t+=n}return $a(e)}function k7(r,e,t,n){var i=Po(r),s=i.getUint32(4,!0),a=(n>1?12:8)+Wy(s&(n>1?3470:398))*4,o=-1,l=-1,f=NaN,c=new Date(2001,0,1);s&512&&(o=i.getUint32(a,!0),a+=4),a+=Wy(s&(n>1?12288:4096))*4,s&16&&(l=i.getUint32(a,!0),a+=4),s&32&&(f=i.getFloat64(a,!0),a+=8),s&64&&(c.setTime(c.getTime()+i.getFloat64(a,!0)*1e3),a+=8);var h;switch(r[2]){case 0:break;case 2:h={t:"n",v:f};break;case 3:h={t:"s",v:e[l]};break;case 5:h={t:"d",v:c};break;case 6:h={t:"b",v:f>0};break;case 7:h={t:"n",v:f/86400};break;case 8:h={t:"e",v:0};break;case 9:if(o>-1)h={t:"s",v:t[o]};else if(l>-1)h={t:"s",v:e[l]};else if(!isNaN(f))h={t:"n",v:f};else throw new Error("Unsupported cell type ".concat(r.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(r.slice(0,4)))}return h}function S7(r,e,t){var n=Po(r),i=n.getUint32(8,!0),s=12,a=-1,o=-1,l=NaN,f=NaN,c=new Date(2001,0,1);i&1&&(l=w7(r,s),s+=16),i&2&&(f=n.getFloat64(s,!0),s+=8),i&4&&(c.setTime(c.getTime()+n.getFloat64(s,!0)*1e3),s+=8),i&8&&(o=n.getUint32(s,!0),s+=4),i&16&&(a=n.getUint32(s,!0),s+=4);var h;switch(r[1]){case 0:break;case 2:h={t:"n",v:l};break;case 3:h={t:"s",v:e[o]};break;case 5:h={t:"d",v:c};break;case 6:h={t:"b",v:f>0};break;case 7:h={t:"n",v:f/86400};break;case 8:h={t:"e",v:0};break;case 9:if(a>-1)h={t:"s",v:t[a]};else throw new Error("Unsupported cell type ".concat(r[1]," : ").concat(i&31," : ").concat(r.slice(0,4)));break;case 10:h={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(r[1]," : ").concat(i&31," : ").concat(r.slice(0,4)))}return h}function hp(r,e){var t=new Uint8Array(32),n=Po(t),i=12,s=0;switch(t[0]=5,r.t){case"n":t[1]=2,b7(t,i,r.v),s|=1,i+=16;break;case"b":t[1]=6,n.setFloat64(i,r.v?1:0,!0),s|=2,i+=8;break;case"s":if(e.indexOf(r.v)==-1)throw new Error("Value ".concat(r.v," missing from SST!"));t[1]=3,n.setUint32(i,e.indexOf(r.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+r.t}return n.setUint32(8,s,!0),t.slice(0,i)}function up(r,e){var t=new Uint8Array(32),n=Po(t),i=12,s=0;switch(t[0]=3,r.t){case"n":t[2]=2,n.setFloat64(i,r.v,!0),s|=32,i+=8;break;case"b":t[2]=6,n.setFloat64(i,r.v?1:0,!0),s|=32,i+=8;break;case"s":if(e.indexOf(r.v)==-1)throw new Error("Value ".concat(r.v," missing from SST!"));t[2]=3,n.setUint32(i,e.indexOf(r.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+r.t}return n.setUint32(4,s,!0),t.slice(0,i)}function T7(r,e,t){switch(r[0]){case 0:case 1:case 2:case 3:return k7(r,e,t,r[0]);case 5:return S7(r,e,t);default:throw new Error("Unsupported payload version ".concat(r[0]))}}function On(r){var e=Qt(r);return Ac(e[1][0].data)}function Uy(r,e){var t=Qt(e.data),n=Sr(t[1][0].data),i=t[3],s=[];return(i||[]).forEach(function(a){var o=Qt(a.data),l=Sr(o[1][0].data)>>>0;switch(n){case 1:s[l]=Um(o[3][0].data);break;case 8:{var f=r[On(o[9][0].data)][0],c=Qt(f.data),h=r[On(c[1][0].data)][0],u=Sr(h.meta[1][0].data);if(u!=2001)throw new Error("2000 unexpected reference to ".concat(u));var d=Qt(h.data);s[l]=d[3].map(function(p){return Um(p.data)}).join("")}break}}),s}function C7(r,e){var t,n,i,s,a,o,l,f,c,h,u,d,p,m,g=Qt(r),O=Sr(g[1][0].data)>>>0,w=Sr(g[2][0].data)>>>0,v=((n=(t=g[8])==null?void 0:t[0])==null?void 0:n.data)&&Sr(g[8][0].data)>0||!1,S,y;if((s=(i=g[7])==null?void 0:i[0])!=null&&s.data&&e!=0)S=(o=(a=g[7])==null?void 0:a[0])==null?void 0:o.data,y=(f=(l=g[6])==null?void 0:l[0])==null?void 0:f.data;else if((h=(c=g[4])==null?void 0:c[0])!=null&&h.data&&e!=1)S=(d=(u=g[4])==null?void 0:u[0])==null?void 0:d.data,y=(m=(p=g[3])==null?void 0:p[0])==null?void 0:m.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var b=v?4:1,x=Po(S),A=[],k=0;k<S.length/2;++k){var E=x.getUint16(k*2,!0);E<65535&&A.push([k,E])}if(A.length!=w)throw"Expected ".concat(w," cells, found ").concat(A.length);var T=[];for(k=0;k<A.length-1;++k)T[A[k][0]]=y.subarray(A[k][1]*b,A[k+1][1]*b);return A.length>=1&&(T[A[A.length-1][0]]=y.subarray(A[A.length-1][1]*b)),{R:O,cells:T}}function A7(r,e){var t,n=Qt(e.data),i=(t=n==null?void 0:n[7])!=null&&t[0]?Sr(n[7][0].data)>>>0>0?1:0:-1,s=BO(n[5],function(a){return C7(a,i)});return{nrows:Sr(n[4][0].data)>>>0,data:s.reduce(function(a,o){return a[o.R]||(a[o.R]=[]),o.cells.forEach(function(l,f){if(a[o.R][f])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(f));a[o.R][f]=l}),a},[])}}function E7(r,e,t){var n,i=Qt(e.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Sr(i[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(s.e.c=(Sr(i[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));t["!ref"]=lt(s);var a=Qt(i[4][0].data),o=Uy(r,r[On(a[4][0].data)][0]),l=(n=a[17])!=null&&n[0]?Uy(r,r[On(a[17][0].data)][0]):[],f=Qt(a[3][0].data),c=0;f[1].forEach(function(h){var u=Qt(h.data),d=r[On(u[2][0].data)][0],p=Sr(d.meta[1][0].data);if(p!=6002)throw new Error("6001 unexpected reference to ".concat(p));var m=A7(r,d);m.data.forEach(function(g,O){g.forEach(function(w,v){var S=et({r:c+O,c:v}),y=T7(w,o,l);y&&(t[S]=y)})}),c+=m.nrows})}function P7(r,e){var t=Qt(e.data),n={"!ref":"A1"},i=r[On(t[2][0].data)],s=Sr(i[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return E7(r,i[0],n),n}function R7(r,e){var t,n=Qt(e.data),i={name:(t=n[1])!=null&&t[0]?Um(n[1][0].data):"",sheets:[]},s=BO(n[2],On);return s.forEach(function(a){r[a].forEach(function(o){var l=Sr(o.meta[1][0].data);l==6e3&&i.sheets.push(P7(r,o))})}),i}function Q7(r,e){var t=jO(),n=Qt(e.data),i=BO(n[1],On);if(i.forEach(function(s){r[s].forEach(function(a){var o=Sr(a.meta[1][0].data);if(o==2){var l=R7(r,a);l.sheets.forEach(function(f,c){zO(t,f,c==0?l.name:l.name+"_"+c,!0)})}})}),t.SheetNames.length==0)throw new Error("Empty NUMBERS file");return t}function dp(r){var e,t,n,i,s={},a=[];if(r.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),r.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var f;try{f=_i(l.content)}catch(h){return console.log("?? "+l.content.length+" "+(h.message||h))}var c;try{c=bi(f)}catch(h){return console.log("## "+(h.message||h))}c.forEach(function(h){s[h.id]=h.messages,a.push(h.id)})}}),!a.length)throw new Error("File has no messages");var o=((i=(n=(t=(e=s==null?void 0:s[1])==null?void 0:e[0])==null?void 0:t.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&Sr(s[1][0].meta[1][0].data)==1&&s[1][0];if(o||a.forEach(function(l){s[l].forEach(function(f){var c=Sr(f.meta[1][0].data)>>>0;if(c==1)if(!o)o=f;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return Q7(s,o)}function F7(r,e,t){var n,i,s,a;if(!((n=r[6])!=null&&n[0])||!((i=r[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var o=((a=(s=r[8])==null?void 0:s[0])==null?void 0:a.data)&&Sr(r[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,f=Po(r[7][0].data),c=0,h=[],u=Po(r[4][0].data),d=0,p=[],m=0;m<e.length;++m){if(e[m]==null){f.setUint16(m*2,65535,!0),u.setUint16(m*2,65535);continue}f.setUint16(m*2,c,!0),u.setUint16(m*2,d,!0);var g,O;switch(typeof e[m]){case"string":g=hp({t:"s",v:e[m]},t),O=up({t:"s",v:e[m]},t);break;case"number":g=hp({t:"n",v:e[m]},t),O=up({t:"n",v:e[m]},t);break;case"boolean":g=hp({t:"b",v:e[m]},t),O=up({t:"b",v:e[m]},t);break;default:throw new Error("Unsupported value "+e[m])}h.push(g),c+=g.length,p.push(O),d+=O.length,++l}for(r[2][0].data=It(l);m<r[7][0].data.length/2;++m)f.setUint16(m*2,65535,!0),u.setUint16(m*2,65535,!0);return r[6][0].data=$a(h),r[3][0].data=$a(p),l}function $7(r,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var t=r.Sheets[r.SheetNames[0]];r.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Ln(t["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(lt(n)));var s=bd(t,{range:n,header:1}),a=["~Sh33tJ5~"];s.forEach(function(I){return I.forEach(function(B){typeof B=="string"&&a.push(B)})});var o={},l=[],f=Ye.read(e.numbers,{type:"base64"});f.FileIndex.map(function(I,B){return[I,f.FullPaths[B]]}).forEach(function(I){var B=I[0],W=I[1];if(B.type==2&&B.name.match(/\.iwa/)){var K=B.content,re=_i(K),pe=bi(re);pe.forEach(function(fe){l.push(fe.id),o[fe.id]={deps:[],location:W,type:Sr(fe.messages[0].meta[1][0].data)}})}}),l.sort(function(I,B){return I-B});var c=l.filter(function(I){return I>1}).map(function(I){return[I,It(I)]});f.FileIndex.map(function(I,B){return[I,f.FullPaths[B]]}).forEach(function(I){var B=I[0];if(I[1],!!B.name.match(/\.iwa/)){var W=bi(_i(B.content));W.forEach(function(K){K.messages.forEach(function(re){c.forEach(function(pe){K.messages.some(function(fe){return Sr(fe.meta[1][0].data)!=11006&&y7(fe.data,pe[1])})&&o[pe[0]].deps.push(K.id)})})})}});for(var h=Ye.find(f,o[1].location),u=bi(_i(h.content)),d,p=0;p<u.length;++p){var m=u[p];m.id==1&&(d=m)}var g=On(Qt(d.messages[0].data)[1][0].data);for(h=Ye.find(f,o[g].location),u=bi(_i(h.content)),p=0;p<u.length;++p)m=u[p],m.id==g&&(d=m);for(g=On(Qt(d.messages[0].data)[2][0].data),h=Ye.find(f,o[g].location),u=bi(_i(h.content)),p=0;p<u.length;++p)m=u[p],m.id==g&&(d=m);for(g=On(Qt(d.messages[0].data)[2][0].data),h=Ye.find(f,o[g].location),u=bi(_i(h.content)),p=0;p<u.length;++p)m=u[p],m.id==g&&(d=m);var O=Qt(d.messages[0].data);{O[6][0].data=It(n.e.r+1),O[7][0].data=It(n.e.c+1);var w=On(O[46][0].data),v=Ye.find(f,o[w].location),S=bi(_i(v.content));{for(var y=0;y<S.length&&S[y].id!=w;++y);if(S[y].id!=w)throw"Bad ColumnRowUIDMapArchive";var b=Qt(S[y].messages[0].data);b[1]=[],b[2]=[],b[3]=[];for(var x=0;x<=n.e.c;++x){var A=[];A[1]=A[2]=[{type:0,data:It(x+420690)}],b[1].push({type:2,data:rn(A)}),b[2].push({type:0,data:It(x)}),b[3].push({type:0,data:It(x)})}b[4]=[],b[5]=[],b[6]=[];for(var k=0;k<=n.e.r;++k)A=[],A[1]=A[2]=[{type:0,data:It(k+726270)}],b[4].push({type:2,data:rn(A)}),b[5].push({type:0,data:It(k)}),b[6].push({type:0,data:It(k)});S[y].messages[0].data=rn(b)}v.content=Ho(Go(S)),v.size=v.content.length,delete O[46];var E=Qt(O[4][0].data);{E[7][0].data=It(n.e.r+1);var T=Qt(E[1][0].data),_=On(T[2][0].data);v=Ye.find(f,o[_].location),S=bi(_i(v.content));{if(S[0].id!=_)throw"Bad HeaderStorageBucket";var N=Qt(S[0].messages[0].data);for(k=0;k<s.length;++k){var Z=Qt(N[2][0].data);Z[1][0].data=It(k),Z[4][0].data=It(s[k].length),N[2][k]={type:N[2][0].type,data:rn(Z)}}S[0].messages[0].data=rn(N)}v.content=Ho(Go(S)),v.size=v.content.length;var z=On(E[2][0].data);v=Ye.find(f,o[z].location),S=bi(_i(v.content));{if(S[0].id!=z)throw"Bad HeaderStorageBucket";for(N=Qt(S[0].messages[0].data),x=0;x<=n.e.c;++x)Z=Qt(N[2][0].data),Z[1][0].data=It(x),Z[4][0].data=It(n.e.r+1),N[2][x]={type:N[2][0].type,data:rn(Z)};S[0].messages[0].data=rn(N)}v.content=Ho(Go(S)),v.size=v.content.length;var ee=On(E[4][0].data);(function(){for(var I=Ye.find(f,o[ee].location),B=bi(_i(I.content)),W,K=0;K<B.length;++K){var re=B[K];re.id==ee&&(W=re)}var pe=Qt(W.messages[0].data);{pe[3]=[];var fe=[];a.forEach(function(q,ze){fe[1]=[{type:0,data:It(ze)}],fe[2]=[{type:0,data:It(1)}],fe[3]=[{type:2,data:v7(q)}],pe[3].push({type:2,data:rn(fe)})})}W.messages[0].data=rn(pe);var de=Go(B),Ue=Ho(de);I.content=Ue,I.size=I.content.length})();var ae=Qt(E[3][0].data);{var xe=ae[1][0];delete ae[2];var V=Qt(xe.data);{var ue=On(V[2][0].data);(function(){for(var I=Ye.find(f,o[ue].location),B=bi(_i(I.content)),W,K=0;K<B.length;++K){var re=B[K];re.id==ue&&(W=re)}var pe=Qt(W.messages[0].data);{delete pe[6],delete ae[7];var fe=new Uint8Array(pe[5][0].data);pe[5]=[];for(var de=0,Ue=0;Ue<=n.e.r;++Ue){var q=Qt(fe);de+=F7(q,s[Ue],a),q[1][0].data=It(Ue),pe[5].push({data:rn(q),type:2})}pe[1]=[{type:0,data:It(n.e.c+1)}],pe[2]=[{type:0,data:It(n.e.r+1)}],pe[3]=[{type:0,data:It(de)}],pe[4]=[{type:0,data:It(n.e.r+1)}]}W.messages[0].data=rn(pe);var ze=Go(B),Qe=Ho(ze);I.content=Qe,I.size=I.content.length})()}xe.data=rn(V)}E[3][0].data=rn(ae)}O[4][0].data=rn(E)}d.messages[0].data=rn(O);var ie=Go(u),P=Ho(ie);return h.content=P,h.size=h.content.length,f}function LT(r){return function(t){for(var n=0;n!=r.length;++n){var i=r[n];t[i[0]]===void 0&&(t[i[0]]=i[1]),i[2]==="n"&&(t[i[0]]=Number(t[i[0]]))}}}function ZO(r){LT([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(r)}function WO(r){LT([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(r)}function D7(r){return pt.WS.indexOf(r)>-1?"sheet":r==pt.CS?"chart":r==pt.DS?"dialog":r==pt.MS?"macro":r&&r.length?r:"sheet"}function N7(r,e){if(!r)return 0;try{r=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,r["!id"][n.id].Target,D7(r["!id"][n.id].Type)]})}catch{return null}return!r||r.length===0?null:r}function M7(r,e,t,n,i,s,a,o,l,f,c,h){try{s[n]=nc(li(r,t,!0),e);var u=Nr(r,e),d;switch(o){case"sheet":d=fB(u,e,i,l,s[n],f,c,h);break;case"chart":if(d=cB(u,e,i,l,s[n],f,c,h),!d||!d["!drawel"])break;var p=Qf(d["!drawel"].Target,e),m=bc(p),g=Y6(li(r,p,!0),nc(li(r,m,!0),p)),O=Qf(g,p),w=bc(O);d=IL(li(r,O,!0),O,l,nc(li(r,w,!0),O),f,d);break;case"macro":d=hB(u,e,i,l,s[n],f,c,h);break;case"dialog":d=uB(u,e,i,l,s[n],f,c,h);break;default:throw new Error("Unrecognized sheet type "+o)}a[n]=d;var v=[];s&&s[n]&&Tr(s[n]).forEach(function(S){var y="";if(s[n][S].Type==pt.CMNT){y=Qf(s[n][S].Target,e);var b=gB(Nr(r,y,!0),y,l);if(!b||!b.length)return;Ay(d,b,!1)}s[n][S].Type==pt.TCMNT&&(y=Qf(s[n][S].Target,e),v=v.concat(J6(Nr(r,y,!0),l)))}),v&&v.length&&Ay(d,v,!0,l.people||[])}catch(S){if(l.WTF)throw S}}function yi(r){return r.charAt(0)=="/"?r.slice(1):r}function BT(r,e){if(ef(),e=e||{},ZO(e),ki(r,"META-INF/manifest.xml")||ki(r,"objectdata.xml"))return Ly(r,e);if(ki(r,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof dp<"u"){if(r.FileIndex)return dp(r);var t=Ye.utils.cfb_new();return Gv(r).forEach(function(Z){ct(t,Z,eF(r,Z))}),dp(t)}throw new Error("Unsupported NUMBERS file")}if(!ki(r,"[Content_Types].xml"))throw ki(r,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):ki(r,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=Gv(r),i=jF(li(r,"[Content_Types].xml")),s=!1,a,o;if(i.workbooks.length===0&&(o="xl/workbook.xml",Nr(r,o,!0)&&i.workbooks.push(o)),i.workbooks.length===0){if(o="xl/workbook.bin",!Nr(r,o,!0))throw new Error("Could not find workbook");i.workbooks.push(o),s=!0}i.workbooks[0].slice(-3)=="bin"&&(s=!0);var l={},f={};if(!e.bookSheets&&!e.bookProps){if(ic=[],i.sst)try{ic=mB(Nr(r,yi(i.sst)),i.sst,e)}catch(Z){if(e.WTF)throw Z}e.cellStyles&&i.themes.length&&(l=pB(li(r,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],e)),i.style&&(f=dB(Nr(r,yi(i.style)),i.style,l,e))}i.links.map(function(Z){try{var z=nc(li(r,bc(yi(Z))),Z);return xB(Nr(r,yi(Z)),z,Z,e)}catch{}});var c=lB(Nr(r,yi(i.workbooks[0])),i.workbooks[0],e),h={},u="";i.coreprops.length&&(u=Nr(r,yi(i.coreprops[0]),!0),u&&(h=_S(u)),i.extprops.length!==0&&(u=Nr(r,yi(i.extprops[0]),!0),u&&e$(u,h,e)));var d={};(!e.bookSheets||e.bookProps)&&i.custprops.length!==0&&(u=li(r,yi(i.custprops[0]),!0),u&&(d=r$(u,e)));var p={};if((e.bookSheets||e.bookProps)&&(c.Sheets?a=c.Sheets.map(function(z){return z.name}):h.Worksheets&&h.SheetNames.length>0&&(a=h.SheetNames),e.bookProps&&(p.Props=h,p.Custprops=d),e.bookSheets&&typeof a<"u"&&(p.SheetNames=a),e.bookSheets?p.SheetNames:e.bookProps))return p;a={};var m={};e.bookDeps&&i.calcchain&&(m=OB(Nr(r,yi(i.calcchain)),i.calcchain));var g=0,O={},w,v;{var S=c.Sheets;h.Worksheets=S.length,h.SheetNames=[];for(var y=0;y!=S.length;++y)h.SheetNames[y]=S[y].name}var b=s?"bin":"xml",x=i.workbooks[0].lastIndexOf("/"),A=(i.workbooks[0].slice(0,x+1)+"_rels/"+i.workbooks[0].slice(x+1)+".rels").replace(/^\//,"");ki(r,A)||(A="xl/_rels/workbook."+b+".rels");var k=nc(li(r,A,!0),A.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(e.xlmeta=vB(Nr(r,yi(i.metadata[0])),i.metadata[0],e)),(i.people||[]).length>=1&&(e.people=t8(Nr(r,yi(i.people[0])),e)),k&&(k=N7(k,c.Sheets));var E=Nr(r,"xl/worksheets/sheet.xml",!0)?1:0;e:for(g=0;g!=h.Worksheets;++g){var T="sheet";if(k&&k[g]?(w="xl/"+k[g][1].replace(/[\/]?xl\//,""),ki(r,w)||(w=k[g][1]),ki(r,w)||(w=A.replace(/_rels\/.*$/,"")+k[g][1]),T=k[g][2]):(w="xl/worksheets/sheet"+(g+1-E)+"."+b,w=w.replace(/sheet0\./,"sheet.")),v=w.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(g!=e.sheets)continue e;break;case"string":if(h.SheetNames[g].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var _=!1,N=0;N!=e.sheets.length;++N)typeof e.sheets[N]=="number"&&e.sheets[N]==g&&(_=1),typeof e.sheets[N]=="string"&&e.sheets[N].toLowerCase()==h.SheetNames[g].toLowerCase()&&(_=1);if(!_)continue e}}M7(r,w,v,h.SheetNames[g],g,O,a,T,e,c,l,f)}return p={Directory:i,Workbook:c,Props:h,Custprops:d,Deps:m,Sheets:a,SheetNames:h.SheetNames,Strings:ic,Styles:f,Themes:l,SSF:jt(Ke)},e&&e.bookFiles&&(r.files?(p.keys=n,p.files=r.files):(p.keys=[],p.files={},r.FullPaths.forEach(function(Z,z){Z=Z.replace(/^Root Entry[\/]/,""),p.keys.push(Z),p.files[Z]=r.FileIndex[z]}))),e&&e.bookVBA&&(i.vba.length>0?p.vbaraw=Nr(r,yi(i.vba[0]),!0):i.defaults&&i.defaults.bin===f8&&(p.vbaraw=Nr(r,"xl/vbaProject.bin",!0))),p}function I7(r,e){var t=e||{},n="Workbook",i=Ye.find(r,n);try{if(n="/!DataSpaces/Version",i=Ye.find(r,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(yN(i.content),n="/!DataSpaces/DataSpaceMap",i=Ye.find(r,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=bN(i.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=Ye.find(r,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=_N(i.content);if(a.length!=1||a[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=Ye.find(r,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);SN(i.content)}catch{}if(n="/EncryptionInfo",i=Ye.find(r,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=TN(i.content);if(n="/EncryptedPackage",i=Ye.find(r,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],i.content,t.password||"",t);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],i.content,t.password||"",t);throw new Error("File is password-protected")}function L7(r,e){return e.bookType=="ods"?IT(r,e):e.bookType=="numbers"?$7(r,e):e.bookType=="xlsb"?B7(r,e):ZT(r,e)}function B7(r,e){il=1024,r&&!r.SSF&&(r.SSF=jt(Ke)),r&&r.SSF&&(ef(),hh(r.SSF),e.revssf=g0(r.SSF),e.revssf[r.SSF[65535]]=0,e.ssf=r.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,sc?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var t=e.bookType=="xlsb"?"bin":"xml",n=lT.indexOf(e.bookType)>-1,i=TO();WO(e=e||{});var s=lO(),a="",o=0;if(e.cellXfs=[],qa(e.cellXfs,{},{revssf:{General:0}}),r.Props||(r.Props={}),a="docProps/core.xml",ct(s,a,kS(r.Props,e)),i.coreprops.push(a),Lt(e.rels,2,a,pt.CORE_PROPS),a="docProps/app.xml",!(r.Props&&r.Props.SheetNames))if(!r.Workbook||!r.Workbook.Sheets)r.Props.SheetNames=r.SheetNames;else{for(var l=[],f=0;f<r.SheetNames.length;++f)(r.Workbook.Sheets[f]||{}).Hidden!=2&&l.push(r.SheetNames[f]);r.Props.SheetNames=l}for(r.Props.Worksheets=r.Props.SheetNames.length,ct(s,a,CS(r.Props)),i.extprops.push(a),Lt(e.rels,3,a,pt.EXT_PROPS),r.Custprops!==r.Props&&Tr(r.Custprops||{}).length>0&&(a="docProps/custom.xml",ct(s,a,AS(r.Custprops)),i.custprops.push(a),Lt(e.rels,4,a,pt.CUST_PROPS)),o=1;o<=r.SheetNames.length;++o){var c={"!id":{}},h=r.Sheets[r.SheetNames[o-1]],u=(h||{})["!type"]||"sheet";switch(u){case"chart":default:a="xl/worksheets/sheet"+o+"."+t,ct(s,a,wB(o-1,a,e,r,c)),i.sheets.push(a),Lt(e.wbrels,-1,"worksheets/sheet"+o+"."+t,pt.WS[0])}if(h){var d=h["!comments"],p=!1,m="";d&&d.length>0&&(m="xl/comments"+o+"."+t,ct(s,m,kB(d,m)),i.comments.push(m),Lt(c,-1,"../comments"+o+"."+t,pt.CMNT),p=!0),h["!legacy"]&&p&&ct(s,"xl/drawings/vmlDrawing"+o+".vml",aT(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}c["!id"].rId1&&ct(s,bc(a),pl(c))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+t,ct(s,a,_B(e.Strings,a,e)),i.strs.push(a),Lt(e.wbrels,-1,"sharedStrings."+t,pt.SST)),a="xl/workbook."+t,ct(s,a,yB(r,a)),i.workbooks.push(a),Lt(e.rels,1,a,pt.WB),a="xl/theme/theme1.xml",ct(s,a,QO(r.Themes,e)),i.themes.push(a),Lt(e.wbrels,-1,"theme/theme1.xml",pt.THEME),a="xl/styles."+t,ct(s,a,bB(r,a,e)),i.styles.push(a),Lt(e.wbrels,-1,"styles."+t,pt.STY),r.vbaraw&&n&&(a="xl/vbaProject.bin",ct(s,a,r.vbaraw),i.vba.push(a),Lt(e.wbrels,-1,"vbaProject.bin",pt.VBA)),a="xl/metadata."+t,ct(s,a,SB(a)),i.metadata.push(a),Lt(e.wbrels,-1,"metadata."+t,pt.XLMETA),ct(s,"[Content_Types].xml",wS(i,e)),ct(s,"_rels/.rels",pl(e.rels)),ct(s,"xl/_rels/workbook."+t+".rels",pl(e.wbrels)),delete e.revssf,delete e.ssf,s}function ZT(r,e){il=1024,r&&!r.SSF&&(r.SSF=jt(Ke)),r&&r.SSF&&(ef(),hh(r.SSF),e.revssf=g0(r.SSF),e.revssf[r.SSF[65535]]=0,e.ssf=r.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,sc?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var t="xml",n=lT.indexOf(e.bookType)>-1,i=TO();WO(e=e||{});var s=lO(),a="",o=0;if(e.cellXfs=[],qa(e.cellXfs,{},{revssf:{General:0}}),r.Props||(r.Props={}),a="docProps/core.xml",ct(s,a,kS(r.Props,e)),i.coreprops.push(a),Lt(e.rels,2,a,pt.CORE_PROPS),a="docProps/app.xml",!(r.Props&&r.Props.SheetNames))if(!r.Workbook||!r.Workbook.Sheets)r.Props.SheetNames=r.SheetNames;else{for(var l=[],f=0;f<r.SheetNames.length;++f)(r.Workbook.Sheets[f]||{}).Hidden!=2&&l.push(r.SheetNames[f]);r.Props.SheetNames=l}r.Props.Worksheets=r.Props.SheetNames.length,ct(s,a,CS(r.Props)),i.extprops.push(a),Lt(e.rels,3,a,pt.EXT_PROPS),r.Custprops!==r.Props&&Tr(r.Custprops||{}).length>0&&(a="docProps/custom.xml",ct(s,a,AS(r.Custprops)),i.custprops.push(a),Lt(e.rels,4,a,pt.CUST_PROPS));var c=["SheetJ5"];for(e.tcid=0,o=1;o<=r.SheetNames.length;++o){var h={"!id":{}},u=r.Sheets[r.SheetNames[o-1]],d=(u||{})["!type"]||"sheet";switch(d){case"chart":default:a="xl/worksheets/sheet"+o+"."+t,ct(s,a,vT(o-1,e,r,h)),i.sheets.push(a),Lt(e.wbrels,-1,"worksheets/sheet"+o+"."+t,pt.WS[0])}if(u){var p=u["!comments"],m=!1,g="";if(p&&p.length>0){var O=!1;p.forEach(function(w){w[1].forEach(function(v){v.T==!0&&(O=!0)})}),O&&(g="xl/threadedComments/threadedComment"+o+"."+t,ct(s,g,e8(p,c,e)),i.threadedcomments.push(g),Lt(h,-1,"../threadedComments/threadedComment"+o+"."+t,pt.TCMNT)),g="xl/comments"+o+"."+t,ct(s,g,oT(p)),i.comments.push(g),Lt(h,-1,"../comments"+o+"."+t,pt.CMNT),m=!0}u["!legacy"]&&m&&ct(s,"xl/drawings/vmlDrawing"+o+".vml",aT(o,u["!comments"])),delete u["!comments"],delete u["!legacy"]}h["!id"].rId1&&ct(s,bc(a),pl(h))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+t,ct(s,a,zS(e.Strings,e)),i.strs.push(a),Lt(e.wbrels,-1,"sharedStrings."+t,pt.SST)),a="xl/workbook."+t,ct(s,a,ST(r)),i.workbooks.push(a),Lt(e.rels,1,a,pt.WB),a="xl/theme/theme1.xml",ct(s,a,QO(r.Themes,e)),i.themes.push(a),Lt(e.wbrels,-1,"theme/theme1.xml",pt.THEME),a="xl/styles."+t,ct(s,a,rT(r,e)),i.styles.push(a),Lt(e.wbrels,-1,"styles."+t,pt.STY),r.vbaraw&&n&&(a="xl/vbaProject.bin",ct(s,a,r.vbaraw),i.vba.push(a),Lt(e.wbrels,-1,"vbaProject.bin",pt.VBA)),a="xl/metadata."+t,ct(s,a,sT()),i.metadata.push(a),Lt(e.wbrels,-1,"metadata."+t,pt.XLMETA),c.length>1&&(a="xl/persons/person.xml",ct(s,a,r8(c)),i.people.push(a),Lt(e.wbrels,-1,"persons/person.xml",pt.PEOPLE)),ct(s,"[Content_Types].xml",wS(i,e)),ct(s,"_rels/.rels",pl(e.rels)),ct(s,"xl/_rels/workbook."+t+".rels",pl(e.wbrels)),delete e.revssf,delete e.ssf,s}function UO(r,e){var t="";switch((e||{}).type||"base64"){case"buffer":return[r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7]];case"base64":t=gi(r.slice(0,12));break;case"binary":t=r;break;case"array":return[r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function Z7(r,e){return Ye.find(r,"EncryptedPackage")?I7(r,e):LO(r,e)}function W7(r,e){var t,n=r,i=e||{};return i.type||(i.type=dt&&Buffer.isBuffer(r)?"buffer":"base64"),t=eS(n,i),BT(t,i)}function WT(r,e){var t=0;e:for(;t<r.length;)switch(r.charCodeAt(t)){case 10:case 13:case 32:++t;break;case 60:return Zm(r.slice(t),e);default:break e}return El.to_workbook(r,e)}function U7(r,e){var t="",n=UO(r,e);switch(e.type){case"base64":t=gi(r);break;case"binary":t=r;break;case"buffer":t=r.toString("binary");break;case"array":t=To(r);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(t=Zt(t)),e.type="binary",WT(t,e)}function X7(r,e){var t=r;return e.type=="base64"&&(t=gi(t)),t=St.utils.decode(1200,t.slice(2),"str"),e.type="binary",WT(t,e)}function V7(r){return r.match(/[^\x00-\x7F]/)?ys(r):r}function pp(r,e,t,n){return n?(t.type="string",El.to_workbook(r,t)):El.to_workbook(e,t)}function wd(r,e){p0();var t=e||{};if(typeof ArrayBuffer<"u"&&r instanceof ArrayBuffer)return wd(new Uint8Array(r),(t=jt(t),t.type="array",t));typeof Uint8Array<"u"&&r instanceof Uint8Array&&!t.type&&(t.type=typeof Deno<"u"?"buffer":"array");var n=r,i=[0,0,0,0],s=!1;if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),gl={},t.dateNF&&(gl.dateNF=t.dateNF),t.type||(t.type=dt&&Buffer.isBuffer(r)?"buffer":"base64"),t.type=="file"&&(t.type=dt?"buffer":"binary",n=qQ(r),typeof Uint8Array<"u"&&!dt&&(t.type="array")),t.type=="string"&&(s=!0,t.type="binary",t.codepage=65001,n=V7(r)),t.type=="array"&&typeof Uint8Array<"u"&&r instanceof Uint8Array&&typeof ArrayBuffer<"u"){var a=new ArrayBuffer(3),o=new Uint8Array(a);if(o.foo="bar",!o.foo)return t=jt(t),t.type="array",wd(iO(n),t)}switch((i=UO(n,t))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return Z7(Ye.read(n,t),t);break;case 9:if(i[1]<=8)return LO(n,t);break;case 60:return Zm(n,t);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return nN(n,t);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return qS.to_workbook(n,t);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?W7(n,t):pp(r,n,t,s);case 239:return i[3]===60?Zm(n,t):pp(r,n,t,s);case 255:if(i[1]===254)return X7(n,t);if(i[1]===0&&i[2]===2&&i[3]===0)return xo.to_workbook(n,t);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return xo.to_workbook(n,t);break;case 3:case 131:case 139:case 140:return Bm.to_workbook(n,t);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return JS.to_workbook(n,t);break;case 10:case 13:case 32:return U7(n,t);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return rN.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?Bm.to_workbook(n,t):pp(r,n,t,s)}function Xy(r,e){var t=e||{};return t.type="file",wd(r,t)}function UT(r,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return uh(e.file,Ye.write(r,{type:dt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return Ye.write(r,e)}function q7(r,e){var t=jt(e||{}),n=L7(r,t);return XT(n,t)}function j7(r,e){var t=jt(e||{}),n=ZT(r,t);return XT(n,t)}function XT(r,e){var t={},n=dt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(t.compression="DEFLATE"),e.password)t.type=n;else switch(e.type){case"base64":t.type="base64";break;case"binary":t.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":t.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var i=r.FullPaths?Ye.write(r,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[t.type]||t.type,compression:!!e.compression}):r.generate(t);if(typeof Deno<"u"&&typeof i=="string"){if(e.type=="binary"||e.type=="base64")return i;i=new Uint8Array(ch(i))}return e.password&&typeof encrypt_agile<"u"?UT(encrypt_agile(i,e.password),e):e.type==="file"?uh(e.file,i):e.type=="string"?Zt(i):i}function z7(r,e){var t=e||{},n=YB(r,t);return UT(n,t)}function ps(r,e,t){t||(t="");var n=t+r;switch(e.type){case"base64":return Oc(ys(n));case"binary":return ys(n);case"string":return r;case"file":return uh(e.file,n,"utf8");case"buffer":return dt?na(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):ps(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function G7(r,e){switch(e.type){case"base64":return Oc(r);case"binary":return r;case"string":return r;case"file":return uh(e.file,r,"binary");case"buffer":return dt?na(r,"binary"):r.split("").map(function(t){return t.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function Vh(r,e){switch(e.type){case"string":case"base64":case"binary":for(var t="",n=0;n<r.length;++n)t+=String.fromCharCode(r[n]);return e.type=="base64"?Oc(t):e.type=="string"?Zt(t):t;case"file":return uh(e.file,r);case"buffer":return r;default:throw new Error("Unrecognized type "+e.type)}}function XO(r,e){p0(),kT(r);var t=jt(e||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),t.type=="array"){t.type="binary";var n=XO(r,t);return t.type="array",ch(n)}return j7(r,t)}function _0(r,e){p0(),kT(r);var t=jt(e||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),t.type=="array"){t.type="binary";var n=_0(r,t);return t.type="array",ch(n)}var i=0;if(t.sheet&&(typeof t.sheet=="number"?i=t.sheet:i=r.SheetNames.indexOf(t.sheet),!r.SheetNames[i]))throw new Error("Sheet not found: "+t.sheet+" : "+typeof t.sheet);switch(t.bookType||"xlsb"){case"xml":case"xlml":return ps(XB(r,t),t);case"slk":case"sylk":return ps(VS.from_sheet(r.Sheets[r.SheetNames[i]],t),t);case"htm":case"html":return ps($T(r.Sheets[r.SheetNames[i]],t),t);case"txt":return G7(jT(r.Sheets[r.SheetNames[i]],t),t);case"csv":return ps(qO(r.Sheets[r.SheetNames[i]],t),t,"\uFEFF");case"dif":return ps(qS.from_sheet(r.Sheets[r.SheetNames[i]],t),t);case"dbf":return Vh(Bm.from_sheet(r.Sheets[r.SheetNames[i]],t),t);case"prn":return ps(El.from_sheet(r.Sheets[r.SheetNames[i]],t),t);case"rtf":return ps(JS.from_sheet(r.Sheets[r.SheetNames[i]],t),t);case"eth":return ps(jS.from_sheet(r.Sheets[r.SheetNames[i]],t),t);case"fods":return ps(IT(r,t),t);case"wk1":return Vh(xo.sheet_to_wk1(r.Sheets[r.SheetNames[i]],t),t);case"wk3":return Vh(xo.book_to_wk3(r,t),t);case"biff2":t.biff||(t.biff=2);case"biff3":t.biff||(t.biff=3);case"biff4":return t.biff||(t.biff=4),Vh(ET(r,t),t);case"biff5":t.biff||(t.biff=5);case"biff8":case"xla":case"xls":return t.biff||(t.biff=8),z7(r,t);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return q7(r,t);default:throw new Error("Unrecognized bookType |"+t.bookType+"|")}}function VO(r){if(!r.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},t=r.file.slice(r.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(r.bookType=t.slice(1)),r.bookType=e[r.bookType]||r.bookType}}function Xm(r,e,t){var n=t||{};return n.type="file",n.file=e,VO(n),_0(r,n)}function H7(r,e,t){var n=t||{};return n.type="file",n.file=e,VO(n),XO(r,n)}function Y7(r,e,t,n){var i=t||{};i.type="file",i.file=r,VO(i),i.type="buffer";var s=n;return s instanceof Function||(s=t),ka.writeFile(r,_0(e,i),s)}function VT(r,e,t,n,i,s,a,o){var l=kr(t),f=o.defval,c=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),h=!0,u=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(u,"__rowNum__",{value:t,enumerable:!1})}catch{u.__rowNum__=t}else u.__rowNum__=t;if(!a||r[t])for(var d=e.s.c;d<=e.e.c;++d){var p=a?r[t][d]:r[n[d]+l];if(p===void 0||p.t===void 0){if(f===void 0)continue;s[d]!=null&&(u[s[d]]=f);continue}var m=p.v;switch(p.t){case"z":if(m==null)break;continue;case"e":m=m==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+p.t)}if(s[d]!=null){if(m==null)if(p.t=="e"&&m===null)u[s[d]]=null;else if(f!==void 0)u[s[d]]=f;else if(c&&m===null)u[s[d]]=null;else continue;else u[s[d]]=c&&(p.t!=="n"||p.t==="n"&&o.rawNumbers!==!1)?m:As(p,m,o);m!=null&&(h=!1)}}return{row:u,isempty:h}}function bd(r,e){if(r==null||r["!ref"]==null)return[];var t={t:"n",v:0},n=0,i=1,s=[],a=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},f=e||{},c=f.range!=null?f.range:r["!ref"];switch(f.header===1?n=1:f.header==="A"?n=2:Array.isArray(f.header)?n=3:f.header==null&&(n=0),typeof c){case"string":l=yt(c);break;case"number":l=yt(r["!ref"]),l.s.r=c;break;default:l=c}n>0&&(i=0);var h=kr(l.s.r),u=[],d=[],p=0,m=0,g=Array.isArray(r),O=l.s.r,w=0,v={};g&&!r[O]&&(r[O]=[]);var S=f.skipHidden&&r["!cols"]||[],y=f.skipHidden&&r["!rows"]||[];for(w=l.s.c;w<=l.e.c;++w)if(!(S[w]||{}).hidden)switch(u[w]=ar(w),t=g?r[O][w]:r[u[w]+h],n){case 1:s[w]=w-l.s.c;break;case 2:s[w]=u[w];break;case 3:s[w]=f.header[w-l.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),o=a=As(t,null,f),m=v[a]||0,!m)v[a]=1;else{do o=a+"_"+m++;while(v[o]);v[a]=m,v[o]=1}s[w]=o}for(O=l.s.r+i;O<=l.e.r;++O)if(!(y[O]||{}).hidden){var b=VT(r,l,O,u,n,s,g,f);(b.isempty===!1||(n===1?f.blankrows!==!1:f.blankrows))&&(d[p++]=b.row)}return d.length=p,d}var Vy=/"/g;function qT(r,e,t,n,i,s,a,o){for(var l=!0,f=[],c="",h=kr(t),u=e.s.c;u<=e.e.c;++u)if(n[u]){var d=o.dense?(r[t]||[])[u]:r[n[u]+h];if(d==null)c="";else if(d.v!=null){l=!1,c=""+(o.rawNumbers&&d.t=="n"?d.v:As(d,null,o));for(var p=0,m=0;p!==c.length;++p)if((m=c.charCodeAt(p))===i||m===s||m===34||o.forceQuotes){c='"'+c.replace(Vy,'""')+'"';break}c=="ID"&&(c='"ID"')}else d.f!=null&&!d.F?(l=!1,c="="+d.f,c.indexOf(",")>=0&&(c='"'+c.replace(Vy,'""')+'"')):c="";f.push(c)}return o.blankrows===!1&&l?null:f.join(a)}function qO(r,e){var t=[],n=e??{};if(r==null||r["!ref"]==null)return"";var i=yt(r["!ref"]),s=n.FS!==void 0?n.FS:",",a=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),f=new RegExp((s=="|"?"\\|":s)+"+$"),c="",h=[];n.dense=Array.isArray(r);for(var u=n.skipHidden&&r["!cols"]||[],d=n.skipHidden&&r["!rows"]||[],p=i.s.c;p<=i.e.c;++p)(u[p]||{}).hidden||(h[p]=ar(p));for(var m=0,g=i.s.r;g<=i.e.r;++g)(d[g]||{}).hidden||(c=qT(r,i,g,h,a,l,s,n),c!=null&&(n.strip&&(c=c.replace(f,"")),(c||n.blankrows!==!1)&&t.push((m++?o:"")+c)));return delete n.dense,t.join("")}function jT(r,e){e||(e={}),e.FS="	",e.RS=`
`;var t=qO(r,e);if(typeof St>"u"||e.type=="string")return t;var n=St.utils.encode(1200,t,"str");return""+n}function K7(r){var e="",t,n="";if(r==null||r["!ref"]==null)return[];var i=yt(r["!ref"]),s="",a=[],o,l=[],f=Array.isArray(r);for(o=i.s.c;o<=i.e.c;++o)a[o]=ar(o);for(var c=i.s.r;c<=i.e.r;++c)for(s=kr(c),o=i.s.c;o<=i.e.c;++o)if(e=a[o]+s,t=f?(r[c]||[])[o]:r[e],n="",t!==void 0){if(t.F!=null){if(e=t.F,!t.f)continue;n=t.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(t.f!=null)n=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)n=""+t.v;else if(t.t=="b")n=t.v?"TRUE":"FALSE";else if(t.w!==void 0)n="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?n="'"+t.v:n=""+t.v}}l[l.length]=e+"="+n}return l}function zT(r,e,t){var n=t||{},i=+!n.skipHeader,s=r||{},a=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?xr(n.origin):n.origin;a=l.r,o=l.c}var f,c={s:{c:0,r:0},e:{c:o,r:a+e.length-1+i}};if(s["!ref"]){var h=yt(s["!ref"]);c.e.c=Math.max(c.e.c,h.e.c),c.e.r=Math.max(c.e.r,h.e.r),a==-1&&(a=h.e.r+1,c.e.r=a+e.length-1+i)}else a==-1&&(a=0,c.e.r=e.length-1+i);var u=n.header||[],d=0;e.forEach(function(m,g){Tr(m).forEach(function(O){(d=u.indexOf(O))==-1&&(u[d=u.length]=O);var w=m[O],v="z",S="",y=et({c:o+d,r:a+g+i});f=Ec(s,y),w&&typeof w=="object"&&!(w instanceof Date)?s[y]=w:(typeof w=="number"?v="n":typeof w=="boolean"?v="b":typeof w=="string"?v="s":w instanceof Date?(v="d",n.cellDates||(v="n",w=Xr(w)),S=n.dateNF||Ke[14]):w===null&&n.nullError&&(v="e",w=0),f?(f.t=v,f.v=w,delete f.w,delete f.R,S&&(f.z=S)):s[y]=f={t:v,v:w},S&&(f.z=S))})}),c.e.c=Math.max(c.e.c,o+u.length-1);var p=kr(a);if(i)for(d=0;d<u.length;++d)s[ar(d+o)+p]={t:"s",v:u[d]};return s["!ref"]=lt(c),s}function J7(r,e){return zT(null,r,e)}function Ec(r,e,t){if(typeof e=="string"){if(Array.isArray(r)){var n=xr(e);return r[n.r]||(r[n.r]=[]),r[n.r][n.c]||(r[n.r][n.c]={t:"z"})}return r[e]||(r[e]={t:"z"})}return typeof e!="number"?Ec(r,et(e)):Ec(r,et({r:e,c:t||0}))}function e9(r,e){if(typeof e=="number"){if(e>=0&&r.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var t=r.SheetNames.indexOf(e);if(t>-1)return t;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function jO(){return{SheetNames:[],Sheets:{}}}function zO(r,e,t,n){var i=1;if(!t)for(;i<=65535&&r.SheetNames.indexOf(t="Sheet"+i)!=-1;++i,t=void 0);if(!t||r.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&r.SheetNames.indexOf(t)>=0){var s=t.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var a=s&&s[1]||t;for(++i;i<=65535&&r.SheetNames.indexOf(t=a+i)!=-1;++i);}if(_T(t),r.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return r.SheetNames.push(t),r.Sheets[t]=e,t}function t9(r,e,t){r.Workbook||(r.Workbook={}),r.Workbook.Sheets||(r.Workbook.Sheets=[]);var n=e9(r,e);switch(r.Workbook.Sheets[n]||(r.Workbook.Sheets[n]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}r.Workbook.Sheets[n].Hidden=t}function r9(r,e){return r.z=e,r}function GT(r,e,t){return e?(r.l={Target:e},t&&(r.l.Tooltip=t)):delete r.l,r}function n9(r,e,t){return GT(r,"#"+e,t)}function i9(r,e,t){r.c||(r.c=[]),r.c.push({t:e,a:t||"SheetJS"})}function s9(r,e,t,n){for(var i=typeof e!="string"?e:yt(e),s=typeof e=="string"?e:lt(e),a=i.s.r;a<=i.e.r;++a)for(var o=i.s.c;o<=i.e.c;++o){var l=Ec(r,a,o);l.t="n",l.F=s,delete l.v,a==i.s.r&&o==i.s.c&&(l.f=t,n&&(l.D=!0))}return r}var Eu={encode_col:ar,encode_row:kr,encode_cell:et,encode_range:lt,decode_col:yO,decode_row:vO,split_cell:kF,decode_cell:xr,decode_range:Ln,format_cell:As,sheet_add_aoa:pS,sheet_add_json:zT,sheet_add_dom:DT,aoa_to_sheet:rf,json_to_sheet:J7,table_to_sheet:NT,table_to_book:m7,sheet_to_csv:qO,sheet_to_txt:jT,sheet_to_json:bd,sheet_to_html:$T,sheet_to_formulae:K7,sheet_to_row_object_array:bd,sheet_get_cell:Ec,book_new:jO,book_append_sheet:zO,book_set_sheet_visibility:t9,cell_set_number_format:r9,cell_set_hyperlink:GT,cell_set_internal_link:n9,cell_add_comment:i9,sheet_set_array_formula:s9,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},k0;function a9(r){k0=r}function o9(r,e){var t=k0(),n=e??{};if(r==null||r["!ref"]==null)return t.push(null),t;var i=yt(r["!ref"]),s=n.FS!==void 0?n.FS:",",a=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),f=new RegExp((s=="|"?"\\|":s)+"+$"),c="",h=[];n.dense=Array.isArray(r);for(var u=n.skipHidden&&r["!cols"]||[],d=n.skipHidden&&r["!rows"]||[],p=i.s.c;p<=i.e.c;++p)(u[p]||{}).hidden||(h[p]=ar(p));var m=i.s.r,g=!1,O=0;return t._read=function(){if(!g)return g=!0,t.push("\uFEFF");for(;m<=i.e.r;)if(++m,!(d[m-1]||{}).hidden&&(c=qT(r,i,m-1,h,a,l,s,n),c!=null&&(n.strip&&(c=c.replace(f,"")),c||n.blankrows!==!1)))return t.push((O++?o:"")+c);return t.push(null)},t}function l9(r,e){var t=k0(),n=e||{},i=n.header!=null?n.header:RT,s=n.footer!=null?n.footer:QT;t.push(i);var a=Ln(r["!ref"]);n.dense=Array.isArray(r),t.push(FT(r,a,n));var o=a.s.r,l=!1;return t._read=function(){if(o>a.e.r)return l||(l=!0,t.push("</table>"+s)),t.push(null);for(;o<=a.e.r;){t.push(PT(r,a,o,n)),++o;break}},t}function f9(r,e){var t=k0({objectMode:!0});if(r==null||r["!ref"]==null)return t.push(null),t;var n={t:"n",v:0},i=0,s=1,a=[],o=0,l="",f={s:{r:0,c:0},e:{r:0,c:0}},c=e||{},h=c.range!=null?c.range:r["!ref"];switch(c.header===1?i=1:c.header==="A"?i=2:Array.isArray(c.header)&&(i=3),typeof h){case"string":f=yt(h);break;case"number":f=yt(r["!ref"]),f.s.r=h;break;default:f=h}i>0&&(s=0);var u=kr(f.s.r),d=[],p=0,m=Array.isArray(r),g=f.s.r,O=0,w={};m&&!r[g]&&(r[g]=[]);var v=c.skipHidden&&r["!cols"]||[],S=c.skipHidden&&r["!rows"]||[];for(O=f.s.c;O<=f.e.c;++O)if(!(v[O]||{}).hidden)switch(d[O]=ar(O),n=m?r[g][O]:r[d[O]+u],i){case 1:a[O]=O-f.s.c;break;case 2:a[O]=d[O];break;case 3:a[O]=c.header[O-f.s.c];break;default:if(n==null&&(n={w:"__EMPTY",t:"s"}),l=o=As(n,null,c),p=w[o]||0,!p)w[o]=1;else{do l=o+"_"+p++;while(w[l]);w[o]=p,w[l]=1}a[O]=l}return g=f.s.r+s,t._read=function(){for(;g<=f.e.r;)if(!(S[g-1]||{}).hidden){var y=VT(r,f,g,d,i,a,m,c);if(++g,y.isempty===!1||(i===1?c.blankrows!==!1:c.blankrows)){t.push(y.row);return}}return t.push(null)},t}var c9={to_json:f9,to_html:l9,to_csv:o9,set_readable:a9};const h9=gc.version,u9=Object.freeze(Object.defineProperty({__proto__:null,CFB:Ye,SSF:zk,parse_xlscfb:LO,parse_zip:BT,read:wd,readFile:Xy,readFileSync:Xy,set_cptable:mQ,set_fs:XQ,stream:c9,utils:Eu,version:h9,write:_0,writeFile:Xm,writeFileAsync:Y7,writeFileSync:Xm,writeFileXLSX:H7,writeXLSX:XO},Symbol.toStringTag,{value:"Module"}));function HT(r,e="txt"){let t="Report";return r&&r.length>0&&(t=r),`${t}_${nt.local().toFormat("yyyy-MM-dd_HH-mm-ss")}.${e}`}function d9(r){let e='<table id="ted_001">';return e+="<thead>",e+="<tr>",Object.keys(r[0]).forEach(t=>{e+="<th>"+t+"</th>"}),e+="</tr>",e+="</thead>",e+="<tbody>",r.forEach(t=>{e+="<tr>",Object.values(t).forEach(n=>{e+="<td>"+n+"</td>"}),e+="</tr>"}),e+="</tbody>",e+="</table>",e=`<!DOCTYPE html>
    <html>
    <head>
    <style>
    #ted_001 {
      font-family: Arial, Helvetica, sans-serif;
      border-collapse: collapse;
      width: 100%;
    }
    
    #ted_001 td, #ted_001 th {
      border: 1px solid #ddd;
      padding: 8px;
    }
    
    #ted_001 tr:nth-child(even){background-color: #f2f2f2;}
    
    #ted_001 tr:hover {background-color: #ddd;}
    
    #ted_001 th {
      padding-top: 12px;
      padding-bottom: 12px;
      text-align: left;
      background-color: #04AA6D;
      color: white;
    }
    </style>
    </head>
    <body>
    ${e}
    </body>
</html>
    `,e}function YT(r,e,t=0){return r.map(n=>{let i={...n};return Object.keys(n).forEach(s=>{if(e[s]&&e[s].hidden)delete i[s];else if(e[s]&&e[s].decorator&&e[s].decorator.component&&e[s].decorator.component===ZR){let a=nt.fromISO(n[s]);a.isValid?i[s]=a.toFormat("yyyy-MM-dd HH:mm:ss"):i[s]=n[s]}else n[s]!==null&&typeof n[s]=="object"&&(i[s]=JSON.stringify(n[s]),t>0&&i[s].length>=t&&(i[s]=i[s].substring(0,t),console.warn(`El valor de la columna ${s} es muy largo para ser exportado, se ha limitado a ${t} caracteres`)))}),delete i.internal_hash_row,i})}const p9=(r,e,t)=>{try{let a=!1,o=YT(r,e,32767);if(console.log("FormatedData",o,u9),o&&o.length>0){var n=Eu.json_to_sheet(o),i=Eu.book_new();Eu.book_append_sheet(i,n,"Report");let l="xlsx",f=HT(t,l);var s={bookType:l,bookSST:!1,type:"binary",FS:";"};Xm(i,f,s)}}catch(a){console.error(a)}},m9=(r,e,t)=>{try{let n=YT(r,e),i=d9(n);const s=document.createElement("a");s.setAttribute("href","data:text/html;charset=utf-8,"+encodeURIComponent(i)),s.setAttribute("download",HT(t,"html")),s.style.display="none",document.body.appendChild(s),s.click(),document.body.removeChild(s)}catch(n){console.error(n)}};function KT(r){var e=8;function t(m,g){var O=(m&65535)+(g&65535),w=(m>>16)+(g>>16)+(O>>16);return w<<16|O&65535}function n(m,g){return m>>>g|m<<32-g}function i(m,g){return m>>>g}function s(m,g,O){return m&g^~m&O}function a(m,g,O){return m&g^m&O^g&O}function o(m){return n(m,2)^n(m,13)^n(m,22)}function l(m){return n(m,6)^n(m,11)^n(m,25)}function f(m){return n(m,7)^n(m,18)^i(m,3)}function c(m){return n(m,17)^n(m,19)^i(m,10)}function h(m,g){var O=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),w=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225),v=new Array(64),S,y,b,x,A,k,E,T,_,N,Z,z;m[g>>5]|=128<<24-g%32,m[(g+64>>9<<4)+15]=g;for(var _=0;_<m.length;_+=16){S=w[0],y=w[1],b=w[2],x=w[3],A=w[4],k=w[5],E=w[6],T=w[7];for(var N=0;N<64;N++)N<16?v[N]=m[N+_]:v[N]=t(t(t(c(v[N-2]),v[N-7]),f(v[N-15])),v[N-16]),Z=t(t(t(t(T,l(A)),s(A,k,E)),O[N]),v[N]),z=t(o(S),a(S,y,b)),T=E,E=k,k=A,A=t(x,Z),x=b,b=y,y=S,S=t(Z,z);w[0]=t(S,w[0]),w[1]=t(y,w[1]),w[2]=t(b,w[2]),w[3]=t(x,w[3]),w[4]=t(A,w[4]),w[5]=t(k,w[5]),w[6]=t(E,w[6]),w[7]=t(T,w[7])}return w}function u(m){for(var g=Array(),O=(1<<e)-1,w=0;w<m.length*e;w+=e)g[w>>5]|=(m.charCodeAt(w/e)&O)<<24-w%32;return g}function d(m){m=m.replace(/\r\n/g,`
`);for(var g="",O=0;O<m.length;O++){var w=m.charCodeAt(O);w<128?g+=String.fromCharCode(w):w>127&&w<2048?(g+=String.fromCharCode(w>>6|192),g+=String.fromCharCode(w&63|128)):(g+=String.fromCharCode(w>>12|224),g+=String.fromCharCode(w>>6&63|128),g+=String.fromCharCode(w&63|128))}return g}function p(m){for(var g="0123456789abcdef",O="",w=0;w<m.length*4;w++)O+=g.charAt(m[w>>2]>>(3-w%4)*8+4&15)+g.charAt(m[w>>2]>>(3-w%4)*8&15);return O}return r=d(r),p(h(u(r),r.length*e))}function g9(r){return new Promise((e,t)=>{const n=r.data,i=r.columns;let s=r.hash_last_data,a=!1,o=[];if(Ff(n)&&n.length>0)try{let l=JSON.stringify(n),f=KT(l&&l.length>0?l:"0");s!==f?(s=f,o=O9(n,i),a=!0):console.log("No changes on Data on Table widget"),e({data:o,hash_last_data:s,different_data:a})}catch(l){console.log(l),t(l)}})}function Ff(r){return r&&Array.isArray(r)}function O9(r,e){let t={};return r.map((i,s)=>{try{i.internal_hash_row=0;let o=KT(JSON.stringify(i));t[o]&&(console.error("Hay un registro duplicado en la tabla",i),o=o+"-"+s,t[o]=!0),t[o]=!0,i.internal_hash_row=o}catch(o){console.error(o,i)}let a={};for(let o in e)Object.hasOwn(i,o)&&(a[o]=i[o]);for(let o in i)a[o]||(a[o]=i[o]);return a}).filter(i=>i&&i.internal_hash_row)}function x9(r,e,t,n,i){try{let s=e();s&&s.length>0?m9(s,t(),n()):(i(2),alert("Select the rows to export."))}catch(s){console.error(s)}}function v9(r,e,t,n,i){try{let s=e();s&&s.length>0?p9(s,t(),n()):(i(2),alert("Select the rows to export."))}catch(s){console.error(s)}}function y9(r,e,t,n,i){if(e()){let s=t().refresh_time+1;n[s]?t(t().refresh_time=s,!0):t(t().refresh_time=0,!0),H(i,Y(n[t().refresh_time]))}else console.warn("ChangeIntervalRefresh: requestData not setted.")}function w9(r,e,t,n){try{let i=e();i&&i.length>0?t()({rows:i}):(alert("Select the rows to delete."),n(2))}catch(i){console.error(i)}}function b9(r,e,t,n){H(e,Y(r.target.dataset.column)),H(t,!C(t)),n()}function qy(r,e,t,n){C(e)&&C(e).length>0?t():(t(),H(n,0))}function _9(r,e,t,n,i){H(e,Y(r.target.checked)),C(e)?(H(t,Y([])),C(n).forEach(s=>{H(t,Y(C(t).concat(s.map(a=>a.internal_hash_row))))})):H(t,Y([])),i()}function k9(r,e){return H(e,!C(e)),!1}function jy(r,e,t,n){e()==1&&H(t,Y([]));let i=r.target.dataset.internal_hash_row;r.target.checked?C(t).push(i):H(t,Y(C(t).filter(s=>s!==i))),n()}var S9=J('<div class="field has-addons"><p class="control"><input class="input size_search is-small svelte-1b7i42n" type="text" placeholder="Search"></p> <p class="control"><button aria-label="close" class="button is-small"><span class="icon is-small"><i class="fas fa-search"></i></span></button></p></div>'),T9=J('<button aria-label="close" class="button is-small" title="Export to Excel"><span class="icon"><i></i></span></button> <button aria-label="close" class="button is-small" title="Export to Html"><span class="icon"><i class="fa-solid fa-download"></i></span></button>',1),C9=(r,e)=>{e(1)},A9=(r,e)=>{e(2)},E9=(r,e)=>{e(0)},P9=J('<div class="dropdown is-hoverable is-right" title="Selection type"><div class="dropdown-trigger"><button aria-label="close" class="button is-small" aria-haspopup="true" aria-controls="dropdown-menu"><span class="icon"><i class="far fa-list-alt"></i></span></button></div> <div class="dropdown-menu" role="menu"><div class="dropdown-content"><a class="dropdown-item is-size-7"><input class="check_margin svelte-1b7i42n" type="radio" name="selection_type" value="1"> <span class="icon"><i class="fas fa-check"></i></span> <span>Simple</span></a> <a class="dropdown-item is-size-7"><input class="check_margin svelte-1b7i42n" type="radio" name="selection_type" value="2"> <span class="icon"><i class="fas fa-check-double"></i></span> <span>Multiple</span></a> <hr class="dropdown-divider"> <a class="dropdown-item is-size-7"><input class="check_margin svelte-1b7i42n" type="radio" name="selection_type" value="0"> <span class="icon"><i class="fas fa-ban"></i></span> <span>None</span></a></div></div></div>'),R9=J('<button aria-label="close" class="button is-small" title="Delete row"><span class="icon"><i></i></span></button>'),Q9=J('<button aria-label="close" class="button is-small"><span class="icon"><i class="far fa-edit"></i></span></button>'),F9=(r,e)=>{e()&&e()()},$9=J('<button aria-label="close" class="button is-small"><span class="icon"><i class="far fa-file"></i></span></button>'),D9=J('<span class="icon has-text-info"><i class="fas fa-spinner fa-pulse"></i></span>'),N9=J('<span class="icon"><i class="fas fa-hourglass-half"></i></span>'),M9=J('<span class="icon has-text-danger"><i class="fas fa-exclamation-triangle"></i></span>'),I9=J('<button class="button is-small"><!> <span> </span></button>'),L9=J('<span class="slot_padding svelte-1b7i42n"><!></span>'),B9=J('<th class="has-text-centered has-text-white"><span>-</span></th>'),Z9=J('<th class="has-text-centered has-text-white"><input type="checkbox"></th>'),W9=J('<th class="has-text-centered has-text-white"><i class="fas fa-pen"></i></th>'),U9=J('<i class="fas fa-caret-down"></i>'),X9=J('<i class="fas fa-caret-up"></i>'),V9=J('<th class="has-text-centered show_cursor_mouse has-text-white svelte-1b7i42n"> <!></th>'),q9=J('<td class="has-text-centered"><input type="radio" name="single_select" class="show_cursor_mouse svelte-1b7i42n"></td>'),j9=J('<td class="has-text-centered"><input class="show_cursor_mouse svelte-1b7i42n" type="checkbox"></td>'),z9=J('<td class="has-text-centered show_cursor_mouse svelte-1b7i42n"><span class="icon is-small"><i class="fas fa-pen"></i></span></td>'),G9=J("<tr><td> </td><!><!><!></tr>"),H9=(r,e,t)=>{H(e,1),t()},Y9=(r,e,t)=>{C(e)>1&&H(e,C(e)-1),t()},K9=(r,e)=>{e()},J9=(r,e,t)=>{H(e,C(e)+1),t()},eZ=J('<button class="button is-small"> </button>'),tZ=(r,e,t)=>{H(e,C(e)+2),t()},rZ=J('<button class="button is-small"> </button>'),nZ=(r,e,t)=>{H(e,C(e)+3),t()},iZ=J('<button class="button is-small"> </button>'),sZ=(r,e,t)=>{H(e,C(e)+4),t()},aZ=J('<button class="button is-small"> </button>'),oZ=(r,e,t,n)=>{C(e)<C(t)&&(H(e,C(e)+1),n())},lZ=(r,e,t,n)=>{H(e,Y(C(t))),n()},fZ=J('<div class="level-item"><span> </span></div> <div class="level-item"><div class="buttons has-addons"><button aria-label="close" class="button is-small"><span class="icon"><i class="fas fa-angle-double-left"></i></span></button> <button aria-label="close" class="button is-small"><span class="icon"><i class="fas fa-angle-left"></i></span></button> <button class="button is-small is-info"> </button> <!> <!> <!> <!> <button aria-label="close" class="button is-small"><span class="icon"><i class="fas fa-angle-right"></i></span></button> <button aria-label="close" class="button is-small"><span class="icon"><i class="fas fa-angle-double-right"></i></span></button></div></div>',1),cZ=(r,e,t)=>{e(r.target.value),t()},hZ=J("<option> </option>"),uZ=J('<div class="table-container is-size-7"><table class="table is-bordered is-striped is-narrow is-hoverable is-fullwidth"><thead><tr class="has-background-link-dark"><th class="has-text-centered has-text-white resizable">#</th><!><!><!></tr></thead><tbody><!></tbody></table></div> <div class="table_pagination svelte-1b7i42n"><nav class="level"><div class="level-left"><!></div> <div class="level-right"><span class="level-item"><span class="label_rows_per_page svelte-1b7i42n">Rows per page</span> <div class="select is-small"><select name="rows_per_page"></select></div></span></div></nav></div>',1),dZ=J('<div class="has-text-centered has-text-link-dark"><i class="fa fa-table" aria-hidden="true"></i> There is no data to show</div>'),pZ=(r,e)=>{H(e,!1)},mZ=J('<div class="column"><label class="checkbox"><input type="checkbox"> </label></div>'),gZ=(r,e)=>{H(e,!1)},OZ=J('<!> <!> <div class="modal"><div class="modal-card"><header class="modal-card-head has-background-dark"><p class="modal-card-title has-text-white"><b><span>Columns</span></b></p> <button class="delete" aria-label="close"></button></header> <section class="modal-card-body"><div class="columns"></div></section> <footer class="modal-card-foot has-background-dark"><button class="button is-success is-small"><span>Accept</span></button> <button class="button is-small"><span>Cancel</span></button></footer></div></div>',1);function vh(r,e){gt(e,!0);let t=ge(e,"RawDataTable",15),n=ge(e,"SelectionType",15,0),i=ge(e,"columns",27,()=>Y({})),s=ge(e,"ShowNewButton",11,!1),a=ge(e,"ShowEditButton",11,!1),o=ge(e,"ShowSelectionButton",11,!0),l=ge(e,"ShowExportButton",11,!0),f=ge(e,"iconExport",11,"fa-solid fa-file-excel"),c=ge(e,"iconDeleteRow",11,"fa-solid fa-trash"),h=ge(e,"ShowDeleteButton",11,!1),u=ge(e,"PageSize",27,()=>Y([25,50,100,200,300,500,1e3])),d=ge(e,"PageSizeSelected",15,0),p=ge(e,"relatedTablesForAutoRefresh",27,()=>Y([])),m=ge(e,"fileNameExport",11,""),g=ge(e,"requestData",15),O=ge(e,"rowClassFunction",3,function(Le){return""}),w=ge(e,"left_items",27,()=>Y([])),v=ge(e,"right_items",27,()=>Y([])),S=ge(e,"onclickrow",3,Le=>{}),y=ge(e,"oneditrow",3,Le=>{console.trace("oneditrow no implemented.")}),b=ge(e,"onnewrow",3,Le=>{console.trace("onnewrow no implemented.")}),x=ge(e,"ondeleterow",3,Le=>{bt(Le)}),A=ge(e,"onselectrows",3,Le=>{}),k=ge(e,"onclickcell",3,Le=>{});const E=new as;let T=Se(Y([])),_=Se(Y([])),N=Se(void 0),Z=Se(!1),z=Se(!1),ee=Se(void 0),ae=Se(!1),xe=Se(999),V=Se(!0),ue=[10,20,30,45,60,120,240,480,960,1920,3840],ie=Se(1),P=Se(0),I=Se(0),B=Se(Y([])),W=Se(!1),K=Se(!0),re=Se(Y({})),pe;j1(()=>{t()&&de()});function fe(){return g()&&g().url&&g().url.length>0}function de(){$t()&&(clearTimeout(pe),pe=setTimeout(async()=>{try{let Le=await g9({data:t(),columns:i(),hash_last_data:it});it=Le.hash_last_data,Le.different_data&&(t(Le.data),ze(),Ce())}catch(Le){console.trace(Le)}},500))}function Ue(){A()({rows:De()})}Ut(()=>{H(xe,0),g()||g({url:void 0,refresh_time:4,params:void 0,method:"GET",headers:void 0,authorization:{basic:void 0,bearer:void 0}}),g(g().method=g().method||"GET",!0),g(g().refresh_time=Number(g().refresh_time)?Number(g().refresh_time):4,!0),lQ.subscribe(Le=>{try{p().includes(Le.table)&&Fe++}catch(Je){console.error(Je)}})});function q(Le,Je){let lr=[];if(Je=parseInt(Je),Ff(Le))for(let Ht=0;Ht<Le.length;Ht+=Je){let fr=Le.slice(Ht,Ht+Je);lr.push(fr)}return lr}function ze(){if($t()&&t().length>0){let Le=15;H(re,Y({})),Object.keys(t()[0]).forEach(Je=>{Je==="internal_hash_row"?C(re)[Je]={label:Je.substring(0,Le),hidden:!0}:i()[Je]?(C(re)[Je]=i()[Je],C(re)[Je].label||(C(re)[Je].label=Je.substring(0,Le))):C(re)[Je]={label:Je.substring(0,Le),hidden:!1}})}}function Qe(Le){return C(_).includes(Le)}function De(){let Le=[];return $t()&&(Le=t().filter(Je=>C(_).includes(Je.internal_hash_row))),Le}let Fe=0,ve=setInterval(async()=>{fe()&&(C(xe)==0||Fe>0?(await Te(),H(xe,Y(ue[g().refresh_time])),Fe=0):GP(xe,-1))},1e3),it="";Ua(()=>{clearInterval(ve),clearTimeout(pe)});function ot(Le,Je="asc"){return function(Ht,fr){if(!Ht.hasOwnProperty(Le)||!fr.hasOwnProperty(Le))return 0;const ei=typeof Ht[Le]=="string"?Ht[Le].toUpperCase():Ht[Le],xi=typeof fr[Le]=="string"?fr[Le].toUpperCase():fr[Le];let ti=0;return ei>xi?ti=1:ei<xi&&(ti=-1),Je==="desc"?ti*-1:ti}}function bt(Le){Le.rows&&Le.rows.length>0&&t(t().filter(Je=>Le.rows.find(lr=>lr.key!=Je.key)))}function $t(){return Ff(t())}function Ce(){let Le;C(N)&&C(N).length>0&&$t()?Le=t().filter(Je=>Object.values(Je).filter(Ht=>Ht&&Ht.toString().toUpperCase().includes(C(N).toUpperCase())).length>0):Le=t(),Le&&(H(P,Y(Le.length)),Ve(Le))}function Ve(Le){C(ee)&&(C(K)?Le=Le.sort(ot(C(ee))):Le=Le.sort(ot(C(ee),"desc"))),H(B,Y(q(Le,u()[d()]))),H(I,Y(C(B).length)),C(ie)>C(I)&&H(ie,1),Ae()}function Ae(){let Le=C(B)[C(ie)-1];Le&&H(T,Y(Le.filter(Je=>Je&&Je.internal_hash_row)))}async function Te(){if(C(Z))console.log("There is a petition in progress...");else if(fe())try{H(Z,!0),g().authorization&&g().authorization.bearer?E.setBearerAuthorization(g().authorization.bearer):g().authorization&&g().authorization.basic?E.SetBasicAuthentication(g().authorization.basic.username,g().authorization.basic.password):E.ClearAuthorizationHeader();let Le=g()&&g().method?g().method.toUpperCase():"GET",Je=await E[Le]({url:g().url,data:g().params,headers:g().headers});if(Je&&Je.status==200){let lr=await Je.json();Ff(lr)?(t(lr),H(V,!0)):(t([]),H(V,!1))}else H(V,!1);H(Z,!1)}catch(Le){console.error(Le),H(Z,!1),H(V,!1)}else console.warn("Not url asigned"),H(V,!1)}var Re=OZ(),Nt=be(Re);{const Le=Ar=>{var Rt=S9(),cr=Q(Rt),hr=Q(cr);wt(hr),hr.__change=[qy,N,Ce,xe],R(cr);var xt=ne(cr,2),vt=Q(xt);vt.__click=[qy,N,Ce,xe],R(xt),R(Rt),Jt(hr,()=>C(N),mr=>H(N,mr)),U(Ar,Rt)},Je=Ar=>{var Rt=Ee(),cr=be(Rt);{var hr=xt=>{var vt=T9(),mr=be(vt);mr.__click=[v9,De,i,m,n];var zr=Q(mr),mn=Q(zr);R(zr),R(mr);var F=ne(mr,2);F.__click=[x9,De,i,m,n],Me(()=>ht(mn,Qi(f()),"svelte-1b7i42n")),U(xt,vt)};ce(cr,xt=>{l()&&xt(hr)})}U(Ar,Rt)},lr=Ar=>{var Rt=Ee(),cr=be(Rt);{var hr=xt=>{var vt=P9(),mr=ne(Q(vt),2),zr=Q(mr),mn=Q(zr),F=Q(mn);wt(F),F.__change=[C9,n],Kt(4),R(mn);var j=ne(mn,2),D=Q(j);wt(D),D.__change=[A9,n],Kt(4),R(j);var M=ne(j,4),X=Q(M);wt(X),X.__change=[E9,n],Kt(4),R(M),R(zr),R(mr),R(vt),Me(()=>{Jo(F,n()==1),Jo(D,n()==2),Jo(X,n()==0)}),U(xt,vt)};ce(cr,xt=>{o()&&xt(hr)})}U(Ar,Rt)},Ht=Ar=>{var Rt=Ee(),cr=be(Rt);{var hr=xt=>{var vt=R9();vt.__click=[w9,De,x,n];var mr=Q(vt),zr=Q(mr);R(mr),R(vt),Me(()=>ht(zr,Qi(c()),"svelte-1b7i42n")),U(xt,vt)};ce(cr,xt=>{h()&&xt(hr)})}U(Ar,Rt)},fr=Ar=>{var Rt=Ee(),cr=be(Rt);{var hr=xt=>{var vt=Q9();vt.__click=[k9,z],U(xt,vt)};ce(cr,xt=>{a()&&xt(hr)})}U(Ar,Rt)},ei=Ar=>{var Rt=Ee(),cr=be(Rt);{var hr=xt=>{var vt=$9();vt.__click=[F9,b],U(xt,vt)};ce(cr,xt=>{s()&&xt(hr)})}U(Ar,Rt)},xi=Ar=>{var Rt=Ee(),cr=be(Rt);{var hr=xt=>{var vt=I9();vt.__click=[y9,fe,g,ue,xe];var mr=Q(vt);{var zr=D=>{var M=D9();U(D,M)},mn=D=>{var M=Ee(),X=be(M);{var G=he=>{var te=N9();U(he,te)},oe=he=>{var te=M9();U(he,te)};ce(X,he=>{C(V)?he(G):he(oe,!1)},!0)}U(D,M)};ce(mr,D=>{C(Z)?D(zr):D(mn,!1)})}var F=ne(mr,2),j=Q(F);R(F),R(vt),Me(()=>Ge(j,`${C(xe)??""}s`)),U(xt,vt)};ce(cr,xt=>{g()&&g().url&&xt(hr)})}U(Ar,Rt)},ti=Ar=>{var Rt=Ee(),cr=be(Rt);{var hr=xt=>{var vt=Ee(),mr=be(vt);_r(mr,17,v,Qr,(zr,mn)=>{var F=L9(),j=Q(F);pc(j,()=>C(mn)??dc),R(F),U(zr,F)}),U(xt,vt)};ce(cr,xt=>{Ff(v())&&xt(hr)})}U(Ar,Rt)};Cl(Nt,{get left(){return w()},right:[ti,xi,ei,fr,Ht,lr,Je,Le],right_01:Le,right_02:Je,right_03:lr,right_04:Ht,right_05:fr,right_06:ei,right_07:xi,right_08:ti,$$slots:{right_01:!0,right_02:!0,right_03:!0,right_04:!0,right_05:!0,right_06:!0,right_07:!0,right_08:!0}})}var yr=ne(Nt,2);{var qr=Le=>{var Je=uZ(),lr=be(Je),Ht=Q(lr),fr=Q(Ht),ei=Q(fr),xi=ne(Q(ei));{var ti=te=>{var se=B9();U(te,se)},Ar=te=>{var se=Ee(),le=be(se);{var we=ye=>{var Pe=Z9(),ke=Q(Pe);ke.__click=[_9,W,_,B,Ce],R(Pe),U(ye,Pe)};ce(le,ye=>{n()==2&&ye(we)},!0)}U(te,se)};ce(xi,te=>{n()==1?te(ti):te(Ar,!1)})}var Rt=ne(xi);{var cr=te=>{var se=W9();U(te,se)};ce(Rt,te=>{C(z)&&te(cr)})}var hr=ne(Rt);{var xt=te=>{var se=Ee(),le=be(se);_r(le,17,()=>Object.keys(C(re)),Qr,(we,ye)=>{var Pe=Ee(),ke=be(Pe);{var Ie=He=>{var ut=Ee(),mt=be(ut);{var Xt=Qn=>{var Er=V9();Er.__click=[b9,ee,K,Ce];var Bn=Q(Er),Zn=ne(Bn);{var $r=ft=>{var Wn=Ee(),ca=be(Wn);{var Zs=_t=>{var ri=U9();U(_t,ri)},nr=_t=>{var ri=X9();U(_t,ri)};ce(ca,_t=>{C(K)?_t(Zs):_t(nr,!1)})}U(ft,Wn)};ce(Zn,ft=>{C(ee)==C(ye)&&ft($r)})}R(Er),Me(()=>{Ea(Er,"data-column",C(ye)),Ge(Bn,`${C(re)[C(ye)].label??""} `)}),U(Qn,Er)};ce(mt,Qn=>{(!C(re)[C(ye)].hidden||!C(re)[C(ye)].hidden==null)&&Qn(Xt)})}U(He,ut)};ce(ke,He=>{C(re)[C(ye)]&&He(Ie)})}U(we,Pe)}),U(te,se)};ce(hr,te=>{C(re)&&te(xt)})}R(ei),R(fr);var vt=ne(fr),mr=Q(vt);{var zr=te=>{var se=Ee(),le=be(se);_r(le,19,()=>C(T),we=>we.internal_hash_row,(we,ye,Pe)=>{var ke=G9();const Ie=kl(()=>Qi(O()(C(ye))));ke.__click=()=>{S()&&S()({row:gr(C(ye)),id:gr(C(Pe))})};var He=Q(ke),ut=Q(He,!0);R(He);var mt=ne(He);{var Xt=$r=>{var ft=q9(),Wn=Q(ft);wt(Wn),Me(()=>Jo(Wn,Qe(C(ye).internal_hash_row))),Wn.__click=[jy,n,_,Ue],R(ft),Me(()=>Ea(Wn,"data-internal_hash_row",C(ye).internal_hash_row)),U($r,ft)},Qn=$r=>{var ft=Ee(),Wn=be(ft);{var ca=Zs=>{var nr=j9(),_t=Q(nr);wt(_t),Me(()=>Jo(_t,Qe(C(ye).internal_hash_row))),_t.__click=[jy,n,_,Ue],R(nr),Me(()=>Ea(_t,"data-internal_hash_row",C(ye).internal_hash_row)),U(Zs,nr)};ce(Wn,Zs=>{n()==2&&Zs(ca)},!0)}U($r,ft)};ce(mt,$r=>{n()==1?$r(Xt):$r(Qn,!1)})}var Er=ne(mt);{var Bn=$r=>{var ft=z9();ft.__click=()=>{y()&&y()(gr(C(T)[C(Pe)]))},U($r,ft)};ce(Er,$r=>{C(z)&&$r(Bn)})}var Zn=ne(Er);_r(Zn,17,()=>Object.keys(C(ye)),Qr,($r,ft)=>{var Wn=Ee(),ca=be(Wn);{var Zs=nr=>{var _t=Ee(),ri=be(_t);{var bP=W0=>{var ev=Ee(),_P=be(ev);{var kP=qo=>{var ha=Ee();const Eh=kl(()=>C(re)[C(ft)].decorator.component);var TP=be(ha);JP(TP,()=>C(Eh),(CP,AP)=>{AP(CP,ov({onclickcell:Ja=>{k()&&k()({field:gr(C(ft)),data:gr(C(ye))})}},()=>{var Ja,tv;return(tv=(Ja=C(re)[C(ft)])==null?void 0:Ja.decorator)==null?void 0:tv.props},{get row(){return C(T)[C(Pe)]},set row(Ja){C(T)[C(Pe)]=Ja},get value(){return C(ye)[C(ft)]},set value(Ja){C(ye)[C(ft)]=Ja}}))}),U(qo,ha)},SP=qo=>{Rm(qo,ov(()=>{var ha,Eh;return(Eh=(ha=C(re)[C(ft)])==null?void 0:ha.decorator)==null?void 0:Eh.props},{onclickcell:ha=>{k()&&k()({field:gr(C(ft)),data:gr(C(ye))})},get value(){return C(ye)[C(ft)]},set value(ha){C(ye)[C(ft)]=ha}}))};ce(_P,qo=>{C(re)[C(ft)].decorator&&C(re)[C(ft)].decorator.component?qo(kP):qo(SP,!1)})}U(W0,ev)};ce(ri,W0=>{(!C(re)[C(ft)].hidden||C(re)[C(ft)].hidden==null)&&W0(bP)})}U(nr,_t)};ce(ca,nr=>{C(re)[C(ft)]&&nr(Zs)})}U($r,Wn)}),R(ke),Me(()=>{ht(ke,C(Ie),"svelte-1b7i42n"),Ge(ut,C(Pe)+1+u()[d()]*(C(ie)-1))}),U(we,ke)}),U(te,se)};ce(mr,te=>{C(T)&&te(zr)})}R(vt),R(Ht),R(lr);var mn=ne(lr,2),F=Q(mn),j=Q(F),D=Q(j);{var M=te=>{var se=fZ(),le=be(se),we=Q(le),ye=Q(we);R(we),R(le);var Pe=ne(le,2),ke=Q(Pe),Ie=Q(ke);Ie.__click=[H9,ie,Ae];var He=ne(Ie,2);He.__click=[Y9,ie,Ae];var ut=ne(He,2);ut.__click=[K9,Ae];var mt=Q(ut,!0);R(ut);var Xt=ne(ut,2);{var Qn=nr=>{var _t=eZ();_t.__click=[J9,ie,Ae];var ri=Q(_t,!0);R(_t),Me(()=>Ge(ri,C(ie)+1)),U(nr,_t)};ce(Xt,nr=>{C(ie)+1<=C(I)&&nr(Qn)})}var Er=ne(Xt,2);{var Bn=nr=>{var _t=rZ();_t.__click=[tZ,ie,Ae];var ri=Q(_t,!0);R(_t),Me(()=>Ge(ri,C(ie)+2)),U(nr,_t)};ce(Er,nr=>{C(ie)+2<=C(I)&&nr(Bn)})}var Zn=ne(Er,2);{var $r=nr=>{var _t=iZ();_t.__click=[nZ,ie,Ae];var ri=Q(_t,!0);R(_t),Me(()=>Ge(ri,C(ie)+3)),U(nr,_t)};ce(Zn,nr=>{C(ie)+3<=C(I)&&nr($r)})}var ft=ne(Zn,2);{var Wn=nr=>{var _t=aZ();_t.__click=[sZ,ie,Ae];var ri=Q(_t,!0);R(_t),Me(()=>Ge(ri,C(ie)+4)),U(nr,_t)};ce(ft,nr=>{C(ie)+4<=C(I)&&nr(Wn)})}var ca=ne(ft,2);ca.__click=[oZ,ie,I,Ae];var Zs=ne(ca,2);Zs.__click=[lZ,ie,I,Ae],R(ke),R(Pe),Me(()=>{Ge(ye,`Page ${C(ie)??""} of ${C(I)??""} (Total ${C(P)??""}
							rows)`),Ge(mt,C(ie))}),U(te,se)};ce(D,te=>{C(B)&&C(B).length>1&&te(M)})}R(j);var X=ne(j,2),G=Q(X),oe=ne(Q(G),2),he=Q(oe);he.__change=[cZ,d,Ce],_r(he,21,u,Qr,(te,se,le)=>{var we=hZ();we.value=(we.__value=le)==null?"":le;var ye=Q(we,!0);R(we),Me(()=>{l3(we,C(se)==u()[d()]),Ge(ye,C(se))}),U(te,we)}),R(he),R(oe),R(G),R(X),R(F),R(mn),U(Le,Je)},at=Le=>{var Je=dZ();U(Le,Je)};ce(yr,Le=>{C(T)?Le(qr):Le(at,!1)})}var Mt=ne(yr,2),jr=Q(Mt),Gt=Q(jr),Bi=ne(Q(Gt),2);Bi.__click=[pZ,ae],R(Gt);var la=ne(Gt,2),Vo=Q(la);_r(Vo,21,()=>Object.keys(i()),Qr,(Le,Je)=>{var lr=mZ(),Ht=Q(lr),fr=ne(Q(Ht));R(Ht),R(lr),Me(()=>Ge(fr,` ${C(Je)??""}`)),U(Le,lr)}),R(Vo),R(la);var fa=ne(la,2),Ka=ne(Q(fa),2);return Ka.__click=[gZ,ae],R(fa),R(jr),R(Mt),Me(()=>S2(Mt,"is-active",C(ae))),U(r,Re),Ot({GetSelectedRows:De})}vr(["change","click"]);vr(["click"]);function xZ(r,e,t,n,i){H(e,Y(r.target.value)),H(t,Y(n().filter(s=>s.name.toLowerCase().includes(C(e).toLowerCase())))),H(i,!0)}var vZ=(r,e,t)=>e(C(t)),yZ=J('<a href="#" class="dropdown-item"> </a>'),wZ=J('<div class="dropdown is-active"><div class="dropdown-menu" role="menu"><div class="dropdown-content svelte-ucicw1"></div></div></div>'),bZ=J('<div class="field is-horizontal"><div><label class="label"> </label></div> <div class="field-body"><div class="field is-narrow"><div class="control"><div class="control"><input type="text"> <input type="hidden"></div> <!></div></div></div></div>');function _Z(r,e){gt(e,!0);let t=ge(e,"options",27,()=>Y([{name:"Manzana",value:"1"},{name:"Durazno",value:"2"}])),n=ge(e,"label",11,""),i=ge(e,"selectedValue",15,""),s=ge(e,"classLabel",11,"is-normal"),a=ge(e,"classInput",11,""),o=ge(e,"placeholder",11,"Type to see options"),l=ge(e,"onselect",3,()=>{}),f=Se(Y(t())),c=Se(!1),h=Se("");function u(E){H(h,Y(E.name)),i(E.value),H(c,!1),l()(E)}function d(){H(f,Y(t().filter(E=>E.name.toLowerCase().includes(C(h).toLowerCase()))))}var p=bZ(),m=Q(p),g=Q(m),O=Q(g,!0);R(g),R(m);var w=ne(m,2),v=Q(w),S=Q(v),y=Q(S),b=Q(y);wt(b),b.__input=[xZ,h,f,t,c];var x=ne(b,2);wt(x),R(y);var A=ne(y,2);{var k=E=>{var T=wZ(),_=Q(T),N=Q(_);_r(N,21,()=>C(f),Qr,(Z,z)=>{var ee=yZ();ee.__click=[vZ,u,z];var ae=Q(ee,!0);R(ee),Me(()=>Ge(ae,C(z).name)),U(Z,ee)}),R(N),R(_),R(T),U(E,T)};ce(A,E=>{C(c)&&C(f).length>0&&E(k)})}R(S),R(v),R(w),R(p),Me(()=>{ht(m,`field-label ${s()??""} svelte-ucicw1`),Ge(O,n()),ht(b,`input ${a()??""} svelte-ucicw1`),Ea(b,"placeholder",o())}),YP("focus",b,d),Jt(b,()=>C(h),E=>H(h,E)),Jt(x,i),U(r,p),Ot()}vr(["input","click"]);var kZ={value:()=>{}};function JT(){for(var r=0,e=arguments.length,t={},n;r<e;++r){if(!(n=arguments[r]+"")||n in t||/[\s.]/.test(n))throw new Error("illegal type: "+n);t[n]=[]}return new Pu(t)}function Pu(r){this._=r}function SZ(r,e){return r.trim().split(/^|\s+/).map(function(t){var n="",i=t.indexOf(".");if(i>=0&&(n=t.slice(i+1),t=t.slice(0,i)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}})}Pu.prototype=JT.prototype={constructor:Pu,on:function(r,e){var t=this._,n=SZ(r+"",t),i,s=-1,a=n.length;if(arguments.length<2){for(;++s<a;)if((i=(r=n[s]).type)&&(i=TZ(t[i],r.name)))return i;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++s<a;)if(i=(r=n[s]).type)t[i]=zy(t[i],r.name,e);else if(e==null)for(i in t)t[i]=zy(t[i],r.name,null);return this},copy:function(){var r={},e=this._;for(var t in e)r[t]=e[t].slice();return new Pu(r)},call:function(r,e){if((i=arguments.length-2)>0)for(var t=new Array(i),n=0,i,s;n<i;++n)t[n]=arguments[n+2];if(!this._.hasOwnProperty(r))throw new Error("unknown type: "+r);for(s=this._[r],n=0,i=s.length;n<i;++n)s[n].value.apply(e,t)},apply:function(r,e,t){if(!this._.hasOwnProperty(r))throw new Error("unknown type: "+r);for(var n=this._[r],i=0,s=n.length;i<s;++i)n[i].value.apply(e,t)}};function TZ(r,e){for(var t=0,n=r.length,i;t<n;++t)if((i=r[t]).name===e)return i.value}function zy(r,e,t){for(var n=0,i=r.length;n<i;++n)if(r[n].name===e){r[n]=kZ,r=r.slice(0,n).concat(r.slice(n+1));break}return t!=null&&r.push({name:e,value:t}),r}var Vm="http://www.w3.org/1999/xhtml";const Gy={svg:"http://www.w3.org/2000/svg",xhtml:Vm,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function S0(r){var e=r+="",t=e.indexOf(":");return t>=0&&(e=r.slice(0,t))!=="xmlns"&&(r=r.slice(t+1)),Gy.hasOwnProperty(e)?{space:Gy[e],local:r}:r}function CZ(r){return function(){var e=this.ownerDocument,t=this.namespaceURI;return t===Vm&&e.documentElement.namespaceURI===Vm?e.createElement(r):e.createElementNS(t,r)}}function AZ(r){return function(){return this.ownerDocument.createElementNS(r.space,r.local)}}function eC(r){var e=S0(r);return(e.local?AZ:CZ)(e)}function EZ(){}function GO(r){return r==null?EZ:function(){return this.querySelector(r)}}function PZ(r){typeof r!="function"&&(r=GO(r));for(var e=this._groups,t=e.length,n=new Array(t),i=0;i<t;++i)for(var s=e[i],a=s.length,o=n[i]=new Array(a),l,f,c=0;c<a;++c)(l=s[c])&&(f=r.call(l,l.__data__,c,s))&&("__data__"in l&&(f.__data__=l.__data__),o[c]=f);return new ts(n,this._parents)}function RZ(r){return r==null?[]:Array.isArray(r)?r:Array.from(r)}function QZ(){return[]}function tC(r){return r==null?QZ:function(){return this.querySelectorAll(r)}}function FZ(r){return function(){return RZ(r.apply(this,arguments))}}function $Z(r){typeof r=="function"?r=FZ(r):r=tC(r);for(var e=this._groups,t=e.length,n=[],i=[],s=0;s<t;++s)for(var a=e[s],o=a.length,l,f=0;f<o;++f)(l=a[f])&&(n.push(r.call(l,l.__data__,f,a)),i.push(l));return new ts(n,i)}function rC(r){return function(){return this.matches(r)}}function nC(r){return function(e){return e.matches(r)}}var DZ=Array.prototype.find;function NZ(r){return function(){return DZ.call(this.children,r)}}function MZ(){return this.firstElementChild}function IZ(r){return this.select(r==null?MZ:NZ(typeof r=="function"?r:nC(r)))}var LZ=Array.prototype.filter;function BZ(){return Array.from(this.children)}function ZZ(r){return function(){return LZ.call(this.children,r)}}function WZ(r){return this.selectAll(r==null?BZ:ZZ(typeof r=="function"?r:nC(r)))}function UZ(r){typeof r!="function"&&(r=rC(r));for(var e=this._groups,t=e.length,n=new Array(t),i=0;i<t;++i)for(var s=e[i],a=s.length,o=n[i]=[],l,f=0;f<a;++f)(l=s[f])&&r.call(l,l.__data__,f,s)&&o.push(l);return new ts(n,this._parents)}function iC(r){return new Array(r.length)}function XZ(){return new ts(this._enter||this._groups.map(iC),this._parents)}function _d(r,e){this.ownerDocument=r.ownerDocument,this.namespaceURI=r.namespaceURI,this._next=null,this._parent=r,this.__data__=e}_d.prototype={constructor:_d,appendChild:function(r){return this._parent.insertBefore(r,this._next)},insertBefore:function(r,e){return this._parent.insertBefore(r,e)},querySelector:function(r){return this._parent.querySelector(r)},querySelectorAll:function(r){return this._parent.querySelectorAll(r)}};function VZ(r){return function(){return r}}function qZ(r,e,t,n,i,s){for(var a=0,o,l=e.length,f=s.length;a<f;++a)(o=e[a])?(o.__data__=s[a],n[a]=o):t[a]=new _d(r,s[a]);for(;a<l;++a)(o=e[a])&&(i[a]=o)}function jZ(r,e,t,n,i,s,a){var o,l,f=new Map,c=e.length,h=s.length,u=new Array(c),d;for(o=0;o<c;++o)(l=e[o])&&(u[o]=d=a.call(l,l.__data__,o,e)+"",f.has(d)?i[o]=l:f.set(d,l));for(o=0;o<h;++o)d=a.call(r,s[o],o,s)+"",(l=f.get(d))?(n[o]=l,l.__data__=s[o],f.delete(d)):t[o]=new _d(r,s[o]);for(o=0;o<c;++o)(l=e[o])&&f.get(u[o])===l&&(i[o]=l)}function zZ(r){return r.__data__}function GZ(r,e){if(!arguments.length)return Array.from(this,zZ);var t=e?jZ:qZ,n=this._parents,i=this._groups;typeof r!="function"&&(r=VZ(r));for(var s=i.length,a=new Array(s),o=new Array(s),l=new Array(s),f=0;f<s;++f){var c=n[f],h=i[f],u=h.length,d=HZ(r.call(c,c&&c.__data__,f,n)),p=d.length,m=o[f]=new Array(p),g=a[f]=new Array(p),O=l[f]=new Array(u);t(c,h,m,g,O,d,e);for(var w=0,v=0,S,y;w<p;++w)if(S=m[w]){for(w>=v&&(v=w+1);!(y=g[v])&&++v<p;);S._next=y||null}}return a=new ts(a,n),a._enter=o,a._exit=l,a}function HZ(r){return typeof r=="object"&&"length"in r?r:Array.from(r)}function YZ(){return new ts(this._exit||this._groups.map(iC),this._parents)}function KZ(r,e,t){var n=this.enter(),i=this,s=this.exit();return typeof r=="function"?(n=r(n),n&&(n=n.selection())):n=n.append(r+""),e!=null&&(i=e(i),i&&(i=i.selection())),t==null?s.remove():t(s),n&&i?n.merge(i).order():i}function JZ(r){for(var e=r.selection?r.selection():r,t=this._groups,n=e._groups,i=t.length,s=n.length,a=Math.min(i,s),o=new Array(i),l=0;l<a;++l)for(var f=t[l],c=n[l],h=f.length,u=o[l]=new Array(h),d,p=0;p<h;++p)(d=f[p]||c[p])&&(u[p]=d);for(;l<i;++l)o[l]=t[l];return new ts(o,this._parents)}function eW(){for(var r=this._groups,e=-1,t=r.length;++e<t;)for(var n=r[e],i=n.length-1,s=n[i],a;--i>=0;)(a=n[i])&&(s&&a.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(a,s),s=a);return this}function tW(r){r||(r=rW);function e(h,u){return h&&u?r(h.__data__,u.__data__):!h-!u}for(var t=this._groups,n=t.length,i=new Array(n),s=0;s<n;++s){for(var a=t[s],o=a.length,l=i[s]=new Array(o),f,c=0;c<o;++c)(f=a[c])&&(l[c]=f);l.sort(e)}return new ts(i,this._parents).order()}function rW(r,e){return r<e?-1:r>e?1:r>=e?0:NaN}function nW(){var r=arguments[0];return arguments[0]=this,r.apply(null,arguments),this}function iW(){return Array.from(this)}function sW(){for(var r=this._groups,e=0,t=r.length;e<t;++e)for(var n=r[e],i=0,s=n.length;i<s;++i){var a=n[i];if(a)return a}return null}function aW(){let r=0;for(const e of this)++r;return r}function oW(){return!this.node()}function lW(r){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var i=e[t],s=0,a=i.length,o;s<a;++s)(o=i[s])&&r.call(o,o.__data__,s,i);return this}function fW(r){return function(){this.removeAttribute(r)}}function cW(r){return function(){this.removeAttributeNS(r.space,r.local)}}function hW(r,e){return function(){this.setAttribute(r,e)}}function uW(r,e){return function(){this.setAttributeNS(r.space,r.local,e)}}function dW(r,e){return function(){var t=e.apply(this,arguments);t==null?this.removeAttribute(r):this.setAttribute(r,t)}}function pW(r,e){return function(){var t=e.apply(this,arguments);t==null?this.removeAttributeNS(r.space,r.local):this.setAttributeNS(r.space,r.local,t)}}function mW(r,e){var t=S0(r);if(arguments.length<2){var n=this.node();return t.local?n.getAttributeNS(t.space,t.local):n.getAttribute(t)}return this.each((e==null?t.local?cW:fW:typeof e=="function"?t.local?pW:dW:t.local?uW:hW)(t,e))}function sC(r){return r.ownerDocument&&r.ownerDocument.defaultView||r.document&&r||r.defaultView}function gW(r){return function(){this.style.removeProperty(r)}}function OW(r,e,t){return function(){this.style.setProperty(r,e,t)}}function xW(r,e,t){return function(){var n=e.apply(this,arguments);n==null?this.style.removeProperty(r):this.style.setProperty(r,n,t)}}function vW(r,e,t){return arguments.length>1?this.each((e==null?gW:typeof e=="function"?xW:OW)(r,e,t??"")):Rl(this.node(),r)}function Rl(r,e){return r.style.getPropertyValue(e)||sC(r).getComputedStyle(r,null).getPropertyValue(e)}function yW(r){return function(){delete this[r]}}function wW(r,e){return function(){this[r]=e}}function bW(r,e){return function(){var t=e.apply(this,arguments);t==null?delete this[r]:this[r]=t}}function _W(r,e){return arguments.length>1?this.each((e==null?yW:typeof e=="function"?bW:wW)(r,e)):this.node()[r]}function aC(r){return r.trim().split(/^|\s+/)}function HO(r){return r.classList||new oC(r)}function oC(r){this._node=r,this._names=aC(r.getAttribute("class")||"")}oC.prototype={add:function(r){var e=this._names.indexOf(r);e<0&&(this._names.push(r),this._node.setAttribute("class",this._names.join(" ")))},remove:function(r){var e=this._names.indexOf(r);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(r){return this._names.indexOf(r)>=0}};function lC(r,e){for(var t=HO(r),n=-1,i=e.length;++n<i;)t.add(e[n])}function fC(r,e){for(var t=HO(r),n=-1,i=e.length;++n<i;)t.remove(e[n])}function kW(r){return function(){lC(this,r)}}function SW(r){return function(){fC(this,r)}}function TW(r,e){return function(){(e.apply(this,arguments)?lC:fC)(this,r)}}function CW(r,e){var t=aC(r+"");if(arguments.length<2){for(var n=HO(this.node()),i=-1,s=t.length;++i<s;)if(!n.contains(t[i]))return!1;return!0}return this.each((typeof e=="function"?TW:e?kW:SW)(t,e))}function AW(){this.textContent=""}function EW(r){return function(){this.textContent=r}}function PW(r){return function(){var e=r.apply(this,arguments);this.textContent=e??""}}function RW(r){return arguments.length?this.each(r==null?AW:(typeof r=="function"?PW:EW)(r)):this.node().textContent}function QW(){this.innerHTML=""}function FW(r){return function(){this.innerHTML=r}}function $W(r){return function(){var e=r.apply(this,arguments);this.innerHTML=e??""}}function DW(r){return arguments.length?this.each(r==null?QW:(typeof r=="function"?$W:FW)(r)):this.node().innerHTML}function NW(){this.nextSibling&&this.parentNode.appendChild(this)}function MW(){return this.each(NW)}function IW(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function LW(){return this.each(IW)}function BW(r){var e=typeof r=="function"?r:eC(r);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function ZW(){return null}function WW(r,e){var t=typeof r=="function"?r:eC(r),n=e==null?ZW:typeof e=="function"?e:GO(e);return this.select(function(){return this.insertBefore(t.apply(this,arguments),n.apply(this,arguments)||null)})}function UW(){var r=this.parentNode;r&&r.removeChild(this)}function XW(){return this.each(UW)}function VW(){var r=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(r,this.nextSibling):r}function qW(){var r=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(r,this.nextSibling):r}function jW(r){return this.select(r?qW:VW)}function zW(r){return arguments.length?this.property("__data__",r):this.node().__data__}function GW(r){return function(e){r.call(this,e,this.__data__)}}function HW(r){return r.trim().split(/^|\s+/).map(function(e){var t="",n=e.indexOf(".");return n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),{type:e,name:t}})}function YW(r){return function(){var e=this.__on;if(e){for(var t=0,n=-1,i=e.length,s;t<i;++t)s=e[t],(!r.type||s.type===r.type)&&s.name===r.name?this.removeEventListener(s.type,s.listener,s.options):e[++n]=s;++n?e.length=n:delete this.__on}}}function KW(r,e,t){return function(){var n=this.__on,i,s=GW(e);if(n){for(var a=0,o=n.length;a<o;++a)if((i=n[a]).type===r.type&&i.name===r.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=s,i.options=t),i.value=e;return}}this.addEventListener(r.type,s,t),i={type:r.type,name:r.name,value:e,listener:s,options:t},n?n.push(i):this.__on=[i]}}function JW(r,e,t){var n=HW(r+""),i,s=n.length,a;if(arguments.length<2){var o=this.node().__on;if(o){for(var l=0,f=o.length,c;l<f;++l)for(i=0,c=o[l];i<s;++i)if((a=n[i]).type===c.type&&a.name===c.name)return c.value}return}for(o=e?KW:YW,i=0;i<s;++i)this.each(o(n[i],e,t));return this}function cC(r,e,t){var n=sC(r),i=n.CustomEvent;typeof i=="function"?i=new i(e,t):(i=n.document.createEvent("Event"),t?(i.initEvent(e,t.bubbles,t.cancelable),i.detail=t.detail):i.initEvent(e,!1,!1)),r.dispatchEvent(i)}function eU(r,e){return function(){return cC(this,r,e)}}function tU(r,e){return function(){return cC(this,r,e.apply(this,arguments))}}function rU(r,e){return this.each((typeof e=="function"?tU:eU)(r,e))}function*nU(){for(var r=this._groups,e=0,t=r.length;e<t;++e)for(var n=r[e],i=0,s=n.length,a;i<s;++i)(a=n[i])&&(yield a)}var iU=[null];function ts(r,e){this._groups=r,this._parents=e}function yh(){return new ts([[document.documentElement]],iU)}function sU(){return this}ts.prototype=yh.prototype={constructor:ts,select:PZ,selectAll:$Z,selectChild:IZ,selectChildren:WZ,filter:UZ,data:GZ,enter:XZ,exit:YZ,join:KZ,merge:JZ,selection:sU,order:eW,sort:tW,call:nW,nodes:iW,node:sW,size:aW,empty:oW,each:lW,attr:mW,style:vW,property:_W,classed:CW,text:RW,html:DW,raise:MW,lower:LW,append:BW,insert:WW,remove:XW,clone:jW,datum:zW,on:JW,dispatch:rU,[Symbol.iterator]:nU};function YO(r,e,t){r.prototype=e.prototype=t,t.constructor=r}function hC(r,e){var t=Object.create(r.prototype);for(var n in e)t[n]=e[n];return t}function wh(){}var Pc=.7,kd=1/Pc,Ol="\\s*([+-]?\\d+)\\s*",Rc="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ss="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",aU=/^#([0-9a-f]{3,8})$/,oU=new RegExp(`^rgb\\(${Ol},${Ol},${Ol}\\)$`),lU=new RegExp(`^rgb\\(${Ss},${Ss},${Ss}\\)$`),fU=new RegExp(`^rgba\\(${Ol},${Ol},${Ol},${Rc}\\)$`),cU=new RegExp(`^rgba\\(${Ss},${Ss},${Ss},${Rc}\\)$`),hU=new RegExp(`^hsl\\(${Rc},${Ss},${Ss}\\)$`),uU=new RegExp(`^hsla\\(${Rc},${Ss},${Ss},${Rc}\\)$`),Hy={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};YO(wh,Qc,{copy(r){return Object.assign(new this.constructor,this,r)},displayable(){return this.rgb().displayable()},hex:Yy,formatHex:Yy,formatHex8:dU,formatHsl:pU,formatRgb:Ky,toString:Ky});function Yy(){return this.rgb().formatHex()}function dU(){return this.rgb().formatHex8()}function pU(){return uC(this).formatHsl()}function Ky(){return this.rgb().formatRgb()}function Qc(r){var e,t;return r=(r+"").trim().toLowerCase(),(e=aU.exec(r))?(t=e[1].length,e=parseInt(e[1],16),t===6?Jy(e):t===3?new Hn(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):t===8?qh(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):t===4?qh(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=oU.exec(r))?new Hn(e[1],e[2],e[3],1):(e=lU.exec(r))?new Hn(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=fU.exec(r))?qh(e[1],e[2],e[3],e[4]):(e=cU.exec(r))?qh(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=hU.exec(r))?rw(e[1],e[2]/100,e[3]/100,1):(e=uU.exec(r))?rw(e[1],e[2]/100,e[3]/100,e[4]):Hy.hasOwnProperty(r)?Jy(Hy[r]):r==="transparent"?new Hn(NaN,NaN,NaN,0):null}function Jy(r){return new Hn(r>>16&255,r>>8&255,r&255,1)}function qh(r,e,t,n){return n<=0&&(r=e=t=NaN),new Hn(r,e,t,n)}function mU(r){return r instanceof wh||(r=Qc(r)),r?(r=r.rgb(),new Hn(r.r,r.g,r.b,r.opacity)):new Hn}function qm(r,e,t,n){return arguments.length===1?mU(r):new Hn(r,e,t,n??1)}function Hn(r,e,t,n){this.r=+r,this.g=+e,this.b=+t,this.opacity=+n}YO(Hn,qm,hC(wh,{brighter(r){return r=r==null?kd:Math.pow(kd,r),new Hn(this.r*r,this.g*r,this.b*r,this.opacity)},darker(r){return r=r==null?Pc:Math.pow(Pc,r),new Hn(this.r*r,this.g*r,this.b*r,this.opacity)},rgb(){return this},clamp(){return new Hn(yo(this.r),yo(this.g),yo(this.b),Sd(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:ew,formatHex:ew,formatHex8:gU,formatRgb:tw,toString:tw}));function ew(){return`#${ho(this.r)}${ho(this.g)}${ho(this.b)}`}function gU(){return`#${ho(this.r)}${ho(this.g)}${ho(this.b)}${ho((isNaN(this.opacity)?1:this.opacity)*255)}`}function tw(){const r=Sd(this.opacity);return`${r===1?"rgb(":"rgba("}${yo(this.r)}, ${yo(this.g)}, ${yo(this.b)}${r===1?")":`, ${r})`}`}function Sd(r){return isNaN(r)?1:Math.max(0,Math.min(1,r))}function yo(r){return Math.max(0,Math.min(255,Math.round(r)||0))}function ho(r){return r=yo(r),(r<16?"0":"")+r.toString(16)}function rw(r,e,t,n){return n<=0?r=e=t=NaN:t<=0||t>=1?r=e=NaN:e<=0&&(r=NaN),new Xi(r,e,t,n)}function uC(r){if(r instanceof Xi)return new Xi(r.h,r.s,r.l,r.opacity);if(r instanceof wh||(r=Qc(r)),!r)return new Xi;if(r instanceof Xi)return r;r=r.rgb();var e=r.r/255,t=r.g/255,n=r.b/255,i=Math.min(e,t,n),s=Math.max(e,t,n),a=NaN,o=s-i,l=(s+i)/2;return o?(e===s?a=(t-n)/o+(t<n)*6:t===s?a=(n-e)/o+2:a=(e-t)/o+4,o/=l<.5?s+i:2-s-i,a*=60):o=l>0&&l<1?0:a,new Xi(a,o,l,r.opacity)}function OU(r,e,t,n){return arguments.length===1?uC(r):new Xi(r,e,t,n??1)}function Xi(r,e,t,n){this.h=+r,this.s=+e,this.l=+t,this.opacity=+n}YO(Xi,OU,hC(wh,{brighter(r){return r=r==null?kd:Math.pow(kd,r),new Xi(this.h,this.s,this.l*r,this.opacity)},darker(r){return r=r==null?Pc:Math.pow(Pc,r),new Xi(this.h,this.s,this.l*r,this.opacity)},rgb(){var r=this.h%360+(this.h<0)*360,e=isNaN(r)||isNaN(this.s)?0:this.s,t=this.l,n=t+(t<.5?t:1-t)*e,i=2*t-n;return new Hn(mp(r>=240?r-240:r+120,i,n),mp(r,i,n),mp(r<120?r+240:r-120,i,n),this.opacity)},clamp(){return new Xi(nw(this.h),jh(this.s),jh(this.l),Sd(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const r=Sd(this.opacity);return`${r===1?"hsl(":"hsla("}${nw(this.h)}, ${jh(this.s)*100}%, ${jh(this.l)*100}%${r===1?")":`, ${r})`}`}}));function nw(r){return r=(r||0)%360,r<0?r+360:r}function jh(r){return Math.max(0,Math.min(1,r||0))}function mp(r,e,t){return(r<60?e+(t-e)*r/60:r<180?t:r<240?e+(t-e)*(240-r)/60:e)*255}const dC=r=>()=>r;function xU(r,e){return function(t){return r+t*e}}function vU(r,e,t){return r=Math.pow(r,t),e=Math.pow(e,t)-r,t=1/t,function(n){return Math.pow(r+n*e,t)}}function yU(r){return(r=+r)==1?pC:function(e,t){return t-e?vU(e,t,r):dC(isNaN(e)?t:e)}}function pC(r,e){var t=e-r;return t?xU(r,t):dC(isNaN(r)?e:r)}const iw=function r(e){var t=yU(e);function n(i,s){var a=t((i=qm(i)).r,(s=qm(s)).r),o=t(i.g,s.g),l=t(i.b,s.b),f=pC(i.opacity,s.opacity);return function(c){return i.r=a(c),i.g=o(c),i.b=l(c),i.opacity=f(c),i+""}}return n.gamma=r,n}(1);function ga(r,e){return r=+r,e=+e,function(t){return r*(1-t)+e*t}}var jm=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,gp=new RegExp(jm.source,"g");function wU(r){return function(){return r}}function bU(r){return function(e){return r(e)+""}}function _U(r,e){var t=jm.lastIndex=gp.lastIndex=0,n,i,s,a=-1,o=[],l=[];for(r=r+"",e=e+"";(n=jm.exec(r))&&(i=gp.exec(e));)(s=i.index)>t&&(s=e.slice(t,s),o[a]?o[a]+=s:o[++a]=s),(n=n[0])===(i=i[0])?o[a]?o[a]+=i:o[++a]=i:(o[++a]=null,l.push({i:a,x:ga(n,i)})),t=gp.lastIndex;return t<e.length&&(s=e.slice(t),o[a]?o[a]+=s:o[++a]=s),o.length<2?l[0]?bU(l[0].x):wU(e):(e=l.length,function(f){for(var c=0,h;c<e;++c)o[(h=l[c]).i]=h.x(f);return o.join("")})}var sw=180/Math.PI,zm={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function mC(r,e,t,n,i,s){var a,o,l;return(a=Math.sqrt(r*r+e*e))&&(r/=a,e/=a),(l=r*t+e*n)&&(t-=r*l,n-=e*l),(o=Math.sqrt(t*t+n*n))&&(t/=o,n/=o,l/=o),r*n<e*t&&(r=-r,e=-e,l=-l,a=-a),{translateX:i,translateY:s,rotate:Math.atan2(e,r)*sw,skewX:Math.atan(l)*sw,scaleX:a,scaleY:o}}var zh;function kU(r){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(r+"");return e.isIdentity?zm:mC(e.a,e.b,e.c,e.d,e.e,e.f)}function SU(r){return r==null||(zh||(zh=document.createElementNS("http://www.w3.org/2000/svg","g")),zh.setAttribute("transform",r),!(r=zh.transform.baseVal.consolidate()))?zm:(r=r.matrix,mC(r.a,r.b,r.c,r.d,r.e,r.f))}function gC(r,e,t,n){function i(f){return f.length?f.pop()+" ":""}function s(f,c,h,u,d,p){if(f!==h||c!==u){var m=d.push("translate(",null,e,null,t);p.push({i:m-4,x:ga(f,h)},{i:m-2,x:ga(c,u)})}else(h||u)&&d.push("translate("+h+e+u+t)}function a(f,c,h,u){f!==c?(f-c>180?c+=360:c-f>180&&(f+=360),u.push({i:h.push(i(h)+"rotate(",null,n)-2,x:ga(f,c)})):c&&h.push(i(h)+"rotate("+c+n)}function o(f,c,h,u){f!==c?u.push({i:h.push(i(h)+"skewX(",null,n)-2,x:ga(f,c)}):c&&h.push(i(h)+"skewX("+c+n)}function l(f,c,h,u,d,p){if(f!==h||c!==u){var m=d.push(i(d)+"scale(",null,",",null,")");p.push({i:m-4,x:ga(f,h)},{i:m-2,x:ga(c,u)})}else(h!==1||u!==1)&&d.push(i(d)+"scale("+h+","+u+")")}return function(f,c){var h=[],u=[];return f=r(f),c=r(c),s(f.translateX,f.translateY,c.translateX,c.translateY,h,u),a(f.rotate,c.rotate,h,u),o(f.skewX,c.skewX,h,u),l(f.scaleX,f.scaleY,c.scaleX,c.scaleY,h,u),f=c=null,function(d){for(var p=-1,m=u.length,g;++p<m;)h[(g=u[p]).i]=g.x(d);return h.join("")}}}var TU=gC(kU,"px, ","px)","deg)"),CU=gC(SU,", ",")",")"),Ql=0,$f=0,mf=0,OC=1e3,Td,Df,Cd=0,Ro=0,T0=0,Fc=typeof performance=="object"&&performance.now?performance:Date,xC=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(r){setTimeout(r,17)};function KO(){return Ro||(xC(AU),Ro=Fc.now()+T0)}function AU(){Ro=0}function Ad(){this._call=this._time=this._next=null}Ad.prototype=vC.prototype={constructor:Ad,restart:function(r,e,t){if(typeof r!="function")throw new TypeError("callback is not a function");t=(t==null?KO():+t)+(e==null?0:+e),!this._next&&Df!==this&&(Df?Df._next=this:Td=this,Df=this),this._call=r,this._time=t,Gm()},stop:function(){this._call&&(this._call=null,this._time=1/0,Gm())}};function vC(r,e,t){var n=new Ad;return n.restart(r,e,t),n}function EU(){KO(),++Ql;for(var r=Td,e;r;)(e=Ro-r._time)>=0&&r._call.call(void 0,e),r=r._next;--Ql}function aw(){Ro=(Cd=Fc.now())+T0,Ql=$f=0;try{EU()}finally{Ql=0,RU(),Ro=0}}function PU(){var r=Fc.now(),e=r-Cd;e>OC&&(T0-=e,Cd=r)}function RU(){for(var r,e=Td,t,n=1/0;e;)e._call?(n>e._time&&(n=e._time),r=e,e=e._next):(t=e._next,e._next=null,e=r?r._next=t:Td=t);Df=r,Gm(n)}function Gm(r){if(!Ql){$f&&($f=clearTimeout($f));var e=r-Ro;e>24?(r<1/0&&($f=setTimeout(aw,r-Fc.now()-T0)),mf&&(mf=clearInterval(mf))):(mf||(Cd=Fc.now(),mf=setInterval(PU,OC)),Ql=1,xC(aw))}}function ow(r,e,t){var n=new Ad;return e=e==null?0:+e,n.restart(i=>{n.stop(),r(i+e)},e,t),n}var QU=JT("start","end","cancel","interrupt"),FU=[],yC=0,lw=1,Hm=2,Ru=3,fw=4,Ym=5,Qu=6;function C0(r,e,t,n,i,s){var a=r.__transition;if(!a)r.__transition={};else if(t in a)return;$U(r,t,{name:e,index:n,group:i,on:QU,tween:FU,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:yC})}function JO(r,e){var t=os(r,e);if(t.state>yC)throw new Error("too late; already scheduled");return t}function Ms(r,e){var t=os(r,e);if(t.state>Ru)throw new Error("too late; already running");return t}function os(r,e){var t=r.__transition;if(!t||!(t=t[e]))throw new Error("transition not found");return t}function $U(r,e,t){var n=r.__transition,i;n[e]=t,t.timer=vC(s,0,t.time);function s(f){t.state=lw,t.timer.restart(a,t.delay,t.time),t.delay<=f&&a(f-t.delay)}function a(f){var c,h,u,d;if(t.state!==lw)return l();for(c in n)if(d=n[c],d.name===t.name){if(d.state===Ru)return ow(a);d.state===fw?(d.state=Qu,d.timer.stop(),d.on.call("interrupt",r,r.__data__,d.index,d.group),delete n[c]):+c<e&&(d.state=Qu,d.timer.stop(),d.on.call("cancel",r,r.__data__,d.index,d.group),delete n[c])}if(ow(function(){t.state===Ru&&(t.state=fw,t.timer.restart(o,t.delay,t.time),o(f))}),t.state=Hm,t.on.call("start",r,r.__data__,t.index,t.group),t.state===Hm){for(t.state=Ru,i=new Array(u=t.tween.length),c=0,h=-1;c<u;++c)(d=t.tween[c].value.call(r,r.__data__,t.index,t.group))&&(i[++h]=d);i.length=h+1}}function o(f){for(var c=f<t.duration?t.ease.call(null,f/t.duration):(t.timer.restart(l),t.state=Ym,1),h=-1,u=i.length;++h<u;)i[h].call(r,c);t.state===Ym&&(t.on.call("end",r,r.__data__,t.index,t.group),l())}function l(){t.state=Qu,t.timer.stop(),delete n[e];for(var f in n)return;delete r.__transition}}function DU(r,e){var t=r.__transition,n,i,s=!0,a;if(t){e=e==null?null:e+"";for(a in t){if((n=t[a]).name!==e){s=!1;continue}i=n.state>Hm&&n.state<Ym,n.state=Qu,n.timer.stop(),n.on.call(i?"interrupt":"cancel",r,r.__data__,n.index,n.group),delete t[a]}s&&delete r.__transition}}function NU(r){return this.each(function(){DU(this,r)})}function MU(r,e){var t,n;return function(){var i=Ms(this,r),s=i.tween;if(s!==t){n=t=s;for(var a=0,o=n.length;a<o;++a)if(n[a].name===e){n=n.slice(),n.splice(a,1);break}}i.tween=n}}function IU(r,e,t){var n,i;if(typeof t!="function")throw new Error;return function(){var s=Ms(this,r),a=s.tween;if(a!==n){i=(n=a).slice();for(var o={name:e,value:t},l=0,f=i.length;l<f;++l)if(i[l].name===e){i[l]=o;break}l===f&&i.push(o)}s.tween=i}}function LU(r,e){var t=this._id;if(r+="",arguments.length<2){for(var n=os(this.node(),t).tween,i=0,s=n.length,a;i<s;++i)if((a=n[i]).name===r)return a.value;return null}return this.each((e==null?MU:IU)(t,r,e))}function ex(r,e,t){var n=r._id;return r.each(function(){var i=Ms(this,n);(i.value||(i.value={}))[e]=t.apply(this,arguments)}),function(i){return os(i,n).value[e]}}function wC(r,e){var t;return(typeof e=="number"?ga:e instanceof Qc?iw:(t=Qc(e))?(e=t,iw):_U)(r,e)}function BU(r){return function(){this.removeAttribute(r)}}function ZU(r){return function(){this.removeAttributeNS(r.space,r.local)}}function WU(r,e,t){var n,i=t+"",s;return function(){var a=this.getAttribute(r);return a===i?null:a===n?s:s=e(n=a,t)}}function UU(r,e,t){var n,i=t+"",s;return function(){var a=this.getAttributeNS(r.space,r.local);return a===i?null:a===n?s:s=e(n=a,t)}}function XU(r,e,t){var n,i,s;return function(){var a,o=t(this),l;return o==null?void this.removeAttribute(r):(a=this.getAttribute(r),l=o+"",a===l?null:a===n&&l===i?s:(i=l,s=e(n=a,o)))}}function VU(r,e,t){var n,i,s;return function(){var a,o=t(this),l;return o==null?void this.removeAttributeNS(r.space,r.local):(a=this.getAttributeNS(r.space,r.local),l=o+"",a===l?null:a===n&&l===i?s:(i=l,s=e(n=a,o)))}}function qU(r,e){var t=S0(r),n=t==="transform"?CU:wC;return this.attrTween(r,typeof e=="function"?(t.local?VU:XU)(t,n,ex(this,"attr."+r,e)):e==null?(t.local?ZU:BU)(t):(t.local?UU:WU)(t,n,e))}function jU(r,e){return function(t){this.setAttribute(r,e.call(this,t))}}function zU(r,e){return function(t){this.setAttributeNS(r.space,r.local,e.call(this,t))}}function GU(r,e){var t,n;function i(){var s=e.apply(this,arguments);return s!==n&&(t=(n=s)&&zU(r,s)),t}return i._value=e,i}function HU(r,e){var t,n;function i(){var s=e.apply(this,arguments);return s!==n&&(t=(n=s)&&jU(r,s)),t}return i._value=e,i}function YU(r,e){var t="attr."+r;if(arguments.length<2)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;var n=S0(r);return this.tween(t,(n.local?GU:HU)(n,e))}function KU(r,e){return function(){JO(this,r).delay=+e.apply(this,arguments)}}function JU(r,e){return e=+e,function(){JO(this,r).delay=e}}function eX(r){var e=this._id;return arguments.length?this.each((typeof r=="function"?KU:JU)(e,r)):os(this.node(),e).delay}function tX(r,e){return function(){Ms(this,r).duration=+e.apply(this,arguments)}}function rX(r,e){return e=+e,function(){Ms(this,r).duration=e}}function nX(r){var e=this._id;return arguments.length?this.each((typeof r=="function"?tX:rX)(e,r)):os(this.node(),e).duration}function iX(r,e){if(typeof e!="function")throw new Error;return function(){Ms(this,r).ease=e}}function sX(r){var e=this._id;return arguments.length?this.each(iX(e,r)):os(this.node(),e).ease}function aX(r,e){return function(){var t=e.apply(this,arguments);if(typeof t!="function")throw new Error;Ms(this,r).ease=t}}function oX(r){if(typeof r!="function")throw new Error;return this.each(aX(this._id,r))}function lX(r){typeof r!="function"&&(r=rC(r));for(var e=this._groups,t=e.length,n=new Array(t),i=0;i<t;++i)for(var s=e[i],a=s.length,o=n[i]=[],l,f=0;f<a;++f)(l=s[f])&&r.call(l,l.__data__,f,s)&&o.push(l);return new Ys(n,this._parents,this._name,this._id)}function fX(r){if(r._id!==this._id)throw new Error;for(var e=this._groups,t=r._groups,n=e.length,i=t.length,s=Math.min(n,i),a=new Array(n),o=0;o<s;++o)for(var l=e[o],f=t[o],c=l.length,h=a[o]=new Array(c),u,d=0;d<c;++d)(u=l[d]||f[d])&&(h[d]=u);for(;o<n;++o)a[o]=e[o];return new Ys(a,this._parents,this._name,this._id)}function cX(r){return(r+"").trim().split(/^|\s+/).every(function(e){var t=e.indexOf(".");return t>=0&&(e=e.slice(0,t)),!e||e==="start"})}function hX(r,e,t){var n,i,s=cX(e)?JO:Ms;return function(){var a=s(this,r),o=a.on;o!==n&&(i=(n=o).copy()).on(e,t),a.on=i}}function uX(r,e){var t=this._id;return arguments.length<2?os(this.node(),t).on.on(r):this.each(hX(t,r,e))}function dX(r){return function(){var e=this.parentNode;for(var t in this.__transition)if(+t!==r)return;e&&e.removeChild(this)}}function pX(){return this.on("end.remove",dX(this._id))}function mX(r){var e=this._name,t=this._id;typeof r!="function"&&(r=GO(r));for(var n=this._groups,i=n.length,s=new Array(i),a=0;a<i;++a)for(var o=n[a],l=o.length,f=s[a]=new Array(l),c,h,u=0;u<l;++u)(c=o[u])&&(h=r.call(c,c.__data__,u,o))&&("__data__"in c&&(h.__data__=c.__data__),f[u]=h,C0(f[u],e,t,u,f,os(c,t)));return new Ys(s,this._parents,e,t)}function gX(r){var e=this._name,t=this._id;typeof r!="function"&&(r=tC(r));for(var n=this._groups,i=n.length,s=[],a=[],o=0;o<i;++o)for(var l=n[o],f=l.length,c,h=0;h<f;++h)if(c=l[h]){for(var u=r.call(c,c.__data__,h,l),d,p=os(c,t),m=0,g=u.length;m<g;++m)(d=u[m])&&C0(d,e,t,m,u,p);s.push(u),a.push(c)}return new Ys(s,a,e,t)}var OX=yh.prototype.constructor;function xX(){return new OX(this._groups,this._parents)}function vX(r,e){var t,n,i;return function(){var s=Rl(this,r),a=(this.style.removeProperty(r),Rl(this,r));return s===a?null:s===t&&a===n?i:i=e(t=s,n=a)}}function bC(r){return function(){this.style.removeProperty(r)}}function yX(r,e,t){var n,i=t+"",s;return function(){var a=Rl(this,r);return a===i?null:a===n?s:s=e(n=a,t)}}function wX(r,e,t){var n,i,s;return function(){var a=Rl(this,r),o=t(this),l=o+"";return o==null&&(l=o=(this.style.removeProperty(r),Rl(this,r))),a===l?null:a===n&&l===i?s:(i=l,s=e(n=a,o))}}function bX(r,e){var t,n,i,s="style."+e,a="end."+s,o;return function(){var l=Ms(this,r),f=l.on,c=l.value[s]==null?o||(o=bC(e)):void 0;(f!==t||i!==c)&&(n=(t=f).copy()).on(a,i=c),l.on=n}}function _X(r,e,t){var n=(r+="")=="transform"?TU:wC;return e==null?this.styleTween(r,vX(r,n)).on("end.style."+r,bC(r)):typeof e=="function"?this.styleTween(r,wX(r,n,ex(this,"style."+r,e))).each(bX(this._id,r)):this.styleTween(r,yX(r,n,e),t).on("end.style."+r,null)}function kX(r,e,t){return function(n){this.style.setProperty(r,e.call(this,n),t)}}function SX(r,e,t){var n,i;function s(){var a=e.apply(this,arguments);return a!==i&&(n=(i=a)&&kX(r,a,t)),n}return s._value=e,s}function TX(r,e,t){var n="style."+(r+="");if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;return this.tween(n,SX(r,e,t??""))}function CX(r){return function(){this.textContent=r}}function AX(r){return function(){var e=r(this);this.textContent=e??""}}function EX(r){return this.tween("text",typeof r=="function"?AX(ex(this,"text",r)):CX(r==null?"":r+""))}function PX(r){return function(e){this.textContent=r.call(this,e)}}function RX(r){var e,t;function n(){var i=r.apply(this,arguments);return i!==t&&(e=(t=i)&&PX(i)),e}return n._value=r,n}function QX(r){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(r==null)return this.tween(e,null);if(typeof r!="function")throw new Error;return this.tween(e,RX(r))}function FX(){for(var r=this._name,e=this._id,t=_C(),n=this._groups,i=n.length,s=0;s<i;++s)for(var a=n[s],o=a.length,l,f=0;f<o;++f)if(l=a[f]){var c=os(l,e);C0(l,r,t,f,a,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new Ys(n,this._parents,r,t)}function $X(){var r,e,t=this,n=t._id,i=t.size();return new Promise(function(s,a){var o={value:a},l={value:function(){--i===0&&s()}};t.each(function(){var f=Ms(this,n),c=f.on;c!==r&&(e=(r=c).copy(),e._.cancel.push(o),e._.interrupt.push(o),e._.end.push(l)),f.on=e}),i===0&&s()})}var DX=0;function Ys(r,e,t,n){this._groups=r,this._parents=e,this._name=t,this._id=n}function _C(){return++DX}var Ws=yh.prototype;Ys.prototype={constructor:Ys,select:mX,selectAll:gX,selectChild:Ws.selectChild,selectChildren:Ws.selectChildren,filter:lX,merge:fX,selection:xX,transition:FX,call:Ws.call,nodes:Ws.nodes,node:Ws.node,size:Ws.size,empty:Ws.empty,each:Ws.each,on:uX,attr:qU,attrTween:YU,style:_X,styleTween:TX,text:EX,textTween:QX,remove:pX,tween:LU,delay:eX,duration:nX,ease:sX,easeVarying:oX,end:$X,[Symbol.iterator]:Ws[Symbol.iterator]};function NX(r){return((r*=2)<=1?r*r*r:(r-=2)*r*r+2)/2}var MX={time:null,delay:0,duration:250,ease:NX};function IX(r,e){for(var t;!(t=r.__transition)||!(t=t[e]);)if(!(r=r.parentNode))throw new Error(`transition ${e} not found`);return t}function LX(r){var e,t;r instanceof Ys?(e=r._id,r=r._name):(e=_C(),(t=MX).time=KO(),r=r==null?null:r+"");for(var n=this._groups,i=n.length,s=0;s<i;++s)for(var a=n[s],o=a.length,l,f=0;f<o;++f)(l=a[f])&&C0(l,r,e,f,a,t||IX(l,e));return new Ys(n,this._parents,r,e)}yh.prototype.interrupt=NU;yh.prototype.transition=LX;function Nf(r,e,t){this.k=r,this.x=e,this.y=t}Nf.prototype={constructor:Nf,scale:function(r){return r===1?this:new Nf(this.k*r,this.x,this.y)},translate:function(r,e){return r===0&e===0?this:new Nf(this.k,this.x+this.k*r,this.y+this.k*e)},apply:function(r){return[r[0]*this.k+this.x,r[1]*this.k+this.y]},applyX:function(r){return r*this.k+this.x},applyY:function(r){return r*this.k+this.y},invert:function(r){return[(r[0]-this.x)/this.k,(r[1]-this.y)/this.k]},invertX:function(r){return(r-this.x)/this.k},invertY:function(r){return(r-this.y)/this.k},rescaleX:function(r){return r.copy().domain(r.range().map(this.invertX,this).map(r.invert,r))},rescaleY:function(r){return r.copy().domain(r.range().map(this.invertY,this).map(r.invert,r))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};Nf.prototype;var BX=J('<span><i class="fa-solid fa-ban" aria-hidden="true"></i></span> <span> </span>',1),ZX=J('<span><i aria-hidden="true"></i></span> <span> </span>',1),WX=J("<li><a><!></a></li>"),UX=J("<div><ul><!></ul></div> <!>",1);function Jn(r,e){gt(e,!0);let t=ge(e,"classSize",11,"is-small"),n=ge(e,"tabs",27,()=>Y([{label:"Pictures",classIcon:"fas fa-picture",disabled:!0},{label:"Calcs",classIcon:"fas fa-picture"},{label:"Film",classIcon:"fas fa-film",disabled:!0}])),i=ge(e,"active",15,0);var s=UX(),a=be(s),o=Q(a),l=Q(o);{var f=u=>{var d=Ee(),p=be(d);_r(p,17,n,Qr,(m,g,O)=>{var w=WX(),v=Q(w);v.__click=()=>{C(g).disabled||(i(O),e.onselect&&e.onselect({label:C(g).label,index:O}))};var S=Q(v);{var y=x=>{var A=BX(),k=be(A),E=ne(k,2),T=Q(E,!0);R(E),Me(()=>{ht(k,`icon ${t()??""} svelte-5sjlmp`),Ge(T,C(g).label)}),U(x,A)},b=x=>{var A=Ee(),k=be(A);{var E=_=>{var N=ZX(),Z=be(N),z=Q(Z);R(Z);var ee=ne(Z,2),ae=Q(ee,!0);R(ee),Me(()=>{ht(Z,`icon ${t()??""} svelte-5sjlmp`),ht(z,Qi(C(g).classIcon),"svelte-5sjlmp"),Ge(ae,C(g).label)}),U(_,N)},T=_=>{var N=vs();Me(()=>Ge(N,C(g).label)),U(_,N)};ce(k,_=>{C(g).classIcon&&C(g).classIcon.length>3?_(E):_(T,!1)},!0)}U(x,A)};ce(S,x=>{C(g).disabled?x(y):x(b,!1)})}R(v),R(w),Me(()=>ht(w,Qi(i()==O?"is-active":""),"svelte-5sjlmp")),U(m,w)}),U(u,d)};ce(l,u=>{n()&&u(f)})}R(o),R(a);var c=ne(a,2);{var h=u=>{var d=Ee(),p=be(d);_r(p,17,n,Qr,(m,g,O)=>{var w=Ee(),v=be(w);{var S=y=>{var b=Ee(),x=be(b);{var A=k=>{var E=Ee(),T=be(E);pc(T,()=>C(g).component??dc),U(k,E)};ce(x,k=>{C(g)&&C(g).component&&!C(g).disabled&&k(A)})}U(y,b)};ce(v,y=>{i()==O&&y(S)})}U(m,w)}),U(u,d)};ce(c,u=>{Array.isArray(n())&&u(h)})}Me(()=>ht(a,`tabs is-boxed ${t()??""} tabMargin svelte-5sjlmp`)),U(r,s),Ot()}vr(["click"]);vr(["click"]);let Km=[],kC=[];(()=>{let r="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(e=>e?parseInt(e,36):1);for(let e=0,t=0;e<r.length;e++)(e%2?kC:Km).push(t=t+r[e])})();function XX(r){if(r<768)return!1;for(let e=0,t=Km.length;;){let n=e+t>>1;if(r<Km[n])t=n;else if(r>=kC[n])e=n+1;else return!0;if(e==t)return!1}}function cw(r){return r>=127462&&r<=127487}const hw=8205;function VX(r,e,t=!0,n=!0){return(t?SC:qX)(r,e,n)}function SC(r,e,t){if(e==r.length)return e;e&&TC(r.charCodeAt(e))&&CC(r.charCodeAt(e-1))&&e--;let n=Op(r,e);for(e+=uw(n);e<r.length;){let i=Op(r,e);if(n==hw||i==hw||t&&XX(i))e+=uw(i),n=i;else if(cw(i)){let s=0,a=e-2;for(;a>=0&&cw(Op(r,a));)s++,a-=2;if(s%2==0)break;e+=2}else break}return e}function qX(r,e,t){for(;e>0;){let n=SC(r,e-2,t);if(n<e)return n;e--}return 0}function Op(r,e){let t=r.charCodeAt(e);if(!CC(t)||e+1==r.length)return t;let n=r.charCodeAt(e+1);return TC(n)?(t-55296<<10)+(n-56320)+65536:t}function TC(r){return r>=56320&&r<57344}function CC(r){return r>=55296&&r<56320}function uw(r){return r<65536?1:2}let Ft=class AC{lineAt(e){if(e<0||e>this.length)throw new RangeError(`Invalid position ${e} in document of length ${this.length}`);return this.lineInner(e,!1,1,0)}line(e){if(e<1||e>this.lines)throw new RangeError(`Invalid line number ${e} in ${this.lines}-line document`);return this.lineInner(e,!0,1,0)}replace(e,t,n){[e,t]=Fl(this,e,t);let i=[];return this.decompose(0,e,i,2),n.length&&n.decompose(0,n.length,i,3),this.decompose(t,this.length,i,1),gs.from(i,this.length-(t-e)+n.length)}append(e){return this.replace(this.length,this.length,e)}slice(e,t=this.length){[e,t]=Fl(this,e,t);let n=[];return this.decompose(e,t,n,0),gs.from(n,t-e)}eq(e){if(e==this)return!0;if(e.length!=this.length||e.lines!=this.lines)return!1;let t=this.scanIdentical(e,1),n=this.length-this.scanIdentical(e,-1),i=new lc(this),s=new lc(e);for(let a=t,o=t;;){if(i.next(a),s.next(a),a=0,i.lineBreak!=s.lineBreak||i.done!=s.done||i.value!=s.value)return!1;if(o+=i.value.length,i.done||o>=n)return!0}}iter(e=1){return new lc(this,e)}iterRange(e,t=this.length){return new EC(this,e,t)}iterLines(e,t){let n;if(e==null)n=this.iter();else{t==null&&(t=this.lines+1);let i=this.line(e).from;n=this.iterRange(i,Math.max(i,t==this.lines+1?this.length:t<=1?0:this.line(t-1).to))}return new PC(n)}toString(){return this.sliceString(0)}toJSON(){let e=[];return this.flatten(e),e}constructor(){}static of(e){if(e.length==0)throw new RangeError("A document must have at least one line");return e.length==1&&!e[0]?AC.empty:e.length<=32?new Rr(e):gs.from(Rr.split(e,[]))}};class Rr extends Ft{constructor(e,t=jX(e)){super(),this.text=e,this.length=t}get lines(){return this.text.length}get children(){return null}lineInner(e,t,n,i){for(let s=0;;s++){let a=this.text[s],o=i+a.length;if((t?n:o)>=e)return new zX(i,o,n,a);i=o+1,n++}}decompose(e,t,n,i){let s=e<=0&&t>=this.length?this:new Rr(dw(this.text,e,t),Math.min(t,this.length)-Math.max(0,e));if(i&1){let a=n.pop(),o=Fu(s.text,a.text.slice(),0,s.length);if(o.length<=32)n.push(new Rr(o,a.length+s.length));else{let l=o.length>>1;n.push(new Rr(o.slice(0,l)),new Rr(o.slice(l)))}}else n.push(s)}replace(e,t,n){if(!(n instanceof Rr))return super.replace(e,t,n);[e,t]=Fl(this,e,t);let i=Fu(this.text,Fu(n.text,dw(this.text,0,e)),t),s=this.length+n.length-(t-e);return i.length<=32?new Rr(i,s):gs.from(Rr.split(i,[]),s)}sliceString(e,t=this.length,n=`
`){[e,t]=Fl(this,e,t);let i="";for(let s=0,a=0;s<=t&&a<this.text.length;a++){let o=this.text[a],l=s+o.length;s>e&&a&&(i+=n),e<l&&t>s&&(i+=o.slice(Math.max(0,e-s),t-s)),s=l+1}return i}flatten(e){for(let t of this.text)e.push(t)}scanIdentical(){return 0}static split(e,t){let n=[],i=-1;for(let s of e)n.push(s),i+=s.length+1,n.length==32&&(t.push(new Rr(n,i)),n=[],i=-1);return i>-1&&t.push(new Rr(n,i)),t}}class gs extends Ft{constructor(e,t){super(),this.children=e,this.length=t,this.lines=0;for(let n of e)this.lines+=n.lines}lineInner(e,t,n,i){for(let s=0;;s++){let a=this.children[s],o=i+a.length,l=n+a.lines-1;if((t?l:o)>=e)return a.lineInner(e,t,n,i);i=o+1,n=l+1}}decompose(e,t,n,i){for(let s=0,a=0;a<=t&&s<this.children.length;s++){let o=this.children[s],l=a+o.length;if(e<=l&&t>=a){let f=i&((a<=e?1:0)|(l>=t?2:0));a>=e&&l<=t&&!f?n.push(o):o.decompose(e-a,t-a,n,f)}a=l+1}}replace(e,t,n){if([e,t]=Fl(this,e,t),n.lines<this.lines)for(let i=0,s=0;i<this.children.length;i++){let a=this.children[i],o=s+a.length;if(e>=s&&t<=o){let l=a.replace(e-s,t-s,n),f=this.lines-a.lines+l.lines;if(l.lines<f>>4&&l.lines>f>>6){let c=this.children.slice();return c[i]=l,new gs(c,this.length-(t-e)+n.length)}return super.replace(s,o,l)}s=o+1}return super.replace(e,t,n)}sliceString(e,t=this.length,n=`
`){[e,t]=Fl(this,e,t);let i="";for(let s=0,a=0;s<this.children.length&&a<=t;s++){let o=this.children[s],l=a+o.length;a>e&&s&&(i+=n),e<l&&t>a&&(i+=o.sliceString(e-a,t-a,n)),a=l+1}return i}flatten(e){for(let t of this.children)t.flatten(e)}scanIdentical(e,t){if(!(e instanceof gs))return 0;let n=0,[i,s,a,o]=t>0?[0,0,this.children.length,e.children.length]:[this.children.length-1,e.children.length-1,-1,-1];for(;;i+=t,s+=t){if(i==a||s==o)return n;let l=this.children[i],f=e.children[s];if(l!=f)return n+l.scanIdentical(f,t);n+=l.length+1}}static from(e,t=e.reduce((n,i)=>n+i.length+1,-1)){let n=0;for(let d of e)n+=d.lines;if(n<32){let d=[];for(let p of e)p.flatten(d);return new Rr(d,t)}let i=Math.max(32,n>>5),s=i<<1,a=i>>1,o=[],l=0,f=-1,c=[];function h(d){let p;if(d.lines>s&&d instanceof gs)for(let m of d.children)h(m);else d.lines>a&&(l>a||!l)?(u(),o.push(d)):d instanceof Rr&&l&&(p=c[c.length-1])instanceof Rr&&d.lines+p.lines<=32?(l+=d.lines,f+=d.length+1,c[c.length-1]=new Rr(p.text.concat(d.text),p.length+1+d.length)):(l+d.lines>i&&u(),l+=d.lines,f+=d.length+1,c.push(d))}function u(){l!=0&&(o.push(c.length==1?c[0]:gs.from(c,f)),f=-1,l=c.length=0)}for(let d of e)h(d);return u(),o.length==1?o[0]:new gs(o,t)}}Ft.empty=new Rr([""],0);function jX(r){let e=-1;for(let t of r)e+=t.length+1;return e}function Fu(r,e,t=0,n=1e9){for(let i=0,s=0,a=!0;s<r.length&&i<=n;s++){let o=r[s],l=i+o.length;l>=t&&(l>n&&(o=o.slice(0,n-i)),i<t&&(o=o.slice(t-i)),a?(e[e.length-1]+=o,a=!1):e.push(o)),i=l+1}return e}function dw(r,e,t){return Fu(r,[""],e,t)}class lc{constructor(e,t=1){this.dir=t,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[e],this.offsets=[t>0?1:(e instanceof Rr?e.text.length:e.children.length)<<1]}nextInner(e,t){for(this.done=this.lineBreak=!1;;){let n=this.nodes.length-1,i=this.nodes[n],s=this.offsets[n],a=s>>1,o=i instanceof Rr?i.text.length:i.children.length;if(a==(t>0?o:0)){if(n==0)return this.done=!0,this.value="",this;t>0&&this.offsets[n-1]++,this.nodes.pop(),this.offsets.pop()}else if((s&1)==(t>0?0:1)){if(this.offsets[n]+=t,e==0)return this.lineBreak=!0,this.value=`
`,this;e--}else if(i instanceof Rr){let l=i.text[a+(t<0?-1:0)];if(this.offsets[n]+=t,l.length>Math.max(0,e))return this.value=e==0?l:t>0?l.slice(e):l.slice(0,l.length-e),this;e-=l.length}else{let l=i.children[a+(t<0?-1:0)];e>l.length?(e-=l.length,this.offsets[n]+=t):(t<0&&this.offsets[n]--,this.nodes.push(l),this.offsets.push(t>0?1:(l instanceof Rr?l.text.length:l.children.length)<<1))}}}next(e=0){return e<0&&(this.nextInner(-e,-this.dir),e=this.value.length),this.nextInner(e,this.dir)}}class EC{constructor(e,t,n){this.value="",this.done=!1,this.cursor=new lc(e,t>n?-1:1),this.pos=t>n?e.length:0,this.from=Math.min(t,n),this.to=Math.max(t,n)}nextInner(e,t){if(t<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;e+=Math.max(0,t<0?this.pos-this.to:this.from-this.pos);let n=t<0?this.pos-this.from:this.to-this.pos;e>n&&(e=n),n-=e;let{value:i}=this.cursor.next(e);return this.pos+=(i.length+e)*t,this.value=i.length<=n?i:t<0?i.slice(i.length-n):i.slice(0,n),this.done=!this.value,this}next(e=0){return e<0?e=Math.max(e,this.from-this.pos):e>0&&(e=Math.min(e,this.to-this.pos)),this.nextInner(e,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}}class PC{constructor(e){this.inner=e,this.afterBreak=!0,this.value="",this.done=!1}next(e=0){let{done:t,lineBreak:n,value:i}=this.inner.next(e);return t&&this.afterBreak?(this.value="",this.afterBreak=!1):t?(this.done=!0,this.value=""):n?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=i,this.afterBreak=!1),this}get lineBreak(){return!1}}typeof Symbol<"u"&&(Ft.prototype[Symbol.iterator]=function(){return this.iter()},lc.prototype[Symbol.iterator]=EC.prototype[Symbol.iterator]=PC.prototype[Symbol.iterator]=function(){return this});class zX{constructor(e,t,n,i){this.from=e,this.to=t,this.number=n,this.text=i}get length(){return this.to-this.from}}function Fl(r,e,t){return e=Math.max(0,Math.min(r.length,e)),[e,Math.max(e,Math.min(r.length,t))]}function pn(r,e,t=!0,n=!0){return VX(r,e,t,n)}function GX(r){return r>=56320&&r<57344}function HX(r){return r>=55296&&r<56320}function qn(r,e){let t=r.charCodeAt(e);if(!HX(t)||e+1==r.length)return t;let n=r.charCodeAt(e+1);return GX(n)?(t-55296<<10)+(n-56320)+65536:t}function tx(r){return r<=65535?String.fromCharCode(r):(r-=65536,String.fromCharCode((r>>10)+55296,(r&1023)+56320))}function Os(r){return r<65536?1:2}const Jm=/\r\n?|\n/;var dn=function(r){return r[r.Simple=0]="Simple",r[r.TrackDel=1]="TrackDel",r[r.TrackBefore=2]="TrackBefore",r[r.TrackAfter=3]="TrackAfter",r}(dn||(dn={}));class Ts{constructor(e){this.sections=e}get length(){let e=0;for(let t=0;t<this.sections.length;t+=2)e+=this.sections[t];return e}get newLength(){let e=0;for(let t=0;t<this.sections.length;t+=2){let n=this.sections[t+1];e+=n<0?this.sections[t]:n}return e}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(e){for(let t=0,n=0,i=0;t<this.sections.length;){let s=this.sections[t++],a=this.sections[t++];a<0?(e(n,i,s),i+=s):i+=a,n+=s}}iterChangedRanges(e,t=!1){eg(this,e,t)}get invertedDesc(){let e=[];for(let t=0;t<this.sections.length;){let n=this.sections[t++],i=this.sections[t++];i<0?e.push(n,i):e.push(i,n)}return new Ts(e)}composeDesc(e){return this.empty?e:e.empty?this:RC(this,e)}mapDesc(e,t=!1){return e.empty?this:tg(this,e,t)}mapPos(e,t=-1,n=dn.Simple){let i=0,s=0;for(let a=0;a<this.sections.length;){let o=this.sections[a++],l=this.sections[a++],f=i+o;if(l<0){if(f>e)return s+(e-i);s+=o}else{if(n!=dn.Simple&&f>=e&&(n==dn.TrackDel&&i<e&&f>e||n==dn.TrackBefore&&i<e||n==dn.TrackAfter&&f>e))return null;if(f>e||f==e&&t<0&&!o)return e==i||t<0?s:s+l;s+=l}i=f}if(e>i)throw new RangeError(`Position ${e} is out of range for changeset of length ${i}`);return s}touchesRange(e,t=e){for(let n=0,i=0;n<this.sections.length&&i<=t;){let s=this.sections[n++],a=this.sections[n++],o=i+s;if(a>=0&&i<=t&&o>=e)return i<e&&o>t?"cover":!0;i=o}return!1}toString(){let e="";for(let t=0;t<this.sections.length;){let n=this.sections[t++],i=this.sections[t++];e+=(e?" ":"")+n+(i>=0?":"+i:"")}return e}toJSON(){return this.sections}static fromJSON(e){if(!Array.isArray(e)||e.length%2||e.some(t=>typeof t!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new Ts(e)}static create(e){return new Ts(e)}}class Wr extends Ts{constructor(e,t){super(e),this.inserted=t}apply(e){if(this.length!=e.length)throw new RangeError("Applying change set to a document with the wrong length");return eg(this,(t,n,i,s,a)=>e=e.replace(i,i+(n-t),a),!1),e}mapDesc(e,t=!1){return tg(this,e,t,!0)}invert(e){let t=this.sections.slice(),n=[];for(let i=0,s=0;i<t.length;i+=2){let a=t[i],o=t[i+1];if(o>=0){t[i]=o,t[i+1]=a;let l=i>>1;for(;n.length<l;)n.push(Ft.empty);n.push(a?e.slice(s,s+a):Ft.empty)}s+=a}return new Wr(t,n)}compose(e){return this.empty?e:e.empty?this:RC(this,e,!0)}map(e,t=!1){return e.empty?this:tg(this,e,t,!0)}iterChanges(e,t=!1){eg(this,e,t)}get desc(){return Ts.create(this.sections)}filter(e){let t=[],n=[],i=[],s=new $c(this);e:for(let a=0,o=0;;){let l=a==e.length?1e9:e[a++];for(;o<l||o==l&&s.len==0;){if(s.done)break e;let c=Math.min(s.len,l-o);vn(i,c,-1);let h=s.ins==-1?-1:s.off==0?s.ins:0;vn(t,c,h),h>0&&Sa(n,t,s.text),s.forward(c),o+=c}let f=e[a++];for(;o<f;){if(s.done)break e;let c=Math.min(s.len,f-o);vn(t,c,-1),vn(i,c,s.ins==-1?-1:s.off==0?s.ins:0),s.forward(c),o+=c}}return{changes:new Wr(t,n),filtered:Ts.create(i)}}toJSON(){let e=[];for(let t=0;t<this.sections.length;t+=2){let n=this.sections[t],i=this.sections[t+1];i<0?e.push(n):i==0?e.push([n]):e.push([n].concat(this.inserted[t>>1].toJSON()))}return e}static of(e,t,n){let i=[],s=[],a=0,o=null;function l(c=!1){if(!c&&!i.length)return;a<t&&vn(i,t-a,-1);let h=new Wr(i,s);o=o?o.compose(h.map(o)):h,i=[],s=[],a=0}function f(c){if(Array.isArray(c))for(let h of c)f(h);else if(c instanceof Wr){if(c.length!=t)throw new RangeError(`Mismatched change set length (got ${c.length}, expected ${t})`);l(),o=o?o.compose(c.map(o)):c}else{let{from:h,to:u=h,insert:d}=c;if(h>u||h<0||u>t)throw new RangeError(`Invalid change range ${h} to ${u} (in doc of length ${t})`);let p=d?typeof d=="string"?Ft.of(d.split(n||Jm)):d:Ft.empty,m=p.length;if(h==u&&m==0)return;h<a&&l(),h>a&&vn(i,h-a,-1),vn(i,u-h,m),Sa(s,i,p),a=u}}return f(e),l(!o),o}static empty(e){return new Wr(e?[e,-1]:[],[])}static fromJSON(e){if(!Array.isArray(e))throw new RangeError("Invalid JSON representation of ChangeSet");let t=[],n=[];for(let i=0;i<e.length;i++){let s=e[i];if(typeof s=="number")t.push(s,-1);else{if(!Array.isArray(s)||typeof s[0]!="number"||s.some((a,o)=>o&&typeof a!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(s.length==1)t.push(s[0],0);else{for(;n.length<i;)n.push(Ft.empty);n[i]=Ft.of(s.slice(1)),t.push(s[0],n[i].length)}}}return new Wr(t,n)}static createSet(e,t){return new Wr(e,t)}}function vn(r,e,t,n=!1){if(e==0&&t<=0)return;let i=r.length-2;i>=0&&t<=0&&t==r[i+1]?r[i]+=e:i>=0&&e==0&&r[i]==0?r[i+1]+=t:n?(r[i]+=e,r[i+1]+=t):r.push(e,t)}function Sa(r,e,t){if(t.length==0)return;let n=e.length-2>>1;if(n<r.length)r[r.length-1]=r[r.length-1].append(t);else{for(;r.length<n;)r.push(Ft.empty);r.push(t)}}function eg(r,e,t){let n=r.inserted;for(let i=0,s=0,a=0;a<r.sections.length;){let o=r.sections[a++],l=r.sections[a++];if(l<0)i+=o,s+=o;else{let f=i,c=s,h=Ft.empty;for(;f+=o,c+=l,l&&n&&(h=h.append(n[a-2>>1])),!(t||a==r.sections.length||r.sections[a+1]<0);)o=r.sections[a++],l=r.sections[a++];e(i,f,s,c,h),i=f,s=c}}}function tg(r,e,t,n=!1){let i=[],s=n?[]:null,a=new $c(r),o=new $c(e);for(let l=-1;;){if(a.done&&o.len||o.done&&a.len)throw new Error("Mismatched change set lengths");if(a.ins==-1&&o.ins==-1){let f=Math.min(a.len,o.len);vn(i,f,-1),a.forward(f),o.forward(f)}else if(o.ins>=0&&(a.ins<0||l==a.i||a.off==0&&(o.len<a.len||o.len==a.len&&!t))){let f=o.len;for(vn(i,o.ins,-1);f;){let c=Math.min(a.len,f);a.ins>=0&&l<a.i&&a.len<=c&&(vn(i,0,a.ins),s&&Sa(s,i,a.text),l=a.i),a.forward(c),f-=c}o.next()}else if(a.ins>=0){let f=0,c=a.len;for(;c;)if(o.ins==-1){let h=Math.min(c,o.len);f+=h,c-=h,o.forward(h)}else if(o.ins==0&&o.len<c)c-=o.len,o.next();else break;vn(i,f,l<a.i?a.ins:0),s&&l<a.i&&Sa(s,i,a.text),l=a.i,a.forward(a.len-c)}else{if(a.done&&o.done)return s?Wr.createSet(i,s):Ts.create(i);throw new Error("Mismatched change set lengths")}}}function RC(r,e,t=!1){let n=[],i=t?[]:null,s=new $c(r),a=new $c(e);for(let o=!1;;){if(s.done&&a.done)return i?Wr.createSet(n,i):Ts.create(n);if(s.ins==0)vn(n,s.len,0,o),s.next();else if(a.len==0&&!a.done)vn(n,0,a.ins,o),i&&Sa(i,n,a.text),a.next();else{if(s.done||a.done)throw new Error("Mismatched change set lengths");{let l=Math.min(s.len2,a.len),f=n.length;if(s.ins==-1){let c=a.ins==-1?-1:a.off?0:a.ins;vn(n,l,c,o),i&&c&&Sa(i,n,a.text)}else a.ins==-1?(vn(n,s.off?0:s.len,l,o),i&&Sa(i,n,s.textBit(l))):(vn(n,s.off?0:s.len,a.off?0:a.ins,o),i&&!a.off&&Sa(i,n,a.text));o=(s.ins>l||a.ins>=0&&a.len>l)&&(o||n.length>f),s.forward2(l),a.forward(l)}}}}class $c{constructor(e){this.set=e,this.i=0,this.next()}next(){let{sections:e}=this.set;this.i<e.length?(this.len=e[this.i++],this.ins=e[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:e}=this.set,t=this.i-2>>1;return t>=e.length?Ft.empty:e[t]}textBit(e){let{inserted:t}=this.set,n=this.i-2>>1;return n>=t.length&&!e?Ft.empty:t[n].slice(this.off,e==null?void 0:this.off+e)}forward(e){e==this.len?this.next():(this.len-=e,this.off+=e)}forward2(e){this.ins==-1?this.forward(e):e==this.ins?this.next():(this.ins-=e,this.off+=e)}}class uo{constructor(e,t,n){this.from=e,this.to=t,this.flags=n}get anchor(){return this.flags&32?this.to:this.from}get head(){return this.flags&32?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&8?-1:this.flags&16?1:0}get bidiLevel(){let e=this.flags&7;return e==7?null:e}get goalColumn(){let e=this.flags>>6;return e==16777215?void 0:e}map(e,t=-1){let n,i;return this.empty?n=i=e.mapPos(this.from,t):(n=e.mapPos(this.from,1),i=e.mapPos(this.to,-1)),n==this.from&&i==this.to?this:new uo(n,i,this.flags)}extend(e,t=e){if(e<=this.anchor&&t>=this.anchor)return Oe.range(e,t);let n=Math.abs(e-this.anchor)>Math.abs(t-this.anchor)?e:t;return Oe.range(this.anchor,n)}eq(e,t=!1){return this.anchor==e.anchor&&this.head==e.head&&(!t||!this.empty||this.assoc==e.assoc)}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(e){if(!e||typeof e.anchor!="number"||typeof e.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return Oe.range(e.anchor,e.head)}static create(e,t,n){return new uo(e,t,n)}}class Oe{constructor(e,t){this.ranges=e,this.mainIndex=t}map(e,t=-1){return e.empty?this:Oe.create(this.ranges.map(n=>n.map(e,t)),this.mainIndex)}eq(e,t=!1){if(this.ranges.length!=e.ranges.length||this.mainIndex!=e.mainIndex)return!1;for(let n=0;n<this.ranges.length;n++)if(!this.ranges[n].eq(e.ranges[n],t))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new Oe([this.main],0)}addRange(e,t=!0){return Oe.create([e].concat(this.ranges),t?0:this.mainIndex+1)}replaceRange(e,t=this.mainIndex){let n=this.ranges.slice();return n[t]=e,Oe.create(n,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(e=>e.toJSON()),main:this.mainIndex}}static fromJSON(e){if(!e||!Array.isArray(e.ranges)||typeof e.main!="number"||e.main>=e.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new Oe(e.ranges.map(t=>uo.fromJSON(t)),e.main)}static single(e,t=e){return new Oe([Oe.range(e,t)],0)}static create(e,t=0){if(e.length==0)throw new RangeError("A selection needs at least one range");for(let n=0,i=0;i<e.length;i++){let s=e[i];if(s.empty?s.from<=n:s.from<n)return Oe.normalized(e.slice(),t);n=s.to}return new Oe(e,t)}static cursor(e,t=0,n,i){return uo.create(e,e,(t==0?0:t<0?8:16)|(n==null?7:Math.min(6,n))|(i??16777215)<<6)}static range(e,t,n,i){let s=(n??16777215)<<6|(i==null?7:Math.min(6,i));return t<e?uo.create(t,e,48|s):uo.create(e,t,(t>e?8:0)|s)}static normalized(e,t=0){let n=e[t];e.sort((i,s)=>i.from-s.from),t=e.indexOf(n);for(let i=1;i<e.length;i++){let s=e[i],a=e[i-1];if(s.empty?s.from<=a.to:s.from<a.to){let o=a.from,l=Math.max(s.to,a.to);i<=t&&t--,e.splice(--i,2,s.anchor>s.head?Oe.range(l,o):Oe.range(o,l))}}return new Oe(e,t)}}function QC(r,e){for(let t of r.ranges)if(t.to>e)throw new RangeError("Selection points outside of document")}let rx=0;class Ze{constructor(e,t,n,i,s){this.combine=e,this.compareInput=t,this.compare=n,this.isStatic=i,this.id=rx++,this.default=e([]),this.extensions=typeof s=="function"?s(this):s}get reader(){return this}static define(e={}){return new Ze(e.combine||(t=>t),e.compareInput||((t,n)=>t===n),e.compare||(e.combine?(t,n)=>t===n:nx),!!e.static,e.enables)}of(e){return new $u([],this,0,e)}compute(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new $u(e,this,1,t)}computeN(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new $u(e,this,2,t)}from(e,t){return t||(t=n=>n),this.compute([e],n=>t(n.field(e)))}}function nx(r,e){return r==e||r.length==e.length&&r.every((t,n)=>t===e[n])}class $u{constructor(e,t,n,i){this.dependencies=e,this.facet=t,this.type=n,this.value=i,this.id=rx++}dynamicSlot(e){var t;let n=this.value,i=this.facet.compareInput,s=this.id,a=e[s]>>1,o=this.type==2,l=!1,f=!1,c=[];for(let h of this.dependencies)h=="doc"?l=!0:h=="selection"?f=!0:((t=e[h.id])!==null&&t!==void 0?t:1)&1||c.push(e[h.id]);return{create(h){return h.values[a]=n(h),1},update(h,u){if(l&&u.docChanged||f&&(u.docChanged||u.selection)||rg(h,c)){let d=n(h);if(o?!pw(d,h.values[a],i):!i(d,h.values[a]))return h.values[a]=d,1}return 0},reconfigure:(h,u)=>{let d,p=u.config.address[s];if(p!=null){let m=Pd(u,p);if(this.dependencies.every(g=>g instanceof Ze?u.facet(g)===h.facet(g):g instanceof Cr?u.field(g,!1)==h.field(g,!1):!0)||(o?pw(d=n(h),m,i):i(d=n(h),m)))return h.values[a]=m,0}else d=n(h);return h.values[a]=d,1}}}}function pw(r,e,t){if(r.length!=e.length)return!1;for(let n=0;n<r.length;n++)if(!t(r[n],e[n]))return!1;return!0}function rg(r,e){let t=!1;for(let n of e)fc(r,n)&1&&(t=!0);return t}function YX(r,e,t){let n=t.map(l=>r[l.id]),i=t.map(l=>l.type),s=n.filter(l=>!(l&1)),a=r[e.id]>>1;function o(l){let f=[];for(let c=0;c<n.length;c++){let h=Pd(l,n[c]);if(i[c]==2)for(let u of h)f.push(u);else f.push(h)}return e.combine(f)}return{create(l){for(let f of n)fc(l,f);return l.values[a]=o(l),1},update(l,f){if(!rg(l,s))return 0;let c=o(l);return e.compare(c,l.values[a])?0:(l.values[a]=c,1)},reconfigure(l,f){let c=rg(l,n),h=f.config.facets[e.id],u=f.facet(e);if(h&&!c&&nx(t,h))return l.values[a]=u,0;let d=o(l);return e.compare(d,u)?(l.values[a]=u,0):(l.values[a]=d,1)}}}const mw=Ze.define({static:!0});class Cr{constructor(e,t,n,i,s){this.id=e,this.createF=t,this.updateF=n,this.compareF=i,this.spec=s,this.provides=void 0}static define(e){let t=new Cr(rx++,e.create,e.update,e.compare||((n,i)=>n===i),e);return e.provide&&(t.provides=e.provide(t)),t}create(e){let t=e.facet(mw).find(n=>n.field==this);return((t==null?void 0:t.create)||this.createF)(e)}slot(e){let t=e[this.id]>>1;return{create:n=>(n.values[t]=this.create(n),1),update:(n,i)=>{let s=n.values[t],a=this.updateF(s,i);return this.compareF(s,a)?0:(n.values[t]=a,1)},reconfigure:(n,i)=>i.config.address[this.id]!=null?(n.values[t]=i.field(this),0):(n.values[t]=this.create(n),1)}}init(e){return[this,mw.of({field:this,create:e})]}get extension(){return this}}const fo={lowest:4,low:3,default:2,high:1,highest:0};function gf(r){return e=>new FC(e,r)}const ja={highest:gf(fo.highest),high:gf(fo.high),default:gf(fo.default),low:gf(fo.low),lowest:gf(fo.lowest)};class FC{constructor(e,t){this.inner=e,this.prec=t}}class A0{of(e){return new ng(this,e)}reconfigure(e){return A0.reconfigure.of({compartment:this,extension:e})}get(e){return e.config.compartments.get(this)}}class ng{constructor(e,t){this.compartment=e,this.inner=t}}class Ed{constructor(e,t,n,i,s,a){for(this.base=e,this.compartments=t,this.dynamicSlots=n,this.address=i,this.staticValues=s,this.facets=a,this.statusTemplate=[];this.statusTemplate.length<n.length;)this.statusTemplate.push(0)}staticFacet(e){let t=this.address[e.id];return t==null?e.default:this.staticValues[t>>1]}static resolve(e,t,n){let i=[],s=Object.create(null),a=new Map;for(let u of KX(e,t,a))u instanceof Cr?i.push(u):(s[u.facet.id]||(s[u.facet.id]=[])).push(u);let o=Object.create(null),l=[],f=[];for(let u of i)o[u.id]=f.length<<1,f.push(d=>u.slot(d));let c=n==null?void 0:n.config.facets;for(let u in s){let d=s[u],p=d[0].facet,m=c&&c[u]||[];if(d.every(g=>g.type==0))if(o[p.id]=l.length<<1|1,nx(m,d))l.push(n.facet(p));else{let g=p.combine(d.map(O=>O.value));l.push(n&&p.compare(g,n.facet(p))?n.facet(p):g)}else{for(let g of d)g.type==0?(o[g.id]=l.length<<1|1,l.push(g.value)):(o[g.id]=f.length<<1,f.push(O=>g.dynamicSlot(O)));o[p.id]=f.length<<1,f.push(g=>YX(g,p,d))}}let h=f.map(u=>u(o));return new Ed(e,a,h,o,l,s)}}function KX(r,e,t){let n=[[],[],[],[],[]],i=new Map;function s(a,o){let l=i.get(a);if(l!=null){if(l<=o)return;let f=n[l].indexOf(a);f>-1&&n[l].splice(f,1),a instanceof ng&&t.delete(a.compartment)}if(i.set(a,o),Array.isArray(a))for(let f of a)s(f,o);else if(a instanceof ng){if(t.has(a.compartment))throw new RangeError("Duplicate use of compartment in extensions");let f=e.get(a.compartment)||a.inner;t.set(a.compartment,f),s(f,o)}else if(a instanceof FC)s(a.inner,a.prec);else if(a instanceof Cr)n[o].push(a),a.provides&&s(a.provides,o);else if(a instanceof $u)n[o].push(a),a.facet.extensions&&s(a.facet.extensions,fo.default);else{let f=a.extension;if(!f)throw new Error(`Unrecognized extension value in extension set (${a}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);s(f,o)}}return s(r,fo.default),n.reduce((a,o)=>a.concat(o))}function fc(r,e){if(e&1)return 2;let t=e>>1,n=r.status[t];if(n==4)throw new Error("Cyclic dependency between fields and/or facets");if(n&2)return n;r.status[t]=4;let i=r.computeSlot(r,r.config.dynamicSlots[t]);return r.status[t]=2|i}function Pd(r,e){return e&1?r.config.staticValues[e>>1]:r.values[e>>1]}const $C=Ze.define(),ig=Ze.define({combine:r=>r.some(e=>e),static:!0}),DC=Ze.define({combine:r=>r.length?r[0]:void 0,static:!0}),NC=Ze.define(),MC=Ze.define(),IC=Ze.define(),LC=Ze.define({combine:r=>r.length?r[0]:!1});class Is{constructor(e,t){this.type=e,this.value=t}static define(){return new JX}}class JX{of(e){return new Is(this,e)}}class eV{constructor(e){this.map=e}of(e){return new rt(this,e)}}class rt{constructor(e,t){this.type=e,this.value=t}map(e){let t=this.type.map(this.value,e);return t===void 0?void 0:t==this.value?this:new rt(this.type,t)}is(e){return this.type==e}static define(e={}){return new eV(e.map||(t=>t))}static mapEffects(e,t){if(!e.length)return e;let n=[];for(let i of e){let s=i.map(t);s&&n.push(s)}return n}}rt.reconfigure=rt.define();rt.appendConfig=rt.define();class Br{constructor(e,t,n,i,s,a){this.startState=e,this.changes=t,this.selection=n,this.effects=i,this.annotations=s,this.scrollIntoView=a,this._doc=null,this._state=null,n&&QC(n,t.newLength),s.some(o=>o.type==Br.time)||(this.annotations=s.concat(Br.time.of(Date.now())))}static create(e,t,n,i,s,a){return new Br(e,t,n,i,s,a)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(e){for(let t of this.annotations)if(t.type==e)return t.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(e){let t=this.annotation(Br.userEvent);return!!(t&&(t==e||t.length>e.length&&t.slice(0,e.length)==e&&t[e.length]=="."))}}Br.time=Is.define();Br.userEvent=Is.define();Br.addToHistory=Is.define();Br.remote=Is.define();function tV(r,e){let t=[];for(let n=0,i=0;;){let s,a;if(n<r.length&&(i==e.length||e[i]>=r[n]))s=r[n++],a=r[n++];else if(i<e.length)s=e[i++],a=e[i++];else return t;!t.length||t[t.length-1]<s?t.push(s,a):t[t.length-1]<a&&(t[t.length-1]=a)}}function BC(r,e,t){var n;let i,s,a;return t?(i=e.changes,s=Wr.empty(e.changes.length),a=r.changes.compose(e.changes)):(i=e.changes.map(r.changes),s=r.changes.mapDesc(e.changes,!0),a=r.changes.compose(i)),{changes:a,selection:e.selection?e.selection.map(s):(n=r.selection)===null||n===void 0?void 0:n.map(i),effects:rt.mapEffects(r.effects,i).concat(rt.mapEffects(e.effects,s)),annotations:r.annotations.length?r.annotations.concat(e.annotations):e.annotations,scrollIntoView:r.scrollIntoView||e.scrollIntoView}}function sg(r,e,t){let n=e.selection,i=xl(e.annotations);return e.userEvent&&(i=i.concat(Br.userEvent.of(e.userEvent))),{changes:e.changes instanceof Wr?e.changes:Wr.of(e.changes||[],t,r.facet(DC)),selection:n&&(n instanceof Oe?n:Oe.single(n.anchor,n.head)),effects:xl(e.effects),annotations:i,scrollIntoView:!!e.scrollIntoView}}function ZC(r,e,t){let n=sg(r,e.length?e[0]:{},r.doc.length);e.length&&e[0].filter===!1&&(t=!1);for(let s=1;s<e.length;s++){e[s].filter===!1&&(t=!1);let a=!!e[s].sequential;n=BC(n,sg(r,e[s],a?n.changes.newLength:r.doc.length),a)}let i=Br.create(r,n.changes,n.selection,n.effects,n.annotations,n.scrollIntoView);return nV(t?rV(i):i)}function rV(r){let e=r.startState,t=!0;for(let i of e.facet(NC)){let s=i(r);if(s===!1){t=!1;break}Array.isArray(s)&&(t=t===!0?s:tV(t,s))}if(t!==!0){let i,s;if(t===!1)s=r.changes.invertedDesc,i=Wr.empty(e.doc.length);else{let a=r.changes.filter(t);i=a.changes,s=a.filtered.mapDesc(a.changes).invertedDesc}r=Br.create(e,i,r.selection&&r.selection.map(s),rt.mapEffects(r.effects,s),r.annotations,r.scrollIntoView)}let n=e.facet(MC);for(let i=n.length-1;i>=0;i--){let s=n[i](r);s instanceof Br?r=s:Array.isArray(s)&&s.length==1&&s[0]instanceof Br?r=s[0]:r=ZC(e,xl(s),!1)}return r}function nV(r){let e=r.startState,t=e.facet(IC),n=r;for(let i=t.length-1;i>=0;i--){let s=t[i](r);s&&Object.keys(s).length&&(n=BC(n,sg(e,s,r.changes.newLength),!0))}return n==r?r:Br.create(e,r.changes,r.selection,n.effects,n.annotations,n.scrollIntoView)}const iV=[];function xl(r){return r==null?iV:Array.isArray(r)?r:[r]}var ur=function(r){return r[r.Word=0]="Word",r[r.Space=1]="Space",r[r.Other=2]="Other",r}(ur||(ur={}));const sV=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let ag;try{ag=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function aV(r){if(ag)return ag.test(r);for(let e=0;e<r.length;e++){let t=r[e];if(/\w/.test(t)||t>""&&(t.toUpperCase()!=t.toLowerCase()||sV.test(t)))return!0}return!1}function oV(r){return e=>{if(!/\S/.test(e))return ur.Space;if(aV(e))return ur.Word;for(let t=0;t<r.length;t++)if(e.indexOf(r[t])>-1)return ur.Word;return ur.Other}}class st{constructor(e,t,n,i,s,a){this.config=e,this.doc=t,this.selection=n,this.values=i,this.status=e.statusTemplate.slice(),this.computeSlot=s,a&&(a._state=this);for(let o=0;o<this.config.dynamicSlots.length;o++)fc(this,o<<1);this.computeSlot=null}field(e,t=!0){let n=this.config.address[e.id];if(n==null){if(t)throw new RangeError("Field is not present in this state");return}return fc(this,n),Pd(this,n)}update(...e){return ZC(this,e,!0)}applyTransaction(e){let t=this.config,{base:n,compartments:i}=t;for(let o of e.effects)o.is(A0.reconfigure)?(t&&(i=new Map,t.compartments.forEach((l,f)=>i.set(f,l)),t=null),i.set(o.value.compartment,o.value.extension)):o.is(rt.reconfigure)?(t=null,n=o.value):o.is(rt.appendConfig)&&(t=null,n=xl(n).concat(o.value));let s;t?s=e.startState.values.slice():(t=Ed.resolve(n,i,this),s=new st(t,this.doc,this.selection,t.dynamicSlots.map(()=>null),(l,f)=>f.reconfigure(l,this),null).values);let a=e.startState.facet(ig)?e.newSelection:e.newSelection.asSingle();new st(t,e.newDoc,a,s,(o,l)=>l.update(o,e),e)}replaceSelection(e){return typeof e=="string"&&(e=this.toText(e)),this.changeByRange(t=>({changes:{from:t.from,to:t.to,insert:e},range:Oe.cursor(t.from+e.length)}))}changeByRange(e){let t=this.selection,n=e(t.ranges[0]),i=this.changes(n.changes),s=[n.range],a=xl(n.effects);for(let o=1;o<t.ranges.length;o++){let l=e(t.ranges[o]),f=this.changes(l.changes),c=f.map(i);for(let u=0;u<o;u++)s[u]=s[u].map(c);let h=i.mapDesc(f,!0);s.push(l.range.map(h)),i=i.compose(c),a=rt.mapEffects(a,c).concat(rt.mapEffects(xl(l.effects),h))}return{changes:i,selection:Oe.create(s,t.mainIndex),effects:a}}changes(e=[]){return e instanceof Wr?e:Wr.of(e,this.doc.length,this.facet(st.lineSeparator))}toText(e){return Ft.of(e.split(this.facet(st.lineSeparator)||Jm))}sliceDoc(e=0,t=this.doc.length){return this.doc.sliceString(e,t,this.lineBreak)}facet(e){let t=this.config.address[e.id];return t==null?e.default:(fc(this,t),Pd(this,t))}toJSON(e){let t={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(e)for(let n in e){let i=e[n];i instanceof Cr&&this.config.address[i.id]!=null&&(t[n]=i.spec.toJSON(this.field(e[n]),this))}return t}static fromJSON(e,t={},n){if(!e||typeof e.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let i=[];if(n){for(let s in n)if(Object.prototype.hasOwnProperty.call(e,s)){let a=n[s],o=e[s];i.push(a.init(l=>a.spec.fromJSON(o,l)))}}return st.create({doc:e.doc,selection:Oe.fromJSON(e.selection),extensions:t.extensions?i.concat([t.extensions]):i})}static create(e={}){let t=Ed.resolve(e.extensions||[],new Map),n=e.doc instanceof Ft?e.doc:Ft.of((e.doc||"").split(t.staticFacet(st.lineSeparator)||Jm)),i=e.selection?e.selection instanceof Oe?e.selection:Oe.single(e.selection.anchor,e.selection.head):Oe.single(0);return QC(i,n.length),t.staticFacet(ig)||(i=i.asSingle()),new st(t,n,i,t.dynamicSlots.map(()=>null),(s,a)=>a.create(s),null)}get tabSize(){return this.facet(st.tabSize)}get lineBreak(){return this.facet(st.lineSeparator)||`
`}get readOnly(){return this.facet(LC)}phrase(e,...t){for(let n of this.facet(st.phrases))if(Object.prototype.hasOwnProperty.call(n,e)){e=n[e];break}return t.length&&(e=e.replace(/\$(\$|\d*)/g,(n,i)=>{if(i=="$")return"$";let s=+(i||1);return!s||s>t.length?n:t[s-1]})),e}languageDataAt(e,t,n=-1){let i=[];for(let s of this.facet($C))for(let a of s(this,t,n))Object.prototype.hasOwnProperty.call(a,e)&&i.push(a[e]);return i}charCategorizer(e){return oV(this.languageDataAt("wordChars",e).join(""))}wordAt(e){let{text:t,from:n,length:i}=this.doc.lineAt(e),s=this.charCategorizer(e),a=e-n,o=e-n;for(;a>0;){let l=pn(t,a,!1);if(s(t.slice(l,a))!=ur.Word)break;a=l}for(;o<i;){let l=pn(t,o);if(s(t.slice(o,l))!=ur.Word)break;o=l}return a==o?null:Oe.range(a+n,o+n)}}st.allowMultipleSelections=ig;st.tabSize=Ze.define({combine:r=>r.length?r[0]:4});st.lineSeparator=DC;st.readOnly=LC;st.phrases=Ze.define({compare(r,e){let t=Object.keys(r),n=Object.keys(e);return t.length==n.length&&t.every(i=>r[i]==e[i])}});st.languageData=$C;st.changeFilter=NC;st.transactionFilter=MC;st.transactionExtender=IC;A0.reconfigure=rt.define();function Ls(r,e,t={}){let n={};for(let i of r)for(let s of Object.keys(i)){let a=i[s],o=n[s];if(o===void 0)n[s]=a;else if(!(o===a||a===void 0))if(Object.hasOwnProperty.call(t,s))n[s]=t[s](o,a);else throw new Error("Config merge conflict for field "+s)}for(let i in e)n[i]===void 0&&(n[i]=e[i]);return n}class Ks{eq(e){return this==e}range(e,t=e){return og.create(e,t,this)}}Ks.prototype.startSide=Ks.prototype.endSide=0;Ks.prototype.point=!1;Ks.prototype.mapMode=dn.TrackDel;let og=class WC{constructor(e,t,n){this.from=e,this.to=t,this.value=n}static create(e,t,n){return new WC(e,t,n)}};function lg(r,e){return r.from-e.from||r.value.startSide-e.value.startSide}class ix{constructor(e,t,n,i){this.from=e,this.to=t,this.value=n,this.maxPoint=i}get length(){return this.to[this.to.length-1]}findIndex(e,t,n,i=0){let s=n?this.to:this.from;for(let a=i,o=s.length;;){if(a==o)return a;let l=a+o>>1,f=s[l]-e||(n?this.value[l].endSide:this.value[l].startSide)-t;if(l==a)return f>=0?a:o;f>=0?o=l:a=l+1}}between(e,t,n,i){for(let s=this.findIndex(t,-1e9,!0),a=this.findIndex(n,1e9,!1,s);s<a;s++)if(i(this.from[s]+e,this.to[s]+e,this.value[s])===!1)return!1}map(e,t){let n=[],i=[],s=[],a=-1,o=-1;for(let l=0;l<this.value.length;l++){let f=this.value[l],c=this.from[l]+e,h=this.to[l]+e,u,d;if(c==h){let p=t.mapPos(c,f.startSide,f.mapMode);if(p==null||(u=d=p,f.startSide!=f.endSide&&(d=t.mapPos(c,f.endSide),d<u)))continue}else if(u=t.mapPos(c,f.startSide),d=t.mapPos(h,f.endSide),u>d||u==d&&f.startSide>0&&f.endSide<=0)continue;(d-u||f.endSide-f.startSide)<0||(a<0&&(a=u),f.point&&(o=Math.max(o,d-u)),n.push(f),i.push(u-a),s.push(d-a))}return{mapped:n.length?new ix(i,s,n,o):null,pos:a}}}class Ct{constructor(e,t,n,i){this.chunkPos=e,this.chunk=t,this.nextLayer=n,this.maxPoint=i}static create(e,t,n,i){return new Ct(e,t,n,i)}get length(){let e=this.chunk.length-1;return e<0?0:Math.max(this.chunkEnd(e),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let e=this.nextLayer.size;for(let t of this.chunk)e+=t.value.length;return e}chunkEnd(e){return this.chunkPos[e]+this.chunk[e].length}update(e){let{add:t=[],sort:n=!1,filterFrom:i=0,filterTo:s=this.length}=e,a=e.filter;if(t.length==0&&!a)return this;if(n&&(t=t.slice().sort(lg)),this.isEmpty)return t.length?Ct.of(t):this;let o=new UC(this,null,-1).goto(0),l=0,f=[],c=new Js;for(;o.value||l<t.length;)if(l<t.length&&(o.from-t[l].from||o.startSide-t[l].value.startSide)>=0){let h=t[l++];c.addInner(h.from,h.to,h.value)||f.push(h)}else o.rangeIndex==1&&o.chunkIndex<this.chunk.length&&(l==t.length||this.chunkEnd(o.chunkIndex)<t[l].from)&&(!a||i>this.chunkEnd(o.chunkIndex)||s<this.chunkPos[o.chunkIndex])&&c.addChunk(this.chunkPos[o.chunkIndex],this.chunk[o.chunkIndex])?o.nextChunk():((!a||i>o.to||s<o.from||a(o.from,o.to,o.value))&&(c.addInner(o.from,o.to,o.value)||f.push(og.create(o.from,o.to,o.value))),o.next());return c.finishInner(this.nextLayer.isEmpty&&!f.length?Ct.empty:this.nextLayer.update({add:f,filter:a,filterFrom:i,filterTo:s}))}map(e){if(e.empty||this.isEmpty)return this;let t=[],n=[],i=-1;for(let a=0;a<this.chunk.length;a++){let o=this.chunkPos[a],l=this.chunk[a],f=e.touchesRange(o,o+l.length);if(f===!1)i=Math.max(i,l.maxPoint),t.push(l),n.push(e.mapPos(o));else if(f===!0){let{mapped:c,pos:h}=l.map(o,e);c&&(i=Math.max(i,c.maxPoint),t.push(c),n.push(h))}}let s=this.nextLayer.map(e);return t.length==0?s:new Ct(n,t,s||Ct.empty,i)}between(e,t,n){if(!this.isEmpty){for(let i=0;i<this.chunk.length;i++){let s=this.chunkPos[i],a=this.chunk[i];if(t>=s&&e<=s+a.length&&a.between(s,e-s,t-s,n)===!1)return}this.nextLayer.between(e,t,n)}}iter(e=0){return Dc.from([this]).goto(e)}get isEmpty(){return this.nextLayer==this}static iter(e,t=0){return Dc.from(e).goto(t)}static compare(e,t,n,i,s=-1){let a=e.filter(h=>h.maxPoint>0||!h.isEmpty&&h.maxPoint>=s),o=t.filter(h=>h.maxPoint>0||!h.isEmpty&&h.maxPoint>=s),l=gw(a,o,n),f=new Of(a,l,s),c=new Of(o,l,s);n.iterGaps((h,u,d)=>Ow(f,h,c,u,d,i)),n.empty&&n.length==0&&Ow(f,0,c,0,0,i)}static eq(e,t,n=0,i){i==null&&(i=999999999);let s=e.filter(c=>!c.isEmpty&&t.indexOf(c)<0),a=t.filter(c=>!c.isEmpty&&e.indexOf(c)<0);if(s.length!=a.length)return!1;if(!s.length)return!0;let o=gw(s,a),l=new Of(s,o,0).goto(n),f=new Of(a,o,0).goto(n);for(;;){if(l.to!=f.to||!fg(l.active,f.active)||l.point&&(!f.point||!l.point.eq(f.point)))return!1;if(l.to>i)return!0;l.next(),f.next()}}static spans(e,t,n,i,s=-1){let a=new Of(e,null,s).goto(t),o=t,l=a.openStart;for(;;){let f=Math.min(a.to,n);if(a.point){let c=a.activeForPoint(a.to),h=a.pointFrom<t?c.length+1:a.point.startSide<0?c.length:Math.min(c.length,l);i.point(o,f,a.point,c,h,a.pointRank),l=Math.min(a.openEnd(f),c.length)}else f>o&&(i.span(o,f,a.active,l),l=a.openEnd(f));if(a.to>n)return l+(a.point&&a.to>n?1:0);o=a.to,a.next()}}static of(e,t=!1){let n=new Js;for(let i of e instanceof og?[e]:t?lV(e):e)n.add(i.from,i.to,i.value);return n.finish()}static join(e){if(!e.length)return Ct.empty;let t=e[e.length-1];for(let n=e.length-2;n>=0;n--)for(let i=e[n];i!=Ct.empty;i=i.nextLayer)t=new Ct(i.chunkPos,i.chunk,t,Math.max(i.maxPoint,t.maxPoint));return t}}Ct.empty=new Ct([],[],null,-1);function lV(r){if(r.length>1)for(let e=r[0],t=1;t<r.length;t++){let n=r[t];if(lg(e,n)>0)return r.slice().sort(lg);e=n}return r}Ct.empty.nextLayer=Ct.empty;class Js{finishChunk(e){this.chunks.push(new ix(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,e&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(e,t,n){this.addInner(e,t,n)||(this.nextLayer||(this.nextLayer=new Js)).add(e,t,n)}addInner(e,t,n){let i=e-this.lastTo||n.startSide-this.last.endSide;if(i<=0&&(e-this.lastFrom||n.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return i<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=e),this.from.push(e-this.chunkStart),this.to.push(t-this.chunkStart),this.last=n,this.lastFrom=e,this.lastTo=t,this.value.push(n),n.point&&(this.maxPoint=Math.max(this.maxPoint,t-e)),!0)}addChunk(e,t){if((e-this.lastTo||t.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,t.maxPoint),this.chunks.push(t),this.chunkPos.push(e);let n=t.value.length-1;return this.last=t.value[n],this.lastFrom=t.from[n]+e,this.lastTo=t.to[n]+e,!0}finish(){return this.finishInner(Ct.empty)}finishInner(e){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return e;let t=Ct.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(e):e,this.setMaxPoint);return this.from=null,t}}function gw(r,e,t){let n=new Map;for(let s of r)for(let a=0;a<s.chunk.length;a++)s.chunk[a].maxPoint<=0&&n.set(s.chunk[a],s.chunkPos[a]);let i=new Set;for(let s of e)for(let a=0;a<s.chunk.length;a++){let o=n.get(s.chunk[a]);o!=null&&(t?t.mapPos(o):o)==s.chunkPos[a]&&!(t!=null&&t.touchesRange(o,o+s.chunk[a].length))&&i.add(s.chunk[a])}return i}class UC{constructor(e,t,n,i=0){this.layer=e,this.skip=t,this.minPoint=n,this.rank=i}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(e,t=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(e,t,!1),this}gotoInner(e,t,n){for(;this.chunkIndex<this.layer.chunk.length;){let i=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(i)||this.layer.chunkEnd(this.chunkIndex)<e||i.maxPoint<this.minPoint))break;this.chunkIndex++,n=!1}if(this.chunkIndex<this.layer.chunk.length){let i=this.layer.chunk[this.chunkIndex].findIndex(e-this.layer.chunkPos[this.chunkIndex],t,!0);(!n||this.rangeIndex<i)&&this.setRangeIndex(i)}this.next()}forward(e,t){(this.to-e||this.endSide-t)<0&&this.gotoInner(e,t,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let e=this.layer.chunkPos[this.chunkIndex],t=this.layer.chunk[this.chunkIndex],n=e+t.from[this.rangeIndex];if(this.from=n,this.to=e+t.to[this.rangeIndex],this.value=t.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(e){if(e==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=e}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(e){return this.from-e.from||this.startSide-e.startSide||this.rank-e.rank||this.to-e.to||this.endSide-e.endSide}}class Dc{constructor(e){this.heap=e}static from(e,t=null,n=-1){let i=[];for(let s=0;s<e.length;s++)for(let a=e[s];!a.isEmpty;a=a.nextLayer)a.maxPoint>=n&&i.push(new UC(a,t,n,s));return i.length==1?i[0]:new Dc(i)}get startSide(){return this.value?this.value.startSide:0}goto(e,t=-1e9){for(let n of this.heap)n.goto(e,t);for(let n=this.heap.length>>1;n>=0;n--)xp(this.heap,n);return this.next(),this}forward(e,t){for(let n of this.heap)n.forward(e,t);for(let n=this.heap.length>>1;n>=0;n--)xp(this.heap,n);(this.to-e||this.value.endSide-t)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let e=this.heap[0];this.from=e.from,this.to=e.to,this.value=e.value,this.rank=e.rank,e.value&&e.next(),xp(this.heap,0)}}}function xp(r,e){for(let t=r[e];;){let n=(e<<1)+1;if(n>=r.length)break;let i=r[n];if(n+1<r.length&&i.compare(r[n+1])>=0&&(i=r[n+1],n++),t.compare(i)<0)break;r[n]=t,r[e]=i,e=n}}class Of{constructor(e,t,n){this.minPoint=n,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=Dc.from(e,t,n)}goto(e,t=-1e9){return this.cursor.goto(e,t),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=e,this.endSide=t,this.openStart=-1,this.next(),this}forward(e,t){for(;this.minActive>-1&&(this.activeTo[this.minActive]-e||this.active[this.minActive].endSide-t)<0;)this.removeActive(this.minActive);this.cursor.forward(e,t)}removeActive(e){Gh(this.active,e),Gh(this.activeTo,e),Gh(this.activeRank,e),this.minActive=xw(this.active,this.activeTo)}addActive(e){let t=0,{value:n,to:i,rank:s}=this.cursor;for(;t<this.activeRank.length&&(s-this.activeRank[t]||i-this.activeTo[t])>0;)t++;Hh(this.active,t,n),Hh(this.activeTo,t,i),Hh(this.activeRank,t,s),e&&Hh(e,t,this.cursor.from),this.minActive=xw(this.active,this.activeTo)}next(){let e=this.to,t=this.point;this.point=null;let n=this.openStart<0?[]:null;for(;;){let i=this.minActive;if(i>-1&&(this.activeTo[i]-this.cursor.from||this.active[i].endSide-this.cursor.startSide)<0){if(this.activeTo[i]>e){this.to=this.activeTo[i],this.endSide=this.active[i].endSide;break}this.removeActive(i),n&&Gh(n,i)}else if(this.cursor.value)if(this.cursor.from>e){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let s=this.cursor.value;if(!s.point)this.addActive(n),this.cursor.next();else if(t&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=s,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=s.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(n){this.openStart=0;for(let i=n.length-1;i>=0&&n[i]<e;i--)this.openStart++}}activeForPoint(e){if(!this.active.length)return this.active;let t=[];for(let n=this.active.length-1;n>=0&&!(this.activeRank[n]<this.pointRank);n--)(this.activeTo[n]>e||this.activeTo[n]==e&&this.active[n].endSide>=this.point.endSide)&&t.push(this.active[n]);return t.reverse()}openEnd(e){let t=0;for(let n=this.activeTo.length-1;n>=0&&this.activeTo[n]>e;n--)t++;return t}}function Ow(r,e,t,n,i,s){r.goto(e),t.goto(n);let a=n+i,o=n,l=n-e;for(;;){let f=r.to+l-t.to,c=f||r.endSide-t.endSide,h=c<0?r.to+l:t.to,u=Math.min(h,a);if(r.point||t.point?r.point&&t.point&&(r.point==t.point||r.point.eq(t.point))&&fg(r.activeForPoint(r.to),t.activeForPoint(t.to))||s.comparePoint(o,u,r.point,t.point):u>o&&!fg(r.active,t.active)&&s.compareRange(o,u,r.active,t.active),h>a)break;(f||r.openEnd!=t.openEnd)&&s.boundChange&&s.boundChange(h),o=h,c<=0&&r.next(),c>=0&&t.next()}}function fg(r,e){if(r.length!=e.length)return!1;for(let t=0;t<r.length;t++)if(r[t]!=e[t]&&!r[t].eq(e[t]))return!1;return!0}function Gh(r,e){for(let t=e,n=r.length-1;t<n;t++)r[t]=r[t+1];r.pop()}function Hh(r,e,t){for(let n=r.length-1;n>=e;n--)r[n+1]=r[n];r[e]=t}function xw(r,e){let t=-1,n=1e9;for(let i=0;i<e.length;i++)(e[i]-n||r[i].endSide-r[t].endSide)<0&&(t=i,n=e[i]);return t}function sf(r,e,t=r.length){let n=0;for(let i=0;i<t&&i<r.length;)r.charCodeAt(i)==9?(n+=e-n%e,i++):(n++,i=pn(r,i));return n}function cg(r,e,t,n){for(let i=0,s=0;;){if(s>=e)return i;if(i==r.length)break;s+=r.charCodeAt(i)==9?t-s%t:1,i=pn(r,i)}return n===!0?-1:r.length}const hg="",vw=typeof Symbol>"u"?"__"+hg:Symbol.for(hg),ug=typeof Symbol>"u"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),yw=typeof globalThis<"u"?globalThis:typeof window<"u"?window:{};class An{constructor(e,t){this.rules=[];let{finish:n}=t||{};function i(a){return/^@/.test(a)?[a]:a.split(/,\s*/)}function s(a,o,l,f){let c=[],h=/^@(\w+)\b/.exec(a[0]),u=h&&h[1]=="keyframes";if(h&&o==null)return l.push(a[0]+";");for(let d in o){let p=o[d];if(/&/.test(d))s(d.split(/,\s*/).map(m=>a.map(g=>m.replace(/&/,g))).reduce((m,g)=>m.concat(g)),p,l);else if(p&&typeof p=="object"){if(!h)throw new RangeError("The value of a property ("+d+") should be a primitive value.");s(i(d),p,c,u)}else p!=null&&c.push(d.replace(/_.*/,"").replace(/[A-Z]/g,m=>"-"+m.toLowerCase())+": "+p+";")}(c.length||u)&&l.push((n&&!h&&!f?a.map(n):a).join(", ")+" {"+c.join(" ")+"}")}for(let a in e)s(i(a),e[a],this.rules)}getRules(){return this.rules.join(`
`)}static newName(){let e=yw[vw]||1;return yw[vw]=e+1,hg+e.toString(36)}static mount(e,t,n){let i=e[ug],s=n&&n.nonce;i?s&&i.setNonce(s):i=new fV(e,s),i.mount(Array.isArray(t)?t:[t],e)}}let ww=new Map;class fV{constructor(e,t){let n=e.ownerDocument||e,i=n.defaultView;if(!e.head&&e.adoptedStyleSheets&&i.CSSStyleSheet){let s=ww.get(n);if(s)return e[ug]=s;this.sheet=new i.CSSStyleSheet,ww.set(n,this)}else this.styleTag=n.createElement("style"),t&&this.styleTag.setAttribute("nonce",t);this.modules=[],e[ug]=this}mount(e,t){let n=this.sheet,i=0,s=0;for(let a=0;a<e.length;a++){let o=e[a],l=this.modules.indexOf(o);if(l<s&&l>-1&&(this.modules.splice(l,1),s--,l=-1),l==-1){if(this.modules.splice(s++,0,o),n)for(let f=0;f<o.rules.length;f++)n.insertRule(o.rules[f],i++)}else{for(;s<l;)i+=this.modules[s++].rules.length;i+=o.rules.length,s++}}if(n)t.adoptedStyleSheets.indexOf(this.sheet)<0&&(t.adoptedStyleSheets=[this.sheet,...t.adoptedStyleSheets]);else{let a="";for(let l=0;l<this.modules.length;l++)a+=this.modules[l].getRules()+`
`;this.styleTag.textContent=a;let o=t.head||t;this.styleTag.parentNode!=o&&o.insertBefore(this.styleTag,o.firstChild)}}setNonce(e){this.styleTag&&this.styleTag.getAttribute("nonce")!=e&&this.styleTag.setAttribute("nonce",e)}}var Da={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Nc={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},cV=typeof navigator<"u"&&/Mac/.test(navigator.platform),hV=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var an=0;an<10;an++)Da[48+an]=Da[96+an]=String(an);for(var an=1;an<=24;an++)Da[an+111]="F"+an;for(var an=65;an<=90;an++)Da[an]=String.fromCharCode(an+32),Nc[an]=String.fromCharCode(an);for(var vp in Da)Nc.hasOwnProperty(vp)||(Nc[vp]=Da[vp]);function uV(r){var e=cV&&r.metaKey&&r.shiftKey&&!r.ctrlKey&&!r.altKey||hV&&r.shiftKey&&r.key&&r.key.length==1||r.key=="Unidentified",t=!e&&r.key||(r.shiftKey?Nc:Da)[r.keyCode]||r.key||"Unidentified";return t=="Esc"&&(t="Escape"),t=="Del"&&(t="Delete"),t=="Left"&&(t="ArrowLeft"),t=="Up"&&(t="ArrowUp"),t=="Right"&&(t="ArrowRight"),t=="Down"&&(t="ArrowDown"),t}function Mc(r){let e;return r.nodeType==11?e=r.getSelection?r:r.ownerDocument:e=r,e.getSelection()}function dg(r,e){return e?r==e||r.contains(e.nodeType!=1?e.parentNode:e):!1}function Du(r,e){if(!e.anchorNode)return!1;try{return dg(r,e.anchorNode)}catch{return!1}}function Ic(r){return r.nodeType==3?Fo(r,0,r.nodeValue.length).getClientRects():r.nodeType==1?r.getClientRects():[]}function cc(r,e,t,n){return t?bw(r,e,t,n,-1)||bw(r,e,t,n,1):!1}function Qo(r){for(var e=0;;e++)if(r=r.previousSibling,!r)return e}function Rd(r){return r.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(r.nodeName)}function bw(r,e,t,n,i){for(;;){if(r==t&&e==n)return!0;if(e==(i<0?0:Es(r))){if(r.nodeName=="DIV")return!1;let s=r.parentNode;if(!s||s.nodeType!=1)return!1;e=Qo(r)+(i<0?0:1),r=s}else if(r.nodeType==1){if(r=r.childNodes[e+(i<0?-1:0)],r.nodeType==1&&r.contentEditable=="false")return!1;e=i<0?Es(r):0}else return!1}}function Es(r){return r.nodeType==3?r.nodeValue.length:r.childNodes.length}function E0(r,e){let t=e?r.left:r.right;return{left:t,right:t,top:r.top,bottom:r.bottom}}function dV(r){let e=r.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:r.innerWidth,top:0,bottom:r.innerHeight}}function XC(r,e){let t=e.width/r.offsetWidth,n=e.height/r.offsetHeight;return(t>.995&&t<1.005||!isFinite(t)||Math.abs(e.width-r.offsetWidth)<1)&&(t=1),(n>.995&&n<1.005||!isFinite(n)||Math.abs(e.height-r.offsetHeight)<1)&&(n=1),{scaleX:t,scaleY:n}}function pV(r,e,t,n,i,s,a,o){let l=r.ownerDocument,f=l.defaultView||window;for(let c=r,h=!1;c&&!h;)if(c.nodeType==1){let u,d=c==l.body,p=1,m=1;if(d)u=dV(f);else{if(/^(fixed|sticky)$/.test(getComputedStyle(c).position)&&(h=!0),c.scrollHeight<=c.clientHeight&&c.scrollWidth<=c.clientWidth){c=c.assignedSlot||c.parentNode;continue}let w=c.getBoundingClientRect();({scaleX:p,scaleY:m}=XC(c,w)),u={left:w.left,right:w.left+c.clientWidth*p,top:w.top,bottom:w.top+c.clientHeight*m}}let g=0,O=0;if(i=="nearest")e.top<u.top?(O=-(u.top-e.top+a),t>0&&e.bottom>u.bottom+O&&(O=e.bottom-u.bottom+O+a)):e.bottom>u.bottom&&(O=e.bottom-u.bottom+a,t<0&&e.top-O<u.top&&(O=-(u.top+O-e.top+a)));else{let w=e.bottom-e.top,v=u.bottom-u.top;O=(i=="center"&&w<=v?e.top+w/2-v/2:i=="start"||i=="center"&&t<0?e.top-a:e.bottom-v+a)-u.top}if(n=="nearest"?e.left<u.left?(g=-(u.left-e.left+s),t>0&&e.right>u.right+g&&(g=e.right-u.right+g+s)):e.right>u.right&&(g=e.right-u.right+s,t<0&&e.left<u.left+g&&(g=-(u.left+g-e.left+s))):g=(n=="center"?e.left+(e.right-e.left)/2-(u.right-u.left)/2:n=="start"==o?e.left-s:e.right-(u.right-u.left)+s)-u.left,g||O)if(d)f.scrollBy(g,O);else{let w=0,v=0;if(O){let S=c.scrollTop;c.scrollTop+=O/m,v=(c.scrollTop-S)*m}if(g){let S=c.scrollLeft;c.scrollLeft+=g/p,w=(c.scrollLeft-S)*p}e={left:e.left-w,top:e.top-v,right:e.right-w,bottom:e.bottom-v},w&&Math.abs(w-g)<1&&(n="nearest"),v&&Math.abs(v-O)<1&&(i="nearest")}if(d)break;c=c.assignedSlot||c.parentNode}else if(c.nodeType==11)c=c.host;else break}function mV(r){let e=r.ownerDocument,t,n;for(let i=r.parentNode;i&&!(i==e.body||t&&n);)if(i.nodeType==1)!n&&i.scrollHeight>i.clientHeight&&(n=i),!t&&i.scrollWidth>i.clientWidth&&(t=i),i=i.assignedSlot||i.parentNode;else if(i.nodeType==11)i=i.host;else break;return{x:t,y:n}}class gV{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(e){return this.anchorNode==e.anchorNode&&this.anchorOffset==e.anchorOffset&&this.focusNode==e.focusNode&&this.focusOffset==e.focusOffset}setRange(e){let{anchorNode:t,focusNode:n}=e;this.set(t,Math.min(e.anchorOffset,t?Es(t):0),n,Math.min(e.focusOffset,n?Es(n):0))}set(e,t,n,i){this.anchorNode=e,this.anchorOffset=t,this.focusNode=n,this.focusOffset=i}}let Yo=null;function VC(r){if(r.setActive)return r.setActive();if(Yo)return r.focus(Yo);let e=[];for(let t=r;t&&(e.push(t,t.scrollTop,t.scrollLeft),t!=t.ownerDocument);t=t.parentNode);if(r.focus(Yo==null?{get preventScroll(){return Yo={preventScroll:!0},!0}}:void 0),!Yo){Yo=!1;for(let t=0;t<e.length;){let n=e[t++],i=e[t++],s=e[t++];n.scrollTop!=i&&(n.scrollTop=i),n.scrollLeft!=s&&(n.scrollLeft=s)}}}let _w;function Fo(r,e,t=e){let n=_w||(_w=document.createRange());return n.setEnd(r,t),n.setStart(r,e),n}function vl(r,e,t,n){let i={key:e,code:e,keyCode:t,which:t,cancelable:!0};n&&({altKey:i.altKey,ctrlKey:i.ctrlKey,shiftKey:i.shiftKey,metaKey:i.metaKey}=n);let s=new KeyboardEvent("keydown",i);s.synthetic=!0,r.dispatchEvent(s);let a=new KeyboardEvent("keyup",i);return a.synthetic=!0,r.dispatchEvent(a),s.defaultPrevented||a.defaultPrevented}function OV(r){for(;r;){if(r&&(r.nodeType==9||r.nodeType==11&&r.host))return r;r=r.assignedSlot||r.parentNode}return null}function qC(r){for(;r.attributes.length;)r.removeAttributeNode(r.attributes[0])}function xV(r,e){let t=e.focusNode,n=e.focusOffset;if(!t||e.anchorNode!=t||e.anchorOffset!=n)return!1;for(n=Math.min(n,Es(t));;)if(n){if(t.nodeType!=1)return!1;let i=t.childNodes[n-1];i.contentEditable=="false"?n--:(t=i,n=Es(t))}else{if(t==r)return!0;n=Qo(t),t=t.parentNode}}function jC(r){return r.scrollTop>Math.max(1,r.scrollHeight-r.clientHeight-4)}function zC(r,e){for(let t=r,n=e;;){if(t.nodeType==3&&n>0)return{node:t,offset:n};if(t.nodeType==1&&n>0){if(t.contentEditable=="false")return null;t=t.childNodes[n-1],n=Es(t)}else if(t.parentNode&&!Rd(t))n=Qo(t),t=t.parentNode;else return null}}function GC(r,e){for(let t=r,n=e;;){if(t.nodeType==3&&n<t.nodeValue.length)return{node:t,offset:n};if(t.nodeType==1&&n<t.childNodes.length){if(t.contentEditable=="false")return null;t=t.childNodes[n],n=0}else if(t.parentNode&&!Rd(t))n=Qo(t)+1,t=t.parentNode;else return null}}class _n{constructor(e,t,n=!0){this.node=e,this.offset=t,this.precise=n}static before(e,t){return new _n(e.parentNode,Qo(e),t)}static after(e,t){return new _n(e.parentNode,Qo(e)+1,t)}}const sx=[];class qt{constructor(){this.parent=null,this.dom=null,this.flags=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(e){let t=this.posAtStart;for(let n of this.children){if(n==e)return t;t+=n.length+n.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(e){return this.posBefore(e)+e.length}sync(e,t){if(this.flags&2){let n=this.dom,i=null,s;for(let a of this.children){if(a.flags&7){if(!a.dom&&(s=i?i.nextSibling:n.firstChild)){let o=qt.get(s);(!o||!o.parent&&o.canReuseDOM(a))&&a.reuseDOM(s)}a.sync(e,t),a.flags&=-8}if(s=i?i.nextSibling:n.firstChild,t&&!t.written&&t.node==n&&s!=a.dom&&(t.written=!0),a.dom.parentNode==n)for(;s&&s!=a.dom;)s=kw(s);else n.insertBefore(a.dom,s);i=a.dom}for(s=i?i.nextSibling:n.firstChild,s&&t&&t.node==n&&(t.written=!0);s;)s=kw(s)}else if(this.flags&1)for(let n of this.children)n.flags&7&&(n.sync(e,t),n.flags&=-8)}reuseDOM(e){}localPosFromDOM(e,t){let n;if(e==this.dom)n=this.dom.childNodes[t];else{let i=Es(e)==0?0:t==0?-1:1;for(;;){let s=e.parentNode;if(s==this.dom)break;i==0&&s.firstChild!=s.lastChild&&(e==s.firstChild?i=-1:i=1),e=s}i<0?n=e:n=e.nextSibling}if(n==this.dom.firstChild)return 0;for(;n&&!qt.get(n);)n=n.nextSibling;if(!n)return this.length;for(let i=0,s=0;;i++){let a=this.children[i];if(a.dom==n)return s;s+=a.length+a.breakAfter}}domBoundsAround(e,t,n=0){let i=-1,s=-1,a=-1,o=-1;for(let l=0,f=n,c=n;l<this.children.length;l++){let h=this.children[l],u=f+h.length;if(f<e&&u>t)return h.domBoundsAround(e,t,f);if(u>=e&&i==-1&&(i=l,s=f),f>t&&h.dom.parentNode==this.dom){a=l,o=c;break}c=u,f=u+h.breakAfter}return{from:s,to:o<0?n+this.length:o,startDOM:(i?this.children[i-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:a<this.children.length&&a>=0?this.children[a].dom:null}}markDirty(e=!1){this.flags|=2,this.markParentsDirty(e)}markParentsDirty(e){for(let t=this.parent;t;t=t.parent){if(e&&(t.flags|=2),t.flags&1)return;t.flags|=1,e=!1}}setParent(e){this.parent!=e&&(this.parent=e,this.flags&7&&this.markParentsDirty(!0))}setDOM(e){this.dom!=e&&(this.dom&&(this.dom.cmView=null),this.dom=e,e.cmView=this)}get rootView(){for(let e=this;;){let t=e.parent;if(!t)return e;e=t}}replaceChildren(e,t,n=sx){this.markDirty();for(let i=e;i<t;i++){let s=this.children[i];s.parent==this&&n.indexOf(s)<0&&s.destroy()}n.length<250?this.children.splice(e,t-e,...n):this.children=[].concat(this.children.slice(0,e),n,this.children.slice(t));for(let i=0;i<n.length;i++)n[i].setParent(this)}ignoreMutation(e){return!1}ignoreEvent(e){return!1}childCursor(e=this.length){return new HC(this.children,e,this.children.length)}childPos(e,t=1){return this.childCursor().findPos(e,t)}toString(){let e=this.constructor.name.replace("View","");return e+(this.children.length?"("+this.children.join()+")":this.length?"["+(e=="Text"?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(e){return e.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(e,t,n,i,s,a){return!1}become(e){return!1}canReuseDOM(e){return e.constructor==this.constructor&&!((this.flags|e.flags)&8)}getSide(){return 0}destroy(){for(let e of this.children)e.parent==this&&e.destroy();this.parent=null}}qt.prototype.breakAfter=0;function kw(r){let e=r.nextSibling;return r.parentNode.removeChild(r),e}class HC{constructor(e,t,n){this.children=e,this.pos=t,this.i=n,this.off=0}findPos(e,t=1){for(;;){if(e>this.pos||e==this.pos&&(t>0||this.i==0||this.children[this.i-1].breakAfter))return this.off=e-this.pos,this;let n=this.children[--this.i];this.pos-=n.length+n.breakAfter}}}function YC(r,e,t,n,i,s,a,o,l){let{children:f}=r,c=f.length?f[e]:null,h=s.length?s[s.length-1]:null,u=h?h.breakAfter:a;if(!(e==n&&c&&!a&&!u&&s.length<2&&c.merge(t,i,s.length?h:null,t==0,o,l))){if(n<f.length){let d=f[n];d&&(i<d.length||d.breakAfter&&(h!=null&&h.breakAfter))?(e==n&&(d=d.split(i),i=0),!u&&h&&d.merge(0,i,h,!0,0,l)?s[s.length-1]=d:((i||d.children.length&&!d.children[0].length)&&d.merge(0,i,null,!1,0,l),s.push(d))):d!=null&&d.breakAfter&&(h?h.breakAfter=1:a=1),n++}for(c&&(c.breakAfter=a,t>0&&(!a&&s.length&&c.merge(t,c.length,s[0],!1,o,0)?c.breakAfter=s.shift().breakAfter:(t<c.length||c.children.length&&c.children[c.children.length-1].length==0)&&c.merge(t,c.length,null,!1,o,0),e++));e<n&&s.length;)if(f[n-1].become(s[s.length-1]))n--,s.pop(),l=s.length?0:o;else if(f[e].become(s[0]))e++,s.shift(),o=s.length?0:l;else break;!s.length&&e&&n<f.length&&!f[e-1].breakAfter&&f[n].merge(0,0,f[e-1],!1,o,l)&&e--,(e<n||s.length)&&r.replaceChildren(e,n,s)}}function KC(r,e,t,n,i,s){let a=r.childCursor(),{i:o,off:l}=a.findPos(t,1),{i:f,off:c}=a.findPos(e,-1),h=e-t;for(let u of n)h+=u.length;r.length+=h,YC(r,f,c,o,l,n,0,i,s)}let jn=typeof navigator<"u"?navigator:{userAgent:"",vendor:"",platform:""},pg=typeof document<"u"?document:{documentElement:{style:{}}};const mg=/Edge\/(\d+)/.exec(jn.userAgent),JC=/MSIE \d/.test(jn.userAgent),gg=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(jn.userAgent),P0=!!(JC||gg||mg),Sw=!P0&&/gecko\/(\d+)/i.test(jn.userAgent),yp=!P0&&/Chrome\/(\d+)/.exec(jn.userAgent),Tw="webkitFontSmoothing"in pg.documentElement.style,eA=!P0&&/Apple Computer/.test(jn.vendor),Cw=eA&&(/Mobile\/\w+/.test(jn.userAgent)||jn.maxTouchPoints>2);var qe={mac:Cw||/Mac/.test(jn.platform),windows:/Win/.test(jn.platform),linux:/Linux|X11/.test(jn.platform),ie:P0,ie_version:JC?pg.documentMode||6:gg?+gg[1]:mg?+mg[1]:0,gecko:Sw,gecko_version:Sw?+(/Firefox\/(\d+)/.exec(jn.userAgent)||[0,0])[1]:0,chrome:!!yp,chrome_version:yp?+yp[1]:0,ios:Cw,android:/Android\b/.test(jn.userAgent),webkit:Tw,safari:eA,webkit_version:Tw?+(/\bAppleWebKit\/(\d+)/.exec(jn.userAgent)||[0,0])[1]:0,tabSize:pg.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};const vV=256;class rs extends qt{constructor(e){super(),this.text=e}get length(){return this.text.length}createDOM(e){this.setDOM(e||document.createTextNode(this.text))}sync(e,t){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(t&&t.node==this.dom&&(t.written=!0),this.dom.nodeValue=this.text)}reuseDOM(e){e.nodeType==3&&this.createDOM(e)}merge(e,t,n){return this.flags&8||n&&(!(n instanceof rs)||this.length-(t-e)+n.length>vV||n.flags&8)?!1:(this.text=this.text.slice(0,e)+(n?n.text:"")+this.text.slice(t),this.markDirty(),!0)}split(e){let t=new rs(this.text.slice(e));return this.text=this.text.slice(0,e),this.markDirty(),t.flags|=this.flags&8,t}localPosFromDOM(e,t){return e==this.dom?t:t?this.text.length:0}domAtPos(e){return new _n(this.dom,e)}domBoundsAround(e,t,n){return{from:n,to:n+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(e,t){return yV(this.dom,e,t)}}class ea extends qt{constructor(e,t=[],n=0){super(),this.mark=e,this.children=t,this.length=n;for(let i of t)i.setParent(this)}setAttrs(e){if(qC(e),this.mark.class&&(e.className=this.mark.class),this.mark.attrs)for(let t in this.mark.attrs)e.setAttribute(t,this.mark.attrs[t]);return e}canReuseDOM(e){return super.canReuseDOM(e)&&!((this.flags|e.flags)&8)}reuseDOM(e){e.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(e),this.flags|=6)}sync(e,t){this.dom?this.flags&4&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(e,t)}merge(e,t,n,i,s,a){return n&&(!(n instanceof ea&&n.mark.eq(this.mark))||e&&s<=0||t<this.length&&a<=0)?!1:(KC(this,e,t,n?n.children.slice():[],s-1,a-1),this.markDirty(),!0)}split(e){let t=[],n=0,i=-1,s=0;for(let o of this.children){let l=n+o.length;l>e&&t.push(n<e?o.split(e-n):o),i<0&&n>=e&&(i=s),n=l,s++}let a=this.length-e;return this.length=e,i>-1&&(this.children.length=i,this.markDirty()),new ea(this.mark,t,a)}domAtPos(e){return tA(this,e)}coordsAt(e,t){return nA(this,e,t)}}function yV(r,e,t){let n=r.nodeValue.length;e>n&&(e=n);let i=e,s=e,a=0;e==0&&t<0||e==n&&t>=0?qe.chrome||qe.gecko||(e?(i--,a=1):s<n&&(s++,a=-1)):t<0?i--:s<n&&s++;let o=Fo(r,i,s).getClientRects();if(!o.length)return null;let l=o[(a?a<0:t>=0)?0:o.length-1];return qe.safari&&!a&&l.width==0&&(l=Array.prototype.find.call(o,f=>f.width)||l),a?E0(l,a<0):l||null}class Ta extends qt{static create(e,t,n){return new Ta(e,t,n)}constructor(e,t,n){super(),this.widget=e,this.length=t,this.side=n,this.prevWidget=null}split(e){let t=Ta.create(this.widget,this.length-e,this.side);return this.length-=e,t}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.widget.editable||(this.dom.contentEditable="false"))}getSide(){return this.side}merge(e,t,n,i,s,a){return n&&(!(n instanceof Ta)||!this.widget.compare(n.widget)||e>0&&s<=0||t<this.length&&a<=0)?!1:(this.length=e+(n?n.length:0)+(this.length-t),!0)}become(e){return e instanceof Ta&&e.side==this.side&&this.widget.constructor==e.widget.constructor?(this.widget.compare(e.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get overrideDOMText(){if(this.length==0)return Ft.empty;let e=this;for(;e.parent;)e=e.parent;let{view:t}=e,n=t&&t.state.doc,i=this.posAtStart;return n?n.slice(i,i+this.length):Ft.empty}domAtPos(e){return(this.length?e==0:this.side>0)?_n.before(this.dom):_n.after(this.dom,e==this.length)}domBoundsAround(){return null}coordsAt(e,t){let n=this.widget.coordsAt(this.dom,e,t);if(n)return n;let i=this.dom.getClientRects(),s=null;if(!i.length)return null;let a=this.side?this.side<0:e>0;for(let o=a?i.length-1:0;s=i[o],!(e>0?o==0:o==i.length-1||s.top<s.bottom);o+=a?-1:1);return E0(s,!a)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class $l extends qt{constructor(e){super(),this.side=e}get length(){return 0}merge(){return!1}become(e){return e instanceof $l&&e.side==this.side}split(){return new $l(this.side)}sync(){if(!this.dom){let e=document.createElement("img");e.className="cm-widgetBuffer",e.setAttribute("aria-hidden","true"),this.setDOM(e)}}getSide(){return this.side}domAtPos(e){return this.side>0?_n.before(this.dom):_n.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(e){return this.dom.getBoundingClientRect()}get overrideDOMText(){return Ft.empty}get isHidden(){return!0}}rs.prototype.children=Ta.prototype.children=$l.prototype.children=sx;function tA(r,e){let t=r.dom,{children:n}=r,i=0;for(let s=0;i<n.length;i++){let a=n[i],o=s+a.length;if(!(o==s&&a.getSide()<=0)){if(e>s&&e<o&&a.dom.parentNode==t)return a.domAtPos(e-s);if(e<=s)break;s=o}}for(let s=i;s>0;s--){let a=n[s-1];if(a.dom.parentNode==t)return a.domAtPos(a.length)}for(let s=i;s<n.length;s++){let a=n[s];if(a.dom.parentNode==t)return a.domAtPos(0)}return new _n(t,0)}function rA(r,e,t){let n,{children:i}=r;t>0&&e instanceof ea&&i.length&&(n=i[i.length-1])instanceof ea&&n.mark.eq(e.mark)?rA(n,e.children[0],t-1):(i.push(e),e.setParent(r)),r.length+=e.length}function nA(r,e,t){let n=null,i=-1,s=null,a=-1;function o(f,c){for(let h=0,u=0;h<f.children.length&&u<=c;h++){let d=f.children[h],p=u+d.length;p>=c&&(d.children.length?o(d,c-u):(!s||s.isHidden&&t>0)&&(p>c||u==p&&d.getSide()>0)?(s=d,a=c-u):(u<c||u==p&&d.getSide()<0&&!d.isHidden)&&(n=d,i=c-u)),u=p}}o(r,e);let l=(t<0?n:s)||n||s;return l?l.coordsAt(Math.max(0,l==n?i:a),t):wV(r)}function wV(r){let e=r.dom.lastChild;if(!e)return r.dom.getBoundingClientRect();let t=Ic(e);return t[t.length-1]||null}function Og(r,e){for(let t in r)t=="class"&&e.class?e.class+=" "+r.class:t=="style"&&e.style?e.style+=";"+r.style:e[t]=r[t];return e}const Aw=Object.create(null);function Qd(r,e,t){if(r==e)return!0;r||(r=Aw),e||(e=Aw);let n=Object.keys(r),i=Object.keys(e);if(n.length-(t&&n.indexOf(t)>-1?1:0)!=i.length-(t&&i.indexOf(t)>-1?1:0))return!1;for(let s of n)if(s!=t&&(i.indexOf(s)==-1||r[s]!==e[s]))return!1;return!0}function xg(r,e,t){let n=!1;if(e)for(let i in e)t&&i in t||(n=!0,i=="style"?r.style.cssText="":r.removeAttribute(i));if(t)for(let i in t)e&&e[i]==t[i]||(n=!0,i=="style"?r.style.cssText=t[i]:r.setAttribute(i,t[i]));return n}function bV(r){let e=Object.create(null);for(let t=0;t<r.attributes.length;t++){let n=r.attributes[t];e[n.name]=n.value}return e}class aa{eq(e){return!1}updateDOM(e,t){return!1}compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(e){return!0}coordsAt(e,t,n){return null}get isHidden(){return!1}get editable(){return!1}destroy(e){}}var Mn=function(r){return r[r.Text=0]="Text",r[r.WidgetBefore=1]="WidgetBefore",r[r.WidgetAfter=2]="WidgetAfter",r[r.WidgetRange=3]="WidgetRange",r}(Mn||(Mn={}));class je extends Ks{constructor(e,t,n,i){super(),this.startSide=e,this.endSide=t,this.widget=n,this.spec=i}get heightRelevant(){return!1}static mark(e){return new bh(e)}static widget(e){let t=Math.max(-1e4,Math.min(1e4,e.side||0)),n=!!e.block;return t+=n&&!e.inlineOrder?t>0?3e8:-4e8:t>0?1e8:-1e8,new Na(e,t,t,n,e.widget||null,!1)}static replace(e){let t=!!e.block,n,i;if(e.isBlockGap)n=-5e8,i=4e8;else{let{start:s,end:a}=iA(e,t);n=(s?t?-3e8:-1:5e8)-1,i=(a?t?2e8:1:-6e8)+1}return new Na(e,n,i,t,e.widget||null,!0)}static line(e){return new _h(e)}static set(e,t=!1){return Ct.of(e,t)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}}je.none=Ct.empty;class bh extends je{constructor(e){let{start:t,end:n}=iA(e);super(t?-1:5e8,n?1:-6e8,null,e),this.tagName=e.tagName||"span",this.class=e.class||"",this.attrs=e.attributes||null}eq(e){var t,n;return this==e||e instanceof bh&&this.tagName==e.tagName&&(this.class||((t=this.attrs)===null||t===void 0?void 0:t.class))==(e.class||((n=e.attrs)===null||n===void 0?void 0:n.class))&&Qd(this.attrs,e.attrs,"class")}range(e,t=e){if(e>=t)throw new RangeError("Mark decorations may not be empty");return super.range(e,t)}}bh.prototype.point=!1;class _h extends je{constructor(e){super(-2e8,-2e8,null,e)}eq(e){return e instanceof _h&&this.spec.class==e.spec.class&&Qd(this.spec.attributes,e.spec.attributes)}range(e,t=e){if(t!=e)throw new RangeError("Line decoration ranges must be zero-length");return super.range(e,t)}}_h.prototype.mapMode=dn.TrackBefore;_h.prototype.point=!0;class Na extends je{constructor(e,t,n,i,s,a){super(t,n,s,e),this.block=i,this.isReplace=a,this.mapMode=i?t<=0?dn.TrackBefore:dn.TrackAfter:dn.TrackDel}get type(){return this.startSide!=this.endSide?Mn.WidgetRange:this.startSide<=0?Mn.WidgetBefore:Mn.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(e){return e instanceof Na&&_V(this.widget,e.widget)&&this.block==e.block&&this.startSide==e.startSide&&this.endSide==e.endSide}range(e,t=e){if(this.isReplace&&(e>t||e==t&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&t!=e)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(e,t)}}Na.prototype.point=!0;function iA(r,e=!1){let{inclusiveStart:t,inclusiveEnd:n}=r;return t==null&&(t=r.inclusive),n==null&&(n=r.inclusive),{start:t??e,end:n??e}}function _V(r,e){return r==e||!!(r&&e&&r.compare(e))}function Nu(r,e,t,n=0){let i=t.length-1;i>=0&&t[i]+n>=r?t[i]=Math.max(t[i],e):t.push(r,e)}class Ir extends qt{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(e,t,n,i,s,a){if(n){if(!(n instanceof Ir))return!1;this.dom||n.transferDOM(this)}return i&&this.setDeco(n?n.attrs:null),KC(this,e,t,n?n.children.slice():[],s,a),!0}split(e){let t=new Ir;if(t.breakAfter=this.breakAfter,this.length==0)return t;let{i:n,off:i}=this.childPos(e);i&&(t.append(this.children[n].split(i),0),this.children[n].merge(i,this.children[n].length,null,!1,0,0),n++);for(let s=n;s<this.children.length;s++)t.append(this.children[s],0);for(;n>0&&this.children[n-1].length==0;)this.children[--n].destroy();return this.children.length=n,this.markDirty(),this.length=e,t}transferDOM(e){this.dom&&(this.markDirty(),e.setDOM(this.dom),e.prevAttrs=this.prevAttrs===void 0?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(e){Qd(this.attrs,e)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=e)}append(e,t){rA(this,e,t)}addLineDeco(e){let t=e.spec.attributes,n=e.spec.class;t&&(this.attrs=Og(t,this.attrs||{})),n&&(this.attrs=Og({class:n},this.attrs||{}))}domAtPos(e){return tA(this,e)}reuseDOM(e){e.nodeName=="DIV"&&(this.setDOM(e),this.flags|=6)}sync(e,t){var n;this.dom?this.flags&4&&(qC(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),this.prevAttrs!==void 0&&(xg(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(e,t);let i=this.dom.lastChild;for(;i&&qt.get(i)instanceof ea;)i=i.lastChild;if(!i||!this.length||i.nodeName!="BR"&&((n=qt.get(i))===null||n===void 0?void 0:n.isEditable)==!1&&(!qe.ios||!this.children.some(s=>s instanceof rs))){let s=document.createElement("BR");s.cmIgnore=!0,this.dom.appendChild(s)}}measureTextSize(){if(this.children.length==0||this.length>20)return null;let e=0,t;for(let n of this.children){if(!(n instanceof rs)||/[^ -~]/.test(n.text))return null;let i=Ic(n.dom);if(i.length!=1)return null;e+=i[0].width,t=i[0].height}return e?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:e/this.length,textHeight:t}:null}coordsAt(e,t){let n=nA(this,e,t);if(!this.children.length&&n&&this.parent){let{heightOracle:i}=this.parent.view.viewState,s=n.bottom-n.top;if(Math.abs(s-i.lineHeight)<2&&i.textHeight<s){let a=(s-i.textHeight)/2;return{top:n.top+a,bottom:n.bottom-a,left:n.left,right:n.left}}}return n}become(e){return e instanceof Ir&&this.children.length==0&&e.children.length==0&&Qd(this.attrs,e.attrs)&&this.breakAfter==e.breakAfter}covers(){return!0}static find(e,t){for(let n=0,i=0;n<e.children.length;n++){let s=e.children[n],a=i+s.length;if(a>=t){if(s instanceof Ir)return s;if(a>t)break}i=a+s.breakAfter}return null}}class Gs extends qt{constructor(e,t,n){super(),this.widget=e,this.length=t,this.deco=n,this.breakAfter=0,this.prevWidget=null}merge(e,t,n,i,s,a){return n&&(!(n instanceof Gs)||!this.widget.compare(n.widget)||e>0&&s<=0||t<this.length&&a<=0)?!1:(this.length=e+(n?n.length:0)+(this.length-t),!0)}domAtPos(e){return e==0?_n.before(this.dom):_n.after(this.dom,e==this.length)}split(e){let t=this.length-e;this.length=e;let n=new Gs(this.widget,t,this.deco);return n.breakAfter=this.breakAfter,n}get children(){return sx}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.widget.editable||(this.dom.contentEditable="false"))}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):Ft.empty}domBoundsAround(){return null}become(e){return e instanceof Gs&&e.widget.constructor==this.widget.constructor?(e.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,this.deco=e.deco,this.breakAfter=e.breakAfter,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get isEditable(){return!1}get isWidget(){return!0}coordsAt(e,t){let n=this.widget.coordsAt(this.dom,e,t);return n||(this.widget instanceof vg?null:E0(this.dom.getBoundingClientRect(),this.length?e==0:t<=0))}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}covers(e){let{startSide:t,endSide:n}=this.deco;return t==n?!1:e<0?t<0:n>0}}class vg extends aa{constructor(e){super(),this.height=e}toDOM(){let e=document.createElement("div");return e.className="cm-gap",this.updateDOM(e),e}eq(e){return e.height==this.height}updateDOM(e){return e.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}}class hc{constructor(e,t,n,i){this.doc=e,this.pos=t,this.end=n,this.disallowBlockEffectsFor=i,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=e.iter(),this.skip=t}posCovered(){if(this.content.length==0)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let e=this.content[this.content.length-1];return!(e.breakAfter||e instanceof Gs&&e.deco.endSide<0)}getLine(){return this.curLine||(this.content.push(this.curLine=new Ir),this.atCursorPos=!0),this.curLine}flushBuffer(e=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(Yh(new $l(-1),e),e.length),this.pendingBuffer=0)}addBlockWidget(e){this.flushBuffer(),this.curLine=null,this.content.push(e)}finish(e){this.pendingBuffer&&e<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,!this.posCovered()&&!(e&&this.content.length&&this.content[this.content.length-1]instanceof Gs)&&this.getLine()}buildText(e,t,n){for(;e>0;){if(this.textOff==this.text.length){let{value:s,lineBreak:a,done:o}=this.cursor.next(this.skip);if(this.skip=0,o)throw new Error("Ran out of text content when drawing inline views");if(a){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,e--;continue}else this.text=s,this.textOff=0}let i=Math.min(this.text.length-this.textOff,e,512);this.flushBuffer(t.slice(t.length-n)),this.getLine().append(Yh(new rs(this.text.slice(this.textOff,this.textOff+i)),t),n),this.atCursorPos=!0,this.textOff+=i,e-=i,n=0}}span(e,t,n,i){this.buildText(t-e,n,i),this.pos=t,this.openStart<0&&(this.openStart=i)}point(e,t,n,i,s,a){if(this.disallowBlockEffectsFor[a]&&n instanceof Na){if(n.block)throw new RangeError("Block decorations may not be specified via plugins");if(t>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let o=t-e;if(n instanceof Na)if(n.block)n.startSide>0&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new Gs(n.widget||Dl.block,o,n));else{let l=Ta.create(n.widget||Dl.inline,o,o?0:n.startSide),f=this.atCursorPos&&!l.isEditable&&s<=i.length&&(e<t||n.startSide>0),c=!l.isEditable&&(e<t||s>i.length||n.startSide<=0),h=this.getLine();this.pendingBuffer==2&&!f&&!l.isEditable&&(this.pendingBuffer=0),this.flushBuffer(i),f&&(h.append(Yh(new $l(1),i),s),s=i.length+Math.max(0,s-i.length)),h.append(Yh(l,i),s),this.atCursorPos=c,this.pendingBuffer=c?e<t||s>i.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=i.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(n);o&&(this.textOff+o<=this.text.length?this.textOff+=o:(this.skip+=o-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=t),this.openStart<0&&(this.openStart=s)}static build(e,t,n,i,s){let a=new hc(e,t,n,s);return a.openEnd=Ct.spans(i,t,n,a),a.openStart<0&&(a.openStart=a.openEnd),a.finish(a.openEnd),a}}function Yh(r,e){for(let t of e)r=new ea(t,[r],r.length);return r}class Dl extends aa{constructor(e){super(),this.tag=e}eq(e){return e.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(e){return e.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}Dl.inline=new Dl("span");Dl.block=new Dl("div");var Et=function(r){return r[r.LTR=0]="LTR",r[r.RTL=1]="RTL",r}(Et||(Et={}));const $o=Et.LTR,ax=Et.RTL;function sA(r){let e=[];for(let t=0;t<r.length;t++)e.push(1<<+r[t]);return e}const kV=sA("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),SV=sA("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),yg=Object.create(null),cs=[];for(let r of["()","[]","{}"]){let e=r.charCodeAt(0),t=r.charCodeAt(1);yg[e]=t,yg[t]=-e}function aA(r){return r<=247?kV[r]:1424<=r&&r<=1524?2:1536<=r&&r<=1785?SV[r-1536]:1774<=r&&r<=2220?4:8192<=r&&r<=8204?256:64336<=r&&r<=65023?4:1}const TV=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class Ca{get dir(){return this.level%2?ax:$o}constructor(e,t,n){this.from=e,this.to=t,this.level=n}side(e,t){return this.dir==t==e?this.to:this.from}forward(e,t){return e==(this.dir==t)}static find(e,t,n,i){let s=-1;for(let a=0;a<e.length;a++){let o=e[a];if(o.from<=t&&o.to>=t){if(o.level==n)return a;(s<0||(i!=0?i<0?o.from<t:o.to>t:e[s].level>o.level))&&(s=a)}}if(s<0)throw new RangeError("Index out of range");return s}}function oA(r,e){if(r.length!=e.length)return!1;for(let t=0;t<r.length;t++){let n=r[t],i=e[t];if(n.from!=i.from||n.to!=i.to||n.direction!=i.direction||!oA(n.inner,i.inner))return!1}return!0}const Vt=[];function CV(r,e,t,n,i){for(let s=0;s<=n.length;s++){let a=s?n[s-1].to:e,o=s<n.length?n[s].from:t,l=s?256:i;for(let f=a,c=l,h=l;f<o;f++){let u=aA(r.charCodeAt(f));u==512?u=c:u==8&&h==4&&(u=16),Vt[f]=u==4?2:u,u&7&&(h=u),c=u}for(let f=a,c=l,h=l;f<o;f++){let u=Vt[f];if(u==128)f<o-1&&c==Vt[f+1]&&c&24?u=Vt[f]=c:Vt[f]=256;else if(u==64){let d=f+1;for(;d<o&&Vt[d]==64;)d++;let p=f&&c==8||d<t&&Vt[d]==8?h==1?1:8:256;for(let m=f;m<d;m++)Vt[m]=p;f=d-1}else u==8&&h==1&&(Vt[f]=1);c=u,u&7&&(h=u)}}}function AV(r,e,t,n,i){let s=i==1?2:1;for(let a=0,o=0,l=0;a<=n.length;a++){let f=a?n[a-1].to:e,c=a<n.length?n[a].from:t;for(let h=f,u,d,p;h<c;h++)if(d=yg[u=r.charCodeAt(h)])if(d<0){for(let m=o-3;m>=0;m-=3)if(cs[m+1]==-d){let g=cs[m+2],O=g&2?i:g&4?g&1?s:i:0;O&&(Vt[h]=Vt[cs[m]]=O),o=m;break}}else{if(cs.length==189)break;cs[o++]=h,cs[o++]=u,cs[o++]=l}else if((p=Vt[h])==2||p==1){let m=p==i;l=m?0:1;for(let g=o-3;g>=0;g-=3){let O=cs[g+2];if(O&2)break;if(m)cs[g+2]|=2;else{if(O&4)break;cs[g+2]|=4}}}}}function EV(r,e,t,n){for(let i=0,s=n;i<=t.length;i++){let a=i?t[i-1].to:r,o=i<t.length?t[i].from:e;for(let l=a;l<o;){let f=Vt[l];if(f==256){let c=l+1;for(;;)if(c==o){if(i==t.length)break;c=t[i++].to,o=i<t.length?t[i].from:e}else if(Vt[c]==256)c++;else break;let h=s==1,u=(c<e?Vt[c]:n)==1,d=h==u?h?1:2:n;for(let p=c,m=i,g=m?t[m-1].to:r;p>l;)p==g&&(p=t[--m].from,g=m?t[m-1].to:r),Vt[--p]=d;l=c}else s=f,l++}}}function wg(r,e,t,n,i,s,a){let o=n%2?2:1;if(n%2==i%2)for(let l=e,f=0;l<t;){let c=!0,h=!1;if(f==s.length||l<s[f].from){let m=Vt[l];m!=o&&(c=!1,h=m==16)}let u=!c&&o==1?[]:null,d=c?n:n+1,p=l;e:for(;;)if(f<s.length&&p==s[f].from){if(h)break e;let m=s[f];if(!c)for(let g=m.to,O=f+1;;){if(g==t)break e;if(O<s.length&&s[O].from==g)g=s[O++].to;else{if(Vt[g]==o)break e;break}}if(f++,u)u.push(m);else{m.from>l&&a.push(new Ca(l,m.from,d));let g=m.direction==$o!=!(d%2);bg(r,g?n+1:n,i,m.inner,m.from,m.to,a),l=m.to}p=m.to}else{if(p==t||(c?Vt[p]!=o:Vt[p]==o))break;p++}u?wg(r,l,p,n+1,i,u,a):l<p&&a.push(new Ca(l,p,d)),l=p}else for(let l=t,f=s.length;l>e;){let c=!0,h=!1;if(!f||l>s[f-1].to){let m=Vt[l-1];m!=o&&(c=!1,h=m==16)}let u=!c&&o==1?[]:null,d=c?n:n+1,p=l;e:for(;;)if(f&&p==s[f-1].to){if(h)break e;let m=s[--f];if(!c)for(let g=m.from,O=f;;){if(g==e)break e;if(O&&s[O-1].to==g)g=s[--O].from;else{if(Vt[g-1]==o)break e;break}}if(u)u.push(m);else{m.to<l&&a.push(new Ca(m.to,l,d));let g=m.direction==$o!=!(d%2);bg(r,g?n+1:n,i,m.inner,m.from,m.to,a),l=m.from}p=m.from}else{if(p==e||(c?Vt[p-1]!=o:Vt[p-1]==o))break;p--}u?wg(r,p,l,n+1,i,u,a):p<l&&a.push(new Ca(p,l,d)),l=p}}function bg(r,e,t,n,i,s,a){let o=e%2?2:1;CV(r,i,s,n,o),AV(r,i,s,n,o),EV(i,s,n,o),wg(r,i,s,e,t,n,a)}function PV(r,e,t){if(!r)return[new Ca(0,0,e==ax?1:0)];if(e==$o&&!t.length&&!TV.test(r))return lA(r.length);if(t.length)for(;r.length>Vt.length;)Vt[Vt.length]=256;let n=[],i=e==$o?0:1;return bg(r,i,i,t,0,r.length,n),n}function lA(r){return[new Ca(0,r,0)]}let fA="";function RV(r,e,t,n,i){var s;let a=n.head-r.from,o=Ca.find(e,a,(s=n.bidiLevel)!==null&&s!==void 0?s:-1,n.assoc),l=e[o],f=l.side(i,t);if(a==f){let u=o+=i?1:-1;if(u<0||u>=e.length)return null;l=e[o=u],a=l.side(!i,t),f=l.side(i,t)}let c=pn(r.text,a,l.forward(i,t));(c<l.from||c>l.to)&&(c=f),fA=r.text.slice(Math.min(a,c),Math.max(a,c));let h=o==(i?e.length-1:0)?null:e[o+(i?1:-1)];return h&&c==f&&h.level+(i?0:1)<l.level?Oe.cursor(h.side(!i,t)+r.from,h.forward(i,t)?1:-1,h.level):Oe.cursor(c+r.from,l.forward(i,t)?-1:1,l.level)}function QV(r,e,t){for(let n=e;n<t;n++){let i=aA(r.charCodeAt(n));if(i==1)return $o;if(i==2||i==4)return ax}return $o}const cA=Ze.define(),hA=Ze.define(),uA=Ze.define(),dA=Ze.define(),_g=Ze.define(),pA=Ze.define(),mA=Ze.define(),ox=Ze.define(),lx=Ze.define(),gA=Ze.define({combine:r=>r.some(e=>e)}),OA=Ze.define({combine:r=>r.some(e=>e)}),xA=Ze.define();class yl{constructor(e,t="nearest",n="nearest",i=5,s=5,a=!1){this.range=e,this.y=t,this.x=n,this.yMargin=i,this.xMargin=s,this.isSnapshot=a}map(e){return e.empty?this:new yl(this.range.map(e),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(e){return this.range.to<=e.doc.length?this:new yl(Oe.cursor(e.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}}const Kh=rt.define({map:(r,e)=>r.map(e)}),vA=rt.define();function tn(r,e,t){let n=r.facet(dA);n.length?n[0](e):window.onerror?window.onerror(String(e),t,void 0,void 0,e):t?console.error(t+":",e):console.error(e)}const Xs=Ze.define({combine:r=>r.length?r[0]:!0});let FV=0;const Mf=Ze.define();class pr{constructor(e,t,n,i,s){this.id=e,this.create=t,this.domEventHandlers=n,this.domEventObservers=i,this.extension=s(this)}static define(e,t){const{eventHandlers:n,eventObservers:i,provide:s,decorations:a}=t||{};return new pr(FV++,e,n,i,o=>{let l=[Mf.of(o)];return a&&l.push(Lc.of(f=>{let c=f.plugin(o);return c?a(c):je.none})),s&&l.push(s(o)),l})}static fromClass(e,t){return pr.define(n=>new e(n),t)}}class wp{constructor(e){this.spec=e,this.mustUpdate=null,this.value=null}update(e){if(this.value){if(this.mustUpdate){let t=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(t)}catch(n){if(tn(t.state,n,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.create(e)}catch(t){tn(e.state,t,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(e){var t;if(!((t=this.value)===null||t===void 0)&&t.destroy)try{this.value.destroy()}catch(n){tn(e.state,n,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const yA=Ze.define(),fx=Ze.define(),Lc=Ze.define(),wA=Ze.define(),cx=Ze.define(),bA=Ze.define();function Ew(r,e){let t=r.state.facet(bA);if(!t.length)return t;let n=t.map(s=>s instanceof Function?s(r):s),i=[];return Ct.spans(n,e.from,e.to,{point(){},span(s,a,o,l){let f=s-e.from,c=a-e.from,h=i;for(let u=o.length-1;u>=0;u--,l--){let d=o[u].spec.bidiIsolate,p;if(d==null&&(d=QV(e.text,f,c)),l>0&&h.length&&(p=h[h.length-1]).to==f&&p.direction==d)p.to=c,h=p.inner;else{let m={from:f,to:c,direction:d,inner:[]};h.push(m),h=m.inner}}}}),i}const _A=Ze.define();function hx(r){let e=0,t=0,n=0,i=0;for(let s of r.state.facet(_A)){let a=s(r);a&&(a.left!=null&&(e=Math.max(e,a.left)),a.right!=null&&(t=Math.max(t,a.right)),a.top!=null&&(n=Math.max(n,a.top)),a.bottom!=null&&(i=Math.max(i,a.bottom)))}return{left:e,right:t,top:n,bottom:i}}const If=Ze.define();class $i{constructor(e,t,n,i){this.fromA=e,this.toA=t,this.fromB=n,this.toB=i}join(e){return new $i(Math.min(this.fromA,e.fromA),Math.max(this.toA,e.toA),Math.min(this.fromB,e.fromB),Math.max(this.toB,e.toB))}addToSet(e){let t=e.length,n=this;for(;t>0;t--){let i=e[t-1];if(!(i.fromA>n.toA)){if(i.toA<n.fromA)break;n=n.join(i),e.splice(t-1,1)}}return e.splice(t,0,n),e}static extendWithRanges(e,t){if(t.length==0)return e;let n=[];for(let i=0,s=0,a=0,o=0;;i++){let l=i==e.length?null:e[i],f=a-o,c=l?l.fromB:1e9;for(;s<t.length&&t[s]<c;){let h=t[s],u=t[s+1],d=Math.max(o,h),p=Math.min(c,u);if(d<=p&&new $i(d+f,p+f,d,p).addToSet(n),u>c)break;s+=2}if(!l)return n;new $i(l.fromA,l.toA,l.fromB,l.toB).addToSet(n),a=l.toA,o=l.toB}}}class Fd{constructor(e,t,n){this.view=e,this.state=t,this.transactions=n,this.flags=0,this.startState=e.state,this.changes=Wr.empty(this.startState.doc.length);for(let s of n)this.changes=this.changes.compose(s.changes);let i=[];this.changes.iterChangedRanges((s,a,o,l)=>i.push(new $i(s,a,o,l))),this.changedRanges=i}static create(e,t,n){return new Fd(e,t,n)}get viewportChanged(){return(this.flags&4)>0}get viewportMoved(){return(this.flags&8)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&18)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(e=>e.selection)}get empty(){return this.flags==0&&this.transactions.length==0}}class Pw extends qt{get length(){return this.view.state.doc.length}constructor(e){super(),this.view=e,this.decorations=[],this.dynamicDecorationMap=[!1],this.domChanged=null,this.hasComposition=null,this.markedForComposition=new Set,this.editContextFormatting=je.none,this.lastCompositionAfterCursor=!1,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(e.contentDOM),this.children=[new Ir],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new $i(0,0,0,e.state.doc.length)],0,null)}update(e){var t;let n=e.changedRanges;this.minWidth>0&&n.length&&(n.every(({fromA:f,toA:c})=>c<this.minWidthFrom||f>this.minWidthTo)?(this.minWidthFrom=e.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=e.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.updateEditContextFormatting(e);let i=-1;this.view.inputState.composing>=0&&!this.view.observer.editContext&&(!((t=this.domChanged)===null||t===void 0)&&t.newSel?i=this.domChanged.newSel.head:!BV(e.changes,this.hasComposition)&&!e.selectionSet&&(i=e.state.selection.main.head));let s=i>-1?DV(this.view,e.changes,i):null;if(this.domChanged=null,this.hasComposition){this.markedForComposition.clear();let{from:f,to:c}=this.hasComposition;n=new $i(f,c,e.changes.mapPos(f,-1),e.changes.mapPos(c,1)).addToSet(n.slice())}this.hasComposition=s?{from:s.range.fromB,to:s.range.toB}:null,(qe.ie||qe.chrome)&&!s&&e&&e.state.doc.lines!=e.startState.doc.lines&&(this.forceSelection=!0);let a=this.decorations,o=this.updateDeco(),l=IV(a,o,e.changes);return n=$i.extendWithRanges(n,l),!(this.flags&7)&&n.length==0?!1:(this.updateInner(n,e.startState.doc.length,s),e.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(e,t,n){this.view.viewState.mustMeasureContent=!0,this.updateChildren(e,t,n);let{observer:i}=this.view;i.ignore(()=>{this.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let a=qe.chrome||qe.ios?{node:i.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,a),this.flags&=-8,a&&(a.written||i.selectionRange.focusNode!=a.node)&&(this.forceSelection=!0),this.dom.style.height=""}),this.markedForComposition.forEach(a=>a.flags&=-9);let s=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let a of this.children)a instanceof Gs&&a.widget instanceof vg&&s.push(a.dom);i.updateGaps(s)}updateChildren(e,t,n){let i=n?n.range.addToSet(e.slice()):e,s=this.childCursor(t);for(let a=i.length-1;;a--){let o=a>=0?i[a]:null;if(!o)break;let{fromA:l,toA:f,fromB:c,toB:h}=o,u,d,p,m;if(n&&n.range.fromB<h&&n.range.toB>c){let S=hc.build(this.view.state.doc,c,n.range.fromB,this.decorations,this.dynamicDecorationMap),y=hc.build(this.view.state.doc,n.range.toB,h,this.decorations,this.dynamicDecorationMap);d=S.breakAtStart,p=S.openStart,m=y.openEnd;let b=this.compositionView(n);y.breakAtStart?b.breakAfter=1:y.content.length&&b.merge(b.length,b.length,y.content[0],!1,y.openStart,0)&&(b.breakAfter=y.content[0].breakAfter,y.content.shift()),S.content.length&&b.merge(0,0,S.content[S.content.length-1],!0,0,S.openEnd)&&S.content.pop(),u=S.content.concat(b).concat(y.content)}else({content:u,breakAtStart:d,openStart:p,openEnd:m}=hc.build(this.view.state.doc,c,h,this.decorations,this.dynamicDecorationMap));let{i:g,off:O}=s.findPos(f,1),{i:w,off:v}=s.findPos(l,-1);YC(this,w,v,g,O,u,d,p,m)}n&&this.fixCompositionDOM(n)}updateEditContextFormatting(e){this.editContextFormatting=this.editContextFormatting.map(e.changes);for(let t of e.transactions)for(let n of t.effects)n.is(vA)&&(this.editContextFormatting=n.value)}compositionView(e){let t=new rs(e.text.nodeValue);t.flags|=8;for(let{deco:i}of e.marks)t=new ea(i,[t],t.length);let n=new Ir;return n.append(t,0),n}fixCompositionDOM(e){let t=(s,a)=>{a.flags|=8|(a.children.some(l=>l.flags&7)?1:0),this.markedForComposition.add(a);let o=qt.get(s);o&&o!=a&&(o.dom=null),a.setDOM(s)},n=this.childPos(e.range.fromB,1),i=this.children[n.i];t(e.line,i);for(let s=e.marks.length-1;s>=-1;s--)n=i.childPos(n.off,1),i=i.children[n.i],t(s>=0?e.marks[s].node:e.text,i)}updateSelection(e=!1,t=!1){(e||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange();let n=this.view.root.activeElement,i=n==this.dom,s=!i&&!(this.view.state.facet(Xs)||this.dom.tabIndex>-1)&&Du(this.dom,this.view.observer.selectionRange)&&!(n&&this.dom.contains(n));if(!(i||t||s))return;let a=this.forceSelection;this.forceSelection=!1;let o=this.view.state.selection.main,l=this.moveToLine(this.domAtPos(o.anchor)),f=o.empty?l:this.moveToLine(this.domAtPos(o.head));if(qe.gecko&&o.empty&&!this.hasComposition&&$V(l)){let h=document.createTextNode("");this.view.observer.ignore(()=>l.node.insertBefore(h,l.node.childNodes[l.offset]||null)),l=f=new _n(h,0),a=!0}let c=this.view.observer.selectionRange;(a||!c.focusNode||(!cc(l.node,l.offset,c.anchorNode,c.anchorOffset)||!cc(f.node,f.offset,c.focusNode,c.focusOffset))&&!this.suppressWidgetCursorChange(c,o))&&(this.view.observer.ignore(()=>{qe.android&&qe.chrome&&this.dom.contains(c.focusNode)&&LV(c.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let h=Mc(this.view.root);if(h)if(o.empty){if(qe.gecko){let u=NV(l.node,l.offset);if(u&&u!=3){let d=(u==1?zC:GC)(l.node,l.offset);d&&(l=new _n(d.node,d.offset))}}h.collapse(l.node,l.offset),o.bidiLevel!=null&&h.caretBidiLevel!==void 0&&(h.caretBidiLevel=o.bidiLevel)}else if(h.extend){h.collapse(l.node,l.offset);try{h.extend(f.node,f.offset)}catch{}}else{let u=document.createRange();o.anchor>o.head&&([l,f]=[f,l]),u.setEnd(f.node,f.offset),u.setStart(l.node,l.offset),h.removeAllRanges(),h.addRange(u)}s&&this.view.root.activeElement==this.dom&&(this.dom.blur(),n&&n.focus())}),this.view.observer.setSelectionRange(l,f)),this.impreciseAnchor=l.precise?null:new _n(c.anchorNode,c.anchorOffset),this.impreciseHead=f.precise?null:new _n(c.focusNode,c.focusOffset)}suppressWidgetCursorChange(e,t){return this.hasComposition&&t.empty&&cc(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)&&this.posFromDOM(e.focusNode,e.focusOffset)==t.head}enforceCursorAssoc(){if(this.hasComposition)return;let{view:e}=this,t=e.state.selection.main,n=Mc(e.root),{anchorNode:i,anchorOffset:s}=e.observer.selectionRange;if(!n||!t.empty||!t.assoc||!n.modify)return;let a=Ir.find(this,t.head);if(!a)return;let o=a.posAtStart;if(t.head==o||t.head==o+a.length)return;let l=this.coordsAt(t.head,-1),f=this.coordsAt(t.head,1);if(!l||!f||l.bottom>f.top)return;let c=this.domAtPos(t.head+t.assoc);n.collapse(c.node,c.offset),n.modify("move",t.assoc<0?"forward":"backward","lineboundary"),e.observer.readSelectionRange();let h=e.observer.selectionRange;e.docView.posFromDOM(h.anchorNode,h.anchorOffset)!=t.from&&n.collapse(i,s)}moveToLine(e){let t=this.dom,n;if(e.node!=t)return e;for(let i=e.offset;!n&&i<t.childNodes.length;i++){let s=qt.get(t.childNodes[i]);s instanceof Ir&&(n=s.domAtPos(0))}for(let i=e.offset-1;!n&&i>=0;i--){let s=qt.get(t.childNodes[i]);s instanceof Ir&&(n=s.domAtPos(s.length))}return n?new _n(n.node,n.offset,!0):e}nearest(e){for(let t=e;t;){let n=qt.get(t);if(n&&n.rootView==this)return n;t=t.parentNode}return null}posFromDOM(e,t){let n=this.nearest(e);if(!n)throw new RangeError("Trying to find position for a DOM position outside of the document");return n.localPosFromDOM(e,t)+n.posAtStart}domAtPos(e){let{i:t,off:n}=this.childCursor().findPos(e,-1);for(;t<this.children.length-1;){let i=this.children[t];if(n<i.length||i instanceof Ir)break;t++,n=0}return this.children[t].domAtPos(n)}coordsAt(e,t){let n=null,i=0;for(let s=this.length,a=this.children.length-1;a>=0;a--){let o=this.children[a],l=s-o.breakAfter,f=l-o.length;if(l<e)break;if(f<=e&&(f<e||o.covers(-1))&&(l>e||o.covers(1))&&(!n||o instanceof Ir&&!(n instanceof Ir&&t>=0)))n=o,i=f;else if(n&&f==e&&l==e&&o instanceof Gs&&Math.abs(t)<2){if(o.deco.startSide<0)break;a&&(n=null)}s=f}return n?n.coordsAt(e-i,t):null}coordsForChar(e){let{i:t,off:n}=this.childPos(e,1),i=this.children[t];if(!(i instanceof Ir))return null;for(;i.children.length;){let{i:o,off:l}=i.childPos(n,1);for(;;o++){if(o==i.children.length)return null;if((i=i.children[o]).length)break}n=l}if(!(i instanceof rs))return null;let s=pn(i.text,n);if(s==n)return null;let a=Fo(i.dom,n,s).getClientRects();for(let o=0;o<a.length;o++){let l=a[o];if(o==a.length-1||l.top<l.bottom&&l.left<l.right)return l}return null}measureVisibleLineHeights(e){let t=[],{from:n,to:i}=e,s=this.view.contentDOM.clientWidth,a=s>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,o=-1,l=this.view.textDirection==Et.LTR;for(let f=0,c=0;c<this.children.length;c++){let h=this.children[c],u=f+h.length;if(u>i)break;if(f>=n){let d=h.dom.getBoundingClientRect();if(t.push(d.height),a){let p=h.dom.lastChild,m=p?Ic(p):[];if(m.length){let g=m[m.length-1],O=l?g.right-d.left:d.right-g.left;O>o&&(o=O,this.minWidth=s,this.minWidthFrom=f,this.minWidthTo=u)}}}f=u+h.breakAfter}return t}textDirectionAt(e){let{i:t}=this.childPos(e,1);return getComputedStyle(this.children[t].dom).direction=="rtl"?Et.RTL:Et.LTR}measureTextSize(){for(let s of this.children)if(s instanceof Ir){let a=s.measureTextSize();if(a)return a}let e=document.createElement("div"),t,n,i;return e.className="cm-line",e.style.width="99999px",e.style.position="absolute",e.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.dom.appendChild(e);let s=Ic(e.firstChild)[0];t=e.getBoundingClientRect().height,n=s?s.width/27:7,i=s?s.height:t,e.remove()}),{lineHeight:t,charWidth:n,textHeight:i}}childCursor(e=this.length){let t=this.children.length;return t&&(e-=this.children[--t].length),new HC(this.children,e,t)}computeBlockGapDeco(){let e=[],t=this.view.viewState;for(let n=0,i=0;;i++){let s=i==t.viewports.length?null:t.viewports[i],a=s?s.from-1:this.length;if(a>n){let o=(t.lineBlockAt(a).bottom-t.lineBlockAt(n).top)/this.view.scaleY;e.push(je.replace({widget:new vg(o),block:!0,inclusive:!0,isBlockGap:!0}).range(n,a))}if(!s)break;n=s.to+1}return je.set(e)}updateDeco(){let e=1,t=this.view.state.facet(Lc).map(s=>(this.dynamicDecorationMap[e++]=typeof s=="function")?s(this.view):s),n=!1,i=this.view.state.facet(wA).map((s,a)=>{let o=typeof s=="function";return o&&(n=!0),o?s(this.view):s});for(i.length&&(this.dynamicDecorationMap[e++]=n,t.push(Ct.join(i))),this.decorations=[this.editContextFormatting,...t,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco];e<this.decorations.length;)this.dynamicDecorationMap[e++]=!1;return this.decorations}scrollIntoView(e){if(e.isSnapshot){let f=this.view.viewState.lineBlockAt(e.range.head);this.view.scrollDOM.scrollTop=f.top-e.yMargin,this.view.scrollDOM.scrollLeft=e.xMargin;return}for(let f of this.view.state.facet(xA))try{if(f(this.view,e.range,e))return!0}catch(c){tn(this.view.state,c,"scroll handler")}let{range:t}=e,n=this.coordsAt(t.head,t.empty?t.assoc:t.head>t.anchor?-1:1),i;if(!n)return;!t.empty&&(i=this.coordsAt(t.anchor,t.anchor>t.head?-1:1))&&(n={left:Math.min(n.left,i.left),top:Math.min(n.top,i.top),right:Math.max(n.right,i.right),bottom:Math.max(n.bottom,i.bottom)});let s=hx(this.view),a={left:n.left-s.left,top:n.top-s.top,right:n.right+s.right,bottom:n.bottom+s.bottom},{offsetWidth:o,offsetHeight:l}=this.view.scrollDOM;pV(this.view.scrollDOM,a,t.head<t.anchor?-1:1,e.x,e.y,Math.max(Math.min(e.xMargin,o),-o),Math.max(Math.min(e.yMargin,l),-l),this.view.textDirection==Et.LTR)}}function $V(r){return r.node.nodeType==1&&r.node.firstChild&&(r.offset==0||r.node.childNodes[r.offset-1].contentEditable=="false")&&(r.offset==r.node.childNodes.length||r.node.childNodes[r.offset].contentEditable=="false")}function kA(r,e){let t=r.observer.selectionRange;if(!t.focusNode)return null;let n=zC(t.focusNode,t.focusOffset),i=GC(t.focusNode,t.focusOffset),s=n||i;if(i&&n&&i.node!=n.node){let o=qt.get(i.node);if(!o||o instanceof rs&&o.text!=i.node.nodeValue)s=i;else if(r.docView.lastCompositionAfterCursor){let l=qt.get(n.node);!l||l instanceof rs&&l.text!=n.node.nodeValue||(s=i)}}if(r.docView.lastCompositionAfterCursor=s!=n,!s)return null;let a=e-s.offset;return{from:a,to:a+s.node.nodeValue.length,node:s.node}}function DV(r,e,t){let n=kA(r,t);if(!n)return null;let{node:i,from:s,to:a}=n,o=i.nodeValue;if(/[\n\r]/.test(o)||r.state.doc.sliceString(n.from,n.to)!=o)return null;let l=e.invertedDesc,f=new $i(l.mapPos(s),l.mapPos(a),s,a),c=[];for(let h=i.parentNode;;h=h.parentNode){let u=qt.get(h);if(u instanceof ea)c.push({node:h,deco:u.mark});else{if(u instanceof Ir||h.nodeName=="DIV"&&h.parentNode==r.contentDOM)return{range:f,text:i,marks:c,line:h};if(h!=r.contentDOM)c.push({node:h,deco:new bh({inclusive:!0,attributes:bV(h),tagName:h.tagName.toLowerCase()})});else return null}}}function NV(r,e){return r.nodeType!=1?0:(e&&r.childNodes[e-1].contentEditable=="false"?1:0)|(e<r.childNodes.length&&r.childNodes[e].contentEditable=="false"?2:0)}let MV=class{constructor(){this.changes=[]}compareRange(e,t){Nu(e,t,this.changes)}comparePoint(e,t){Nu(e,t,this.changes)}boundChange(e){Nu(e,e,this.changes)}};function IV(r,e,t){let n=new MV;return Ct.compare(r,e,t,n),n.changes}function LV(r,e){for(let t=r;t&&t!=e;t=t.assignedSlot||t.parentNode)if(t.nodeType==1&&t.contentEditable=="false")return!0;return!1}function BV(r,e){let t=!1;return e&&r.iterChangedRanges((n,i)=>{n<e.to&&i>e.from&&(t=!0)}),t}function ZV(r,e,t=1){let n=r.charCategorizer(e),i=r.doc.lineAt(e),s=e-i.from;if(i.length==0)return Oe.cursor(e);s==0?t=1:s==i.length&&(t=-1);let a=s,o=s;t<0?a=pn(i.text,s,!1):o=pn(i.text,s);let l=n(i.text.slice(a,o));for(;a>0;){let f=pn(i.text,a,!1);if(n(i.text.slice(f,a))!=l)break;a=f}for(;o<i.length;){let f=pn(i.text,o);if(n(i.text.slice(o,f))!=l)break;o=f}return Oe.range(a+i.from,o+i.from)}function WV(r,e){return e.left>r?e.left-r:Math.max(0,r-e.right)}function UV(r,e){return e.top>r?e.top-r:Math.max(0,r-e.bottom)}function bp(r,e){return r.top<e.bottom-1&&r.bottom>e.top+1}function Rw(r,e){return e<r.top?{top:e,left:r.left,right:r.right,bottom:r.bottom}:r}function Qw(r,e){return e>r.bottom?{top:r.top,left:r.left,right:r.right,bottom:e}:r}function kg(r,e,t){let n,i,s,a,o=!1,l,f,c,h;for(let p=r.firstChild;p;p=p.nextSibling){let m=Ic(p);for(let g=0;g<m.length;g++){let O=m[g];i&&bp(i,O)&&(O=Rw(Qw(O,i.bottom),i.top));let w=WV(e,O),v=UV(t,O);if(w==0&&v==0)return p.nodeType==3?Fw(p,e,t):kg(p,e,t);if(!n||a>v||a==v&&s>w){n=p,i=O,s=w,a=v;let S=v?t<O.top?-1:1:w?e<O.left?-1:1:0;o=!S||(S>0?g<m.length-1:g>0)}w==0?t>O.bottom&&(!c||c.bottom<O.bottom)?(l=p,c=O):t<O.top&&(!h||h.top>O.top)&&(f=p,h=O):c&&bp(c,O)?c=Qw(c,O.bottom):h&&bp(h,O)&&(h=Rw(h,O.top))}}if(c&&c.bottom>=t?(n=l,i=c):h&&h.top<=t&&(n=f,i=h),!n)return{node:r,offset:0};let u=Math.max(i.left,Math.min(i.right,e));if(n.nodeType==3)return Fw(n,u,t);if(o&&n.contentEditable!="false")return kg(n,u,t);let d=Array.prototype.indexOf.call(r.childNodes,n)+(e>=(i.left+i.right)/2?1:0);return{node:r,offset:d}}function Fw(r,e,t){let n=r.nodeValue.length,i=-1,s=1e9,a=0;for(let o=0;o<n;o++){let l=Fo(r,o,o+1).getClientRects();for(let f=0;f<l.length;f++){let c=l[f];if(c.top==c.bottom)continue;a||(a=e-c.left);let h=(c.top>t?c.top-t:t-c.bottom)-1;if(c.left-1<=e&&c.right+1>=e&&h<s){let u=e>=(c.left+c.right)/2,d=u;if((qe.chrome||qe.gecko)&&Fo(r,o).getBoundingClientRect().left==c.right&&(d=!u),h<=0)return{node:r,offset:o+(d?1:0)};i=o+(d?1:0),s=h}}}return{node:r,offset:i>-1?i:a>0?r.nodeValue.length:0}}function SA(r,e,t,n=-1){var i,s;let a=r.contentDOM.getBoundingClientRect(),o=a.top+r.viewState.paddingTop,l,{docHeight:f}=r.viewState,{x:c,y:h}=e,u=h-o;if(u<0)return 0;if(u>f)return r.state.doc.length;for(let S=r.viewState.heightOracle.textHeight/2,y=!1;l=r.elementAtHeight(u),l.type!=Mn.Text;)for(;u=n>0?l.bottom+S:l.top-S,!(u>=0&&u<=f);){if(y)return t?null:0;y=!0,n=-n}h=o+u;let d=l.from;if(d<r.viewport.from)return r.viewport.from==0?0:t?null:$w(r,a,l,c,h);if(d>r.viewport.to)return r.viewport.to==r.state.doc.length?r.state.doc.length:t?null:$w(r,a,l,c,h);let p=r.dom.ownerDocument,m=r.root.elementFromPoint?r.root:p,g=m.elementFromPoint(c,h);g&&!r.contentDOM.contains(g)&&(g=null),g||(c=Math.max(a.left+1,Math.min(a.right-1,c)),g=m.elementFromPoint(c,h),g&&!r.contentDOM.contains(g)&&(g=null));let O,w=-1;if(g&&((i=r.docView.nearest(g))===null||i===void 0?void 0:i.isEditable)!=!1){if(p.caretPositionFromPoint){let S=p.caretPositionFromPoint(c,h);S&&({offsetNode:O,offset:w}=S)}else if(p.caretRangeFromPoint){let S=p.caretRangeFromPoint(c,h);S&&({startContainer:O,startOffset:w}=S,(!r.contentDOM.contains(O)||qe.safari&&XV(O,w,c)||qe.chrome&&VV(O,w,c))&&(O=void 0))}O&&(w=Math.min(Es(O),w))}if(!O||!r.docView.dom.contains(O)){let S=Ir.find(r.docView,d);if(!S)return u>l.top+l.height/2?l.to:l.from;({node:O,offset:w}=kg(S.dom,c,h))}let v=r.docView.nearest(O);if(!v)return null;if(v.isWidget&&((s=v.dom)===null||s===void 0?void 0:s.nodeType)==1){let S=v.dom.getBoundingClientRect();return e.y<S.top||e.y<=S.bottom&&e.x<=(S.left+S.right)/2?v.posAtStart:v.posAtEnd}else return v.localPosFromDOM(O,w)+v.posAtStart}function $w(r,e,t,n,i){let s=Math.round((n-e.left)*r.defaultCharacterWidth);if(r.lineWrapping&&t.height>r.defaultLineHeight*1.5){let o=r.viewState.heightOracle.textHeight,l=Math.floor((i-t.top-(r.defaultLineHeight-o)*.5)/o);s+=l*r.viewState.heightOracle.lineLength}let a=r.state.sliceDoc(t.from,t.to);return t.from+cg(a,s,r.state.tabSize)}function XV(r,e,t){let n;if(r.nodeType!=3||e!=(n=r.nodeValue.length))return!1;for(let i=r.nextSibling;i;i=i.nextSibling)if(i.nodeType!=1||i.nodeName!="BR")return!1;return Fo(r,n-1,n).getBoundingClientRect().left>t}function VV(r,e,t){if(e!=0)return!1;for(let i=r;;){let s=i.parentNode;if(!s||s.nodeType!=1||s.firstChild!=i)return!1;if(s.classList.contains("cm-line"))break;i=s}let n=r.nodeType==1?r.getBoundingClientRect():Fo(r,0,Math.max(r.nodeValue.length,1)).getBoundingClientRect();return t-n.left>5}function Sg(r,e){let t=r.lineBlockAt(e);if(Array.isArray(t.type)){for(let n of t.type)if(n.to>e||n.to==e&&(n.to==t.to||n.type==Mn.Text))return n}return t}function qV(r,e,t,n){let i=Sg(r,e.head),s=!n||i.type!=Mn.Text||!(r.lineWrapping||i.widgetLineBreaks)?null:r.coordsAtPos(e.assoc<0&&e.head>i.from?e.head-1:e.head);if(s){let a=r.dom.getBoundingClientRect(),o=r.textDirectionAt(i.from),l=r.posAtCoords({x:t==(o==Et.LTR)?a.right-1:a.left+1,y:(s.top+s.bottom)/2});if(l!=null)return Oe.cursor(l,t?-1:1)}return Oe.cursor(t?i.to:i.from,t?-1:1)}function Dw(r,e,t,n){let i=r.state.doc.lineAt(e.head),s=r.bidiSpans(i),a=r.textDirectionAt(i.from);for(let o=e,l=null;;){let f=RV(i,s,a,o,t),c=fA;if(!f){if(i.number==(t?r.state.doc.lines:1))return o;c=`
`,i=r.state.doc.line(i.number+(t?1:-1)),s=r.bidiSpans(i),f=r.visualLineSide(i,!t)}if(l){if(!l(c))return o}else{if(!n)return f;l=n(c)}o=f}}function jV(r,e,t){let n=r.state.charCategorizer(e),i=n(t);return s=>{let a=n(s);return i==ur.Space&&(i=a),i==a}}function zV(r,e,t,n){let i=e.head,s=t?1:-1;if(i==(t?r.state.doc.length:0))return Oe.cursor(i,e.assoc);let a=e.goalColumn,o,l=r.contentDOM.getBoundingClientRect(),f=r.coordsAtPos(i,e.assoc||-1),c=r.documentTop;if(f)a==null&&(a=f.left-l.left),o=s<0?f.top:f.bottom;else{let d=r.viewState.lineBlockAt(i);a==null&&(a=Math.min(l.right-l.left,r.defaultCharacterWidth*(i-d.from))),o=(s<0?d.top:d.bottom)+c}let h=l.left+a,u=n??r.viewState.heightOracle.textHeight>>1;for(let d=0;;d+=10){let p=o+(u+d)*s,m=SA(r,{x:h,y:p},!1,s);if(p<l.top||p>l.bottom||(s<0?m<i:m>i)){let g=r.docView.coordsForChar(m),O=!g||p<g.top?-1:1;return Oe.cursor(m,O,void 0,a)}}}function Mu(r,e,t){for(;;){let n=0;for(let i of r)i.between(e-1,e+1,(s,a,o)=>{if(e>s&&e<a){let l=n||t||(e-s<a-e?-1:1);e=l<0?s:a,n=l}});if(!n)return e}}function _p(r,e,t){let n=Mu(r.state.facet(cx).map(i=>i(r)),t.from,e.head>t.from?-1:1);return n==t.from?t:Oe.cursor(n,n<t.from?1:-1)}const Lf="";class GV{constructor(e,t){this.points=e,this.text="",this.lineSeparator=t.facet(st.lineSeparator)}append(e){this.text+=e}lineBreak(){this.text+=Lf}readRange(e,t){if(!e)return this;let n=e.parentNode;for(let i=e;;){this.findPointBefore(n,i);let s=this.text.length;this.readNode(i);let a=i.nextSibling;if(a==t)break;let o=qt.get(i),l=qt.get(a);(o&&l?o.breakAfter:(o?o.breakAfter:Rd(i))||Rd(a)&&(i.nodeName!="BR"||i.cmIgnore)&&this.text.length>s)&&this.lineBreak(),i=a}return this.findPointBefore(n,t),this}readTextNode(e){let t=e.nodeValue;for(let n of this.points)n.node==e&&(n.pos=this.text.length+Math.min(n.offset,t.length));for(let n=0,i=this.lineSeparator?null:/\r\n?|\n/g;;){let s=-1,a=1,o;if(this.lineSeparator?(s=t.indexOf(this.lineSeparator,n),a=this.lineSeparator.length):(o=i.exec(t))&&(s=o.index,a=o[0].length),this.append(t.slice(n,s<0?t.length:s)),s<0)break;if(this.lineBreak(),a>1)for(let l of this.points)l.node==e&&l.pos>this.text.length&&(l.pos-=a-1);n=s+a}}readNode(e){if(e.cmIgnore)return;let t=qt.get(e),n=t&&t.overrideDOMText;if(n!=null){this.findPointInside(e,n.length);for(let i=n.iter();!i.next().done;)i.lineBreak?this.lineBreak():this.append(i.value)}else e.nodeType==3?this.readTextNode(e):e.nodeName=="BR"?e.nextSibling&&this.lineBreak():e.nodeType==1&&this.readRange(e.firstChild,null)}findPointBefore(e,t){for(let n of this.points)n.node==e&&e.childNodes[n.offset]==t&&(n.pos=this.text.length)}findPointInside(e,t){for(let n of this.points)(e.nodeType==3?n.node==e:e.contains(n.node))&&(n.pos=this.text.length+(HV(e,n.node,n.offset)?t:0))}}function HV(r,e,t){for(;;){if(!e||t<Es(e))return!1;if(e==r)return!0;t=Qo(e)+1,e=e.parentNode}}class Nw{constructor(e,t){this.node=e,this.offset=t,this.pos=-1}}class YV{constructor(e,t,n,i){this.typeOver=i,this.bounds=null,this.text="",this.domChanged=t>-1;let{impreciseHead:s,impreciseAnchor:a}=e.docView;if(e.state.readOnly&&t>-1)this.newSel=null;else if(t>-1&&(this.bounds=e.docView.domBoundsAround(t,n,0))){let o=s||a?[]:eq(e),l=new GV(o,e.state);l.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=l.text,this.newSel=tq(o,this.bounds.from)}else{let o=e.observer.selectionRange,l=s&&s.node==o.focusNode&&s.offset==o.focusOffset||!dg(e.contentDOM,o.focusNode)?e.state.selection.main.head:e.docView.posFromDOM(o.focusNode,o.focusOffset),f=a&&a.node==o.anchorNode&&a.offset==o.anchorOffset||!dg(e.contentDOM,o.anchorNode)?e.state.selection.main.anchor:e.docView.posFromDOM(o.anchorNode,o.anchorOffset),c=e.viewport;if((qe.ios||qe.chrome)&&e.state.selection.main.empty&&l!=f&&(c.from>0||c.to<e.state.doc.length)){let h=Math.min(l,f),u=Math.max(l,f),d=c.from-h,p=c.to-u;(d==0||d==1||h==0)&&(p==0||p==-1||u==e.state.doc.length)&&(l=0,f=e.state.doc.length)}this.newSel=Oe.single(f,l)}}}function TA(r,e){let t,{newSel:n}=e,i=r.state.selection.main,s=r.inputState.lastKeyTime>Date.now()-100?r.inputState.lastKeyCode:-1;if(e.bounds){let{from:a,to:o}=e.bounds,l=i.from,f=null;(s===8||qe.android&&e.text.length<o-a)&&(l=i.to,f="end");let c=JV(r.state.doc.sliceString(a,o,Lf),e.text,l-a,f);c&&(qe.chrome&&s==13&&c.toB==c.from+2&&e.text.slice(c.from,c.toB)==Lf+Lf&&c.toB--,t={from:a+c.from,to:a+c.toA,insert:Ft.of(e.text.slice(c.from,c.toB).split(Lf))})}else n&&(!r.hasFocus&&r.state.facet(Xs)||n.main.eq(i))&&(n=null);if(!t&&!n)return!1;if(!t&&e.typeOver&&!i.empty&&n&&n.main.empty?t={from:i.from,to:i.to,insert:r.state.doc.slice(i.from,i.to)}:(qe.mac||qe.android)&&t&&t.from==t.to&&t.from==i.head-1&&/^\. ?$/.test(t.insert.toString())&&r.contentDOM.getAttribute("autocorrect")=="off"?(n&&t.insert.length==2&&(n=Oe.single(n.main.anchor-1,n.main.head-1)),t={from:t.from,to:t.to,insert:Ft.of([t.insert.toString().replace("."," ")])}):t&&t.from>=i.from&&t.to<=i.to&&(t.from!=i.from||t.to!=i.to)&&i.to-i.from-(t.to-t.from)<=4?t={from:i.from,to:i.to,insert:r.state.doc.slice(i.from,t.from).append(t.insert).append(r.state.doc.slice(t.to,i.to))}:qe.chrome&&t&&t.from==t.to&&t.from==i.head&&t.insert.toString()==`
 `&&r.lineWrapping&&(n&&(n=Oe.single(n.main.anchor-1,n.main.head-1)),t={from:i.from,to:i.to,insert:Ft.of([" "])}),t)return ux(r,t,n,s);if(n&&!n.main.eq(i)){let a=!1,o="select";return r.inputState.lastSelectionTime>Date.now()-50&&(r.inputState.lastSelectionOrigin=="select"&&(a=!0),o=r.inputState.lastSelectionOrigin),r.dispatch({selection:n,scrollIntoView:a,userEvent:o}),!0}else return!1}function ux(r,e,t,n=-1){if(qe.ios&&r.inputState.flushIOSKey(e))return!0;let i=r.state.selection.main;if(qe.android&&(e.to==i.to&&(e.from==i.from||e.from==i.from-1&&r.state.sliceDoc(e.from,i.from)==" ")&&e.insert.length==1&&e.insert.lines==2&&vl(r.contentDOM,"Enter",13)||(e.from==i.from-1&&e.to==i.to&&e.insert.length==0||n==8&&e.insert.length<e.to-e.from&&e.to>i.head)&&vl(r.contentDOM,"Backspace",8)||e.from==i.from&&e.to==i.to+1&&e.insert.length==0&&vl(r.contentDOM,"Delete",46)))return!0;let s=e.insert.toString();r.inputState.composing>=0&&r.inputState.composing++;let a,o=()=>a||(a=KV(r,e,t));return r.state.facet(pA).some(l=>l(r,e.from,e.to,s,o))||r.dispatch(o()),!0}function KV(r,e,t){let n,i=r.state,s=i.selection.main;if(e.from>=s.from&&e.to<=s.to&&e.to-e.from>=(s.to-s.from)/3&&(!t||t.main.empty&&t.main.from==e.from+e.insert.length)&&r.inputState.composing<0){let o=s.from<e.from?i.sliceDoc(s.from,e.from):"",l=s.to>e.to?i.sliceDoc(e.to,s.to):"";n=i.replaceSelection(r.state.toText(o+e.insert.sliceString(0,void 0,r.state.lineBreak)+l))}else{let o=i.changes(e),l=t&&t.main.to<=o.newLength?t.main:void 0;if(i.selection.ranges.length>1&&r.inputState.composing>=0&&e.to<=s.to&&e.to>=s.to-10){let f=r.state.sliceDoc(e.from,e.to),c,h=t&&kA(r,t.main.head);if(h){let p=e.insert.length-(e.to-e.from);c={from:h.from,to:h.to-p}}else c=r.state.doc.lineAt(s.head);let u=s.to-e.to,d=s.to-s.from;n=i.changeByRange(p=>{if(p.from==s.from&&p.to==s.to)return{changes:o,range:l||p.map(o)};let m=p.to-u,g=m-f.length;if(p.to-p.from!=d||r.state.sliceDoc(g,m)!=f||p.to>=c.from&&p.from<=c.to)return{range:p};let O=i.changes({from:g,to:m,insert:e.insert}),w=p.to-s.to;return{changes:O,range:l?Oe.range(Math.max(0,l.anchor+w),Math.max(0,l.head+w)):p.map(O)}})}else n={changes:o,selection:l&&i.selection.replaceRange(l)}}let a="input.type";return(r.composing||r.inputState.compositionPendingChange&&r.inputState.compositionEndedAt>Date.now()-50)&&(r.inputState.compositionPendingChange=!1,a+=".compose",r.inputState.compositionFirstChange&&(a+=".start",r.inputState.compositionFirstChange=!1)),i.update(n,{userEvent:a,scrollIntoView:!0})}function JV(r,e,t,n){let i=Math.min(r.length,e.length),s=0;for(;s<i&&r.charCodeAt(s)==e.charCodeAt(s);)s++;if(s==i&&r.length==e.length)return null;let a=r.length,o=e.length;for(;a>0&&o>0&&r.charCodeAt(a-1)==e.charCodeAt(o-1);)a--,o--;if(n=="end"){let l=Math.max(0,s-Math.min(a,o));t-=a+l-s}if(a<s&&r.length<e.length){let l=t<=s&&t>=a?s-t:0;s-=l,o=s+(o-a),a=s}else if(o<s){let l=t<=s&&t>=o?s-t:0;s-=l,a=s+(a-o),o=s}return{from:s,toA:a,toB:o}}function eq(r){let e=[];if(r.root.activeElement!=r.contentDOM)return e;let{anchorNode:t,anchorOffset:n,focusNode:i,focusOffset:s}=r.observer.selectionRange;return t&&(e.push(new Nw(t,n)),(i!=t||s!=n)&&e.push(new Nw(i,s))),e}function tq(r,e){if(r.length==0)return null;let t=r[0].pos,n=r.length==2?r[1].pos:t;return t>-1&&n>-1?Oe.single(t+e,n+e):null}class rq{setSelectionOrigin(e){this.lastSelectionOrigin=e,this.lastSelectionTime=Date.now()}constructor(e){this.view=e,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.tabFocusMode=-1,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=e.hasFocus,qe.safari&&e.contentDOM.addEventListener("input",()=>null),qe.gecko&&xq(e.contentDOM.ownerDocument)}handleEvent(e){!cq(this.view,e)||this.ignoreDuringComposition(e)||e.type=="keydown"&&this.keydown(e)||this.runHandlers(e.type,e)}runHandlers(e,t){let n=this.handlers[e];if(n){for(let i of n.observers)i(this.view,t);for(let i of n.handlers){if(t.defaultPrevented)break;if(i(this.view,t)){t.preventDefault();break}}}}ensureHandlers(e){let t=nq(e),n=this.handlers,i=this.view.contentDOM;for(let s in t)if(s!="scroll"){let a=!t[s].handlers.length,o=n[s];o&&a!=!o.handlers.length&&(i.removeEventListener(s,this.handleEvent),o=null),o||i.addEventListener(s,this.handleEvent,{passive:a})}for(let s in n)s!="scroll"&&!t[s]&&i.removeEventListener(s,this.handleEvent);this.handlers=t}keydown(e){if(this.lastKeyCode=e.keyCode,this.lastKeyTime=Date.now(),e.keyCode==9&&this.tabFocusMode>-1&&(!this.tabFocusMode||Date.now()<=this.tabFocusMode))return!0;if(this.tabFocusMode>0&&e.keyCode!=27&&AA.indexOf(e.keyCode)<0&&(this.tabFocusMode=-1),qe.android&&qe.chrome&&!e.synthetic&&(e.keyCode==13||e.keyCode==8))return this.view.observer.delayAndroidKey(e.key,e.keyCode),!0;let t;return qe.ios&&!e.synthetic&&!e.altKey&&!e.metaKey&&((t=CA.find(n=>n.keyCode==e.keyCode))&&!e.ctrlKey||iq.indexOf(e.key)>-1&&e.ctrlKey&&!e.shiftKey)?(this.pendingIOSKey=t||e,setTimeout(()=>this.flushIOSKey(),250),!0):(e.keyCode!=229&&this.view.observer.forceFlush(),!1)}flushIOSKey(e){let t=this.pendingIOSKey;return!t||t.key=="Enter"&&e&&e.from<e.to&&/^\S+$/.test(e.insert.toString())?!1:(this.pendingIOSKey=void 0,vl(this.view.contentDOM,t.key,t.keyCode,t instanceof KeyboardEvent?t:void 0))}ignoreDuringComposition(e){return/^key/.test(e.type)?this.composing>0?!0:qe.safari&&!qe.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100?(this.compositionPendingKey=!1,!0):!1:!1}startMouseSelection(e){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=e}update(e){this.view.observer.update(e),this.mouseSelection&&this.mouseSelection.update(e),this.draggedContent&&e.docChanged&&(this.draggedContent=this.draggedContent.map(e.changes)),e.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}function Mw(r,e){return(t,n)=>{try{return e.call(r,n,t)}catch(i){tn(t.state,i)}}}function nq(r){let e=Object.create(null);function t(n){return e[n]||(e[n]={observers:[],handlers:[]})}for(let n of r){let i=n.spec;if(i&&i.domEventHandlers)for(let s in i.domEventHandlers){let a=i.domEventHandlers[s];a&&t(s).handlers.push(Mw(n.value,a))}if(i&&i.domEventObservers)for(let s in i.domEventObservers){let a=i.domEventObservers[s];a&&t(s).observers.push(Mw(n.value,a))}}for(let n in ns)t(n).handlers.push(ns[n]);for(let n in Ni)t(n).observers.push(Ni[n]);return e}const CA=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],iq="dthko",AA=[16,17,18,20,91,92,224,225],Jh=6;function eu(r){return Math.max(0,r)*.7+8}function sq(r,e){return Math.max(Math.abs(r.clientX-e.clientX),Math.abs(r.clientY-e.clientY))}class aq{constructor(e,t,n,i){this.view=e,this.startEvent=t,this.style=n,this.mustSelect=i,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=t,this.scrollParents=mV(e.contentDOM),this.atoms=e.state.facet(cx).map(a=>a(e));let s=e.contentDOM.ownerDocument;s.addEventListener("mousemove",this.move=this.move.bind(this)),s.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=t.shiftKey,this.multiple=e.state.facet(st.allowMultipleSelections)&&oq(e,t),this.dragging=fq(e,t)&&RA(t)==1?null:!1}start(e){this.dragging===!1&&this.select(e)}move(e){if(e.buttons==0)return this.destroy();if(this.dragging||this.dragging==null&&sq(this.startEvent,e)<10)return;this.select(this.lastEvent=e);let t=0,n=0,i=0,s=0,a=this.view.win.innerWidth,o=this.view.win.innerHeight;this.scrollParents.x&&({left:i,right:a}=this.scrollParents.x.getBoundingClientRect()),this.scrollParents.y&&({top:s,bottom:o}=this.scrollParents.y.getBoundingClientRect());let l=hx(this.view);e.clientX-l.left<=i+Jh?t=-eu(i-e.clientX):e.clientX+l.right>=a-Jh&&(t=eu(e.clientX-a)),e.clientY-l.top<=s+Jh?n=-eu(s-e.clientY):e.clientY+l.bottom>=o-Jh&&(n=eu(e.clientY-o)),this.setScrollSpeed(t,n)}up(e){this.dragging==null&&this.select(this.lastEvent),this.dragging||e.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let e=this.view.contentDOM.ownerDocument;e.removeEventListener("mousemove",this.move),e.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(e,t){this.scrollSpeed={x:e,y:t},e||t?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){let{x:e,y:t}=this.scrollSpeed;e&&this.scrollParents.x&&(this.scrollParents.x.scrollLeft+=e,e=0),t&&this.scrollParents.y&&(this.scrollParents.y.scrollTop+=t,t=0),(e||t)&&this.view.win.scrollBy(e,t),this.dragging===!1&&this.select(this.lastEvent)}skipAtoms(e){let t=null;for(let n=0;n<e.ranges.length;n++){let i=e.ranges[n],s=null;if(i.empty){let a=Mu(this.atoms,i.from,0);a!=i.from&&(s=Oe.cursor(a,-1))}else{let a=Mu(this.atoms,i.from,-1),o=Mu(this.atoms,i.to,1);(a!=i.from||o!=i.to)&&(s=Oe.range(i.from==i.anchor?a:o,i.from==i.head?a:o))}s&&(t||(t=e.ranges.slice()),t[n]=s)}return t?Oe.create(t,e.mainIndex):e}select(e){let{view:t}=this,n=this.skipAtoms(this.style.get(e,this.extend,this.multiple));(this.mustSelect||!n.eq(t.state.selection,this.dragging===!1))&&this.view.dispatch({selection:n,userEvent:"select.pointer"}),this.mustSelect=!1}update(e){e.transactions.some(t=>t.isUserEvent("input.type"))?this.destroy():this.style.update(e)&&setTimeout(()=>this.select(this.lastEvent),20)}}function oq(r,e){let t=r.state.facet(cA);return t.length?t[0](e):qe.mac?e.metaKey:e.ctrlKey}function lq(r,e){let t=r.state.facet(hA);return t.length?t[0](e):qe.mac?!e.altKey:!e.ctrlKey}function fq(r,e){let{main:t}=r.state.selection;if(t.empty)return!1;let n=Mc(r.root);if(!n||n.rangeCount==0)return!0;let i=n.getRangeAt(0).getClientRects();for(let s=0;s<i.length;s++){let a=i[s];if(a.left<=e.clientX&&a.right>=e.clientX&&a.top<=e.clientY&&a.bottom>=e.clientY)return!0}return!1}function cq(r,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let t=e.target,n;t!=r.contentDOM;t=t.parentNode)if(!t||t.nodeType==11||(n=qt.get(t))&&n.ignoreEvent(e))return!1;return!0}const ns=Object.create(null),Ni=Object.create(null),EA=qe.ie&&qe.ie_version<15||qe.ios&&qe.webkit_version<604;function hq(r){let e=r.dom.parentNode;if(!e)return;let t=e.appendChild(document.createElement("textarea"));t.style.cssText="position: fixed; left: -10000px; top: 10px",t.focus(),setTimeout(()=>{r.focus(),t.remove(),PA(r,t.value)},50)}function R0(r,e,t){for(let n of r.facet(e))t=n(t,r);return t}function PA(r,e){e=R0(r.state,ox,e);let{state:t}=r,n,i=1,s=t.toText(e),a=s.lines==t.selection.ranges.length;if(Tg!=null&&t.selection.ranges.every(l=>l.empty)&&Tg==s.toString()){let l=-1;n=t.changeByRange(f=>{let c=t.doc.lineAt(f.from);if(c.from==l)return{range:f};l=c.from;let h=t.toText((a?s.line(i++).text:e)+t.lineBreak);return{changes:{from:c.from,insert:h},range:Oe.cursor(f.from+h.length)}})}else a?n=t.changeByRange(l=>{let f=s.line(i++);return{changes:{from:l.from,to:l.to,insert:f.text},range:Oe.cursor(l.from+f.length)}}):n=t.replaceSelection(s);r.dispatch(n,{userEvent:"input.paste",scrollIntoView:!0})}Ni.scroll=r=>{r.inputState.lastScrollTop=r.scrollDOM.scrollTop,r.inputState.lastScrollLeft=r.scrollDOM.scrollLeft};ns.keydown=(r,e)=>(r.inputState.setSelectionOrigin("select"),e.keyCode==27&&r.inputState.tabFocusMode!=0&&(r.inputState.tabFocusMode=Date.now()+2e3),!1);Ni.touchstart=(r,e)=>{r.inputState.lastTouchTime=Date.now(),r.inputState.setSelectionOrigin("select.pointer")};Ni.touchmove=r=>{r.inputState.setSelectionOrigin("select.pointer")};ns.mousedown=(r,e)=>{if(r.observer.flush(),r.inputState.lastTouchTime>Date.now()-2e3)return!1;let t=null;for(let n of r.state.facet(uA))if(t=n(r,e),t)break;if(!t&&e.button==0&&(t=pq(r,e)),t){let n=!r.hasFocus;r.inputState.startMouseSelection(new aq(r,e,t,n)),n&&r.observer.ignore(()=>{VC(r.contentDOM);let s=r.root.activeElement;s&&!s.contains(r.contentDOM)&&s.blur()});let i=r.inputState.mouseSelection;if(i)return i.start(e),i.dragging===!1}return!1};function Iw(r,e,t,n){if(n==1)return Oe.cursor(e,t);if(n==2)return ZV(r.state,e,t);{let i=Ir.find(r.docView,e),s=r.state.doc.lineAt(i?i.posAtEnd:e),a=i?i.posAtStart:s.from,o=i?i.posAtEnd:s.to;return o<r.state.doc.length&&o==s.to&&o++,Oe.range(a,o)}}let Lw=(r,e,t)=>e>=t.top&&e<=t.bottom&&r>=t.left&&r<=t.right;function uq(r,e,t,n){let i=Ir.find(r.docView,e);if(!i)return 1;let s=e-i.posAtStart;if(s==0)return 1;if(s==i.length)return-1;let a=i.coordsAt(s,-1);if(a&&Lw(t,n,a))return-1;let o=i.coordsAt(s,1);return o&&Lw(t,n,o)?1:a&&a.bottom>=n?-1:1}function Bw(r,e){let t=r.posAtCoords({x:e.clientX,y:e.clientY},!1);return{pos:t,bias:uq(r,t,e.clientX,e.clientY)}}const dq=qe.ie&&qe.ie_version<=11;let Zw=null,Ww=0,Uw=0;function RA(r){if(!dq)return r.detail;let e=Zw,t=Uw;return Zw=r,Uw=Date.now(),Ww=!e||t>Date.now()-400&&Math.abs(e.clientX-r.clientX)<2&&Math.abs(e.clientY-r.clientY)<2?(Ww+1)%3:1}function pq(r,e){let t=Bw(r,e),n=RA(e),i=r.state.selection;return{update(s){s.docChanged&&(t.pos=s.changes.mapPos(t.pos),i=i.map(s.changes))},get(s,a,o){let l=Bw(r,s),f,c=Iw(r,l.pos,l.bias,n);if(t.pos!=l.pos&&!a){let h=Iw(r,t.pos,t.bias,n),u=Math.min(h.from,c.from),d=Math.max(h.to,c.to);c=u<c.from?Oe.range(u,d):Oe.range(d,u)}return a?i.replaceRange(i.main.extend(c.from,c.to)):o&&n==1&&i.ranges.length>1&&(f=mq(i,l.pos))?f:o?i.addRange(c):Oe.create([c])}}}function mq(r,e){for(let t=0;t<r.ranges.length;t++){let{from:n,to:i}=r.ranges[t];if(n<=e&&i>=e)return Oe.create(r.ranges.slice(0,t).concat(r.ranges.slice(t+1)),r.mainIndex==t?0:r.mainIndex-(r.mainIndex>t?1:0))}return null}ns.dragstart=(r,e)=>{let{selection:{main:t}}=r.state;if(e.target.draggable){let i=r.docView.nearest(e.target);if(i&&i.isWidget){let s=i.posAtStart,a=s+i.length;(s>=t.to||a<=t.from)&&(t=Oe.range(s,a))}}let{inputState:n}=r;return n.mouseSelection&&(n.mouseSelection.dragging=!0),n.draggedContent=t,e.dataTransfer&&(e.dataTransfer.setData("Text",R0(r.state,lx,r.state.sliceDoc(t.from,t.to))),e.dataTransfer.effectAllowed="copyMove"),!1};ns.dragend=r=>(r.inputState.draggedContent=null,!1);function Xw(r,e,t,n){if(t=R0(r.state,ox,t),!t)return;let i=r.posAtCoords({x:e.clientX,y:e.clientY},!1),{draggedContent:s}=r.inputState,a=n&&s&&lq(r,e)?{from:s.from,to:s.to}:null,o={from:i,insert:t},l=r.state.changes(a?[a,o]:o);r.focus(),r.dispatch({changes:l,selection:{anchor:l.mapPos(i,-1),head:l.mapPos(i,1)},userEvent:a?"move.drop":"input.drop"}),r.inputState.draggedContent=null}ns.drop=(r,e)=>{if(!e.dataTransfer)return!1;if(r.state.readOnly)return!0;let t=e.dataTransfer.files;if(t&&t.length){let n=Array(t.length),i=0,s=()=>{++i==t.length&&Xw(r,e,n.filter(a=>a!=null).join(r.state.lineBreak),!1)};for(let a=0;a<t.length;a++){let o=new FileReader;o.onerror=s,o.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(o.result)||(n[a]=o.result),s()},o.readAsText(t[a])}return!0}else{let n=e.dataTransfer.getData("Text");if(n)return Xw(r,e,n,!0),!0}return!1};ns.paste=(r,e)=>{if(r.state.readOnly)return!0;r.observer.flush();let t=EA?null:e.clipboardData;return t?(PA(r,t.getData("text/plain")||t.getData("text/uri-list")),!0):(hq(r),!1)};function gq(r,e){let t=r.dom.parentNode;if(!t)return;let n=t.appendChild(document.createElement("textarea"));n.style.cssText="position: fixed; left: -10000px; top: 10px",n.value=e,n.focus(),n.selectionEnd=e.length,n.selectionStart=0,setTimeout(()=>{n.remove(),r.focus()},50)}function Oq(r){let e=[],t=[],n=!1;for(let i of r.selection.ranges)i.empty||(e.push(r.sliceDoc(i.from,i.to)),t.push(i));if(!e.length){let i=-1;for(let{from:s}of r.selection.ranges){let a=r.doc.lineAt(s);a.number>i&&(e.push(a.text),t.push({from:a.from,to:Math.min(r.doc.length,a.to+1)})),i=a.number}n=!0}return{text:R0(r,lx,e.join(r.lineBreak)),ranges:t,linewise:n}}let Tg=null;ns.copy=ns.cut=(r,e)=>{let{text:t,ranges:n,linewise:i}=Oq(r.state);if(!t&&!i)return!1;Tg=i?t:null,e.type=="cut"&&!r.state.readOnly&&r.dispatch({changes:n,scrollIntoView:!0,userEvent:"delete.cut"});let s=EA?null:e.clipboardData;return s?(s.clearData(),s.setData("text/plain",t),!0):(gq(r,t),!1)};const QA=Is.define();function FA(r,e){let t=[];for(let n of r.facet(mA)){let i=n(r,e);i&&t.push(i)}return t?r.update({effects:t,annotations:QA.of(!0)}):null}function $A(r){setTimeout(()=>{let e=r.hasFocus;if(e!=r.inputState.notifiedFocused){let t=FA(r.state,e);t?r.dispatch(t):r.update([])}},10)}Ni.focus=r=>{r.inputState.lastFocusTime=Date.now(),!r.scrollDOM.scrollTop&&(r.inputState.lastScrollTop||r.inputState.lastScrollLeft)&&(r.scrollDOM.scrollTop=r.inputState.lastScrollTop,r.scrollDOM.scrollLeft=r.inputState.lastScrollLeft),$A(r)};Ni.blur=r=>{r.observer.clearSelectionRange(),$A(r)};Ni.compositionstart=Ni.compositionupdate=r=>{r.observer.editContext||(r.inputState.compositionFirstChange==null&&(r.inputState.compositionFirstChange=!0),r.inputState.composing<0&&(r.inputState.composing=0))};Ni.compositionend=r=>{r.observer.editContext||(r.inputState.composing=-1,r.inputState.compositionEndedAt=Date.now(),r.inputState.compositionPendingKey=!0,r.inputState.compositionPendingChange=r.observer.pendingRecords().length>0,r.inputState.compositionFirstChange=null,qe.chrome&&qe.android?r.observer.flushSoon():r.inputState.compositionPendingChange?Promise.resolve().then(()=>r.observer.flush()):setTimeout(()=>{r.inputState.composing<0&&r.docView.hasComposition&&r.update([])},50))};Ni.contextmenu=r=>{r.inputState.lastContextMenu=Date.now()};ns.beforeinput=(r,e)=>{var t,n;if(e.inputType=="insertReplacementText"&&r.observer.editContext){let s=(t=e.dataTransfer)===null||t===void 0?void 0:t.getData("text/plain"),a=e.getTargetRanges();if(s&&a.length){let o=a[0],l=r.posAtDOM(o.startContainer,o.startOffset),f=r.posAtDOM(o.endContainer,o.endOffset);return ux(r,{from:l,to:f,insert:r.state.toText(s)},null),!0}}let i;if(qe.chrome&&qe.android&&(i=CA.find(s=>s.inputType==e.inputType))&&(r.observer.delayAndroidKey(i.key,i.keyCode),i.key=="Backspace"||i.key=="Delete")){let s=((n=window.visualViewport)===null||n===void 0?void 0:n.height)||0;setTimeout(()=>{var a;(((a=window.visualViewport)===null||a===void 0?void 0:a.height)||0)>s+10&&r.hasFocus&&(r.contentDOM.blur(),r.focus())},100)}return qe.ios&&e.inputType=="deleteContentForward"&&r.observer.flushSoon(),qe.safari&&e.inputType=="insertText"&&r.inputState.composing>=0&&setTimeout(()=>Ni.compositionend(r,e),20),!1};const Vw=new Set;function xq(r){Vw.has(r)||(Vw.add(r),r.addEventListener("copy",()=>{}),r.addEventListener("cut",()=>{}))}const qw=["pre-wrap","normal","pre-line","break-spaces"];let Nl=!1;function jw(){Nl=!1}class vq{constructor(e){this.lineWrapping=e,this.doc=Ft.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30}heightForGap(e,t){let n=this.doc.lineAt(t).number-this.doc.lineAt(e).number+1;return this.lineWrapping&&(n+=Math.max(0,Math.ceil((t-e-n*this.lineLength*.5)/this.lineLength))),this.lineHeight*n}heightForLine(e){return this.lineWrapping?(1+Math.max(0,Math.ceil((e-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(e){return this.doc=e,this}mustRefreshForWrapping(e){return qw.indexOf(e)>-1!=this.lineWrapping}mustRefreshForHeights(e){let t=!1;for(let n=0;n<e.length;n++){let i=e[n];i<0?n++:this.heightSamples[Math.floor(i*10)]||(t=!0,this.heightSamples[Math.floor(i*10)]=!0)}return t}refresh(e,t,n,i,s,a){let o=qw.indexOf(e)>-1,l=Math.round(t)!=Math.round(this.lineHeight)||this.lineWrapping!=o;if(this.lineWrapping=o,this.lineHeight=t,this.charWidth=n,this.textHeight=i,this.lineLength=s,l){this.heightSamples={};for(let f=0;f<a.length;f++){let c=a[f];c<0?f++:this.heightSamples[Math.floor(c*10)]=!0}}return l}}class yq{constructor(e,t){this.from=e,this.heights=t,this.index=0}get more(){return this.index<this.heights.length}}class xs{constructor(e,t,n,i,s){this.from=e,this.length=t,this.top=n,this.height=i,this._content=s}get type(){return typeof this._content=="number"?Mn.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof Na?this._content.widget:null}get widgetLineBreaks(){return typeof this._content=="number"?this._content:0}join(e){let t=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(e._content)?e._content:[e]);return new xs(this.from,this.length+e.length,this.top,this.height+e.height,t)}}var ir=function(r){return r[r.ByPos=0]="ByPos",r[r.ByHeight=1]="ByHeight",r[r.ByPosNoHeight=2]="ByPosNoHeight",r}(ir||(ir={}));const Iu=.001;class In{constructor(e,t,n=2){this.length=e,this.height=t,this.flags=n}get outdated(){return(this.flags&2)>0}set outdated(e){this.flags=(e?2:0)|this.flags&-3}setHeight(e){this.height!=e&&(Math.abs(this.height-e)>Iu&&(Nl=!0),this.height=e)}replace(e,t,n){return In.of(n)}decomposeLeft(e,t){t.push(this)}decomposeRight(e,t){t.push(this)}applyChanges(e,t,n,i){let s=this,a=n.doc;for(let o=i.length-1;o>=0;o--){let{fromA:l,toA:f,fromB:c,toB:h}=i[o],u=s.lineAt(l,ir.ByPosNoHeight,n.setDoc(t),0,0),d=u.to>=f?u:s.lineAt(f,ir.ByPosNoHeight,n,0,0);for(h+=d.to-f,f=d.to;o>0&&u.from<=i[o-1].toA;)l=i[o-1].fromA,c=i[o-1].fromB,o--,l<u.from&&(u=s.lineAt(l,ir.ByPosNoHeight,n,0,0));c+=u.from-l,l=u.from;let p=dx.build(n.setDoc(a),e,c,h);s=$d(s,s.replace(l,f,p))}return s.updateHeight(n,0)}static empty(){return new si(0,0)}static of(e){if(e.length==1)return e[0];let t=0,n=e.length,i=0,s=0;for(;;)if(t==n)if(i>s*2){let o=e[t-1];o.break?e.splice(--t,1,o.left,null,o.right):e.splice(--t,1,o.left,o.right),n+=1+o.break,i-=o.size}else if(s>i*2){let o=e[n];o.break?e.splice(n,1,o.left,null,o.right):e.splice(n,1,o.left,o.right),n+=2+o.break,s-=o.size}else break;else if(i<s){let o=e[t++];o&&(i+=o.size)}else{let o=e[--n];o&&(s+=o.size)}let a=0;return e[t-1]==null?(a=1,t--):e[t]==null&&(a=1,n++),new wq(In.of(e.slice(0,t)),a,In.of(e.slice(n)))}}function $d(r,e){return r==e?r:(r.constructor!=e.constructor&&(Nl=!0),e)}In.prototype.size=1;class DA extends In{constructor(e,t,n){super(e,t),this.deco=n}blockAt(e,t,n,i){return new xs(i,this.length,n,this.height,this.deco||0)}lineAt(e,t,n,i,s){return this.blockAt(0,n,i,s)}forEachLine(e,t,n,i,s,a){e<=s+this.length&&t>=s&&a(this.blockAt(0,n,i,s))}updateHeight(e,t=0,n=!1,i){return i&&i.from<=t&&i.more&&this.setHeight(i.heights[i.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class si extends DA{constructor(e,t){super(e,t,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0}blockAt(e,t,n,i){return new xs(i,this.length,n,this.height,this.breaks)}replace(e,t,n){let i=n[0];return n.length==1&&(i instanceof si||i instanceof nn&&i.flags&4)&&Math.abs(this.length-i.length)<10?(i instanceof nn?i=new si(i.length,this.height):i.height=this.height,this.outdated||(i.outdated=!1),i):In.of(n)}updateHeight(e,t=0,n=!1,i){return i&&i.from<=t&&i.more?this.setHeight(i.heights[i.index++]):(n||this.outdated)&&this.setHeight(Math.max(this.widgetHeight,e.heightForLine(this.length-this.collapsed))+this.breaks*e.lineHeight),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class nn extends In{constructor(e){super(e,0)}heightMetrics(e,t){let n=e.doc.lineAt(t).number,i=e.doc.lineAt(t+this.length).number,s=i-n+1,a,o=0;if(e.lineWrapping){let l=Math.min(this.height,e.lineHeight*s);a=l/s,this.length>s+1&&(o=(this.height-l)/(this.length-s-1))}else a=this.height/s;return{firstLine:n,lastLine:i,perLine:a,perChar:o}}blockAt(e,t,n,i){let{firstLine:s,lastLine:a,perLine:o,perChar:l}=this.heightMetrics(t,i);if(t.lineWrapping){let f=i+(e<t.lineHeight?0:Math.round(Math.max(0,Math.min(1,(e-n)/this.height))*this.length)),c=t.doc.lineAt(f),h=o+c.length*l,u=Math.max(n,e-h/2);return new xs(c.from,c.length,u,h,0)}else{let f=Math.max(0,Math.min(a-s,Math.floor((e-n)/o))),{from:c,length:h}=t.doc.line(s+f);return new xs(c,h,n+o*f,o,0)}}lineAt(e,t,n,i,s){if(t==ir.ByHeight)return this.blockAt(e,n,i,s);if(t==ir.ByPosNoHeight){let{from:d,to:p}=n.doc.lineAt(e);return new xs(d,p-d,0,0,0)}let{firstLine:a,perLine:o,perChar:l}=this.heightMetrics(n,s),f=n.doc.lineAt(e),c=o+f.length*l,h=f.number-a,u=i+o*h+l*(f.from-s-h);return new xs(f.from,f.length,Math.max(i,Math.min(u,i+this.height-c)),c,0)}forEachLine(e,t,n,i,s,a){e=Math.max(e,s),t=Math.min(t,s+this.length);let{firstLine:o,perLine:l,perChar:f}=this.heightMetrics(n,s);for(let c=e,h=i;c<=t;){let u=n.doc.lineAt(c);if(c==e){let p=u.number-o;h+=l*p+f*(e-s-p)}let d=l+f*u.length;a(new xs(u.from,u.length,h,d,0)),h+=d,c=u.to+1}}replace(e,t,n){let i=this.length-t;if(i>0){let s=n[n.length-1];s instanceof nn?n[n.length-1]=new nn(s.length+i):n.push(null,new nn(i-1))}if(e>0){let s=n[0];s instanceof nn?n[0]=new nn(e+s.length):n.unshift(new nn(e-1),null)}return In.of(n)}decomposeLeft(e,t){t.push(new nn(e-1),null)}decomposeRight(e,t){t.push(null,new nn(this.length-e-1))}updateHeight(e,t=0,n=!1,i){let s=t+this.length;if(i&&i.from<=t+this.length&&i.more){let a=[],o=Math.max(t,i.from),l=-1;for(i.from>t&&a.push(new nn(i.from-t-1).updateHeight(e,t));o<=s&&i.more;){let c=e.doc.lineAt(o).length;a.length&&a.push(null);let h=i.heights[i.index++];l==-1?l=h:Math.abs(h-l)>=Iu&&(l=-2);let u=new si(c,h);u.outdated=!1,a.push(u),o+=c+1}o<=s&&a.push(null,new nn(s-o).updateHeight(e,o));let f=In.of(a);return(l<0||Math.abs(f.height-this.height)>=Iu||Math.abs(l-this.heightMetrics(e,t).perLine)>=Iu)&&(Nl=!0),$d(this,f)}else(n||this.outdated)&&(this.setHeight(e.heightForGap(t,t+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}}class wq extends In{constructor(e,t,n){super(e.length+t+n.length,e.height+n.height,t|(e.outdated||n.outdated?2:0)),this.left=e,this.right=n,this.size=e.size+n.size}get break(){return this.flags&1}blockAt(e,t,n,i){let s=n+this.left.height;return e<s?this.left.blockAt(e,t,n,i):this.right.blockAt(e,t,s,i+this.left.length+this.break)}lineAt(e,t,n,i,s){let a=i+this.left.height,o=s+this.left.length+this.break,l=t==ir.ByHeight?e<a:e<o,f=l?this.left.lineAt(e,t,n,i,s):this.right.lineAt(e,t,n,a,o);if(this.break||(l?f.to<o:f.from>o))return f;let c=t==ir.ByPosNoHeight?ir.ByPosNoHeight:ir.ByPos;return l?f.join(this.right.lineAt(o,c,n,a,o)):this.left.lineAt(o,c,n,i,s).join(f)}forEachLine(e,t,n,i,s,a){let o=i+this.left.height,l=s+this.left.length+this.break;if(this.break)e<l&&this.left.forEachLine(e,t,n,i,s,a),t>=l&&this.right.forEachLine(e,t,n,o,l,a);else{let f=this.lineAt(l,ir.ByPos,n,i,s);e<f.from&&this.left.forEachLine(e,f.from-1,n,i,s,a),f.to>=e&&f.from<=t&&a(f),t>f.to&&this.right.forEachLine(f.to+1,t,n,o,l,a)}}replace(e,t,n){let i=this.left.length+this.break;if(t<i)return this.balanced(this.left.replace(e,t,n),this.right);if(e>this.left.length)return this.balanced(this.left,this.right.replace(e-i,t-i,n));let s=[];e>0&&this.decomposeLeft(e,s);let a=s.length;for(let o of n)s.push(o);if(e>0&&zw(s,a-1),t<this.length){let o=s.length;this.decomposeRight(t,s),zw(s,o)}return In.of(s)}decomposeLeft(e,t){let n=this.left.length;if(e<=n)return this.left.decomposeLeft(e,t);t.push(this.left),this.break&&(n++,e>=n&&t.push(null)),e>n&&this.right.decomposeLeft(e-n,t)}decomposeRight(e,t){let n=this.left.length,i=n+this.break;if(e>=i)return this.right.decomposeRight(e-i,t);e<n&&this.left.decomposeRight(e,t),this.break&&e<i&&t.push(null),t.push(this.right)}balanced(e,t){return e.size>2*t.size||t.size>2*e.size?In.of(this.break?[e,null,t]:[e,t]):(this.left=$d(this.left,e),this.right=$d(this.right,t),this.setHeight(e.height+t.height),this.outdated=e.outdated||t.outdated,this.size=e.size+t.size,this.length=e.length+this.break+t.length,this)}updateHeight(e,t=0,n=!1,i){let{left:s,right:a}=this,o=t+s.length+this.break,l=null;return i&&i.from<=t+s.length&&i.more?l=s=s.updateHeight(e,t,n,i):s.updateHeight(e,t,n),i&&i.from<=o+a.length&&i.more?l=a=a.updateHeight(e,o,n,i):a.updateHeight(e,o,n),l?this.balanced(s,a):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function zw(r,e){let t,n;r[e]==null&&(t=r[e-1])instanceof nn&&(n=r[e+1])instanceof nn&&r.splice(e-1,3,new nn(t.length+1+n.length))}const bq=5;class dx{constructor(e,t){this.pos=e,this.oracle=t,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=e}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(e,t){if(this.lineStart>-1){let n=Math.min(t,this.lineEnd),i=this.nodes[this.nodes.length-1];i instanceof si?i.length+=n-this.pos:(n>this.pos||!this.isCovered)&&this.nodes.push(new si(n-this.pos,-1)),this.writtenTo=n,t>n&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=t}point(e,t,n){if(e<t||n.heightRelevant){let i=n.widget?n.widget.estimatedHeight:0,s=n.widget?n.widget.lineBreaks:0;i<0&&(i=this.oracle.lineHeight);let a=t-e;n.block?this.addBlock(new DA(a,i,n)):(a||s||i>=bq)&&this.addLineDeco(i,s,a)}else t>e&&this.span(e,t);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:e,to:t}=this.oracle.doc.lineAt(this.pos);this.lineStart=e,this.lineEnd=t,this.writtenTo<e&&((this.writtenTo<e-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,e-1)),this.nodes.push(null)),this.pos>e&&this.nodes.push(new si(this.pos-e,-1)),this.writtenTo=this.pos}blankContent(e,t){let n=new nn(t-e);return this.oracle.doc.lineAt(e).to==t&&(n.flags|=4),n}ensureLine(){this.enterLine();let e=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(e instanceof si)return e;let t=new si(0,-1);return this.nodes.push(t),t}addBlock(e){this.enterLine();let t=e.deco;t&&t.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(e),this.writtenTo=this.pos=this.pos+e.length,t&&t.endSide>0&&(this.covering=e)}addLineDeco(e,t,n){let i=this.ensureLine();i.length+=n,i.collapsed+=n,i.widgetHeight=Math.max(i.widgetHeight,e),i.breaks+=t,this.writtenTo=this.pos=this.pos+n}finish(e){let t=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(t instanceof si)&&!this.isCovered?this.nodes.push(new si(0,-1)):(this.writtenTo<this.pos||t==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let n=e;for(let i of this.nodes)i instanceof si&&i.updateHeight(this.oracle,n),n+=i?i.length:1;return this.nodes}static build(e,t,n,i){let s=new dx(n,e);return Ct.spans(t,n,i,s,0),s.finish(n)}}function _q(r,e,t){let n=new kq;return Ct.compare(r,e,t,n,0),n.changes}class kq{constructor(){this.changes=[]}compareRange(){}comparePoint(e,t,n,i){(e<t||n&&n.heightRelevant||i&&i.heightRelevant)&&Nu(e,t,this.changes,5)}}function Sq(r,e){let t=r.getBoundingClientRect(),n=r.ownerDocument,i=n.defaultView||window,s=Math.max(0,t.left),a=Math.min(i.innerWidth,t.right),o=Math.max(0,t.top),l=Math.min(i.innerHeight,t.bottom);for(let f=r.parentNode;f&&f!=n.body;)if(f.nodeType==1){let c=f,h=window.getComputedStyle(c);if((c.scrollHeight>c.clientHeight||c.scrollWidth>c.clientWidth)&&h.overflow!="visible"){let u=c.getBoundingClientRect();s=Math.max(s,u.left),a=Math.min(a,u.right),o=Math.max(o,u.top),l=Math.min(f==r.parentNode?i.innerHeight:l,u.bottom)}f=h.position=="absolute"||h.position=="fixed"?c.offsetParent:c.parentNode}else if(f.nodeType==11)f=f.host;else break;return{left:s-t.left,right:Math.max(s,a)-t.left,top:o-(t.top+e),bottom:Math.max(o,l)-(t.top+e)}}function Tq(r){let e=r.getBoundingClientRect(),t=r.ownerDocument.defaultView||window;return e.left<t.innerWidth&&e.right>0&&e.top<t.innerHeight&&e.bottom>0}function Cq(r,e){let t=r.getBoundingClientRect();return{left:0,right:t.right-t.left,top:e,bottom:t.bottom-(t.top+e)}}class kp{constructor(e,t,n,i){this.from=e,this.to=t,this.size=n,this.displaySize=i}static same(e,t){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++){let i=e[n],s=t[n];if(i.from!=s.from||i.to!=s.to||i.size!=s.size)return!1}return!0}draw(e,t){return je.replace({widget:new Aq(this.displaySize*(t?e.scaleY:e.scaleX),t)}).range(this.from,this.to)}}class Aq extends aa{constructor(e,t){super(),this.size=e,this.vertical=t}eq(e){return e.size==this.size&&e.vertical==this.vertical}toDOM(){let e=document.createElement("div");return this.vertical?e.style.height=this.size+"px":(e.style.width=this.size+"px",e.style.height="2px",e.style.display="inline-block"),e}get estimatedHeight(){return this.vertical?this.size:-1}}class Gw{constructor(e){this.state=e,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!1,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=Hw,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=Et.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let t=e.facet(fx).some(n=>typeof n!="function"&&n.class=="cm-lineWrapping");this.heightOracle=new vq(t),this.stateDeco=e.facet(Lc).filter(n=>typeof n!="function"),this.heightMap=In.empty().applyChanges(this.stateDeco,Ft.empty,this.heightOracle.setDoc(e.doc),[new $i(0,0,0,e.doc.length)]);for(let n=0;n<2&&(this.viewport=this.getViewport(0,null),!!this.updateForViewport());n++);this.updateViewportLines(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=je.set(this.lineGaps.map(n=>n.draw(this,!1))),this.computeVisibleRanges()}updateForViewport(){let e=[this.viewport],{main:t}=this.state.selection;for(let n=0;n<=1;n++){let i=n?t.head:t.anchor;if(!e.some(({from:s,to:a})=>i>=s&&i<=a)){let{from:s,to:a}=this.lineBlockAt(i);e.push(new tu(s,a))}}return this.viewports=e.sort((n,i)=>n.from-i.from),this.updateScaler()}updateScaler(){let e=this.scaler;return this.scaler=this.heightMap.height<=7e6?Hw:new px(this.heightOracle,this.heightMap,this.viewports),e.eq(this.scaler)?0:2}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,e=>{this.viewportLines.push(Bf(e,this.scaler))})}update(e,t=null){this.state=e.state;let n=this.stateDeco;this.stateDeco=this.state.facet(Lc).filter(c=>typeof c!="function");let i=e.changedRanges,s=$i.extendWithRanges(i,_q(n,this.stateDeco,e?e.changes:Wr.empty(this.state.doc.length))),a=this.heightMap.height,o=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);jw(),this.heightMap=this.heightMap.applyChanges(this.stateDeco,e.startState.doc,this.heightOracle.setDoc(this.state.doc),s),(this.heightMap.height!=a||Nl)&&(e.flags|=2),o?(this.scrollAnchorPos=e.changes.mapPos(o.from,-1),this.scrollAnchorHeight=o.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=this.heightMap.height);let l=s.length?this.mapViewport(this.viewport,e.changes):this.viewport;(t&&(t.range.head<l.from||t.range.head>l.to)||!this.viewportIsAppropriate(l))&&(l=this.getViewport(0,t));let f=l.from!=this.viewport.from||l.to!=this.viewport.to;this.viewport=l,e.flags|=this.updateForViewport(),(f||!e.changes.empty||e.flags&2)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,e.changes))),e.flags|=this.computeVisibleRanges(e.changes),t&&(this.scrollTarget=t),!this.mustEnforceCursorAssoc&&e.selectionSet&&e.view.lineWrapping&&e.state.selection.main.empty&&e.state.selection.main.assoc&&!e.state.facet(OA)&&(this.mustEnforceCursorAssoc=!0)}measure(e){let t=e.contentDOM,n=window.getComputedStyle(t),i=this.heightOracle,s=n.whiteSpace;this.defaultTextDirection=n.direction=="rtl"?Et.RTL:Et.LTR;let a=this.heightOracle.mustRefreshForWrapping(s),o=t.getBoundingClientRect(),l=a||this.mustMeasureContent||this.contentDOMHeight!=o.height;this.contentDOMHeight=o.height,this.mustMeasureContent=!1;let f=0,c=0;if(o.width&&o.height){let{scaleX:S,scaleY:y}=XC(t,o);(S>.005&&Math.abs(this.scaleX-S)>.005||y>.005&&Math.abs(this.scaleY-y)>.005)&&(this.scaleX=S,this.scaleY=y,f|=16,a=l=!0)}let h=(parseInt(n.paddingTop)||0)*this.scaleY,u=(parseInt(n.paddingBottom)||0)*this.scaleY;(this.paddingTop!=h||this.paddingBottom!=u)&&(this.paddingTop=h,this.paddingBottom=u,f|=18),this.editorWidth!=e.scrollDOM.clientWidth&&(i.lineWrapping&&(l=!0),this.editorWidth=e.scrollDOM.clientWidth,f|=16);let d=e.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=d&&(this.scrollAnchorHeight=-1,this.scrollTop=d),this.scrolledToBottom=jC(e.scrollDOM);let p=(this.printing?Cq:Sq)(t,this.paddingTop),m=p.top-this.pixelViewport.top,g=p.bottom-this.pixelViewport.bottom;this.pixelViewport=p;let O=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(O!=this.inView&&(this.inView=O,O&&(l=!0)),!this.inView&&!this.scrollTarget&&!Tq(e.dom))return 0;let w=o.width;if((this.contentDOMWidth!=w||this.editorHeight!=e.scrollDOM.clientHeight)&&(this.contentDOMWidth=o.width,this.editorHeight=e.scrollDOM.clientHeight,f|=16),l){let S=e.docView.measureVisibleLineHeights(this.viewport);if(i.mustRefreshForHeights(S)&&(a=!0),a||i.lineWrapping&&Math.abs(w-this.contentDOMWidth)>i.charWidth){let{lineHeight:y,charWidth:b,textHeight:x}=e.docView.measureTextSize();a=y>0&&i.refresh(s,y,b,x,w/b,S),a&&(e.docView.minWidth=0,f|=16)}m>0&&g>0?c=Math.max(m,g):m<0&&g<0&&(c=Math.min(m,g)),jw();for(let y of this.viewports){let b=y.from==this.viewport.from?S:e.docView.measureVisibleLineHeights(y);this.heightMap=(a?In.empty().applyChanges(this.stateDeco,Ft.empty,this.heightOracle,[new $i(0,0,0,e.state.doc.length)]):this.heightMap).updateHeight(i,0,a,new yq(y.from,b))}Nl&&(f|=2)}let v=!this.viewportIsAppropriate(this.viewport,c)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return v&&(f&2&&(f|=this.updateScaler()),this.viewport=this.getViewport(c,this.scrollTarget),f|=this.updateForViewport()),(f&2||v)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(a?[]:this.lineGaps,e)),f|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,e.docView.enforceCursorAssoc()),f}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(e,t){let n=.5-Math.max(-.5,Math.min(.5,e/1e3/2)),i=this.heightMap,s=this.heightOracle,{visibleTop:a,visibleBottom:o}=this,l=new tu(i.lineAt(a-n*1e3,ir.ByHeight,s,0,0).from,i.lineAt(o+(1-n)*1e3,ir.ByHeight,s,0,0).to);if(t){let{head:f}=t.range;if(f<l.from||f>l.to){let c=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),h=i.lineAt(f,ir.ByPos,s,0,0),u;t.y=="center"?u=(h.top+h.bottom)/2-c/2:t.y=="start"||t.y=="nearest"&&f<l.from?u=h.top:u=h.bottom-c,l=new tu(i.lineAt(u-1e3/2,ir.ByHeight,s,0,0).from,i.lineAt(u+c+1e3/2,ir.ByHeight,s,0,0).to)}}return l}mapViewport(e,t){let n=t.mapPos(e.from,-1),i=t.mapPos(e.to,1);return new tu(this.heightMap.lineAt(n,ir.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(i,ir.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:e,to:t},n=0){if(!this.inView)return!0;let{top:i}=this.heightMap.lineAt(e,ir.ByPos,this.heightOracle,0,0),{bottom:s}=this.heightMap.lineAt(t,ir.ByPos,this.heightOracle,0,0),{visibleTop:a,visibleBottom:o}=this;return(e==0||i<=a-Math.max(10,Math.min(-n,250)))&&(t==this.state.doc.length||s>=o+Math.max(10,Math.min(n,250)))&&i>a-2*1e3&&s<o+2*1e3}mapLineGaps(e,t){if(!e.length||t.empty)return e;let n=[];for(let i of e)t.touchesRange(i.from,i.to)||n.push(new kp(t.mapPos(i.from),t.mapPos(i.to),i.size,i.displaySize));return n}ensureLineGaps(e,t){let n=this.heightOracle.lineWrapping,i=n?1e4:2e3,s=i>>1,a=i<<1;if(this.defaultTextDirection!=Et.LTR&&!n)return[];let o=[],l=(c,h,u,d)=>{if(h-c<s)return;let p=this.state.selection.main,m=[p.from];p.empty||m.push(p.to);for(let O of m)if(O>c&&O<h){l(c,O-10,u,d),l(O+10,h,u,d);return}let g=Pq(e,O=>O.from>=u.from&&O.to<=u.to&&Math.abs(O.from-c)<s&&Math.abs(O.to-h)<s&&!m.some(w=>O.from<w&&O.to>w));if(!g){if(h<u.to&&t&&n&&t.visibleRanges.some(v=>v.from<=h&&v.to>=h)){let v=t.moveToLineBoundary(Oe.cursor(h),!1,!0).head;v>c&&(h=v)}let O=this.gapSize(u,c,h,d),w=n||O<2e6?O:2e6;g=new kp(c,h,O,w)}o.push(g)},f=c=>{if(c.length<a||c.type!=Mn.Text)return;let h=Eq(c.from,c.to,this.stateDeco);if(h.total<a)return;let u=this.scrollTarget?this.scrollTarget.range.head:null,d,p;if(n){let m=i/this.heightOracle.lineLength*this.heightOracle.lineHeight,g,O;if(u!=null){let w=nu(h,u),v=((this.visibleBottom-this.visibleTop)/2+m)/c.height;g=w-v,O=w+v}else g=(this.visibleTop-c.top-m)/c.height,O=(this.visibleBottom-c.top+m)/c.height;d=ru(h,g),p=ru(h,O)}else{let m=h.total*this.heightOracle.charWidth,g=i*this.heightOracle.charWidth,O=0;if(m>2e6)for(let b of e)b.from>=c.from&&b.from<c.to&&b.size!=b.displaySize&&b.from*this.heightOracle.charWidth+O<this.pixelViewport.left&&(O=b.size-b.displaySize);let w=this.pixelViewport.left+O,v=this.pixelViewport.right+O,S,y;if(u!=null){let b=nu(h,u),x=((v-w)/2+g)/m;S=b-x,y=b+x}else S=(w-g)/m,y=(v+g)/m;d=ru(h,S),p=ru(h,y)}d>c.from&&l(c.from,d,c,h),p<c.to&&l(p,c.to,c,h)};for(let c of this.viewportLines)Array.isArray(c.type)?c.type.forEach(f):f(c);return o}gapSize(e,t,n,i){let s=nu(i,n)-nu(i,t);return this.heightOracle.lineWrapping?e.height*s:i.total*this.heightOracle.charWidth*s}updateLineGaps(e){kp.same(e,this.lineGaps)||(this.lineGaps=e,this.lineGapDeco=je.set(e.map(t=>t.draw(this,this.heightOracle.lineWrapping))))}computeVisibleRanges(e){let t=this.stateDeco;this.lineGaps.length&&(t=t.concat(this.lineGapDeco));let n=[];Ct.spans(t,this.viewport.from,this.viewport.to,{span(s,a){n.push({from:s,to:a})},point(){}},20);let i=0;if(n.length!=this.visibleRanges.length)i=12;else for(let s=0;s<n.length&&!(i&8);s++){let a=this.visibleRanges[s],o=n[s];(a.from!=o.from||a.to!=o.to)&&(i|=4,e&&e.mapPos(a.from,-1)==o.from&&e.mapPos(a.to,1)==o.to||(i|=8))}return this.visibleRanges=n,i}lineBlockAt(e){return e>=this.viewport.from&&e<=this.viewport.to&&this.viewportLines.find(t=>t.from<=e&&t.to>=e)||Bf(this.heightMap.lineAt(e,ir.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(e){return e>=this.viewportLines[0].top&&e<=this.viewportLines[this.viewportLines.length-1].bottom&&this.viewportLines.find(t=>t.top<=e&&t.bottom>=e)||Bf(this.heightMap.lineAt(this.scaler.fromDOM(e),ir.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(e){let t=this.lineBlockAtHeight(e+8);return t.from>=this.viewport.from||this.viewportLines[0].top-e>200?t:this.viewportLines[0]}elementAtHeight(e){return Bf(this.heightMap.blockAt(this.scaler.fromDOM(e),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class tu{constructor(e,t){this.from=e,this.to=t}}function Eq(r,e,t){let n=[],i=r,s=0;return Ct.spans(t,r,e,{span(){},point(a,o){a>i&&(n.push({from:i,to:a}),s+=a-i),i=o}},20),i<e&&(n.push({from:i,to:e}),s+=e-i),{total:s,ranges:n}}function ru({total:r,ranges:e},t){if(t<=0)return e[0].from;if(t>=1)return e[e.length-1].to;let n=Math.floor(r*t);for(let i=0;;i++){let{from:s,to:a}=e[i],o=a-s;if(n<=o)return s+n;n-=o}}function nu(r,e){let t=0;for(let{from:n,to:i}of r.ranges){if(e<=i){t+=e-n;break}t+=i-n}return t/r.total}function Pq(r,e){for(let t of r)if(e(t))return t}const Hw={toDOM(r){return r},fromDOM(r){return r},scale:1,eq(r){return r==this}};class px{constructor(e,t,n){let i=0,s=0,a=0;this.viewports=n.map(({from:o,to:l})=>{let f=t.lineAt(o,ir.ByPos,e,0,0).top,c=t.lineAt(l,ir.ByPos,e,0,0).bottom;return i+=c-f,{from:o,to:l,top:f,bottom:c,domTop:0,domBottom:0}}),this.scale=(7e6-i)/(t.height-i);for(let o of this.viewports)o.domTop=a+(o.top-s)*this.scale,a=o.domBottom=o.domTop+(o.bottom-o.top),s=o.bottom}toDOM(e){for(let t=0,n=0,i=0;;t++){let s=t<this.viewports.length?this.viewports[t]:null;if(!s||e<s.top)return i+(e-n)*this.scale;if(e<=s.bottom)return s.domTop+(e-s.top);n=s.bottom,i=s.domBottom}}fromDOM(e){for(let t=0,n=0,i=0;;t++){let s=t<this.viewports.length?this.viewports[t]:null;if(!s||e<s.domTop)return n+(e-i)/this.scale;if(e<=s.domBottom)return s.top+(e-s.domTop);n=s.bottom,i=s.domBottom}}eq(e){return e instanceof px?this.scale==e.scale&&this.viewports.length==e.viewports.length&&this.viewports.every((t,n)=>t.from==e.viewports[n].from&&t.to==e.viewports[n].to):!1}}function Bf(r,e){if(e.scale==1)return r;let t=e.toDOM(r.top),n=e.toDOM(r.bottom);return new xs(r.from,r.length,t,n-t,Array.isArray(r._content)?r._content.map(i=>Bf(i,e)):r._content)}const iu=Ze.define({combine:r=>r.join(" ")}),Cg=Ze.define({combine:r=>r.indexOf(!0)>-1}),Ag=An.newName(),NA=An.newName(),MA=An.newName(),IA={"&light":"."+NA,"&dark":"."+MA};function Eg(r,e,t){return new An(e,{finish(n){return/&/.test(n)?n.replace(/&\w*/,i=>{if(i=="&")return r;if(!t||!t[i])throw new RangeError(`Unsupported selector: ${i}`);return t[i]}):r+" "+n}})}const Rq=Eg("."+Ag,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0,overflowAnchor:"none"},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#ddd"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",insetInlineStart:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0,zIndex:300},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top"},".cm-highlightSpace":{backgroundImage:"radial-gradient(circle at 50% 55%, #aaa 20%, transparent 5%)",backgroundPosition:"center"},".cm-highlightTab":{backgroundImage:`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>')`,backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},IA),Qq={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},Sp=qe.ie&&qe.ie_version<=11;class Fq{constructor(e){this.view=e,this.active=!1,this.editContext=null,this.selectionRange=new gV,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.printQuery=null,this.parentCheck=-1,this.dom=e.contentDOM,this.observer=new MutationObserver(t=>{for(let n of t)this.queue.push(n);(qe.ie&&qe.ie_version<=11||qe.ios&&e.composing)&&t.some(n=>n.type=="childList"&&n.removedNodes.length||n.type=="characterData"&&n.oldValue.length>n.target.nodeValue.length)?this.flushSoon():this.flush()}),window.EditContext&&e.constructor.EDIT_CONTEXT!==!1&&!(qe.chrome&&qe.chrome_version<126)&&(this.editContext=new Dq(e),e.state.facet(Xs)&&(e.contentDOM.editContext=this.editContext.editContext)),Sp&&(this.onCharData=t=>{this.queue.push({target:t.target,type:"characterData",oldValue:t.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),window.matchMedia&&(this.printQuery=window.matchMedia("print")),typeof ResizeObserver=="function"&&(this.resizeScroll=new ResizeObserver(()=>{var t;((t=this.view.docView)===null||t===void 0?void 0:t.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(e.scrollDOM)),this.addWindowListeners(this.win=e.win),this.start(),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(t=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),t.length>0&&t[t.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(t=>{t.length>0&&t[t.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(e){this.view.inputState.runHandlers("scroll",e),this.intersecting&&this.view.measure()}onScroll(e){this.intersecting&&this.flush(!1),this.editContext&&this.view.requestMeasure(this.editContext.measureReq),this.onScrollChanged(e)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(e){(e.type=="change"||!e.type)&&!e.matches||(this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500))}updateGaps(e){if(this.gapIntersection&&(e.length!=this.gaps.length||this.gaps.some((t,n)=>t!=e[n]))){this.gapIntersection.disconnect();for(let t of e)this.gapIntersection.observe(t);this.gaps=e}}onSelectionChange(e){let t=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:n}=this,i=this.selectionRange;if(n.state.facet(Xs)?n.root.activeElement!=this.dom:!Du(this.dom,i))return;let s=i.anchorNode&&n.docView.nearest(i.anchorNode);if(s&&s.ignoreEvent(e)){t||(this.selectionChanged=!1);return}(qe.ie&&qe.ie_version<=11||qe.android&&qe.chrome)&&!n.state.selection.main.empty&&i.focusNode&&cc(i.focusNode,i.focusOffset,i.anchorNode,i.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:e}=this,t=Mc(e.root);if(!t)return!1;let n=qe.safari&&e.root.nodeType==11&&e.root.activeElement==this.dom&&$q(this.view,t)||t;if(!n||this.selectionRange.eq(n))return!1;let i=Du(this.dom,n);return i&&!this.selectionChanged&&e.inputState.lastFocusTime>Date.now()-200&&e.inputState.lastTouchTime<Date.now()-300&&xV(this.dom,n)?(this.view.inputState.lastFocusTime=0,e.docView.updateSelection(),!1):(this.selectionRange.setRange(n),i&&(this.selectionChanged=!0),!0)}setSelectionRange(e,t){this.selectionRange.set(e.node,e.offset,t.node,t.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let e=0,t=null;for(let n=this.dom;n;)if(n.nodeType==1)!t&&e<this.scrollTargets.length&&this.scrollTargets[e]==n?e++:t||(t=this.scrollTargets.slice(0,e)),t&&t.push(n),n=n.assignedSlot||n.parentNode;else if(n.nodeType==11)n=n.host;else break;if(e<this.scrollTargets.length&&!t&&(t=this.scrollTargets.slice(0,e)),t){for(let n of this.scrollTargets)n.removeEventListener("scroll",this.onScroll);for(let n of this.scrollTargets=t)n.addEventListener("scroll",this.onScroll)}}ignore(e){if(!this.active)return e();try{return this.stop(),e()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,Qq),Sp&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),Sp&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(e,t){var n;if(!this.delayedAndroidKey){let i=()=>{let s=this.delayedAndroidKey;s&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=s.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&s.force&&vl(this.dom,s.key,s.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(i)}(!this.delayedAndroidKey||e=="Enter")&&(this.delayedAndroidKey={key:e,keyCode:t,force:this.lastChange<Date.now()-50||!!(!((n=this.delayedAndroidKey)===null||n===void 0)&&n.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}processRecords(){let e=this.pendingRecords();e.length&&(this.queue=[]);let t=-1,n=-1,i=!1;for(let s of e){let a=this.readMutation(s);a&&(a.typeOver&&(i=!0),t==-1?{from:t,to:n}=a:(t=Math.min(a.from,t),n=Math.max(a.to,n)))}return{from:t,to:n,typeOver:i}}readChange(){let{from:e,to:t,typeOver:n}=this.processRecords(),i=this.selectionChanged&&Du(this.dom,this.selectionRange);if(e<0&&!i)return null;e>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let s=new YV(this.view,e,t,n);return this.view.docView.domChanged={newSel:s.newSel?s.newSel.main:null},s}flush(e=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;e&&this.readSelectionRange();let t=this.readChange();if(!t)return this.view.requestMeasure(),!1;let n=this.view.state,i=TA(this.view,t);return this.view.state==n&&(t.domChanged||t.newSel&&!t.newSel.main.eq(this.view.state.selection.main))&&this.view.update([]),i}readMutation(e){let t=this.view.docView.nearest(e.target);if(!t||t.ignoreMutation(e))return null;if(t.markDirty(e.type=="attributes"),e.type=="attributes"&&(t.flags|=4),e.type=="childList"){let n=Yw(t,e.previousSibling||e.target.previousSibling,-1),i=Yw(t,e.nextSibling||e.target.nextSibling,1);return{from:n?t.posAfter(n):t.posAtStart,to:i?t.posBefore(i):t.posAtEnd,typeOver:!1}}else return e.type=="characterData"?{from:t.posAtStart,to:t.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}:null}setWindow(e){e!=this.win&&(this.removeWindowListeners(this.win),this.win=e,this.addWindowListeners(this.win))}addWindowListeners(e){e.addEventListener("resize",this.onResize),this.printQuery?this.printQuery.addEventListener?this.printQuery.addEventListener("change",this.onPrint):this.printQuery.addListener(this.onPrint):e.addEventListener("beforeprint",this.onPrint),e.addEventListener("scroll",this.onScroll),e.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(e){e.removeEventListener("scroll",this.onScroll),e.removeEventListener("resize",this.onResize),this.printQuery?this.printQuery.removeEventListener?this.printQuery.removeEventListener("change",this.onPrint):this.printQuery.removeListener(this.onPrint):e.removeEventListener("beforeprint",this.onPrint),e.document.removeEventListener("selectionchange",this.onSelectionChange)}update(e){this.editContext&&(this.editContext.update(e),e.startState.facet(Xs)!=e.state.facet(Xs)&&(e.view.contentDOM.editContext=e.state.facet(Xs)?this.editContext.editContext:null))}destroy(){var e,t,n;this.stop(),(e=this.intersection)===null||e===void 0||e.disconnect(),(t=this.gapIntersection)===null||t===void 0||t.disconnect(),(n=this.resizeScroll)===null||n===void 0||n.disconnect();for(let i of this.scrollTargets)i.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey),this.editContext&&(this.view.contentDOM.editContext=null,this.editContext.destroy())}}function Yw(r,e,t){for(;e;){let n=qt.get(e);if(n&&n.parent==r)return n;let i=e.parentNode;e=i!=r.dom?i:t>0?e.nextSibling:e.previousSibling}return null}function Kw(r,e){let t=e.startContainer,n=e.startOffset,i=e.endContainer,s=e.endOffset,a=r.docView.domAtPos(r.state.selection.main.anchor);return cc(a.node,a.offset,i,s)&&([t,n,i,s]=[i,s,t,n]),{anchorNode:t,anchorOffset:n,focusNode:i,focusOffset:s}}function $q(r,e){if(e.getComposedRanges){let i=e.getComposedRanges(r.root)[0];if(i)return Kw(r,i)}let t=null;function n(i){i.preventDefault(),i.stopImmediatePropagation(),t=i.getTargetRanges()[0]}return r.contentDOM.addEventListener("beforeinput",n,!0),r.dom.ownerDocument.execCommand("indent"),r.contentDOM.removeEventListener("beforeinput",n,!0),t?Kw(r,t):null}class Dq{constructor(e){this.from=0,this.to=0,this.pendingContextChange=null,this.handlers=Object.create(null),this.composing=null,this.resetRange(e.state);let t=this.editContext=new window.EditContext({text:e.state.doc.sliceString(this.from,this.to),selectionStart:this.toContextPos(Math.max(this.from,Math.min(this.to,e.state.selection.main.anchor))),selectionEnd:this.toContextPos(e.state.selection.main.head)});this.handlers.textupdate=n=>{let i=e.state.selection.main,{anchor:s,head:a}=i,o=this.toEditorPos(n.updateRangeStart),l=this.toEditorPos(n.updateRangeEnd);e.inputState.composing>=0&&!this.composing&&(this.composing={contextBase:n.updateRangeStart,editorBase:o,drifted:!1});let f={from:o,to:l,insert:Ft.of(n.text.split(`
`))};if(f.from==this.from&&s<this.from?f.from=s:f.to==this.to&&s>this.to&&(f.to=s),f.from==f.to&&!f.insert.length){let c=Oe.single(this.toEditorPos(n.selectionStart),this.toEditorPos(n.selectionEnd));c.main.eq(i)||e.dispatch({selection:c,userEvent:"select"});return}if((qe.mac||qe.android)&&f.from==a-1&&/^\. ?$/.test(n.text)&&e.contentDOM.getAttribute("autocorrect")=="off"&&(f={from:o,to:l,insert:Ft.of([n.text.replace("."," ")])}),this.pendingContextChange=f,!e.state.readOnly){let c=this.to-this.from+(f.to-f.from+f.insert.length);ux(e,f,Oe.single(this.toEditorPos(n.selectionStart,c),this.toEditorPos(n.selectionEnd,c)))}this.pendingContextChange&&(this.revertPending(e.state),this.setSelection(e.state))},this.handlers.characterboundsupdate=n=>{let i=[],s=null;for(let a=this.toEditorPos(n.rangeStart),o=this.toEditorPos(n.rangeEnd);a<o;a++){let l=e.coordsForChar(a);s=l&&new DOMRect(l.left,l.top,l.right-l.left,l.bottom-l.top)||s||new DOMRect,i.push(s)}t.updateCharacterBounds(n.rangeStart,i)},this.handlers.textformatupdate=n=>{let i=[];for(let s of n.getTextFormats()){let a=s.underlineStyle,o=s.underlineThickness;if(a!="None"&&o!="None"){let l=this.toEditorPos(s.rangeStart),f=this.toEditorPos(s.rangeEnd);if(l<f){let c=`text-decoration: underline ${a=="Dashed"?"dashed ":a=="Squiggle"?"wavy ":""}${o=="Thin"?1:2}px`;i.push(je.mark({attributes:{style:c}}).range(l,f))}}}e.dispatch({effects:vA.of(je.set(i))})},this.handlers.compositionstart=()=>{e.inputState.composing<0&&(e.inputState.composing=0,e.inputState.compositionFirstChange=!0)},this.handlers.compositionend=()=>{if(e.inputState.composing=-1,e.inputState.compositionFirstChange=null,this.composing){let{drifted:n}=this.composing;this.composing=null,n&&this.reset(e.state)}};for(let n in this.handlers)t.addEventListener(n,this.handlers[n]);this.measureReq={read:n=>{this.editContext.updateControlBounds(n.contentDOM.getBoundingClientRect());let i=Mc(n.root);i&&i.rangeCount&&this.editContext.updateSelectionBounds(i.getRangeAt(0).getBoundingClientRect())}}}applyEdits(e){let t=0,n=!1,i=this.pendingContextChange;return e.changes.iterChanges((s,a,o,l,f)=>{if(n)return;let c=f.length-(a-s);if(i&&a>=i.to)if(i.from==s&&i.to==a&&i.insert.eq(f)){i=this.pendingContextChange=null,t+=c,this.to+=c;return}else i=null,this.revertPending(e.state);if(s+=t,a+=t,a<=this.from)this.from+=c,this.to+=c;else if(s<this.to){if(s<this.from||a>this.to||this.to-this.from+f.length>3e4){n=!0;return}this.editContext.updateText(this.toContextPos(s),this.toContextPos(a),f.toString()),this.to+=c}t+=c}),i&&!n&&this.revertPending(e.state),!n}update(e){let t=this.pendingContextChange;this.composing&&(this.composing.drifted||e.transactions.some(n=>!n.isUserEvent("input.type")&&n.changes.touchesRange(this.from,this.to)))?(this.composing.drifted=!0,this.composing.editorBase=e.changes.mapPos(this.composing.editorBase)):!this.applyEdits(e)||!this.rangeIsValid(e.state)?(this.pendingContextChange=null,this.reset(e.state)):(e.docChanged||e.selectionSet||t)&&this.setSelection(e.state),(e.geometryChanged||e.docChanged||e.selectionSet)&&e.view.requestMeasure(this.measureReq)}resetRange(e){let{head:t}=e.selection.main;this.from=Math.max(0,t-1e4),this.to=Math.min(e.doc.length,t+1e4)}reset(e){this.resetRange(e),this.editContext.updateText(0,this.editContext.text.length,e.doc.sliceString(this.from,this.to)),this.setSelection(e)}revertPending(e){let t=this.pendingContextChange;this.pendingContextChange=null,this.editContext.updateText(this.toContextPos(t.from),this.toContextPos(t.from+t.insert.length),e.doc.sliceString(t.from,t.to))}setSelection(e){let{main:t}=e.selection,n=this.toContextPos(Math.max(this.from,Math.min(this.to,t.anchor))),i=this.toContextPos(t.head);(this.editContext.selectionStart!=n||this.editContext.selectionEnd!=i)&&this.editContext.updateSelection(n,i)}rangeIsValid(e){let{head:t}=e.selection.main;return!(this.from>0&&t-this.from<500||this.to<e.doc.length&&this.to-t<500||this.to-this.from>1e4*3)}toEditorPos(e,t=this.to-this.from){e=Math.min(e,t);let n=this.composing;return n&&n.drifted?n.editorBase+(e-n.contextBase):e+this.from}toContextPos(e){let t=this.composing;return t&&t.drifted?t.contextBase+(e-t.editorBase):e-this.from}destroy(){for(let e in this.handlers)this.editContext.removeEventListener(e,this.handlers[e])}}class We{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return this.inputState.composing>0}get compositionStarted(){return this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(e={}){var t;this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),e.parent&&e.parent.appendChild(this.dom);let{dispatch:n}=e;this.dispatchTransactions=e.dispatchTransactions||n&&(i=>i.forEach(s=>n(s,this)))||(i=>this.update(i)),this.dispatch=this.dispatch.bind(this),this._root=e.root||OV(e.parent)||document,this.viewState=new Gw(e.state||st.create(e)),e.scrollTo&&e.scrollTo.is(Kh)&&(this.viewState.scrollTarget=e.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(Mf).map(i=>new wp(i));for(let i of this.plugins)i.update(this);this.observer=new Fq(this),this.inputState=new rq(this),this.inputState.ensureHandlers(this.plugins),this.docView=new Pw(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),!((t=document.fonts)===null||t===void 0)&&t.ready&&document.fonts.ready.then(()=>this.requestMeasure())}dispatch(...e){let t=e.length==1&&e[0]instanceof Br?e:e.length==1&&Array.isArray(e[0])?e[0]:[this.state.update(...e)];this.dispatchTransactions(t,this)}update(e){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let t=!1,n=!1,i,s=this.state;for(let u of e){if(u.startState!=s)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");s=u.state}if(this.destroyed){this.viewState.state=s;return}let a=this.hasFocus,o=0,l=null;e.some(u=>u.annotation(QA))?(this.inputState.notifiedFocused=a,o=1):a!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=a,l=FA(s,a),l||(o=1));let f=this.observer.delayedAndroidKey,c=null;if(f?(this.observer.clearDelayedAndroidKey(),c=this.observer.readChange(),(c&&!this.state.doc.eq(s.doc)||!this.state.selection.eq(s.selection))&&(c=null)):this.observer.clear(),s.facet(st.phrases)!=this.state.facet(st.phrases))return this.setState(s);i=Fd.create(this,s,e),i.flags|=o;let h=this.viewState.scrollTarget;try{this.updateState=2;for(let u of e){if(h&&(h=h.map(u.changes)),u.scrollIntoView){let{main:d}=u.state.selection;h=new yl(d.empty?d:Oe.cursor(d.head,d.head>d.anchor?-1:1))}for(let d of u.effects)d.is(Kh)&&(h=d.value.clip(this.state))}this.viewState.update(i,h),this.bidiCache=Dd.update(this.bidiCache,i.changes),i.empty||(this.updatePlugins(i),this.inputState.update(i)),t=this.docView.update(i),this.state.facet(If)!=this.styleModules&&this.mountStyles(),n=this.updateAttrs(),this.showAnnouncements(e),this.docView.updateSelection(t,e.some(u=>u.isUserEvent("select.pointer")))}finally{this.updateState=0}if(i.startState.facet(iu)!=i.state.facet(iu)&&(this.viewState.mustMeasureContent=!0),(t||n||h||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),t&&this.docViewUpdate(),!i.empty)for(let u of this.state.facet(_g))try{u(i)}catch(d){tn(this.state,d,"update listener")}(l||c)&&Promise.resolve().then(()=>{l&&this.state==l.startState&&this.dispatch(l),c&&!TA(this,c)&&f.force&&vl(this.contentDOM,f.key,f.keyCode)})}setState(e){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=e;return}this.updateState=2;let t=this.hasFocus;try{for(let n of this.plugins)n.destroy(this);this.viewState=new Gw(e),this.plugins=e.facet(Mf).map(n=>new wp(n)),this.pluginMap.clear();for(let n of this.plugins)n.update(this);this.docView.destroy(),this.docView=new Pw(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}t&&this.focus(),this.requestMeasure()}updatePlugins(e){let t=e.startState.facet(Mf),n=e.state.facet(Mf);if(t!=n){let i=[];for(let s of n){let a=t.indexOf(s);if(a<0)i.push(new wp(s));else{let o=this.plugins[a];o.mustUpdate=e,i.push(o)}}for(let s of this.plugins)s.mustUpdate!=e&&s.destroy(this);this.plugins=i,this.pluginMap.clear()}else for(let i of this.plugins)i.mustUpdate=e;for(let i=0;i<this.plugins.length;i++)this.plugins[i].update(this);t!=n&&this.inputState.ensureHandlers(this.plugins)}docViewUpdate(){for(let e of this.plugins){let t=e.value;if(t&&t.docViewUpdate)try{t.docViewUpdate(this)}catch(n){tn(this.state,n,"doc view update listener")}}}measure(e=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey){this.measureScheduled=-1,this.requestMeasure();return}this.measureScheduled=0,e&&this.observer.forceFlush();let t=null,n=this.scrollDOM,i=n.scrollTop*this.scaleY,{scrollAnchorPos:s,scrollAnchorHeight:a}=this.viewState;Math.abs(i-this.viewState.scrollTop)>1&&(a=-1),this.viewState.scrollAnchorHeight=-1;try{for(let o=0;;o++){if(a<0)if(jC(n))s=-1,a=this.viewState.heightMap.height;else{let d=this.viewState.scrollAnchorAt(i);s=d.from,a=d.top}this.updateState=1;let l=this.viewState.measure(this);if(!l&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(o>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let f=[];l&4||([this.measureRequests,f]=[f,this.measureRequests]);let c=f.map(d=>{try{return d.read(this)}catch(p){return tn(this.state,p),Jw}}),h=Fd.create(this,this.state,[]),u=!1;h.flags|=l,t?t.flags|=l:t=h,this.updateState=2,h.empty||(this.updatePlugins(h),this.inputState.update(h),this.updateAttrs(),u=this.docView.update(h),u&&this.docViewUpdate());for(let d=0;d<f.length;d++)if(c[d]!=Jw)try{let p=f[d];p.write&&p.write(c[d],this)}catch(p){tn(this.state,p)}if(u&&this.docView.updateSelection(!0),!h.viewportChanged&&this.measureRequests.length==0){if(this.viewState.editorHeight)if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,a=-1;continue}else{let p=(s<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(s).top)-a;if(p>1||p<-1){i=i+p,n.scrollTop=i/this.scaleY,a=-1;continue}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(t&&!t.empty)for(let o of this.state.facet(_g))o(t)}get themeClasses(){return Ag+" "+(this.state.facet(Cg)?MA:NA)+" "+this.state.facet(iu)}updateAttrs(){let e=eb(this,yA,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),t={spellcheck:"false",autocorrect:"off",autocapitalize:"off",writingsuggestions:"false",translate:"no",contenteditable:this.state.facet(Xs)?"true":"false",class:"cm-content",style:`${qe.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(t["aria-readonly"]="true"),eb(this,fx,t);let n=this.observer.ignore(()=>{let i=xg(this.contentDOM,this.contentAttrs,t),s=xg(this.dom,this.editorAttrs,e);return i||s});return this.editorAttrs=e,this.contentAttrs=t,n}showAnnouncements(e){let t=!0;for(let n of e)for(let i of n.effects)if(i.is(We.announce)){t&&(this.announceDOM.textContent=""),t=!1;let s=this.announceDOM.appendChild(document.createElement("div"));s.textContent=i.value}}mountStyles(){this.styleModules=this.state.facet(If);let e=this.state.facet(We.cspNonce);An.mount(this.root,this.styleModules.concat(Rq).reverse(),e?{nonce:e}:void 0)}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(e){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),e){if(this.measureRequests.indexOf(e)>-1)return;if(e.key!=null){for(let t=0;t<this.measureRequests.length;t++)if(this.measureRequests[t].key===e.key){this.measureRequests[t]=e;return}}this.measureRequests.push(e)}}plugin(e){let t=this.pluginMap.get(e);return(t===void 0||t&&t.spec!=e)&&this.pluginMap.set(e,t=this.plugins.find(n=>n.spec==e)||null),t&&t.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(e){return this.readMeasured(),this.viewState.elementAtHeight(e)}lineBlockAtHeight(e){return this.readMeasured(),this.viewState.lineBlockAtHeight(e)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(e){return this.viewState.lineBlockAt(e)}get contentHeight(){return this.viewState.contentHeight}moveByChar(e,t,n){return _p(this,e,Dw(this,e,t,n))}moveByGroup(e,t){return _p(this,e,Dw(this,e,t,n=>jV(this,e.head,n)))}visualLineSide(e,t){let n=this.bidiSpans(e),i=this.textDirectionAt(e.from),s=n[t?n.length-1:0];return Oe.cursor(s.side(t,i)+e.from,s.forward(!t,i)?1:-1)}moveToLineBoundary(e,t,n=!0){return qV(this,e,t,n)}moveVertically(e,t,n){return _p(this,e,zV(this,e,t,n))}domAtPos(e){return this.docView.domAtPos(e)}posAtDOM(e,t=0){return this.docView.posFromDOM(e,t)}posAtCoords(e,t=!0){return this.readMeasured(),SA(this,e,t)}coordsAtPos(e,t=1){this.readMeasured();let n=this.docView.coordsAt(e,t);if(!n||n.left==n.right)return n;let i=this.state.doc.lineAt(e),s=this.bidiSpans(i),a=s[Ca.find(s,e-i.from,-1,t)];return E0(n,a.dir==Et.LTR==t>0)}coordsForChar(e){return this.readMeasured(),this.docView.coordsForChar(e)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(e){return!this.state.facet(gA)||e<this.viewport.from||e>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(e))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(e){if(e.length>Nq)return lA(e.length);let t=this.textDirectionAt(e.from),n;for(let s of this.bidiCache)if(s.from==e.from&&s.dir==t&&(s.fresh||oA(s.isolates,n=Ew(this,e))))return s.order;n||(n=Ew(this,e));let i=PV(e.text,t,n);return this.bidiCache.push(new Dd(e.from,e.to,t,n,!0,i)),i}get hasFocus(){var e;return(this.dom.ownerDocument.hasFocus()||qe.safari&&((e=this.inputState)===null||e===void 0?void 0:e.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{VC(this.contentDOM),this.docView.updateSelection()})}setRoot(e){this._root!=e&&(this._root=e,this.observer.setWindow((e.nodeType==9?e:e.ownerDocument).defaultView||window),this.mountStyles())}destroy(){this.root.activeElement==this.contentDOM&&this.contentDOM.blur();for(let e of this.plugins)e.destroy(this);this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(e,t={}){return Kh.of(new yl(typeof e=="number"?Oe.cursor(e):e,t.y,t.x,t.yMargin,t.xMargin))}scrollSnapshot(){let{scrollTop:e,scrollLeft:t}=this.scrollDOM,n=this.viewState.scrollAnchorAt(e);return Kh.of(new yl(Oe.cursor(n.from),"start","start",n.top-e,t,!0))}setTabFocusMode(e){e==null?this.inputState.tabFocusMode=this.inputState.tabFocusMode<0?0:-1:typeof e=="boolean"?this.inputState.tabFocusMode=e?0:-1:this.inputState.tabFocusMode!=0&&(this.inputState.tabFocusMode=Date.now()+e)}static domEventHandlers(e){return pr.define(()=>({}),{eventHandlers:e})}static domEventObservers(e){return pr.define(()=>({}),{eventObservers:e})}static theme(e,t){let n=An.newName(),i=[iu.of(n),If.of(Eg(`.${n}`,e))];return t&&t.dark&&i.push(Cg.of(!0)),i}static baseTheme(e){return ja.lowest(If.of(Eg("."+Ag,e,IA)))}static findFromDOM(e){var t;let n=e.querySelector(".cm-content"),i=n&&qt.get(n)||qt.get(e);return((t=i==null?void 0:i.rootView)===null||t===void 0?void 0:t.view)||null}}We.styleModule=If;We.inputHandler=pA;We.clipboardInputFilter=ox;We.clipboardOutputFilter=lx;We.scrollHandler=xA;We.focusChangeEffect=mA;We.perLineTextDirection=gA;We.exceptionSink=dA;We.updateListener=_g;We.editable=Xs;We.mouseSelectionStyle=uA;We.dragMovesSelection=hA;We.clickAddsSelectionRange=cA;We.decorations=Lc;We.outerDecorations=wA;We.atomicRanges=cx;We.bidiIsolatedRanges=bA;We.scrollMargins=_A;We.darkTheme=Cg;We.cspNonce=Ze.define({combine:r=>r.length?r[0]:""});We.contentAttributes=fx;We.editorAttributes=yA;We.lineWrapping=We.contentAttributes.of({class:"cm-lineWrapping"});We.announce=rt.define();const Nq=4096,Jw={};class Dd{constructor(e,t,n,i,s,a){this.from=e,this.to=t,this.dir=n,this.isolates=i,this.fresh=s,this.order=a}static update(e,t){if(t.empty&&!e.some(s=>s.fresh))return e;let n=[],i=e.length?e[e.length-1].dir:Et.LTR;for(let s=Math.max(0,e.length-10);s<e.length;s++){let a=e[s];a.dir==i&&!t.touchesRange(a.from,a.to)&&n.push(new Dd(t.mapPos(a.from,1),t.mapPos(a.to,-1),a.dir,a.isolates,!1,a.order))}return n}}function eb(r,e,t){for(let n=r.state.facet(e),i=n.length-1;i>=0;i--){let s=n[i],a=typeof s=="function"?s(r):s;a&&Og(a,t)}return t}const Mq=qe.mac?"mac":qe.windows?"win":qe.linux?"linux":"key";function Iq(r,e){const t=r.split(/-(?!$)/);let n=t[t.length-1];n=="Space"&&(n=" ");let i,s,a,o;for(let l=0;l<t.length-1;++l){const f=t[l];if(/^(cmd|meta|m)$/i.test(f))o=!0;else if(/^a(lt)?$/i.test(f))i=!0;else if(/^(c|ctrl|control)$/i.test(f))s=!0;else if(/^s(hift)?$/i.test(f))a=!0;else if(/^mod$/i.test(f))e=="mac"?o=!0:s=!0;else throw new Error("Unrecognized modifier name: "+f)}return i&&(n="Alt-"+n),s&&(n="Ctrl-"+n),o&&(n="Meta-"+n),a&&(n="Shift-"+n),n}function su(r,e,t){return e.altKey&&(r="Alt-"+r),e.ctrlKey&&(r="Ctrl-"+r),e.metaKey&&(r="Meta-"+r),t!==!1&&e.shiftKey&&(r="Shift-"+r),r}const Lq=ja.default(We.domEventHandlers({keydown(r,e){return BA(LA(e.state),r,e,"editor")}})),Q0=Ze.define({enables:Lq}),tb=new WeakMap;function LA(r){let e=r.facet(Q0),t=tb.get(e);return t||tb.set(e,t=Wq(e.reduce((n,i)=>n.concat(i),[]))),t}function Bq(r,e,t){return BA(LA(r.state),e,r,t)}let ya=null;const Zq=4e3;function Wq(r,e=Mq){let t=Object.create(null),n=Object.create(null),i=(a,o)=>{let l=n[a];if(l==null)n[a]=o;else if(l!=o)throw new Error("Key binding "+a+" is used both as a regular binding and as a multi-stroke prefix")},s=(a,o,l,f,c)=>{var h,u;let d=t[a]||(t[a]=Object.create(null)),p=o.split(/ (?!$)/).map(O=>Iq(O,e));for(let O=1;O<p.length;O++){let w=p.slice(0,O).join(" ");i(w,!0),d[w]||(d[w]={preventDefault:!0,stopPropagation:!1,run:[v=>{let S=ya={view:v,prefix:w,scope:a};return setTimeout(()=>{ya==S&&(ya=null)},Zq),!0}]})}let m=p.join(" ");i(m,!1);let g=d[m]||(d[m]={preventDefault:!1,stopPropagation:!1,run:((u=(h=d._any)===null||h===void 0?void 0:h.run)===null||u===void 0?void 0:u.slice())||[]});l&&g.run.push(l),f&&(g.preventDefault=!0),c&&(g.stopPropagation=!0)};for(let a of r){let o=a.scope?a.scope.split(" "):["editor"];if(a.any)for(let f of o){let c=t[f]||(t[f]=Object.create(null));c._any||(c._any={preventDefault:!1,stopPropagation:!1,run:[]});let{any:h}=a;for(let u in c)c[u].run.push(d=>h(d,Pg))}let l=a[e]||a.key;if(l)for(let f of o)s(f,l,a.run,a.preventDefault,a.stopPropagation),a.shift&&s(f,"Shift-"+l,a.shift,a.preventDefault,a.stopPropagation)}return t}let Pg=null;function BA(r,e,t,n){Pg=e;let i=uV(e),s=qn(i,0),a=Os(s)==i.length&&i!=" ",o="",l=!1,f=!1,c=!1;ya&&ya.view==t&&ya.scope==n&&(o=ya.prefix+" ",AA.indexOf(e.keyCode)<0&&(f=!0,ya=null));let h=new Set,u=g=>{if(g){for(let O of g.run)if(!h.has(O)&&(h.add(O),O(t)))return g.stopPropagation&&(c=!0),!0;g.preventDefault&&(g.stopPropagation&&(c=!0),f=!0)}return!1},d=r[n],p,m;return d&&(u(d[o+su(i,e,!a)])?l=!0:a&&(e.altKey||e.metaKey||e.ctrlKey)&&!(qe.windows&&e.ctrlKey&&e.altKey)&&(p=Da[e.keyCode])&&p!=i?(u(d[o+su(p,e,!0)])||e.shiftKey&&(m=Nc[e.keyCode])!=i&&m!=p&&u(d[o+su(m,e,!1)]))&&(l=!0):a&&e.shiftKey&&u(d[o+su(i,e,!0)])&&(l=!0),!l&&u(d._any)&&(l=!0)),f&&(l=!0),l&&c&&e.stopPropagation(),Pg=null,l}class kh{constructor(e,t,n,i,s){this.className=e,this.left=t,this.top=n,this.width=i,this.height=s}draw(){let e=document.createElement("div");return e.className=this.className,this.adjust(e),e}update(e,t){return t.className!=this.className?!1:(this.adjust(e),!0)}adjust(e){e.style.left=this.left+"px",e.style.top=this.top+"px",this.width!=null&&(e.style.width=this.width+"px"),e.style.height=this.height+"px"}eq(e){return this.left==e.left&&this.top==e.top&&this.width==e.width&&this.height==e.height&&this.className==e.className}static forRange(e,t,n){if(n.empty){let i=e.coordsAtPos(n.head,n.assoc||1);if(!i)return[];let s=ZA(e);return[new kh(t,i.left-s.left,i.top-s.top,null,i.bottom-i.top)]}else return Uq(e,t,n)}}function ZA(r){let e=r.scrollDOM.getBoundingClientRect();return{left:(r.textDirection==Et.LTR?e.left:e.right-r.scrollDOM.clientWidth*r.scaleX)-r.scrollDOM.scrollLeft*r.scaleX,top:e.top-r.scrollDOM.scrollTop*r.scaleY}}function rb(r,e,t,n){let i=r.coordsAtPos(e,t*2);if(!i)return n;let s=r.dom.getBoundingClientRect(),a=(i.top+i.bottom)/2,o=r.posAtCoords({x:s.left+1,y:a}),l=r.posAtCoords({x:s.right-1,y:a});return o==null||l==null?n:{from:Math.max(n.from,Math.min(o,l)),to:Math.min(n.to,Math.max(o,l))}}function Uq(r,e,t){if(t.to<=r.viewport.from||t.from>=r.viewport.to)return[];let n=Math.max(t.from,r.viewport.from),i=Math.min(t.to,r.viewport.to),s=r.textDirection==Et.LTR,a=r.contentDOM,o=a.getBoundingClientRect(),l=ZA(r),f=a.querySelector(".cm-line"),c=f&&window.getComputedStyle(f),h=o.left+(c?parseInt(c.paddingLeft)+Math.min(0,parseInt(c.textIndent)):0),u=o.right-(c?parseInt(c.paddingRight):0),d=Sg(r,n),p=Sg(r,i),m=d.type==Mn.Text?d:null,g=p.type==Mn.Text?p:null;if(m&&(r.lineWrapping||d.widgetLineBreaks)&&(m=rb(r,n,1,m)),g&&(r.lineWrapping||p.widgetLineBreaks)&&(g=rb(r,i,-1,g)),m&&g&&m.from==g.from&&m.to==g.to)return w(v(t.from,t.to,m));{let y=m?v(t.from,null,m):S(d,!1),b=g?v(null,t.to,g):S(p,!0),x=[];return(m||d).to<(g||p).from-(m&&g?1:0)||d.widgetLineBreaks>1&&y.bottom+r.defaultLineHeight/2<b.top?x.push(O(h,y.bottom,u,b.top)):y.bottom<b.top&&r.elementAtHeight((y.bottom+b.top)/2).type==Mn.Text&&(y.bottom=b.top=(y.bottom+b.top)/2),w(y).concat(x).concat(w(b))}function O(y,b,x,A){return new kh(e,y-l.left,b-l.top,x-y,A-b)}function w({top:y,bottom:b,horizontal:x}){let A=[];for(let k=0;k<x.length;k+=2)A.push(O(x[k],y,x[k+1],b));return A}function v(y,b,x){let A=1e9,k=-1e9,E=[];function T(Z,z,ee,ae,xe){let V=r.coordsAtPos(Z,Z==x.to?-2:2),ue=r.coordsAtPos(ee,ee==x.from?2:-2);!V||!ue||(A=Math.min(V.top,ue.top,A),k=Math.max(V.bottom,ue.bottom,k),xe==Et.LTR?E.push(s&&z?h:V.left,s&&ae?u:ue.right):E.push(!s&&ae?h:ue.left,!s&&z?u:V.right))}let _=y??x.from,N=b??x.to;for(let Z of r.visibleRanges)if(Z.to>_&&Z.from<N)for(let z=Math.max(Z.from,_),ee=Math.min(Z.to,N);;){let ae=r.state.doc.lineAt(z);for(let xe of r.bidiSpans(ae)){let V=xe.from+ae.from,ue=xe.to+ae.from;if(V>=ee)break;ue>z&&T(Math.max(V,z),y==null&&V<=_,Math.min(ue,ee),b==null&&ue>=N,xe.dir)}if(z=ae.to+1,z>=ee)break}return E.length==0&&T(_,y==null,N,b==null,r.textDirection),{top:A,bottom:k,horizontal:E}}function S(y,b){let x=o.top+(b?y.top:y.bottom);return{top:x,bottom:x,horizontal:[]}}}function Xq(r,e){return r.constructor==e.constructor&&r.eq(e)}class Vq{constructor(e,t){this.view=e,this.layer=t,this.drawn=[],this.scaleX=1,this.scaleY=1,this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=e.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),t.above&&this.dom.classList.add("cm-layer-above"),t.class&&this.dom.classList.add(t.class),this.scale(),this.dom.setAttribute("aria-hidden","true"),this.setOrder(e.state),e.requestMeasure(this.measureReq),t.mount&&t.mount(this.dom,e)}update(e){e.startState.facet(Lu)!=e.state.facet(Lu)&&this.setOrder(e.state),(this.layer.update(e,this.dom)||e.geometryChanged)&&(this.scale(),e.view.requestMeasure(this.measureReq))}docViewUpdate(e){this.layer.updateOnDocViewUpdate!==!1&&e.requestMeasure(this.measureReq)}setOrder(e){let t=0,n=e.facet(Lu);for(;t<n.length&&n[t]!=this.layer;)t++;this.dom.style.zIndex=String((this.layer.above?150:-1)-t)}measure(){return this.layer.markers(this.view)}scale(){let{scaleX:e,scaleY:t}=this.view;(e!=this.scaleX||t!=this.scaleY)&&(this.scaleX=e,this.scaleY=t,this.dom.style.transform=`scale(${1/e}, ${1/t})`)}draw(e){if(e.length!=this.drawn.length||e.some((t,n)=>!Xq(t,this.drawn[n]))){let t=this.dom.firstChild,n=0;for(let i of e)i.update&&t&&i.constructor&&this.drawn[n].constructor&&i.update(t,this.drawn[n])?(t=t.nextSibling,n++):this.dom.insertBefore(i.draw(),t);for(;t;){let i=t.nextSibling;t.remove(),t=i}this.drawn=e}}destroy(){this.layer.destroy&&this.layer.destroy(this.dom,this.view),this.dom.remove()}}const Lu=Ze.define();function WA(r){return[pr.define(e=>new Vq(e,r)),Lu.of(r)]}const UA=!(qe.ios&&qe.webkit&&qe.webkit_version<534),Bc=Ze.define({combine(r){return Ls(r,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(e,t)=>Math.min(e,t),drawRangeCursor:(e,t)=>e||t})}});function qq(r={}){return[Bc.of(r),jq,zq,Gq,OA.of(!0)]}function XA(r){return r.startState.facet(Bc)!=r.state.facet(Bc)}const jq=WA({above:!0,markers(r){let{state:e}=r,t=e.facet(Bc),n=[];for(let i of e.selection.ranges){let s=i==e.selection.main;if(i.empty?!s||UA:t.drawRangeCursor){let a=s?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",o=i.empty?i:Oe.cursor(i.head,i.head>i.anchor?-1:1);for(let l of kh.forRange(r,a,o))n.push(l)}}return n},update(r,e){r.transactions.some(n=>n.selection)&&(e.style.animationName=e.style.animationName=="cm-blink"?"cm-blink2":"cm-blink");let t=XA(r);return t&&nb(r.state,e),r.docChanged||r.selectionSet||t},mount(r,e){nb(e.state,r)},class:"cm-cursorLayer"});function nb(r,e){e.style.animationDuration=r.facet(Bc).cursorBlinkRate+"ms"}const zq=WA({above:!1,markers(r){return r.state.selection.ranges.map(e=>e.empty?[]:kh.forRange(r,"cm-selectionBackground",e)).reduce((e,t)=>e.concat(t))},update(r,e){return r.docChanged||r.selectionSet||r.viewportChanged||XA(r)},class:"cm-selectionLayer"}),Rg={".cm-line":{"& ::selection, &::selection":{backgroundColor:"transparent !important"}},".cm-content":{"& :focus":{caretColor:"initial !important","&::selection, & ::selection":{backgroundColor:"Highlight !important"}}}};UA&&(Rg[".cm-line"].caretColor=Rg[".cm-content"].caretColor="transparent !important");const Gq=ja.highest(We.theme(Rg)),VA=rt.define({map(r,e){return r==null?null:e.mapPos(r)}}),Zf=Cr.define({create(){return null},update(r,e){return r!=null&&(r=e.changes.mapPos(r)),e.effects.reduce((t,n)=>n.is(VA)?n.value:t,r)}}),Hq=pr.fromClass(class{constructor(r){this.view=r,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(r){var e;let t=r.state.field(Zf);t==null?this.cursor!=null&&((e=this.cursor)===null||e===void 0||e.remove(),this.cursor=null):(this.cursor||(this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor"),(r.startState.field(Zf)!=t||r.docChanged||r.geometryChanged)&&this.view.requestMeasure(this.measureReq))}readPos(){let{view:r}=this,e=r.state.field(Zf),t=e!=null&&r.coordsAtPos(e);if(!t)return null;let n=r.scrollDOM.getBoundingClientRect();return{left:t.left-n.left+r.scrollDOM.scrollLeft*r.scaleX,top:t.top-n.top+r.scrollDOM.scrollTop*r.scaleY,height:t.bottom-t.top}}drawCursor(r){if(this.cursor){let{scaleX:e,scaleY:t}=this.view;r?(this.cursor.style.left=r.left/e+"px",this.cursor.style.top=r.top/t+"px",this.cursor.style.height=r.height/t+"px"):this.cursor.style.left="-100000px"}}destroy(){this.cursor&&this.cursor.remove()}setDropPos(r){this.view.state.field(Zf)!=r&&this.view.dispatch({effects:VA.of(r)})}},{eventObservers:{dragover(r){this.setDropPos(this.view.posAtCoords({x:r.clientX,y:r.clientY}))},dragleave(r){(r.target==this.view.contentDOM||!this.view.contentDOM.contains(r.relatedTarget))&&this.setDropPos(null)},dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}});function Yq(){return[Zf,Hq]}function ib(r,e,t,n,i){e.lastIndex=0;for(let s=r.iterRange(t,n),a=t,o;!s.next().done;a+=s.value.length)if(!s.lineBreak)for(;o=e.exec(s.value);)i(a+o.index,o)}function Kq(r,e){let t=r.visibleRanges;if(t.length==1&&t[0].from==r.viewport.from&&t[0].to==r.viewport.to)return t;let n=[];for(let{from:i,to:s}of t)i=Math.max(r.state.doc.lineAt(i).from,i-e),s=Math.min(r.state.doc.lineAt(s).to,s+e),n.length&&n[n.length-1].to>=i?n[n.length-1].to=s:n.push({from:i,to:s});return n}class Jq{constructor(e){const{regexp:t,decoration:n,decorate:i,boundary:s,maxLength:a=1e3}=e;if(!t.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");if(this.regexp=t,i)this.addMatch=(o,l,f,c)=>i(c,f,f+o[0].length,o,l);else if(typeof n=="function")this.addMatch=(o,l,f,c)=>{let h=n(o,l,f);h&&c(f,f+o[0].length,h)};else if(n)this.addMatch=(o,l,f,c)=>c(f,f+o[0].length,n);else throw new RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.boundary=s,this.maxLength=a}createDeco(e){let t=new Js,n=t.add.bind(t);for(let{from:i,to:s}of Kq(e,this.maxLength))ib(e.state.doc,this.regexp,i,s,(a,o)=>this.addMatch(o,e,a,n));return t.finish()}updateDeco(e,t){let n=1e9,i=-1;return e.docChanged&&e.changes.iterChanges((s,a,o,l)=>{l>=e.view.viewport.from&&o<=e.view.viewport.to&&(n=Math.min(o,n),i=Math.max(l,i))}),e.viewportMoved||i-n>1e3?this.createDeco(e.view):i>-1?this.updateRange(e.view,t.map(e.changes),n,i):t}updateRange(e,t,n,i){for(let s of e.visibleRanges){let a=Math.max(s.from,n),o=Math.min(s.to,i);if(o>a){let l=e.state.doc.lineAt(a),f=l.to<o?e.state.doc.lineAt(o):l,c=Math.max(s.from,l.from),h=Math.min(s.to,f.to);if(this.boundary){for(;a>l.from;a--)if(this.boundary.test(l.text[a-1-l.from])){c=a;break}for(;o<f.to;o++)if(this.boundary.test(f.text[o-f.from])){h=o;break}}let u=[],d,p=(m,g,O)=>u.push(O.range(m,g));if(l==f)for(this.regexp.lastIndex=c-l.from;(d=this.regexp.exec(l.text))&&d.index<h-l.from;)this.addMatch(d,e,d.index+l.from,p);else ib(e.state.doc,this.regexp,c,h,(m,g)=>this.addMatch(g,e,m,p));t=t.update({filterFrom:c,filterTo:h,filter:(m,g)=>m<c||g>h,add:u})}}return t}}const Qg=/x/.unicode!=null?"gu":"g",ej=new RegExp(`[\0-\b
--\u2028\u2029\uFEFF-]`,Qg),tj={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"};let Tp=null;function rj(){var r;if(Tp==null&&typeof document<"u"&&document.body){let e=document.body.style;Tp=((r=e.tabSize)!==null&&r!==void 0?r:e.MozTabSize)!=null}return Tp||!1}const Bu=Ze.define({combine(r){let e=Ls(r,{render:null,specialChars:ej,addSpecialChars:null});return(e.replaceTabs=!rj())&&(e.specialChars=new RegExp("	|"+e.specialChars.source,Qg)),e.addSpecialChars&&(e.specialChars=new RegExp(e.specialChars.source+"|"+e.addSpecialChars.source,Qg)),e}});function nj(r={}){return[Bu.of(r),ij()]}let sb=null;function ij(){return sb||(sb=pr.fromClass(class{constructor(r){this.view=r,this.decorations=je.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(r.state.facet(Bu)),this.decorations=this.decorator.createDeco(r)}makeDecorator(r){return new Jq({regexp:r.specialChars,decoration:(e,t,n)=>{let{doc:i}=t.state,s=qn(e[0],0);if(s==9){let a=i.lineAt(n),o=t.state.tabSize,l=sf(a.text,o,n-a.from);return je.replace({widget:new lj((o-l%o)*this.view.defaultCharacterWidth/this.view.scaleX)})}return this.decorationCache[s]||(this.decorationCache[s]=je.replace({widget:new oj(r,s)}))},boundary:r.replaceTabs?void 0:/[^]/})}update(r){let e=r.state.facet(Bu);r.startState.facet(Bu)!=e?(this.decorator=this.makeDecorator(e),this.decorations=this.decorator.createDeco(r.view)):this.decorations=this.decorator.updateDeco(r,this.decorations)}},{decorations:r=>r.decorations}))}const sj="";function aj(r){return r>=32?sj:r==10?"":String.fromCharCode(9216+r)}class oj extends aa{constructor(e,t){super(),this.options=e,this.code=t}eq(e){return e.code==this.code}toDOM(e){let t=aj(this.code),n=e.state.phrase("Control character")+" "+(tj[this.code]||"0x"+this.code.toString(16)),i=this.options.render&&this.options.render(this.code,n,t);if(i)return i;let s=document.createElement("span");return s.textContent=t,s.title=n,s.setAttribute("aria-label",n),s.className="cm-specialChar",s}ignoreEvent(){return!1}}class lj extends aa{constructor(e){super(),this.width=e}eq(e){return e.width==this.width}toDOM(){let e=document.createElement("span");return e.textContent="	",e.className="cm-tab",e.style.width=this.width+"px",e}ignoreEvent(){return!1}}function fj(){return hj}const cj=je.line({class:"cm-activeLine"}),hj=pr.fromClass(class{constructor(r){this.decorations=this.getDeco(r)}update(r){(r.docChanged||r.selectionSet)&&(this.decorations=this.getDeco(r.view))}getDeco(r){let e=-1,t=[];for(let n of r.state.selection.ranges){let i=r.lineBlockAt(n.head);i.from>e&&(t.push(cj.range(i.from)),e=i.from)}return je.set(t)}},{decorations:r=>r.decorations}),Fg=2e3;function uj(r,e,t){let n=Math.min(e.line,t.line),i=Math.max(e.line,t.line),s=[];if(e.off>Fg||t.off>Fg||e.col<0||t.col<0){let a=Math.min(e.off,t.off),o=Math.max(e.off,t.off);for(let l=n;l<=i;l++){let f=r.doc.line(l);f.length<=o&&s.push(Oe.range(f.from+a,f.to+o))}}else{let a=Math.min(e.col,t.col),o=Math.max(e.col,t.col);for(let l=n;l<=i;l++){let f=r.doc.line(l),c=cg(f.text,a,r.tabSize,!0);if(c<0)s.push(Oe.cursor(f.to));else{let h=cg(f.text,o,r.tabSize);s.push(Oe.range(f.from+c,f.from+h))}}}return s}function dj(r,e){let t=r.coordsAtPos(r.viewport.from);return t?Math.round(Math.abs((t.left-e)/r.defaultCharacterWidth)):-1}function ab(r,e){let t=r.posAtCoords({x:e.clientX,y:e.clientY},!1),n=r.state.doc.lineAt(t),i=t-n.from,s=i>Fg?-1:i==n.length?dj(r,e.clientX):sf(n.text,r.state.tabSize,t-n.from);return{line:n.number,col:s,off:i}}function pj(r,e){let t=ab(r,e),n=r.state.selection;return t?{update(i){if(i.docChanged){let s=i.changes.mapPos(i.startState.doc.line(t.line).from),a=i.state.doc.lineAt(s);t={line:a.number,col:t.col,off:Math.min(t.off,a.length)},n=n.map(i.changes)}},get(i,s,a){let o=ab(r,i);if(!o)return n;let l=uj(r.state,t,o);return l.length?a?Oe.create(l.concat(n.ranges)):Oe.create(l):n}}:null}function mj(r){let e=t=>t.altKey&&t.button==0;return We.mouseSelectionStyle.of((t,n)=>e(n)?pj(t,n):null)}const gj={Alt:[18,r=>!!r.altKey],Control:[17,r=>!!r.ctrlKey],Shift:[16,r=>!!r.shiftKey],Meta:[91,r=>!!r.metaKey]},Oj={style:"cursor: crosshair"};function xj(r={}){let[e,t]=gj[r.key||"Alt"],n=pr.fromClass(class{constructor(i){this.view=i,this.isDown=!1}set(i){this.isDown!=i&&(this.isDown=i,this.view.update([]))}},{eventObservers:{keydown(i){this.set(i.keyCode==e||t(i))},keyup(i){(i.keyCode==e||!t(i))&&this.set(!1)},mousemove(i){this.set(t(i))}}});return[n,We.contentAttributes.of(i=>{var s;return!((s=i.plugin(n))===null||s===void 0)&&s.isDown?Oj:null})]}const xf="-10000px";class qA{constructor(e,t,n,i){this.facet=t,this.createTooltipView=n,this.removeTooltipView=i,this.input=e.state.facet(t),this.tooltips=this.input.filter(a=>a);let s=null;this.tooltipViews=this.tooltips.map(a=>s=n(a,s))}update(e,t){var n;let i=e.state.facet(this.facet),s=i.filter(l=>l);if(i===this.input){for(let l of this.tooltipViews)l.update&&l.update(e);return!1}let a=[],o=t?[]:null;for(let l=0;l<s.length;l++){let f=s[l],c=-1;if(f){for(let h=0;h<this.tooltips.length;h++){let u=this.tooltips[h];u&&u.create==f.create&&(c=h)}if(c<0)a[l]=this.createTooltipView(f,l?a[l-1]:null),o&&(o[l]=!!f.above);else{let h=a[l]=this.tooltipViews[c];o&&(o[l]=t[c]),h.update&&h.update(e)}}}for(let l of this.tooltipViews)a.indexOf(l)<0&&(this.removeTooltipView(l),(n=l.destroy)===null||n===void 0||n.call(l));return t&&(o.forEach((l,f)=>t[f]=l),t.length=o.length),this.input=i,this.tooltips=s,this.tooltipViews=a,!0}}function vj(r){let{win:e}=r;return{top:0,left:0,bottom:e.innerHeight,right:e.innerWidth}}const Cp=Ze.define({combine:r=>{var e,t,n;return{position:qe.ios?"absolute":((e=r.find(i=>i.position))===null||e===void 0?void 0:e.position)||"fixed",parent:((t=r.find(i=>i.parent))===null||t===void 0?void 0:t.parent)||null,tooltipSpace:((n=r.find(i=>i.tooltipSpace))===null||n===void 0?void 0:n.tooltipSpace)||vj}}}),ob=new WeakMap,mx=pr.fromClass(class{constructor(r){this.view=r,this.above=[],this.inView=!0,this.madeAbsolute=!1,this.lastTransaction=0,this.measureTimeout=-1;let e=r.state.facet(Cp);this.position=e.position,this.parent=e.parent,this.classes=r.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.resizeObserver=typeof ResizeObserver=="function"?new ResizeObserver(()=>this.measureSoon()):null,this.manager=new qA(r,gx,(t,n)=>this.createTooltip(t,n),t=>{this.resizeObserver&&this.resizeObserver.unobserve(t.dom),t.dom.remove()}),this.above=this.manager.tooltips.map(t=>!!t.above),this.intersectionObserver=typeof IntersectionObserver=="function"?new IntersectionObserver(t=>{Date.now()>this.lastTransaction-50&&t.length>0&&t[t.length-1].intersectionRatio<1&&this.measureSoon()},{threshold:[1]}):null,this.observeIntersection(),r.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let r of this.manager.tooltipViews)this.intersectionObserver.observe(r.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1,this.maybeMeasure()},50))}update(r){r.transactions.length&&(this.lastTransaction=Date.now());let e=this.manager.update(r,this.above);e&&this.observeIntersection();let t=e||r.geometryChanged,n=r.state.facet(Cp);if(n.position!=this.position&&!this.madeAbsolute){this.position=n.position;for(let i of this.manager.tooltipViews)i.dom.style.position=this.position;t=!0}if(n.parent!=this.parent){this.parent&&this.container.remove(),this.parent=n.parent,this.createContainer();for(let i of this.manager.tooltipViews)this.container.appendChild(i.dom);t=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);t&&this.maybeMeasure()}createTooltip(r,e){let t=r.create(this.view),n=e?e.dom:null;if(t.dom.classList.add("cm-tooltip"),r.arrow&&!t.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let i=document.createElement("div");i.className="cm-tooltip-arrow",t.dom.appendChild(i)}return t.dom.style.position=this.position,t.dom.style.top=xf,t.dom.style.left="0px",this.container.insertBefore(t.dom,n),t.mount&&t.mount(this.view),this.resizeObserver&&this.resizeObserver.observe(t.dom),t}destroy(){var r,e,t;this.view.win.removeEventListener("resize",this.measureSoon);for(let n of this.manager.tooltipViews)n.dom.remove(),(r=n.destroy)===null||r===void 0||r.call(n);this.parent&&this.container.remove(),(e=this.resizeObserver)===null||e===void 0||e.disconnect(),(t=this.intersectionObserver)===null||t===void 0||t.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let r=1,e=1,t=!1;if(this.position=="fixed"&&this.manager.tooltipViews.length){let{dom:s}=this.manager.tooltipViews[0];if(qe.gecko)t=s.offsetParent!=this.container.ownerDocument.body;else if(s.style.top==xf&&s.style.left=="0px"){let a=s.getBoundingClientRect();t=Math.abs(a.top+1e4)>1||Math.abs(a.left)>1}}if(t||this.position=="absolute")if(this.parent){let s=this.parent.getBoundingClientRect();s.width&&s.height&&(r=s.width/this.parent.offsetWidth,e=s.height/this.parent.offsetHeight)}else({scaleX:r,scaleY:e}=this.view.viewState);let n=this.view.scrollDOM.getBoundingClientRect(),i=hx(this.view);return{visible:{left:n.left+i.left,top:n.top+i.top,right:n.right-i.right,bottom:n.bottom-i.bottom},parent:this.parent?this.container.getBoundingClientRect():this.view.dom.getBoundingClientRect(),pos:this.manager.tooltips.map((s,a)=>{let o=this.manager.tooltipViews[a];return o.getCoords?o.getCoords(s.pos):this.view.coordsAtPos(s.pos)}),size:this.manager.tooltipViews.map(({dom:s})=>s.getBoundingClientRect()),space:this.view.state.facet(Cp).tooltipSpace(this.view),scaleX:r,scaleY:e,makeAbsolute:t}}writeMeasure(r){var e;if(r.makeAbsolute){this.madeAbsolute=!0,this.position="absolute";for(let o of this.manager.tooltipViews)o.dom.style.position="absolute"}let{visible:t,space:n,scaleX:i,scaleY:s}=r,a=[];for(let o=0;o<this.manager.tooltips.length;o++){let l=this.manager.tooltips[o],f=this.manager.tooltipViews[o],{dom:c}=f,h=r.pos[o],u=r.size[o];if(!h||l.clip!==!1&&(h.bottom<=Math.max(t.top,n.top)||h.top>=Math.min(t.bottom,n.bottom)||h.right<Math.max(t.left,n.left)-.1||h.left>Math.min(t.right,n.right)+.1)){c.style.top=xf;continue}let d=l.arrow?f.dom.querySelector(".cm-tooltip-arrow"):null,p=d?7:0,m=u.right-u.left,g=(e=ob.get(f))!==null&&e!==void 0?e:u.bottom-u.top,O=f.offset||wj,w=this.view.textDirection==Et.LTR,v=u.width>n.right-n.left?w?n.left:n.right-u.width:w?Math.max(n.left,Math.min(h.left-(d?14:0)+O.x,n.right-m)):Math.min(Math.max(n.left,h.left-m+(d?14:0)-O.x),n.right-m),S=this.above[o];!l.strictSide&&(S?h.top-g-p-O.y<n.top:h.bottom+g+p+O.y>n.bottom)&&S==n.bottom-h.bottom>h.top-n.top&&(S=this.above[o]=!S);let y=(S?h.top-n.top:n.bottom-h.bottom)-p;if(y<g&&f.resize!==!1){if(y<this.view.defaultLineHeight){c.style.top=xf;continue}ob.set(f,g),c.style.height=(g=y)/s+"px"}else c.style.height&&(c.style.height="");let b=S?h.top-g-p-O.y:h.bottom+p+O.y,x=v+m;if(f.overlap!==!0)for(let A of a)A.left<x&&A.right>v&&A.top<b+g&&A.bottom>b&&(b=S?A.top-g-2-p:A.bottom+p+2);if(this.position=="absolute"?(c.style.top=(b-r.parent.top)/s+"px",lb(c,(v-r.parent.left)/i)):(c.style.top=b/s+"px",lb(c,v/i)),d){let A=h.left+(w?O.x:-O.x)-(v+14-7);d.style.left=A/i+"px"}f.overlap!==!0&&a.push({left:v,top:b,right:x,bottom:b+g}),c.classList.toggle("cm-tooltip-above",S),c.classList.toggle("cm-tooltip-below",!S),f.positioned&&f.positioned(r.space)}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let r of this.manager.tooltipViews)r.dom.style.top=xf}},{eventObservers:{scroll(){this.maybeMeasure()}}});function lb(r,e){let t=parseInt(r.style.left,10);(isNaN(t)||Math.abs(e-t)>1)&&(r.style.left=e+"px")}const yj=We.baseTheme({".cm-tooltip":{zIndex:500,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"7px",width:`${7*2}px`,position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent"},".cm-tooltip-above &":{bottom:"-7px","&:before":{borderTop:"7px solid #bbb"},"&:after":{borderTop:"7px solid #f5f5f5",bottom:"1px"}},".cm-tooltip-below &":{top:"-7px","&:before":{borderBottom:"7px solid #bbb"},"&:after":{borderBottom:"7px solid #f5f5f5",top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),wj={x:0,y:0},gx=Ze.define({enables:[mx,yj]}),Nd=Ze.define({combine:r=>r.reduce((e,t)=>e.concat(t),[])});class F0{static create(e){return new F0(e)}constructor(e){this.view=e,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new qA(e,Nd,(t,n)=>this.createHostedView(t,n),t=>t.dom.remove())}createHostedView(e,t){let n=e.create(this.view);return n.dom.classList.add("cm-tooltip-section"),this.dom.insertBefore(n.dom,t?t.dom.nextSibling:this.dom.firstChild),this.mounted&&n.mount&&n.mount(this.view),n}mount(e){for(let t of this.manager.tooltipViews)t.mount&&t.mount(e);this.mounted=!0}positioned(e){for(let t of this.manager.tooltipViews)t.positioned&&t.positioned(e)}update(e){this.manager.update(e)}destroy(){var e;for(let t of this.manager.tooltipViews)(e=t.destroy)===null||e===void 0||e.call(t)}passProp(e){let t;for(let n of this.manager.tooltipViews){let i=n[e];if(i!==void 0){if(t===void 0)t=i;else if(t!==i)return}}return t}get offset(){return this.passProp("offset")}get getCoords(){return this.passProp("getCoords")}get overlap(){return this.passProp("overlap")}get resize(){return this.passProp("resize")}}const bj=gx.compute([Nd],r=>{let e=r.facet(Nd);return e.length===0?null:{pos:Math.min(...e.map(t=>t.pos)),end:Math.max(...e.map(t=>{var n;return(n=t.end)!==null&&n!==void 0?n:t.pos})),create:F0.create,above:e[0].above,arrow:e.some(t=>t.arrow)}});class _j{constructor(e,t,n,i,s){this.view=e,this.source=t,this.field=n,this.setHover=i,this.hoverTime=s,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:e.dom,time:0},this.checkHover=this.checkHover.bind(this),e.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),e.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout(()=>this.startHover(),20))}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=-1,this.active.length)return;let e=Date.now()-this.lastMove.time;e<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-e):this.startHover()}startHover(){clearTimeout(this.restartTimeout);let{view:e,lastMove:t}=this,n=e.docView.nearest(t.target);if(!n)return;let i,s=1;if(n instanceof Ta)i=n.posAtStart;else{if(i=e.posAtCoords(t),i==null)return;let o=e.coordsAtPos(i);if(!o||t.y<o.top||t.y>o.bottom||t.x<o.left-e.defaultCharacterWidth||t.x>o.right+e.defaultCharacterWidth)return;let l=e.bidiSpans(e.state.doc.lineAt(i)).find(c=>c.from<=i&&c.to>=i),f=l&&l.dir==Et.RTL?-1:1;s=t.x<o.left?-f:f}let a=this.source(e,i,s);if(a!=null&&a.then){let o=this.pending={pos:i};a.then(l=>{this.pending==o&&(this.pending=null,l&&!(Array.isArray(l)&&!l.length)&&e.dispatch({effects:this.setHover.of(Array.isArray(l)?l:[l])}))},l=>tn(e.state,l,"hover tooltip"))}else a&&!(Array.isArray(a)&&!a.length)&&e.dispatch({effects:this.setHover.of(Array.isArray(a)?a:[a])})}get tooltip(){let e=this.view.plugin(mx),t=e?e.manager.tooltips.findIndex(n=>n.create==F0.create):-1;return t>-1?e.manager.tooltipViews[t]:null}mousemove(e){var t,n;this.lastMove={x:e.clientX,y:e.clientY,target:e.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime));let{active:i,tooltip:s}=this;if(i.length&&s&&!kj(s.dom,e)||this.pending){let{pos:a}=i[0]||this.pending,o=(n=(t=i[0])===null||t===void 0?void 0:t.end)!==null&&n!==void 0?n:a;(a==o?this.view.posAtCoords(this.lastMove)!=a:!Sj(this.view,a,o,e.clientX,e.clientY))&&(this.view.dispatch({effects:this.setHover.of([])}),this.pending=null)}}mouseleave(e){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1;let{active:t}=this;if(t.length){let{tooltip:n}=this;n&&n.dom.contains(e.relatedTarget)?this.watchTooltipLeave(n.dom):this.view.dispatch({effects:this.setHover.of([])})}}watchTooltipLeave(e){let t=n=>{e.removeEventListener("mouseleave",t),this.active.length&&!this.view.dom.contains(n.relatedTarget)&&this.view.dispatch({effects:this.setHover.of([])})};e.addEventListener("mouseleave",t)}destroy(){clearTimeout(this.hoverTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}}const au=4;function kj(r,e){let{left:t,right:n,top:i,bottom:s}=r.getBoundingClientRect(),a;if(a=r.querySelector(".cm-tooltip-arrow")){let o=a.getBoundingClientRect();i=Math.min(o.top,i),s=Math.max(o.bottom,s)}return e.clientX>=t-au&&e.clientX<=n+au&&e.clientY>=i-au&&e.clientY<=s+au}function Sj(r,e,t,n,i,s){let a=r.scrollDOM.getBoundingClientRect(),o=r.documentTop+r.documentPadding.top+r.contentHeight;if(a.left>n||a.right<n||a.top>i||Math.min(a.bottom,o)<i)return!1;let l=r.posAtCoords({x:n,y:i},!1);return l>=e&&l<=t}function Tj(r,e={}){let t=rt.define(),n=Cr.define({create(){return[]},update(i,s){if(i.length&&(e.hideOnChange&&(s.docChanged||s.selection)?i=[]:e.hideOn&&(i=i.filter(a=>!e.hideOn(s,a))),s.docChanged)){let a=[];for(let o of i){let l=s.changes.mapPos(o.pos,-1,dn.TrackDel);if(l!=null){let f=Object.assign(Object.create(null),o);f.pos=l,f.end!=null&&(f.end=s.changes.mapPos(f.end)),a.push(f)}}i=a}for(let a of s.effects)a.is(t)&&(i=a.value),a.is(Cj)&&(i=[]);return i},provide:i=>Nd.from(i)});return{active:n,extension:[n,pr.define(i=>new _j(i,r,n,t,e.hoverTime||300)),bj]}}function jA(r,e){let t=r.plugin(mx);if(!t)return null;let n=t.manager.tooltips.indexOf(e);return n<0?null:t.manager.tooltipViews[n]}const Cj=rt.define(),fb=Ze.define({combine(r){let e,t;for(let n of r)e=e||n.topContainer,t=t||n.bottomContainer;return{topContainer:e,bottomContainer:t}}});function Zc(r,e){let t=r.plugin(zA),n=t?t.specs.indexOf(e):-1;return n>-1?t.panels[n]:null}const zA=pr.fromClass(class{constructor(r){this.input=r.state.facet(Wc),this.specs=this.input.filter(t=>t),this.panels=this.specs.map(t=>t(r));let e=r.state.facet(fb);this.top=new ou(r,!0,e.topContainer),this.bottom=new ou(r,!1,e.bottomContainer),this.top.sync(this.panels.filter(t=>t.top)),this.bottom.sync(this.panels.filter(t=>!t.top));for(let t of this.panels)t.dom.classList.add("cm-panel"),t.mount&&t.mount()}update(r){let e=r.state.facet(fb);this.top.container!=e.topContainer&&(this.top.sync([]),this.top=new ou(r.view,!0,e.topContainer)),this.bottom.container!=e.bottomContainer&&(this.bottom.sync([]),this.bottom=new ou(r.view,!1,e.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let t=r.state.facet(Wc);if(t!=this.input){let n=t.filter(l=>l),i=[],s=[],a=[],o=[];for(let l of n){let f=this.specs.indexOf(l),c;f<0?(c=l(r.view),o.push(c)):(c=this.panels[f],c.update&&c.update(r)),i.push(c),(c.top?s:a).push(c)}this.specs=n,this.panels=i,this.top.sync(s),this.bottom.sync(a);for(let l of o)l.dom.classList.add("cm-panel"),l.mount&&l.mount()}else for(let n of this.panels)n.update&&n.update(r)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:r=>We.scrollMargins.of(e=>{let t=e.plugin(r);return t&&{top:t.top.scrollMargin(),bottom:t.bottom.scrollMargin()}})});class ou{constructor(e,t,n){this.view=e,this.top=t,this.container=n,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(e){for(let t of this.panels)t.destroy&&e.indexOf(t)<0&&t.destroy();this.panels=e,this.syncDOM()}syncDOM(){if(this.panels.length==0){this.dom&&(this.dom.remove(),this.dom=void 0);return}if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let t=this.container||this.view.dom;t.insertBefore(this.dom,this.top?t.firstChild:null)}let e=this.dom.firstChild;for(let t of this.panels)if(t.dom.parentNode==this.dom){for(;e!=t.dom;)e=cb(e);e=e.nextSibling}else this.dom.insertBefore(t.dom,e);for(;e;)e=cb(e)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(!(!this.container||this.classes==this.view.themeClasses)){for(let e of this.classes.split(" "))e&&this.container.classList.remove(e);for(let e of(this.classes=this.view.themeClasses).split(" "))e&&this.container.classList.add(e)}}}function cb(r){let e=r.nextSibling;return r.remove(),e}const Wc=Ze.define({enables:zA});class ta extends Ks{compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}eq(e){return!1}destroy(e){}}ta.prototype.elementClass="";ta.prototype.toDOM=void 0;ta.prototype.mapMode=dn.TrackBefore;ta.prototype.startSide=ta.prototype.endSide=-1;ta.prototype.point=!0;const Zu=Ze.define(),Aj=Ze.define(),Ej={class:"",renderEmptyElements:!1,elementStyle:"",markers:()=>Ct.empty,lineMarker:()=>null,widgetMarker:()=>null,lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{}},uc=Ze.define();function Pj(r){return[GA(),uc.of(Object.assign(Object.assign({},Ej),r))]}const hb=Ze.define({combine:r=>r.some(e=>e)});function GA(r){return[Rj]}const Rj=pr.fromClass(class{constructor(r){this.view=r,this.prevViewport=r.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.gutters=r.state.facet(uc).map(e=>new db(r,e));for(let e of this.gutters)this.dom.appendChild(e.dom);this.fixed=!r.state.facet(hb),this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),r.scrollDOM.insertBefore(this.dom,r.contentDOM)}update(r){if(this.updateGutters(r)){let e=this.prevViewport,t=r.view.viewport,n=Math.min(e.to,t.to)-Math.max(e.from,t.from);this.syncGutters(n<(t.to-t.from)*.8)}r.geometryChanged&&(this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px"),this.view.state.facet(hb)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":""),this.prevViewport=r.view.viewport}syncGutters(r){let e=this.dom.nextSibling;r&&this.dom.remove();let t=Ct.iter(this.view.state.facet(Zu),this.view.viewport.from),n=[],i=this.gutters.map(s=>new Qj(s,this.view.viewport,-this.view.documentPadding.top));for(let s of this.view.viewportLineBlocks)if(n.length&&(n=[]),Array.isArray(s.type)){let a=!0;for(let o of s.type)if(o.type==Mn.Text&&a){$g(t,n,o.from);for(let l of i)l.line(this.view,o,n);a=!1}else if(o.widget)for(let l of i)l.widget(this.view,o)}else if(s.type==Mn.Text){$g(t,n,s.from);for(let a of i)a.line(this.view,s,n)}else if(s.widget)for(let a of i)a.widget(this.view,s);for(let s of i)s.finish();r&&this.view.scrollDOM.insertBefore(this.dom,e)}updateGutters(r){let e=r.startState.facet(uc),t=r.state.facet(uc),n=r.docChanged||r.heightChanged||r.viewportChanged||!Ct.eq(r.startState.facet(Zu),r.state.facet(Zu),r.view.viewport.from,r.view.viewport.to);if(e==t)for(let i of this.gutters)i.update(r)&&(n=!0);else{n=!0;let i=[];for(let s of t){let a=e.indexOf(s);a<0?i.push(new db(this.view,s)):(this.gutters[a].update(r),i.push(this.gutters[a]))}for(let s of this.gutters)s.dom.remove(),i.indexOf(s)<0&&s.destroy();for(let s of i)this.dom.appendChild(s.dom);this.gutters=i}return n}destroy(){for(let r of this.gutters)r.destroy();this.dom.remove()}},{provide:r=>We.scrollMargins.of(e=>{let t=e.plugin(r);return!t||t.gutters.length==0||!t.fixed?null:e.textDirection==Et.LTR?{left:t.dom.offsetWidth*e.scaleX}:{right:t.dom.offsetWidth*e.scaleX}})});function ub(r){return Array.isArray(r)?r:[r]}function $g(r,e,t){for(;r.value&&r.from<=t;)r.from==t&&e.push(r.value),r.next()}class Qj{constructor(e,t,n){this.gutter=e,this.height=n,this.i=0,this.cursor=Ct.iter(e.markers,t.from)}addElement(e,t,n){let{gutter:i}=this,s=(t.top-this.height)/e.scaleY,a=t.height/e.scaleY;if(this.i==i.elements.length){let o=new HA(e,a,s,n);i.elements.push(o),i.dom.appendChild(o.dom)}else i.elements[this.i].update(e,a,s,n);this.height=t.bottom,this.i++}line(e,t,n){let i=[];$g(this.cursor,i,t.from),n.length&&(i=i.concat(n));let s=this.gutter.config.lineMarker(e,t,i);s&&i.unshift(s);let a=this.gutter;i.length==0&&!a.config.renderEmptyElements||this.addElement(e,t,i)}widget(e,t){let n=this.gutter.config.widgetMarker(e,t.widget,t),i=n?[n]:null;for(let s of e.state.facet(Aj)){let a=s(e,t.widget,t);a&&(i||(i=[])).push(a)}i&&this.addElement(e,t,i)}finish(){let e=this.gutter;for(;e.elements.length>this.i;){let t=e.elements.pop();e.dom.removeChild(t.dom),t.destroy()}}}class db{constructor(e,t){this.view=e,this.config=t,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let n in t.domEventHandlers)this.dom.addEventListener(n,i=>{let s=i.target,a;if(s!=this.dom&&this.dom.contains(s)){for(;s.parentNode!=this.dom;)s=s.parentNode;let l=s.getBoundingClientRect();a=(l.top+l.bottom)/2}else a=i.clientY;let o=e.lineBlockAtHeight(a-e.documentTop);t.domEventHandlers[n](e,o,i)&&i.preventDefault()});this.markers=ub(t.markers(e)),t.initialSpacer&&(this.spacer=new HA(e,0,0,[t.initialSpacer(e)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(e){let t=this.markers;if(this.markers=ub(this.config.markers(e.view)),this.spacer&&this.config.updateSpacer){let i=this.config.updateSpacer(this.spacer.markers[0],e);i!=this.spacer.markers[0]&&this.spacer.update(e.view,0,0,[i])}let n=e.view.viewport;return!Ct.eq(this.markers,t,n.from,n.to)||(this.config.lineMarkerChange?this.config.lineMarkerChange(e):!1)}destroy(){for(let e of this.elements)e.destroy()}}class HA{constructor(e,t,n,i){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(e,t,n,i)}update(e,t,n,i){this.height!=t&&(this.height=t,this.dom.style.height=t+"px"),this.above!=n&&(this.dom.style.marginTop=(this.above=n)?n+"px":""),Fj(this.markers,i)||this.setMarkers(e,i)}setMarkers(e,t){let n="cm-gutterElement",i=this.dom.firstChild;for(let s=0,a=0;;){let o=a,l=s<t.length?t[s++]:null,f=!1;if(l){let c=l.elementClass;c&&(n+=" "+c);for(let h=a;h<this.markers.length;h++)if(this.markers[h].compare(l)){o=h,f=!0;break}}else o=this.markers.length;for(;a<o;){let c=this.markers[a++];if(c.toDOM){c.destroy(i);let h=i.nextSibling;i.remove(),i=h}}if(!l)break;l.toDOM&&(f?i=i.nextSibling:this.dom.insertBefore(l.toDOM(e),i)),f&&a++}this.dom.className=n,this.markers=t}destroy(){this.setMarkers(null,[])}}function Fj(r,e){if(r.length!=e.length)return!1;for(let t=0;t<r.length;t++)if(!r[t].compare(e[t]))return!1;return!0}const $j=Ze.define(),Dj=Ze.define(),sl=Ze.define({combine(r){return Ls(r,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(e,t){let n=Object.assign({},e);for(let i in t){let s=n[i],a=t[i];n[i]=s?(o,l,f)=>s(o,l,f)||a(o,l,f):a}return n}})}});class Ap extends ta{constructor(e){super(),this.number=e}eq(e){return this.number==e.number}toDOM(){return document.createTextNode(this.number)}}function Ep(r,e){return r.state.facet(sl).formatNumber(e,r.state)}const Nj=uc.compute([sl],r=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers(e){return e.state.facet($j)},lineMarker(e,t,n){return n.some(i=>i.toDOM)?null:new Ap(Ep(e,e.state.doc.lineAt(t.from).number))},widgetMarker:(e,t,n)=>{for(let i of e.state.facet(Dj)){let s=i(e,t,n);if(s)return s}return null},lineMarkerChange:e=>e.startState.facet(sl)!=e.state.facet(sl),initialSpacer(e){return new Ap(Ep(e,pb(e.state.doc.lines)))},updateSpacer(e,t){let n=Ep(t.view,pb(t.view.state.doc.lines));return n==e.number?e:new Ap(n)},domEventHandlers:r.facet(sl).domEventHandlers}));function Mj(r={}){return[sl.of(r),GA(),Nj]}function pb(r){let e=9;for(;e<r;)e=e*10+9;return e}const Ij=new class extends ta{constructor(){super(...arguments),this.elementClass="cm-activeLineGutter"}},Lj=Zu.compute(["selection"],r=>{let e=[],t=-1;for(let n of r.selection.ranges){let i=r.doc.lineAt(n.head).from;i>t&&(t=i,e.push(Ij.range(i)))}return Ct.of(e)});function Bj(){return Lj}const Zj=1024;let Wj=0,Pp=class{constructor(e,t){this.from=e,this.to=t}},Pt=class{constructor(e={}){this.id=Wj++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof e!="function"&&(e=Ps.match(e)),t=>{let n=e(t);return n===void 0?null:[this,n]}}};Pt.closedBy=new Pt({deserialize:r=>r.split(" ")});Pt.openedBy=new Pt({deserialize:r=>r.split(" ")});Pt.group=new Pt({deserialize:r=>r.split(" ")});Pt.isolate=new Pt({deserialize:r=>{if(r&&r!="rtl"&&r!="ltr"&&r!="auto")throw new RangeError("Invalid value for isolate: "+r);return r||"auto"}});Pt.contextHash=new Pt({perNode:!0});Pt.lookAhead=new Pt({perNode:!0});Pt.mounted=new Pt({perNode:!0});let Md=class{constructor(e,t,n){this.tree=e,this.overlay=t,this.parser=n}static get(e){return e&&e.props&&e.props[Pt.mounted.id]}};const Uj=Object.create(null);let Ps=class YA{constructor(e,t,n,i=0){this.name=e,this.props=t,this.id=n,this.flags=i}static define(e){let t=e.props&&e.props.length?Object.create(null):Uj,n=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(e.name==null?8:0),i=new YA(e.name||"",t,e.id,n);if(e.props){for(let s of e.props)if(Array.isArray(s)||(s=s(i)),s){if(s[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");t[s[0].id]=s[1]}}return i}prop(e){return this.props[e.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(e){if(typeof e=="string"){if(this.name==e)return!0;let t=this.prop(Pt.group);return t?t.indexOf(e)>-1:!1}return this.id==e}static match(e){let t=Object.create(null);for(let n in e)for(let i of n.split(" "))t[i]=e[n];return n=>{for(let i=n.prop(Pt.group),s=-1;s<(i?i.length:0);s++){let a=t[s<0?n.name:i[s]];if(a)return a}}}};Ps.none=new Ps("",Object.create(null),0,8);const lu=new WeakMap,mb=new WeakMap;var on;(function(r){r[r.ExcludeBuffers=1]="ExcludeBuffers",r[r.IncludeAnonymous=2]="IncludeAnonymous",r[r.IgnoreMounts=4]="IgnoreMounts",r[r.IgnoreOverlays=8]="IgnoreOverlays"})(on||(on={}));let fi=class Dg{constructor(e,t,n,i,s){if(this.type=e,this.children=t,this.positions=n,this.length=i,this.props=null,s&&s.length){this.props=Object.create(null);for(let[a,o]of s)this.props[typeof a=="number"?a:a.id]=o}}toString(){let e=Md.get(this);if(e&&!e.overlay)return e.tree.toString();let t="";for(let n of this.children){let i=n.toString();i&&(t&&(t+=","),t+=i)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(t.length?"("+t+")":""):t}cursor(e=0){return new Ig(this.topNode,e)}cursorAt(e,t=0,n=0){let i=lu.get(this)||this.topNode,s=new Ig(i);return s.moveTo(e,t),lu.set(this,s._tree),s}get topNode(){return new Ma(this,0,0,null)}resolve(e,t=0){let n=Uc(lu.get(this)||this.topNode,e,t,!1);return lu.set(this,n),n}resolveInner(e,t=0){let n=Uc(mb.get(this)||this.topNode,e,t,!0);return mb.set(this,n),n}resolveStack(e,t=0){return jj(this,e,t)}iterate(e){let{enter:t,leave:n,from:i=0,to:s=this.length}=e,a=e.mode||0,o=(a&on.IncludeAnonymous)>0;for(let l=this.cursor(a|on.IncludeAnonymous);;){let f=!1;if(l.from<=s&&l.to>=i&&(!o&&l.type.isAnonymous||t(l)!==!1)){if(l.firstChild())continue;f=!0}for(;f&&n&&(o||!l.type.isAnonymous)&&n(l),!l.nextSibling();){if(!l.parent())return;f=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let t in this.props)e.push([+t,this.props[t]]);return e}balance(e={}){return this.children.length<=8?this:xx(Ps.none,this.children,this.positions,0,this.children.length,0,this.length,(t,n,i)=>new Dg(this.type,t,n,i,this.propValues),e.makeTree||((t,n,i)=>new Dg(Ps.none,t,n,i)))}static build(e){return zj(e)}};fi.empty=new fi(Ps.none,[],[],0);let Xj=class KA{constructor(e,t){this.buffer=e,this.index=t}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new KA(this.buffer,this.index)}},Ml=class JA{constructor(e,t,n){this.buffer=e,this.length=t,this.set=n}get type(){return Ps.none}toString(){let e=[];for(let t=0;t<this.buffer.length;)e.push(this.childString(t)),t=this.buffer[t+3];return e.join(",")}childString(e){let t=this.buffer[e],n=this.buffer[e+3],i=this.set.types[t],s=i.name;if(/\W/.test(s)&&!i.isError&&(s=JSON.stringify(s)),e+=4,n==e)return s;let a=[];for(;e<n;)a.push(this.childString(e)),e=this.buffer[e+3];return s+"("+a.join(",")+")"}findChild(e,t,n,i,s){let{buffer:a}=this,o=-1;for(let l=e;l!=t&&!(e4(s,i,a[l+1],a[l+2])&&(o=l,n>0));l=a[l+3]);return o}slice(e,t,n){let i=this.buffer,s=new Uint16Array(t-e),a=0;for(let o=e,l=0;o<t;){s[l++]=i[o++],s[l++]=i[o++]-n;let f=s[l++]=i[o++]-n;s[l++]=i[o++]-e,a=Math.max(a,f)}return new JA(s,a,this.set)}};function e4(r,e,t,n){switch(r){case-2:return t<e;case-1:return n>=e&&t<e;case 0:return t<e&&n>e;case 1:return t<=e&&n>e;case 2:return n>e;case 4:return!0}}function Uc(r,e,t,n){for(var i;r.from==r.to||(t<1?r.from>=e:r.from>e)||(t>-1?r.to<=e:r.to<e);){let a=!n&&r instanceof Ma&&r.index<0?null:r.parent;if(!a)return r;r=a}let s=n?0:on.IgnoreOverlays;if(n)for(let a=r,o=a.parent;o;a=o,o=a.parent)a instanceof Ma&&a.index<0&&((i=o.enter(e,t,s))===null||i===void 0?void 0:i.from)!=a.from&&(r=o);for(;;){let a=r.enter(e,t,s);if(!a)return r;r=a}}let t4=class{cursor(e=0){return new Ig(this,e)}getChild(e,t=null,n=null){let i=gb(this,e,t,n);return i.length?i[0]:null}getChildren(e,t=null,n=null){return gb(this,e,t,n)}resolve(e,t=0){return Uc(this,e,t,!1)}resolveInner(e,t=0){return Uc(this,e,t,!0)}matchContext(e){return Ng(this.parent,e)}enterUnfinishedNodesBefore(e){let t=this.childBefore(e),n=this;for(;t;){let i=t.lastChild;if(!i||i.to!=t.to)break;i.type.isError&&i.from==i.to?(n=t,t=i.prevSibling):t=i}return n}get node(){return this}get next(){return this.parent}},Ma=class Wu extends t4{constructor(e,t,n,i){super(),this._tree=e,this.from=t,this.index=n,this._parent=i}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,t,n,i,s=0){for(let a=this;;){for(let{children:o,positions:l}=a._tree,f=t>0?o.length:-1;e!=f;e+=t){let c=o[e],h=l[e]+a.from;if(e4(i,n,h,h+c.length)){if(c instanceof Ml){if(s&on.ExcludeBuffers)continue;let u=c.findChild(0,c.buffer.length,t,n-h,i);if(u>-1)return new Mg(new Vj(a,c,e,h),null,u)}else if(s&on.IncludeAnonymous||!c.type.isAnonymous||Ox(c)){let u;if(!(s&on.IgnoreMounts)&&(u=Md.get(c))&&!u.overlay)return new Wu(u.tree,h,e,a);let d=new Wu(c,h,e,a);return s&on.IncludeAnonymous||!d.type.isAnonymous?d:d.nextChild(t<0?c.children.length-1:0,t,n,i)}}}if(s&on.IncludeAnonymous||!a.type.isAnonymous||(a.index>=0?e=a.index+t:e=t<0?-1:a._parent._tree.children.length,a=a._parent,!a))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}enter(e,t,n=0){let i;if(!(n&on.IgnoreOverlays)&&(i=Md.get(this._tree))&&i.overlay){let s=e-this.from;for(let{from:a,to:o}of i.overlay)if((t>0?a<=s:a<s)&&(t<0?o>=s:o>s))return new Wu(i.tree,i.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,t,n)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}};function gb(r,e,t,n){let i=r.cursor(),s=[];if(!i.firstChild())return s;if(t!=null){for(let a=!1;!a;)if(a=i.type.is(t),!i.nextSibling())return s}for(;;){if(n!=null&&i.type.is(n))return s;if(i.type.is(e)&&s.push(i.node),!i.nextSibling())return n==null?s:[]}}function Ng(r,e,t=e.length-1){for(let n=r;t>=0;n=n.parent){if(!n)return!1;if(!n.type.isAnonymous){if(e[t]&&e[t]!=n.name)return!1;t--}}return!0}let Vj=class{constructor(e,t,n,i){this.parent=e,this.buffer=t,this.index=n,this.start=i}},Mg=class Wf extends t4{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(e,t,n){super(),this.context=e,this._parent=t,this.index=n,this.type=e.buffer.set.types[e.buffer.buffer[n]]}child(e,t,n){let{buffer:i}=this.context,s=i.findChild(this.index+4,i.buffer[this.index+3],e,t-this.context.start,n);return s<0?null:new Wf(this.context,this,s)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}enter(e,t,n=0){if(n&on.ExcludeBuffers)return null;let{buffer:i}=this.context,s=i.findChild(this.index+4,i.buffer[this.index+3],t>0?1:-1,e-this.context.start,t);return s<0?null:new Wf(this.context,this,s)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,t=e.buffer[this.index+3];return t<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new Wf(this.context,this._parent,t):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,t=this._parent?this._parent.index+4:0;return this.index==t?this.externalSibling(-1):new Wf(this.context,this._parent,e.findChild(t,this.index,-1,0,4))}get tree(){return null}toTree(){let e=[],t=[],{buffer:n}=this.context,i=this.index+4,s=n.buffer[this.index+3];if(s>i){let a=n.buffer[this.index+1];e.push(n.slice(i,s,a)),t.push(0)}return new fi(this.type,e,t,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}};function r4(r){if(!r.length)return null;let e=0,t=r[0];for(let s=1;s<r.length;s++){let a=r[s];(a.from>t.from||a.to<t.to)&&(t=a,e=s)}let n=t instanceof Ma&&t.index<0?null:t.parent,i=r.slice();return n?i[e]=n:i.splice(e,1),new qj(i,t)}let qj=class{constructor(e,t){this.heads=e,this.node=t}get next(){return r4(this.heads)}};function jj(r,e,t){let n=r.resolveInner(e,t),i=null;for(let s=n instanceof Ma?n:n.context.parent;s;s=s.parent)if(s.index<0){let a=s.parent;(i||(i=[n])).push(a.resolve(e,t)),s=a}else{let a=Md.get(s.tree);if(a&&a.overlay&&a.overlay[0].from<=e&&a.overlay[a.overlay.length-1].to>=e){let o=new Ma(a.tree,a.overlay[0].from+s.from,-1,s);(i||(i=[n])).push(Uc(o,e,t,!1))}}return i?r4(i):n}let Ig=class{get name(){return this.type.name}constructor(e,t=0){if(this.mode=t,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,e instanceof Ma)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let n=e._parent;n;n=n._parent)this.stack.unshift(n.index);this.bufferNode=e,this.yieldBuf(e.index)}}yieldNode(e){return e?(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0):!1}yieldBuf(e,t){this.index=e;let{start:n,buffer:i}=this.buffer;return this.type=t||i.set.types[i.buffer[e]],this.from=n+i.buffer[e+1],this.to=n+i.buffer[e+2],!0}yield(e){return e?e instanceof Ma?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,t,n){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,t,n,this.mode));let{buffer:i}=this.buffer,s=i.findChild(this.index+4,i.buffer[this.index+3],e,t-this.buffer.start,n);return s<0?!1:(this.stack.push(this.index),this.yieldBuf(s))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,t,n=this.mode){return this.buffer?n&on.ExcludeBuffers?!1:this.enterChild(1,e,t):this.yield(this._tree.enter(e,t,n))}parent(){if(!this.buffer)return this.yieldNode(this.mode&on.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&on.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode)):!1;let{buffer:t}=this.buffer,n=this.stack.length-1;if(e<0){let i=n<0?0:this.stack[n]+4;if(this.index!=i)return this.yieldBuf(t.findChild(i,this.index,-1,0,4))}else{let i=t.buffer[this.index+3];if(i<(n<0?t.buffer.length:t.buffer[this.stack[n]+3]))return this.yieldBuf(i)}return n<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let t,n,{buffer:i}=this;if(i){if(e>0){if(this.index<i.buffer.buffer.length)return!1}else for(let s=0;s<this.index;s++)if(i.buffer.buffer[s+3]<this.index)return!1;({index:t,parent:n}=i)}else({index:t,_parent:n}=this._tree);for(;n;{index:t,_parent:n}=n)if(t>-1)for(let s=t+e,a=e<0?-1:n._tree.children.length;s!=a;s+=e){let o=n._tree.children[s];if(this.mode&on.IncludeAnonymous||o instanceof Ml||!o.type.isAnonymous||Ox(o))return!1}return!0}move(e,t){if(t&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,t=0){for(;(this.from==this.to||(t<1?this.from>=e:this.from>e)||(t>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,t););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,t=null,n=0;if(e&&e.context==this.buffer)e:for(let i=this.index,s=this.stack.length;s>=0;){for(let a=e;a;a=a._parent)if(a.index==i){if(i==this.index)return a;t=a,n=s+1;break e}i=this.stack[--s]}for(let i=n;i<this.stack.length;i++)t=new Mg(this.buffer,t,this.stack[i]);return this.bufferNode=new Mg(this.buffer,t,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,t){for(let n=0;;){let i=!1;if(this.type.isAnonymous||e(this)!==!1){if(this.firstChild()){n++;continue}this.type.isAnonymous||(i=!0)}for(;;){if(i&&t&&t(this),i=this.type.isAnonymous,!n)return;if(this.nextSibling())break;this.parent(),n--,i=!0}}}matchContext(e){if(!this.buffer)return Ng(this.node.parent,e);let{buffer:t}=this.buffer,{types:n}=t.set;for(let i=e.length-1,s=this.stack.length-1;i>=0;s--){if(s<0)return Ng(this._tree,e,i);let a=n[t.buffer[this.stack[s]]];if(!a.isAnonymous){if(e[i]&&e[i]!=a.name)return!1;i--}}return!0}};function Ox(r){return r.children.some(e=>e instanceof Ml||!e.type.isAnonymous||Ox(e))}function zj(r){var e;let{buffer:t,nodeSet:n,maxBufferLength:i=Zj,reused:s=[],minRepeatType:a=n.types.length}=r,o=Array.isArray(t)?new Xj(t,t.length):t,l=n.types,f=0,c=0;function h(y,b,x,A,k,E){let{id:T,start:_,end:N,size:Z}=o,z=c,ee=f;for(;Z<0;)if(o.next(),Z==-1){let ie=s[T];x.push(ie),A.push(_-y);return}else if(Z==-3){f=T;return}else if(Z==-4){c=T;return}else throw new RangeError(`Unrecognized record size: ${Z}`);let ae=l[T],xe,V,ue=_-y;if(N-_<=i&&(V=g(o.pos-b,k))){let ie=new Uint16Array(V.size-V.skip),P=o.pos-V.size,I=ie.length;for(;o.pos>P;)I=O(V.start,ie,I);xe=new Ml(ie,N-V.start,n),ue=V.start-y}else{let ie=o.pos-Z;o.next();let P=[],I=[],B=T>=a?T:-1,W=0,K=N;for(;o.pos>ie;)B>=0&&o.id==B&&o.size>=0?(o.end<=K-i&&(p(P,I,_,W,o.end,K,B,z,ee),W=P.length,K=o.end),o.next()):E>2500?u(_,ie,P,I):h(_,ie,P,I,B,E+1);if(B>=0&&W>0&&W<P.length&&p(P,I,_,W,_,K,B,z,ee),P.reverse(),I.reverse(),B>-1&&W>0){let re=d(ae,ee);xe=xx(ae,P,I,0,P.length,0,N-_,re,re)}else xe=m(ae,P,I,N-_,z-N,ee)}x.push(xe),A.push(ue)}function u(y,b,x,A){let k=[],E=0,T=-1;for(;o.pos>b;){let{id:_,start:N,end:Z,size:z}=o;if(z>4)o.next();else{if(T>-1&&N<T)break;T<0&&(T=Z-i),k.push(_,N,Z),E++,o.next()}}if(E){let _=new Uint16Array(E*4),N=k[k.length-2];for(let Z=k.length-3,z=0;Z>=0;Z-=3)_[z++]=k[Z],_[z++]=k[Z+1]-N,_[z++]=k[Z+2]-N,_[z++]=z;x.push(new Ml(_,k[2]-N,n)),A.push(N-y)}}function d(y,b){return(x,A,k)=>{let E=0,T=x.length-1,_,N;if(T>=0&&(_=x[T])instanceof fi){if(!T&&_.type==y&&_.length==k)return _;(N=_.prop(Pt.lookAhead))&&(E=A[T]+_.length+N)}return m(y,x,A,k,E,b)}}function p(y,b,x,A,k,E,T,_,N){let Z=[],z=[];for(;y.length>A;)Z.push(y.pop()),z.push(b.pop()+x-k);y.push(m(n.types[T],Z,z,E-k,_-E,N)),b.push(k-x)}function m(y,b,x,A,k,E,T){if(E){let _=[Pt.contextHash,E];T=T?[_].concat(T):[_]}if(k>25){let _=[Pt.lookAhead,k];T=T?[_].concat(T):[_]}return new fi(y,b,x,A,T)}function g(y,b){let x=o.fork(),A=0,k=0,E=0,T=x.end-i,_={size:0,start:0,skip:0};e:for(let N=x.pos-y;x.pos>N;){let Z=x.size;if(x.id==b&&Z>=0){_.size=A,_.start=k,_.skip=E,E+=4,A+=4,x.next();continue}let z=x.pos-Z;if(Z<0||z<N||x.start<T)break;let ee=x.id>=a?4:0,ae=x.start;for(x.next();x.pos>z;){if(x.size<0)if(x.size==-3)ee+=4;else break e;else x.id>=a&&(ee+=4);x.next()}k=ae,A+=Z,E+=ee}return(b<0||A==y)&&(_.size=A,_.start=k,_.skip=E),_.size>4?_:void 0}function O(y,b,x){let{id:A,start:k,end:E,size:T}=o;if(o.next(),T>=0&&A<a){let _=x;if(T>4){let N=o.pos-(T-4);for(;o.pos>N;)x=O(y,b,x)}b[--x]=_,b[--x]=E-y,b[--x]=k-y,b[--x]=A}else T==-3?f=A:T==-4&&(c=A);return x}let w=[],v=[];for(;o.pos>0;)h(r.start||0,r.bufferStart||0,w,v,-1,0);let S=(e=r.length)!==null&&e!==void 0?e:w.length?v[0]+w[0].length:0;return new fi(l[r.topID],w.reverse(),v.reverse(),S)}const Ob=new WeakMap;function Uu(r,e){if(!r.isAnonymous||e instanceof Ml||e.type!=r)return 1;let t=Ob.get(e);if(t==null){t=1;for(let n of e.children){if(n.type!=r||!(n instanceof fi)){t=1;break}t+=Uu(r,n)}Ob.set(e,t)}return t}function xx(r,e,t,n,i,s,a,o,l){let f=0;for(let p=n;p<i;p++)f+=Uu(r,e[p]);let c=Math.ceil(f*1.5/8),h=[],u=[];function d(p,m,g,O,w){for(let v=g;v<O;){let S=v,y=m[v],b=Uu(r,p[v]);for(v++;v<O;v++){let x=Uu(r,p[v]);if(b+x>=c)break;b+=x}if(v==S+1){if(b>c){let x=p[S];d(x.children,x.positions,0,x.children.length,m[S]+w);continue}h.push(p[S])}else{let x=m[v-1]+p[v-1].length-y;h.push(xx(r,p,m,S,v,y,x,null,l))}u.push(y+w-s)}}return d(e,t,n,i,0),(o||l)(h,u,a)}let Xu=class Lg{constructor(e,t,n,i,s=!1,a=!1){this.from=e,this.to=t,this.tree=n,this.offset=i,this.open=(s?1:0)|(a?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(e,t=[],n=!1){let i=[new Lg(0,e.length,e,0,!1,n)];for(let s of t)s.to>e.length&&i.push(s);return i}static applyChanges(e,t,n=128){if(!t.length)return e;let i=[],s=1,a=e.length?e[0]:null;for(let o=0,l=0,f=0;;o++){let c=o<t.length?t[o]:null,h=c?c.fromA:1e9;if(h-l>=n)for(;a&&a.from<h;){let u=a;if(l>=u.from||h<=u.to||f){let d=Math.max(u.from,l)-f,p=Math.min(u.to,h)-f;u=d>=p?null:new Lg(d,p,u.tree,u.offset+f,o>0,!!c)}if(u&&i.push(u),a.to>h)break;a=s<e.length?e[s++]:null}if(!c)break;l=c.toA,f=c.toA-c.toB}return i}},Gj=class{startParse(e,t,n){return typeof e=="string"&&(e=new Hj(e)),n=n?n.length?n.map(i=>new Pp(i.from,i.to)):[new Pp(0,0)]:[new Pp(0,e.length)],this.createParse(e,t||[],n)}parse(e,t,n){let i=this.startParse(e,t,n);for(;;){let s=i.advance();if(s)return s}}},Hj=class{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,t){return this.string.slice(e,t)}};new Pt({perNode:!0});let Yj=0,Vr=class{constructor(e={}){this.id=Yj++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof e!="function"&&(e=Bg.match(e)),t=>{let n=e(t);return n===void 0?null:[this,n]}}};Vr.closedBy=new Vr({deserialize:r=>r.split(" ")});Vr.openedBy=new Vr({deserialize:r=>r.split(" ")});Vr.group=new Vr({deserialize:r=>r.split(" ")});Vr.isolate=new Vr({deserialize:r=>{if(r&&r!="rtl"&&r!="ltr"&&r!="auto")throw new RangeError("Invalid value for isolate: "+r);return r||"auto"}});Vr.contextHash=new Vr({perNode:!0});Vr.lookAhead=new Vr({perNode:!0});Vr.mounted=new Vr({perNode:!0});const Kj=Object.create(null);let Bg=class n4{constructor(e,t,n,i=0){this.name=e,this.props=t,this.id=n,this.flags=i}static define(e){let t=e.props&&e.props.length?Object.create(null):Kj,n=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(e.name==null?8:0),i=new n4(e.name||"",t,e.id,n);if(e.props){for(let s of e.props)if(Array.isArray(s)||(s=s(i)),s){if(s[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");t[s[0].id]=s[1]}}return i}prop(e){return this.props[e.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(e){if(typeof e=="string"){if(this.name==e)return!0;let t=this.prop(Vr.group);return t?t.indexOf(e)>-1:!1}return this.id==e}static match(e){let t=Object.create(null);for(let n in e)for(let i of n.split(" "))t[i]=e[n];return n=>{for(let i=n.prop(Vr.group),s=-1;s<(i?i.length:0);s++){let a=t[s<0?n.name:i[s]];if(a)return a}}}};Bg.none=new Bg("",Object.create(null),0,8);var xb;(function(r){r[r.ExcludeBuffers=1]="ExcludeBuffers",r[r.IncludeAnonymous=2]="IncludeAnonymous",r[r.IgnoreMounts=4]="IgnoreMounts",r[r.IgnoreOverlays=8]="IgnoreOverlays"})(xb||(xb={}));new Vr({perNode:!0});let Jj=0;class Ci{constructor(e,t,n,i){this.name=e,this.set=t,this.base=n,this.modified=i,this.id=Jj++}toString(){let{name:e}=this;for(let t of this.modified)t.name&&(e=`${t.name}(${e})`);return e}static define(e,t){let n=typeof e=="string"?e:"?";if(e instanceof Ci&&(t=e),t!=null&&t.base)throw new Error("Can not derive from a modified tag");let i=new Ci(n,[],null,[]);if(i.set.push(i),t)for(let s of t.set)i.set.push(s);return i}static defineModifier(e){let t=new Id(e);return n=>n.modified.indexOf(t)>-1?n:Id.get(n.base||n,n.modified.concat(t).sort((i,s)=>i.id-s.id))}}let ez=0;class Id{constructor(e){this.name=e,this.instances=[],this.id=ez++}static get(e,t){if(!t.length)return e;let n=t[0].instances.find(o=>o.base==e&&tz(t,o.modified));if(n)return n;let i=[],s=new Ci(e.name,i,e,t);for(let o of t)o.instances.push(s);let a=rz(t);for(let o of e.set)if(!o.modified.length)for(let l of a)i.push(Id.get(o,l));return s}}function tz(r,e){return r.length==e.length&&r.every((t,n)=>t==e[n])}function rz(r){let e=[[]];for(let t=0;t<r.length;t++)for(let n=0,i=e.length;n<i;n++)e.push(e[n].concat(r[t]));return e.sort((t,n)=>n.length-t.length)}function oa(r){let e=Object.create(null);for(let t in r){let n=r[t];Array.isArray(n)||(n=[n]);for(let i of t.split(" "))if(i){let s=[],a=2,o=i;for(let h=0;;){if(o=="..."&&h>0&&h+3==i.length){a=1;break}let u=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(o);if(!u)throw new RangeError("Invalid path: "+i);if(s.push(u[0]=="*"?"":u[0][0]=='"'?JSON.parse(u[0]):u[0]),h+=u[0].length,h==i.length)break;let d=i[h++];if(h==i.length&&d=="!"){a=0;break}if(d!="/")throw new RangeError("Invalid path: "+i);o=i.slice(h)}let l=s.length-1,f=s[l];if(!f)throw new RangeError("Invalid path: "+i);let c=new Ld(n,a,l>0?s.slice(0,l):null);e[f]=c.sort(e[f])}}return i4.add(e)}const i4=new Vr;class Ld{constructor(e,t,n,i){this.tags=e,this.mode=t,this.context=n,this.next=i}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(e){return!e||e.depth<this.depth?(this.next=e,this):(e.next=this.sort(e.next),e)}get depth(){return this.context?this.context.length:0}}Ld.empty=new Ld([],2,null);function af(r,e){let t=Object.create(null);for(let s of r)if(!Array.isArray(s.tag))t[s.tag.id]=s.class;else for(let a of s.tag)t[a.id]=s.class;let{scope:n,all:i=null}=e||{};return{style:s=>{let a=i;for(let o of s)for(let l of o.set){let f=t[l.id];if(f){a=a?a+" "+f:f;break}}return a},scope:n}}function nz(r,e){let t=null;for(let n of r){let i=n.style(e);i&&(t=t?t+" "+i:i)}return t}function iz(r,e,t,n=0,i=r.length){let s=new sz(n,Array.isArray(e)?e:[e],t);s.highlightRange(r.cursor(),n,i,"",s.highlighters),s.flush(i)}class sz{constructor(e,t,n){this.at=e,this.highlighters=t,this.span=n,this.class=""}startSpan(e,t){t!=this.class&&(this.flush(e),e>this.at&&(this.at=e),this.class=t)}flush(e){e>this.at&&this.class&&this.span(this.at,e,this.class)}highlightRange(e,t,n,i,s){let{type:a,from:o,to:l}=e;if(o>=n||l<=t)return;a.isTop&&(s=this.highlighters.filter(d=>!d.scope||d.scope(a)));let f=i,c=az(e)||Ld.empty,h=nz(s,c.tags);if(h&&(f&&(f+=" "),f+=h,c.mode==1&&(i+=(i?" ":"")+h)),this.startSpan(Math.max(t,o),f),c.opaque)return;let u=e.tree&&e.tree.prop(Vr.mounted);if(u&&u.overlay){let d=e.node.enter(u.overlay[0].from+o,1),p=this.highlighters.filter(g=>!g.scope||g.scope(u.tree.type)),m=e.firstChild();for(let g=0,O=o;;g++){let w=g<u.overlay.length?u.overlay[g]:null,v=w?w.from+o:l,S=Math.max(t,O),y=Math.min(n,v);if(S<y&&m)for(;e.from<y&&(this.highlightRange(e,S,y,i,s),this.startSpan(Math.min(y,e.to),f),!(e.to>=v||!e.nextSibling())););if(!w||v>n)break;O=w.to+o,O>t&&(this.highlightRange(d.cursor(),Math.max(t,w.from+o),Math.min(n,O),"",p),this.startSpan(Math.min(n,O),f))}m&&e.parent()}else if(e.firstChild()){u&&(i="");do if(!(e.to<=t)){if(e.from>=n)break;this.highlightRange(e,t,n,i,s),this.startSpan(Math.min(n,e.to),f)}while(e.nextSibling());e.parent()}}}function az(r){let e=r.type.prop(i4);for(;e&&e.context&&!r.matchContext(e.context);)e=e.next;return e||null}const Be=Ci.define,fu=Be(),Oa=Be(),vb=Be(Oa),yb=Be(Oa),xa=Be(),cu=Be(xa),Rp=Be(xa),ms=Be(),ro=Be(ms),hs=Be(),us=Be(),Zg=Be(),vf=Be(Zg),hu=Be(),L={comment:fu,lineComment:Be(fu),blockComment:Be(fu),docComment:Be(fu),name:Oa,variableName:Be(Oa),typeName:vb,tagName:Be(vb),propertyName:yb,attributeName:Be(yb),className:Be(Oa),labelName:Be(Oa),namespace:Be(Oa),macroName:Be(Oa),literal:xa,string:cu,docString:Be(cu),character:Be(cu),attributeValue:Be(cu),number:Rp,integer:Be(Rp),float:Be(Rp),bool:Be(xa),regexp:Be(xa),escape:Be(xa),color:Be(xa),url:Be(xa),keyword:hs,self:Be(hs),null:Be(hs),atom:Be(hs),unit:Be(hs),modifier:Be(hs),operatorKeyword:Be(hs),controlKeyword:Be(hs),definitionKeyword:Be(hs),moduleKeyword:Be(hs),operator:us,derefOperator:Be(us),arithmeticOperator:Be(us),logicOperator:Be(us),bitwiseOperator:Be(us),compareOperator:Be(us),updateOperator:Be(us),definitionOperator:Be(us),typeOperator:Be(us),controlOperator:Be(us),punctuation:Zg,separator:Be(Zg),bracket:vf,angleBracket:Be(vf),squareBracket:Be(vf),paren:Be(vf),brace:Be(vf),content:ms,heading:ro,heading1:Be(ro),heading2:Be(ro),heading3:Be(ro),heading4:Be(ro),heading5:Be(ro),heading6:Be(ro),contentSeparator:Be(ms),list:Be(ms),quote:Be(ms),emphasis:Be(ms),strong:Be(ms),link:Be(ms),monospace:Be(ms),strikethrough:Be(ms),inserted:Be(),deleted:Be(),changed:Be(),invalid:Be(),meta:hu,documentMeta:Be(hu),annotation:Be(hu),processingInstruction:Be(hu),definition:Ci.defineModifier("definition"),constant:Ci.defineModifier("constant"),function:Ci.defineModifier("function"),standard:Ci.defineModifier("standard"),local:Ci.defineModifier("local"),special:Ci.defineModifier("special")};for(let r in L){let e=L[r];e instanceof Ci&&(e.name=r)}af([{tag:L.link,class:"tok-link"},{tag:L.heading,class:"tok-heading"},{tag:L.emphasis,class:"tok-emphasis"},{tag:L.strong,class:"tok-strong"},{tag:L.keyword,class:"tok-keyword"},{tag:L.atom,class:"tok-atom"},{tag:L.bool,class:"tok-bool"},{tag:L.url,class:"tok-url"},{tag:L.labelName,class:"tok-labelName"},{tag:L.inserted,class:"tok-inserted"},{tag:L.deleted,class:"tok-deleted"},{tag:L.literal,class:"tok-literal"},{tag:L.string,class:"tok-string"},{tag:L.number,class:"tok-number"},{tag:[L.regexp,L.escape,L.special(L.string)],class:"tok-string2"},{tag:L.variableName,class:"tok-variableName"},{tag:L.local(L.variableName),class:"tok-variableName tok-local"},{tag:L.definition(L.variableName),class:"tok-variableName tok-definition"},{tag:L.special(L.variableName),class:"tok-variableName2"},{tag:L.definition(L.propertyName),class:"tok-propertyName tok-definition"},{tag:L.typeName,class:"tok-typeName"},{tag:L.namespace,class:"tok-namespace"},{tag:L.className,class:"tok-className"},{tag:L.macroName,class:"tok-macroName"},{tag:L.propertyName,class:"tok-propertyName"},{tag:L.operator,class:"tok-operator"},{tag:L.comment,class:"tok-comment"},{tag:L.meta,class:"tok-meta"},{tag:L.invalid,class:"tok-invalid"},{tag:L.punctuation,class:"tok-punctuation"}]);var Qp;const Uf=new Pt,oz=new Pt;let ws=class{constructor(e,t,n=[],i=""){this.data=e,this.name=i,st.prototype.hasOwnProperty("tree")||Object.defineProperty(st.prototype,"tree",{get(){return En(this)}}),this.parser=t,this.extension=[Ia.of(this),st.languageData.of((s,a,o)=>{let l=wb(s,a,o),f=l.type.prop(Uf);if(!f)return[];let c=s.facet(f),h=l.type.prop(oz);if(h){let u=l.resolve(a-l.from,o);for(let d of h)if(d.test(u,s)){let p=s.facet(d.facet);return d.type=="replace"?p:p.concat(c)}}return c})].concat(n)}isActiveAt(e,t,n=-1){return wb(e,t,n).type.prop(Uf)==this.data}findRegions(e){let t=e.facet(Ia);if((t==null?void 0:t.data)==this.data)return[{from:0,to:e.doc.length}];if(!t||!t.allowsNesting)return[];let n=[],i=(s,a)=>{if(s.prop(Uf)==this.data){n.push({from:a,to:a+s.length});return}let o=s.prop(Pt.mounted);if(o){if(o.tree.prop(Uf)==this.data){if(o.overlay)for(let l of o.overlay)n.push({from:l.from+a,to:l.to+a});else n.push({from:a,to:a+s.length});return}else if(o.overlay){let l=n.length;if(i(o.tree,o.overlay[0].from+a),n.length>l)return}}for(let l=0;l<s.children.length;l++){let f=s.children[l];f instanceof fi&&i(f,s.positions[l]+a)}};return i(En(e),0),n}get allowsNesting(){return!0}};ws.setState=rt.define();function wb(r,e,t){let n=r.facet(Ia),i=En(r).topNode;if(!n||n.allowsNesting)for(let s=i;s;s=s.enter(e,t,on.ExcludeBuffers))s.type.isTop&&(i=s);return i}function En(r){let e=r.field(ws.state,!1);return e?e.tree:fi.empty}let lz=class{constructor(e){this.doc=e,this.cursorPos=0,this.string="",this.cursor=e.iter()}get length(){return this.doc.length}syncTo(e){return this.string=this.cursor.next(e-this.cursorPos).value,this.cursorPos=e+this.string.length,this.cursorPos-this.string.length}chunk(e){return this.syncTo(e),this.string}get lineChunks(){return!0}read(e,t){let n=this.cursorPos-this.string.length;return e<n||t>=this.cursorPos?this.doc.sliceString(e,t):this.string.slice(e-n,t-n)}},yf=null,fz=class Wg{constructor(e,t,n=[],i,s,a,o,l){this.parser=e,this.state=t,this.fragments=n,this.tree=i,this.treeLen=s,this.viewport=a,this.skipped=o,this.scheduleOn=l,this.parse=null,this.tempSkipped=[]}static create(e,t,n){return new Wg(e,t,[],fi.empty,0,n,[],null)}startParse(){return this.parser.startParse(new lz(this.state.doc),this.fragments)}work(e,t){return t!=null&&t>=this.state.doc.length&&(t=void 0),this.tree!=fi.empty&&this.isDone(t??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var n;if(typeof e=="number"){let i=Date.now()+e;e=()=>Date.now()>i}for(this.parse||(this.parse=this.startParse()),t!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>t)&&t<this.state.doc.length&&this.parse.stopAt(t);;){let i=this.parse.advance();if(i)if(this.fragments=this.withoutTempSkipped(Xu.addTree(i,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(n=this.parse.stoppedAt)!==null&&n!==void 0?n:this.state.doc.length,this.tree=i,this.parse=null,this.treeLen<(t??this.state.doc.length))this.parse=this.startParse();else return!0;if(e())return!1}})}takeTree(){let e,t;this.parse&&(e=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>e)&&this.parse.stopAt(e),this.withContext(()=>{for(;!(t=this.parse.advance()););}),this.treeLen=e,this.tree=t,this.fragments=this.withoutTempSkipped(Xu.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(e){let t=yf;yf=this;try{return e()}finally{yf=t}}withoutTempSkipped(e){for(let t;t=this.tempSkipped.pop();)e=bb(e,t.from,t.to);return e}changes(e,t){let{fragments:n,tree:i,treeLen:s,viewport:a,skipped:o}=this;if(this.takeTree(),!e.empty){let l=[];if(e.iterChangedRanges((f,c,h,u)=>l.push({fromA:f,toA:c,fromB:h,toB:u})),n=Xu.applyChanges(n,l),i=fi.empty,s=0,a={from:e.mapPos(a.from,-1),to:e.mapPos(a.to,1)},this.skipped.length){o=[];for(let f of this.skipped){let c=e.mapPos(f.from,1),h=e.mapPos(f.to,-1);c<h&&o.push({from:c,to:h})}}}return new Wg(this.parser,t,n,i,s,a,o,this.scheduleOn)}updateViewport(e){if(this.viewport.from==e.from&&this.viewport.to==e.to)return!1;this.viewport=e;let t=this.skipped.length;for(let n=0;n<this.skipped.length;n++){let{from:i,to:s}=this.skipped[n];i<e.to&&s>e.from&&(this.fragments=bb(this.fragments,i,s),this.skipped.splice(n--,1))}return this.skipped.length>=t?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(e,t){this.skipped.push({from:e,to:t})}static getSkippingParser(e){return new class extends Gj{createParse(t,n,i){let s=i[0].from,a=i[i.length-1].to;return{parsedPos:s,advance(){let l=yf;if(l){for(let f of i)l.tempSkipped.push(f);e&&(l.scheduleOn=l.scheduleOn?Promise.all([l.scheduleOn,e]):e)}return this.parsedPos=a,new fi(Ps.none,[],[],a-s)},stoppedAt:null,stopAt(){}}}}}isDone(e){e=Math.min(e,this.state.doc.length);let t=this.fragments;return this.treeLen>=e&&t.length&&t[0].from==0&&t[0].to>=e}static get(){return yf}};function bb(r,e,t){return Xu.applyChanges(r,[{fromA:e,toA:t,fromB:e,toB:t}])}let Ug=class Xg{constructor(e){this.context=e,this.tree=e.tree}apply(e){if(!e.docChanged&&this.tree==this.context.tree)return this;let t=this.context.changes(e.changes,e.state),n=this.context.treeLen==e.startState.doc.length?void 0:Math.max(e.changes.mapPos(this.context.treeLen),t.viewport.to);return t.work(20,n)||t.takeTree(),new Xg(t)}static init(e){let t=Math.min(3e3,e.doc.length),n=fz.create(e.facet(Ia).parser,e,{from:0,to:t});return n.work(20,t)||n.takeTree(),new Xg(n)}};ws.state=Cr.define({create:Ug.init,update(r,e){for(let t of e.effects)if(t.is(ws.setState))return t.value;return e.startState.facet(Ia)!=e.state.facet(Ia)?Ug.init(e.state):r.apply(e)}});let s4=r=>{let e=setTimeout(()=>r(),500);return()=>clearTimeout(e)};typeof requestIdleCallback<"u"&&(s4=r=>{let e=-1,t=setTimeout(()=>{e=requestIdleCallback(r,{timeout:400})},100);return()=>e<0?clearTimeout(t):cancelIdleCallback(e)});const Fp=typeof navigator<"u"&&(!((Qp=navigator.scheduling)===null||Qp===void 0)&&Qp.isInputPending)?()=>navigator.scheduling.isInputPending():null,cz=pr.fromClass(class{constructor(e){this.view=e,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(e){let t=this.view.state.field(ws.state).context;(t.updateViewport(e.view.viewport)||this.view.viewport.to>t.treeLen)&&this.scheduleWork(),(e.docChanged||e.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(t)}scheduleWork(){if(this.working)return;let{state:e}=this.view,t=e.field(ws.state);(t.tree!=t.context.tree||!t.context.isDone(e.doc.length))&&(this.working=s4(this.work))}work(e){this.working=null;let t=Date.now();if(this.chunkEnd<t&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=t+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:n,viewport:{to:i}}=this.view,s=n.field(ws.state);if(s.tree==s.context.tree&&s.context.isDone(i+1e5))return;let a=Date.now()+Math.min(this.chunkBudget,100,e&&!Fp?Math.max(25,e.timeRemaining()-5):1e9),o=s.context.treeLen<i&&n.doc.length>i+1e3,l=s.context.work(()=>Fp&&Fp()||Date.now()>a,i+(o?0:1e5));this.chunkBudget-=Date.now()-t,(l||this.chunkBudget<=0)&&(s.context.takeTree(),this.view.dispatch({effects:ws.setState.of(new Ug(s.context))})),this.chunkBudget>0&&!(l&&!o)&&this.scheduleWork(),this.checkAsyncSchedule(s.context)}checkAsyncSchedule(e){e.scheduleOn&&(this.workScheduled++,e.scheduleOn.then(()=>this.scheduleWork()).catch(t=>tn(this.view.state,t)).then(()=>this.workScheduled--),e.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),Ia=Ze.define({combine(r){return r.length?r[0]:null},enables:r=>[ws.state,cz,We.contentAttributes.compute([r],e=>{let t=e.facet(r);return t&&t.name?{"data-language":t.name}:{}})]}),hz=Ze.define(),vx=Ze.define({combine:r=>{if(!r.length)return"  ";let e=r[0];if(!e||/\S/.test(e)||Array.from(e).some(t=>t!=e[0]))throw new Error("Invalid indent unit: "+JSON.stringify(r[0]));return e}});function Bd(r){let e=r.facet(vx);return e.charCodeAt(0)==9?r.tabSize*e.length:e.length}function Xc(r,e){let t="",n=r.tabSize,i=r.facet(vx)[0];if(i=="	"){for(;e>=n;)t+="	",e-=n;i=" "}for(let s=0;s<e;s++)t+=i;return t}function yx(r,e){r instanceof st&&(r=new $0(r));for(let n of r.state.facet(hz)){let i=n(r,e);if(i!==void 0)return i}let t=En(r.state);return t.length>=e?dz(r,t,e):null}class $0{constructor(e,t={}){this.state=e,this.options=t,this.unit=Bd(e)}lineAt(e,t=1){let n=this.state.doc.lineAt(e),{simulateBreak:i,simulateDoubleBreak:s}=this.options;return i!=null&&i>=n.from&&i<=n.to?s&&i==e?{text:"",from:e}:(t<0?i<e:i<=e)?{text:n.text.slice(i-n.from),from:i}:{text:n.text.slice(0,i-n.from),from:n.from}:n}textAfterPos(e,t=1){if(this.options.simulateDoubleBreak&&e==this.options.simulateBreak)return"";let{text:n,from:i}=this.lineAt(e,t);return n.slice(e-i,Math.min(n.length,e+100-i))}column(e,t=1){let{text:n,from:i}=this.lineAt(e,t),s=this.countColumn(n,e-i),a=this.options.overrideIndentation?this.options.overrideIndentation(i):-1;return a>-1&&(s+=a-this.countColumn(n,n.search(/\S|$/))),s}countColumn(e,t=e.length){return sf(e,this.state.tabSize,t)}lineIndent(e,t=1){let{text:n,from:i}=this.lineAt(e,t),s=this.options.overrideIndentation;if(s){let a=s(i);if(a>-1)return a}return this.countColumn(n,n.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const uz=new Pt;function dz(r,e,t){let n=e.resolveStack(t),i=e.resolveInner(t,-1).resolve(t,0).enterUnfinishedNodesBefore(t);if(i!=n.node){let s=[];for(let a=i;a&&!(a.from==n.node.from&&a.type==n.node.type);a=a.parent)s.push(a);for(let a=s.length-1;a>=0;a--)n={node:s[a],next:n}}return a4(n,r,t)}function a4(r,e,t){for(let n=r;n;n=n.next){let i=mz(n.node);if(i)return i(wx.create(e,t,n))}return 0}function pz(r){return r.pos==r.options.simulateBreak&&r.options.simulateDoubleBreak}function mz(r){let e=r.type.prop(uz);if(e)return e;let t=r.firstChild,n;if(t&&(n=t.type.prop(Pt.closedBy))){let i=r.lastChild,s=i&&n.indexOf(i.name)>-1;return a=>vz(a,!0,1,void 0,s&&!pz(a)?i.from:void 0)}return r.parent==null?gz:null}function gz(){return 0}class wx extends $0{constructor(e,t,n){super(e.state,e.options),this.base=e,this.pos=t,this.context=n}get node(){return this.context.node}static create(e,t,n){return new wx(e,t,n)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(e){let t=this.state.doc.lineAt(e.from);for(;;){let n=e.resolve(t.from);for(;n.parent&&n.parent.from==n.from;)n=n.parent;if(Oz(n,e))break;t=this.state.doc.lineAt(n.from)}return this.lineIndent(t.from)}continue(){return a4(this.context.next,this.base,this.pos)}}function Oz(r,e){for(let t=e;t;t=t.parent)if(r==t)return!0;return!1}function xz(r){let e=r.node,t=e.childAfter(e.from),n=e.lastChild;if(!t)return null;let i=r.options.simulateBreak,s=r.state.doc.lineAt(t.from),a=i==null||i<=s.from?s.to:Math.min(s.to,i);for(let o=t.to;;){let l=e.childAfter(o);if(!l||l==n)return null;if(!l.type.isSkipped){if(l.from>=a)return null;let f=/^ */.exec(s.text.slice(t.to-s.from))[0].length;return{from:t.from,to:t.to+f}}o=l.to}}function vz(r,e,t,n,i){let s=r.textAfter,a=s.match(/^\s*/)[0].length,o=i==r.pos+a,l=xz(r);return l?o?r.column(l.from):r.column(l.to):r.baseIndent+(o?0:r.unit*t)}const yz=200;function wz(){return st.transactionFilter.of(r=>{if(!r.docChanged||!r.isUserEvent("input.type")&&!r.isUserEvent("input.complete"))return r;let e=r.startState.languageDataAt("indentOnInput",r.startState.selection.main.head);if(!e.length)return r;let t=r.newDoc,{head:n}=r.newSelection.main,i=t.lineAt(n);if(n>i.from+yz)return r;let s=t.sliceString(i.from,n);if(!e.some(f=>f.test(s)))return r;let{state:a}=r,o=-1,l=[];for(let{head:f}of a.selection.ranges){let c=a.doc.lineAt(f);if(c.from==o)continue;o=c.from;let h=yx(a,c.from);if(h==null)continue;let u=/^\s*/.exec(c.text)[0],d=Xc(a,h);u!=d&&l.push({from:c.from,to:c.from+u.length,insert:d})}return l.length?[r,{changes:l,sequential:!0}]:r})}const bz=Ze.define(),_z=new Pt;function kz(r,e,t){let n=En(r);if(n.length<t)return null;let i=n.resolveStack(t,1),s=null;for(let a=i;a;a=a.next){let o=a.node;if(o.to<=t||o.from>t)continue;if(s&&o.from<e)break;let l=o.type.prop(_z);if(l&&(o.to<n.length-50||n.length==r.doc.length||!Sz(o))){let f=l(o,r);f&&f.from<=t&&f.from>=e&&f.to>t&&(s=f)}}return s}function Sz(r){let e=r.lastChild;return e&&e.to==r.to&&e.type.isError}function Zd(r,e,t){for(let n of r.facet(bz)){let i=n(r,e,t);if(i)return i}return kz(r,e,t)}function o4(r,e){let t=e.mapPos(r.from,1),n=e.mapPos(r.to,-1);return t>=n?void 0:{from:t,to:n}}const D0=rt.define({map:o4}),Sh=rt.define({map:o4});function l4(r){let e=[];for(let{head:t}of r.state.selection.ranges)e.some(n=>n.from<=t&&n.to>=t)||e.push(r.lineBlockAt(t));return e}const Do=Cr.define({create(){return je.none},update(r,e){r=r.map(e.changes);for(let t of e.effects)if(t.is(D0)&&!Tz(r,t.value.from,t.value.to)){let{preparePlaceholder:n}=e.state.facet(h4),i=n?je.replace({widget:new Fz(n(e.state,t.value))}):_b;r=r.update({add:[i.range(t.value.from,t.value.to)]})}else t.is(Sh)&&(r=r.update({filter:(n,i)=>t.value.from!=n||t.value.to!=i,filterFrom:t.value.from,filterTo:t.value.to}));if(e.selection){let t=!1,{head:n}=e.selection.main;r.between(n,n,(i,s)=>{i<n&&s>n&&(t=!0)}),t&&(r=r.update({filterFrom:n,filterTo:n,filter:(i,s)=>s<=n||i>=n}))}return r},provide:r=>We.decorations.from(r),toJSON(r,e){let t=[];return r.between(0,e.doc.length,(n,i)=>{t.push(n,i)}),t},fromJSON(r){if(!Array.isArray(r)||r.length%2)throw new RangeError("Invalid JSON for fold state");let e=[];for(let t=0;t<r.length;){let n=r[t++],i=r[t++];if(typeof n!="number"||typeof i!="number")throw new RangeError("Invalid JSON for fold state");e.push(_b.range(n,i))}return je.set(e,!0)}});function Wd(r,e,t){var n;let i=null;return(n=r.field(Do,!1))===null||n===void 0||n.between(e,t,(s,a)=>{(!i||i.from>s)&&(i={from:s,to:a})}),i}function Tz(r,e,t){let n=!1;return r.between(e,e,(i,s)=>{i==e&&s==t&&(n=!0)}),n}function f4(r,e){return r.field(Do,!1)?e:e.concat(rt.appendConfig.of(u4()))}const Cz=r=>{for(let e of l4(r)){let t=Zd(r.state,e.from,e.to);if(t)return r.dispatch({effects:f4(r.state,[D0.of(t),c4(r,t)])}),!0}return!1},Az=r=>{if(!r.state.field(Do,!1))return!1;let e=[];for(let t of l4(r)){let n=Wd(r.state,t.from,t.to);n&&e.push(Sh.of(n),c4(r,n,!1))}return e.length&&r.dispatch({effects:e}),e.length>0};function c4(r,e,t=!0){let n=r.state.doc.lineAt(e.from).number,i=r.state.doc.lineAt(e.to).number;return We.announce.of(`${r.state.phrase(t?"Folded lines":"Unfolded lines")} ${n} ${r.state.phrase("to")} ${i}.`)}const Ez=r=>{let{state:e}=r,t=[];for(let n=0;n<e.doc.length;){let i=r.lineBlockAt(n),s=Zd(e,i.from,i.to);s&&t.push(D0.of(s)),n=(s?r.lineBlockAt(s.to):i).to+1}return t.length&&r.dispatch({effects:f4(r.state,t)}),!!t.length},Pz=r=>{let e=r.state.field(Do,!1);if(!e||!e.size)return!1;let t=[];return e.between(0,r.state.doc.length,(n,i)=>{t.push(Sh.of({from:n,to:i}))}),r.dispatch({effects:t}),!0},Rz=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:Cz},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:Az},{key:"Ctrl-Alt-[",run:Ez},{key:"Ctrl-Alt-]",run:Pz}],Qz={placeholderDOM:null,preparePlaceholder:null,placeholderText:""},h4=Ze.define({combine(r){return Ls(r,Qz)}});function u4(r){return[Do,Nz]}function d4(r,e){let{state:t}=r,n=t.facet(h4),i=a=>{let o=r.lineBlockAt(r.posAtDOM(a.target)),l=Wd(r.state,o.from,o.to);l&&r.dispatch({effects:Sh.of(l)}),a.preventDefault()};if(n.placeholderDOM)return n.placeholderDOM(r,i,e);let s=document.createElement("span");return s.textContent=n.placeholderText,s.setAttribute("aria-label",t.phrase("folded code")),s.title=t.phrase("unfold"),s.className="cm-foldPlaceholder",s.onclick=i,s}const _b=je.replace({widget:new class extends aa{toDOM(r){return d4(r,null)}}});class Fz extends aa{constructor(e){super(),this.value=e}eq(e){return this.value==e.value}toDOM(e){return d4(e,this.value)}}const $z={openText:"",closedText:"",markerDOM:null,domEventHandlers:{},foldingChanged:()=>!1};class $p extends ta{constructor(e,t){super(),this.config=e,this.open=t}eq(e){return this.config==e.config&&this.open==e.open}toDOM(e){if(this.config.markerDOM)return this.config.markerDOM(this.open);let t=document.createElement("span");return t.textContent=this.open?this.config.openText:this.config.closedText,t.title=e.state.phrase(this.open?"Fold line":"Unfold line"),t}}function Dz(r={}){let e=Object.assign(Object.assign({},$z),r),t=new $p(e,!0),n=new $p(e,!1),i=pr.fromClass(class{constructor(a){this.from=a.viewport.from,this.markers=this.buildMarkers(a)}update(a){(a.docChanged||a.viewportChanged||a.startState.facet(Ia)!=a.state.facet(Ia)||a.startState.field(Do,!1)!=a.state.field(Do,!1)||En(a.startState)!=En(a.state)||e.foldingChanged(a))&&(this.markers=this.buildMarkers(a.view))}buildMarkers(a){let o=new Js;for(let l of a.viewportLineBlocks){let f=Wd(a.state,l.from,l.to)?n:Zd(a.state,l.from,l.to)?t:null;f&&o.add(l.from,l.from,f)}return o.finish()}}),{domEventHandlers:s}=e;return[i,Pj({class:"cm-foldGutter",markers(a){var o;return((o=a.plugin(i))===null||o===void 0?void 0:o.markers)||Ct.empty},initialSpacer(){return new $p(e,!1)},domEventHandlers:Object.assign(Object.assign({},s),{click:(a,o,l)=>{if(s.click&&s.click(a,o,l))return!0;let f=Wd(a.state,o.from,o.to);if(f)return a.dispatch({effects:Sh.of(f)}),!0;let c=Zd(a.state,o.from,o.to);return c?(a.dispatch({effects:D0.of(c)}),!0):!1}})}),u4()]}const Nz=We.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});let p4=class m4{constructor(e,t){this.specs=e;let n;function i(o){let l=An.newName();return(n||(n=Object.create(null)))["."+l]=o,l}const s=typeof t.all=="string"?t.all:t.all?i(t.all):void 0,a=t.scope;this.scope=a instanceof ws?o=>o.prop(Uf)==a.data:a?o=>o==a:void 0,this.style=af(e.map(o=>({tag:o.tag,class:o.class||i(Object.assign({},o,{tag:null}))})),{all:s}).style,this.module=n?new An(n):null,this.themeType=t.themeType}static define(e,t){return new m4(e,t||{})}};const Vg=Ze.define(),g4=Ze.define({combine(r){return r.length?[r[0]]:null}});function Dp(r){let e=r.facet(Vg);return e.length?e:r.facet(g4)}function Mz(r,e){let t=[Lz],n;return r instanceof p4&&(r.module&&t.push(We.styleModule.of(r.module)),n=r.themeType),e!=null&&e.fallback?t.push(g4.of(r)):n?t.push(Vg.computeN([We.darkTheme],i=>i.facet(We.darkTheme)==(n=="dark")?[r]:[])):t.push(Vg.of(r)),t}class Iz{constructor(e){this.markCache=Object.create(null),this.tree=En(e.state),this.decorations=this.buildDeco(e,Dp(e.state)),this.decoratedTo=e.viewport.to}update(e){let t=En(e.state),n=Dp(e.state),i=n!=Dp(e.startState),{viewport:s}=e.view,a=e.changes.mapPos(this.decoratedTo,1);t.length<s.to&&!i&&t.type==this.tree.type&&a>=s.to?(this.decorations=this.decorations.map(e.changes),this.decoratedTo=a):(t!=this.tree||e.viewportChanged||i)&&(this.tree=t,this.decorations=this.buildDeco(e.view,n),this.decoratedTo=s.to)}buildDeco(e,t){if(!t||!this.tree.length)return je.none;let n=new Js;for(let{from:i,to:s}of e.visibleRanges)iz(this.tree,t,(a,o,l)=>{n.add(a,o,this.markCache[l]||(this.markCache[l]=je.mark({class:l})))},i,s);return n.finish()}}const Lz=ja.high(pr.fromClass(Iz,{decorations:r=>r.decorations})),Bz=p4.define([{tag:L.meta,color:"#404740"},{tag:L.link,textDecoration:"underline"},{tag:L.heading,textDecoration:"underline",fontWeight:"bold"},{tag:L.emphasis,fontStyle:"italic"},{tag:L.strong,fontWeight:"bold"},{tag:L.strikethrough,textDecoration:"line-through"},{tag:L.keyword,color:"#708"},{tag:[L.atom,L.bool,L.url,L.contentSeparator,L.labelName],color:"#219"},{tag:[L.literal,L.inserted],color:"#164"},{tag:[L.string,L.deleted],color:"#a11"},{tag:[L.regexp,L.escape,L.special(L.string)],color:"#e40"},{tag:L.definition(L.variableName),color:"#00f"},{tag:L.local(L.variableName),color:"#30a"},{tag:[L.typeName,L.namespace],color:"#085"},{tag:L.className,color:"#167"},{tag:[L.special(L.variableName),L.macroName],color:"#256"},{tag:L.definition(L.propertyName),color:"#00c"},{tag:L.comment,color:"#940"},{tag:L.invalid,color:"#f00"}]),Zz=We.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),O4=1e4,x4="()[]{}",v4=Ze.define({combine(r){return Ls(r,{afterCursor:!0,brackets:x4,maxScanDistance:O4,renderMatch:Xz})}}),Wz=je.mark({class:"cm-matchingBracket"}),Uz=je.mark({class:"cm-nonmatchingBracket"});function Xz(r){let e=[],t=r.matched?Wz:Uz;return e.push(t.range(r.start.from,r.start.to)),r.end&&e.push(t.range(r.end.from,r.end.to)),e}const Vz=Cr.define({create(){return je.none},update(r,e){if(!e.docChanged&&!e.selection)return r;let t=[],n=e.state.facet(v4);for(let i of e.state.selection.ranges){if(!i.empty)continue;let s=bs(e.state,i.head,-1,n)||i.head>0&&bs(e.state,i.head-1,1,n)||n.afterCursor&&(bs(e.state,i.head,1,n)||i.head<e.state.doc.length&&bs(e.state,i.head+1,-1,n));s&&(t=t.concat(n.renderMatch(s,e.state)))}return je.set(t,!0)},provide:r=>We.decorations.from(r)}),qz=[Vz,Zz];function jz(r={}){return[v4.of(r),qz]}const zz=new Pt;function qg(r,e,t){let n=r.prop(e<0?Pt.openedBy:Pt.closedBy);if(n)return n;if(r.name.length==1){let i=t.indexOf(r.name);if(i>-1&&i%2==(e<0?1:0))return[t[i+e]]}return null}function jg(r){let e=r.type.prop(zz);return e?e(r.node):r}function bs(r,e,t,n={}){let i=n.maxScanDistance||O4,s=n.brackets||x4,a=En(r),o=a.resolveInner(e,t);for(let l=o;l;l=l.parent){let f=qg(l.type,t,s);if(f&&l.from<l.to){let c=jg(l);if(c&&(t>0?e>=c.from&&e<c.to:e>c.from&&e<=c.to))return Gz(r,e,t,l,c,f,s)}}return Hz(r,e,t,a,o.type,i,s)}function Gz(r,e,t,n,i,s,a){let o=n.parent,l={from:i.from,to:i.to},f=0,c=o==null?void 0:o.cursor();if(c&&(t<0?c.childBefore(n.from):c.childAfter(n.to)))do if(t<0?c.to<=n.from:c.from>=n.to){if(f==0&&s.indexOf(c.type.name)>-1&&c.from<c.to){let h=jg(c);return{start:l,end:h?{from:h.from,to:h.to}:void 0,matched:!0}}else if(qg(c.type,t,a))f++;else if(qg(c.type,-t,a)){if(f==0){let h=jg(c);return{start:l,end:h&&h.from<h.to?{from:h.from,to:h.to}:void 0,matched:!1}}f--}}while(t<0?c.prevSibling():c.nextSibling());return{start:l,matched:!1}}function Hz(r,e,t,n,i,s,a){let o=t<0?r.sliceDoc(e-1,e):r.sliceDoc(e,e+1),l=a.indexOf(o);if(l<0||l%2==0!=t>0)return null;let f={from:t<0?e-1:e,to:t>0?e+1:e},c=r.doc.iterRange(e,t>0?r.doc.length:0),h=0;for(let u=0;!c.next().done&&u<=s;){let d=c.value;t<0&&(u+=d.length);let p=e+u*t;for(let m=t>0?0:d.length-1,g=t>0?d.length:-1;m!=g;m+=t){let O=a.indexOf(d[m]);if(!(O<0||n.resolveInner(p+m,1).type!=i))if(O%2==0==t>0)h++;else{if(h==1)return{start:f,end:{from:p+m,to:p+m+1},matched:O>>1==l>>1};h--}}t>0&&(u+=d.length)}return c.done?{start:f,matched:!1}:null}const Yz=Object.create(null),kb=[Ps.none],Sb=[],Tb=Object.create(null),Kz=Object.create(null);for(let[r,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])Kz[r]=Jz(Yz,e);function Np(r,e){Sb.indexOf(r)>-1||(Sb.push(r),console.warn(e))}function Jz(r,e){let t=[];for(let o of e.split(" ")){let l=[];for(let f of o.split(".")){let c=r[f]||L[f];c?typeof c=="function"?l.length?l=l.map(c):Np(f,`Modifier ${f} used at start of tag`):l.length?Np(f,`Tag ${f} used as modifier`):l=Array.isArray(c)?c:[c]:Np(f,`Unknown highlighting tag ${f}`)}for(let f of l)t.push(f)}if(!t.length)return 0;let n=e.replace(/ /g,"_"),i=n+" "+t.map(o=>o.id),s=Tb[i];if(s)return s.id;let a=Tb[i]=Ps.define({id:kb.length,name:n,props:[oa({[n]:t})]});return kb.push(a),a.id}Et.RTL,Et.LTR;const eG=r=>{let{state:e}=r,t=e.doc.lineAt(e.selection.main.from),n=_x(r.state,t.from);return n.line?tG(r):n.block?nG(r):!1};function bx(r,e){return({state:t,dispatch:n})=>{if(t.readOnly)return!1;let i=r(e,t);return i?(n(t.update(i)),!0):!1}}const tG=bx(aG,0),rG=bx(y4,0),nG=bx((r,e)=>y4(r,e,sG(e)),0);function _x(r,e){let t=r.languageDataAt("commentTokens",e);return t.length?t[0]:{}}const wf=50;function iG(r,{open:e,close:t},n,i){let s=r.sliceDoc(n-wf,n),a=r.sliceDoc(i,i+wf),o=/\s*$/.exec(s)[0].length,l=/^\s*/.exec(a)[0].length,f=s.length-o;if(s.slice(f-e.length,f)==e&&a.slice(l,l+t.length)==t)return{open:{pos:n-o,margin:o&&1},close:{pos:i+l,margin:l&&1}};let c,h;i-n<=2*wf?c=h=r.sliceDoc(n,i):(c=r.sliceDoc(n,n+wf),h=r.sliceDoc(i-wf,i));let u=/^\s*/.exec(c)[0].length,d=/\s*$/.exec(h)[0].length,p=h.length-d-t.length;return c.slice(u,u+e.length)==e&&h.slice(p,p+t.length)==t?{open:{pos:n+u+e.length,margin:/\s/.test(c.charAt(u+e.length))?1:0},close:{pos:i-d-t.length,margin:/\s/.test(h.charAt(p-1))?1:0}}:null}function sG(r){let e=[];for(let t of r.selection.ranges){let n=r.doc.lineAt(t.from),i=t.to<=n.to?n:r.doc.lineAt(t.to);i.from>n.from&&i.from==t.to&&(i=t.to==n.to+1?n:r.doc.lineAt(t.to-1));let s=e.length-1;s>=0&&e[s].to>n.from?e[s].to=i.to:e.push({from:n.from+/^\s*/.exec(n.text)[0].length,to:i.to})}return e}function y4(r,e,t=e.selection.ranges){let n=t.map(s=>_x(e,s.from).block);if(!n.every(s=>s))return null;let i=t.map((s,a)=>iG(e,n[a],s.from,s.to));if(r!=2&&!i.every(s=>s))return{changes:e.changes(t.map((s,a)=>i[a]?[]:[{from:s.from,insert:n[a].open+" "},{from:s.to,insert:" "+n[a].close}]))};if(r!=1&&i.some(s=>s)){let s=[];for(let a=0,o;a<i.length;a++)if(o=i[a]){let l=n[a],{open:f,close:c}=o;s.push({from:f.pos-l.open.length,to:f.pos+f.margin},{from:c.pos-c.margin,to:c.pos+l.close.length})}return{changes:s}}return null}function aG(r,e,t=e.selection.ranges){let n=[],i=-1;for(let{from:s,to:a}of t){let o=n.length,l=1e9,f=_x(e,s).line;if(f){for(let c=s;c<=a;){let h=e.doc.lineAt(c);if(h.from>i&&(s==a||a>h.from)){i=h.from;let u=/^\s*/.exec(h.text)[0].length,d=u==h.length,p=h.text.slice(u,u+f.length)==f?u:-1;u<h.text.length&&u<l&&(l=u),n.push({line:h,comment:p,token:f,indent:u,empty:d,single:!1})}c=h.to+1}if(l<1e9)for(let c=o;c<n.length;c++)n[c].indent<n[c].line.text.length&&(n[c].indent=l);n.length==o+1&&(n[o].single=!0)}}if(r!=2&&n.some(s=>s.comment<0&&(!s.empty||s.single))){let s=[];for(let{line:o,token:l,indent:f,empty:c,single:h}of n)(h||!c)&&s.push({from:o.from+f,insert:l+" "});let a=e.changes(s);return{changes:a,selection:e.selection.map(a,1)}}else if(r!=1&&n.some(s=>s.comment>=0)){let s=[];for(let{line:a,comment:o,token:l}of n)if(o>=0){let f=a.from+o,c=f+l.length;a.text[c-a.from]==" "&&c++,s.push({from:f,to:c})}return{changes:s}}return null}const zg=Is.define(),oG=Is.define(),lG=Ze.define(),w4=Ze.define({combine(r){return Ls(r,{minDepth:100,newGroupDelay:500,joinToEvent:(e,t)=>t},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(e,t)=>(n,i)=>e(n,i)||t(n,i)})}}),b4=Cr.define({create(){return _s.empty},update(r,e){let t=e.state.facet(w4),n=e.annotation(zg);if(n){let l=Yn.fromTransaction(e,n.selection),f=n.side,c=f==0?r.undone:r.done;return l?c=Ud(c,c.length,t.minDepth,l):c=S4(c,e.startState.selection),new _s(f==0?n.rest:c,f==0?c:n.rest)}let i=e.annotation(oG);if((i=="full"||i=="before")&&(r=r.isolate()),e.annotation(Br.addToHistory)===!1)return e.changes.empty?r:r.addMapping(e.changes.desc);let s=Yn.fromTransaction(e),a=e.annotation(Br.time),o=e.annotation(Br.userEvent);return s?r=r.addChanges(s,a,o,t,e):e.selection&&(r=r.addSelection(e.startState.selection,a,o,t.newGroupDelay)),(i=="full"||i=="after")&&(r=r.isolate()),r},toJSON(r){return{done:r.done.map(e=>e.toJSON()),undone:r.undone.map(e=>e.toJSON())}},fromJSON(r){return new _s(r.done.map(Yn.fromJSON),r.undone.map(Yn.fromJSON))}});function fG(r={}){return[b4,w4.of(r),We.domEventHandlers({beforeinput(e,t){let n=e.inputType=="historyUndo"?_4:e.inputType=="historyRedo"?Gg:null;return n?(e.preventDefault(),n(t)):!1}})]}function N0(r,e){return function({state:t,dispatch:n}){if(!e&&t.readOnly)return!1;let i=t.field(b4,!1);if(!i)return!1;let s=i.pop(r,t,e);return s?(n(s),!0):!1}}const _4=N0(0,!1),Gg=N0(1,!1),cG=N0(0,!0),hG=N0(1,!0);class Yn{constructor(e,t,n,i,s){this.changes=e,this.effects=t,this.mapped=n,this.startSelection=i,this.selectionsAfter=s}setSelAfter(e){return new Yn(this.changes,this.effects,this.mapped,this.startSelection,e)}toJSON(){var e,t,n;return{changes:(e=this.changes)===null||e===void 0?void 0:e.toJSON(),mapped:(t=this.mapped)===null||t===void 0?void 0:t.toJSON(),startSelection:(n=this.startSelection)===null||n===void 0?void 0:n.toJSON(),selectionsAfter:this.selectionsAfter.map(i=>i.toJSON())}}static fromJSON(e){return new Yn(e.changes&&Wr.fromJSON(e.changes),[],e.mapped&&Ts.fromJSON(e.mapped),e.startSelection&&Oe.fromJSON(e.startSelection),e.selectionsAfter.map(Oe.fromJSON))}static fromTransaction(e,t){let n=Pi;for(let i of e.startState.facet(lG)){let s=i(e);s.length&&(n=n.concat(s))}return!n.length&&e.changes.empty?null:new Yn(e.changes.invert(e.startState.doc),n,void 0,t||e.startState.selection,Pi)}static selection(e){return new Yn(void 0,Pi,void 0,void 0,e)}}function Ud(r,e,t,n){let i=e+1>t+20?e-t-1:0,s=r.slice(i,e);return s.push(n),s}function uG(r,e){let t=[],n=!1;return r.iterChangedRanges((i,s)=>t.push(i,s)),e.iterChangedRanges((i,s,a,o)=>{for(let l=0;l<t.length;){let f=t[l++],c=t[l++];o>=f&&a<=c&&(n=!0)}}),n}function dG(r,e){return r.ranges.length==e.ranges.length&&r.ranges.filter((t,n)=>t.empty!=e.ranges[n].empty).length===0}function k4(r,e){return r.length?e.length?r.concat(e):r:e}const Pi=[],pG=200;function S4(r,e){if(r.length){let t=r[r.length-1],n=t.selectionsAfter.slice(Math.max(0,t.selectionsAfter.length-pG));return n.length&&n[n.length-1].eq(e)?r:(n.push(e),Ud(r,r.length-1,1e9,t.setSelAfter(n)))}else return[Yn.selection([e])]}function mG(r){let e=r[r.length-1],t=r.slice();return t[r.length-1]=e.setSelAfter(e.selectionsAfter.slice(0,e.selectionsAfter.length-1)),t}function Mp(r,e){if(!r.length)return r;let t=r.length,n=Pi;for(;t;){let i=gG(r[t-1],e,n);if(i.changes&&!i.changes.empty||i.effects.length){let s=r.slice(0,t);return s[t-1]=i,s}else e=i.mapped,t--,n=i.selectionsAfter}return n.length?[Yn.selection(n)]:Pi}function gG(r,e,t){let n=k4(r.selectionsAfter.length?r.selectionsAfter.map(o=>o.map(e)):Pi,t);if(!r.changes)return Yn.selection(n);let i=r.changes.map(e),s=e.mapDesc(r.changes,!0),a=r.mapped?r.mapped.composeDesc(s):s;return new Yn(i,rt.mapEffects(r.effects,e),a,r.startSelection.map(s),n)}const OG=/^(input\.type|delete)($|\.)/;class _s{constructor(e,t,n=0,i=void 0){this.done=e,this.undone=t,this.prevTime=n,this.prevUserEvent=i}isolate(){return this.prevTime?new _s(this.done,this.undone):this}addChanges(e,t,n,i,s){let a=this.done,o=a[a.length-1];return o&&o.changes&&!o.changes.empty&&e.changes&&(!n||OG.test(n))&&(!o.selectionsAfter.length&&t-this.prevTime<i.newGroupDelay&&i.joinToEvent(s,uG(o.changes,e.changes))||n=="input.type.compose")?a=Ud(a,a.length-1,i.minDepth,new Yn(e.changes.compose(o.changes),k4(rt.mapEffects(e.effects,o.changes),o.effects),o.mapped,o.startSelection,Pi)):a=Ud(a,a.length,i.minDepth,e),new _s(a,Pi,t,n)}addSelection(e,t,n,i){let s=this.done.length?this.done[this.done.length-1].selectionsAfter:Pi;return s.length>0&&t-this.prevTime<i&&n==this.prevUserEvent&&n&&/^select($|\.)/.test(n)&&dG(s[s.length-1],e)?this:new _s(S4(this.done,e),this.undone,t,n)}addMapping(e){return new _s(Mp(this.done,e),Mp(this.undone,e),this.prevTime,this.prevUserEvent)}pop(e,t,n){let i=e==0?this.done:this.undone;if(i.length==0)return null;let s=i[i.length-1],a=s.selectionsAfter[0]||t.selection;if(n&&s.selectionsAfter.length)return t.update({selection:s.selectionsAfter[s.selectionsAfter.length-1],annotations:zg.of({side:e,rest:mG(i),selection:a}),userEvent:e==0?"select.undo":"select.redo",scrollIntoView:!0});if(s.changes){let o=i.length==1?Pi:i.slice(0,i.length-1);return s.mapped&&(o=Mp(o,s.mapped)),t.update({changes:s.changes,selection:s.startSelection,effects:s.effects,annotations:zg.of({side:e,rest:o,selection:a}),filter:!1,userEvent:e==0?"undo":"redo",scrollIntoView:!0})}else return null}}_s.empty=new _s(Pi,Pi);const xG=[{key:"Mod-z",run:_4,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:Gg,preventDefault:!0},{linux:"Ctrl-Shift-z",run:Gg,preventDefault:!0},{key:"Mod-u",run:cG,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:hG,preventDefault:!0}];function of(r,e){return Oe.create(r.ranges.map(e),r.mainIndex)}function Bs(r,e){return r.update({selection:e,scrollIntoView:!0,userEvent:"select"})}function ls({state:r,dispatch:e},t){let n=of(r.selection,t);return n.eq(r.selection,!0)?!1:(e(Bs(r,n)),!0)}function M0(r,e){return Oe.cursor(e?r.to:r.from)}function T4(r,e){return ls(r,t=>t.empty?r.moveByChar(t,e):M0(t,e))}function Rn(r){return r.textDirectionAt(r.state.selection.main.head)==Et.LTR}const C4=r=>T4(r,!Rn(r)),A4=r=>T4(r,Rn(r));function E4(r,e){return ls(r,t=>t.empty?r.moveByGroup(t,e):M0(t,e))}const vG=r=>E4(r,!Rn(r)),yG=r=>E4(r,Rn(r));function wG(r,e,t){if(e.type.prop(t))return!0;let n=e.to-e.from;return n&&(n>2||/[^\s,.;:]/.test(r.sliceDoc(e.from,e.to)))||e.firstChild}function I0(r,e,t){let n=En(r).resolveInner(e.head),i=t?Pt.closedBy:Pt.openedBy;for(let l=e.head;;){let f=t?n.childAfter(l):n.childBefore(l);if(!f)break;wG(r,f,i)?n=f:l=t?f.to:f.from}let s=n.type.prop(i),a,o;return s&&(a=t?bs(r,n.from,1):bs(r,n.to,-1))&&a.matched?o=t?a.end.to:a.end.from:o=t?n.to:n.from,Oe.cursor(o,t?-1:1)}const bG=r=>ls(r,e=>I0(r.state,e,!Rn(r))),_G=r=>ls(r,e=>I0(r.state,e,Rn(r)));function P4(r,e){return ls(r,t=>{if(!t.empty)return M0(t,e);let n=r.moveVertically(t,e);return n.head!=t.head?n:r.moveToLineBoundary(t,e)})}const R4=r=>P4(r,!1),Q4=r=>P4(r,!0);function F4(r){let e=r.scrollDOM.clientHeight<r.scrollDOM.scrollHeight-2,t=0,n=0,i;if(e){for(let s of r.state.facet(We.scrollMargins)){let a=s(r);a!=null&&a.top&&(t=Math.max(a==null?void 0:a.top,t)),a!=null&&a.bottom&&(n=Math.max(a==null?void 0:a.bottom,n))}i=r.scrollDOM.clientHeight-t-n}else i=(r.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:t,marginBottom:n,selfScroll:e,height:Math.max(r.defaultLineHeight,i-5)}}function $4(r,e){let t=F4(r),{state:n}=r,i=of(n.selection,a=>a.empty?r.moveVertically(a,e,t.height):M0(a,e));if(i.eq(n.selection))return!1;let s;if(t.selfScroll){let a=r.coordsAtPos(n.selection.main.head),o=r.scrollDOM.getBoundingClientRect(),l=o.top+t.marginTop,f=o.bottom-t.marginBottom;a&&a.top>l&&a.bottom<f&&(s=We.scrollIntoView(i.main.head,{y:"start",yMargin:a.top-l}))}return r.dispatch(Bs(n,i),{effects:s}),!0}const Cb=r=>$4(r,!1),Hg=r=>$4(r,!0);function za(r,e,t){let n=r.lineBlockAt(e.head),i=r.moveToLineBoundary(e,t);if(i.head==e.head&&i.head!=(t?n.to:n.from)&&(i=r.moveToLineBoundary(e,t,!1)),!t&&i.head==n.from&&n.length){let s=/^\s*/.exec(r.state.sliceDoc(n.from,Math.min(n.from+100,n.to)))[0].length;s&&e.head!=n.from+s&&(i=Oe.cursor(n.from+s))}return i}const kG=r=>ls(r,e=>za(r,e,!0)),SG=r=>ls(r,e=>za(r,e,!1)),TG=r=>ls(r,e=>za(r,e,!Rn(r))),CG=r=>ls(r,e=>za(r,e,Rn(r))),AG=r=>ls(r,e=>Oe.cursor(r.lineBlockAt(e.head).from,1)),EG=r=>ls(r,e=>Oe.cursor(r.lineBlockAt(e.head).to,-1));function PG(r,e,t){let n=!1,i=of(r.selection,s=>{let a=bs(r,s.head,-1)||bs(r,s.head,1)||s.head>0&&bs(r,s.head-1,1)||s.head<r.doc.length&&bs(r,s.head+1,-1);if(!a||!a.end)return s;n=!0;let o=a.start.from==s.head?a.end.to:a.end.from;return Oe.cursor(o)});return n?(e(Bs(r,i)),!0):!1}const RG=({state:r,dispatch:e})=>PG(r,e);function Li(r,e){let t=of(r.state.selection,n=>{let i=e(n);return Oe.range(n.anchor,i.head,i.goalColumn,i.bidiLevel||void 0)});return t.eq(r.state.selection)?!1:(r.dispatch(Bs(r.state,t)),!0)}function D4(r,e){return Li(r,t=>r.moveByChar(t,e))}const N4=r=>D4(r,!Rn(r)),M4=r=>D4(r,Rn(r));function I4(r,e){return Li(r,t=>r.moveByGroup(t,e))}const QG=r=>I4(r,!Rn(r)),FG=r=>I4(r,Rn(r)),$G=r=>Li(r,e=>I0(r.state,e,!Rn(r))),DG=r=>Li(r,e=>I0(r.state,e,Rn(r)));function L4(r,e){return Li(r,t=>r.moveVertically(t,e))}const B4=r=>L4(r,!1),Z4=r=>L4(r,!0);function W4(r,e){return Li(r,t=>r.moveVertically(t,e,F4(r).height))}const Ab=r=>W4(r,!1),Eb=r=>W4(r,!0),NG=r=>Li(r,e=>za(r,e,!0)),MG=r=>Li(r,e=>za(r,e,!1)),IG=r=>Li(r,e=>za(r,e,!Rn(r))),LG=r=>Li(r,e=>za(r,e,Rn(r))),BG=r=>Li(r,e=>Oe.cursor(r.lineBlockAt(e.head).from)),ZG=r=>Li(r,e=>Oe.cursor(r.lineBlockAt(e.head).to)),Pb=({state:r,dispatch:e})=>(e(Bs(r,{anchor:0})),!0),Rb=({state:r,dispatch:e})=>(e(Bs(r,{anchor:r.doc.length})),!0),Qb=({state:r,dispatch:e})=>(e(Bs(r,{anchor:r.selection.main.anchor,head:0})),!0),Fb=({state:r,dispatch:e})=>(e(Bs(r,{anchor:r.selection.main.anchor,head:r.doc.length})),!0),WG=({state:r,dispatch:e})=>(e(r.update({selection:{anchor:0,head:r.doc.length},userEvent:"select"})),!0),UG=({state:r,dispatch:e})=>{let t=L0(r).map(({from:n,to:i})=>Oe.range(n,Math.min(i+1,r.doc.length)));return e(r.update({selection:Oe.create(t),userEvent:"select"})),!0},XG=({state:r,dispatch:e})=>{let t=of(r.selection,n=>{let i=En(r),s=i.resolveStack(n.from,1);if(n.empty){let a=i.resolveStack(n.from,-1);a.node.from>=s.node.from&&a.node.to<=s.node.to&&(s=a)}for(let a=s;a;a=a.next){let{node:o}=a;if((o.from<n.from&&o.to>=n.to||o.to>n.to&&o.from<=n.from)&&a.next)return Oe.range(o.to,o.from)}return n});return t.eq(r.selection)?!1:(e(Bs(r,t)),!0)},VG=({state:r,dispatch:e})=>{let t=r.selection,n=null;return t.ranges.length>1?n=Oe.create([t.main]):t.main.empty||(n=Oe.create([Oe.cursor(t.main.head)])),n?(e(Bs(r,n)),!0):!1};function Th(r,e){if(r.state.readOnly)return!1;let t="delete.selection",{state:n}=r,i=n.changeByRange(s=>{let{from:a,to:o}=s;if(a==o){let l=e(s);l<a?(t="delete.backward",l=uu(r,l,!1)):l>a&&(t="delete.forward",l=uu(r,l,!0)),a=Math.min(a,l),o=Math.max(o,l)}else a=uu(r,a,!1),o=uu(r,o,!0);return a==o?{range:s}:{changes:{from:a,to:o},range:Oe.cursor(a,a<s.head?-1:1)}});return i.changes.empty?!1:(r.dispatch(n.update(i,{scrollIntoView:!0,userEvent:t,effects:t=="delete.selection"?We.announce.of(n.phrase("Selection deleted")):void 0})),!0)}function uu(r,e,t){if(r instanceof We)for(let n of r.state.facet(We.atomicRanges).map(i=>i(r)))n.between(e,e,(i,s)=>{i<e&&s>e&&(e=t?s:i)});return e}const U4=(r,e,t)=>Th(r,n=>{let i=n.from,{state:s}=r,a=s.doc.lineAt(i),o,l;if(t&&!e&&i>a.from&&i<a.from+200&&!/[^ \t]/.test(o=a.text.slice(0,i-a.from))){if(o[o.length-1]=="	")return i-1;let f=sf(o,s.tabSize),c=f%Bd(s)||Bd(s);for(let h=0;h<c&&o[o.length-1-h]==" ";h++)i--;l=i}else l=pn(a.text,i-a.from,e,e)+a.from,l==i&&a.number!=(e?s.doc.lines:1)?l+=e?1:-1:!e&&/[\ufe00-\ufe0f]/.test(a.text.slice(l-a.from,i-a.from))&&(l=pn(a.text,l-a.from,!1,!1)+a.from);return l}),Yg=r=>U4(r,!1,!0),X4=r=>U4(r,!0,!1),V4=(r,e)=>Th(r,t=>{let n=t.head,{state:i}=r,s=i.doc.lineAt(n),a=i.charCategorizer(n);for(let o=null;;){if(n==(e?s.to:s.from)){n==t.head&&s.number!=(e?i.doc.lines:1)&&(n+=e?1:-1);break}let l=pn(s.text,n-s.from,e)+s.from,f=s.text.slice(Math.min(n,l)-s.from,Math.max(n,l)-s.from),c=a(f);if(o!=null&&c!=o)break;(f!=" "||n!=t.head)&&(o=c),n=l}return n}),q4=r=>V4(r,!1),qG=r=>V4(r,!0),jG=r=>Th(r,e=>{let t=r.lineBlockAt(e.head).to;return e.head<t?t:Math.min(r.state.doc.length,e.head+1)}),zG=r=>Th(r,e=>{let t=r.moveToLineBoundary(e,!1).head;return e.head>t?t:Math.max(0,e.head-1)}),GG=r=>Th(r,e=>{let t=r.moveToLineBoundary(e,!0).head;return e.head<t?t:Math.min(r.state.doc.length,e.head+1)}),HG=({state:r,dispatch:e})=>{if(r.readOnly)return!1;let t=r.changeByRange(n=>({changes:{from:n.from,to:n.to,insert:Ft.of(["",""])},range:Oe.cursor(n.from)}));return e(r.update(t,{scrollIntoView:!0,userEvent:"input"})),!0},YG=({state:r,dispatch:e})=>{if(r.readOnly)return!1;let t=r.changeByRange(n=>{if(!n.empty||n.from==0||n.from==r.doc.length)return{range:n};let i=n.from,s=r.doc.lineAt(i),a=i==s.from?i-1:pn(s.text,i-s.from,!1)+s.from,o=i==s.to?i+1:pn(s.text,i-s.from,!0)+s.from;return{changes:{from:a,to:o,insert:r.doc.slice(i,o).append(r.doc.slice(a,i))},range:Oe.cursor(o)}});return t.changes.empty?!1:(e(r.update(t,{scrollIntoView:!0,userEvent:"move.character"})),!0)};function L0(r){let e=[],t=-1;for(let n of r.selection.ranges){let i=r.doc.lineAt(n.from),s=r.doc.lineAt(n.to);if(!n.empty&&n.to==s.from&&(s=r.doc.lineAt(n.to-1)),t>=i.number){let a=e[e.length-1];a.to=s.to,a.ranges.push(n)}else e.push({from:i.from,to:s.to,ranges:[n]});t=s.number+1}return e}function j4(r,e,t){if(r.readOnly)return!1;let n=[],i=[];for(let s of L0(r)){if(t?s.to==r.doc.length:s.from==0)continue;let a=r.doc.lineAt(t?s.to+1:s.from-1),o=a.length+1;if(t){n.push({from:s.to,to:a.to},{from:s.from,insert:a.text+r.lineBreak});for(let l of s.ranges)i.push(Oe.range(Math.min(r.doc.length,l.anchor+o),Math.min(r.doc.length,l.head+o)))}else{n.push({from:a.from,to:s.from},{from:s.to,insert:r.lineBreak+a.text});for(let l of s.ranges)i.push(Oe.range(l.anchor-o,l.head-o))}}return n.length?(e(r.update({changes:n,scrollIntoView:!0,selection:Oe.create(i,r.selection.mainIndex),userEvent:"move.line"})),!0):!1}const KG=({state:r,dispatch:e})=>j4(r,e,!1),JG=({state:r,dispatch:e})=>j4(r,e,!0);function z4(r,e,t){if(r.readOnly)return!1;let n=[];for(let i of L0(r))t?n.push({from:i.from,insert:r.doc.slice(i.from,i.to)+r.lineBreak}):n.push({from:i.to,insert:r.lineBreak+r.doc.slice(i.from,i.to)});return e(r.update({changes:n,scrollIntoView:!0,userEvent:"input.copyline"})),!0}const eH=({state:r,dispatch:e})=>z4(r,e,!1),tH=({state:r,dispatch:e})=>z4(r,e,!0),rH=r=>{if(r.state.readOnly)return!1;let{state:e}=r,t=e.changes(L0(e).map(({from:i,to:s})=>(i>0?i--:s<e.doc.length&&s++,{from:i,to:s}))),n=of(e.selection,i=>{let s;if(r.lineWrapping){let a=r.lineBlockAt(i.head),o=r.coordsAtPos(i.head,i.assoc||1);o&&(s=a.bottom+r.documentTop-o.bottom+r.defaultLineHeight/2)}return r.moveVertically(i,!0,s)}).map(t);return r.dispatch({changes:t,selection:n,scrollIntoView:!0,userEvent:"delete.line"}),!0};function nH(r,e){if(/\(\)|\[\]|\{\}/.test(r.sliceDoc(e-1,e+1)))return{from:e,to:e};let t=En(r).resolveInner(e),n=t.childBefore(e),i=t.childAfter(e),s;return n&&i&&n.to<=e&&i.from>=e&&(s=n.type.prop(Pt.closedBy))&&s.indexOf(i.name)>-1&&r.doc.lineAt(n.to).from==r.doc.lineAt(i.from).from&&!/\S/.test(r.sliceDoc(n.to,i.from))?{from:n.to,to:i.from}:null}const $b=G4(!1),iH=G4(!0);function G4(r){return({state:e,dispatch:t})=>{if(e.readOnly)return!1;let n=e.changeByRange(i=>{let{from:s,to:a}=i,o=e.doc.lineAt(s),l=!r&&s==a&&nH(e,s);r&&(s=a=(a<=o.to?o:e.doc.lineAt(a)).to);let f=new $0(e,{simulateBreak:s,simulateDoubleBreak:!!l}),c=yx(f,s);for(c==null&&(c=sf(/^\s*/.exec(e.doc.lineAt(s).text)[0],e.tabSize));a<o.to&&/\s/.test(o.text[a-o.from]);)a++;l?{from:s,to:a}=l:s>o.from&&s<o.from+100&&!/\S/.test(o.text.slice(0,s))&&(s=o.from);let h=["",Xc(e,c)];return l&&h.push(Xc(e,f.lineIndent(o.from,-1))),{changes:{from:s,to:a,insert:Ft.of(h)},range:Oe.cursor(s+1+h[1].length)}});return t(e.update(n,{scrollIntoView:!0,userEvent:"input"})),!0}}function kx(r,e){let t=-1;return r.changeByRange(n=>{let i=[];for(let a=n.from;a<=n.to;){let o=r.doc.lineAt(a);o.number>t&&(n.empty||n.to>o.from)&&(e(o,i,n),t=o.number),a=o.to+1}let s=r.changes(i);return{changes:i,range:Oe.range(s.mapPos(n.anchor,1),s.mapPos(n.head,1))}})}const sH=({state:r,dispatch:e})=>{if(r.readOnly)return!1;let t=Object.create(null),n=new $0(r,{overrideIndentation:s=>{let a=t[s];return a??-1}}),i=kx(r,(s,a,o)=>{let l=yx(n,s.from);if(l==null)return;/\S/.test(s.text)||(l=0);let f=/^\s*/.exec(s.text)[0],c=Xc(r,l);(f!=c||o.from<s.from+f.length)&&(t[s.from]=l,a.push({from:s.from,to:s.from+f.length,insert:c}))});return i.changes.empty||e(r.update(i,{userEvent:"indent"})),!0},aH=({state:r,dispatch:e})=>r.readOnly?!1:(e(r.update(kx(r,(t,n)=>{n.push({from:t.from,insert:r.facet(vx)})}),{userEvent:"input.indent"})),!0),oH=({state:r,dispatch:e})=>r.readOnly?!1:(e(r.update(kx(r,(t,n)=>{let i=/^\s*/.exec(t.text)[0];if(!i)return;let s=sf(i,r.tabSize),a=0,o=Xc(r,Math.max(0,s-Bd(r)));for(;a<i.length&&a<o.length&&i.charCodeAt(a)==o.charCodeAt(a);)a++;n.push({from:t.from+a,to:t.from+i.length,insert:o.slice(a)})}),{userEvent:"delete.dedent"})),!0),lH=r=>(r.setTabFocusMode(),!0),fH=[{key:"Ctrl-b",run:C4,shift:N4,preventDefault:!0},{key:"Ctrl-f",run:A4,shift:M4},{key:"Ctrl-p",run:R4,shift:B4},{key:"Ctrl-n",run:Q4,shift:Z4},{key:"Ctrl-a",run:AG,shift:BG},{key:"Ctrl-e",run:EG,shift:ZG},{key:"Ctrl-d",run:X4},{key:"Ctrl-h",run:Yg},{key:"Ctrl-k",run:jG},{key:"Ctrl-Alt-h",run:q4},{key:"Ctrl-o",run:HG},{key:"Ctrl-t",run:YG},{key:"Ctrl-v",run:Hg}],cH=[{key:"ArrowLeft",run:C4,shift:N4,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:vG,shift:QG,preventDefault:!0},{mac:"Cmd-ArrowLeft",run:TG,shift:IG,preventDefault:!0},{key:"ArrowRight",run:A4,shift:M4,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:yG,shift:FG,preventDefault:!0},{mac:"Cmd-ArrowRight",run:CG,shift:LG,preventDefault:!0},{key:"ArrowUp",run:R4,shift:B4,preventDefault:!0},{mac:"Cmd-ArrowUp",run:Pb,shift:Qb},{mac:"Ctrl-ArrowUp",run:Cb,shift:Ab},{key:"ArrowDown",run:Q4,shift:Z4,preventDefault:!0},{mac:"Cmd-ArrowDown",run:Rb,shift:Fb},{mac:"Ctrl-ArrowDown",run:Hg,shift:Eb},{key:"PageUp",run:Cb,shift:Ab},{key:"PageDown",run:Hg,shift:Eb},{key:"Home",run:SG,shift:MG,preventDefault:!0},{key:"Mod-Home",run:Pb,shift:Qb},{key:"End",run:kG,shift:NG,preventDefault:!0},{key:"Mod-End",run:Rb,shift:Fb},{key:"Enter",run:$b,shift:$b},{key:"Mod-a",run:WG},{key:"Backspace",run:Yg,shift:Yg},{key:"Delete",run:X4},{key:"Mod-Backspace",mac:"Alt-Backspace",run:q4},{key:"Mod-Delete",mac:"Alt-Delete",run:qG},{mac:"Mod-Backspace",run:zG},{mac:"Mod-Delete",run:GG}].concat(fH.map(r=>({mac:r.key,run:r.run,shift:r.shift}))),hH=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:bG,shift:$G},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:_G,shift:DG},{key:"Alt-ArrowUp",run:KG},{key:"Shift-Alt-ArrowUp",run:eH},{key:"Alt-ArrowDown",run:JG},{key:"Shift-Alt-ArrowDown",run:tH},{key:"Escape",run:VG},{key:"Mod-Enter",run:iH},{key:"Alt-l",mac:"Ctrl-l",run:UG},{key:"Mod-i",run:XG,preventDefault:!0},{key:"Mod-[",run:oH},{key:"Mod-]",run:aH},{key:"Mod-Alt-\\",run:sH},{key:"Shift-Mod-k",run:rH},{key:"Shift-Mod-\\",run:RG},{key:"Mod-/",run:eG},{key:"Alt-A",run:rG},{key:"Ctrl-m",mac:"Shift-Alt-m",run:lH}].concat(cH);function Yt(){var r=arguments[0];typeof r=="string"&&(r=document.createElement(r));var e=1,t=arguments[1];if(t&&typeof t=="object"&&t.nodeType==null&&!Array.isArray(t)){for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var i=t[n];typeof i=="string"?r.setAttribute(n,i):i!=null&&(r[n]=i)}e++}for(;e<arguments.length;e++)H4(r,arguments[e]);return r}function H4(r,e){if(typeof e=="string")r.appendChild(document.createTextNode(e));else if(e!=null)if(e.nodeType!=null)r.appendChild(e);else if(Array.isArray(e))for(var t=0;t<e.length;t++)H4(r,e[t]);else throw new RangeError("Unsupported child node: "+e)}const Db=typeof String.prototype.normalize=="function"?r=>r.normalize("NFKD"):r=>r;class Il{constructor(e,t,n=0,i=e.length,s,a){this.test=a,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=e.iterRange(n,i),this.bufferStart=n,this.normalize=s?o=>s(Db(o)):Db,this.query=this.normalize(t)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return qn(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let e=this.peek();if(e<0)return this.done=!0,this;let t=tx(e),n=this.bufferStart+this.bufferPos;this.bufferPos+=Os(e);let i=this.normalize(t);if(i.length)for(let s=0,a=n;;s++){let o=i.charCodeAt(s),l=this.match(o,a,this.bufferPos+this.bufferStart);if(s==i.length-1){if(l)return this.value=l,this;break}a==n&&s<t.length&&t.charCodeAt(s)==o&&a++}}}match(e,t,n){let i=null;for(let s=0;s<this.matches.length;s+=2){let a=this.matches[s],o=!1;this.query.charCodeAt(a)==e&&(a==this.query.length-1?i={from:this.matches[s+1],to:n}:(this.matches[s]++,o=!0)),o||(this.matches.splice(s,2),s-=2)}return this.query.charCodeAt(0)==e&&(this.query.length==1?i={from:t,to:n}:this.matches.push(1,t)),i&&this.test&&!this.test(i.from,i.to,this.buffer,this.bufferStart)&&(i=null),i}}typeof Symbol<"u"&&(Il.prototype[Symbol.iterator]=function(){return this});const Y4={from:-1,to:-1,match:/.*/.exec("")},Sx="gm"+(/x/.unicode==null?"":"u");class K4{constructor(e,t,n,i=0,s=e.length){if(this.text=e,this.to=s,this.curLine="",this.done=!1,this.value=Y4,/\\[sWDnr]|\n|\r|\[\^/.test(t))return new J4(e,t,n,i,s);this.re=new RegExp(t,Sx+(n!=null&&n.ignoreCase?"i":"")),this.test=n==null?void 0:n.test,this.iter=e.iter();let a=e.lineAt(i);this.curLineStart=a.from,this.matchPos=Xd(e,i),this.getLine(this.curLineStart)}getLine(e){this.iter.next(e),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let e=this.matchPos-this.curLineStart;;){this.re.lastIndex=e;let t=this.matchPos<=this.to&&this.re.exec(this.curLine);if(t){let n=this.curLineStart+t.index,i=n+t[0].length;if(this.matchPos=Xd(this.text,i+(n==i?1:0)),n==this.curLineStart+this.curLine.length&&this.nextLine(),(n<i||n>this.value.to)&&(!this.test||this.test(n,i,t)))return this.value={from:n,to:i,match:t},this;e=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to)this.nextLine(),e=0;else return this.done=!0,this}}}const Ip=new WeakMap;class wl{constructor(e,t){this.from=e,this.text=t}get to(){return this.from+this.text.length}static get(e,t,n){let i=Ip.get(e);if(!i||i.from>=n||i.to<=t){let o=new wl(t,e.sliceString(t,n));return Ip.set(e,o),o}if(i.from==t&&i.to==n)return i;let{text:s,from:a}=i;return a>t&&(s=e.sliceString(t,a)+s,a=t),i.to<n&&(s+=e.sliceString(i.to,n)),Ip.set(e,new wl(a,s)),new wl(t,s.slice(t-a,n-a))}}class J4{constructor(e,t,n,i,s){this.text=e,this.to=s,this.done=!1,this.value=Y4,this.matchPos=Xd(e,i),this.re=new RegExp(t,Sx+(n!=null&&n.ignoreCase?"i":"")),this.test=n==null?void 0:n.test,this.flat=wl.get(e,i,this.chunkEnd(i+5e3))}chunkEnd(e){return e>=this.to?this.to:this.text.lineAt(e).to}next(){for(;;){let e=this.re.lastIndex=this.matchPos-this.flat.from,t=this.re.exec(this.flat.text);if(t&&!t[0]&&t.index==e&&(this.re.lastIndex=e+1,t=this.re.exec(this.flat.text)),t){let n=this.flat.from+t.index,i=n+t[0].length;if((this.flat.to>=this.to||t.index+t[0].length<=this.flat.text.length-10)&&(!this.test||this.test(n,i,t)))return this.value={from:n,to:i,match:t},this.matchPos=Xd(this.text,i+(n==i?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=wl.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2))}}}typeof Symbol<"u"&&(K4.prototype[Symbol.iterator]=J4.prototype[Symbol.iterator]=function(){return this});function uH(r){try{return new RegExp(r,Sx),!0}catch{return!1}}function Xd(r,e){if(e>=r.length)return e;let t=r.lineAt(e),n;for(;e<t.to&&(n=t.text.charCodeAt(e-t.from))>=56320&&n<57344;)e++;return e}function Kg(r){let e=String(r.state.doc.lineAt(r.state.selection.main.head).number),t=Yt("input",{class:"cm-textfield",name:"line",value:e}),n=Yt("form",{class:"cm-gotoLine",onkeydown:s=>{s.keyCode==27?(s.preventDefault(),r.dispatch({effects:Vd.of(!1)}),r.focus()):s.keyCode==13&&(s.preventDefault(),i())},onsubmit:s=>{s.preventDefault(),i()}},Yt("label",r.state.phrase("Go to line"),": ",t)," ",Yt("button",{class:"cm-button",type:"submit"},r.state.phrase("go")));function i(){let s=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(t.value);if(!s)return;let{state:a}=r,o=a.doc.lineAt(a.selection.main.head),[,l,f,c,h]=s,u=c?+c.slice(1):0,d=f?+f:o.number;if(f&&h){let g=d/100;l&&(g=g*(l=="-"?-1:1)+o.number/a.doc.lines),d=Math.round(a.doc.lines*g)}else f&&l&&(d=d*(l=="-"?-1:1)+o.number);let p=a.doc.line(Math.max(1,Math.min(a.doc.lines,d))),m=Oe.cursor(p.from+Math.max(0,Math.min(u,p.length)));r.dispatch({effects:[Vd.of(!1),We.scrollIntoView(m.from,{y:"center"})],selection:m}),r.focus()}return{dom:n}}const Vd=rt.define(),Nb=Cr.define({create(){return!0},update(r,e){for(let t of e.effects)t.is(Vd)&&(r=t.value);return r},provide:r=>Wc.from(r,e=>e?Kg:null)}),dH=r=>{let e=Zc(r,Kg);if(!e){let t=[Vd.of(!0)];r.state.field(Nb,!1)==null&&t.push(rt.appendConfig.of([Nb,pH])),r.dispatch({effects:t}),e=Zc(r,Kg)}return e&&e.dom.querySelector("input").select(),!0},pH=We.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px","& label":{fontSize:"80%"}}}),mH={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},gH=Ze.define({combine(r){return Ls(r,mH,{highlightWordAroundCursor:(e,t)=>e||t,minSelectionLength:Math.min,maxMatches:Math.min})}});function OH(r){return[bH,wH]}const xH=je.mark({class:"cm-selectionMatch"}),vH=je.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function Mb(r,e,t,n){return(t==0||r(e.sliceDoc(t-1,t))!=ur.Word)&&(n==e.doc.length||r(e.sliceDoc(n,n+1))!=ur.Word)}function yH(r,e,t,n){return r(e.sliceDoc(t,t+1))==ur.Word&&r(e.sliceDoc(n-1,n))==ur.Word}const wH=pr.fromClass(class{constructor(r){this.decorations=this.getDeco(r)}update(r){(r.selectionSet||r.docChanged||r.viewportChanged)&&(this.decorations=this.getDeco(r.view))}getDeco(r){let e=r.state.facet(gH),{state:t}=r,n=t.selection;if(n.ranges.length>1)return je.none;let i=n.main,s,a=null;if(i.empty){if(!e.highlightWordAroundCursor)return je.none;let l=t.wordAt(i.head);if(!l)return je.none;a=t.charCategorizer(i.head),s=t.sliceDoc(l.from,l.to)}else{let l=i.to-i.from;if(l<e.minSelectionLength||l>200)return je.none;if(e.wholeWords){if(s=t.sliceDoc(i.from,i.to),a=t.charCategorizer(i.head),!(Mb(a,t,i.from,i.to)&&yH(a,t,i.from,i.to)))return je.none}else if(s=t.sliceDoc(i.from,i.to),!s)return je.none}let o=[];for(let l of r.visibleRanges){let f=new Il(t.doc,s,l.from,l.to);for(;!f.next().done;){let{from:c,to:h}=f.value;if((!a||Mb(a,t,c,h))&&(i.empty&&c<=i.from&&h>=i.to?o.push(vH.range(c,h)):(c>=i.to||h<=i.from)&&o.push(xH.range(c,h)),o.length>e.maxMatches))return je.none}}return je.set(o)}},{decorations:r=>r.decorations}),bH=We.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}}),_H=({state:r,dispatch:e})=>{let{selection:t}=r,n=Oe.create(t.ranges.map(i=>r.wordAt(i.head)||Oe.cursor(i.head)),t.mainIndex);return n.eq(t)?!1:(e(r.update({selection:n})),!0)};function kH(r,e){let{main:t,ranges:n}=r.selection,i=r.wordAt(t.head),s=i&&i.from==t.from&&i.to==t.to;for(let a=!1,o=new Il(r.doc,e,n[n.length-1].to);;)if(o.next(),o.done){if(a)return null;o=new Il(r.doc,e,0,Math.max(0,n[n.length-1].from-1)),a=!0}else{if(a&&n.some(l=>l.from==o.value.from))continue;if(s){let l=r.wordAt(o.value.from);if(!l||l.from!=o.value.from||l.to!=o.value.to)continue}return o.value}}const SH=({state:r,dispatch:e})=>{let{ranges:t}=r.selection;if(t.some(s=>s.from===s.to))return _H({state:r,dispatch:e});let n=r.sliceDoc(t[0].from,t[0].to);if(r.selection.ranges.some(s=>r.sliceDoc(s.from,s.to)!=n))return!1;let i=kH(r,n);return i?(e(r.update({selection:r.selection.addRange(Oe.range(i.from,i.to),!1),effects:We.scrollIntoView(i.to)})),!0):!1},lf=Ze.define({combine(r){return Ls(r,{top:!1,caseSensitive:!1,literal:!1,regexp:!1,wholeWord:!1,createPanel:e=>new MH(e),scrollToMatch:e=>We.scrollIntoView(e)})}});class eE{constructor(e){this.search=e.search,this.caseSensitive=!!e.caseSensitive,this.literal=!!e.literal,this.regexp=!!e.regexp,this.replace=e.replace||"",this.valid=!!this.search&&(!this.regexp||uH(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!e.wholeWord}unquote(e){return this.literal?e:e.replace(/\\([nrt\\])/g,(t,n)=>n=="n"?`
`:n=="r"?"\r":n=="t"?"	":"\\")}eq(e){return this.search==e.search&&this.replace==e.replace&&this.caseSensitive==e.caseSensitive&&this.regexp==e.regexp&&this.wholeWord==e.wholeWord}create(){return this.regexp?new EH(this):new CH(this)}getCursor(e,t=0,n){let i=e.doc?e:st.create({doc:e});return n==null&&(n=i.doc.length),this.regexp?rl(this,i,t,n):tl(this,i,t,n)}}class tE{constructor(e){this.spec=e}}function tl(r,e,t,n){return new Il(e.doc,r.unquoted,t,n,r.caseSensitive?void 0:i=>i.toLowerCase(),r.wholeWord?TH(e.doc,e.charCategorizer(e.selection.main.head)):void 0)}function TH(r,e){return(t,n,i,s)=>((s>t||s+i.length<n)&&(s=Math.max(0,t-2),i=r.sliceString(s,Math.min(r.length,n+2))),(e(qd(i,t-s))!=ur.Word||e(jd(i,t-s))!=ur.Word)&&(e(jd(i,n-s))!=ur.Word||e(qd(i,n-s))!=ur.Word))}class CH extends tE{constructor(e){super(e)}nextMatch(e,t,n){let i=tl(this.spec,e,n,e.doc.length).nextOverlapping();if(i.done){let s=Math.min(e.doc.length,t+this.spec.unquoted.length);i=tl(this.spec,e,0,s).nextOverlapping()}return i.done||i.value.from==t&&i.value.to==n?null:i.value}prevMatchInRange(e,t,n){for(let i=n;;){let s=Math.max(t,i-1e4-this.spec.unquoted.length),a=tl(this.spec,e,s,i),o=null;for(;!a.nextOverlapping().done;)o=a.value;if(o)return o;if(s==t)return null;i-=1e4}}prevMatch(e,t,n){let i=this.prevMatchInRange(e,0,t);return i||(i=this.prevMatchInRange(e,Math.max(0,n-this.spec.unquoted.length),e.doc.length)),i&&(i.from!=t||i.to!=n)?i:null}getReplacement(e){return this.spec.unquote(this.spec.replace)}matchAll(e,t){let n=tl(this.spec,e,0,e.doc.length),i=[];for(;!n.next().done;){if(i.length>=t)return null;i.push(n.value)}return i}highlight(e,t,n,i){let s=tl(this.spec,e,Math.max(0,t-this.spec.unquoted.length),Math.min(n+this.spec.unquoted.length,e.doc.length));for(;!s.next().done;)i(s.value.from,s.value.to)}}function rl(r,e,t,n){return new K4(e.doc,r.search,{ignoreCase:!r.caseSensitive,test:r.wholeWord?AH(e.charCategorizer(e.selection.main.head)):void 0},t,n)}function qd(r,e){return r.slice(pn(r,e,!1),e)}function jd(r,e){return r.slice(e,pn(r,e))}function AH(r){return(e,t,n)=>!n[0].length||(r(qd(n.input,n.index))!=ur.Word||r(jd(n.input,n.index))!=ur.Word)&&(r(jd(n.input,n.index+n[0].length))!=ur.Word||r(qd(n.input,n.index+n[0].length))!=ur.Word)}class EH extends tE{nextMatch(e,t,n){let i=rl(this.spec,e,n,e.doc.length).next();return i.done&&(i=rl(this.spec,e,0,t).next()),i.done?null:i.value}prevMatchInRange(e,t,n){for(let i=1;;i++){let s=Math.max(t,n-i*1e4),a=rl(this.spec,e,s,n),o=null;for(;!a.next().done;)o=a.value;if(o&&(s==t||o.from>s+10))return o;if(s==t)return null}}prevMatch(e,t,n){return this.prevMatchInRange(e,0,t)||this.prevMatchInRange(e,n,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace).replace(/\$([$&\d+])/g,(t,n)=>n=="$"?"$":n=="&"?e.match[0]:n!="0"&&+n<e.match.length?e.match[n]:t)}matchAll(e,t){let n=rl(this.spec,e,0,e.doc.length),i=[];for(;!n.next().done;){if(i.length>=t)return null;i.push(n.value)}return i}highlight(e,t,n,i){let s=rl(this.spec,e,Math.max(0,t-250),Math.min(n+250,e.doc.length));for(;!s.next().done;)i(s.value.from,s.value.to)}}const Vc=rt.define(),Tx=rt.define(),Pa=Cr.define({create(r){return new Lp(Jg(r).create(),null)},update(r,e){for(let t of e.effects)t.is(Vc)?r=new Lp(t.value.create(),r.panel):t.is(Tx)&&(r=new Lp(r.query,t.value?Cx:null));return r},provide:r=>Wc.from(r,e=>e.panel)});class Lp{constructor(e,t){this.query=e,this.panel=t}}const PH=je.mark({class:"cm-searchMatch"}),RH=je.mark({class:"cm-searchMatch cm-searchMatch-selected"}),QH=pr.fromClass(class{constructor(r){this.view=r,this.decorations=this.highlight(r.state.field(Pa))}update(r){let e=r.state.field(Pa);(e!=r.startState.field(Pa)||r.docChanged||r.selectionSet||r.viewportChanged)&&(this.decorations=this.highlight(e))}highlight({query:r,panel:e}){if(!e||!r.spec.valid)return je.none;let{view:t}=this,n=new Js;for(let i=0,s=t.visibleRanges,a=s.length;i<a;i++){let{from:o,to:l}=s[i];for(;i<a-1&&l>s[i+1].from-2*250;)l=s[++i].to;r.highlight(t.state,o,l,(f,c)=>{let h=t.state.selection.ranges.some(u=>u.from==f&&u.to==c);n.add(f,c,h?RH:PH)})}return n.finish()}},{decorations:r=>r.decorations});function Ch(r){return e=>{let t=e.state.field(Pa,!1);return t&&t.query.spec.valid?r(e,t):iE(e)}}const zd=Ch((r,{query:e})=>{let{to:t}=r.state.selection.main,n=e.nextMatch(r.state,t,t);if(!n)return!1;let i=Oe.single(n.from,n.to),s=r.state.facet(lf);return r.dispatch({selection:i,effects:[Ax(r,n),s.scrollToMatch(i.main,r)],userEvent:"select.search"}),nE(r),!0}),Gd=Ch((r,{query:e})=>{let{state:t}=r,{from:n}=t.selection.main,i=e.prevMatch(t,n,n);if(!i)return!1;let s=Oe.single(i.from,i.to),a=r.state.facet(lf);return r.dispatch({selection:s,effects:[Ax(r,i),a.scrollToMatch(s.main,r)],userEvent:"select.search"}),nE(r),!0}),FH=Ch((r,{query:e})=>{let t=e.matchAll(r.state,1e3);return!t||!t.length?!1:(r.dispatch({selection:Oe.create(t.map(n=>Oe.range(n.from,n.to))),userEvent:"select.search.matches"}),!0)}),$H=({state:r,dispatch:e})=>{let t=r.selection;if(t.ranges.length>1||t.main.empty)return!1;let{from:n,to:i}=t.main,s=[],a=0;for(let o=new Il(r.doc,r.sliceDoc(n,i));!o.next().done;){if(s.length>1e3)return!1;o.value.from==n&&(a=s.length),s.push(Oe.range(o.value.from,o.value.to))}return e(r.update({selection:Oe.create(s,a),userEvent:"select.search.matches"})),!0},Ib=Ch((r,{query:e})=>{let{state:t}=r,{from:n,to:i}=t.selection.main;if(t.readOnly)return!1;let s=e.nextMatch(t,n,n);if(!s)return!1;let a=s,o=[],l,f,c=[];if(a.from==n&&a.to==i&&(f=t.toText(e.getReplacement(a)),o.push({from:a.from,to:a.to,insert:f}),a=e.nextMatch(t,a.from,a.to),c.push(We.announce.of(t.phrase("replaced match on line $",t.doc.lineAt(n).number)+"."))),a){let h=o.length==0||o[0].from>=s.to?0:s.to-s.from-f.length;l=Oe.single(a.from-h,a.to-h),c.push(Ax(r,a)),c.push(t.facet(lf).scrollToMatch(l.main,r))}return r.dispatch({changes:o,selection:l,effects:c,userEvent:"input.replace"}),!0}),DH=Ch((r,{query:e})=>{if(r.state.readOnly)return!1;let t=e.matchAll(r.state,1e9).map(i=>{let{from:s,to:a}=i;return{from:s,to:a,insert:e.getReplacement(i)}});if(!t.length)return!1;let n=r.state.phrase("replaced $ matches",t.length)+".";return r.dispatch({changes:t,effects:We.announce.of(n),userEvent:"input.replace.all"}),!0});function Cx(r){return r.state.facet(lf).createPanel(r)}function Jg(r,e){var t,n,i,s,a;let o=r.selection.main,l=o.empty||o.to>o.from+100?"":r.sliceDoc(o.from,o.to);if(e&&!l)return e;let f=r.facet(lf);return new eE({search:((t=e==null?void 0:e.literal)!==null&&t!==void 0?t:f.literal)?l:l.replace(/\n/g,"\\n"),caseSensitive:(n=e==null?void 0:e.caseSensitive)!==null&&n!==void 0?n:f.caseSensitive,literal:(i=e==null?void 0:e.literal)!==null&&i!==void 0?i:f.literal,regexp:(s=e==null?void 0:e.regexp)!==null&&s!==void 0?s:f.regexp,wholeWord:(a=e==null?void 0:e.wholeWord)!==null&&a!==void 0?a:f.wholeWord})}function rE(r){let e=Zc(r,Cx);return e&&e.dom.querySelector("[main-field]")}function nE(r){let e=rE(r);e&&e==r.root.activeElement&&e.select()}const iE=r=>{let e=r.state.field(Pa,!1);if(e&&e.panel){let t=rE(r);if(t&&t!=r.root.activeElement){let n=Jg(r.state,e.query.spec);n.valid&&r.dispatch({effects:Vc.of(n)}),t.focus(),t.select()}}else r.dispatch({effects:[Tx.of(!0),e?Vc.of(Jg(r.state,e.query.spec)):rt.appendConfig.of(LH)]});return!0},sE=r=>{let e=r.state.field(Pa,!1);if(!e||!e.panel)return!1;let t=Zc(r,Cx);return t&&t.dom.contains(r.root.activeElement)&&r.focus(),r.dispatch({effects:Tx.of(!1)}),!0},NH=[{key:"Mod-f",run:iE,scope:"editor search-panel"},{key:"F3",run:zd,shift:Gd,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:zd,shift:Gd,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:sE,scope:"editor search-panel"},{key:"Mod-Shift-l",run:$H},{key:"Mod-Alt-g",run:dH},{key:"Mod-d",run:SH,preventDefault:!0}];class MH{constructor(e){this.view=e;let t=this.query=e.state.field(Pa).query.spec;this.commit=this.commit.bind(this),this.searchField=Yt("input",{value:t.search,placeholder:ni(e,"Find"),"aria-label":ni(e,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=Yt("input",{value:t.replace,placeholder:ni(e,"Replace"),"aria-label":ni(e,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=Yt("input",{type:"checkbox",name:"case",form:"",checked:t.caseSensitive,onchange:this.commit}),this.reField=Yt("input",{type:"checkbox",name:"re",form:"",checked:t.regexp,onchange:this.commit}),this.wordField=Yt("input",{type:"checkbox",name:"word",form:"",checked:t.wholeWord,onchange:this.commit});function n(i,s,a){return Yt("button",{class:"cm-button",name:i,onclick:s,type:"button"},a)}this.dom=Yt("div",{onkeydown:i=>this.keydown(i),class:"cm-search"},[this.searchField,n("next",()=>zd(e),[ni(e,"next")]),n("prev",()=>Gd(e),[ni(e,"previous")]),n("select",()=>FH(e),[ni(e,"all")]),Yt("label",null,[this.caseField,ni(e,"match case")]),Yt("label",null,[this.reField,ni(e,"regexp")]),Yt("label",null,[this.wordField,ni(e,"by word")]),...e.state.readOnly?[]:[Yt("br"),this.replaceField,n("replace",()=>Ib(e),[ni(e,"replace")]),n("replaceAll",()=>DH(e),[ni(e,"replace all")])],Yt("button",{name:"close",onclick:()=>sE(e),"aria-label":ni(e,"close"),type:"button"},[""])])}commit(){let e=new eE({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});e.eq(this.query)||(this.query=e,this.view.dispatch({effects:Vc.of(e)}))}keydown(e){Bq(this.view,e,"search-panel")?e.preventDefault():e.keyCode==13&&e.target==this.searchField?(e.preventDefault(),(e.shiftKey?Gd:zd)(this.view)):e.keyCode==13&&e.target==this.replaceField&&(e.preventDefault(),Ib(this.view))}update(e){for(let t of e.transactions)for(let n of t.effects)n.is(Vc)&&!n.value.eq(this.query)&&this.setQuery(n.value)}setQuery(e){this.query=e,this.searchField.value=e.search,this.replaceField.value=e.replace,this.caseField.checked=e.caseSensitive,this.reField.checked=e.regexp,this.wordField.checked=e.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(lf).top}}function ni(r,e){return r.state.phrase(e)}const du=30,pu=/[\s\.,:;?!]/;function Ax(r,{from:e,to:t}){let n=r.state.doc.lineAt(e),i=r.state.doc.lineAt(t).to,s=Math.max(n.from,e-du),a=Math.min(i,t+du),o=r.state.sliceDoc(s,a);if(s!=n.from){for(let l=0;l<du;l++)if(!pu.test(o[l+1])&&pu.test(o[l])){o=o.slice(l);break}}if(a!=i){for(let l=o.length-1;l>o.length-du;l--)if(!pu.test(o[l-1])&&pu.test(o[l])){o=o.slice(0,l);break}}return We.announce.of(`${r.state.phrase("current match")}. ${o} ${r.state.phrase("on line")} ${n.number}.`)}const IH=We.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),LH=[Pa,ja.low(QH),IH];class aE{constructor(e,t,n,i){this.state=e,this.pos=t,this.explicit=n,this.view=i,this.abortListeners=[],this.abortOnDocChange=!1}tokenBefore(e){let t=En(this.state).resolveInner(this.pos,-1);for(;t&&e.indexOf(t.name)<0;)t=t.parent;return t?{from:t.from,to:this.pos,text:this.state.sliceDoc(t.from,this.pos),type:t.type}:null}matchBefore(e){let t=this.state.doc.lineAt(this.pos),n=Math.max(t.from,this.pos-250),i=t.text.slice(n-t.from,this.pos-t.from),s=i.search(oE(e,!1));return s<0?null:{from:n+s,to:this.pos,text:i.slice(s)}}get aborted(){return this.abortListeners==null}addEventListener(e,t,n){e=="abort"&&this.abortListeners&&(this.abortListeners.push(t),n&&n.onDocChange&&(this.abortOnDocChange=!0))}}function Lb(r){let e=Object.keys(r).join(""),t=/\w/.test(e);return t&&(e=e.replace(/\w/g,"")),`[${t?"\\w":""}${e.replace(/[^\w\s]/g,"\\$&")}]`}function BH(r){let e=Object.create(null),t=Object.create(null);for(let{label:i}of r){e[i[0]]=!0;for(let s=1;s<i.length;s++)t[i[s]]=!0}let n=Lb(e)+Lb(t)+"*$";return[new RegExp("^"+n),new RegExp(n)]}function ZH(r){let e=r.map(i=>typeof i=="string"?{label:i}:i),[t,n]=e.every(i=>/^\w+$/.test(i.label))?[/\w*$/,/\w+$/]:BH(e);return i=>{let s=i.matchBefore(n);return s||i.explicit?{from:s?s.from:i.pos,options:e,validFor:t}:null}}class Bb{constructor(e,t,n,i){this.completion=e,this.source=t,this.match=n,this.score=i}}function wo(r){return r.selection.main.from}function oE(r,e){var t;let{source:n}=r,i=e&&n[0]!="^",s=n[n.length-1]!="$";return!i&&!s?r:new RegExp(`${i?"^":""}(?:${n})${s?"$":""}`,(t=r.flags)!==null&&t!==void 0?t:r.ignoreCase?"i":"")}const lE=Is.define();function WH(r,e,t,n){let{main:i}=r.selection,s=t-i.from,a=n-i.from;return Object.assign(Object.assign({},r.changeByRange(o=>{if(o!=i&&t!=n&&r.sliceDoc(o.from+s,o.from+a)!=r.sliceDoc(t,n))return{range:o};let l=r.toText(e);return{changes:{from:o.from+s,to:n==i.from?o.to:o.from+a,insert:l},range:Oe.cursor(o.from+s+l.length)}})),{scrollIntoView:!0,userEvent:"input.complete"})}const Zb=new WeakMap;function UH(r){if(!Array.isArray(r))return r;let e=Zb.get(r);return e||Zb.set(r,e=ZH(r)),e}const Hd=rt.define(),qc=rt.define();class XH{constructor(e){this.pattern=e,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[],this.score=0,this.matched=[];for(let t=0;t<e.length;){let n=qn(e,t),i=Os(n);this.chars.push(n);let s=e.slice(t,t+i),a=s.toUpperCase();this.folded.push(qn(a==s?s.toLowerCase():a,0)),t+=i}this.astral=e.length!=this.chars.length}ret(e,t){return this.score=e,this.matched=t,this}match(e){if(this.pattern.length==0)return this.ret(-100,[]);if(e.length<this.pattern.length)return null;let{chars:t,folded:n,any:i,precise:s,byWord:a}=this;if(t.length==1){let w=qn(e,0),v=Os(w),S=v==e.length?0:-100;if(w!=t[0])if(w==n[0])S+=-200;else return null;return this.ret(S,[0,v])}let o=e.indexOf(this.pattern);if(o==0)return this.ret(e.length==this.pattern.length?0:-100,[0,this.pattern.length]);let l=t.length,f=0;if(o<0){for(let w=0,v=Math.min(e.length,200);w<v&&f<l;){let S=qn(e,w);(S==t[f]||S==n[f])&&(i[f++]=w),w+=Os(S)}if(f<l)return null}let c=0,h=0,u=!1,d=0,p=-1,m=-1,g=/[a-z]/.test(e),O=!0;for(let w=0,v=Math.min(e.length,200),S=0;w<v&&h<l;){let y=qn(e,w);o<0&&(c<l&&y==t[c]&&(s[c++]=w),d<l&&(y==t[d]||y==n[d]?(d==0&&(p=w),m=w+1,d++):d=0));let b,x=y<255?y>=48&&y<=57||y>=97&&y<=122?2:y>=65&&y<=90?1:0:(b=tx(y))!=b.toLowerCase()?1:b!=b.toUpperCase()?2:0;(!w||x==1&&g||S==0&&x!=0)&&(t[h]==y||n[h]==y&&(u=!0)?a[h++]=w:a.length&&(O=!1)),S=x,w+=Os(y)}return h==l&&a[0]==0&&O?this.result(-100+(u?-200:0),a,e):d==l&&p==0?this.ret(-200-e.length+(m==e.length?0:-100),[0,m]):o>-1?this.ret(-700-e.length,[o,o+this.pattern.length]):d==l?this.ret(-900-e.length,[p,m]):h==l?this.result(-100+(u?-200:0)+-700+(O?0:-1100),a,e):t.length==2?null:this.result((i[0]?-700:0)+-200+-1100,i,e)}result(e,t,n){let i=[],s=0;for(let a of t){let o=a+(this.astral?Os(qn(n,a)):1);s&&i[s-1]==a?i[s-1]=o:(i[s++]=a,i[s++]=o)}return this.ret(e-n.length,i)}}class VH{constructor(e){this.pattern=e,this.matched=[],this.score=0,this.folded=e.toLowerCase()}match(e){if(e.length<this.pattern.length)return null;let t=e.slice(0,this.pattern.length),n=t==this.pattern?0:t.toLowerCase()==this.folded?-200:null;return n==null?null:(this.matched=[0,t.length],this.score=n+(e.length==this.pattern.length?0:-100),this)}}const Jr=Ze.define({combine(r){return Ls(r,{activateOnTyping:!0,activateOnCompletion:()=>!1,activateOnTypingDelay:100,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:qH,filterStrict:!1,compareCompletions:(e,t)=>e.label.localeCompare(t.label),interactionDelay:75,updateSyncTime:100},{defaultKeymap:(e,t)=>e&&t,closeOnBlur:(e,t)=>e&&t,icons:(e,t)=>e&&t,tooltipClass:(e,t)=>n=>Wb(e(n),t(n)),optionClass:(e,t)=>n=>Wb(e(n),t(n)),addToOptions:(e,t)=>e.concat(t),filterStrict:(e,t)=>e||t})}});function Wb(r,e){return r?e?r+" "+e:r:e}function qH(r,e,t,n,i,s){let a=r.textDirection==Et.RTL,o=a,l=!1,f="top",c,h,u=e.left-i.left,d=i.right-e.right,p=n.right-n.left,m=n.bottom-n.top;if(o&&u<Math.min(p,d)?o=!1:!o&&d<Math.min(p,u)&&(o=!0),p<=(o?u:d))c=Math.max(i.top,Math.min(t.top,i.bottom-m))-e.top,h=Math.min(400,o?u:d);else{l=!0,h=Math.min(400,(a?e.right:i.right-e.left)-30);let w=i.bottom-e.bottom;w>=m||w>e.top?c=t.bottom-e.top:(f="bottom",c=e.bottom-t.top)}let g=(e.bottom-e.top)/s.offsetHeight,O=(e.right-e.left)/s.offsetWidth;return{style:`${f}: ${c/g}px; max-width: ${h/O}px`,class:"cm-completionInfo-"+(l?a?"left-narrow":"right-narrow":o?"left":"right")}}function jH(r){let e=r.addToOptions.slice();return r.icons&&e.push({render(t){let n=document.createElement("div");return n.classList.add("cm-completionIcon"),t.type&&n.classList.add(...t.type.split(/\s+/g).map(i=>"cm-completionIcon-"+i)),n.setAttribute("aria-hidden","true"),n},position:20}),e.push({render(t,n,i,s){let a=document.createElement("span");a.className="cm-completionLabel";let o=t.displayLabel||t.label,l=0;for(let f=0;f<s.length;){let c=s[f++],h=s[f++];c>l&&a.appendChild(document.createTextNode(o.slice(l,c)));let u=a.appendChild(document.createElement("span"));u.appendChild(document.createTextNode(o.slice(c,h))),u.className="cm-completionMatchedText",l=h}return l<o.length&&a.appendChild(document.createTextNode(o.slice(l))),a},position:50},{render(t){if(!t.detail)return null;let n=document.createElement("span");return n.className="cm-completionDetail",n.textContent=t.detail,n},position:80}),e.sort((t,n)=>t.position-n.position).map(t=>t.render)}function Bp(r,e,t){if(r<=t)return{from:0,to:r};if(e<0&&(e=0),e<=r>>1){let i=Math.floor(e/t);return{from:i*t,to:(i+1)*t}}let n=Math.floor((r-e)/t);return{from:r-(n+1)*t,to:r-n*t}}class zH{constructor(e,t,n){this.view=e,this.stateField=t,this.applyCompletion=n,this.info=null,this.infoDestroy=null,this.placeInfoReq={read:()=>this.measureInfo(),write:l=>this.placeInfo(l),key:this},this.space=null,this.currentClass="";let i=e.state.field(t),{options:s,selected:a}=i.open,o=e.state.facet(Jr);this.optionContent=jH(o),this.optionClass=o.optionClass,this.tooltipClass=o.tooltipClass,this.range=Bp(s.length,a,o.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(e.state),this.dom.addEventListener("mousedown",l=>{let{options:f}=e.state.field(t).open;for(let c=l.target,h;c&&c!=this.dom;c=c.parentNode)if(c.nodeName=="LI"&&(h=/-(\d+)$/.exec(c.id))&&+h[1]<f.length){this.applyCompletion(e,f[+h[1]]),l.preventDefault();return}}),this.dom.addEventListener("focusout",l=>{let f=e.state.field(this.stateField,!1);f&&f.tooltip&&e.state.facet(Jr).closeOnBlur&&l.relatedTarget!=e.contentDOM&&e.dispatch({effects:qc.of(null)})}),this.showOptions(s,i.id)}mount(){this.updateSel()}showOptions(e,t){this.list&&this.list.remove(),this.list=this.dom.appendChild(this.createListBox(e,t,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)})}update(e){var t;let n=e.state.field(this.stateField),i=e.startState.field(this.stateField);if(this.updateTooltipClass(e.state),n!=i){let{options:s,selected:a,disabled:o}=n.open;(!i.open||i.open.options!=s)&&(this.range=Bp(s.length,a,e.state.facet(Jr).maxRenderedOptions),this.showOptions(s,n.id)),this.updateSel(),o!=((t=i.open)===null||t===void 0?void 0:t.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!o)}}updateTooltipClass(e){let t=this.tooltipClass(e);if(t!=this.currentClass){for(let n of this.currentClass.split(" "))n&&this.dom.classList.remove(n);for(let n of t.split(" "))n&&this.dom.classList.add(n);this.currentClass=t}}positioned(e){this.space=e,this.info&&this.view.requestMeasure(this.placeInfoReq)}updateSel(){let e=this.view.state.field(this.stateField),t=e.open;if((t.selected>-1&&t.selected<this.range.from||t.selected>=this.range.to)&&(this.range=Bp(t.options.length,t.selected,this.view.state.facet(Jr).maxRenderedOptions),this.showOptions(t.options,e.id)),this.updateSelectedOption(t.selected)){this.destroyInfo();let{completion:n}=t.options[t.selected],{info:i}=n;if(!i)return;let s=typeof i=="string"?document.createTextNode(i):i(n);if(!s)return;"then"in s?s.then(a=>{a&&this.view.state.field(this.stateField,!1)==e&&this.addInfoPane(a,n)}).catch(a=>tn(this.view.state,a,"completion info")):this.addInfoPane(s,n)}}addInfoPane(e,t){this.destroyInfo();let n=this.info=document.createElement("div");if(n.className="cm-tooltip cm-completionInfo",e.nodeType!=null)n.appendChild(e),this.infoDestroy=null;else{let{dom:i,destroy:s}=e;n.appendChild(i),this.infoDestroy=s||null}this.dom.appendChild(n),this.view.requestMeasure(this.placeInfoReq)}updateSelectedOption(e){let t=null;for(let n=this.list.firstChild,i=this.range.from;n;n=n.nextSibling,i++)n.nodeName!="LI"||!n.id?i--:i==e?n.hasAttribute("aria-selected")||(n.setAttribute("aria-selected","true"),t=n):n.hasAttribute("aria-selected")&&n.removeAttribute("aria-selected");return t&&HH(this.list,t),t}measureInfo(){let e=this.dom.querySelector("[aria-selected]");if(!e||!this.info)return null;let t=this.dom.getBoundingClientRect(),n=this.info.getBoundingClientRect(),i=e.getBoundingClientRect(),s=this.space;if(!s){let a=this.dom.ownerDocument.defaultView||window;s={left:0,top:0,right:a.innerWidth,bottom:a.innerHeight}}return i.top>Math.min(s.bottom,t.bottom)-10||i.bottom<Math.max(s.top,t.top)+10?null:this.view.state.facet(Jr).positionInfo(this.view,t,i,n,s,this.dom)}placeInfo(e){this.info&&(e?(e.style&&(this.info.style.cssText=e.style),this.info.className="cm-tooltip cm-completionInfo "+(e.class||"")):this.info.style.cssText="top: -1e6px")}createListBox(e,t,n){const i=document.createElement("ul");i.id=t,i.setAttribute("role","listbox"),i.setAttribute("aria-expanded","true"),i.setAttribute("aria-label",this.view.state.phrase("Completions"));let s=null;for(let a=n.from;a<n.to;a++){let{completion:o,match:l}=e[a],{section:f}=o;if(f){let u=typeof f=="string"?f:f.name;if(u!=s&&(a>n.from||n.from==0))if(s=u,typeof f!="string"&&f.header)i.appendChild(f.header(f));else{let d=i.appendChild(document.createElement("completion-section"));d.textContent=u}}const c=i.appendChild(document.createElement("li"));c.id=t+"-"+a,c.setAttribute("role","option");let h=this.optionClass(o);h&&(c.className=h);for(let u of this.optionContent){let d=u(o,this.view.state,this.view,l);d&&c.appendChild(d)}}return n.from&&i.classList.add("cm-completionListIncompleteTop"),n.to<e.length&&i.classList.add("cm-completionListIncompleteBottom"),i}destroyInfo(){this.info&&(this.infoDestroy&&this.infoDestroy(),this.info.remove(),this.info=null)}destroy(){this.destroyInfo()}}function GH(r,e){return t=>new zH(t,r,e)}function HH(r,e){let t=r.getBoundingClientRect(),n=e.getBoundingClientRect(),i=t.height/r.offsetHeight;n.top<t.top?r.scrollTop-=(t.top-n.top)/i:n.bottom>t.bottom&&(r.scrollTop+=(n.bottom-t.bottom)/i)}function Ub(r){return(r.boost||0)*100+(r.apply?10:0)+(r.info?5:0)+(r.type?1:0)}function YH(r,e){let t=[],n=null,i=f=>{t.push(f);let{section:c}=f.completion;if(c){n||(n=[]);let h=typeof c=="string"?c:c.name;n.some(u=>u.name==h)||n.push(typeof c=="string"?{name:h}:c)}},s=e.facet(Jr);for(let f of r)if(f.hasResult()){let c=f.result.getMatch;if(f.result.filter===!1)for(let h of f.result.options)i(new Bb(h,f.source,c?c(h):[],1e9-t.length));else{let h=e.sliceDoc(f.from,f.to),u,d=s.filterStrict?new VH(h):new XH(h);for(let p of f.result.options)if(u=d.match(p.label)){let m=p.displayLabel?c?c(p,u.matched):[]:u.matched;i(new Bb(p,f.source,m,u.score+(p.boost||0)))}}}if(n){let f=Object.create(null),c=0,h=(u,d)=>{var p,m;return((p=u.rank)!==null&&p!==void 0?p:1e9)-((m=d.rank)!==null&&m!==void 0?m:1e9)||(u.name<d.name?-1:1)};for(let u of n.sort(h))c-=1e5,f[u.name]=c;for(let u of t){let{section:d}=u.completion;d&&(u.score+=f[typeof d=="string"?d:d.name])}}let a=[],o=null,l=s.compareCompletions;for(let f of t.sort((c,h)=>h.score-c.score||l(c.completion,h.completion))){let c=f.completion;!o||o.label!=c.label||o.detail!=c.detail||o.type!=null&&c.type!=null&&o.type!=c.type||o.apply!=c.apply||o.boost!=c.boost?a.push(f):Ub(f.completion)>Ub(o)&&(a[a.length-1]=f),o=f.completion}return a}class al{constructor(e,t,n,i,s,a){this.options=e,this.attrs=t,this.tooltip=n,this.timestamp=i,this.selected=s,this.disabled=a}setSelected(e,t){return e==this.selected||e>=this.options.length?this:new al(this.options,Xb(t,e),this.tooltip,this.timestamp,e,this.disabled)}static build(e,t,n,i,s,a){if(i&&!a&&e.some(f=>f.isPending))return i.setDisabled();let o=YH(e,t);if(!o.length)return i&&e.some(f=>f.isPending)?i.setDisabled():null;let l=t.facet(Jr).selectOnOpen?0:-1;if(i&&i.selected!=l&&i.selected!=-1){let f=i.options[i.selected].completion;for(let c=0;c<o.length;c++)if(o[c].completion==f){l=c;break}}return new al(o,Xb(n,l),{pos:e.reduce((f,c)=>c.hasResult()?Math.min(f,c.from):f,1e8),create:nY,above:s.aboveCursor},i?i.timestamp:Date.now(),l,!1)}map(e){return new al(this.options,this.attrs,Object.assign(Object.assign({},this.tooltip),{pos:e.mapPos(this.tooltip.pos)}),this.timestamp,this.selected,this.disabled)}setDisabled(){return new al(this.options,this.attrs,this.tooltip,this.timestamp,this.selected,!0)}}class Yd{constructor(e,t,n){this.active=e,this.id=t,this.open=n}static start(){return new Yd(tY,"cm-ac-"+Math.floor(Math.random()*2e6).toString(36),null)}update(e){let{state:t}=e,n=t.facet(Jr),s=(n.override||t.languageDataAt("autocomplete",wo(t)).map(UH)).map(l=>(this.active.find(c=>c.source==l)||new Ri(l,this.active.some(c=>c.state!=0)?1:0)).update(e,n));s.length==this.active.length&&s.every((l,f)=>l==this.active[f])&&(s=this.active);let a=this.open,o=e.effects.some(l=>l.is(Ex));a&&e.docChanged&&(a=a.map(e.changes)),e.selection||s.some(l=>l.hasResult()&&e.changes.touchesRange(l.from,l.to))||!KH(s,this.active)||o?a=al.build(s,t,this.id,a,n,o):a&&a.disabled&&!s.some(l=>l.isPending)&&(a=null),!a&&s.every(l=>!l.isPending)&&s.some(l=>l.hasResult())&&(s=s.map(l=>l.hasResult()?new Ri(l.source,0):l));for(let l of e.effects)l.is(cE)&&(a=a&&a.setSelected(l.value,this.id));return s==this.active&&a==this.open?this:new Yd(s,this.id,a)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:this.active.length?JH:eY}}function KH(r,e){if(r==e)return!0;for(let t=0,n=0;;){for(;t<r.length&&!r[t].hasResult();)t++;for(;n<e.length&&!e[n].hasResult();)n++;let i=t==r.length,s=n==e.length;if(i||s)return i==s;if(r[t++].result!=e[n++].result)return!1}}const JH={"aria-autocomplete":"list"},eY={};function Xb(r,e){let t={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":r};return e>-1&&(t["aria-activedescendant"]=r+"-"+e),t}const tY=[];function fE(r,e){if(r.isUserEvent("input.complete")){let n=r.annotation(lE);if(n&&e.activateOnCompletion(n))return 12}let t=r.isUserEvent("input.type");return t&&e.activateOnTyping?5:t?1:r.isUserEvent("delete.backward")?2:r.selection?8:r.docChanged?16:0}class Ri{constructor(e,t,n=!1){this.source=e,this.state=t,this.explicit=n}hasResult(){return!1}get isPending(){return this.state==1}update(e,t){let n=fE(e,t),i=this;(n&8||n&16&&this.touches(e))&&(i=new Ri(i.source,0)),n&4&&i.state==0&&(i=new Ri(this.source,1)),i=i.updateFor(e,n);for(let s of e.effects)if(s.is(Hd))i=new Ri(i.source,1,s.value);else if(s.is(qc))i=new Ri(i.source,0);else if(s.is(Ex))for(let a of s.value)a.source==i.source&&(i=a);return i}updateFor(e,t){return this.map(e.changes)}map(e){return this}touches(e){return e.changes.touchesRange(wo(e.state))}}class bl extends Ri{constructor(e,t,n,i,s,a){super(e,3,t),this.limit=n,this.result=i,this.from=s,this.to=a}hasResult(){return!0}updateFor(e,t){var n;if(!(t&3))return this.map(e.changes);let i=this.result;i.map&&!e.changes.empty&&(i=i.map(i,e.changes));let s=e.changes.mapPos(this.from),a=e.changes.mapPos(this.to,1),o=wo(e.state);if(o>a||!i||t&2&&(wo(e.startState)==this.from||o<this.limit))return new Ri(this.source,t&4?1:0);let l=e.changes.mapPos(this.limit);return rY(i.validFor,e.state,s,a)?new bl(this.source,this.explicit,l,i,s,a):i.update&&(i=i.update(i,s,a,new aE(e.state,o,!1)))?new bl(this.source,this.explicit,l,i,i.from,(n=i.to)!==null&&n!==void 0?n:wo(e.state)):new Ri(this.source,1,this.explicit)}map(e){return e.empty?this:(this.result.map?this.result.map(this.result,e):this.result)?new bl(this.source,this.explicit,e.mapPos(this.limit),this.result,e.mapPos(this.from),e.mapPos(this.to,1)):new Ri(this.source,0)}touches(e){return e.changes.touchesRange(this.from,this.to)}}function rY(r,e,t,n){if(!r)return!1;let i=e.sliceDoc(t,n);return typeof r=="function"?r(i,t,n,e):oE(r,!0).test(i)}const Ex=rt.define({map(r,e){return r.map(t=>t.map(e))}}),cE=rt.define(),zn=Cr.define({create(){return Yd.start()},update(r,e){return r.update(e)},provide:r=>[gx.from(r,e=>e.tooltip),We.contentAttributes.from(r,e=>e.attrs)]});function Px(r,e){const t=e.completion.apply||e.completion.label;let n=r.state.field(zn).active.find(i=>i.source==e.source);return n instanceof bl?(typeof t=="string"?r.dispatch(Object.assign(Object.assign({},WH(r.state,t,n.from,n.to)),{annotations:lE.of(e.completion)})):t(r,e.completion,n.from,n.to),!0):!1}const nY=GH(zn,Px);function mu(r,e="option"){return t=>{let n=t.state.field(zn,!1);if(!n||!n.open||n.open.disabled||Date.now()-n.open.timestamp<t.state.facet(Jr).interactionDelay)return!1;let i=1,s;e=="page"&&(s=jA(t,n.open.tooltip))&&(i=Math.max(2,Math.floor(s.dom.offsetHeight/s.dom.querySelector("li").offsetHeight)-1));let{length:a}=n.open.options,o=n.open.selected>-1?n.open.selected+i*(r?1:-1):r?0:a-1;return o<0?o=e=="page"?0:a-1:o>=a&&(o=e=="page"?a-1:0),t.dispatch({effects:cE.of(o)}),!0}}const iY=r=>{let e=r.state.field(zn,!1);return r.state.readOnly||!e||!e.open||e.open.selected<0||e.open.disabled||Date.now()-e.open.timestamp<r.state.facet(Jr).interactionDelay?!1:Px(r,e.open.options[e.open.selected])},Vb=r=>r.state.field(zn,!1)?(r.dispatch({effects:Hd.of(!0)}),!0):!1,sY=r=>{let e=r.state.field(zn,!1);return!e||!e.active.some(t=>t.state!=0)?!1:(r.dispatch({effects:qc.of(null)}),!0)};class aY{constructor(e,t){this.active=e,this.context=t,this.time=Date.now(),this.updates=[],this.done=void 0}}const oY=50,lY=1e3,fY=pr.fromClass(class{constructor(r){this.view=r,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.pendingStart=!1,this.composing=0;for(let e of r.state.field(zn).active)e.isPending&&this.startQuery(e)}update(r){let e=r.state.field(zn),t=r.state.facet(Jr);if(!r.selectionSet&&!r.docChanged&&r.startState.field(zn)==e)return;let n=r.transactions.some(s=>{let a=fE(s,t);return a&8||(s.selection||s.docChanged)&&!(a&3)});for(let s=0;s<this.running.length;s++){let a=this.running[s];if(n||a.context.abortOnDocChange&&r.docChanged||a.updates.length+r.transactions.length>oY&&Date.now()-a.time>lY){for(let o of a.context.abortListeners)try{o()}catch(l){tn(this.view.state,l)}a.context.abortListeners=null,this.running.splice(s--,1)}else a.updates.push(...r.transactions)}this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),r.transactions.some(s=>s.effects.some(a=>a.is(Hd)))&&(this.pendingStart=!0);let i=this.pendingStart?50:t.activateOnTypingDelay;if(this.debounceUpdate=e.active.some(s=>s.isPending&&!this.running.some(a=>a.active.source==s.source))?setTimeout(()=>this.startUpdate(),i):-1,this.composing!=0)for(let s of r.transactions)s.isUserEvent("input.type")?this.composing=2:this.composing==2&&s.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1,this.pendingStart=!1;let{state:r}=this.view,e=r.field(zn);for(let t of e.active)t.isPending&&!this.running.some(n=>n.active.source==t.source)&&this.startQuery(t);this.running.length&&e.open&&e.open.disabled&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(Jr).updateSyncTime))}startQuery(r){let{state:e}=this.view,t=wo(e),n=new aE(e,t,r.explicit,this.view),i=new aY(r,n);this.running.push(i),Promise.resolve(r.source(n)).then(s=>{i.context.aborted||(i.done=s||null,this.scheduleAccept())},s=>{this.view.dispatch({effects:qc.of(null)}),tn(this.view.state,s)})}scheduleAccept(){this.running.every(r=>r.done!==void 0)?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(Jr).updateSyncTime))}accept(){var r;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let e=[],t=this.view.state.facet(Jr),n=this.view.state.field(zn);for(let i=0;i<this.running.length;i++){let s=this.running[i];if(s.done===void 0)continue;if(this.running.splice(i--,1),s.done){let o=wo(s.updates.length?s.updates[0].startState:this.view.state),l=Math.min(o,s.done.from+(s.active.explicit?0:1)),f=new bl(s.active.source,s.active.explicit,l,s.done,s.done.from,(r=s.done.to)!==null&&r!==void 0?r:o);for(let c of s.updates)f=f.update(c,t);if(f.hasResult()){e.push(f);continue}}let a=n.active.find(o=>o.source==s.active.source);if(a&&a.isPending)if(s.done==null){let o=new Ri(s.active.source,0);for(let l of s.updates)o=o.update(l,t);o.isPending||e.push(o)}else this.startQuery(a)}(e.length||n.open&&n.open.disabled)&&this.view.dispatch({effects:Ex.of(e)})}},{eventHandlers:{blur(r){let e=this.view.state.field(zn,!1);if(e&&e.tooltip&&this.view.state.facet(Jr).closeOnBlur){let t=e.open&&jA(this.view,e.open.tooltip);(!t||!t.dom.contains(r.relatedTarget))&&setTimeout(()=>this.view.dispatch({effects:qc.of(null)}),10)}},compositionstart(){this.composing=1},compositionend(){this.composing==3&&setTimeout(()=>this.view.dispatch({effects:Hd.of(!1)}),20),this.composing=0}}}),cY=typeof navigator=="object"&&/Win/.test(navigator.platform),hY=ja.highest(We.domEventHandlers({keydown(r,e){let t=e.state.field(zn,!1);if(!t||!t.open||t.open.disabled||t.open.selected<0||r.key.length>1||r.ctrlKey&&!(cY&&r.altKey)||r.metaKey)return!1;let n=t.open.options[t.open.selected],i=t.active.find(a=>a.source==n.source),s=n.completion.commitCharacters||i.result.commitCharacters;return s&&s.indexOf(r.key)>-1&&Px(e,n),!1}})),uY=We.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'""',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"400px",boxSizing:"border-box",whiteSpace:"pre-line"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:"30px"},".cm-completionInfo.cm-completionInfo-right-narrow":{left:"30px"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"''"}},".cm-completionIcon-class":{"&:after":{content:"''"}},".cm-completionIcon-interface":{"&:after":{content:"''"}},".cm-completionIcon-variable":{"&:after":{content:"''"}},".cm-completionIcon-constant":{"&:after":{content:"''"}},".cm-completionIcon-type":{"&:after":{content:"''"}},".cm-completionIcon-enum":{"&:after":{content:"''"}},".cm-completionIcon-property":{"&:after":{content:"''"}},".cm-completionIcon-keyword":{"&:after":{content:"''"}},".cm-completionIcon-namespace":{"&:after":{content:"''"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}}),jc={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},po=rt.define({map(r,e){let t=e.mapPos(r,-1,dn.TrackAfter);return t??void 0}}),Rx=new class extends Ks{};Rx.startSide=1;Rx.endSide=-1;const hE=Cr.define({create(){return Ct.empty},update(r,e){if(r=r.map(e.changes),e.selection){let t=e.state.doc.lineAt(e.selection.main.head);r=r.update({filter:n=>n>=t.from&&n<=t.to})}for(let t of e.effects)t.is(po)&&(r=r.update({add:[Rx.range(t.value,t.value+1)]}));return r}});function dY(){return[mY,hE]}const Zp="()[]{}<>";function uE(r){for(let e=0;e<Zp.length;e+=2)if(Zp.charCodeAt(e)==r)return Zp.charAt(e+1);return tx(r<128?r:r+1)}function dE(r,e){return r.languageDataAt("closeBrackets",e)[0]||jc}const pY=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),mY=We.inputHandler.of((r,e,t,n)=>{if((pY?r.composing:r.compositionStarted)||r.state.readOnly)return!1;let i=r.state.selection.main;if(n.length>2||n.length==2&&Os(qn(n,0))==1||e!=i.from||t!=i.to)return!1;let s=xY(r.state,n);return s?(r.dispatch(s),!0):!1}),gY=({state:r,dispatch:e})=>{if(r.readOnly)return!1;let n=dE(r,r.selection.main.head).brackets||jc.brackets,i=null,s=r.changeByRange(a=>{if(a.empty){let o=vY(r.doc,a.head);for(let l of n)if(l==o&&B0(r.doc,a.head)==uE(qn(l,0)))return{changes:{from:a.head-l.length,to:a.head+l.length},range:Oe.cursor(a.head-l.length)}}return{range:i=a}});return i||e(r.update(s,{scrollIntoView:!0,userEvent:"delete.backward"})),!i},OY=[{key:"Backspace",run:gY}];function xY(r,e){let t=dE(r,r.selection.main.head),n=t.brackets||jc.brackets;for(let i of n){let s=uE(qn(i,0));if(e==i)return s==i?bY(r,i,n.indexOf(i+i+i)>-1,t):yY(r,i,s,t.before||jc.before);if(e==s&&pE(r,r.selection.main.from))return wY(r,i,s)}return null}function pE(r,e){let t=!1;return r.field(hE).between(0,r.doc.length,n=>{n==e&&(t=!0)}),t}function B0(r,e){let t=r.sliceString(e,e+2);return t.slice(0,Os(qn(t,0)))}function vY(r,e){let t=r.sliceString(e-2,e);return Os(qn(t,0))==t.length?t:t.slice(1)}function yY(r,e,t,n){let i=null,s=r.changeByRange(a=>{if(!a.empty)return{changes:[{insert:e,from:a.from},{insert:t,from:a.to}],effects:po.of(a.to+e.length),range:Oe.range(a.anchor+e.length,a.head+e.length)};let o=B0(r.doc,a.head);return!o||/\s/.test(o)||n.indexOf(o)>-1?{changes:{insert:e+t,from:a.head},effects:po.of(a.head+e.length),range:Oe.cursor(a.head+e.length)}:{range:i=a}});return i?null:r.update(s,{scrollIntoView:!0,userEvent:"input.type"})}function wY(r,e,t){let n=null,i=r.changeByRange(s=>s.empty&&B0(r.doc,s.head)==t?{changes:{from:s.head,to:s.head+t.length,insert:t},range:Oe.cursor(s.head+t.length)}:n={range:s});return n?null:r.update(i,{scrollIntoView:!0,userEvent:"input.type"})}function bY(r,e,t,n){let i=n.stringPrefixes||jc.stringPrefixes,s=null,a=r.changeByRange(o=>{if(!o.empty)return{changes:[{insert:e,from:o.from},{insert:e,from:o.to}],effects:po.of(o.to+e.length),range:Oe.range(o.anchor+e.length,o.head+e.length)};let l=o.head,f=B0(r.doc,l),c;if(f==e){if(qb(r,l))return{changes:{insert:e+e,from:l},effects:po.of(l+e.length),range:Oe.cursor(l+e.length)};if(pE(r,l)){let u=t&&r.sliceDoc(l,l+e.length*3)==e+e+e?e+e+e:e;return{changes:{from:l,to:l+u.length,insert:u},range:Oe.cursor(l+u.length)}}}else{if(t&&r.sliceDoc(l-2*e.length,l)==e+e&&(c=jb(r,l-2*e.length,i))>-1&&qb(r,c))return{changes:{insert:e+e+e+e,from:l},effects:po.of(l+e.length),range:Oe.cursor(l+e.length)};if(r.charCategorizer(l)(f)!=ur.Word&&jb(r,l,i)>-1&&!_Y(r,l,e,i))return{changes:{insert:e+e,from:l},effects:po.of(l+e.length),range:Oe.cursor(l+e.length)}}return{range:s=o}});return s?null:r.update(a,{scrollIntoView:!0,userEvent:"input.type"})}function qb(r,e){let t=En(r).resolveInner(e+1);return t.parent&&t.from==e}function _Y(r,e,t,n){let i=En(r).resolveInner(e,-1),s=n.reduce((a,o)=>Math.max(a,o.length),0);for(let a=0;a<5;a++){let o=r.sliceDoc(i.from,Math.min(i.to,i.from+t.length+s)),l=o.indexOf(t);if(!l||l>-1&&n.indexOf(o.slice(0,l))>-1){let c=i.firstChild;for(;c&&c.from==i.from&&c.to-c.from>t.length+l;){if(r.sliceDoc(c.to-t.length,c.to)==t)return!1;c=c.firstChild}return!0}let f=i.to==e&&i.parent;if(!f)break;i=f}return!1}function jb(r,e,t){let n=r.charCategorizer(e);if(n(r.sliceDoc(e-1,e))!=ur.Word)return e;for(let i of t){let s=e-i.length;if(r.sliceDoc(s,e)==i&&n(r.sliceDoc(s-1,s))!=ur.Word)return s}return-1}function kY(r={}){return[hY,zn,Jr.of(r),fY,SY,uY]}const mE=[{key:"Ctrl-Space",run:Vb},{mac:"Alt-`",run:Vb},{key:"Escape",run:sY},{key:"ArrowDown",run:mu(!0)},{key:"ArrowUp",run:mu(!1)},{key:"PageDown",run:mu(!0,"page")},{key:"PageUp",run:mu(!1,"page")},{key:"Enter",run:iY}],SY=ja.highest(Q0.computeN([Jr],r=>r.facet(Jr).defaultKeymap?[mE]:[]));class zb{constructor(e,t,n){this.from=e,this.to=t,this.diagnostic=n}}class co{constructor(e,t,n){this.diagnostics=e,this.panel=t,this.selected=n}static init(e,t,n){let i=e,s=n.facet(zc).markerFilter;s&&(i=s(i,n));let a=e.slice().sort((h,u)=>h.from-u.from||h.to-u.to),o=new Js,l=[],f=0;for(let h=0;;){let u=h==a.length?null:a[h];if(!u&&!l.length)break;let d,p;for(l.length?(d=f,p=l.reduce((g,O)=>Math.min(g,O.to),u&&u.from>d?u.from:1e8)):(d=u.from,p=u.to,l.push(u),h++);h<a.length;){let g=a[h];if(g.from==d&&(g.to>g.from||g.to==d))l.push(g),h++,p=Math.min(g.to,p);else{p=Math.min(g.from,p);break}}let m=IY(l);if(l.some(g=>g.from==g.to||g.from==g.to-1&&n.doc.lineAt(g.from).to==g.from))o.add(d,d,je.widget({widget:new $Y(m),diagnostics:l.slice()}));else{let g=l.reduce((O,w)=>w.markClass?O+" "+w.markClass:O,"");o.add(d,p,je.mark({class:"cm-lintRange cm-lintRange-"+m+g,diagnostics:l.slice(),inclusiveEnd:l.some(O=>O.to>p)}))}f=p;for(let g=0;g<l.length;g++)l[g].to<=f&&l.splice(g--,1)}let c=o.finish();return new co(c,t,Ll(c))}}function Ll(r,e=null,t=0){let n=null;return r.between(t,1e9,(i,s,{spec:a})=>{if(!(e&&a.diagnostics.indexOf(e)<0))if(!n)n=new zb(i,s,e||a.diagnostics[0]);else{if(a.diagnostics.indexOf(n.diagnostic)<0)return!1;n=new zb(n.from,s,n.diagnostic)}}),n}function TY(r,e){let t=e.pos,n=e.end||t,i=r.state.facet(zc).hideOn(r,t,n);if(i!=null)return i;let s=r.startState.doc.lineAt(e.pos);return!!(r.effects.some(a=>a.is(gE))||r.changes.touchesRange(s.from,Math.max(s.to,n)))}function CY(r,e){return r.field(ci,!1)?e:e.concat(rt.appendConfig.of(LY))}const gE=rt.define(),Qx=rt.define(),OE=rt.define(),ci=Cr.define({create(){return new co(je.none,null,null)},update(r,e){if(e.docChanged&&r.diagnostics.size){let t=r.diagnostics.map(e.changes),n=null,i=r.panel;if(r.selected){let s=e.changes.mapPos(r.selected.from,1);n=Ll(t,r.selected.diagnostic,s)||Ll(t,null,s)}!t.size&&i&&e.state.facet(zc).autoPanel&&(i=null),r=new co(t,i,n)}for(let t of e.effects)if(t.is(gE)){let n=e.state.facet(zc).autoPanel?t.value.length?Gc.open:null:r.panel;r=co.init(t.value,n,e.state)}else t.is(Qx)?r=new co(r.diagnostics,t.value?Gc.open:null,r.selected):t.is(OE)&&(r=new co(r.diagnostics,r.panel,t.value));return r},provide:r=>[Wc.from(r,e=>e.panel),We.decorations.from(r,e=>e.diagnostics)]}),AY=je.mark({class:"cm-lintRange cm-lintRange-active"});function EY(r,e,t){let{diagnostics:n}=r.state.field(ci),i,s=-1,a=-1;n.between(e-(t<0?1:0),e+(t>0?1:0),(l,f,{spec:c})=>{if(e>=l&&e<=f&&(l==f||(e>l||t>0)&&(e<f||t<0)))return i=c.diagnostics,s=l,a=f,!1});let o=r.state.facet(zc).tooltipFilter;return i&&o&&(i=o(i,r.state)),i?{pos:s,end:a,above:r.state.doc.lineAt(s).to<a,create(){return{dom:PY(r,i)}}}:null}function PY(r,e){return Yt("ul",{class:"cm-tooltip-lint"},e.map(t=>vE(r,t,!1)))}const RY=r=>{let e=r.state.field(ci,!1);(!e||!e.panel)&&r.dispatch({effects:CY(r.state,[Qx.of(!0)])});let t=Zc(r,Gc.open);return t&&t.dom.querySelector(".cm-panel-lint ul").focus(),!0},Gb=r=>{let e=r.state.field(ci,!1);return!e||!e.panel?!1:(r.dispatch({effects:Qx.of(!1)}),!0)},QY=r=>{let e=r.state.field(ci,!1);if(!e)return!1;let t=r.state.selection.main,n=e.diagnostics.iter(t.to+1);return!n.value&&(n=e.diagnostics.iter(0),!n.value||n.from==t.from&&n.to==t.to)?!1:(r.dispatch({selection:{anchor:n.from,head:n.to},scrollIntoView:!0}),!0)},FY=[{key:"Mod-Shift-m",run:RY,preventDefault:!0},{key:"F8",run:QY}],zc=Ze.define({combine(r){return Object.assign({sources:r.map(e=>e.source).filter(e=>e!=null)},Ls(r.map(e=>e.config),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null,hideOn:()=>null},{needsRefresh:(e,t)=>e?t?n=>e(n)||t(n):e:t}))}});function xE(r){let e=[];if(r)e:for(let{name:t}of r){for(let n=0;n<t.length;n++){let i=t[n];if(/[a-zA-Z]/.test(i)&&!e.some(s=>s.toLowerCase()==i.toLowerCase())){e.push(i);continue e}}e.push("")}return e}function vE(r,e,t){var n;let i=t?xE(e.actions):[];return Yt("li",{class:"cm-diagnostic cm-diagnostic-"+e.severity},Yt("span",{class:"cm-diagnosticText"},e.renderMessage?e.renderMessage(r):e.message),(n=e.actions)===null||n===void 0?void 0:n.map((s,a)=>{let o=!1,l=u=>{if(u.preventDefault(),o)return;o=!0;let d=Ll(r.state.field(ci).diagnostics,e);d&&s.apply(r,d.from,d.to)},{name:f}=s,c=i[a]?f.indexOf(i[a]):-1,h=c<0?f:[f.slice(0,c),Yt("u",f.slice(c,c+1)),f.slice(c+1)];return Yt("button",{type:"button",class:"cm-diagnosticAction",onclick:l,onmousedown:l,"aria-label":` Action: ${f}${c<0?"":` (access key "${i[a]})"`}.`},h)}),e.source&&Yt("div",{class:"cm-diagnosticSource"},e.source))}class $Y extends aa{constructor(e){super(),this.sev=e}eq(e){return e.sev==this.sev}toDOM(){return Yt("span",{class:"cm-lintPoint cm-lintPoint-"+this.sev})}}class Hb{constructor(e,t){this.diagnostic=t,this.id="item_"+Math.floor(Math.random()*4294967295).toString(16),this.dom=vE(e,t,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class Gc{constructor(e){this.view=e,this.items=[];let t=i=>{if(i.keyCode==27)Gb(this.view),this.view.focus();else if(i.keyCode==38||i.keyCode==33)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(i.keyCode==40||i.keyCode==34)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(i.keyCode==36)this.moveSelection(0);else if(i.keyCode==35)this.moveSelection(this.items.length-1);else if(i.keyCode==13)this.view.focus();else if(i.keyCode>=65&&i.keyCode<=90&&this.selectedIndex>=0){let{diagnostic:s}=this.items[this.selectedIndex],a=xE(s.actions);for(let o=0;o<a.length;o++)if(a[o].toUpperCase().charCodeAt(0)==i.keyCode){let l=Ll(this.view.state.field(ci).diagnostics,s);l&&s.actions[o].apply(e,l.from,l.to)}}else return;i.preventDefault()},n=i=>{for(let s=0;s<this.items.length;s++)this.items[s].dom.contains(i.target)&&this.moveSelection(s)};this.list=Yt("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:t,onclick:n}),this.dom=Yt("div",{class:"cm-panel-lint"},this.list,Yt("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>Gb(this.view)},"")),this.update()}get selectedIndex(){let e=this.view.state.field(ci).selected;if(!e)return-1;for(let t=0;t<this.items.length;t++)if(this.items[t].diagnostic==e.diagnostic)return t;return-1}update(){let{diagnostics:e,selected:t}=this.view.state.field(ci),n=0,i=!1,s=null,a=new Set;for(e.between(0,this.view.state.doc.length,(o,l,{spec:f})=>{for(let c of f.diagnostics){if(a.has(c))continue;a.add(c);let h=-1,u;for(let d=n;d<this.items.length;d++)if(this.items[d].diagnostic==c){h=d;break}h<0?(u=new Hb(this.view,c),this.items.splice(n,0,u),i=!0):(u=this.items[h],h>n&&(this.items.splice(n,h-n),i=!0)),t&&u.diagnostic==t.diagnostic?u.dom.hasAttribute("aria-selected")||(u.dom.setAttribute("aria-selected","true"),s=u):u.dom.hasAttribute("aria-selected")&&u.dom.removeAttribute("aria-selected"),n++}});n<this.items.length&&!(this.items.length==1&&this.items[0].diagnostic.from<0);)i=!0,this.items.pop();this.items.length==0&&(this.items.push(new Hb(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),i=!0),s?(this.list.setAttribute("aria-activedescendant",s.id),this.view.requestMeasure({key:this,read:()=>({sel:s.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:o,panel:l})=>{let f=l.height/this.list.offsetHeight;o.top<l.top?this.list.scrollTop-=(l.top-o.top)/f:o.bottom>l.bottom&&(this.list.scrollTop+=(o.bottom-l.bottom)/f)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),i&&this.sync()}sync(){let e=this.list.firstChild;function t(){let n=e;e=n.nextSibling,n.remove()}for(let n of this.items)if(n.dom.parentNode==this.list){for(;e!=n.dom;)t();e=n.dom.nextSibling}else this.list.insertBefore(n.dom,e);for(;e;)t()}moveSelection(e){if(this.selectedIndex<0)return;let t=this.view.state.field(ci),n=Ll(t.diagnostics,this.items[e].diagnostic);n&&this.view.dispatch({selection:{anchor:n.from,head:n.to},scrollIntoView:!0,effects:OE.of(n)})}static open(e){return new Gc(e)}}function DY(r,e='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${e}>${encodeURIComponent(r)}</svg>')`}function gu(r){return DY(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${r}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}const NY=We.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnostic-hint":{borderLeft:"5px solid #66d"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:gu("#d11")},".cm-lintRange-warning":{backgroundImage:gu("orange")},".cm-lintRange-info":{backgroundImage:gu("#999")},".cm-lintRange-hint":{backgroundImage:gu("#66d")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-lintPoint-hint":{"&:after":{borderBottomColor:"#66d"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}});function MY(r){return r=="error"?4:r=="warning"?3:r=="info"?2:1}function IY(r){let e="hint",t=1;for(let n of r){let i=MY(n.severity);i>t&&(t=i,e=n.severity)}return e}const LY=[ci,We.decorations.compute([ci],r=>{let{selected:e,panel:t}=r.field(ci);return!e||!t||e.from==e.to?je.none:je.set([AY.range(e.from,e.to)])}),Tj(EY,{hideOn:TY}),NY],BY=[Mj(),Bj(),nj(),fG(),Dz(),qq(),Yq(),st.allowMultipleSelections.of(!0),wz(),Mz(Bz,{fallback:!0}),jz(),dY(),kY(),mj(),xj(),fj(),OH(),Q0.of([...OY,...hH,...NH,...xG,...Rz,...mE,...FY])],yE=1024;let ZY=0,Wp=class{constructor(e,t){this.from=e,this.to=t}},dr=class{constructor(e={}){this.id=ZY++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof e!="function"&&(e=ra.match(e)),t=>{let n=e(t);return n===void 0?null:[this,n]}}};dr.closedBy=new dr({deserialize:r=>r.split(" ")});dr.openedBy=new dr({deserialize:r=>r.split(" ")});dr.group=new dr({deserialize:r=>r.split(" ")});dr.isolate=new dr({deserialize:r=>{if(r&&r!="rtl"&&r!="ltr"&&r!="auto")throw new RangeError("Invalid value for isolate: "+r);return r||"auto"}});dr.contextHash=new dr({perNode:!0});dr.lookAhead=new dr({perNode:!0});dr.mounted=new dr({perNode:!0});let Kd=class{constructor(e,t,n){this.tree=e,this.overlay=t,this.parser=n}static get(e){return e&&e.props&&e.props[dr.mounted.id]}};const WY=Object.create(null);let ra=class wE{constructor(e,t,n,i=0){this.name=e,this.props=t,this.id=n,this.flags=i}static define(e){let t=e.props&&e.props.length?Object.create(null):WY,n=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(e.name==null?8:0),i=new wE(e.name||"",t,e.id,n);if(e.props){for(let s of e.props)if(Array.isArray(s)||(s=s(i)),s){if(s[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");t[s[0].id]=s[1]}}return i}prop(e){return this.props[e.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(e){if(typeof e=="string"){if(this.name==e)return!0;let t=this.prop(dr.group);return t?t.indexOf(e)>-1:!1}return this.id==e}static match(e){let t=Object.create(null);for(let n in e)for(let i of n.split(" "))t[i]=e[n];return n=>{for(let i=n.prop(dr.group),s=-1;s<(i?i.length:0);s++){let a=t[s<0?n.name:i[s]];if(a)return a}}}};ra.none=new ra("",Object.create(null),0,8);class Fx{constructor(e){this.types=e;for(let t=0;t<e.length;t++)if(e[t].id!=t)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...e){let t=[];for(let n of this.types){let i=null;for(let s of e){let a=s(n);a&&(i||(i=Object.assign({},n.props)),i[a[0].id]=a[1])}t.push(i?new ra(n.name,i,n.id,n.flags):n)}return new Fx(t)}}const Ou=new WeakMap,Yb=new WeakMap;var ln;(function(r){r[r.ExcludeBuffers=1]="ExcludeBuffers",r[r.IncludeAnonymous=2]="IncludeAnonymous",r[r.IgnoreMounts=4]="IgnoreMounts",r[r.IgnoreOverlays=8]="IgnoreOverlays"})(ln||(ln={}));let Ji=class e1{constructor(e,t,n,i,s){if(this.type=e,this.children=t,this.positions=n,this.length=i,this.props=null,s&&s.length){this.props=Object.create(null);for(let[a,o]of s)this.props[typeof a=="number"?a:a.id]=o}}toString(){let e=Kd.get(this);if(e&&!e.overlay)return e.tree.toString();let t="";for(let n of this.children){let i=n.toString();i&&(t&&(t+=","),t+=i)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(t.length?"("+t+")":""):t}cursor(e=0){return new n1(this.topNode,e)}cursorAt(e,t=0,n=0){let i=Ou.get(this)||this.topNode,s=new n1(i);return s.moveTo(e,t),Ou.set(this,s._tree),s}get topNode(){return new La(this,0,0,null)}resolve(e,t=0){let n=Hc(Ou.get(this)||this.topNode,e,t,!1);return Ou.set(this,n),n}resolveInner(e,t=0){let n=Hc(Yb.get(this)||this.topNode,e,t,!0);return Yb.set(this,n),n}resolveStack(e,t=0){return qY(this,e,t)}iterate(e){let{enter:t,leave:n,from:i=0,to:s=this.length}=e,a=e.mode||0,o=(a&ln.IncludeAnonymous)>0;for(let l=this.cursor(a|ln.IncludeAnonymous);;){let f=!1;if(l.from<=s&&l.to>=i&&(!o&&l.type.isAnonymous||t(l)!==!1)){if(l.firstChild())continue;f=!0}for(;f&&n&&(o||!l.type.isAnonymous)&&n(l),!l.nextSibling();){if(!l.parent())return;f=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let t in this.props)e.push([+t,this.props[t]]);return e}balance(e={}){return this.children.length<=8?this:Dx(ra.none,this.children,this.positions,0,this.children.length,0,this.length,(t,n,i)=>new e1(this.type,t,n,i,this.propValues),e.makeTree||((t,n,i)=>new e1(ra.none,t,n,i)))}static build(e){return jY(e)}};Ji.empty=new Ji(ra.none,[],[],0);let UY=class bE{constructor(e,t){this.buffer=e,this.index=t}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new bE(this.buffer,this.index)}},Bl=class _E{constructor(e,t,n){this.buffer=e,this.length=t,this.set=n}get type(){return ra.none}toString(){let e=[];for(let t=0;t<this.buffer.length;)e.push(this.childString(t)),t=this.buffer[t+3];return e.join(",")}childString(e){let t=this.buffer[e],n=this.buffer[e+3],i=this.set.types[t],s=i.name;if(/\W/.test(s)&&!i.isError&&(s=JSON.stringify(s)),e+=4,n==e)return s;let a=[];for(;e<n;)a.push(this.childString(e)),e=this.buffer[e+3];return s+"("+a.join(",")+")"}findChild(e,t,n,i,s){let{buffer:a}=this,o=-1;for(let l=e;l!=t&&!(kE(s,i,a[l+1],a[l+2])&&(o=l,n>0));l=a[l+3]);return o}slice(e,t,n){let i=this.buffer,s=new Uint16Array(t-e),a=0;for(let o=e,l=0;o<t;){s[l++]=i[o++],s[l++]=i[o++]-n;let f=s[l++]=i[o++]-n;s[l++]=i[o++]-e,a=Math.max(a,f)}return new _E(s,a,this.set)}};function kE(r,e,t,n){switch(r){case-2:return t<e;case-1:return n>=e&&t<e;case 0:return t<e&&n>e;case 1:return t<=e&&n>e;case 2:return n>e;case 4:return!0}}function Hc(r,e,t,n){for(var i;r.from==r.to||(t<1?r.from>=e:r.from>e)||(t>-1?r.to<=e:r.to<e);){let a=!n&&r instanceof La&&r.index<0?null:r.parent;if(!a)return r;r=a}let s=n?0:ln.IgnoreOverlays;if(n)for(let a=r,o=a.parent;o;a=o,o=a.parent)a instanceof La&&a.index<0&&((i=o.enter(e,t,s))===null||i===void 0?void 0:i.from)!=a.from&&(r=o);for(;;){let a=r.enter(e,t,s);if(!a)return r;r=a}}let SE=class{cursor(e=0){return new n1(this,e)}getChild(e,t=null,n=null){let i=Kb(this,e,t,n);return i.length?i[0]:null}getChildren(e,t=null,n=null){return Kb(this,e,t,n)}resolve(e,t=0){return Hc(this,e,t,!1)}resolveInner(e,t=0){return Hc(this,e,t,!0)}matchContext(e){return t1(this.parent,e)}enterUnfinishedNodesBefore(e){let t=this.childBefore(e),n=this;for(;t;){let i=t.lastChild;if(!i||i.to!=t.to)break;i.type.isError&&i.from==i.to?(n=t,t=i.prevSibling):t=i}return n}get node(){return this}get next(){return this.parent}},La=class Vu extends SE{constructor(e,t,n,i){super(),this._tree=e,this.from=t,this.index=n,this._parent=i}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,t,n,i,s=0){for(let a=this;;){for(let{children:o,positions:l}=a._tree,f=t>0?o.length:-1;e!=f;e+=t){let c=o[e],h=l[e]+a.from;if(kE(i,n,h,h+c.length)){if(c instanceof Bl){if(s&ln.ExcludeBuffers)continue;let u=c.findChild(0,c.buffer.length,t,n-h,i);if(u>-1)return new r1(new XY(a,c,e,h),null,u)}else if(s&ln.IncludeAnonymous||!c.type.isAnonymous||$x(c)){let u;if(!(s&ln.IgnoreMounts)&&(u=Kd.get(c))&&!u.overlay)return new Vu(u.tree,h,e,a);let d=new Vu(c,h,e,a);return s&ln.IncludeAnonymous||!d.type.isAnonymous?d:d.nextChild(t<0?c.children.length-1:0,t,n,i)}}}if(s&ln.IncludeAnonymous||!a.type.isAnonymous||(a.index>=0?e=a.index+t:e=t<0?-1:a._parent._tree.children.length,a=a._parent,!a))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}enter(e,t,n=0){let i;if(!(n&ln.IgnoreOverlays)&&(i=Kd.get(this._tree))&&i.overlay){let s=e-this.from;for(let{from:a,to:o}of i.overlay)if((t>0?a<=s:a<s)&&(t<0?o>=s:o>s))return new Vu(i.tree,i.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,t,n)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}};function Kb(r,e,t,n){let i=r.cursor(),s=[];if(!i.firstChild())return s;if(t!=null){for(let a=!1;!a;)if(a=i.type.is(t),!i.nextSibling())return s}for(;;){if(n!=null&&i.type.is(n))return s;if(i.type.is(e)&&s.push(i.node),!i.nextSibling())return n==null?s:[]}}function t1(r,e,t=e.length-1){for(let n=r;t>=0;n=n.parent){if(!n)return!1;if(!n.type.isAnonymous){if(e[t]&&e[t]!=n.name)return!1;t--}}return!0}let XY=class{constructor(e,t,n,i){this.parent=e,this.buffer=t,this.index=n,this.start=i}},r1=class Xf extends SE{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(e,t,n){super(),this.context=e,this._parent=t,this.index=n,this.type=e.buffer.set.types[e.buffer.buffer[n]]}child(e,t,n){let{buffer:i}=this.context,s=i.findChild(this.index+4,i.buffer[this.index+3],e,t-this.context.start,n);return s<0?null:new Xf(this.context,this,s)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}enter(e,t,n=0){if(n&ln.ExcludeBuffers)return null;let{buffer:i}=this.context,s=i.findChild(this.index+4,i.buffer[this.index+3],t>0?1:-1,e-this.context.start,t);return s<0?null:new Xf(this.context,this,s)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,t=e.buffer[this.index+3];return t<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new Xf(this.context,this._parent,t):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,t=this._parent?this._parent.index+4:0;return this.index==t?this.externalSibling(-1):new Xf(this.context,this._parent,e.findChild(t,this.index,-1,0,4))}get tree(){return null}toTree(){let e=[],t=[],{buffer:n}=this.context,i=this.index+4,s=n.buffer[this.index+3];if(s>i){let a=n.buffer[this.index+1];e.push(n.slice(i,s,a)),t.push(0)}return new Ji(this.type,e,t,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}};function TE(r){if(!r.length)return null;let e=0,t=r[0];for(let s=1;s<r.length;s++){let a=r[s];(a.from>t.from||a.to<t.to)&&(t=a,e=s)}let n=t instanceof La&&t.index<0?null:t.parent,i=r.slice();return n?i[e]=n:i.splice(e,1),new VY(i,t)}let VY=class{constructor(e,t){this.heads=e,this.node=t}get next(){return TE(this.heads)}};function qY(r,e,t){let n=r.resolveInner(e,t),i=null;for(let s=n instanceof La?n:n.context.parent;s;s=s.parent)if(s.index<0){let a=s.parent;(i||(i=[n])).push(a.resolve(e,t)),s=a}else{let a=Kd.get(s.tree);if(a&&a.overlay&&a.overlay[0].from<=e&&a.overlay[a.overlay.length-1].to>=e){let o=new La(a.tree,a.overlay[0].from+s.from,-1,s);(i||(i=[n])).push(Hc(o,e,t,!1))}}return i?TE(i):n}let n1=class{get name(){return this.type.name}constructor(e,t=0){if(this.mode=t,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,e instanceof La)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let n=e._parent;n;n=n._parent)this.stack.unshift(n.index);this.bufferNode=e,this.yieldBuf(e.index)}}yieldNode(e){return e?(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0):!1}yieldBuf(e,t){this.index=e;let{start:n,buffer:i}=this.buffer;return this.type=t||i.set.types[i.buffer[e]],this.from=n+i.buffer[e+1],this.to=n+i.buffer[e+2],!0}yield(e){return e?e instanceof La?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,t,n){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,t,n,this.mode));let{buffer:i}=this.buffer,s=i.findChild(this.index+4,i.buffer[this.index+3],e,t-this.buffer.start,n);return s<0?!1:(this.stack.push(this.index),this.yieldBuf(s))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,t,n=this.mode){return this.buffer?n&ln.ExcludeBuffers?!1:this.enterChild(1,e,t):this.yield(this._tree.enter(e,t,n))}parent(){if(!this.buffer)return this.yieldNode(this.mode&ln.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&ln.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode)):!1;let{buffer:t}=this.buffer,n=this.stack.length-1;if(e<0){let i=n<0?0:this.stack[n]+4;if(this.index!=i)return this.yieldBuf(t.findChild(i,this.index,-1,0,4))}else{let i=t.buffer[this.index+3];if(i<(n<0?t.buffer.length:t.buffer[this.stack[n]+3]))return this.yieldBuf(i)}return n<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let t,n,{buffer:i}=this;if(i){if(e>0){if(this.index<i.buffer.buffer.length)return!1}else for(let s=0;s<this.index;s++)if(i.buffer.buffer[s+3]<this.index)return!1;({index:t,parent:n}=i)}else({index:t,_parent:n}=this._tree);for(;n;{index:t,_parent:n}=n)if(t>-1)for(let s=t+e,a=e<0?-1:n._tree.children.length;s!=a;s+=e){let o=n._tree.children[s];if(this.mode&ln.IncludeAnonymous||o instanceof Bl||!o.type.isAnonymous||$x(o))return!1}return!0}move(e,t){if(t&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,t=0){for(;(this.from==this.to||(t<1?this.from>=e:this.from>e)||(t>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,t););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,t=null,n=0;if(e&&e.context==this.buffer)e:for(let i=this.index,s=this.stack.length;s>=0;){for(let a=e;a;a=a._parent)if(a.index==i){if(i==this.index)return a;t=a,n=s+1;break e}i=this.stack[--s]}for(let i=n;i<this.stack.length;i++)t=new r1(this.buffer,t,this.stack[i]);return this.bufferNode=new r1(this.buffer,t,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,t){for(let n=0;;){let i=!1;if(this.type.isAnonymous||e(this)!==!1){if(this.firstChild()){n++;continue}this.type.isAnonymous||(i=!0)}for(;;){if(i&&t&&t(this),i=this.type.isAnonymous,!n)return;if(this.nextSibling())break;this.parent(),n--,i=!0}}}matchContext(e){if(!this.buffer)return t1(this.node.parent,e);let{buffer:t}=this.buffer,{types:n}=t.set;for(let i=e.length-1,s=this.stack.length-1;i>=0;s--){if(s<0)return t1(this._tree,e,i);let a=n[t.buffer[this.stack[s]]];if(!a.isAnonymous){if(e[i]&&e[i]!=a.name)return!1;i--}}return!0}};function $x(r){return r.children.some(e=>e instanceof Bl||!e.type.isAnonymous||$x(e))}function jY(r){var e;let{buffer:t,nodeSet:n,maxBufferLength:i=yE,reused:s=[],minRepeatType:a=n.types.length}=r,o=Array.isArray(t)?new UY(t,t.length):t,l=n.types,f=0,c=0;function h(y,b,x,A,k,E){let{id:T,start:_,end:N,size:Z}=o,z=c,ee=f;for(;Z<0;)if(o.next(),Z==-1){let ie=s[T];x.push(ie),A.push(_-y);return}else if(Z==-3){f=T;return}else if(Z==-4){c=T;return}else throw new RangeError(`Unrecognized record size: ${Z}`);let ae=l[T],xe,V,ue=_-y;if(N-_<=i&&(V=g(o.pos-b,k))){let ie=new Uint16Array(V.size-V.skip),P=o.pos-V.size,I=ie.length;for(;o.pos>P;)I=O(V.start,ie,I);xe=new Bl(ie,N-V.start,n),ue=V.start-y}else{let ie=o.pos-Z;o.next();let P=[],I=[],B=T>=a?T:-1,W=0,K=N;for(;o.pos>ie;)B>=0&&o.id==B&&o.size>=0?(o.end<=K-i&&(p(P,I,_,W,o.end,K,B,z,ee),W=P.length,K=o.end),o.next()):E>2500?u(_,ie,P,I):h(_,ie,P,I,B,E+1);if(B>=0&&W>0&&W<P.length&&p(P,I,_,W,_,K,B,z,ee),P.reverse(),I.reverse(),B>-1&&W>0){let re=d(ae,ee);xe=Dx(ae,P,I,0,P.length,0,N-_,re,re)}else xe=m(ae,P,I,N-_,z-N,ee)}x.push(xe),A.push(ue)}function u(y,b,x,A){let k=[],E=0,T=-1;for(;o.pos>b;){let{id:_,start:N,end:Z,size:z}=o;if(z>4)o.next();else{if(T>-1&&N<T)break;T<0&&(T=Z-i),k.push(_,N,Z),E++,o.next()}}if(E){let _=new Uint16Array(E*4),N=k[k.length-2];for(let Z=k.length-3,z=0;Z>=0;Z-=3)_[z++]=k[Z],_[z++]=k[Z+1]-N,_[z++]=k[Z+2]-N,_[z++]=z;x.push(new Bl(_,k[2]-N,n)),A.push(N-y)}}function d(y,b){return(x,A,k)=>{let E=0,T=x.length-1,_,N;if(T>=0&&(_=x[T])instanceof Ji){if(!T&&_.type==y&&_.length==k)return _;(N=_.prop(dr.lookAhead))&&(E=A[T]+_.length+N)}return m(y,x,A,k,E,b)}}function p(y,b,x,A,k,E,T,_,N){let Z=[],z=[];for(;y.length>A;)Z.push(y.pop()),z.push(b.pop()+x-k);y.push(m(n.types[T],Z,z,E-k,_-E,N)),b.push(k-x)}function m(y,b,x,A,k,E,T){if(E){let _=[dr.contextHash,E];T=T?[_].concat(T):[_]}if(k>25){let _=[dr.lookAhead,k];T=T?[_].concat(T):[_]}return new Ji(y,b,x,A,T)}function g(y,b){let x=o.fork(),A=0,k=0,E=0,T=x.end-i,_={size:0,start:0,skip:0};e:for(let N=x.pos-y;x.pos>N;){let Z=x.size;if(x.id==b&&Z>=0){_.size=A,_.start=k,_.skip=E,E+=4,A+=4,x.next();continue}let z=x.pos-Z;if(Z<0||z<N||x.start<T)break;let ee=x.id>=a?4:0,ae=x.start;for(x.next();x.pos>z;){if(x.size<0)if(x.size==-3)ee+=4;else break e;else x.id>=a&&(ee+=4);x.next()}k=ae,A+=Z,E+=ee}return(b<0||A==y)&&(_.size=A,_.start=k,_.skip=E),_.size>4?_:void 0}function O(y,b,x){let{id:A,start:k,end:E,size:T}=o;if(o.next(),T>=0&&A<a){let _=x;if(T>4){let N=o.pos-(T-4);for(;o.pos>N;)x=O(y,b,x)}b[--x]=_,b[--x]=E-y,b[--x]=k-y,b[--x]=A}else T==-3?f=A:T==-4&&(c=A);return x}let w=[],v=[];for(;o.pos>0;)h(r.start||0,r.bufferStart||0,w,v,-1,0);let S=(e=r.length)!==null&&e!==void 0?e:w.length?v[0]+w[0].length:0;return new Ji(l[r.topID],w.reverse(),v.reverse(),S)}const Jb=new WeakMap;function qu(r,e){if(!r.isAnonymous||e instanceof Bl||e.type!=r)return 1;let t=Jb.get(e);if(t==null){t=1;for(let n of e.children){if(n.type!=r||!(n instanceof Ji)){t=1;break}t+=qu(r,n)}Jb.set(e,t)}return t}function Dx(r,e,t,n,i,s,a,o,l){let f=0;for(let p=n;p<i;p++)f+=qu(r,e[p]);let c=Math.ceil(f*1.5/8),h=[],u=[];function d(p,m,g,O,w){for(let v=g;v<O;){let S=v,y=m[v],b=qu(r,p[v]);for(v++;v<O;v++){let x=qu(r,p[v]);if(b+x>=c)break;b+=x}if(v==S+1){if(b>c){let x=p[S];d(x.children,x.positions,0,x.children.length,m[S]+w);continue}h.push(p[S])}else{let x=m[v-1]+p[v-1].length-y;h.push(Dx(r,p,m,S,v,y,x,null,l))}u.push(y+w-s)}}return d(e,t,n,i,0),(o||l)(h,u,a)}let zY=class{startParse(e,t,n){return typeof e=="string"&&(e=new GY(e)),n=n?n.length?n.map(i=>new Wp(i.from,i.to)):[new Wp(0,0)]:[new Wp(0,e.length)],this.createParse(e,t||[],n)}parse(e,t,n){let i=this.startParse(e,t,n);for(;;){let s=i.advance();if(s)return s}}},GY=class{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,t){return this.string.slice(e,t)}};new dr({perNode:!0});var e_={};class Jd{constructor(e,t,n,i,s,a,o,l,f,c=0,h){this.p=e,this.stack=t,this.state=n,this.reducePos=i,this.pos=s,this.score=a,this.buffer=o,this.bufferBase=l,this.curContext=f,this.lookAhead=c,this.parent=h}toString(){return`[${this.stack.filter((e,t)=>t%3==0).concat(this.state)}]@${this.pos}${this.score?"!"+this.score:""}`}static start(e,t,n=0){let i=e.parser.context;return new Jd(e,[],t,n,n,0,[],0,i?new t_(i,i.start):null,0,null)}get context(){return this.curContext?this.curContext.context:null}pushState(e,t){this.stack.push(this.state,t,this.bufferBase+this.buffer.length),this.state=e}reduce(e){var t;let n=e>>19,i=e&65535,{parser:s}=this.p,a=this.reducePos<this.pos-25;a&&this.setLookAhead(this.pos);let o=s.dynamicPrecedence(i);if(o&&(this.score+=o),n==0){this.pushState(s.getGoto(this.state,i,!0),this.reducePos),i<s.minRepeatTerm&&this.storeNode(i,this.reducePos,this.reducePos,a?8:4,!0),this.reduceContext(i,this.reducePos);return}let l=this.stack.length-(n-1)*3-(e&262144?6:0),f=l?this.stack[l-2]:this.p.ranges[0].from,c=this.reducePos-f;c>=2e3&&!(!((t=this.p.parser.nodeSet.types[i])===null||t===void 0)&&t.isAnonymous)&&(f==this.p.lastBigReductionStart?(this.p.bigReductionCount++,this.p.lastBigReductionSize=c):this.p.lastBigReductionSize<c&&(this.p.bigReductionCount=1,this.p.lastBigReductionStart=f,this.p.lastBigReductionSize=c));let h=l?this.stack[l-1]:0,u=this.bufferBase+this.buffer.length-h;if(i<s.minRepeatTerm||e&131072){let d=s.stateFlag(this.state,1)?this.pos:this.reducePos;this.storeNode(i,f,d,u+4,!0)}if(e&262144)this.state=this.stack[l];else{let d=this.stack[l-3];this.state=s.getGoto(d,i,!0)}for(;this.stack.length>l;)this.stack.pop();this.reduceContext(i,f)}storeNode(e,t,n,i=4,s=!1){if(e==0&&(!this.stack.length||this.stack[this.stack.length-1]<this.buffer.length+this.bufferBase)){let a=this,o=this.buffer.length;if(o==0&&a.parent&&(o=a.bufferBase-a.parent.bufferBase,a=a.parent),o>0&&a.buffer[o-4]==0&&a.buffer[o-1]>-1){if(t==n)return;if(a.buffer[o-2]>=t){a.buffer[o-2]=n;return}}}if(!s||this.pos==n)this.buffer.push(e,t,n,i);else{let a=this.buffer.length;if(a>0&&this.buffer[a-4]!=0){let o=!1;for(let l=a;l>0&&this.buffer[l-2]>n;l-=4)if(this.buffer[l-1]>=0){o=!0;break}if(o)for(;a>0&&this.buffer[a-2]>n;)this.buffer[a]=this.buffer[a-4],this.buffer[a+1]=this.buffer[a-3],this.buffer[a+2]=this.buffer[a-2],this.buffer[a+3]=this.buffer[a-1],a-=4,i>4&&(i-=4)}this.buffer[a]=e,this.buffer[a+1]=t,this.buffer[a+2]=n,this.buffer[a+3]=i}}shift(e,t,n,i){if(e&131072)this.pushState(e&65535,this.pos);else if(e&262144)this.pos=i,this.shiftContext(t,n),t<=this.p.parser.maxNode&&this.buffer.push(t,n,i,4);else{let s=e,{parser:a}=this.p;(i>this.pos||t<=a.maxNode)&&(this.pos=i,a.stateFlag(s,1)||(this.reducePos=i)),this.pushState(s,n),this.shiftContext(t,n),t<=a.maxNode&&this.buffer.push(t,n,i,4)}}apply(e,t,n,i){e&65536?this.reduce(e):this.shift(e,t,n,i)}useNode(e,t){let n=this.p.reused.length-1;(n<0||this.p.reused[n]!=e)&&(this.p.reused.push(e),n++);let i=this.pos;this.reducePos=this.pos=i+e.length,this.pushState(t,i),this.buffer.push(n,i,this.reducePos,-1),this.curContext&&this.updateContext(this.curContext.tracker.reuse(this.curContext.context,e,this,this.p.stream.reset(this.pos-e.length)))}split(){let e=this,t=e.buffer.length;for(;t>0&&e.buffer[t-2]>e.reducePos;)t-=4;let n=e.buffer.slice(t),i=e.bufferBase+t;for(;e&&i==e.bufferBase;)e=e.parent;return new Jd(this.p,this.stack.slice(),this.state,this.reducePos,this.pos,this.score,n,i,this.curContext,this.lookAhead,e)}recoverByDelete(e,t){let n=e<=this.p.parser.maxNode;n&&this.storeNode(e,this.pos,t,4),this.storeNode(0,this.pos,t,n?8:4),this.pos=this.reducePos=t,this.score-=190}canShift(e){for(let t=new HY(this);;){let n=this.p.parser.stateSlot(t.state,4)||this.p.parser.hasAction(t.state,e);if(n==0)return!1;if(!(n&65536))return!0;t.reduce(n)}}recoverByInsert(e){if(this.stack.length>=300)return[];let t=this.p.parser.nextStates(this.state);if(t.length>8||this.stack.length>=120){let i=[];for(let s=0,a;s<t.length;s+=2)(a=t[s+1])!=this.state&&this.p.parser.hasAction(a,e)&&i.push(t[s],a);if(this.stack.length<120)for(let s=0;i.length<8&&s<t.length;s+=2){let a=t[s+1];i.some((o,l)=>l&1&&o==a)||i.push(t[s],a)}t=i}let n=[];for(let i=0;i<t.length&&n.length<4;i+=2){let s=t[i+1];if(s==this.state)continue;let a=this.split();a.pushState(s,this.pos),a.storeNode(0,a.pos,a.pos,4,!0),a.shiftContext(t[i],this.pos),a.reducePos=this.pos,a.score-=200,n.push(a)}return n}forceReduce(){let{parser:e}=this.p,t=e.stateSlot(this.state,5);if(!(t&65536))return!1;if(!e.validAction(this.state,t)){let n=t>>19,i=t&65535,s=this.stack.length-n*3;if(s<0||e.getGoto(this.stack[s],i,!1)<0){let a=this.findForcedReduction();if(a==null)return!1;t=a}this.storeNode(0,this.pos,this.pos,4,!0),this.score-=100}return this.reducePos=this.pos,this.reduce(t),!0}findForcedReduction(){let{parser:e}=this.p,t=[],n=(i,s)=>{if(!t.includes(i))return t.push(i),e.allActions(i,a=>{if(!(a&393216))if(a&65536){let o=(a>>19)-s;if(o>1){let l=a&65535,f=this.stack.length-o*3;if(f>=0&&e.getGoto(this.stack[f],l,!1)>=0)return o<<19|65536|l}}else{let o=n(a,s+1);if(o!=null)return o}})};return n(this.state,0)}forceAll(){for(;!this.p.parser.stateFlag(this.state,2);)if(!this.forceReduce()){this.storeNode(0,this.pos,this.pos,4,!0);break}return this}get deadEnd(){if(this.stack.length!=3)return!1;let{parser:e}=this.p;return e.data[e.stateSlot(this.state,1)]==65535&&!e.stateSlot(this.state,4)}restart(){this.storeNode(0,this.pos,this.pos,4,!0),this.state=this.stack[0],this.stack.length=0}sameState(e){if(this.state!=e.state||this.stack.length!=e.stack.length)return!1;for(let t=0;t<this.stack.length;t+=3)if(this.stack[t]!=e.stack[t])return!1;return!0}get parser(){return this.p.parser}dialectEnabled(e){return this.p.parser.dialect.flags[e]}shiftContext(e,t){this.curContext&&this.updateContext(this.curContext.tracker.shift(this.curContext.context,e,this,this.p.stream.reset(t)))}reduceContext(e,t){this.curContext&&this.updateContext(this.curContext.tracker.reduce(this.curContext.context,e,this,this.p.stream.reset(t)))}emitContext(){let e=this.buffer.length-1;(e<0||this.buffer[e]!=-3)&&this.buffer.push(this.curContext.hash,this.pos,this.pos,-3)}emitLookAhead(){let e=this.buffer.length-1;(e<0||this.buffer[e]!=-4)&&this.buffer.push(this.lookAhead,this.pos,this.pos,-4)}updateContext(e){if(e!=this.curContext.context){let t=new t_(this.curContext.tracker,e);t.hash!=this.curContext.hash&&this.emitContext(),this.curContext=t}}setLookAhead(e){e>this.lookAhead&&(this.emitLookAhead(),this.lookAhead=e)}close(){this.curContext&&this.curContext.tracker.strict&&this.emitContext(),this.lookAhead>0&&this.emitLookAhead()}}class t_{constructor(e,t){this.tracker=e,this.context=t,this.hash=e.strict?e.hash(t):0}}class HY{constructor(e){this.start=e,this.state=e.state,this.stack=e.stack,this.base=this.stack.length}reduce(e){let t=e&65535,n=e>>19;n==0?(this.stack==this.start.stack&&(this.stack=this.stack.slice()),this.stack.push(this.state,0,0),this.base+=3):this.base-=(n-1)*3;let i=this.start.p.parser.getGoto(this.stack[this.base-3],t,!0);this.state=i}}class e0{constructor(e,t,n){this.stack=e,this.pos=t,this.index=n,this.buffer=e.buffer,this.index==0&&this.maybeNext()}static create(e,t=e.bufferBase+e.buffer.length){return new e0(e,t,t-e.bufferBase)}maybeNext(){let e=this.stack.parent;e!=null&&(this.index=this.stack.bufferBase-e.bufferBase,this.stack=e,this.buffer=e.buffer)}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}next(){this.index-=4,this.pos-=4,this.index==0&&this.maybeNext()}fork(){return new e0(this.stack,this.pos,this.index)}}function Vf(r,e=Uint16Array){if(typeof r!="string")return r;let t=null;for(let n=0,i=0;n<r.length;){let s=0;for(;;){let a=r.charCodeAt(n++),o=!1;if(a==126){s=65535;break}a>=92&&a--,a>=34&&a--;let l=a-32;if(l>=46&&(l-=46,o=!0),s+=l,o)break;s*=46}t?t[i++]=s:t=new e(s)}return t}class ju{constructor(){this.start=-1,this.value=-1,this.end=-1,this.extended=-1,this.lookAhead=0,this.mask=0,this.context=0}}const r_=new ju;class YY{constructor(e,t){this.input=e,this.ranges=t,this.chunk="",this.chunkOff=0,this.chunk2="",this.chunk2Pos=0,this.next=-1,this.token=r_,this.rangeIndex=0,this.pos=this.chunkPos=t[0].from,this.range=t[0],this.end=t[t.length-1].to,this.readNext()}resolveOffset(e,t){let n=this.range,i=this.rangeIndex,s=this.pos+e;for(;s<n.from;){if(!i)return null;let a=this.ranges[--i];s-=n.from-a.to,n=a}for(;t<0?s>n.to:s>=n.to;){if(i==this.ranges.length-1)return null;let a=this.ranges[++i];s+=a.from-n.to,n=a}return s}clipPos(e){if(e>=this.range.from&&e<this.range.to)return e;for(let t of this.ranges)if(t.to>e)return Math.max(e,t.from);return this.end}peek(e){let t=this.chunkOff+e,n,i;if(t>=0&&t<this.chunk.length)n=this.pos+e,i=this.chunk.charCodeAt(t);else{let s=this.resolveOffset(e,1);if(s==null)return-1;if(n=s,n>=this.chunk2Pos&&n<this.chunk2Pos+this.chunk2.length)i=this.chunk2.charCodeAt(n-this.chunk2Pos);else{let a=this.rangeIndex,o=this.range;for(;o.to<=n;)o=this.ranges[++a];this.chunk2=this.input.chunk(this.chunk2Pos=n),n+this.chunk2.length>o.to&&(this.chunk2=this.chunk2.slice(0,o.to-n)),i=this.chunk2.charCodeAt(0)}}return n>=this.token.lookAhead&&(this.token.lookAhead=n+1),i}acceptToken(e,t=0){let n=t?this.resolveOffset(t,-1):this.pos;if(n==null||n<this.token.start)throw new RangeError("Token end out of bounds");this.token.value=e,this.token.end=n}acceptTokenTo(e,t){this.token.value=e,this.token.end=t}getChunk(){if(this.pos>=this.chunk2Pos&&this.pos<this.chunk2Pos+this.chunk2.length){let{chunk:e,chunkPos:t}=this;this.chunk=this.chunk2,this.chunkPos=this.chunk2Pos,this.chunk2=e,this.chunk2Pos=t,this.chunkOff=this.pos-this.chunkPos}else{this.chunk2=this.chunk,this.chunk2Pos=this.chunkPos;let e=this.input.chunk(this.pos),t=this.pos+e.length;this.chunk=t>this.range.to?e.slice(0,this.range.to-this.pos):e,this.chunkPos=this.pos,this.chunkOff=0}}readNext(){return this.chunkOff>=this.chunk.length&&(this.getChunk(),this.chunkOff==this.chunk.length)?this.next=-1:this.next=this.chunk.charCodeAt(this.chunkOff)}advance(e=1){for(this.chunkOff+=e;this.pos+e>=this.range.to;){if(this.rangeIndex==this.ranges.length-1)return this.setDone();e-=this.range.to-this.pos,this.range=this.ranges[++this.rangeIndex],this.pos=this.range.from}return this.pos+=e,this.pos>=this.token.lookAhead&&(this.token.lookAhead=this.pos+1),this.readNext()}setDone(){return this.pos=this.chunkPos=this.end,this.range=this.ranges[this.rangeIndex=this.ranges.length-1],this.chunk="",this.next=-1}reset(e,t){if(t?(this.token=t,t.start=e,t.lookAhead=e+1,t.value=t.extended=-1):this.token=r_,this.pos!=e){if(this.pos=e,e==this.end)return this.setDone(),this;for(;e<this.range.from;)this.range=this.ranges[--this.rangeIndex];for(;e>=this.range.to;)this.range=this.ranges[++this.rangeIndex];e>=this.chunkPos&&e<this.chunkPos+this.chunk.length?this.chunkOff=e-this.chunkPos:(this.chunk="",this.chunkOff=0),this.readNext()}return this}read(e,t){if(e>=this.chunkPos&&t<=this.chunkPos+this.chunk.length)return this.chunk.slice(e-this.chunkPos,t-this.chunkPos);if(e>=this.chunk2Pos&&t<=this.chunk2Pos+this.chunk2.length)return this.chunk2.slice(e-this.chunk2Pos,t-this.chunk2Pos);if(e>=this.range.from&&t<=this.range.to)return this.input.read(e,t);let n="";for(let i of this.ranges){if(i.from>=t)break;i.to>e&&(n+=this.input.read(Math.max(i.from,e),Math.min(i.to,t)))}return n}}class _l{constructor(e,t){this.data=e,this.id=t}token(e,t){let{parser:n}=t.p;CE(this.data,e,t,this.id,n.data,n.tokenPrecTable)}}_l.prototype.contextual=_l.prototype.fallback=_l.prototype.extend=!1;class i1{constructor(e,t,n){this.precTable=t,this.elseToken=n,this.data=typeof e=="string"?Vf(e):e}token(e,t){let n=e.pos,i=0;for(;;){let s=e.next<0,a=e.resolveOffset(1,1);if(CE(this.data,e,t,0,this.data,this.precTable),e.token.value>-1)break;if(this.elseToken==null)return;if(s||i++,a==null)break;e.reset(a,e.token)}i&&(e.reset(n,e.token),e.acceptToken(this.elseToken,i))}}i1.prototype.contextual=_l.prototype.fallback=_l.prototype.extend=!1;class Ga{constructor(e,t={}){this.token=e,this.contextual=!!t.contextual,this.fallback=!!t.fallback,this.extend=!!t.extend}}function CE(r,e,t,n,i,s){let a=0,o=1<<n,{dialect:l}=t.p.parser;e:for(;o&r[a];){let f=r[a+1];for(let d=a+3;d<f;d+=2)if((r[d+1]&o)>0){let p=r[d];if(l.allows(p)&&(e.token.value==-1||e.token.value==p||KY(p,e.token.value,i,s))){e.acceptToken(p);break}}let c=e.next,h=0,u=r[a+2];if(e.next<0&&u>h&&r[f+u*3-3]==65535){a=r[f+u*3-1];continue e}for(;h<u;){let d=h+u>>1,p=f+d+(d<<1),m=r[p],g=r[p+1]||65536;if(c<m)u=d;else if(c>=g)h=d+1;else{a=r[p+2],e.advance();continue e}}break}}function n_(r,e,t){for(let n=e,i;(i=r[n])!=65535;n++)if(i==t)return n-e;return-1}function KY(r,e,t,n){let i=n_(t,n,e);return i<0||n_(t,n,r)<i}const ii=typeof process<"u"&&e_&&/\bparse\b/.test(e_.LOG);let Up=null;function i_(r,e,t){let n=r.cursor(ln.IncludeAnonymous);for(n.moveTo(e);;)if(!(t<0?n.childBefore(e):n.childAfter(e)))for(;;){if((t<0?n.to<e:n.from>e)&&!n.type.isError)return t<0?Math.max(0,Math.min(n.to-1,e-25)):Math.min(r.length,Math.max(n.from+1,e+25));if(t<0?n.prevSibling():n.nextSibling())break;if(!n.parent())return t<0?0:r.length}}class JY{constructor(e,t){this.fragments=e,this.nodeSet=t,this.i=0,this.fragment=null,this.safeFrom=-1,this.safeTo=-1,this.trees=[],this.start=[],this.index=[],this.nextFragment()}nextFragment(){let e=this.fragment=this.i==this.fragments.length?null:this.fragments[this.i++];if(e){for(this.safeFrom=e.openStart?i_(e.tree,e.from+e.offset,1)-e.offset:e.from,this.safeTo=e.openEnd?i_(e.tree,e.to+e.offset,-1)-e.offset:e.to;this.trees.length;)this.trees.pop(),this.start.pop(),this.index.pop();this.trees.push(e.tree),this.start.push(-e.offset),this.index.push(0),this.nextStart=this.safeFrom}else this.nextStart=1e9}nodeAt(e){if(e<this.nextStart)return null;for(;this.fragment&&this.safeTo<=e;)this.nextFragment();if(!this.fragment)return null;for(;;){let t=this.trees.length-1;if(t<0)return this.nextFragment(),null;let n=this.trees[t],i=this.index[t];if(i==n.children.length){this.trees.pop(),this.start.pop(),this.index.pop();continue}let s=n.children[i],a=this.start[t]+n.positions[i];if(a>e)return this.nextStart=a,null;if(s instanceof Ji){if(a==e){if(a<this.safeFrom)return null;let o=a+s.length;if(o<=this.safeTo){let l=s.prop(dr.lookAhead);if(!l||o+l<this.fragment.to)return s}}this.index[t]++,a+s.length>=Math.max(this.safeFrom,e)&&(this.trees.push(s),this.start.push(a),this.index.push(0))}else this.index[t]++,this.nextStart=a+s.length}}}class eK{constructor(e,t){this.stream=t,this.tokens=[],this.mainToken=null,this.actions=[],this.tokens=e.tokenizers.map(n=>new ju)}getActions(e){let t=0,n=null,{parser:i}=e.p,{tokenizers:s}=i,a=i.stateSlot(e.state,3),o=e.curContext?e.curContext.hash:0,l=0;for(let f=0;f<s.length;f++){if(!(1<<f&a))continue;let c=s[f],h=this.tokens[f];if(!(n&&!c.fallback)&&((c.contextual||h.start!=e.pos||h.mask!=a||h.context!=o)&&(this.updateCachedToken(h,c,e),h.mask=a,h.context=o),h.lookAhead>h.end+25&&(l=Math.max(h.lookAhead,l)),h.value!=0)){let u=t;if(h.extended>-1&&(t=this.addActions(e,h.extended,h.end,t)),t=this.addActions(e,h.value,h.end,t),!c.extend&&(n=h,t>u))break}}for(;this.actions.length>t;)this.actions.pop();return l&&e.setLookAhead(l),!n&&e.pos==this.stream.end&&(n=new ju,n.value=e.p.parser.eofTerm,n.start=n.end=e.pos,t=this.addActions(e,n.value,n.end,t)),this.mainToken=n,this.actions}getMainToken(e){if(this.mainToken)return this.mainToken;let t=new ju,{pos:n,p:i}=e;return t.start=n,t.end=Math.min(n+1,i.stream.end),t.value=n==i.stream.end?i.parser.eofTerm:0,t}updateCachedToken(e,t,n){let i=this.stream.clipPos(n.pos);if(t.token(this.stream.reset(i,e),n),e.value>-1){let{parser:s}=n.p;for(let a=0;a<s.specialized.length;a++)if(s.specialized[a]==e.value){let o=s.specializers[a](this.stream.read(e.start,e.end),n);if(o>=0&&n.p.parser.dialect.allows(o>>1)){o&1?e.extended=o>>1:e.value=o>>1;break}}}else e.value=0,e.end=this.stream.clipPos(i+1)}putAction(e,t,n,i){for(let s=0;s<i;s+=3)if(this.actions[s]==e)return i;return this.actions[i++]=e,this.actions[i++]=t,this.actions[i++]=n,i}addActions(e,t,n,i){let{state:s}=e,{parser:a}=e.p,{data:o}=a;for(let l=0;l<2;l++)for(let f=a.stateSlot(s,l?2:1);;f+=3){if(o[f]==65535)if(o[f+1]==1)f=Us(o,f+2);else{i==0&&o[f+1]==2&&(i=this.putAction(Us(o,f+2),t,n,i));break}o[f]==t&&(i=this.putAction(Us(o,f+1),t,n,i))}return i}}class tK{constructor(e,t,n,i){this.parser=e,this.input=t,this.ranges=i,this.recovering=0,this.nextStackID=9812,this.minStackPos=0,this.reused=[],this.stoppedAt=null,this.lastBigReductionStart=-1,this.lastBigReductionSize=0,this.bigReductionCount=0,this.stream=new YY(t,i),this.tokens=new eK(e,this.stream),this.topTerm=e.top[1];let{from:s}=i[0];this.stacks=[Jd.start(this,e.top[0],s)],this.fragments=n.length&&this.stream.end-s>e.bufferLength*4?new JY(n,e.nodeSet):null}get parsedPos(){return this.minStackPos}advance(){let e=this.stacks,t=this.minStackPos,n=this.stacks=[],i,s;if(this.bigReductionCount>300&&e.length==1){let[a]=e;for(;a.forceReduce()&&a.stack.length&&a.stack[a.stack.length-2]>=this.lastBigReductionStart;);this.bigReductionCount=this.lastBigReductionSize=0}for(let a=0;a<e.length;a++){let o=e[a];for(;;){if(this.tokens.mainToken=null,o.pos>t)n.push(o);else{if(this.advanceStack(o,n,e))continue;{i||(i=[],s=[]),i.push(o);let l=this.tokens.getMainToken(o);s.push(l.value,l.end)}}break}}if(!n.length){let a=i&&nK(i);if(a)return ii&&console.log("Finish with "+this.stackID(a)),this.stackToTree(a);if(this.parser.strict)throw ii&&i&&console.log("Stuck with token "+(this.tokens.mainToken?this.parser.getName(this.tokens.mainToken.value):"none")),new SyntaxError("No parse at "+t);this.recovering||(this.recovering=5)}if(this.recovering&&i){let a=this.stoppedAt!=null&&i[0].pos>this.stoppedAt?i[0]:this.runRecovery(i,s,n);if(a)return ii&&console.log("Force-finish "+this.stackID(a)),this.stackToTree(a.forceAll())}if(this.recovering){let a=this.recovering==1?1:this.recovering*3;if(n.length>a)for(n.sort((o,l)=>l.score-o.score);n.length>a;)n.pop();n.some(o=>o.reducePos>t)&&this.recovering--}else if(n.length>1){e:for(let a=0;a<n.length-1;a++){let o=n[a];for(let l=a+1;l<n.length;l++){let f=n[l];if(o.sameState(f)||o.buffer.length>500&&f.buffer.length>500)if((o.score-f.score||o.buffer.length-f.buffer.length)>0)n.splice(l--,1);else{n.splice(a--,1);continue e}}}n.length>12&&n.splice(12,n.length-12)}this.minStackPos=n[0].pos;for(let a=1;a<n.length;a++)n[a].pos<this.minStackPos&&(this.minStackPos=n[a].pos);return null}stopAt(e){if(this.stoppedAt!=null&&this.stoppedAt<e)throw new RangeError("Can't move stoppedAt forward");this.stoppedAt=e}advanceStack(e,t,n){let i=e.pos,{parser:s}=this,a=ii?this.stackID(e)+" -> ":"";if(this.stoppedAt!=null&&i>this.stoppedAt)return e.forceReduce()?e:null;if(this.fragments){let f=e.curContext&&e.curContext.tracker.strict,c=f?e.curContext.hash:0;for(let h=this.fragments.nodeAt(i);h;){let u=this.parser.nodeSet.types[h.type.id]==h.type?s.getGoto(e.state,h.type.id):-1;if(u>-1&&h.length&&(!f||(h.prop(dr.contextHash)||0)==c))return e.useNode(h,u),ii&&console.log(a+this.stackID(e)+` (via reuse of ${s.getName(h.type.id)})`),!0;if(!(h instanceof Ji)||h.children.length==0||h.positions[0]>0)break;let d=h.children[0];if(d instanceof Ji&&h.positions[0]==0)h=d;else break}}let o=s.stateSlot(e.state,4);if(o>0)return e.reduce(o),ii&&console.log(a+this.stackID(e)+` (via always-reduce ${s.getName(o&65535)})`),!0;if(e.stack.length>=8400)for(;e.stack.length>6e3&&e.forceReduce(););let l=this.tokens.getActions(e);for(let f=0;f<l.length;){let c=l[f++],h=l[f++],u=l[f++],d=f==l.length||!n,p=d?e:e.split(),m=this.tokens.mainToken;if(p.apply(c,h,m?m.start:p.pos,u),ii&&console.log(a+this.stackID(p)+` (via ${c&65536?`reduce of ${s.getName(c&65535)}`:"shift"} for ${s.getName(h)} @ ${i}${p==e?"":", split"})`),d)return!0;p.pos>i?t.push(p):n.push(p)}return!1}advanceFully(e,t){let n=e.pos;for(;;){if(!this.advanceStack(e,null,null))return!1;if(e.pos>n)return s_(e,t),!0}}runRecovery(e,t,n){let i=null,s=!1;for(let a=0;a<e.length;a++){let o=e[a],l=t[a<<1],f=t[(a<<1)+1],c=ii?this.stackID(o)+" -> ":"";if(o.deadEnd&&(s||(s=!0,o.restart(),ii&&console.log(c+this.stackID(o)+" (restarted)"),this.advanceFully(o,n))))continue;let h=o.split(),u=c;for(let d=0;h.forceReduce()&&d<10&&(ii&&console.log(u+this.stackID(h)+" (via force-reduce)"),!this.advanceFully(h,n));d++)ii&&(u=this.stackID(h)+" -> ");for(let d of o.recoverByInsert(l))ii&&console.log(c+this.stackID(d)+" (via recover-insert)"),this.advanceFully(d,n);this.stream.end>o.pos?(f==o.pos&&(f++,l=0),o.recoverByDelete(l,f),ii&&console.log(c+this.stackID(o)+` (via recover-delete ${this.parser.getName(l)})`),s_(o,n)):(!i||i.score<o.score)&&(i=o)}return i}stackToTree(e){return e.close(),Ji.build({buffer:e0.create(e),nodeSet:this.parser.nodeSet,topID:this.topTerm,maxBufferLength:this.parser.bufferLength,reused:this.reused,start:this.ranges[0].from,length:e.pos-this.ranges[0].from,minRepeatType:this.parser.minRepeatTerm})}stackID(e){let t=(Up||(Up=new WeakMap)).get(e);return t||Up.set(e,t=String.fromCodePoint(this.nextStackID++)),t+e}}function s_(r,e){for(let t=0;t<e.length;t++){let n=e[t];if(n.pos==r.pos&&n.sameState(r)){e[t].score<r.score&&(e[t]=r);return}}e.push(r)}class rK{constructor(e,t,n){this.source=e,this.flags=t,this.disabled=n}allows(e){return!this.disabled||this.disabled[e]==0}}const Xp=r=>r;class AE{constructor(e){this.start=e.start,this.shift=e.shift||Xp,this.reduce=e.reduce||Xp,this.reuse=e.reuse||Xp,this.hash=e.hash||(()=>0),this.strict=e.strict!==!1}}class No extends zY{constructor(e){if(super(),this.wrappers=[],e.version!=14)throw new RangeError(`Parser version (${e.version}) doesn't match runtime version (14)`);let t=e.nodeNames.split(" ");this.minRepeatTerm=t.length;for(let o=0;o<e.repeatNodeCount;o++)t.push("");let n=Object.keys(e.topRules).map(o=>e.topRules[o][1]),i=[];for(let o=0;o<t.length;o++)i.push([]);function s(o,l,f){i[o].push([l,l.deserialize(String(f))])}if(e.nodeProps)for(let o of e.nodeProps){let l=o[0];typeof l=="string"&&(l=dr[l]);for(let f=1;f<o.length;){let c=o[f++];if(c>=0)s(c,l,o[f++]);else{let h=o[f+-c];for(let u=-c;u>0;u--)s(o[f++],l,h);f++}}}this.nodeSet=new Fx(t.map((o,l)=>ra.define({name:l>=this.minRepeatTerm?void 0:o,id:l,props:i[l],top:n.indexOf(l)>-1,error:l==0,skipped:e.skippedNodes&&e.skippedNodes.indexOf(l)>-1}))),e.propSources&&(this.nodeSet=this.nodeSet.extend(...e.propSources)),this.strict=!1,this.bufferLength=yE;let a=Vf(e.tokenData);this.context=e.context,this.specializerSpecs=e.specialized||[],this.specialized=new Uint16Array(this.specializerSpecs.length);for(let o=0;o<this.specializerSpecs.length;o++)this.specialized[o]=this.specializerSpecs[o].term;this.specializers=this.specializerSpecs.map(a_),this.states=Vf(e.states,Uint32Array),this.data=Vf(e.stateData),this.goto=Vf(e.goto),this.maxTerm=e.maxTerm,this.tokenizers=e.tokenizers.map(o=>typeof o=="number"?new _l(a,o):o),this.topRules=e.topRules,this.dialects=e.dialects||{},this.dynamicPrecedences=e.dynamicPrecedences||null,this.tokenPrecTable=e.tokenPrec,this.termNames=e.termNames||null,this.maxNode=this.nodeSet.types.length-1,this.dialect=this.parseDialect(),this.top=this.topRules[Object.keys(this.topRules)[0]]}createParse(e,t,n){let i=new tK(this,e,t,n);for(let s of this.wrappers)i=s(i,e,t,n);return i}getGoto(e,t,n=!1){let i=this.goto;if(t>=i[0])return-1;for(let s=i[t+1];;){let a=i[s++],o=a&1,l=i[s++];if(o&&n)return l;for(let f=s+(a>>1);s<f;s++)if(i[s]==e)return l;if(o)return-1}}hasAction(e,t){let n=this.data;for(let i=0;i<2;i++)for(let s=this.stateSlot(e,i?2:1),a;;s+=3){if((a=n[s])==65535)if(n[s+1]==1)a=n[s=Us(n,s+2)];else{if(n[s+1]==2)return Us(n,s+2);break}if(a==t||a==0)return Us(n,s+1)}return 0}stateSlot(e,t){return this.states[e*6+t]}stateFlag(e,t){return(this.stateSlot(e,0)&t)>0}validAction(e,t){return!!this.allActions(e,n=>n==t?!0:null)}allActions(e,t){let n=this.stateSlot(e,4),i=n?t(n):void 0;for(let s=this.stateSlot(e,1);i==null;s+=3){if(this.data[s]==65535)if(this.data[s+1]==1)s=Us(this.data,s+2);else break;i=t(Us(this.data,s+1))}return i}nextStates(e){let t=[];for(let n=this.stateSlot(e,1);;n+=3){if(this.data[n]==65535)if(this.data[n+1]==1)n=Us(this.data,n+2);else break;if(!(this.data[n+2]&1)){let i=this.data[n+1];t.some((s,a)=>a&1&&s==i)||t.push(this.data[n],i)}}return t}configure(e){let t=Object.assign(Object.create(No.prototype),this);if(e.props&&(t.nodeSet=this.nodeSet.extend(...e.props)),e.top){let n=this.topRules[e.top];if(!n)throw new RangeError(`Invalid top rule name ${e.top}`);t.top=n}return e.tokenizers&&(t.tokenizers=this.tokenizers.map(n=>{let i=e.tokenizers.find(s=>s.from==n);return i?i.to:n})),e.specializers&&(t.specializers=this.specializers.slice(),t.specializerSpecs=this.specializerSpecs.map((n,i)=>{let s=e.specializers.find(o=>o.from==n.external);if(!s)return n;let a=Object.assign(Object.assign({},n),{external:s.to});return t.specializers[i]=a_(a),a})),e.contextTracker&&(t.context=e.contextTracker),e.dialect&&(t.dialect=this.parseDialect(e.dialect)),e.strict!=null&&(t.strict=e.strict),e.wrap&&(t.wrappers=t.wrappers.concat(e.wrap)),e.bufferLength!=null&&(t.bufferLength=e.bufferLength),t}hasWrappers(){return this.wrappers.length>0}getName(e){return this.termNames?this.termNames[e]:String(e<=this.maxNode&&this.nodeSet.types[e].name||e)}get eofTerm(){return this.maxNode+1}get topNode(){return this.nodeSet.types[this.top[1]]}dynamicPrecedence(e){let t=this.dynamicPrecedences;return t==null?0:t[e]||0}parseDialect(e){let t=Object.keys(this.dialects),n=t.map(()=>!1);if(e)for(let s of e.split(" ")){let a=t.indexOf(s);a>=0&&(n[a]=!0)}let i=null;for(let s=0;s<t.length;s++)if(!n[s])for(let a=this.dialects[t[s]],o;(o=this.data[a++])!=65535;)(i||(i=new Uint8Array(this.maxTerm+1)))[o]=1;return new rK(e,n,i)}static deserialize(e){return new No(e)}}function Us(r,e){return r[e]|r[e+1]<<16}function nK(r){let e=null;for(let t of r){let n=t.p.stoppedAt;(t.pos==t.p.stream.end||n!=null&&t.pos>n)&&t.p.parser.stateFlag(t.state,2)&&(!e||e.score<t.score)&&(e=t)}return e}function a_(r){if(r.external){let e=r.extend?1:0;return(t,n)=>r.external(t,n)<<1|e}return r.get}const iK=314,sK=315,o_=1,aK=2,oK=3,lK=4,fK=316,cK=318,hK=319,uK=5,dK=6,pK=0,s1=[9,10,11,12,13,32,133,160,5760,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8232,8233,8239,8287,12288],EE=125,mK=59,a1=47,gK=42,OK=43,xK=45,vK=60,yK=44,wK=63,bK=46,_K=91,kK=new AE({start:!1,shift(r,e){return e==uK||e==dK||e==cK?r:e==hK},strict:!1}),SK=new Ga((r,e)=>{let{next:t}=r;(t==EE||t==-1||e.context)&&r.acceptToken(fK)},{contextual:!0,fallback:!0}),TK=new Ga((r,e)=>{let{next:t}=r,n;s1.indexOf(t)>-1||t==a1&&((n=r.peek(1))==a1||n==gK)||t!=EE&&t!=mK&&t!=-1&&!e.context&&r.acceptToken(iK)},{contextual:!0}),CK=new Ga((r,e)=>{r.next==_K&&!e.context&&r.acceptToken(sK)},{contextual:!0}),AK=new Ga((r,e)=>{let{next:t}=r;if(t==OK||t==xK){if(r.advance(),t==r.next){r.advance();let n=!e.context&&e.canShift(o_);r.acceptToken(n?o_:aK)}}else t==wK&&r.peek(1)==bK&&(r.advance(),r.advance(),(r.next<48||r.next>57)&&r.acceptToken(oK))},{contextual:!0});function Vp(r,e){return r>=65&&r<=90||r>=97&&r<=122||r==95||r>=192||!e&&r>=48&&r<=57}const EK=new Ga((r,e)=>{if(r.next!=vK||!e.dialectEnabled(pK)||(r.advance(),r.next==a1))return;let t=0;for(;s1.indexOf(r.next)>-1;)r.advance(),t++;if(Vp(r.next,!0)){for(r.advance(),t++;Vp(r.next,!1);)r.advance(),t++;for(;s1.indexOf(r.next)>-1;)r.advance(),t++;if(r.next==yK)return;for(let n=0;;n++){if(n==7){if(!Vp(r.next,!0))return;break}if(r.next!="extends".charCodeAt(n))break;r.advance(),t++}}r.acceptToken(lK,-t)}),PK=oa({"get set async static":L.modifier,"for while do if else switch try catch finally return throw break continue default case":L.controlKeyword,"in of await yield void typeof delete instanceof":L.operatorKeyword,"let var const using function class extends":L.definitionKeyword,"import export from":L.moduleKeyword,"with debugger as new":L.keyword,TemplateString:L.special(L.string),super:L.atom,BooleanLiteral:L.bool,this:L.self,null:L.null,Star:L.modifier,VariableName:L.variableName,"CallExpression/VariableName TaggedTemplateExpression/VariableName":L.function(L.variableName),VariableDefinition:L.definition(L.variableName),Label:L.labelName,PropertyName:L.propertyName,PrivatePropertyName:L.special(L.propertyName),"CallExpression/MemberExpression/PropertyName":L.function(L.propertyName),"FunctionDeclaration/VariableDefinition":L.function(L.definition(L.variableName)),"ClassDeclaration/VariableDefinition":L.definition(L.className),"NewExpression/VariableName":L.className,PropertyDefinition:L.definition(L.propertyName),PrivatePropertyDefinition:L.definition(L.special(L.propertyName)),UpdateOp:L.updateOperator,"LineComment Hashbang":L.lineComment,BlockComment:L.blockComment,Number:L.number,String:L.string,Escape:L.escape,ArithOp:L.arithmeticOperator,LogicOp:L.logicOperator,BitOp:L.bitwiseOperator,CompareOp:L.compareOperator,RegExp:L.regexp,Equals:L.definitionOperator,Arrow:L.function(L.punctuation),": Spread":L.punctuation,"( )":L.paren,"[ ]":L.squareBracket,"{ }":L.brace,"InterpolationStart InterpolationEnd":L.special(L.brace),".":L.derefOperator,", ;":L.separator,"@":L.meta,TypeName:L.typeName,TypeDefinition:L.definition(L.typeName),"type enum interface implements namespace module declare":L.definitionKeyword,"abstract global Privacy readonly override":L.modifier,"is keyof unique infer asserts":L.operatorKeyword,JSXAttributeValue:L.attributeValue,JSXText:L.content,"JSXStartTag JSXStartCloseTag JSXSelfCloseEndTag JSXEndTag":L.angleBracket,"JSXIdentifier JSXNameSpacedName":L.tagName,"JSXAttribute/JSXIdentifier JSXAttribute/JSXNameSpacedName":L.attributeName,"JSXBuiltin/JSXIdentifier":L.standard(L.tagName)}),RK={__proto__:null,export:20,as:25,from:33,default:36,async:41,function:42,const:52,extends:56,this:60,true:68,false:68,null:80,void:84,typeof:88,super:104,new:138,delete:150,yield:159,await:163,class:168,public:231,private:231,protected:231,readonly:233,instanceof:252,satisfies:255,in:256,import:290,keyof:347,unique:351,infer:357,asserts:393,is:395,abstract:415,implements:417,type:419,let:422,var:424,using:427,interface:433,enum:437,namespace:443,module:445,declare:449,global:453,for:472,of:481,while:484,with:488,do:492,if:496,else:498,switch:502,case:508,try:514,catch:518,finally:522,return:526,throw:530,break:534,continue:538,debugger:542},QK={__proto__:null,async:125,get:127,set:129,declare:191,public:193,private:193,protected:193,static:195,abstract:197,override:199,readonly:205,accessor:207,new:399},FK={__proto__:null,"<":189},$K=No.deserialize({version:14,states:"$EOQ%TQlOOO%[QlOOO'_QpOOP(lO`OOO*zQ!0MxO'#CiO+RO#tO'#CjO+aO&jO'#CjO+oO#@ItO'#D_O.QQlO'#DeO.bQlO'#DpO%[QlO'#DxO0fQlO'#EQOOQ!0Lf'#EY'#EYO1PQ`O'#EVOOQO'#En'#EnOOQO'#Ij'#IjO1XQ`O'#GrO1dQ`O'#EmO1iQ`O'#EmO3hQ!0MxO'#JpO6[Q!0MxO'#JqO6uQ`O'#F[O6zQ,UO'#FsOOQ!0Lf'#Fe'#FeO7VO7dO'#FeO7eQMhO'#F{O9UQ`O'#FzOOQ!0Lf'#Jq'#JqOOQ!0Lb'#Jp'#JpO9ZQ`O'#GvOOQ['#K]'#K]O9fQ`O'#IWO9kQ!0LrO'#IXOOQ['#J^'#J^OOQ['#I]'#I]Q`QlOOQ`QlOOO9sQ!L^O'#DtO9zQlO'#D|O:RQlO'#EOO9aQ`O'#GrO:YQMhO'#CoO:hQ`O'#ElO:sQ`O'#EwO:xQMhO'#FdO;gQ`O'#GrOOQO'#K^'#K^O;lQ`O'#K^O;zQ`O'#GzO;zQ`O'#G{O;zQ`O'#G}O9aQ`O'#HQO<qQ`O'#HTO>YQ`O'#CeO>jQ`O'#HaO>rQ`O'#HgO>rQ`O'#HiO`QlO'#HkO>rQ`O'#HmO>rQ`O'#HpO>wQ`O'#HvO>|Q!0LsO'#H|O%[QlO'#IOO?XQ!0LsO'#IQO?dQ!0LsO'#ISO9kQ!0LrO'#IUO?oQ!0MxO'#CiO@qQpO'#DjQOQ`OOO%[QlO'#EOOAXQ`O'#ERO:YQMhO'#ElOAdQ`O'#ElOAoQ!bO'#FdOOQ['#Cg'#CgOOQ!0Lb'#Do'#DoOOQ!0Lb'#Jt'#JtO%[QlO'#JtOOQO'#Jw'#JwOOQO'#If'#IfOBoQpO'#EeOOQ!0Lb'#Ed'#EdOOQ!0Lb'#J{'#J{OCkQ!0MSO'#EeOCuQpO'#EUOOQO'#Jv'#JvODZQpO'#JwOEhQpO'#EUOCuQpO'#EePEuO&2DjO'#CbPOOO)CD{)CD{OOOO'#I^'#I^OFQO#tO,59UOOQ!0Lh,59U,59UOOOO'#I_'#I_OF`O&jO,59UOFnQ!L^O'#DaOOOO'#Ia'#IaOFuO#@ItO,59yOOQ!0Lf,59y,59yOGTQlO'#IbOGhQ`O'#JrOIgQ!fO'#JrO+}QlO'#JrOInQ`O,5:POJUQ`O'#EnOJcQ`O'#KROJnQ`O'#KQOJnQ`O'#KQOJvQ`O,5;[OJ{Q`O'#KPOOQ!0Ln,5:[,5:[OKSQlO,5:[OMQQ!0MxO,5:dOMqQ`O,5:lON[Q!0LrO'#KOONcQ`O'#J}O9ZQ`O'#J}ONwQ`O'#J}O! PQ`O,5;ZO! UQ`O'#J}O!#ZQ!fO'#JqOOQ!0Lh'#Ci'#CiO%[QlO'#EQO!#yQ!fO,5:qOOQS'#Jx'#JxOOQO-E<h-E<hO9aQ`O,5=^O!$aQ`O,5=^O!$fQlO,5;XO!&iQMhO'#EiO!(SQ`O,5;XO!(XQlO'#DwO!(cQpO,5;bO!(kQpO,5;bO%[QlO,5;bOOQ['#FS'#FSOOQ['#FU'#FUO%[QlO,5;cO%[QlO,5;cO%[QlO,5;cO%[QlO,5;cO%[QlO,5;cO%[QlO,5;cO%[QlO,5;cO%[QlO,5;cO%[QlO,5;cO%[QlO,5;cOOQ['#FY'#FYO!(yQlO,5;sOOQ!0Lf,5;x,5;xOOQ!0Lf,5;y,5;yOOQ!0Lf,5;{,5;{O%[QlO'#InO!*|Q!0LrO,5<hO%[QlO,5;cO!&iQMhO,5;cO!+kQMhO,5;cO!-]QMhO'#E[O%[QlO,5;vOOQ!0Lf,5;z,5;zO!-dQ,UO'#FiO!.aQ,UO'#KVO!-{Q,UO'#KVO!.hQ,UO'#KVOOQO'#KV'#KVO!.|Q,UO,5<ROOOW,5<_,5<_O!/_QlO'#FuOOOW'#Im'#ImO7VO7dO,5<PO!/fQ,UO'#FwOOQ!0Lf,5<P,5<PO!0VQ$IUO'#CwOOQ!0Lh'#C{'#C{O!0jO#@ItO'#DPO!1WQMjO,5<dO!1_Q`O,5<gO!2zQ(CWO'#GWO!3XQ`O'#GXO!3^Q`O'#GXO!4|Q(CWO'#G]O!6RQpO'#GaOOQO'#Gm'#GmO!+rQMhO'#GlOOQO'#Go'#GoO!+rQMhO'#GnO!6tQ$IUO'#JjOOQ!0Lh'#Jj'#JjO!7OQ`O'#JiO!7^Q`O'#JhO!7fQ`O'#CuOOQ!0Lh'#Cy'#CyO!7qQ`O'#C{OOQ!0Lh'#DT'#DTOOQ!0Lh'#DV'#DVO1SQ`O'#DXO!+rQMhO'#GOO!+rQMhO'#GQO!7vQ`O'#GSO!7{Q`O'#GTO!3^Q`O'#GZO!+rQMhO'#G`O;zQ`O'#JiO!8QQ`O'#EoO!8oQ`O,5<fOOQ!0Lb'#Cr'#CrO!8wQ`O'#EpO!9qQpO'#EqOOQ!0Lb'#KP'#KPO!9xQ!0LrO'#K_O9kQ!0LrO,5=bO`QlO,5>rOOQ['#Jf'#JfOOQ[,5>s,5>sOOQ[-E<Z-E<ZO!;wQ!0MxO,5:`O!9lQpO,5:^O!>bQ!0MxO,5:hO%[QlO,5:hO!@xQ!0MxO,5:jOOQO,5@x,5@xO!AiQMhO,5=^O!AwQ!0LrO'#JgO9UQ`O'#JgO!BYQ!0LrO,59ZO!BeQpO,59ZO!BmQMhO,59ZO:YQMhO,59ZO!BxQ`O,5;XO!CQQ`O'#H`O!CfQ`O'#KbO%[QlO,5;|O!9lQpO,5<OO!CnQ`O,5=yO!CsQ`O,5=yO!CxQ`O,5=yO9kQ!0LrO,5=yO;zQ`O,5=iOOQO'#Cw'#CwO!DWQpO,5=fO!D`QMhO,5=gO!DkQ`O,5=iO!DpQ!bO,5=lO!DxQ`O'#K^O>wQ`O'#HVO9aQ`O'#HXO!D}Q`O'#HXO:YQMhO'#HZO!ESQ`O'#HZOOQ[,5=o,5=oO!EXQ`O'#H[O!EjQ`O'#CoO!EoQ`O,59PO!EyQ`O,59PO!HOQlO,59POOQ[,59P,59PO!H`Q!0LrO,59PO%[QlO,59PO!JkQlO'#HcOOQ['#Hd'#HdOOQ['#He'#HeO`QlO,5={O!KRQ`O,5={O`QlO,5>RO`QlO,5>TO!KWQ`O,5>VO`QlO,5>XO!K]Q`O,5>[O!KbQlO,5>bOOQ[,5>h,5>hO%[QlO,5>hO9kQ!0LrO,5>jOOQ[,5>l,5>lO# lQ`O,5>lOOQ[,5>n,5>nO# lQ`O,5>nOOQ[,5>p,5>pO#!YQpO'#D]O%[QlO'#JtO#!{QpO'#JtO##VQpO'#DkO##hQpO'#DkO#%yQlO'#DkO#&QQ`O'#JsO#&YQ`O,5:UO#&_Q`O'#ErO#&mQ`O'#KSO#&uQ`O,5;]O#&zQpO'#DkO#'XQpO'#ETOOQ!0Lf,5:m,5:mO%[QlO,5:mO#'`Q`O,5:mO>wQ`O,5;WO!BeQpO,5;WO!BmQMhO,5;WO:YQMhO,5;WO#'hQ`O,5@`O#'mQ07dO,5:qOOQO-E<d-E<dO#(sQ!0MSO,5;POCuQpO,5:pO#(}QpO,5:pOCuQpO,5;PO!BYQ!0LrO,5:pOOQ!0Lb'#Eh'#EhOOQO,5;P,5;PO%[QlO,5;PO#)[Q!0LrO,5;PO#)gQ!0LrO,5;PO!BeQpO,5:pOOQO,5;V,5;VO#)uQ!0LrO,5;PPOOO'#I['#I[P#*ZO&2DjO,58|POOO,58|,58|OOOO-E<[-E<[OOQ!0Lh1G.p1G.pOOOO-E<]-E<]OOOO,59{,59{O#*fQ!bO,59{OOOO-E<_-E<_OOQ!0Lf1G/e1G/eO#*kQ!fO,5>|O+}QlO,5>|OOQO,5?S,5?SO#*uQlO'#IbOOQO-E<`-E<`O#+SQ`O,5@^O#+[Q!fO,5@^O#+cQ`O,5@lOOQ!0Lf1G/k1G/kO%[QlO,5@mO#+kQ`O'#IhOOQO-E<f-E<fO#+cQ`O,5@lOOQ!0Lb1G0v1G0vOOQ!0Ln1G/v1G/vOOQ!0Ln1G0W1G0WO%[QlO,5@jO#,PQ!0LrO,5@jO#,bQ!0LrO,5@jO#,iQ`O,5@iO9ZQ`O,5@iO#,qQ`O,5@iO#-PQ`O'#IkO#,iQ`O,5@iOOQ!0Lb1G0u1G0uO!(cQpO,5:sO!(nQpO,5:sOOQS,5:u,5:uO#-qQdO,5:uO#-yQMhO1G2xO9aQ`O1G2xOOQ!0Lf1G0s1G0sO#.XQ!0MxO1G0sO#/^Q!0MvO,5;TOOQ!0Lh'#GV'#GVO#/zQ!0MzO'#JjO!$fQlO1G0sO#2VQ!fO'#JuO%[QlO'#JuO#2aQ`O,5:cOOQ!0Lh'#D]'#D]OOQ!0Lf1G0|1G0|O%[QlO1G0|OOQ!0Lf1G1e1G1eO#2fQ`O1G0|O#4zQ!0MxO1G0}O#5RQ!0MxO1G0}O#7iQ!0MxO1G0}O#7pQ!0MxO1G0}O#:WQ!0MxO1G0}O#<nQ!0MxO1G0}O#<uQ!0MxO1G0}O#<|Q!0MxO1G0}O#?dQ!0MxO1G0}O#?kQ!0MxO1G0}O#AxQ?MtO'#CiO#CsQ?MtO1G1_O#CzQ?MtO'#JqO#D_Q!0MxO,5?YOOQ!0Lb-E<l-E<lO#FlQ!0MxO1G0}O#GiQ!0MzO1G0}OOQ!0Lf1G0}1G0}O#HlQMjO'#JzO#HvQ`O,5:vO#H{Q!0MxO1G1bO#IoQ,UO,5<VO#IwQ,UO,5<WO#JPQ,UO'#FnO#JhQ`O'#FmOOQO'#KW'#KWOOQO'#Il'#IlO#JmQ,UO1G1mOOQ!0Lf1G1m1G1mOOOW1G1x1G1xO#KOQ?MtO'#JpO#KYQ`O,5<aO!(yQlO,5<aOOOW-E<k-E<kOOQ!0Lf1G1k1G1kO#K_QpO'#KVOOQ!0Lf,5<c,5<cO#KgQpO,5<cO#KlQMhO'#DROOOO'#I`'#I`O#KsO#@ItO,59kOOQ!0Lh,59k,59kO%[QlO1G2OO!7{Q`O'#IpO#LOQ`O,5<yOOQ!0Lh,5<v,5<vO!+rQMhO'#IsO#LlQMjO,5=WO!+rQMhO'#IuO#M_QMjO,5=YO!&iQMhO,5=[OOQO1G2R1G2RO#MiQ!dO'#CrO#M|Q(CWO'#EpO$ RQpO'#GaO$ iQ!dO,5<rO$ pQ`O'#KYO9ZQ`O'#KYO$!OQ`O,5<tO!+rQMhO,5<sO$!TQ`O'#GYO$!fQ`O,5<sO$!kQ!dO'#GVO$!xQ!dO'#KZO$#SQ`O'#KZO!&iQMhO'#KZO$#XQ`O,5<wO$#^QlO'#JtO$#hQpO'#GbO##hQpO'#GbO$#yQ`O'#GfO!3^Q`O'#GjO$$OQ!0LrO'#IrO$$ZQpO,5<{OOQ!0Lp,5<{,5<{O$$bQpO'#GbO$$oQpO'#GcO$%QQpO'#GcO$%VQMjO,5=WO$%gQMjO,5=YOOQ!0Lh,5=],5=]O!+rQMhO,5@TO!+rQMhO,5@TO$%wQ`O'#IwO$&VQ`O,5@SO$&_Q`O,59aOOQ!0Lh,59g,59gO$'UQ$IYO,59sOOQ!0Lh'#Jn'#JnO$'wQMjO,5<jO$(jQMjO,5<lO@iQ`O,5<nOOQ!0Lh,5<o,5<oO$(tQ`O,5<uO$(yQMjO,5<zO$)ZQ`O,5@TO$)iQ`O'#J}O!$fQlO1G2QO$)nQ`O1G2QO9ZQ`O'#KQO9ZQ`O'#ErO%[QlO'#ErO9ZQ`O'#IyO$)sQ!0LrO,5@yOOQ[1G2|1G2|OOQ[1G4^1G4^OOQ!0Lf1G/z1G/zOOQ!0Lf1G/x1G/xO$+uQ!0MxO1G0SOOQ[1G2x1G2xO!&iQMhO1G2xO%[QlO1G2xO#-|Q`O1G2xO$-yQMhO'#EiOOQ!0Lb,5@R,5@RO$.WQ!0LrO,5@ROOQ[1G.u1G.uO!BYQ!0LrO1G.uO!BeQpO1G.uO!BmQMhO1G.uO$.iQ`O1G0sO$.nQ`O'#CiO$.yQ`O'#KcO$/RQ`O,5=zO$/WQ`O'#KcO$/]Q`O'#KcO$/kQ`O'#JPO$/yQ`O,5@|O$0RQ!fO1G1hOOQ!0Lf1G1j1G1jO9aQ`O1G3eO@iQ`O1G3eO$0YQ`O1G3eO$0_Q`O1G3eOOQ[1G3e1G3eO!DkQ`O1G3TO!&iQMhO1G3QO$0dQ`O1G3QOOQ[1G3R1G3RO!&iQMhO1G3RO$0iQ`O1G3RO$0qQpO'#HPOOQ[1G3T1G3TO!5|QpO'#I{O!DpQ!bO1G3WOOQ[1G3W1G3WOOQ[,5=q,5=qO$0yQMhO,5=sO9aQ`O,5=sO$#yQ`O,5=uO9UQ`O,5=uO!BeQpO,5=uO!BmQMhO,5=uO:YQMhO,5=uO$1XQ`O'#KaO$1dQ`O,5=vOOQ[1G.k1G.kO$1iQ!0LrO1G.kO@iQ`O1G.kO$1tQ`O1G.kO9kQ!0LrO1G.kO$3|Q!fO,5AOO$4ZQ`O,5AOO9ZQ`O,5AOO$4fQlO,5=}O$4mQ`O,5=}OOQ[1G3g1G3gO`QlO1G3gOOQ[1G3m1G3mOOQ[1G3o1G3oO>rQ`O1G3qO$4rQlO1G3sO$8vQlO'#HrOOQ[1G3v1G3vO$9TQ`O'#HxO>wQ`O'#HzOOQ[1G3|1G3|O$9]QlO1G3|O9kQ!0LrO1G4SOOQ[1G4U1G4UOOQ!0Lb'#G^'#G^O9kQ!0LrO1G4WO9kQ!0LrO1G4YO$=dQ`O,5@`O!(yQlO,5;^O9ZQ`O,5;^O>wQ`O,5:VO!(yQlO,5:VO!BeQpO,5:VO$=iQ?MtO,5:VOOQO,5;^,5;^O$=sQpO'#IcO$>ZQ`O,5@_OOQ!0Lf1G/p1G/pO$>cQpO'#IiO$>mQ`O,5@nOOQ!0Lb1G0w1G0wO##hQpO,5:VOOQO'#Ie'#IeO$>uQpO,5:oOOQ!0Ln,5:o,5:oO#'cQ`O1G0XOOQ!0Lf1G0X1G0XO%[QlO1G0XOOQ!0Lf1G0r1G0rO>wQ`O1G0rO!BeQpO1G0rO!BmQMhO1G0rOOQ!0Lb1G5z1G5zO!BYQ!0LrO1G0[OOQO1G0k1G0kO%[QlO1G0kO$>|Q!0LrO1G0kO$?XQ!0LrO1G0kO!BeQpO1G0[OCuQpO1G0[O$?gQ!0LrO1G0kOOQO1G0[1G0[O$?{Q!0MxO1G0kPOOO-E<Y-E<YPOOO1G.h1G.hOOOO1G/g1G/gO$@VQ!bO,5<hO$@_Q!fO1G4hOOQO1G4n1G4nO%[QlO,5>|O$@iQ`O1G5xO$@qQ`O1G6WO$@yQ!fO1G6XO9ZQ`O,5?SO$ATQ!0MxO1G6UO%[QlO1G6UO$AeQ!0LrO1G6UO$AvQ`O1G6TO$AvQ`O1G6TO9ZQ`O1G6TO$BOQ`O,5?VO9ZQ`O,5?VOOQO,5?V,5?VO$BdQ`O,5?VO$)iQ`O,5?VOOQO-E<i-E<iOOQS1G0_1G0_OOQS1G0a1G0aO#-tQ`O1G0aOOQ[7+(d7+(dO!&iQMhO7+(dO%[QlO7+(dO$BrQ`O7+(dO$B}QMhO7+(dO$C]Q!0MzO,5=WO$EhQ!0MzO,5=YO$GsQ!0MzO,5=WO$JUQ!0MzO,5=YO$LgQ!0MzO,59sO$NlQ!0MzO,5<jO%!wQ!0MzO,5<lO%%SQ!0MzO,5<zOOQ!0Lf7+&_7+&_O%'eQ!0MxO7+&_O%(XQlO'#IdO%(fQ`O,5@aO%(nQ!fO,5@aOOQ!0Lf1G/}1G/}O%(xQ`O7+&hOOQ!0Lf7+&h7+&hO%(}Q?MtO,5:dO%[QlO7+&yO%)XQ?MtO,5:`O%)fQ?MtO,5:hO%)pQ?MtO,5:jO%)zQMhO'#IgO%*UQ`O,5@fOOQ!0Lh1G0b1G0bOOQO1G1q1G1qOOQO1G1r1G1rO%*^Q!jO,5<YO!(yQlO,5<XOOQO-E<j-E<jOOQ!0Lf7+'X7+'XOOOW7+'d7+'dOOOW1G1{1G1{O%*iQ`O1G1{OOQ!0Lf1G1}1G1}OOOO,59m,59mO%*nQ!dO,59mOOOO-E<^-E<^OOQ!0Lh1G/V1G/VO%*uQ!0MxO7+'jOOQ!0Lh,5?[,5?[O%+iQMhO1G2eP%+pQ`O'#IpPOQ!0Lh-E<n-E<nO%,^QMjO,5?_OOQ!0Lh-E<q-E<qO%-PQMjO,5?aOOQ!0Lh-E<s-E<sO%-ZQ!dO1G2vO%-bQ!dO'#CrO%-xQMhO'#KQO$#^QlO'#JtOOQ!0Lh1G2^1G2^O%.PQ`O'#IoO%.eQ`O,5@tO%.eQ`O,5@tO%.mQ`O,5@tO%.xQ`O,5@tOOQO1G2`1G2`O%/WQMjO1G2_O!+rQMhO1G2_O%/hQ(CWO'#IqO%/uQ`O,5@uO!&iQMhO,5@uO%/}Q!dO,5@uOOQ!0Lh1G2c1G2cO%2_Q!fO'#CiO%2iQ`O,5=OOOQ!0Lb,5<|,5<|O%2qQpO,5<|OOQ!0Lb,5<},5<}OCfQ`O,5<|O%2|QpO,5<|OOQ!0Lb,5=Q,5=QO$)iQ`O,5=UOOQO,5?^,5?^OOQO-E<p-E<pOOQ!0Lp1G2g1G2gO##hQpO,5<|O$#^QlO,5=OO%3[Q`O,5<}O%3gQpO,5<}O!+rQMhO'#IsO%4aQMjO1G2rO!+rQMhO'#IuO%5SQMjO1G2tO%5^QMjO1G5oO%5hQMjO1G5oOOQO,5?c,5?cOOQO-E<u-E<uOOQO1G.{1G.{O!9lQpO,59uO%[QlO,59uOOQ!0Lh,5<i,5<iO%5uQ`O1G2YO!+rQMhO1G2aO!+rQMhO1G5oO!+rQMhO1G5oO%5zQ!0MxO7+'lOOQ!0Lf7+'l7+'lO!$fQlO7+'lO%6nQ`O,5;^OOQ!0Lb,5?e,5?eOOQ!0Lb-E<w-E<wO%6sQ!dO'#K[O#'cQ`O7+(dO4UQ!fO7+(dO$BuQ`O7+(dO%6}Q!0MvO'#CiO%7nQ!0LrO,5=RO%8PQ!0MvO,5=RO%8dQ`O,5=ROOQ!0Lb1G5m1G5mOOQ[7+$a7+$aO!BYQ!0LrO7+$aO!BeQpO7+$aO!$fQlO7+&_O%8lQ`O'#JOO%9TQ`O,5@}OOQO1G3f1G3fO9aQ`O,5@}O%9TQ`O,5@}O%9]Q`O,5@}OOQO,5?k,5?kOOQO-E<}-E<}OOQ!0Lf7+'S7+'SO%9bQ`O7+)PO9kQ!0LrO7+)PO9aQ`O7+)PO@iQ`O7+)POOQ[7+(o7+(oO%9gQ!0MvO7+(lO!&iQMhO7+(lO!DfQ`O7+(mOOQ[7+(m7+(mO!&iQMhO7+(mO%9qQ`O'#K`O%9|Q`O,5=kOOQO,5?g,5?gOOQO-E<y-E<yOOQ[7+(r7+(rO%;`QpO'#HYOOQ[1G3_1G3_O!&iQMhO1G3_O%[QlO1G3_O%;gQ`O1G3_O%;rQMhO1G3_O9kQ!0LrO1G3aO$#yQ`O1G3aO9UQ`O1G3aO!BeQpO1G3aO!BmQMhO1G3aO%<QQ`O'#I}O%<fQ`O,5@{O%<nQpO,5@{OOQ!0Lb1G3b1G3bOOQ[7+$V7+$VO@iQ`O7+$VO9kQ!0LrO7+$VO%<yQ`O7+$VO%[QlO1G6jO%[QlO1G6kO%=OQ!0LrO1G6jO%=YQlO1G3iO%=aQ`O1G3iO%=fQlO1G3iOOQ[7+)R7+)RO9kQ!0LrO7+)]O`QlO7+)_OOQ['#Kf'#KfOOQ['#JQ'#JQO%=mQlO,5>^OOQ[,5>^,5>^O%[QlO'#HsO%=zQ`O'#HuOOQ[,5>d,5>dO9ZQ`O,5>dOOQ[,5>f,5>fOOQ[7+)h7+)hOOQ[7+)n7+)nOOQ[7+)r7+)rOOQ[7+)t7+)tO%>PQpO1G5zO%>kQ?MtO1G0xO%>uQ`O1G0xOOQO1G/q1G/qO%?QQ?MtO1G/qO>wQ`O1G/qO!(yQlO'#DkOOQO,5>},5>}OOQO-E<a-E<aOOQO,5?T,5?TOOQO-E<g-E<gO!BeQpO1G/qOOQO-E<c-E<cOOQ!0Ln1G0Z1G0ZOOQ!0Lf7+%s7+%sO#'cQ`O7+%sOOQ!0Lf7+&^7+&^O>wQ`O7+&^O!BeQpO7+&^OOQO7+%v7+%vO$?{Q!0MxO7+&VOOQO7+&V7+&VO%[QlO7+&VO%?[Q!0LrO7+&VO!BYQ!0LrO7+%vO!BeQpO7+%vO%?gQ!0LrO7+&VO%?uQ!0MxO7++pO%[QlO7++pO%@VQ`O7++oO%@VQ`O7++oOOQO1G4q1G4qO9ZQ`O1G4qO%@_Q`O1G4qOOQS7+%{7+%{O#'cQ`O<<LOO4UQ!fO<<LOO%@mQ`O<<LOOOQ[<<LO<<LOO!&iQMhO<<LOO%[QlO<<LOO%@uQ`O<<LOO%AQQ!0MzO,5?_O%C]Q!0MzO,5?aO%EhQ!0MzO1G2_O%GyQ!0MzO1G2rO%JUQ!0MzO1G2tO%LaQ!fO,5?OO%[QlO,5?OOOQO-E<b-E<bO%LkQ`O1G5{OOQ!0Lf<<JS<<JSO%LsQ?MtO1G0sO%NzQ?MtO1G0}O& RQ?MtO1G0}O&#SQ?MtO1G0}O&#ZQ?MtO1G0}O&%[Q?MtO1G0}O&']Q?MtO1G0}O&'dQ?MtO1G0}O&'kQ?MtO1G0}O&)lQ?MtO1G0}O&)sQ?MtO1G0}O&)zQ!0MxO<<JeO&+rQ?MtO1G0}O&,oQ?MvO1G0}O&-rQ?MvO'#JjO&/xQ?MtO1G1bO&0VQ?MtO1G0SO&0aQMjO,5?ROOQO-E<e-E<eO!(yQlO'#FpOOQO'#KX'#KXOOQO1G1t1G1tO&0kQ`O1G1sO&0pQ?MtO,5?YOOOW7+'g7+'gOOOO1G/X1G/XO&0zQ!dO1G4vOOQ!0Lh7+(P7+(PP!&iQMhO,5?[O!+rQMhO7+(bO&1RQ`O,5?ZO9ZQ`O,5?ZOOQO-E<m-E<mO&1aQ`O1G6`O&1aQ`O1G6`O&1iQ`O1G6`O&1tQMjO7+'yO&2UQ!dO,5?]O&2`Q`O,5?]O!&iQMhO,5?]OOQO-E<o-E<oO&2eQ!dO1G6aO&2oQ`O1G6aO&2wQ`O1G2jO!&iQMhO1G2jOOQ!0Lb1G2h1G2hOOQ!0Lb1G2i1G2iO%2qQpO1G2hO!BeQpO1G2hOCfQ`O1G2hOOQ!0Lb1G2p1G2pO&2|QpO1G2hO&3[Q`O1G2jO$)iQ`O1G2iOCfQ`O1G2iO$#^QlO1G2jO&3dQ`O1G2iO&4WQMjO,5?_OOQ!0Lh-E<r-E<rO&4yQMjO,5?aOOQ!0Lh-E<t-E<tO!+rQMhO7++ZOOQ!0Lh1G/a1G/aO&5TQ`O1G/aOOQ!0Lh7+'t7+'tO&5YQMjO7+'{O&5jQMjO7++ZO&5tQMjO7++ZO&6RQ!0MxO<<KWOOQ!0Lf<<KW<<KWO&6uQ`O1G0xO!&iQMhO'#IxO&6zQ`O,5@vO&8|Q!fO<<LOO!&iQMhO1G2mO&9TQ!0LrO1G2mOOQ[<<G{<<G{O!BYQ!0LrO<<G{O&9fQ!0MxO<<IyOOQ!0Lf<<Iy<<IyOOQO,5?j,5?jO&:YQ`O,5?jO&:_Q`O,5?jOOQO-E<|-E<|O&:mQ`O1G6iO&:mQ`O1G6iO9aQ`O1G6iO@iQ`O<<LkOOQ[<<Lk<<LkO&:uQ`O<<LkO9kQ!0LrO<<LkOOQ[<<LW<<LWO%9gQ!0MvO<<LWOOQ[<<LX<<LXO!DfQ`O<<LXO&:zQpO'#IzO&;VQ`O,5@zO!(yQlO,5@zOOQ[1G3V1G3VOOQO'#I|'#I|O9kQ!0LrO'#I|O&;_QpO,5=tOOQ[,5=t,5=tO&;fQpO'#EeO&;mQpO'#GdO&;rQ`O7+(yO&;wQ`O7+(yOOQ[7+(y7+(yO!&iQMhO7+(yO%[QlO7+(yO&<PQ`O7+(yOOQ[7+({7+({O9kQ!0LrO7+({O$#yQ`O7+({O9UQ`O7+({O!BeQpO7+({O&<[Q`O,5?iOOQO-E<{-E<{OOQO'#H]'#H]O&<gQ`O1G6gO9kQ!0LrO<<GqOOQ[<<Gq<<GqO@iQ`O<<GqO&<oQ`O7+,UO&<tQ`O7+,VO%[QlO7+,UO%[QlO7+,VOOQ[7+)T7+)TO&<yQ`O7+)TO&=OQlO7+)TO&=VQ`O7+)TOOQ[<<Lw<<LwOOQ[<<Ly<<LyOOQ[-E=O-E=OOOQ[1G3x1G3xO&=[Q`O,5>_OOQ[,5>a,5>aO&=aQ`O1G4OO9ZQ`O7+&dO!(yQlO7+&dOOQO7+%]7+%]O&=fQ?MtO1G6XO>wQ`O7+%]OOQ!0Lf<<I_<<I_OOQ!0Lf<<Ix<<IxO>wQ`O<<IxOOQO<<Iq<<IqO$?{Q!0MxO<<IqO%[QlO<<IqOOQO<<Ib<<IbO!BYQ!0LrO<<IbO&=pQ!0LrO<<IqO&={Q!0MxO<= [O&>]Q`O<= ZOOQO7+*]7+*]O9ZQ`O7+*]OOQ[ANAjANAjO&>eQ!fOANAjO!&iQMhOANAjO#'cQ`OANAjO4UQ!fOANAjO&>lQ`OANAjO%[QlOANAjO&>tQ!0MzO7+'yO&AVQ!0MzO,5?_O&CbQ!0MzO,5?aO&EmQ!0MzO7+'{O&HOQ!fO1G4jO&HYQ?MtO7+&_O&J^Q?MvO,5=WO&LeQ?MvO,5=YO&LuQ?MvO,5=WO&MVQ?MvO,5=YO&MgQ?MvO,59sO' mQ?MvO,5<jO'#pQ?MvO,5<lO'&UQ?MvO,5<zO''zQ?MtO7+'jO'(XQ?MtO7+'lO'(fQ`O,5<[OOQO7+'_7+'_OOQ!0Lh7+*b7+*bO'(kQMjO<<K|OOQO1G4u1G4uO'(rQ`O1G4uO'(}Q`O1G4uO')]Q`O7++zO')]Q`O7++zO!&iQMhO1G4wO')eQ!dO1G4wO')oQ`O7++{O')wQ`O7+(UO'*SQ!dO7+(UOOQ!0Lb7+(S7+(SOOQ!0Lb7+(T7+(TO!BeQpO7+(SOCfQ`O7+(SO'*^Q`O7+(UO!&iQMhO7+(UO$)iQ`O7+(TO'*cQ`O7+(UOCfQ`O7+(TO'*kQMjO<<NuOOQ!0Lh7+${7+${O!+rQMhO<<NuO'*uQ!dO,5?dOOQO-E<v-E<vO'+PQ!0MvO7+(XO!&iQMhO7+(XOOQ[AN=gAN=gO9aQ`O1G5UOOQO1G5U1G5UO'+aQ`O1G5UO'+fQ`O7+,TO'+fQ`O7+,TO9kQ!0LrOANBVO@iQ`OANBVOOQ[ANBVANBVOOQ[ANArANArOOQ[ANAsANAsO'+nQ`O,5?fOOQO-E<x-E<xO'+yQ?MtO1G6fOOQO,5?h,5?hOOQO-E<z-E<zOOQ[1G3`1G3`O',TQ`O,5=OOOQ[<<Le<<LeO!&iQMhO<<LeO&;rQ`O<<LeO',YQ`O<<LeO%[QlO<<LeOOQ[<<Lg<<LgO9kQ!0LrO<<LgO$#yQ`O<<LgO9UQ`O<<LgO',bQpO1G5TO',mQ`O7+,ROOQ[AN=]AN=]O9kQ!0LrOAN=]OOQ[<= p<= pOOQ[<= q<= qO',uQ`O<= pO',zQ`O<= qOOQ[<<Lo<<LoO'-PQ`O<<LoO'-UQlO<<LoOOQ[1G3y1G3yO>wQ`O7+)jO'-]Q`O<<JOO'-hQ?MtO<<JOOOQO<<Hw<<HwOOQ!0LfAN?dAN?dOOQOAN?]AN?]O$?{Q!0MxOAN?]OOQOAN>|AN>|O%[QlOAN?]OOQO<<Mw<<MwOOQ[G27UG27UO!&iQMhOG27UO#'cQ`OG27UO'-rQ!fOG27UO4UQ!fOG27UO'-yQ`OG27UO'.RQ?MtO<<JeO'.`Q?MvO1G2_O'0UQ?MvO,5?_O'2XQ?MvO,5?aO'4[Q?MvO1G2rO'6_Q?MvO1G2tO'8bQ?MtO<<KWO'8oQ?MtO<<IyOOQO1G1v1G1vO!+rQMhOANAhOOQO7+*a7+*aO'8|Q`O7+*aO'9XQ`O<= fO'9aQ!dO7+*cOOQ!0Lb<<Kp<<KpO$)iQ`O<<KpOCfQ`O<<KpO'9kQ`O<<KpO!&iQMhO<<KpOOQ!0Lb<<Kn<<KnO!BeQpO<<KnO'9vQ!dO<<KpOOQ!0Lb<<Ko<<KoO':QQ`O<<KpO!&iQMhO<<KpO$)iQ`O<<KoO':VQMjOANDaO':aQ!0MvO<<KsOOQO7+*p7+*pO9aQ`O7+*pO':qQ`O<= oOOQ[G27qG27qO9kQ!0LrOG27qO!(yQlO1G5QO':yQ`O7+,QO';RQ`O1G2jO&;rQ`OANBPOOQ[ANBPANBPO!&iQMhOANBPO';WQ`OANBPOOQ[ANBRANBRO9kQ!0LrOANBRO$#yQ`OANBROOQO'#H^'#H^OOQO7+*o7+*oOOQ[G22wG22wOOQ[ANE[ANE[OOQ[ANE]ANE]OOQ[ANBZANBZO';`Q`OANBZOOQ[<<MU<<MUO!(yQlOAN?jOOQOG24wG24wO$?{Q!0MxOG24wO#'cQ`OLD,pOOQ[LD,pLD,pO!&iQMhOLD,pO';eQ!fOLD,pO';lQ?MvO7+'yO'=bQ?MvO,5?_O'?eQ?MvO,5?aO'AhQ?MvO7+'{O'C^QMjOG27SOOQO<<M{<<M{OOQ!0LbANA[ANA[O$)iQ`OANA[OCfQ`OANA[O'CnQ!dOANA[OOQ!0LbANAYANAYO'CuQ`OANA[O!&iQMhOANA[O'DQQ!dOANA[OOQ!0LbANAZANAZOOQO<<N[<<N[OOQ[LD-]LD-]O'D[Q?MtO7+*lOOQO'#Ge'#GeOOQ[G27kG27kO&;rQ`OG27kO!&iQMhOG27kOOQ[G27mG27mO9kQ!0LrOG27mOOQ[G27uG27uO'DfQ?MtOG25UOOQOLD*cLD*cOOQ[!$(![!$(![O#'cQ`O!$(![O!&iQMhO!$(![O'DpQ!0MzOG27SOOQ!0LbG26vG26vO$)iQ`OG26vO'GRQ`OG26vOCfQ`OG26vO'G^Q!dOG26vO!&iQMhOG26vOOQ[LD-VLD-VO&;rQ`OLD-VOOQ[LD-XLD-XOOQ[!)9Ev!)9EvO#'cQ`O!)9EvOOQ!0LbLD,bLD,bO$)iQ`OLD,bOCfQ`OLD,bO'GeQ`OLD,bO'GpQ!dOLD,bOOQ[!$(!q!$(!qOOQ[!.K;b!.K;bO'GwQ?MvOG27SOOQ!0Lb!$( |!$( |O$)iQ`O!$( |OCfQ`O!$( |O'ImQ`O!$( |OOQ!0Lb!)9Eh!)9EhO$)iQ`O!)9EhOCfQ`O!)9EhOOQ!0Lb!.K;S!.K;SO$)iQ`O!.K;SOOQ!0Lb!4/0n!4/0nO!(yQlO'#DxO1PQ`O'#EVO'IxQ!fO'#JpO'JPQ!L^O'#DtO'JWQlO'#D|O'J_Q!fO'#CiO'LuQ!fO'#CiO!(yQlO'#EOO'MVQlO,5;XO!(yQlO,5;cO!(yQlO,5;cO!(yQlO,5;cO!(yQlO,5;cO!(yQlO,5;cO!(yQlO,5;cO!(yQlO,5;cO!(yQlO,5;cO!(yQlO,5;cO!(yQlO,5;cO!(yQlO'#InO( YQ`O,5<hO!(yQlO,5;cO( bQMhO,5;cO(!{QMhO,5;cO!(yQlO,5;vO!&iQMhO'#GlO( bQMhO'#GlO!&iQMhO'#GnO( bQMhO'#GnO1SQ`O'#DXO1SQ`O'#DXO!&iQMhO'#GOO( bQMhO'#GOO!&iQMhO'#GQO( bQMhO'#GQO!&iQMhO'#G`O( bQMhO'#G`O!(yQlO,5:hO(#SQpO'#D]O(#^QpO'#JtO!(yQlO,5@mO'MVQlO1G0sO(#hQ?MtO'#CiO!(yQlO1G2OO!&iQMhO'#IsO( bQMhO'#IsO!&iQMhO'#IuO( bQMhO'#IuO(#rQ!dO'#CrO!&iQMhO,5<sO( bQMhO,5<sO'MVQlO1G2QO!(yQlO7+&yO!&iQMhO1G2_O( bQMhO1G2_O!&iQMhO'#IsO( bQMhO'#IsO!&iQMhO'#IuO( bQMhO'#IuO!&iQMhO1G2aO( bQMhO1G2aO'MVQlO7+'lO'MVQlO7+&_O!&iQMhOANAhO( bQMhOANAhO($VQ`O'#EmO($[Q`O'#EmO($dQ`O'#F[O($iQ`O'#EwO($nQ`O'#KRO($yQ`O'#KPO(%UQ`O,5;XO(%ZQMjO,5<dO(%bQ`O'#GXO(%gQ`O'#GXO(%lQ`O,5<fO(%tQ`O,5;XO(%|Q?MtO1G1_O(&TQ`O,5<sO(&YQ`O,5<sO(&_Q`O,5<uO(&dQ`O,5<uO(&iQ`O1G2QO(&nQ`O1G0sO(&sQMjO<<K|O(&zQMjO<<K|O7eQMhO'#F{O9UQ`O'#FzOAdQ`O'#ElO!(yQlO,5;sO!3^Q`O'#GXO!3^Q`O'#GXO!3^Q`O'#GZO!3^Q`O'#GZO!+rQMhO7+(bO!+rQMhO7+(bO%-ZQ!dO1G2vO%-ZQ!dO1G2vO!&iQMhO,5=[O!&iQMhO,5=[",stateData:"((P~O'zOS'{OSTOS'|RQ~OPYOQYOSfOY!VOaqOdzOeyOj!POnkOpYOqkOrkOxkOzYO|YO!QWO!UkO!VkO!]XO!guO!jZO!mYO!nYO!oYO!qvO!swO!vxO!z]O$V|O$miO%g}O%i!QO%k!OO%l!OO%m!OO%p!RO%r!SO%u!TO%v!TO%x!UO&U!WO&[!XO&^!YO&`!ZO&b![O&e!]O&k!^O&q!_O&s!`O&u!aO&w!bO&y!cO(RSO(TTO(WUO(_VO(m[O~OWtO~P`OPYOQYOSfOd!jOe!iOnkOpYOqkOrkOxkOzYO|YO!QWO!UkO!VkO!]!eO!guO!jZO!mYO!nYO!oYO!qvO!s!gO!v!hO$V!kO$miO(R!dO(TTO(WUO(_VO(m[O~Oa!wOq!nO!Q!oO!`!yO!a!vO!b!vO!z;wO#R!pO#S!pO#T!xO#U!pO#V!pO#Y!zO#Z!zO(S!lO(TTO(WUO(c!mO(m!sO~O'|!{O~OP]XR]X[]Xa]Xp]X!O]X!Q]X!Z]X!j]X!n]X#P]X#Q]X#^]X#ifX#l]X#m]X#n]X#o]X#p]X#q]X#r]X#s]X#t]X#u]X#w]X#y]X#z]X$P]X'x]X(_]X(p]X(w]X(x]X~O!e%QX~P(qO_!}O(T#PO(U!}O(V#PO~O_#QO(V#PO(W#PO(X#QO~Ov#SO!S#TO(`#TO(a#VO~OPYOQYOSfOd!jOe!iOnkOpYOqkOrkOxkOzYO|YO!QWO!UkO!VkO!]!eO!guO!jZO!mYO!nYO!oYO!qvO!s!gO!v!hO$V!kO$miO(R;{O(TTO(WUO(_VO(m[O~O!Y#ZO!Z#WO!W(fP!W(tP~P+}O![#cO~P`OPYOQYOSfOd!jOe!iOpYOqkOrkOxkOzYO|YO!QWO!UkO!VkO!]!eO!guO!jZO!mYO!nYO!oYO!qvO!s!gO!v!hO$V!kO$miO(TTO(WUO(_VO(m[O~On#mO!Y#iO!z]O#g#lO#h#iO(R;|O!i(qP~P.iO!j#oO(R#nO~O!v#sO!z]O%g#tO~O#i#uO~O!e#vO#i#uO~OP$[OR#zO[$cOp$aO!O#yO!Q#{O!Z$_O!j#xO!n$[O#P$RO#l$OO#m$PO#n$PO#o$PO#p$QO#q$RO#r$RO#s$bO#t$RO#u$SO#w$UO#y$WO#z$XO(_VO(p$YO(w#|O(x#}O~Oa(dX'x(dX'u(dX!i(dX!W(dX!](dX%h(dX!e(dX~P1qO#Q$dO#^$eO$P$eOP(eXR(eX[(eXp(eX!O(eX!Q(eX!Z(eX!j(eX!n(eX#P(eX#l(eX#m(eX#n(eX#o(eX#p(eX#q(eX#r(eX#s(eX#t(eX#u(eX#w(eX#y(eX#z(eX(_(eX(p(eX(w(eX(x(eX!](eX%h(eX~Oa(eX'x(eX'u(eX!W(eX!i(eXt(eX!e(eX~P4UO#^$eO~O$[$hO$^$gO$e$mO~OSfO!]$nO$h$oO$j$qO~Oh%VOj%cOn%WOp%XOq$tOr$tOx%YOz%ZO|%[O!Q${O!]$|O!g%aO!j$xO#h%bO$V%_O$s%]O$u%^O$x%`O(R$sO(TTO(WUO(_$uO(w$}O(x%POg([P~O!j%dO~O!Q%gO!]%hO(R%fO~O!e%lO~Oa%mO'x%mO~O!O%qO~P%[O(S!lO~P%[O%m%uO~P%[Oh%VO!j%dO(R%fO(S!lO~Oe%|O!j%dO(R%fO~O#t$RO~O!O&RO!]&OO!j&QO%i&UO(R%fO(S!lO(TTO(WUO`)UP~O!v#sO~O%r&WO!Q)QX!])QX(R)QX~O(R&XO~Oj!PO!s&^O%i!QO%k!OO%l!OO%m!OO%p!RO%r!SO%u!TO%v!TO~Od&cOe&bO!v&`O%g&aO%z&_O~P<POd&fOeyOj!PO!]&eO!s&^O!vxO!z]O%g}O%k!OO%l!OO%m!OO%p!RO%r!SO%u!TO%v!TO%x!UO~Ob&iO#^&lO%i&gO(S!lO~P=UO!j&mO!s&qO~O!j#oO~O!]XO~Oa%mO'v&yO'x%mO~Oa%mO'v&|O'x%mO~Oa%mO'v'OO'x%mO~O'u]X!W]Xt]X!i]X&Y]X!]]X%h]X!e]X~P(qO!`']O!a'UO!b'UO(S!lO(TTO(WUO~Oq'SO!Q'RO!Y'VO(c'QO![(gP![(vP~P@]Ol'`O!]'^O(R%fO~Oe'eO!j%dO(R%fO~O!O&RO!j&QO~Oq!nO!Q!oO!z;wO#R!pO#S!pO#U!pO#V!pO(S!lO(TTO(WUO(c!mO(m!sO~O!`'kO!a'jO!b'jO#T!pO#Y'lO#Z'lO~PAwOa%mOh%VO!e#vO!j%dO'x%mO(p'nO~O!n'rO#^'pO~PCVOq!nO!Q!oO(TTO(WUO(c!mO(m!sO~O!]XOq(kX!Q(kX!`(kX!a(kX!b(kX!z(kX#R(kX#S(kX#T(kX#U(kX#V(kX#Y(kX#Z(kX(S(kX(T(kX(W(kX(c(kX(m(kX~O!a'jO!b'jO(S!lO~PCuO'}'vO(O'vO(P'xO~O_!}O(T'zO(U!}O(V'zO~O_#QO(V'zO(W'zO(X#QO~Ot'|O~P%[Ov#SO!S#TO(`#TO(a(PO~O!Y(RO!W'UX!W'[X!Z'UX!Z'[X~P+}O!Z(TO!W(fX~OP$[OR#zO[$cOp$aO!O#yO!Q#{O!Z(TO!j#xO!n$[O#P$RO#l$OO#m$PO#n$PO#o$PO#p$QO#q$RO#r$RO#s$bO#t$RO#u$SO#w$UO#y$WO#z$XO(_VO(p$YO(w#|O(x#}O~O!W(fX~PGpO!W(YO~O!W(sX!Z(sX!e(sX!i(sX(p(sX~O#^(sX#i#bX![(sX~PIsO#^(ZO!W(uX!Z(uX~O!Z([O!W(tX~O!W(_O~O#^$eO~PIsO![(`O~P`OR#zO!O#yO!Q#{O!j#xO(_VOP!la[!lap!la!Z!la!n!la#P!la#l!la#m!la#n!la#o!la#p!la#q!la#r!la#s!la#t!la#u!la#w!la#y!la#z!la(p!la(w!la(x!la~Oa!la'x!la'u!la!W!la!i!lat!la!]!la%h!la!e!la~PKZO!i(aO~O!e#vO#^(bO(p'nO!Z(rXa(rX'x(rX~O!i(rX~PMvO!Q%gO!]%hO!z]O#g(gO#h(fO(R%fO~O!Z(hO!i(qX~O!i(jO~O!Q%gO!]%hO#h(fO(R%fO~OP(eXR(eX[(eXp(eX!O(eX!Q(eX!Z(eX!j(eX!n(eX#P(eX#l(eX#m(eX#n(eX#o(eX#p(eX#q(eX#r(eX#s(eX#t(eX#u(eX#w(eX#y(eX#z(eX(_(eX(p(eX(w(eX(x(eX~O!e#vO!i(eX~P! dOR(lO!O(kO!j#xO#Q$dO!z!ya!Q!ya~O!v!ya%g!ya!]!ya#g!ya#h!ya(R!ya~P!#eO!v(pO~OPYOQYOSfOd!jOe!iOnkOpYOqkOrkOxkOzYO|YO!QWO!UkO!VkO!]XO!guO!jZO!mYO!nYO!oYO!qvO!s!gO!v!hO$V!kO$miO(R!dO(TTO(WUO(_VO(m[O~Oh%VOn%WOp%XOq$tOr$tOx%YOz%ZO|<eO!Q${O!]$|O!g=vO!j$xO#h<kO$V%_O$s<gO$u<iO$x%`O(R(tO(TTO(WUO(_$uO(w$}O(x%PO~O#i(vO~O!Y(xO!i(iP~P%[O(c(zO(m[O~O!Q(|O!j#xO(c(zO(m[O~OP;vOQ;vOSfOd=rOe!iOnkOp;vOqkOrkOxkOz;vO|;vO!QWO!UkO!VkO!]!eO!g;yO!jZO!m;vO!n;vO!o;vO!q;zO!s;}O!v!hO$V!kO$m=pO(R)ZO(TTO(WUO(_VO(m[O~O!Z$_Oa$pa'x$pa'u$pa!i$pa!W$pa!]$pa%h$pa!e$pa~Oj)bO~P!&iOh%VOn%WOp%XOq$tOr$tOx%YOz%ZO|%[O!Q${O!]$|O!g%aO!j$xO#h%bO$V%_O$s%]O$u%^O$x%`O(R(tO(TTO(WUO(_$uO(w$}O(x%PO~Og(nP~P!+rO!O)gO!e)fO!]$]X$Y$]X$[$]X$^$]X$e$]X~O!e)fO!](yX$Y(yX$[(yX$^(yX$e(yX~O!O)gO~P!-{O!O)gO!](yX$Y(yX$[(yX$^(yX$e(yX~O!])iO$Y)mO$[)hO$^)hO$e)nO~O!Y)qO~P!(yO$[$hO$^$gO$e)uO~Ol$yX!O$yX#Q$yX'w$yX(w$yX(x$yX~OgkXg$yXlkX!ZkX#^kX~P!/qOv)wO(`)xO(a)zO~Ol*TO!O)|O'w)}O(w$}O(x%PO~Og){O~P!0uOg*UO~Oh%VOn%WOp%XOq$tOr$tOx%YOz%ZO|<eO!Q*WO!]*XO!g=vO!j$xO#h<kO$V%_O$s<gO$u<iO$x%`O(TTO(WUO(_$uO(w$}O(x%PO~O!Y*[O(R*VO!i(|P~P!1dO#i*^O~O!j*_O~Oh%VOn%WOp%XOq$tOr$tOx%YOz%ZO|<eO!Q${O!]$|O!g=vO!j$xO#h<kO$V%_O$s<gO$u<iO$x%`O(R*aO(TTO(WUO(_$uO(w$}O(x%PO~O!Y*dO!W(}P~P!3cOp*pOq!nO!Q*fO!`*nO!a*hO!b*hO!j*_O#Y*oO%_*jO(S!lO(TTO(WUO(c!mO~O![*mO~P!5WO#Q$dOl(^X!O(^X'w(^X(w(^X(x(^X!Z(^X#^(^X~Og(^X#}(^X~P!6YOl*uO#^*tOg(]X!Z(]X~O!Z*vOg([X~Oj%cO(R&XOg([P~Oq*yO~O!j+OO~O(R(tO~On+TO!Q%gO!Y#iO!]%hO!z]O#g#lO#h#iO(R%fO!i(qP~O!e#vO#i+UO~O!Q%gO!Y+WO!Z([O!]%hO(R%fO!W(tP~Oq'YO!Q+YO!Y+XO(TTO(WUO(c(zO~O![(vP~P!9]O!Z+ZOa)RX'x)RX~OP$[OR#zO[$cOp$aO!O#yO!Q#{O!j#xO!n$[O#P$RO#l$OO#m$PO#n$PO#o$PO#p$QO#q$RO#r$RO#s$bO#t$RO#u$SO#w$UO#y$WO#z$XO(_VO(p$YO(w#|O(x#}O~Oa!ha!Z!ha'x!ha'u!ha!W!ha!i!hat!ha!]!ha%h!ha!e!ha~P!:TOR#zO!O#yO!Q#{O!j#xO(_VOP!pa[!pap!pa!Z!pa!n!pa#P!pa#l!pa#m!pa#n!pa#o!pa#p!pa#q!pa#r!pa#s!pa#t!pa#u!pa#w!pa#y!pa#z!pa(p!pa(w!pa(x!pa~Oa!pa'x!pa'u!pa!W!pa!i!pat!pa!]!pa%h!pa!e!pa~P!<kOR#zO!O#yO!Q#{O!j#xO(_VOP!ra[!rap!ra!Z!ra!n!ra#P!ra#l!ra#m!ra#n!ra#o!ra#p!ra#q!ra#r!ra#s!ra#t!ra#u!ra#w!ra#y!ra#z!ra(p!ra(w!ra(x!ra~Oa!ra'x!ra'u!ra!W!ra!i!rat!ra!]!ra%h!ra!e!ra~P!?ROh%VOl+dO!]'^O%h+cO~O!e+fOa(ZX!](ZX'x(ZX!Z(ZX~Oa%mO!]XO'x%mO~Oh%VO!j%dO~Oh%VO!j%dO(R%fO~O!e#vO#i(vO~Ob+qO%i+rO(R+nO(TTO(WUO![)VP~O!Z+sO`)UX~O[+wO~O`+xO~O!]&OO(R%fO(S!lO`)UP~Oh%VO#^+}O~Oh%VOl,QO!]$|O~O!],SO~O!O,UO!]XO~O%m%uO~O!v,ZO~Oe,`O~Ob,aO(R#nO(TTO(WUO![)TP~Oe%|O~O%i!QO(R&XO~P=UO[,fO`,eO~OPYOQYOSfOdzOeyOnkOpYOqkOrkOxkOzYO|YO!QWO!UkO!VkO!guO!jZO!mYO!nYO!oYO!qvO!vxO!z]O$miO%g}O(TTO(WUO(_VO(m[O~O!]!eO!s!gO$V!kO(R!dO~P!FRO`,eOa%mO'x%mO~OPYOQYOSfOd!jOe!iOnkOpYOqkOrkOxkOzYO|YO!QWO!UkO!VkO!]!eO!guO!jZO!mYO!nYO!oYO!qvO!v!hO$V!kO$miO(R!dO(TTO(WUO(_VO(m[O~Oa,kOj!OO!swO%k!OO%l!OO%m!OO~P!HkO!j&mO~O&[,qO~O!],sO~O&m,uO&o,vOP&jaQ&jaS&jaY&jaa&jad&jae&jaj&jan&jap&jaq&jar&jax&jaz&ja|&ja!Q&ja!U&ja!V&ja!]&ja!g&ja!j&ja!m&ja!n&ja!o&ja!q&ja!s&ja!v&ja!z&ja$V&ja$m&ja%g&ja%i&ja%k&ja%l&ja%m&ja%p&ja%r&ja%u&ja%v&ja%x&ja&U&ja&[&ja&^&ja&`&ja&b&ja&e&ja&k&ja&q&ja&s&ja&u&ja&w&ja&y&ja'u&ja(R&ja(T&ja(W&ja(_&ja(m&ja![&ja&c&jab&ja&h&ja~O(R,{O~Oh!cX!Z!PX![!PX!e!PX!e!cX!j!cX#^!PX~O!Z!cX![!cX~P# qO!e-QO#^-POh(hX!Z#fX![#fX!e(hX!j(hX~O!Z(hX![(hX~P#!dOh%VO!e-SO!j%dO!Z!_X![!_X~Oq!nO!Q!oO(TTO(WUO(c!mO~OP;vOQ;vOSfOd=rOe!iOnkOp;vOqkOrkOxkOz;vO|;vO!QWO!UkO!VkO!]!eO!g;yO!jZO!m;vO!n;vO!o;vO!q;zO!s;}O!v!hO$V!kO$m=pO(TTO(WUO(_VO(m[O~O(R<rO~P##yO!Z-WO![(gX~O![-YO~O!e-QO#^-PO!Z#fX![#fX~O!Z-ZO![(vX~O![-]O~O!a-^O!b-^O(S!lO~P##hO![-aO~P'_Ol-dO!]'^O~O!W-iO~Oq!ya!`!ya!a!ya!b!ya#R!ya#S!ya#T!ya#U!ya#V!ya#Y!ya#Z!ya(S!ya(T!ya(W!ya(c!ya(m!ya~P!#eO!n-nO#^-lO~PCVO!a-pO!b-pO(S!lO~PCuOa%mO#^-lO'x%mO~Oa%mO!e#vO#^-lO'x%mO~Oa%mO!e#vO!n-nO#^-lO'x%mO(p'nO~O'}'vO(O'vO(P-uO~Ot-vO~O!W'Ua!Z'Ua~P!:TO!Y-zO!W'UX!Z'UX~P%[O!Z(TO!W(fa~O!W(fa~PGpO!Z([O!W(ta~O!Q%gO!Y.OO!]%hO(R%fO!W'[X!Z'[X~O#^.QO!Z(ra!i(raa(ra'x(ra~O!e#vO~P#,PO!Z(hO!i(qa~O!Q%gO!]%hO#h.UO(R%fO~On.ZO!Q%gO!Y.WO!]%hO!z]O#g.YO#h.WO(R%fO!Z'_X!i'_X~OR._O!j#xO~Oh%VOl.bO!]'^O%h.aO~Oa#ai!Z#ai'x#ai'u#ai!W#ai!i#ait#ai!]#ai%h#ai!e#ai~P!:TOl=|O!O)|O'w)}O(w$}O(x%PO~O#i#]aa#]a#^#]a'x#]a!Z#]a!i#]a!]#]a!W#]a~P#.{O#i(^XP(^XR(^X[(^Xa(^Xp(^X!Q(^X!j(^X!n(^X#P(^X#l(^X#m(^X#n(^X#o(^X#p(^X#q(^X#r(^X#s(^X#t(^X#u(^X#w(^X#y(^X#z(^X'x(^X(_(^X(p(^X!i(^X!W(^X'u(^Xt(^X!](^X%h(^X!e(^X~P!6YO!Z.oO!i(iX~P!:TO!i.rO~O!W.tO~OP$[OR#zO!O#yO!Q#{O!j#xO!n$[O(_VO[#kia#kip#ki!Z#ki#P#ki#m#ki#n#ki#o#ki#p#ki#q#ki#r#ki#s#ki#t#ki#u#ki#w#ki#y#ki#z#ki'x#ki(p#ki(w#ki(x#ki'u#ki!W#ki!i#kit#ki!]#ki%h#ki!e#ki~O#l#ki~P#2kO#l$OO~P#2kOP$[OR#zOp$aO!O#yO!Q#{O!j#xO!n$[O#l$OO#m$PO#n$PO#o$PO(_VO[#kia#ki!Z#ki#P#ki#q#ki#r#ki#s#ki#t#ki#u#ki#w#ki#y#ki#z#ki'x#ki(p#ki(w#ki(x#ki'u#ki!W#ki!i#kit#ki!]#ki%h#ki!e#ki~O#p#ki~P#5YO#p$QO~P#5YOP$[OR#zO[$cOp$aO!O#yO!Q#{O!j#xO!n$[O#P$RO#l$OO#m$PO#n$PO#o$PO#p$QO#q$RO#r$RO#s$bO#t$RO(_VOa#ki!Z#ki#w#ki#y#ki#z#ki'x#ki(p#ki(w#ki(x#ki'u#ki!W#ki!i#kit#ki!]#ki%h#ki!e#ki~O#u#ki~P#7wOP$[OR#zO[$cOp$aO!O#yO!Q#{O!j#xO!n$[O#P$RO#l$OO#m$PO#n$PO#o$PO#p$QO#q$RO#r$RO#s$bO#t$RO#u$SO(_VO(x#}Oa#ki!Z#ki#y#ki#z#ki'x#ki(p#ki(w#ki'u#ki!W#ki!i#kit#ki!]#ki%h#ki!e#ki~O#w$UO~P#:_O#w#ki~P#:_O#u$SO~P#7wOP$[OR#zO[$cOp$aO!O#yO!Q#{O!j#xO!n$[O#P$RO#l$OO#m$PO#n$PO#o$PO#p$QO#q$RO#r$RO#s$bO#t$RO#u$SO#w$UO(_VO(w#|O(x#}Oa#ki!Z#ki#z#ki'x#ki(p#ki'u#ki!W#ki!i#kit#ki!]#ki%h#ki!e#ki~O#y#ki~P#=TO#y$WO~P#=TOP]XR]X[]Xp]X!O]X!Q]X!j]X!n]X#P]X#Q]X#^]X#ifX#l]X#m]X#n]X#o]X#p]X#q]X#r]X#s]X#t]X#u]X#w]X#y]X#z]X$P]X(_]X(p]X(w]X(x]X!Z]X![]X~O#}]X~P#?rOP$[OR#zO[<_Op<]O!O#yO!Q#{O!j#xO!n$[O#P<SO#l<PO#m<QO#n<QO#o<QO#p<RO#q<SO#r<SO#s<^O#t<SO#u<TO#w<VO#y<XO#z<YO(_VO(p$YO(w#|O(x#}O~O#}.vO~P#BPO#Q$dO#^<`O$P<`O#}(eX![(eX~P! dOa'ba!Z'ba'x'ba'u'ba!i'ba!W'bat'ba!]'ba%h'ba!e'ba~P!:TO[#kia#kip#ki!Z#ki#P#ki#p#ki#q#ki#r#ki#s#ki#t#ki#u#ki#w#ki#y#ki#z#ki'x#ki(p#ki'u#ki!W#ki!i#kit#ki!]#ki%h#ki!e#ki~OP$[OR#zO!O#yO!Q#{O!j#xO!n$[O#l$OO#m$PO#n$PO#o$PO(_VO(w#ki(x#ki~P#EROl=|O!O)|O'w)}O(w$}O(x%POP#kiR#ki!Q#ki!j#ki!n#ki#l#ki#m#ki#n#ki#o#ki(_#ki~P#ERO!Z.zOg(nX~P!0uOg.|O~Oa$Oi!Z$Oi'x$Oi'u$Oi!W$Oi!i$Oit$Oi!]$Oi%h$Oi!e$Oi~P!:TO$[.}O$^.}O~O$[/OO$^/OO~O!e)fO#^/PO!]$bX$Y$bX$[$bX$^$bX$e$bX~O!Y/QO~O!])iO$Y/SO$[)hO$^)hO$e/TO~O!Z<ZO![(dX~P#BPO![/UO~O!e)fO$e(yX~O$e/WO~Ot/XO~P!&iOv)wO(`)xO(a/[O~O!Q/_O~O(w$}Ol%`a!O%`a'w%`a(x%`a!Z%`a#^%`a~Og%`a#}%`a~P#LTO(x%POl%ba!O%ba'w%ba(w%ba!Z%ba#^%ba~Og%ba#}%ba~P#LvO!ZfX!efX!ifX!i$yX(pfX~P!/qO!Y/hO!Z([O(R/gO!W(tP!W(}P~P!1dOp*pO!`*nO!a*hO!b*hO!j*_O#Y*oO%_*jO(S!lO(TTO(WUO~Oq<oO!Q/iO!Y+XO![*mO(c<nO![(vP~P#NaO!i/jO~P#.{O!Z/kO!e#vO(p'nO!i(|X~O!i/pO~O!Q%gO!Y*[O!]%hO(R%fO!i(|P~O#i/rO~O!W$yX!Z$yX!e%QX~P!/qO!Z/sO!W(}X~P#.{O!e/uO~O!W/wO~OnkO(R/xO~P.iOh%VOp/}O!e#vO!j%dO(p'nO~O!e+fO~Oa%mO!Z0RO'x%mO~O![0TO~P!5WO!a0UO!b0UO(S!lO~P##hOq!nO!Q0VO(TTO(WUO(c!mO~O#Y0XO~Og%`a!Z%`a#^%`a#}%`a~P!0uOg%ba!Z%ba#^%ba#}%ba~P!0uOj%cO(R&XOg'kX!Z'kX~O!Z*vOg([a~Og0bO~OR0cO!O0cO!Q0dO#Q$dOl{a'w{a(w{a(x{a!Z{a#^{a~Og{a#}{a~P$&dO!O)|O'w)}Ol$ra(w$ra(x$ra!Z$ra#^$ra~Og$ra#}$ra~P$'`O!O)|O'w)}Ol$ta(w$ta(x$ta!Z$ta#^$ta~Og$ta#}$ta~P$(RO#i0gO~Og%Sa!Z%Sa#^%Sa#}%Sa~P!0uOl0iO#^0hOg(]a!Z(]a~O!e#vO~O#i0lO~O!Z+ZOa)Ra'x)Ra~OR#zO!O#yO!Q#{O!j#xO(_VOP!pi[!pip!pi!Z!pi!n!pi#P!pi#l!pi#m!pi#n!pi#o!pi#p!pi#q!pi#r!pi#s!pi#t!pi#u!pi#w!pi#y!pi#z!pi(p!pi(w!pi(x!pi~Oa!pi'x!pi'u!pi!W!pi!i!pit!pi!]!pi%h!pi!e!pi~P$*OOh%VOp%XOq$tOr$tOx%YOz%ZO|<eO!Q${O!]$|O!g=vO!j$xO#h<kO$V%_O$s<gO$u<iO$x%`O(TTO(WUO(_$uO(w$}O(x%PO~On0vO%[0wO(R0tO~P$,fO!e+fOa(Za!](Za'x(Za!Z(Za~O#i0|O~O[]X!ZfX![fX~O!Z0}O![)VX~O![1PO~O[1QO~Ob1SO(R+nO(TTO(WUO~O!]&OO(R%fO`'sX!Z'sX~O!Z+sO`)Ua~O!i1VO~P!:TO[1YO~O`1ZO~O#^1^O~Ol1aO!]$|O~O(c(zO![)SP~Oh%VOl1jO!]1gO%h1iO~O[1tO!Z1rO![)TX~O![1uO~O`1wOa%mO'x%mO~O(R#nO(TTO(WUO~O#Q$dO#^$eO$P$eOP(eXR(eX[(eXp(eX!O(eX!Q(eX!Z(eX!j(eX!n(eX#P(eX#l(eX#m(eX#n(eX#o(eX#p(eX#q(eX#r(eX#s(eX#u(eX#w(eX#y(eX#z(eX(_(eX(p(eX(w(eX(x(eX~O#t1zO&Y1{Oa(eX~P$2PO#^$eO#t1zO&Y1{O~Oa1}O~P%[Oa2PO~O&c2SOP&aiQ&aiS&aiY&aia&aid&aie&aij&ain&aip&aiq&air&aix&aiz&ai|&ai!Q&ai!U&ai!V&ai!]&ai!g&ai!j&ai!m&ai!n&ai!o&ai!q&ai!s&ai!v&ai!z&ai$V&ai$m&ai%g&ai%i&ai%k&ai%l&ai%m&ai%p&ai%r&ai%u&ai%v&ai%x&ai&U&ai&[&ai&^&ai&`&ai&b&ai&e&ai&k&ai&q&ai&s&ai&u&ai&w&ai&y&ai'u&ai(R&ai(T&ai(W&ai(_&ai(m&ai![&aib&ai&h&ai~Ob2YO![2WO&h2XO~P`O!]XO!j2[O~O&o,vOP&jiQ&jiS&jiY&jia&jid&jie&jij&jin&jip&jiq&jir&jix&jiz&ji|&ji!Q&ji!U&ji!V&ji!]&ji!g&ji!j&ji!m&ji!n&ji!o&ji!q&ji!s&ji!v&ji!z&ji$V&ji$m&ji%g&ji%i&ji%k&ji%l&ji%m&ji%p&ji%r&ji%u&ji%v&ji%x&ji&U&ji&[&ji&^&ji&`&ji&b&ji&e&ji&k&ji&q&ji&s&ji&u&ji&w&ji&y&ji'u&ji(R&ji(T&ji(W&ji(_&ji(m&ji![&ji&c&jib&ji&h&ji~O!W2bO~O!Z!_a![!_a~P#BPOq!nO!Q!oO!Y2hO(c!mO!Z'VX!['VX~P@]O!Z-WO![(ga~O!Z']X![']X~P!9]O!Z-ZO![(va~O![2oO~P'_Oa%mO#^2xO'x%mO~Oa%mO!e#vO#^2xO'x%mO~Oa%mO!e#vO!n2|O#^2xO'x%mO(p'nO~Oa%mO'x%mO~P!:TO!Z$_Ot$pa~O!W'Ui!Z'Ui~P!:TO!Z(TO!W(fi~O!Z([O!W(ti~O!W(ui!Z(ui~P!:TO!Z(ri!i(ria(ri'x(ri~P!:TO#^3OO!Z(ri!i(ria(ri'x(ri~O!Z(hO!i(qi~O!Q%gO!]%hO!z]O#g3TO#h3SO(R%fO~O!Q%gO!]%hO#h3SO(R%fO~Ol3[O!]'^O%h3ZO~Oh%VOl3[O!]'^O%h3ZO~O#i%`aP%`aR%`a[%`aa%`ap%`a!Q%`a!j%`a!n%`a#P%`a#l%`a#m%`a#n%`a#o%`a#p%`a#q%`a#r%`a#s%`a#t%`a#u%`a#w%`a#y%`a#z%`a'x%`a(_%`a(p%`a!i%`a!W%`a'u%`at%`a!]%`a%h%`a!e%`a~P#LTO#i%baP%baR%ba[%baa%bap%ba!Q%ba!j%ba!n%ba#P%ba#l%ba#m%ba#n%ba#o%ba#p%ba#q%ba#r%ba#s%ba#t%ba#u%ba#w%ba#y%ba#z%ba'x%ba(_%ba(p%ba!i%ba!W%ba'u%bat%ba!]%ba%h%ba!e%ba~P#LvO#i%`aP%`aR%`a[%`aa%`ap%`a!Q%`a!Z%`a!j%`a!n%`a#P%`a#l%`a#m%`a#n%`a#o%`a#p%`a#q%`a#r%`a#s%`a#t%`a#u%`a#w%`a#y%`a#z%`a'x%`a(_%`a(p%`a!i%`a!W%`a'u%`a#^%`at%`a!]%`a%h%`a!e%`a~P#.{O#i%baP%baR%ba[%baa%bap%ba!Q%ba!Z%ba!j%ba!n%ba#P%ba#l%ba#m%ba#n%ba#o%ba#p%ba#q%ba#r%ba#s%ba#t%ba#u%ba#w%ba#y%ba#z%ba'x%ba(_%ba(p%ba!i%ba!W%ba'u%ba#^%bat%ba!]%ba%h%ba!e%ba~P#.{O#i{aP{a[{aa{ap{a!j{a!n{a#P{a#l{a#m{a#n{a#o{a#p{a#q{a#r{a#s{a#t{a#u{a#w{a#y{a#z{a'x{a(_{a(p{a!i{a!W{a'u{at{a!]{a%h{a!e{a~P$&dO#i$raP$raR$ra[$raa$rap$ra!Q$ra!j$ra!n$ra#P$ra#l$ra#m$ra#n$ra#o$ra#p$ra#q$ra#r$ra#s$ra#t$ra#u$ra#w$ra#y$ra#z$ra'x$ra(_$ra(p$ra!i$ra!W$ra'u$rat$ra!]$ra%h$ra!e$ra~P$'`O#i$taP$taR$ta[$taa$tap$ta!Q$ta!j$ta!n$ta#P$ta#l$ta#m$ta#n$ta#o$ta#p$ta#q$ta#r$ta#s$ta#t$ta#u$ta#w$ta#y$ta#z$ta'x$ta(_$ta(p$ta!i$ta!W$ta'u$tat$ta!]$ta%h$ta!e$ta~P$(RO#i%SaP%SaR%Sa[%Saa%Sap%Sa!Q%Sa!Z%Sa!j%Sa!n%Sa#P%Sa#l%Sa#m%Sa#n%Sa#o%Sa#p%Sa#q%Sa#r%Sa#s%Sa#t%Sa#u%Sa#w%Sa#y%Sa#z%Sa'x%Sa(_%Sa(p%Sa!i%Sa!W%Sa'u%Sa#^%Sat%Sa!]%Sa%h%Sa!e%Sa~P#.{Oa#aq!Z#aq'x#aq'u#aq!W#aq!i#aqt#aq!]#aq%h#aq!e#aq~P!:TO!Y3dO!Z'WX!i'WX~P%[O!Z.oO!i(ia~O!Z.oO!i(ia~P!:TO!W3gO~O#}!la![!la~PKZO#}!ha!Z!ha![!ha~P#BPO#}!pa![!pa~P!<kO#}!ra![!ra~P!?ROg'ZX!Z'ZX~P!+rO!Z.zOg(na~OSfO!]3{O$c3|O~O![4QO~Ot4RO~P#.{Oa$lq!Z$lq'x$lq'u$lq!W$lq!i$lqt$lq!]$lq%h$lq!e$lq~P!:TO!W4TO~P!&iO!Q4UO~O!O)|O'w)}O(x%POl'ga(w'ga!Z'ga#^'ga~Og'ga#}'ga~P%+uO!O)|O'w)}Ol'ia(w'ia(x'ia!Z'ia#^'ia~Og'ia#}'ia~P%,hO(p$YO~P#.{O!WfX!W$yX!ZfX!Z$yX!e%QX#^fX~P!/qO(R<xO~P!1dO!Q%gO!Y4XO!]%hO(R%fO!Z'cX!i'cX~O!Z/kO!i(|a~O!Z/kO!e#vO!i(|a~O!Z/kO!e#vO(p'nO!i(|a~Og${i!Z${i#^${i#}${i~P!0uO!Y4aO!W'eX!Z'eX~P!3cO!Z/sO!W(}a~O!Z/sO!W(}a~P#.{OP]XR]X[]Xp]X!O]X!Q]X!W]X!Z]X!j]X!n]X#P]X#Q]X#^]X#ifX#l]X#m]X#n]X#o]X#p]X#q]X#r]X#s]X#t]X#u]X#w]X#y]X#z]X$P]X(_]X(p]X(w]X(x]X~O!e%XX#t%XX~P%0XO!e#vO#t4fO~Oh%VO!e#vO!j%dO~Oh%VOp4kO!j%dO(p'nO~Op4pO!e#vO(p'nO~Oq!nO!Q4qO(TTO(WUO(c!mO~O(w$}Ol%`i!O%`i'w%`i(x%`i!Z%`i#^%`i~Og%`i#}%`i~P%3xO(x%POl%bi!O%bi'w%bi(w%bi!Z%bi#^%bi~Og%bi#}%bi~P%4kOg(]i!Z(]i~P!0uO#^4wOg(]i!Z(]i~P!0uO!i4zO~Oa$nq!Z$nq'x$nq'u$nq!W$nq!i$nqt$nq!]$nq%h$nq!e$nq~P!:TO!W5QO~O!Z5RO!])OX~P#.{Oa]Xa$yX!]]X!]$yX%]]X'x]X'x$yX!Z]X!Z$yX~P!/qO%]5UOa%Za!]%Za'x%Za!Z%Za~OlmX!OmX'wmX(wmX(xmX~P%7nOn5VO(R#nO~Ob5]O%i5^O(R+nO(TTO(WUO!Z'rX!['rX~O!Z0}O![)Va~O[5bO~O`5cO~Oa%mO'x%mO~P#.{O!Z5kO#^5mO![)SX~O![5nO~Op5tOq!nO!Q*fO!`!yO!a!vO!b!vO!z;wO#R!pO#S!pO#T!pO#U!pO#V!pO#Y5sO#Z!zO(S!lO(TTO(WUO(c!mO(m!sO~O![5rO~P%:ROl5yO!]1gO%h5xO~Oh%VOl5yO!]1gO%h5xO~Ob6QO(R#nO(TTO(WUO!Z'qX!['qX~O!Z1rO![)Ta~O(TTO(WUO(c6SO~O`6WO~O#t6ZO&Y6[O~PMvO!i6]O~P%[Oa6_O~Oa6_O~P%[Ob2YO![6dO&h2XO~P`O!e6fO~O!e6hOh(hi!Z(hi![(hi!e(hi!j(hip(hi(p(hi~O!Z#fi![#fi~P#BPO#^6iO!Z#fi![#fi~O!Z!_i![!_i~P#BPOa%mO#^6rO'x%mO~Oa%mO!e#vO#^6rO'x%mO~O!Z(rq!i(rqa(rq'x(rq~P!:TO!Z(hO!i(qq~O!Q%gO!]%hO#h6yO(R%fO~O!]'^O%h6|O~Ol7QO!]'^O%h6|O~O#i'gaP'gaR'ga['gaa'gap'ga!Q'ga!j'ga!n'ga#P'ga#l'ga#m'ga#n'ga#o'ga#p'ga#q'ga#r'ga#s'ga#t'ga#u'ga#w'ga#y'ga#z'ga'x'ga(_'ga(p'ga!i'ga!W'ga'u'gat'ga!]'ga%h'ga!e'ga~P%+uO#i'iaP'iaR'ia['iaa'iap'ia!Q'ia!j'ia!n'ia#P'ia#l'ia#m'ia#n'ia#o'ia#p'ia#q'ia#r'ia#s'ia#t'ia#u'ia#w'ia#y'ia#z'ia'x'ia(_'ia(p'ia!i'ia!W'ia'u'iat'ia!]'ia%h'ia!e'ia~P%,hO#i${iP${iR${i[${ia${ip${i!Q${i!Z${i!j${i!n${i#P${i#l${i#m${i#n${i#o${i#p${i#q${i#r${i#s${i#t${i#u${i#w${i#y${i#z${i'x${i(_${i(p${i!i${i!W${i'u${i#^${it${i!]${i%h${i!e${i~P#.{O#i%`iP%`iR%`i[%`ia%`ip%`i!Q%`i!j%`i!n%`i#P%`i#l%`i#m%`i#n%`i#o%`i#p%`i#q%`i#r%`i#s%`i#t%`i#u%`i#w%`i#y%`i#z%`i'x%`i(_%`i(p%`i!i%`i!W%`i'u%`it%`i!]%`i%h%`i!e%`i~P%3xO#i%biP%biR%bi[%bia%bip%bi!Q%bi!j%bi!n%bi#P%bi#l%bi#m%bi#n%bi#o%bi#p%bi#q%bi#r%bi#s%bi#t%bi#u%bi#w%bi#y%bi#z%bi'x%bi(_%bi(p%bi!i%bi!W%bi'u%bit%bi!]%bi%h%bi!e%bi~P%4kO!Z'Wa!i'Wa~P!:TO!Z.oO!i(ii~O#}#ai!Z#ai![#ai~P#BPOP$[OR#zO!O#yO!Q#{O!j#xO!n$[O(_VO[#kip#ki#P#ki#m#ki#n#ki#o#ki#p#ki#q#ki#r#ki#s#ki#t#ki#u#ki#w#ki#y#ki#z#ki#}#ki(p#ki(w#ki(x#ki!Z#ki![#ki~O#l#ki~P%MQO#l<PO~P%MQOP$[OR#zOp<]O!O#yO!Q#{O!j#xO!n$[O#l<PO#m<QO#n<QO#o<QO(_VO[#ki#P#ki#q#ki#r#ki#s#ki#t#ki#u#ki#w#ki#y#ki#z#ki#}#ki(p#ki(w#ki(x#ki!Z#ki![#ki~O#p#ki~P& YO#p<RO~P& YOP$[OR#zO[<_Op<]O!O#yO!Q#{O!j#xO!n$[O#P<SO#l<PO#m<QO#n<QO#o<QO#p<RO#q<SO#r<SO#s<^O#t<SO(_VO#w#ki#y#ki#z#ki#}#ki(p#ki(w#ki(x#ki!Z#ki![#ki~O#u#ki~P&#bOP$[OR#zO[<_Op<]O!O#yO!Q#{O!j#xO!n$[O#P<SO#l<PO#m<QO#n<QO#o<QO#p<RO#q<SO#r<SO#s<^O#t<SO#u<TO(_VO(x#}O#y#ki#z#ki#}#ki(p#ki(w#ki!Z#ki![#ki~O#w<VO~P&%cO#w#ki~P&%cO#u<TO~P&#bOP$[OR#zO[<_Op<]O!O#yO!Q#{O!j#xO!n$[O#P<SO#l<PO#m<QO#n<QO#o<QO#p<RO#q<SO#r<SO#s<^O#t<SO#u<TO#w<VO(_VO(w#|O(x#}O#z#ki#}#ki(p#ki!Z#ki![#ki~O#y#ki~P&'rO#y<XO~P&'rOa#{y!Z#{y'x#{y'u#{y!W#{y!i#{yt#{y!]#{y%h#{y!e#{y~P!:TO[#kip#ki#P#ki#p#ki#q#ki#r#ki#s#ki#t#ki#u#ki#w#ki#y#ki#z#ki#}#ki(p#ki!Z#ki![#ki~OP$[OR#zO!O#yO!Q#{O!j#xO!n$[O#l<PO#m<QO#n<QO#o<QO(_VO(w#ki(x#ki~P&*nOl=}O!O)|O'w)}O(w$}O(x%POP#kiR#ki!Q#ki!j#ki!n#ki#l#ki#m#ki#n#ki#o#ki(_#ki~P&*nO#Q$dOP(^XR(^X[(^Xl(^Xp(^X!O(^X!Q(^X!j(^X!n(^X#P(^X#l(^X#m(^X#n(^X#o(^X#p(^X#q(^X#r(^X#s(^X#t(^X#u(^X#w(^X#y(^X#z(^X#}(^X'w(^X(_(^X(p(^X(w(^X(x(^X!Z(^X![(^X~O#}$Oi!Z$Oi![$Oi~P#BPO#}!pi![!pi~P$*OOg'Za!Z'Za~P!0uO![7dO~O!Z'ba!['ba~P#BPO!W7eO~P#.{O!e#vO(p'nO!Z'ca!i'ca~O!Z/kO!i(|i~O!Z/kO!e#vO!i(|i~Og${q!Z${q#^${q#}${q~P!0uO!W'ea!Z'ea~P#.{O!e7lO~O!Z/sO!W(}i~P#.{O!Z/sO!W(}i~O!W7oO~Oh%VOp7tO!j%dO(p'nO~O!e#vO#t7vO~Op7yO!e#vO(p'nO~O!O)|O'w)}O(x%POl'ha(w'ha!Z'ha#^'ha~Og'ha#}'ha~P&3oO!O)|O'w)}Ol'ja(w'ja(x'ja!Z'ja#^'ja~Og'ja#}'ja~P&4bO!W7{O~Og$}q!Z$}q#^$}q#}$}q~P!0uOg(]q!Z(]q~P!0uO#^7|Og(]q!Z(]q~P!0uOa$ny!Z$ny'x$ny'u$ny!W$ny!i$nyt$ny!]$ny%h$ny!e$ny~P!:TO!e6hO~O!Z5RO!])Oa~O!]'^OP$SaR$Sa[$Sap$Sa!O$Sa!Q$Sa!Z$Sa!j$Sa!n$Sa#P$Sa#l$Sa#m$Sa#n$Sa#o$Sa#p$Sa#q$Sa#r$Sa#s$Sa#t$Sa#u$Sa#w$Sa#y$Sa#z$Sa(_$Sa(p$Sa(w$Sa(x$Sa~O%h6|O~P&7SO%]8QOa%Zi!]%Zi'x%Zi!Z%Zi~Oa#ay!Z#ay'x#ay'u#ay!W#ay!i#ayt#ay!]#ay%h#ay!e#ay~P!:TO[8SO~Ob8UO(R+nO(TTO(WUO~O!Z0}O![)Vi~O`8YO~O(c(zO!Z'nX!['nX~O!Z5kO![)Sa~O![8cO~P%:RO(m!sO~P$$oO#Y8dO~O!]1gO~O!]1gO%h8fO~Ol8iO!]1gO%h8fO~O[8nO!Z'qa!['qa~O!Z1rO![)Ti~O!i8rO~O!i8sO~O!i8vO~O!i8vO~P%[Oa8xO~O!e8yO~O!i8zO~O!Z(ui![(ui~P#BPOa%mO#^9SO'x%mO~O!Z(ry!i(rya(ry'x(ry~P!:TO!Z(hO!i(qy~O%h9VO~P&7SO!]'^O%h9VO~O#i${qP${qR${q[${qa${qp${q!Q${q!Z${q!j${q!n${q#P${q#l${q#m${q#n${q#o${q#p${q#q${q#r${q#s${q#t${q#u${q#w${q#y${q#z${q'x${q(_${q(p${q!i${q!W${q'u${q#^${qt${q!]${q%h${q!e${q~P#.{O#i'haP'haR'ha['haa'hap'ha!Q'ha!j'ha!n'ha#P'ha#l'ha#m'ha#n'ha#o'ha#p'ha#q'ha#r'ha#s'ha#t'ha#u'ha#w'ha#y'ha#z'ha'x'ha(_'ha(p'ha!i'ha!W'ha'u'hat'ha!]'ha%h'ha!e'ha~P&3oO#i'jaP'jaR'ja['jaa'jap'ja!Q'ja!j'ja!n'ja#P'ja#l'ja#m'ja#n'ja#o'ja#p'ja#q'ja#r'ja#s'ja#t'ja#u'ja#w'ja#y'ja#z'ja'x'ja(_'ja(p'ja!i'ja!W'ja'u'jat'ja!]'ja%h'ja!e'ja~P&4bO#i$}qP$}qR$}q[$}qa$}qp$}q!Q$}q!Z$}q!j$}q!n$}q#P$}q#l$}q#m$}q#n$}q#o$}q#p$}q#q$}q#r$}q#s$}q#t$}q#u$}q#w$}q#y$}q#z$}q'x$}q(_$}q(p$}q!i$}q!W$}q'u$}q#^$}qt$}q!]$}q%h$}q!e$}q~P#.{O!Z'Wi!i'Wi~P!:TO#}#aq!Z#aq![#aq~P#BPO(w$}OP%`aR%`a[%`ap%`a!Q%`a!j%`a!n%`a#P%`a#l%`a#m%`a#n%`a#o%`a#p%`a#q%`a#r%`a#s%`a#t%`a#u%`a#w%`a#y%`a#z%`a#}%`a(_%`a(p%`a!Z%`a![%`a~Ol%`a!O%`a'w%`a(x%`a~P&HgO(x%POP%baR%ba[%bap%ba!Q%ba!j%ba!n%ba#P%ba#l%ba#m%ba#n%ba#o%ba#p%ba#q%ba#r%ba#s%ba#t%ba#u%ba#w%ba#y%ba#z%ba#}%ba(_%ba(p%ba!Z%ba![%ba~Ol%ba!O%ba'w%ba(w%ba~P&JnOl=}O!O)|O'w)}O(x%PO~P&HgOl=}O!O)|O'w)}O(w$}O~P&JnOR0cO!O0cO!Q0dO#Q$dOP{a[{al{ap{a!j{a!n{a#P{a#l{a#m{a#n{a#o{a#p{a#q{a#r{a#s{a#t{a#u{a#w{a#y{a#z{a#}{a'w{a(_{a(p{a(w{a(x{a!Z{a![{a~O!O)|O'w)}OP$raR$ra[$ral$rap$ra!Q$ra!j$ra!n$ra#P$ra#l$ra#m$ra#n$ra#o$ra#p$ra#q$ra#r$ra#s$ra#t$ra#u$ra#w$ra#y$ra#z$ra#}$ra(_$ra(p$ra(w$ra(x$ra!Z$ra![$ra~O!O)|O'w)}OP$taR$ta[$tal$tap$ta!Q$ta!j$ta!n$ta#P$ta#l$ta#m$ta#n$ta#o$ta#p$ta#q$ta#r$ta#s$ta#t$ta#u$ta#w$ta#y$ta#z$ta#}$ta(_$ta(p$ta(w$ta(x$ta!Z$ta![$ta~Ol=}O!O)|O'w)}O(w$}O(x%PO~OP%SaR%Sa[%Sap%Sa!Q%Sa!j%Sa!n%Sa#P%Sa#l%Sa#m%Sa#n%Sa#o%Sa#p%Sa#q%Sa#r%Sa#s%Sa#t%Sa#u%Sa#w%Sa#y%Sa#z%Sa#}%Sa(_%Sa(p%Sa!Z%Sa![%Sa~P'%sO#}$lq!Z$lq![$lq~P#BPO#}$nq!Z$nq![$nq~P#BPO![9dO~O#}9eO~P!0uO!e#vO!Z'ci!i'ci~O!e#vO(p'nO!Z'ci!i'ci~O!Z/kO!i(|q~O!W'ei!Z'ei~P#.{O!Z/sO!W(}q~Op9lO!e#vO(p'nO~O[9nO!W9mO~P#.{O!W9mO~O!e#vO#t9tO~Og(]y!Z(]y~P!0uO!Z'la!]'la~P#.{Oa%Zq!]%Zq'x%Zq!Z%Zq~P#.{O[9yO~O!Z0}O![)Vq~O#^9}O!Z'na!['na~O!Z5kO![)Si~P#BPO!Q:PO~O!]1gO%h:SO~O(TTO(WUO(c:XO~O!Z1rO![)Tq~O!i:[O~O!i:]O~O!i:^O~O!i:^O~P%[O#^:aO!Z#fy![#fy~O!Z#fy![#fy~P#BPO%h:fO~P&7SO!]'^O%h:fO~O#}#{y!Z#{y![#{y~P#BPOP${iR${i[${ip${i!Q${i!j${i!n${i#P${i#l${i#m${i#n${i#o${i#p${i#q${i#r${i#s${i#t${i#u${i#w${i#y${i#z${i#}${i(_${i(p${i!Z${i![${i~P'%sO!O)|O'w)}O(x%POP'gaR'ga['gal'gap'ga!Q'ga!j'ga!n'ga#P'ga#l'ga#m'ga#n'ga#o'ga#p'ga#q'ga#r'ga#s'ga#t'ga#u'ga#w'ga#y'ga#z'ga#}'ga(_'ga(p'ga(w'ga!Z'ga!['ga~O!O)|O'w)}OP'iaR'ia['ial'iap'ia!Q'ia!j'ia!n'ia#P'ia#l'ia#m'ia#n'ia#o'ia#p'ia#q'ia#r'ia#s'ia#t'ia#u'ia#w'ia#y'ia#z'ia#}'ia(_'ia(p'ia(w'ia(x'ia!Z'ia!['ia~O(w$}OP%`iR%`i[%`il%`ip%`i!O%`i!Q%`i!j%`i!n%`i#P%`i#l%`i#m%`i#n%`i#o%`i#p%`i#q%`i#r%`i#s%`i#t%`i#u%`i#w%`i#y%`i#z%`i#}%`i'w%`i(_%`i(p%`i(x%`i!Z%`i![%`i~O(x%POP%biR%bi[%bil%bip%bi!O%bi!Q%bi!j%bi!n%bi#P%bi#l%bi#m%bi#n%bi#o%bi#p%bi#q%bi#r%bi#s%bi#t%bi#u%bi#w%bi#y%bi#z%bi#}%bi'w%bi(_%bi(p%bi(w%bi!Z%bi![%bi~O#}$ny!Z$ny![$ny~P#BPO#}#ay!Z#ay![#ay~P#BPO!e#vO!Z'cq!i'cq~O!Z/kO!i(|y~O!W'eq!Z'eq~P#.{Op:pO!e#vO(p'nO~O[:tO!W:sO~P#.{O!W:sO~Og(]!R!Z(]!R~P!0uOa%Zy!]%Zy'x%Zy!Z%Zy~P#.{O!Z0}O![)Vy~O!Z5kO![)Sq~O(R:zO~O!]1gO%h:}O~O!i;QO~O%h;VO~P&7SOP${qR${q[${qp${q!Q${q!j${q!n${q#P${q#l${q#m${q#n${q#o${q#p${q#q${q#r${q#s${q#t${q#u${q#w${q#y${q#z${q#}${q(_${q(p${q!Z${q![${q~P'%sO!O)|O'w)}O(x%POP'haR'ha['hal'hap'ha!Q'ha!j'ha!n'ha#P'ha#l'ha#m'ha#n'ha#o'ha#p'ha#q'ha#r'ha#s'ha#t'ha#u'ha#w'ha#y'ha#z'ha#}'ha(_'ha(p'ha(w'ha!Z'ha!['ha~O!O)|O'w)}OP'jaR'ja['jal'jap'ja!Q'ja!j'ja!n'ja#P'ja#l'ja#m'ja#n'ja#o'ja#p'ja#q'ja#r'ja#s'ja#t'ja#u'ja#w'ja#y'ja#z'ja#}'ja(_'ja(p'ja(w'ja(x'ja!Z'ja!['ja~OP$}qR$}q[$}qp$}q!Q$}q!j$}q!n$}q#P$}q#l$}q#m$}q#n$}q#o$}q#p$}q#q$}q#r$}q#s$}q#t$}q#u$}q#w$}q#y$}q#z$}q#}$}q(_$}q(p$}q!Z$}q![$}q~P'%sOg%d!Z!Z%d!Z#^%d!Z#}%d!Z~P!0uO!W;ZO~P#.{Op;[O!e#vO(p'nO~O[;^O!W;ZO~P#.{O!Z'nq!['nq~P#BPO!Z#f!Z![#f!Z~P#BPO#i%d!ZP%d!ZR%d!Z[%d!Za%d!Zp%d!Z!Q%d!Z!Z%d!Z!j%d!Z!n%d!Z#P%d!Z#l%d!Z#m%d!Z#n%d!Z#o%d!Z#p%d!Z#q%d!Z#r%d!Z#s%d!Z#t%d!Z#u%d!Z#w%d!Z#y%d!Z#z%d!Z'x%d!Z(_%d!Z(p%d!Z!i%d!Z!W%d!Z'u%d!Z#^%d!Zt%d!Z!]%d!Z%h%d!Z!e%d!Z~P#.{Op;fO!e#vO(p'nO~O!W;gO~P#.{Op;nO!e#vO(p'nO~O!W;oO~P#.{OP%d!ZR%d!Z[%d!Zp%d!Z!Q%d!Z!j%d!Z!n%d!Z#P%d!Z#l%d!Z#m%d!Z#n%d!Z#o%d!Z#p%d!Z#q%d!Z#r%d!Z#s%d!Z#t%d!Z#u%d!Z#w%d!Z#y%d!Z#z%d!Z#}%d!Z(_%d!Z(p%d!Z!Z%d!Z![%d!Z~P'%sOp;rO!e#vO(p'nO~Ot(dX~P1qO!O%qO~P!(yO(S!lO~P!(yO!WfX!ZfX#^fX~P%0XOP]XR]X[]Xp]X!O]X!Q]X!Z]X!ZfX!j]X!n]X#P]X#Q]X#^]X#^fX#ifX#l]X#m]X#n]X#o]X#p]X#q]X#r]X#s]X#t]X#u]X#w]X#y]X#z]X$P]X(_]X(p]X(w]X(x]X~O!efX!i]X!ifX(pfX~P'JlOP;vOQ;vOSfOd=rOe!iOnkOp;vOqkOrkOxkOz;vO|;vO!QWO!UkO!VkO!]XO!g;yO!jZO!m;vO!n;vO!o;vO!q;zO!s;}O!v!hO$V!kO$m=pO(R)ZO(TTO(WUO(_VO(m[O~O!Z<ZO![$pa~Oh%VOn%WOp%XOq$tOr$tOx%YOz%ZO|<fO!Q${O!]$|O!g=wO!j$xO#h<lO$V%_O$s<hO$u<jO$x%`O(R(tO(TTO(WUO(_$uO(w$}O(x%PO~Oj)bO~P( bOp!cX(p!cX~P# qOp(hX(p(hX~P#!dO![]X![fX~P'JlO!WfX!W$yX!ZfX!Z$yX#^fX~P!/qO#i<OO~O!e#vO#i<OO~O#^<`O~O#t<SO~O#^<pO!Z(uX![(uX~O#^<`O!Z(sX![(sX~O#i<qO~Og<sO~P!0uO#i<yO~O#i<zO~O!e#vO#i<{O~O!e#vO#i<qO~O#}<|O~P#BPO#i<}O~O#i=OO~O#i=TO~O#i=UO~O#i=VO~O#i=WO~O#}=XO~P!0uO#}=YO~P!0uO#Q#R#S#U#V#Y#g#h#s$m$s$u$x%[%]%g%h%i%p%r%u%v%x%z~'|T#m!V'z(S#nq#l#op!O'{$['{(R$^(c~",goto:"$8f)ZPPPPPP)[PP)_P)pP+Q/VPPPP6aPP6wPP<oP@cP@yP@yPPP@yPCRP@yP@yP@yPCVPC[PCyPHsPPPHwPPPPHwKzPPPLQLrPHwPHwPP! QHwPPPHwPHwP!#XHwP!&o!'t!'}P!(q!(u!(q!,SPPPPPPP!,s!'tPP!-T!.uP!2RHwHw!2W!5d!:Q!:Q!>PPPP!>XHwPPPPPPPPPP!AhP!BuPPHw!DWPHwPHwHwHwHwHwPHw!EjP!HtP!KzP!LO!LY!L^!L^P!HqP!Lb!LbP# hP# lHwPHw# r#$wCV@yP@yP@y@yP#&U@y@y#(h@y#+`@y#-l@y@y#.[#0p#0p#0u#1O#0p#1ZPP#0pP@y#1s@y#5r@y@y6aPPP#9wPPP#:b#:bP#:bP#:x#:bPP#;OP#:uP#:u#;c#:u#;}#<T#<W)_#<Z)_P#<b#<b#<bP)_P)_P)_P)_PP)_P#<h#<kP#<k)_P#<oP#<rP)_P)_P)_P)_P)_P)_)_PP#<x#=O#=Z#=a#=g#=m#=s#>R#>X#>c#>i#>s#>y#?Z#?a#@R#@e#@k#@q#AP#Af#CZ#Ci#Cp#E[#Ej#G[#Gj#Gp#Gv#G|#HW#H^#Hd#Hn#IQ#IWPPPPPPPPPPP#I^PPPPPPP#JR#MY#Nr#Ny$ RPPP$&mP$&v$)o$0Y$0]$0`$1_$1b$1i$1qP$1w$1zP$2h$2l$3d$4r$4w$5_PP$5d$5j$5n$5q$5u$5y$6u$7^$7u$7y$7|$8P$8V$8Y$8^$8bR!|RoqOXst!Z#d%l&p&r&s&u,n,s2S2VY!vQ'^-`1g5qQ%svQ%{yQ&S|Q&h!VS'U!e-WQ'd!iS'j!r!yU*h$|*X*lQ+l%|Q+y&UQ,_&bQ-^']Q-h'eQ-p'kQ0U*nQ1q,`R<m;z%SdOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%l%s&Q&i&l&p&r&s&u&y'R'`'p(R(T(Z(b(v(x(|){*f+U+Y,k,n,s-d-l-z.Q.o.v/i0V0d0l0|1j1z1{1}2P2S2V2X2x3O3d4q5y6Z6[6_6r8i8x9SS#q];w!r)]$Z$n'V)q-P-S/Q2h3{5m6i9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sU*{%[<e<fQ+q&OQ,a&eQ,h&mQ0r+dQ0u+fQ1S+rQ1y,fQ3W.bQ5V0wQ5]0}Q6Q1rQ7O3[Q8U5^R9Y7Q'QkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%l%s&Q&i&l&m&p&r&s&u&y'R'V'`'p(R(T(Z(b(v(x(|)q){*f+U+Y+d,k,n,s-P-S-d-l-z.Q.b.o.v/Q/i0V0d0l0|1j1z1{1}2P2S2V2X2h2x3O3[3d3{4q5m5y6Z6[6_6i6r7Q8i8x9S9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=s!S!nQ!r!v!y!z$|'U']'^'j'k'l*h*l*n*o-W-^-`-p0U0X1g5q5s%[$ti#v$b$c$d$x${%O%Q%]%^%b)w*P*R*T*W*^*d*t*u+c+f+},Q.a.z/_/h/r/s/u0Y0[0g0h0i1^1a1i3Z4U4V4a4f4w5R5U5x6|7l7v7|8Q8f9V9e9n9t:S:f:t:};V;^<^<_<a<b<c<d<g<h<i<j<k<l<t<u<v<w<y<z<}=O=P=Q=R=S=T=U=X=Y=p=x=y=|=}Q&V|Q'S!eS'Y%h-ZQ+q&OQ,a&eQ0f+OQ1S+rQ1X+xQ1x,eQ1y,fQ5]0}Q5f1ZQ6Q1rQ6T1tQ6U1wQ8U5^Q8X5cQ8q6WQ9|8YQ:Y8nR<o*XrnOXst!V!Z#d%l&g&p&r&s&u,n,s2S2VR,c&i&z^OPXYstuvwz!Z!`!g!j!o#S#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%l%s&Q&i&l&m&p&r&s&u&y'R'`'p(T(Z(b(v(x(|)q){*f+U+Y+d,k,n,s-P-S-d-l-z.Q.b.o.v/Q/i0V0d0l0|1j1z1{1}2P2S2V2X2h2x3O3[3d3{4q5m5y6Z6[6_6i6r7Q8i8x9S9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=r=s[#]WZ#W#Z'V(R!b%im#h#i#l$x%d%g([(f(g(h*W*[*_+W+X+Z,j-Q.O.U.V.W.Y/h/k2[3S3T4X6h6yQ%vxQ%zyS&P|&UQ&]!TQ'a!hQ'c!iQ(o#sS+k%{%|Q+o&OQ,Y&`Q,^&bS-g'd'eQ.d(pQ0{+lQ1R+rQ1T+sQ1W+wQ1l,ZS1p,_,`Q2t-hQ5[0}Q5`1QQ5e1YQ6P1qQ8T5^Q8W5bQ9x8SR:w9y!U$zi$d%O%Q%]%^%b*P*R*^*t*u.z/r0Y0[0g0h0i4V4w7|9e=p=x=y!^%xy!i!u%z%{%|'T'c'd'e'i's*g+k+l-T-g-h-o/{0O0{2m2t2{4i4j4m7s9pQ+e%vQ,O&YQ,R&ZQ,]&bQ.c(oQ1k,YU1o,^,_,`Q3].dQ5z1lS6O1p1qQ8m6P#f=t#v$b$c$x${)w*T*W*d+c+f+},Q.a/_/h/s/u1^1a1i3Z4U4a4f5R5U5x6|7l7v8Q8f9V9n9t:S:f:t:};V;^<a<c<g<i<k<t<v<y<}=P=R=T=X=|=}o=u<^<_<b<d<h<j<l<u<w<z=O=Q=S=U=YW%Ti%V*v=pS&Y!Q&gQ&Z!RQ&[!SQ+S%cR+|&W%]%Si#v$b$c$d$x${%O%Q%]%^%b)w*P*R*T*W*^*d*t*u+c+f+},Q.a.z/_/h/r/s/u0Y0[0g0h0i1^1a1i3Z4U4V4a4f4w5R5U5x6|7l7v7|8Q8f9V9e9n9t:S:f:t:};V;^<^<_<a<b<c<d<g<h<i<j<k<l<t<u<v<w<y<z<}=O=P=Q=R=S=T=U=X=Y=p=x=y=|=}T)x$u)yV*{%[<e<fW'Y!e%h*X-ZS({#y#zQ+`%qQ+v&RS.](k(lQ1b,SQ4x0cR8^5k'QkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%l%s&Q&i&l&m&p&r&s&u&y'R'V'`'p(R(T(Z(b(v(x(|)q){*f+U+Y+d,k,n,s-P-S-d-l-z.Q.b.o.v/Q/i0V0d0l0|1j1z1{1}2P2S2V2X2h2x3O3[3d3{4q5m5y6Z6[6_6i6r7Q8i8x9S9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=s$i$^c#Y#e%p%r%t(Q(W(r(w)P)Q)R)S)T)U)V)W)X)Y)[)^)`)e)o+a+u-U-s-x-}.P.n.q.u.w.x.y/]0j2c2f2v2}3c3h3i3j3k3l3m3n3o3p3q3r3s3t3w3x4P5O5Y6k6q6v7V7W7a7b8`8|9Q9[9b9c:c:y;R;x=gT#TV#U'RkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%l%s&Q&i&l&m&p&r&s&u&y'R'V'`'p(R(T(Z(b(v(x(|)q){*f+U+Y+d,k,n,s-P-S-d-l-z.Q.b.o.v/Q/i0V0d0l0|1j1z1{1}2P2S2V2X2h2x3O3[3d3{4q5m5y6Z6[6_6i6r7Q8i8x9S9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sQ'W!eR2i-W!W!nQ!e!r!v!y!z$|'U']'^'j'k'l*X*h*l*n*o-W-^-`-p0U0X1g5q5sR1d,UnqOXst!Z#d%l&p&r&s&u,n,s2S2VQ&w!^Q't!xS(q#u<OQ+i%yQ,W&]Q,X&_Q-e'bQ-r'mS.m(v<qS0k+U<{Q0y+jQ1f,VQ2Z,uQ2],vQ2e-RQ2r-fQ2u-jS5P0l=VQ5W0zS5Z0|=WQ6j2gQ6n2sQ6s2zQ8R5XQ8}6lQ9O6oQ9R6tR:`8z$d$]c#Y#e%r%t(Q(W(r(w)P)Q)R)S)T)U)V)W)X)Y)[)^)`)e)o+a+u-U-s-x-}.P.n.q.u.x.y/]0j2c2f2v2}3c3h3i3j3k3l3m3n3o3p3q3r3s3t3w3x4P5O5Y6k6q6v7V7W7a7b8`8|9Q9[9b9c:c:y;R;x=gS(m#p'gQ(}#zS+_%p.wS.^(l(nR3U._'QkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%l%s&Q&i&l&m&p&r&s&u&y'R'V'`'p(R(T(Z(b(v(x(|)q){*f+U+Y+d,k,n,s-P-S-d-l-z.Q.b.o.v/Q/i0V0d0l0|1j1z1{1}2P2S2V2X2h2x3O3[3d3{4q5m5y6Z6[6_6i6r7Q8i8x9S9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sS#q];wQ&r!XQ&s!YQ&u![Q&v!]R2R,qQ'_!hQ+b%vQ-c'aS.`(o+eQ2p-bW3Y.c.d0q0sQ6m2qW6z3V3X3]5TU9U6{6}7PU:e9W9X9ZS;T:d:gQ;b;UR;j;cU!wQ'^-`T5o1g5q!Q_OXZ`st!V!Z#d#h%d%l&g&i&p&r&s&u(h,n,s.V2S2V]!pQ!r'^-`1g5qT#q];w%^{OPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%l%s&Q&i&l&m&p&r&s&u&y'R'`'p(R(T(Z(b(v(x(|){*f+U+Y+d,k,n,s-d-l-z.Q.b.o.v/i0V0d0l0|1j1z1{1}2P2S2V2X2x3O3[3d4q5y6Z6[6_6r7Q8i8x9SS({#y#zS.](k(l!s=^$Z$n'V)q-P-S/Q2h3{5m6i9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sU$fd)],hS(n#p'gU*s%R(u3vU0e*z.i7]Q5T0rQ6{3WQ9X7OR:g9Ym!tQ!r!v!y!z'^'j'k'l-`-p1g5q5sQ'r!uS(d#g1|S-n'i'uQ/n*ZQ/{*gQ2|-qQ4]/oQ4i/}Q4j0OQ4o0WQ7h4WS7s4k4mS7w4p4rQ9g7iQ9k7oQ9p7tQ9u7yS:o9l9mS;Y:p:sS;e;Z;[S;m;f;gS;q;n;oR;t;rQ#wbQ'q!uS(c#g1|S(e#m+TQ+V%eQ+g%wQ+m%}U-m'i'r'uQ.R(dQ/m*ZQ/|*gQ0P*iQ0x+hQ1m,[S2y-n-qQ3R.ZS4[/n/oQ4e/yS4h/{0WQ4l0QQ5|1nQ6u2|Q7g4WQ7k4]U7r4i4o4rQ7u4nQ8k5}S9f7h7iQ9j7oQ9r7wQ9s7xQ:V8lQ:m9gS:n9k9mQ:v9uQ;P:WS;X:o:sS;d;Y;ZS;l;e;gS;p;m;oQ;s;qQ;u;tQ=a=[Q=l=eR=m=fV!wQ'^-`%^aOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%l%s&Q&i&l&m&p&r&s&u&y'R'`'p(R(T(Z(b(v(x(|){*f+U+Y+d,k,n,s-d-l-z.Q.b.o.v/i0V0d0l0|1j1z1{1}2P2S2V2X2x3O3[3d4q5y6Z6[6_6r7Q8i8x9SS#wz!j!r=Z$Z$n'V)q-P-S/Q2h3{5m6i9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sR=a=r%^bOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%l%s&Q&i&l&m&p&r&s&u&y'R'`'p(R(T(Z(b(v(x(|){*f+U+Y+d,k,n,s-d-l-z.Q.b.o.v/i0V0d0l0|1j1z1{1}2P2S2V2X2x3O3[3d4q5y6Z6[6_6r7Q8i8x9SQ%ej!^%wy!i!u%z%{%|'T'c'd'e'i's*g+k+l-T-g-h-o/{0O0{2m2t2{4i4j4m7s9pS%}z!jQ+h%xQ,[&bW1n,],^,_,`U5}1o1p1qS8l6O6PQ:W8m!r=[$Z$n'V)q-P-S/Q2h3{5m6i9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sQ=e=qR=f=r%QeOPXYstuvw!Z!`!g!o#S#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%l%s&Q&i&l&p&r&s&u&y'R'`'p(T(Z(b(v(x(|){*f+U+Y+d,k,n,s-d-l-z.Q.b.o.v/i0V0d0l0|1j1z1{1}2P2S2V2X2x3O3[3d4q5y6Z6[6_6r7Q8i8x9SY#bWZ#W#Z(R!b%im#h#i#l$x%d%g([(f(g(h*W*[*_+W+X+Z,j-Q.O.U.V.W.Y/h/k2[3S3T4X6h6yQ,i&m!p=]$Z$n)q-P-S/Q2h3{5m6i9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sR=`'VU'Z!e%h*XR2k-Z%SdOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%l%s&Q&i&l&p&r&s&u&y'R'`'p(R(T(Z(b(v(x(|){*f+U+Y,k,n,s-d-l-z.Q.o.v/i0V0d0l0|1j1z1{1}2P2S2V2X2x3O3d4q5y6Z6[6_6r8i8x9S!r)]$Z$n'V)q-P-S/Q2h3{5m6i9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sQ,h&mQ0r+dQ3W.bQ7O3[R9Y7Q!b$Tc#Y%p(Q(W(r(w)X)Y)^)e+u-s-x-}.P.n.q/]0j2v2}3c3s5O5Y6q6v7V9Q:c;x!P<U)[)o-U.w2c2f3h3q3r3w4P6k7W7a7b8`8|9[9b9c:y;R=g!f$Vc#Y%p(Q(W(r(w)U)V)X)Y)^)e+u-s-x-}.P.n.q/]0j2v2}3c3s5O5Y6q6v7V9Q:c;x!T<W)[)o-U.w2c2f3h3n3o3q3r3w4P6k7W7a7b8`8|9[9b9c:y;R=g!^$Zc#Y%p(Q(W(r(w)^)e+u-s-x-}.P.n.q/]0j2v2}3c3s5O5Y6q6v7V9Q:c;xQ4V/fz=s)[)o-U.w2c2f3h3w4P6k7W7a7b8`8|9[9b9c:y;R=gQ=x=zR=y={'QkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%l%s&Q&i&l&m&p&r&s&u&y'R'V'`'p(R(T(Z(b(v(x(|)q){*f+U+Y+d,k,n,s-P-S-d-l-z.Q.b.o.v/Q/i0V0d0l0|1j1z1{1}2P2S2V2X2h2x3O3[3d3{4q5m5y6Z6[6_6i6r7Q8i8x9S9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sS$oh$pR3|/P'XgOPWXYZhstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n$p%l%s&Q&i&l&m&p&r&s&u&y'R'V'`'p(R(T(Z(b(v(x(|)q){*f+U+Y+d,k,n,s-P-S-d-l-z.Q.b.o.v/P/Q/i0V0d0l0|1j1z1{1}2P2S2V2X2h2x3O3[3d3{4q5m5y6Z6[6_6i6r7Q8i8x9S9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sT$kf$qQ$ifS)h$l)lR)t$qT$jf$qT)j$l)l'XhOPWXYZhstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n$p%l%s&Q&i&l&m&p&r&s&u&y'R'V'`'p(R(T(Z(b(v(x(|)q){*f+U+Y+d,k,n,s-P-S-d-l-z.Q.b.o.v/P/Q/i0V0d0l0|1j1z1{1}2P2S2V2X2h2x3O3[3d3{4q5m5y6Z6[6_6i6r7Q8i8x9S9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sT$oh$pQ$rhR)s$p%^jOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%l%s&Q&i&l&m&p&r&s&u&y'R'`'p(R(T(Z(b(v(x(|){*f+U+Y+d,k,n,s-d-l-z.Q.b.o.v/i0V0d0l0|1j1z1{1}2P2S2V2X2x3O3[3d4q5y6Z6[6_6r7Q8i8x9S!s=q$Z$n'V)q-P-S/Q2h3{5m6i9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=s#glOPXZst!Z!`!o#S#d#o#{$n%l&i&l&m&p&r&s&u&y'R'`(|)q*f+Y+d,k,n,s-d.b/Q/i0V0d1j1z1{1}2P2S2V2X3[3{4q5y6Z6[6_7Q8i8x!U%Ri$d%O%Q%]%^%b*P*R*^*t*u.z/r0Y0[0g0h0i4V4w7|9e=p=x=y#f(u#v$b$c$x${)w*T*W*d+c+f+},Q.a/_/h/s/u1^1a1i3Z4U4a4f5R5U5x6|7l7v8Q8f9V9n9t:S:f:t:};V;^<a<c<g<i<k<t<v<y<}=P=R=T=X=|=}Q+P%`Q/^)|o3v<^<_<b<d<h<j<l<u<w<z=O=Q=S=U=Y!U$yi$d%O%Q%]%^%b*P*R*^*t*u.z/r0Y0[0g0h0i4V4w7|9e=p=x=yQ*`$zU*i$|*X*lQ+Q%aQ0Q*j#f=c#v$b$c$x${)w*T*W*d+c+f+},Q.a/_/h/s/u1^1a1i3Z4U4a4f5R5U5x6|7l7v8Q8f9V9n9t:S:f:t:};V;^<a<c<g<i<k<t<v<y<}=P=R=T=X=|=}n=d<^<_<b<d<h<j<l<u<w<z=O=Q=S=U=YQ=h=tQ=i=uQ=j=vR=k=w!U%Ri$d%O%Q%]%^%b*P*R*^*t*u.z/r0Y0[0g0h0i4V4w7|9e=p=x=y#f(u#v$b$c$x${)w*T*W*d+c+f+},Q.a/_/h/s/u1^1a1i3Z4U4a4f5R5U5x6|7l7v8Q8f9V9n9t:S:f:t:};V;^<a<c<g<i<k<t<v<y<}=P=R=T=X=|=}o3v<^<_<b<d<h<j<l<u<w<z=O=Q=S=U=YnoOXst!Z#d%l&p&r&s&u,n,s2S2VS*c${*WQ,|&|Q,}'OR4`/s%[%Si#v$b$c$d$x${%O%Q%]%^%b)w*P*R*T*W*^*d*t*u+c+f+},Q.a.z/_/h/r/s/u0Y0[0g0h0i1^1a1i3Z4U4V4a4f4w5R5U5x6|7l7v7|8Q8f9V9e9n9t:S:f:t:};V;^<^<_<a<b<c<d<g<h<i<j<k<l<t<u<v<w<y<z<}=O=P=Q=R=S=T=U=X=Y=p=x=y=|=}Q,P&ZQ1`,RQ5i1_R8]5jV*k$|*X*lU*k$|*X*lT5p1g5qS/y*f/iQ4n0VT7x4q:PQ+g%wQ0P*iQ0x+hQ1m,[Q5|1nQ8k5}Q:V8lR;P:W!U%Oi$d%O%Q%]%^%b*P*R*^*t*u.z/r0Y0[0g0h0i4V4w7|9e=p=x=yx*P$v)c*Q*r+R/q0^0_3y4^4{4|4}7f7z9v:l=b=n=oS0Y*q0Z#f<a#v$b$c$x${)w*T*W*d+c+f+},Q.a/_/h/s/u1^1a1i3Z4U4a4f5R5U5x6|7l7v8Q8f9V9n9t:S:f:t:};V;^<a<c<g<i<k<t<v<y<}=P=R=T=X=|=}n<b<^<_<b<d<h<j<l<u<w<z=O=Q=S=U=Y!d<t(s)a*Y*b.e.h.l/Y/f/v0p1]3`4S4_4c5h7R7U7m7p7}8P9i9q9w:q:u;W;];h=z={`<u3u7X7[7`9]:h:k;kS=P.g3aT=Q7Z9`!U%Qi$d%O%Q%]%^%b*P*R*^*t*u.z/r0Y0[0g0h0i4V4w7|9e=p=x=y|*R$v)c*S*q+R/b/q0^0_3y4^4s4{4|4}7f7z9v:l=b=n=oS0[*r0]#f<c#v$b$c$x${)w*T*W*d+c+f+},Q.a/_/h/s/u1^1a1i3Z4U4a4f5R5U5x6|7l7v8Q8f9V9n9t:S:f:t:};V;^<a<c<g<i<k<t<v<y<}=P=R=T=X=|=}n<d<^<_<b<d<h<j<l<u<w<z=O=Q=S=U=Y!h<v(s)a*Y*b.f.g.l/Y/f/v0p1]3^3`4S4_4c5h7R7S7U7m7p7}8P9i9q9w:q:u;W;];h=z={d<w3u7Y7Z7`9]9^:h:i:k;kS=R.h3bT=S7[9arnOXst!V!Z#d%l&g&p&r&s&u,n,s2S2VQ&d!UR,k&mrnOXst!V!Z#d%l&g&p&r&s&u,n,s2S2VR&d!UQ,T&[R1[+|snOXst!V!Z#d%l&g&p&r&s&u,n,s2S2VQ1h,YS5w1k1lU8e5u5v5zS:R8g8hS:{:Q:TQ;_:|R;i;`Q&k!VR,d&gR6T1tR:Y8nS&P|&UR1T+sQ&p!WR,n&qR,t&vT2T,s2VR,x&wQ,w&wR2^,xQ'w!{R-t'wSsOtQ#dXT%os#dQ#OTR'y#OQ#RUR'{#RQ)y$uR/Z)yQ#UVR(O#UQ#XWU(U#X(V-{Q(V#YR-{(WQ-X'WR2j-XQ.p(wS3e.p3fR3f.qQ-`'^R2n-`Y!rQ'^-`1g5qR'h!rQ.{)cR3z.{U#_W%g*WU(]#_(^-|Q(^#`R-|(XQ-['ZR2l-[t`OXst!V!Z#d%l&g&i&p&r&s&u,n,s2S2VS#hZ%dU#r`#h.VR.V(hQ(i#jQ.S(eW.[(i.S3P6wQ3P.TR6w3QQ)l$lR/R)lQ$phR)r$pQ$`cU)_$`-w<[Q-w;xR<[)oQ/l*ZW4Y/l4Z7j9hU4Z/m/n/oS7j4[4]R9h7k$e*O$v(s)a)c*Y*b*q*r*|*}+R.g.h.j.k.l/Y/b/d/f/q/v0^0_0p1]3^3_3`3u3y4S4^4_4c4s4u4{4|4}5h7R7S7T7U7Z7[7^7_7`7f7m7p7z7}8P9]9^9_9i9q9v9w:h:i:j:k:l:q:u;W;];h;k=b=n=o=z={Q/t*bU4b/t4d7nQ4d/vR7n4cS*l$|*XR0S*lx*Q$v)c*q*r+R/q0^0_3y4^4{4|4}7f7z9v:l=b=n=o!d.e(s)a*Y*b.g.h.l/Y/f/v0p1]3`4S4_4c5h7R7U7m7p7}8P9i9q9w:q:u;W;];h=z={U/c*Q.e7Xa7X3u7Z7[7`9]:h:k;kQ0Z*qQ3a.gU4t0Z3a9`R9`7Z|*S$v)c*q*r+R/b/q0^0_3y4^4s4{4|4}7f7z9v:l=b=n=o!h.f(s)a*Y*b.g.h.l/Y/f/v0p1]3^3`4S4_4c5h7R7S7U7m7p7}8P9i9q9w:q:u;W;];h=z={U/e*S.f7Ye7Y3u7Z7[7`9]9^:h:i:k;kQ0]*rQ3b.hU4v0]3b9aR9a7[Q*w%UR0a*wQ5S0pR8O5SQ+[%jR0o+[Q5l1bS8_5l:OR:O8`Q,V&]R1e,VQ5q1gR8b5qQ1s,aS6R1s8oR8o6TQ1O+oW5_1O5a8V9zQ5a1RQ8V5`R9z8WQ+t&PR1U+tQ2V,sR6c2VYrOXst#dQ&t!ZQ+^%lQ,m&pQ,o&rQ,p&sQ,r&uQ2Q,nS2T,s2VR6b2SQ%npQ&x!_Q&{!aQ&}!bQ'P!cQ'o!uQ+]%kQ+i%yQ+{&VQ,c&kQ,z&zW-k'i'q'r'uQ-r'mQ0R*kQ0y+jS1v,d,gQ2_,yQ2`,|Q2a,}Q2u-jW2w-m-n-q-sQ5W0zQ5d1XQ5g1]Q5{1mQ6V1xQ6a2RU6p2v2y2|Q6s2zQ8R5XQ8Z5fQ8[5hQ8a5pQ8j5|Q8p6US9P6q6uQ9R6tQ9{8XQ:U8kQ:Z8qQ:b9QQ:x9|Q;O:VQ;S:cR;a;PQ%yyQ'b!iQ'm!uU+j%z%{%|Q-R'TU-f'c'd'eS-j'i'sQ/z*gS0z+k+lQ2g-TS2s-g-hQ2z-oS4g/{0OQ5X0{Q6l2mQ6o2tQ6t2{U7q4i4j4mQ9o7sR:r9pS$wi=pR*x%VU%Ui%V=pR0`*vQ$viS(s#v+fS)a$b$cQ)c$dQ*Y$xS*b${*WQ*q%OQ*r%QQ*|%]Q*}%^Q+R%bQ.g<aQ.h<cQ.j<gQ.k<iQ.l<kQ/Y)wQ/b*PQ/d*RQ/f*TQ/q*^S/v*d/hQ0^*tQ0_*ul0p+c,Q.a1a1i3Z5x6|8f9V:S:f:};VQ1]+}Q3^<tQ3_<vQ3`<yS3u<^<_Q3y.zS4S/_4UQ4^/rQ4_/sQ4c/uQ4s0YQ4u0[Q4{0gQ4|0hQ4}0iQ5h1^Q7R<}Q7S=PQ7T=RQ7U=TQ7Z<bQ7[<dQ7^<hQ7_<jQ7`<lQ7f4VQ7m4aQ7p4fQ7z4wQ7}5RQ8P5UQ9]<zQ9^<uQ9_<wQ9i7lQ9q7vQ9v7|Q9w8QQ:h=OQ:i=QQ:j=SQ:k=UQ:l9eQ:q9nQ:u9tQ;W=XQ;]:tQ;h;^Q;k=YQ=b=pQ=n=xQ=o=yQ=z=|R={=}Q*z%[Q.i<eR7]<fnpOXst!Z#d%l&p&r&s&u,n,s2S2VQ!fPS#fZ#oQ&z!`W'f!o*f0V4qQ'}#SQ)O#{Q)p$nS,g&i&lQ,l&mQ,y&yS-O'R/iQ-b'`Q.s(|Q/V)qQ0m+YQ0s+dQ2O,kQ2q-dQ3X.bQ4O/QQ4y0dQ5v1jQ6X1zQ6Y1{Q6^1}Q6`2PQ6e2XQ7P3[Q7c3{Q8h5yQ8t6ZQ8u6[Q8w6_Q9Z7QQ:T8iR:_8x#[cOPXZst!Z!`!o#d#o#{%l&i&l&m&p&r&s&u&y'R'`(|*f+Y+d,k,n,s-d.b/i0V0d1j1z1{1}2P2S2V2X3[4q5y6Z6[6_7Q8i8xQ#YWQ#eYQ%puQ%rvS%tw!gS(Q#W(TQ(W#ZQ(r#uQ(w#xQ)P$OQ)Q$PQ)R$QQ)S$RQ)T$SQ)U$TQ)V$UQ)W$VQ)X$WQ)Y$XQ)[$ZQ)^$_Q)`$aQ)e$eW)o$n)q/Q3{Q+a%sQ+u&QS-U'V2hQ-s'pS-x(R-zQ-}(ZQ.P(bQ.n(vQ.q(xQ.u;vQ.w;yQ.x;zQ.y;}Q/]){Q0j+UQ2c-PQ2f-SQ2v-lQ2}.QQ3c.oQ3h<OQ3i<PQ3j<QQ3k<RQ3l<SQ3m<TQ3n<UQ3o<VQ3p<WQ3q<XQ3r<YQ3s.vQ3t<]Q3w<`Q3x<mQ4P<ZQ5O0lQ5Y0|Q6k<pQ6q2xQ6v3OQ7V3dQ7W<qQ7a<sQ7b<{Q8`5mQ8|6iQ9Q6rQ9[<|Q9b=VQ9c=WQ:c9SQ:y9}Q;R:aQ;x#SR=g=sR#[WR'X!el!tQ!r!v!y!z'^'j'k'l-`-p1g5q5sS'T!e-WU*g$|*X*lS-T'U']S0O*h*nQ0W*oQ2m-^Q4m0UR4r0XR(y#xQ!fQT-_'^-`]!qQ!r'^-`1g5qQ#p]R'g;wR)d$dY!uQ'^-`1g5qQ'i!rS's!v!yS'u!z5sS-o'j'kQ-q'lR2{-pT#kZ%dS#jZ%dS%jm,jU(e#h#i#lS.T(f(gQ.X(hQ0n+ZQ3Q.UU3R.V.W.YS6x3S3TR9T6yd#^W#W#Z%g(R([*W+W.O/hr#gZm#h#i#l%d(f(g(h+Z.U.V.W.Y3S3T6yS*Z$x*_Q/o*[Q1|,jQ2d-QQ4W/kQ6g2[Q7i4XQ8{6hT=_'V+XV#aW%g*WU#`W%g*WS(S#W([U(X#Z+W/hS-V'V+XT-y(R.OV'[!e%h*XQ$lfR)v$qT)k$l)lR3}/PT*]$x*_T*e${*WQ0q+cQ1_,QQ3V.aQ5j1aQ5u1iQ6}3ZQ8g5xQ9W6|Q:Q8fQ:d9VQ:|:SQ;U:fQ;`:}R;c;VnqOXst!Z#d%l&p&r&s&u,n,s2S2VQ&j!VR,c&gtmOXst!U!V!Z#d%l&g&p&r&s&u,n,s2S2VR,j&mT%km,jR1c,SR,b&eQ&T|R+z&UR+p&OT&n!W&qT&o!W&qT2U,s2V",nodeNames:" ArithOp ArithOp ?. JSXStartTag LineComment BlockComment Script Hashbang ExportDeclaration export Star as VariableName String Escape from ; default FunctionDeclaration async function VariableDefinition > < TypeParamList const TypeDefinition extends ThisType this LiteralType ArithOp Number BooleanLiteral TemplateType InterpolationEnd Interpolation InterpolationStart NullType null VoidType void TypeofType typeof MemberExpression . PropertyName [ TemplateString Escape Interpolation super RegExp ] ArrayExpression Spread , } { ObjectExpression Property async get set PropertyDefinition Block : NewTarget new NewExpression ) ( ArgList UnaryExpression delete LogicOp BitOp YieldExpression yield AwaitExpression await ParenthesizedExpression ClassExpression class ClassBody MethodDeclaration Decorator @ MemberExpression PrivatePropertyName CallExpression TypeArgList CompareOp < declare Privacy static abstract override PrivatePropertyDefinition PropertyDeclaration readonly accessor Optional TypeAnnotation Equals StaticBlock FunctionExpression ArrowFunction ParamList ParamList ArrayPattern ObjectPattern PatternProperty Privacy readonly Arrow MemberExpression BinaryExpression ArithOp ArithOp ArithOp ArithOp BitOp CompareOp instanceof satisfies in CompareOp BitOp BitOp BitOp LogicOp LogicOp ConditionalExpression LogicOp LogicOp AssignmentExpression UpdateOp PostfixExpression CallExpression InstantiationExpression TaggedTemplateExpression DynamicImport import ImportMeta JSXElement JSXSelfCloseEndTag JSXSelfClosingTag JSXIdentifier JSXBuiltin JSXIdentifier JSXNamespacedName JSXMemberExpression JSXSpreadAttribute JSXAttribute JSXAttributeValue JSXEscape JSXEndTag JSXOpenTag JSXFragmentTag JSXText JSXEscape JSXStartCloseTag JSXCloseTag PrefixCast < ArrowFunction TypeParamList SequenceExpression InstantiationExpression KeyofType keyof UniqueType unique ImportType InferredType infer TypeName ParenthesizedType FunctionSignature ParamList NewSignature IndexedType TupleType Label ArrayType ReadonlyType ObjectType MethodType PropertyType IndexSignature PropertyDefinition CallSignature TypePredicate asserts is NewSignature new UnionType LogicOp IntersectionType LogicOp ConditionalType ParameterizedType ClassDeclaration abstract implements type VariableDeclaration let var using TypeAliasDeclaration InterfaceDeclaration interface EnumDeclaration enum EnumBody NamespaceDeclaration namespace module AmbientDeclaration declare GlobalDeclaration global ClassDeclaration ClassBody AmbientFunctionDeclaration ExportGroup VariableName VariableName ImportDeclaration ImportGroup ForStatement for ForSpec ForInSpec ForOfSpec of WhileStatement while WithStatement with DoStatement do IfStatement if else SwitchStatement switch SwitchBody CaseLabel case DefaultLabel TryStatement try CatchClause catch FinallyClause finally ReturnStatement return ThrowStatement throw BreakStatement break ContinueStatement continue DebuggerStatement debugger LabeledStatement ExpressionStatement SingleExpression SingleClassItem",maxTerm:378,context:kK,nodeProps:[["isolate",-8,5,6,14,35,37,49,51,53,""],["group",-26,9,17,19,66,206,210,214,215,217,220,223,233,235,241,243,245,247,250,256,262,264,266,268,270,272,273,"Statement",-34,13,14,30,33,34,40,49,52,53,55,60,68,70,74,78,80,82,83,108,109,118,119,135,138,140,141,142,143,144,146,147,166,168,170,"Expression",-23,29,31,35,39,41,43,172,174,176,177,179,180,181,183,184,185,187,188,189,200,202,204,205,"Type",-3,86,101,107,"ClassItem"],["openedBy",23,"<",36,"InterpolationStart",54,"[",58,"{",71,"(",159,"JSXStartCloseTag"],["closedBy",-2,24,167,">",38,"InterpolationEnd",48,"]",59,"}",72,")",164,"JSXEndTag"]],propSources:[PK],skippedNodes:[0,5,6,276],repeatNodeCount:37,tokenData:"$Fq07[R!bOX%ZXY+gYZ-yZ[+g[]%Z]^.c^p%Zpq+gqr/mrs3cst:_tuEruvJSvwLkwx! Yxy!'iyz!(sz{!)}{|!,q|}!.O}!O!,q!O!P!/Y!P!Q!9j!Q!R#:O!R![#<_![!]#I_!]!^#Jk!^!_#Ku!_!`$![!`!a$$v!a!b$*T!b!c$,r!c!}Er!}#O$-|#O#P$/W#P#Q$4o#Q#R$5y#R#SEr#S#T$7W#T#o$8b#o#p$<r#p#q$=h#q#r$>x#r#s$@U#s$f%Z$f$g+g$g#BYEr#BY#BZ$A`#BZ$ISEr$IS$I_$A`$I_$I|Er$I|$I}$Dk$I}$JO$Dk$JO$JTEr$JT$JU$A`$JU$KVEr$KV$KW$A`$KW&FUEr&FU&FV$A`&FV;'SEr;'S;=`I|<%l?HTEr?HT?HU$A`?HUOEr(n%d_$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z&j&hT$h&jO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c&j&zP;=`<%l&c'|'U]$h&j(X!bOY&}YZ&cZw&}wx&cx!^&}!^!_'}!_#O&}#O#P&c#P#o&}#o#p'}#p;'S&};'S;=`(l<%lO&}!b(SU(X!bOY'}Zw'}x#O'}#P;'S'};'S;=`(f<%lO'}!b(iP;=`<%l'}'|(oP;=`<%l&}'[(y]$h&j(UpOY(rYZ&cZr(rrs&cs!^(r!^!_)r!_#O(r#O#P&c#P#o(r#o#p)r#p;'S(r;'S;=`*a<%lO(rp)wU(UpOY)rZr)rs#O)r#P;'S)r;'S;=`*Z<%lO)rp*^P;=`<%l)r'[*dP;=`<%l(r#S*nX(Up(X!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g#S+^P;=`<%l*g(n+dP;=`<%l%Z07[+rq$h&j(Up(X!b'z0/lOX%ZXY+gYZ&cZ[+g[p%Zpq+gqr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p$f%Z$f$g+g$g#BY%Z#BY#BZ+g#BZ$IS%Z$IS$I_+g$I_$JT%Z$JT$JU+g$JU$KV%Z$KV$KW+g$KW&FU%Z&FU&FV+g&FV;'S%Z;'S;=`+a<%l?HT%Z?HT?HU+g?HUO%Z07[.ST(V#S$h&j'{0/lO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c07[.n_$h&j(Up(X!b'{0/lOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z)3p/x`$h&j!n),Q(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`0z!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW1V`#u(Ch$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`2X!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW2d_#u(Ch$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'At3l_(T':f$h&j(X!bOY4kYZ5qZr4krs7nsw4kwx5qx!^4k!^!_8p!_#O4k#O#P5q#P#o4k#o#p8p#p;'S4k;'S;=`:X<%lO4k(^4r_$h&j(X!bOY4kYZ5qZr4krs7nsw4kwx5qx!^4k!^!_8p!_#O4k#O#P5q#P#o4k#o#p8p#p;'S4k;'S;=`:X<%lO4k&z5vX$h&jOr5qrs6cs!^5q!^!_6y!_#o5q#o#p6y#p;'S5q;'S;=`7h<%lO5q&z6jT$c`$h&jO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c`6|TOr6yrs7]s;'S6y;'S;=`7b<%lO6y`7bO$c``7eP;=`<%l6y&z7kP;=`<%l5q(^7w]$c`$h&j(X!bOY&}YZ&cZw&}wx&cx!^&}!^!_'}!_#O&}#O#P&c#P#o&}#o#p'}#p;'S&};'S;=`(l<%lO&}!r8uZ(X!bOY8pYZ6yZr8prs9hsw8pwx6yx#O8p#O#P6y#P;'S8p;'S;=`:R<%lO8p!r9oU$c`(X!bOY'}Zw'}x#O'}#P;'S'};'S;=`(f<%lO'}!r:UP;=`<%l8p(^:[P;=`<%l4k%9[:hh$h&j(Up(X!bOY%ZYZ&cZq%Zqr<Srs&}st%ZtuCruw%Zwx(rx!^%Z!^!_*g!_!c%Z!c!}Cr!}#O%Z#O#P&c#P#R%Z#R#SCr#S#T%Z#T#oCr#o#p*g#p$g%Z$g;'SCr;'S;=`El<%lOCr(r<__WS$h&j(Up(X!bOY<SYZ&cZr<Srs=^sw<Swx@nx!^<S!^!_Bm!_#O<S#O#P>`#P#o<S#o#pBm#p;'S<S;'S;=`Cl<%lO<S(Q=g]WS$h&j(X!bOY=^YZ&cZw=^wx>`x!^=^!^!_?q!_#O=^#O#P>`#P#o=^#o#p?q#p;'S=^;'S;=`@h<%lO=^&n>gXWS$h&jOY>`YZ&cZ!^>`!^!_?S!_#o>`#o#p?S#p;'S>`;'S;=`?k<%lO>`S?XSWSOY?SZ;'S?S;'S;=`?e<%lO?SS?hP;=`<%l?S&n?nP;=`<%l>`!f?xWWS(X!bOY?qZw?qwx?Sx#O?q#O#P?S#P;'S?q;'S;=`@b<%lO?q!f@eP;=`<%l?q(Q@kP;=`<%l=^'`@w]WS$h&j(UpOY@nYZ&cZr@nrs>`s!^@n!^!_Ap!_#O@n#O#P>`#P#o@n#o#pAp#p;'S@n;'S;=`Bg<%lO@ntAwWWS(UpOYApZrAprs?Ss#OAp#O#P?S#P;'SAp;'S;=`Ba<%lOAptBdP;=`<%lAp'`BjP;=`<%l@n#WBvYWS(Up(X!bOYBmZrBmrs?qswBmwxApx#OBm#O#P?S#P;'SBm;'S;=`Cf<%lOBm#WCiP;=`<%lBm(rCoP;=`<%l<S%9[C}i$h&j(m%1l(Up(X!bOY%ZYZ&cZr%Zrs&}st%ZtuCruw%Zwx(rx!Q%Z!Q![Cr![!^%Z!^!_*g!_!c%Z!c!}Cr!}#O%Z#O#P&c#P#R%Z#R#SCr#S#T%Z#T#oCr#o#p*g#p$g%Z$g;'SCr;'S;=`El<%lOCr%9[EoP;=`<%lCr07[FRk$h&j(Up(X!b$[#t(R,2j(c$I[OY%ZYZ&cZr%Zrs&}st%ZtuEruw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Er![!^%Z!^!_*g!_!c%Z!c!}Er!}#O%Z#O#P&c#P#R%Z#R#SEr#S#T%Z#T#oEr#o#p*g#p$g%Z$g;'SEr;'S;=`I|<%lOEr+dHRk$h&j(Up(X!b$[#tOY%ZYZ&cZr%Zrs&}st%ZtuGvuw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Gv![!^%Z!^!_*g!_!c%Z!c!}Gv!}#O%Z#O#P&c#P#R%Z#R#SGv#S#T%Z#T#oGv#o#p*g#p$g%Z$g;'SGv;'S;=`Iv<%lOGv+dIyP;=`<%lGv07[JPP;=`<%lEr(KWJ_`$h&j(Up(X!b#n(ChOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KWKl_$h&j$P(Ch(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z,#xLva(x+JY$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sv%ZvwM{wx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KWNW`$h&j#y(Ch(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'At! c_(W';W$h&j(UpOY!!bYZ!#hZr!!brs!#hsw!!bwx!$xx!^!!b!^!_!%z!_#O!!b#O#P!#h#P#o!!b#o#p!%z#p;'S!!b;'S;=`!'c<%lO!!b'l!!i_$h&j(UpOY!!bYZ!#hZr!!brs!#hsw!!bwx!$xx!^!!b!^!_!%z!_#O!!b#O#P!#h#P#o!!b#o#p!%z#p;'S!!b;'S;=`!'c<%lO!!b&z!#mX$h&jOw!#hwx6cx!^!#h!^!_!$Y!_#o!#h#o#p!$Y#p;'S!#h;'S;=`!$r<%lO!#h`!$]TOw!$Ywx7]x;'S!$Y;'S;=`!$l<%lO!$Y`!$oP;=`<%l!$Y&z!$uP;=`<%l!#h'l!%R]$c`$h&j(UpOY(rYZ&cZr(rrs&cs!^(r!^!_)r!_#O(r#O#P&c#P#o(r#o#p)r#p;'S(r;'S;=`*a<%lO(r!Q!&PZ(UpOY!%zYZ!$YZr!%zrs!$Ysw!%zwx!&rx#O!%z#O#P!$Y#P;'S!%z;'S;=`!']<%lO!%z!Q!&yU$c`(UpOY)rZr)rs#O)r#P;'S)r;'S;=`*Z<%lO)r!Q!'`P;=`<%l!%z'l!'fP;=`<%l!!b/5|!'t_!j/.^$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z#&U!)O_!i!Lf$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z-!n!*[b$h&j(Up(X!b(S%&f#o(ChOY%ZYZ&cZr%Zrs&}sw%Zwx(rxz%Zz{!+d{!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW!+o`$h&j(Up(X!b#l(ChOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z+;x!,|`$h&j(Up(X!bp+4YOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z,$U!.Z_!Z+Jf$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z07[!/ec$h&j(Up(X!b!O.2^OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!0p!P!Q%Z!Q![!3Y![!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z#%|!0ya$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!2O!P!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z#%|!2Z_!Y!L^$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad!3eg$h&j(Up(X!bq'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![!3Y![!^%Z!^!_*g!_!g%Z!g!h!4|!h#O%Z#O#P&c#P#R%Z#R#S!3Y#S#X%Z#X#Y!4|#Y#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad!5Vg$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx{%Z{|!6n|}%Z}!O!6n!O!Q%Z!Q![!8S![!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S!8S#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad!6wc$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![!8S![!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S!8S#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad!8_c$h&j(Up(X!bq'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![!8S![!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S!8S#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z07[!9uf$h&j(Up(X!b#m(ChOY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcxz!;Zz{#-}{!P!;Z!P!Q#/d!Q!^!;Z!^!_#(i!_!`#7S!`!a#8i!a!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;Z?O!;fb$h&j(Up(X!b!V7`OY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcx!P!;Z!P!Q#&`!Q!^!;Z!^!_#(i!_!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;Z>^!<w`$h&j(X!b!V7`OY!<nYZ&cZw!<nwx!=yx!P!<n!P!Q!Eq!Q!^!<n!^!_!Gr!_!}!<n!}#O!KS#O#P!Dy#P#o!<n#o#p!Gr#p;'S!<n;'S;=`!L]<%lO!<n<z!>Q^$h&j!V7`OY!=yYZ&cZ!P!=y!P!Q!>|!Q!^!=y!^!_!@c!_!}!=y!}#O!CW#O#P!Dy#P#o!=y#o#p!@c#p;'S!=y;'S;=`!Ek<%lO!=y<z!?Td$h&j!V7`O!^&c!_#W&c#W#X!>|#X#Z&c#Z#[!>|#[#]&c#]#^!>|#^#a&c#a#b!>|#b#g&c#g#h!>|#h#i&c#i#j!>|#j#k!>|#k#m&c#m#n!>|#n#o&c#p;'S&c;'S;=`&w<%lO&c7`!@hX!V7`OY!@cZ!P!@c!P!Q!AT!Q!}!@c!}#O!Ar#O#P!Bq#P;'S!@c;'S;=`!CQ<%lO!@c7`!AYW!V7`#W#X!AT#Z#[!AT#]#^!AT#a#b!AT#g#h!AT#i#j!AT#j#k!AT#m#n!AT7`!AuVOY!ArZ#O!Ar#O#P!B[#P#Q!@c#Q;'S!Ar;'S;=`!Bk<%lO!Ar7`!B_SOY!ArZ;'S!Ar;'S;=`!Bk<%lO!Ar7`!BnP;=`<%l!Ar7`!BtSOY!@cZ;'S!@c;'S;=`!CQ<%lO!@c7`!CTP;=`<%l!@c<z!C][$h&jOY!CWYZ&cZ!^!CW!^!_!Ar!_#O!CW#O#P!DR#P#Q!=y#Q#o!CW#o#p!Ar#p;'S!CW;'S;=`!Ds<%lO!CW<z!DWX$h&jOY!CWYZ&cZ!^!CW!^!_!Ar!_#o!CW#o#p!Ar#p;'S!CW;'S;=`!Ds<%lO!CW<z!DvP;=`<%l!CW<z!EOX$h&jOY!=yYZ&cZ!^!=y!^!_!@c!_#o!=y#o#p!@c#p;'S!=y;'S;=`!Ek<%lO!=y<z!EnP;=`<%l!=y>^!Ezl$h&j(X!b!V7`OY&}YZ&cZw&}wx&cx!^&}!^!_'}!_#O&}#O#P&c#P#W&}#W#X!Eq#X#Z&}#Z#[!Eq#[#]&}#]#^!Eq#^#a&}#a#b!Eq#b#g&}#g#h!Eq#h#i&}#i#j!Eq#j#k!Eq#k#m&}#m#n!Eq#n#o&}#o#p'}#p;'S&};'S;=`(l<%lO&}8r!GyZ(X!b!V7`OY!GrZw!Grwx!@cx!P!Gr!P!Q!Hl!Q!}!Gr!}#O!JU#O#P!Bq#P;'S!Gr;'S;=`!J|<%lO!Gr8r!Hse(X!b!V7`OY'}Zw'}x#O'}#P#W'}#W#X!Hl#X#Z'}#Z#[!Hl#[#]'}#]#^!Hl#^#a'}#a#b!Hl#b#g'}#g#h!Hl#h#i'}#i#j!Hl#j#k!Hl#k#m'}#m#n!Hl#n;'S'};'S;=`(f<%lO'}8r!JZX(X!bOY!JUZw!JUwx!Arx#O!JU#O#P!B[#P#Q!Gr#Q;'S!JU;'S;=`!Jv<%lO!JU8r!JyP;=`<%l!JU8r!KPP;=`<%l!Gr>^!KZ^$h&j(X!bOY!KSYZ&cZw!KSwx!CWx!^!KS!^!_!JU!_#O!KS#O#P!DR#P#Q!<n#Q#o!KS#o#p!JU#p;'S!KS;'S;=`!LV<%lO!KS>^!LYP;=`<%l!KS>^!L`P;=`<%l!<n=l!Ll`$h&j(Up!V7`OY!LcYZ&cZr!Lcrs!=ys!P!Lc!P!Q!Mn!Q!^!Lc!^!_# o!_!}!Lc!}#O#%P#O#P!Dy#P#o!Lc#o#p# o#p;'S!Lc;'S;=`#&Y<%lO!Lc=l!Mwl$h&j(Up!V7`OY(rYZ&cZr(rrs&cs!^(r!^!_)r!_#O(r#O#P&c#P#W(r#W#X!Mn#X#Z(r#Z#[!Mn#[#](r#]#^!Mn#^#a(r#a#b!Mn#b#g(r#g#h!Mn#h#i(r#i#j!Mn#j#k!Mn#k#m(r#m#n!Mn#n#o(r#o#p)r#p;'S(r;'S;=`*a<%lO(r8Q# vZ(Up!V7`OY# oZr# ors!@cs!P# o!P!Q#!i!Q!}# o!}#O#$R#O#P!Bq#P;'S# o;'S;=`#$y<%lO# o8Q#!pe(Up!V7`OY)rZr)rs#O)r#P#W)r#W#X#!i#X#Z)r#Z#[#!i#[#])r#]#^#!i#^#a)r#a#b#!i#b#g)r#g#h#!i#h#i)r#i#j#!i#j#k#!i#k#m)r#m#n#!i#n;'S)r;'S;=`*Z<%lO)r8Q#$WX(UpOY#$RZr#$Rrs!Ars#O#$R#O#P!B[#P#Q# o#Q;'S#$R;'S;=`#$s<%lO#$R8Q#$vP;=`<%l#$R8Q#$|P;=`<%l# o=l#%W^$h&j(UpOY#%PYZ&cZr#%Prs!CWs!^#%P!^!_#$R!_#O#%P#O#P!DR#P#Q!Lc#Q#o#%P#o#p#$R#p;'S#%P;'S;=`#&S<%lO#%P=l#&VP;=`<%l#%P=l#&]P;=`<%l!Lc?O#&kn$h&j(Up(X!b!V7`OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#W%Z#W#X#&`#X#Z%Z#Z#[#&`#[#]%Z#]#^#&`#^#a%Z#a#b#&`#b#g%Z#g#h#&`#h#i%Z#i#j#&`#j#k#&`#k#m%Z#m#n#&`#n#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z9d#(r](Up(X!b!V7`OY#(iZr#(irs!Grsw#(iwx# ox!P#(i!P!Q#)k!Q!}#(i!}#O#+`#O#P!Bq#P;'S#(i;'S;=`#,`<%lO#(i9d#)th(Up(X!b!V7`OY*gZr*grs'}sw*gwx)rx#O*g#P#W*g#W#X#)k#X#Z*g#Z#[#)k#[#]*g#]#^#)k#^#a*g#a#b#)k#b#g*g#g#h#)k#h#i*g#i#j#)k#j#k#)k#k#m*g#m#n#)k#n;'S*g;'S;=`+Z<%lO*g9d#+gZ(Up(X!bOY#+`Zr#+`rs!JUsw#+`wx#$Rx#O#+`#O#P!B[#P#Q#(i#Q;'S#+`;'S;=`#,Y<%lO#+`9d#,]P;=`<%l#+`9d#,cP;=`<%l#(i?O#,o`$h&j(Up(X!bOY#,fYZ&cZr#,frs!KSsw#,fwx#%Px!^#,f!^!_#+`!_#O#,f#O#P!DR#P#Q!;Z#Q#o#,f#o#p#+`#p;'S#,f;'S;=`#-q<%lO#,f?O#-tP;=`<%l#,f?O#-zP;=`<%l!;Z07[#.[b$h&j(Up(X!b'|0/l!V7`OY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcx!P!;Z!P!Q#&`!Q!^!;Z!^!_#(i!_!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;Z07[#/o_$h&j(Up(X!bT0/lOY#/dYZ&cZr#/drs#0nsw#/dwx#4Ox!^#/d!^!_#5}!_#O#/d#O#P#1p#P#o#/d#o#p#5}#p;'S#/d;'S;=`#6|<%lO#/d06j#0w]$h&j(X!bT0/lOY#0nYZ&cZw#0nwx#1px!^#0n!^!_#3R!_#O#0n#O#P#1p#P#o#0n#o#p#3R#p;'S#0n;'S;=`#3x<%lO#0n05W#1wX$h&jT0/lOY#1pYZ&cZ!^#1p!^!_#2d!_#o#1p#o#p#2d#p;'S#1p;'S;=`#2{<%lO#1p0/l#2iST0/lOY#2dZ;'S#2d;'S;=`#2u<%lO#2d0/l#2xP;=`<%l#2d05W#3OP;=`<%l#1p01O#3YW(X!bT0/lOY#3RZw#3Rwx#2dx#O#3R#O#P#2d#P;'S#3R;'S;=`#3r<%lO#3R01O#3uP;=`<%l#3R06j#3{P;=`<%l#0n05x#4X]$h&j(UpT0/lOY#4OYZ&cZr#4Ors#1ps!^#4O!^!_#5Q!_#O#4O#O#P#1p#P#o#4O#o#p#5Q#p;'S#4O;'S;=`#5w<%lO#4O00^#5XW(UpT0/lOY#5QZr#5Qrs#2ds#O#5Q#O#P#2d#P;'S#5Q;'S;=`#5q<%lO#5Q00^#5tP;=`<%l#5Q05x#5zP;=`<%l#4O01p#6WY(Up(X!bT0/lOY#5}Zr#5}rs#3Rsw#5}wx#5Qx#O#5}#O#P#2d#P;'S#5};'S;=`#6v<%lO#5}01p#6yP;=`<%l#5}07[#7PP;=`<%l#/d)3h#7ab$h&j$P(Ch(Up(X!b!V7`OY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcx!P!;Z!P!Q#&`!Q!^!;Z!^!_#(i!_!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;ZAt#8vb$Y#t$h&j(Up(X!b!V7`OY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcx!P!;Z!P!Q#&`!Q!^!;Z!^!_#(i!_!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;Z'Ad#:Zp$h&j(Up(X!bq'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!3Y!P!Q%Z!Q![#<_![!^%Z!^!_*g!_!g%Z!g!h!4|!h#O%Z#O#P&c#P#R%Z#R#S#<_#S#U%Z#U#V#?i#V#X%Z#X#Y!4|#Y#b%Z#b#c#>_#c#d#Bq#d#l%Z#l#m#Es#m#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#<jk$h&j(Up(X!bq'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!3Y!P!Q%Z!Q![#<_![!^%Z!^!_*g!_!g%Z!g!h!4|!h#O%Z#O#P&c#P#R%Z#R#S#<_#S#X%Z#X#Y!4|#Y#b%Z#b#c#>_#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#>j_$h&j(Up(X!bq'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#?rd$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!R#AQ!R!S#AQ!S!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#AQ#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#A]f$h&j(Up(X!bq'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!R#AQ!R!S#AQ!S!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#AQ#S#b%Z#b#c#>_#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#Bzc$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!Y#DV!Y!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#DV#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#Dbe$h&j(Up(X!bq'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!Y#DV!Y!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#DV#S#b%Z#b#c#>_#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#E|g$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![#Ge![!^%Z!^!_*g!_!c%Z!c!i#Ge!i#O%Z#O#P&c#P#R%Z#R#S#Ge#S#T%Z#T#Z#Ge#Z#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#Gpi$h&j(Up(X!bq'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![#Ge![!^%Z!^!_*g!_!c%Z!c!i#Ge!i#O%Z#O#P&c#P#R%Z#R#S#Ge#S#T%Z#T#Z#Ge#Z#b%Z#b#c#>_#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z*)x#Il_!e$b$h&j#})Lv(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z)[#Jv_al$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z04f#LS^h#)`#P-<U(Up(X!b$m7`OY*gZr*grs'}sw*gwx)rx!P*g!P!Q#MO!Q!^*g!^!_#Mt!_!`$ f!`#O*g#P;'S*g;'S;=`+Z<%lO*g(n#MXX$j&j(Up(X!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g(El#M}Z#p(Ch(Up(X!bOY*gZr*grs'}sw*gwx)rx!_*g!_!`#Np!`#O*g#P;'S*g;'S;=`+Z<%lO*g(El#NyX$P(Ch(Up(X!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g(El$ oX#q(Ch(Up(X!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g*)x$!ga#^*!Y$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`0z!`!a$#l!a#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(K[$#w_#i(Cl$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z*)x$%Vag!*r#q(Ch$e#|$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`$&[!`!a$'f!a#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$&g_#q(Ch$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$'qa#p(Ch$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`!a$(v!a#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$)R`#p(Ch$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(Kd$*`a(p(Ct$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!a%Z!a!b$+e!b#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$+p`$h&j#z(Ch(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#`$,}_!z$Ip$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z04f$.X_!Q0,v$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(n$/]Z$h&jO!^$0O!^!_$0f!_#i$0O#i#j$0k#j#l$0O#l#m$2^#m#o$0O#o#p$0f#p;'S$0O;'S;=`$4i<%lO$0O(n$0VT_#S$h&jO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c#S$0kO_#S(n$0p[$h&jO!Q&c!Q![$1f![!^&c!_!c&c!c!i$1f!i#T&c#T#Z$1f#Z#o&c#o#p$3|#p;'S&c;'S;=`&w<%lO&c(n$1kZ$h&jO!Q&c!Q![$2^![!^&c!_!c&c!c!i$2^!i#T&c#T#Z$2^#Z#o&c#p;'S&c;'S;=`&w<%lO&c(n$2cZ$h&jO!Q&c!Q![$3U![!^&c!_!c&c!c!i$3U!i#T&c#T#Z$3U#Z#o&c#p;'S&c;'S;=`&w<%lO&c(n$3ZZ$h&jO!Q&c!Q![$0O![!^&c!_!c&c!c!i$0O!i#T&c#T#Z$0O#Z#o&c#p;'S&c;'S;=`&w<%lO&c#S$4PR!Q![$4Y!c!i$4Y#T#Z$4Y#S$4]S!Q![$4Y!c!i$4Y#T#Z$4Y#q#r$0f(n$4lP;=`<%l$0O#1[$4z_!W#)l$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$6U`#w(Ch$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z+;p$7c_$h&j(Up(X!b(_+4QOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z07[$8qk$h&j(Up(X!b(R,2j$^#t(c$I[OY%ZYZ&cZr%Zrs&}st%Ztu$8buw%Zwx(rx}%Z}!O$:f!O!Q%Z!Q![$8b![!^%Z!^!_*g!_!c%Z!c!}$8b!}#O%Z#O#P&c#P#R%Z#R#S$8b#S#T%Z#T#o$8b#o#p*g#p$g%Z$g;'S$8b;'S;=`$<l<%lO$8b+d$:qk$h&j(Up(X!b$^#tOY%ZYZ&cZr%Zrs&}st%Ztu$:fuw%Zwx(rx}%Z}!O$:f!O!Q%Z!Q![$:f![!^%Z!^!_*g!_!c%Z!c!}$:f!}#O%Z#O#P&c#P#R%Z#R#S$:f#S#T%Z#T#o$:f#o#p*g#p$g%Z$g;'S$:f;'S;=`$<f<%lO$:f+d$<iP;=`<%l$:f07[$<oP;=`<%l$8b#Jf$<{X!]#Hb(Up(X!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g,#x$=sa(w+JY$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p#q$+e#q;'S%Z;'S;=`+a<%lO%Z)>v$?V_![(CdtBr$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z?O$@a_!o7`$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z07[$Aq|$h&j(Up(X!b'z0/l$[#t(R,2j(c$I[OX%ZXY+gYZ&cZ[+g[p%Zpq+gqr%Zrs&}st%ZtuEruw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Er![!^%Z!^!_*g!_!c%Z!c!}Er!}#O%Z#O#P&c#P#R%Z#R#SEr#S#T%Z#T#oEr#o#p*g#p$f%Z$f$g+g$g#BYEr#BY#BZ$A`#BZ$ISEr$IS$I_$A`$I_$JTEr$JT$JU$A`$JU$KVEr$KV$KW$A`$KW&FUEr&FU&FV$A`&FV;'SEr;'S;=`I|<%l?HTEr?HT?HU$A`?HUOEr07[$D|k$h&j(Up(X!b'{0/l$[#t(R,2j(c$I[OY%ZYZ&cZr%Zrs&}st%ZtuEruw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Er![!^%Z!^!_*g!_!c%Z!c!}Er!}#O%Z#O#P&c#P#R%Z#R#SEr#S#T%Z#T#oEr#o#p*g#p$g%Z$g;'SEr;'S;=`I|<%lOEr",tokenizers:[TK,CK,AK,EK,2,3,4,5,6,7,8,9,10,11,12,13,14,SK,new i1("$S~RRtu[#O#Pg#S#T#|~_P#o#pb~gOv~~jVO#i!P#i#j!U#j#l!P#l#m!q#m;'S!P;'S;=`#v<%lO!P~!UO!S~~!XS!Q![!e!c!i!e#T#Z!e#o#p#Z~!hR!Q![!q!c!i!q#T#Z!q~!tR!Q![!}!c!i!}#T#Z!}~#QR!Q![!P!c!i!P#T#Z!P~#^R!Q![#g!c!i#g#T#Z#g~#jS!Q![#g!c!i#g#T#Z#g#q#r!P~#yP;=`<%l!P~$RO(a~~",141,338),new i1("j~RQYZXz{^~^O(O~~aP!P!Qd~iO(P~~",25,321)],topRules:{Script:[0,7],SingleExpression:[1,274],SingleClassItem:[2,275]},dialects:{jsx:0,ts:15091},dynamicPrecedences:{78:1,80:1,92:1,168:1,198:1},specialized:[{term:325,get:r=>RK[r]||-1},{term:341,get:r=>QK[r]||-1},{term:93,get:r=>FK[r]||-1}],tokenPrec:15116}),DK=1024;let NK=0,qp=class{constructor(e,t){this.from=e,this.to=t}},er=class{constructor(e={}){this.id=NK++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof e!="function"&&(e=Rs.match(e)),t=>{let n=e(t);return n===void 0?null:[this,n]}}};er.closedBy=new er({deserialize:r=>r.split(" ")});er.openedBy=new er({deserialize:r=>r.split(" ")});er.group=new er({deserialize:r=>r.split(" ")});er.isolate=new er({deserialize:r=>{if(r&&r!="rtl"&&r!="ltr"&&r!="auto")throw new RangeError("Invalid value for isolate: "+r);return r||"auto"}});er.contextHash=new er({perNode:!0});er.lookAhead=new er({perNode:!0});er.mounted=new er({perNode:!0});let t0=class{constructor(e,t,n){this.tree=e,this.overlay=t,this.parser=n}static get(e){return e&&e.props&&e.props[er.mounted.id]}};const MK=Object.create(null);let Rs=class PE{constructor(e,t,n,i=0){this.name=e,this.props=t,this.id=n,this.flags=i}static define(e){let t=e.props&&e.props.length?Object.create(null):MK,n=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(e.name==null?8:0),i=new PE(e.name||"",t,e.id,n);if(e.props){for(let s of e.props)if(Array.isArray(s)||(s=s(i)),s){if(s[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");t[s[0].id]=s[1]}}return i}prop(e){return this.props[e.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(e){if(typeof e=="string"){if(this.name==e)return!0;let t=this.prop(er.group);return t?t.indexOf(e)>-1:!1}return this.id==e}static match(e){let t=Object.create(null);for(let n in e)for(let i of n.split(" "))t[i]=e[n];return n=>{for(let i=n.prop(er.group),s=-1;s<(i?i.length:0);s++){let a=t[s<0?n.name:i[s]];if(a)return a}}}};Rs.none=new Rs("",Object.create(null),0,8);const xu=new WeakMap,l_=new WeakMap;var Yr;(function(r){r[r.ExcludeBuffers=1]="ExcludeBuffers",r[r.IncludeAnonymous=2]="IncludeAnonymous",r[r.IgnoreMounts=4]="IgnoreMounts",r[r.IgnoreOverlays=8]="IgnoreOverlays"})(Yr||(Yr={}));let hi=class o1{constructor(e,t,n,i,s){if(this.type=e,this.children=t,this.positions=n,this.length=i,this.props=null,s&&s.length){this.props=Object.create(null);for(let[a,o]of s)this.props[typeof a=="number"?a:a.id]=o}}toString(){let e=t0.get(this);if(e&&!e.overlay)return e.tree.toString();let t="";for(let n of this.children){let i=n.toString();i&&(t&&(t+=","),t+=i)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(t.length?"("+t+")":""):t}cursor(e=0){return new f1(this.topNode,e)}cursorAt(e,t=0,n=0){let i=xu.get(this)||this.topNode,s=new f1(i);return s.moveTo(e,t),xu.set(this,s._tree),s}get topNode(){return new Qs(this,0,0,null)}resolve(e,t=0){let n=Yc(xu.get(this)||this.topNode,e,t,!1);return xu.set(this,n),n}resolveInner(e,t=0){let n=Yc(l_.get(this)||this.topNode,e,t,!0);return l_.set(this,n),n}resolveStack(e,t=0){return ZK(this,e,t)}iterate(e){let{enter:t,leave:n,from:i=0,to:s=this.length}=e,a=e.mode||0,o=(a&Yr.IncludeAnonymous)>0;for(let l=this.cursor(a|Yr.IncludeAnonymous);;){let f=!1;if(l.from<=s&&l.to>=i&&(!o&&l.type.isAnonymous||t(l)!==!1)){if(l.firstChild())continue;f=!0}for(;f&&n&&(o||!l.type.isAnonymous)&&n(l),!l.nextSibling();){if(!l.parent())return;f=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let t in this.props)e.push([+t,this.props[t]]);return e}balance(e={}){return this.children.length<=8?this:Mx(Rs.none,this.children,this.positions,0,this.children.length,0,this.length,(t,n,i)=>new o1(this.type,t,n,i,this.propValues),e.makeTree||((t,n,i)=>new o1(Rs.none,t,n,i)))}static build(e){return WK(e)}};hi.empty=new hi(Rs.none,[],[],0);let IK=class RE{constructor(e,t){this.buffer=e,this.index=t}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new RE(this.buffer,this.index)}},Zl=class QE{constructor(e,t,n){this.buffer=e,this.length=t,this.set=n}get type(){return Rs.none}toString(){let e=[];for(let t=0;t<this.buffer.length;)e.push(this.childString(t)),t=this.buffer[t+3];return e.join(",")}childString(e){let t=this.buffer[e],n=this.buffer[e+3],i=this.set.types[t],s=i.name;if(/\W/.test(s)&&!i.isError&&(s=JSON.stringify(s)),e+=4,n==e)return s;let a=[];for(;e<n;)a.push(this.childString(e)),e=this.buffer[e+3];return s+"("+a.join(",")+")"}findChild(e,t,n,i,s){let{buffer:a}=this,o=-1;for(let l=e;l!=t&&!(FE(s,i,a[l+1],a[l+2])&&(o=l,n>0));l=a[l+3]);return o}slice(e,t,n){let i=this.buffer,s=new Uint16Array(t-e),a=0;for(let o=e,l=0;o<t;){s[l++]=i[o++],s[l++]=i[o++]-n;let f=s[l++]=i[o++]-n;s[l++]=i[o++]-e,a=Math.max(a,f)}return new QE(s,a,this.set)}};function FE(r,e,t,n){switch(r){case-2:return t<e;case-1:return n>=e&&t<e;case 0:return t<e&&n>e;case 1:return t<=e&&n>e;case 2:return n>e;case 4:return!0}}function Yc(r,e,t,n){for(var i;r.from==r.to||(t<1?r.from>=e:r.from>e)||(t>-1?r.to<=e:r.to<e);){let a=!n&&r instanceof Qs&&r.index<0?null:r.parent;if(!a)return r;r=a}let s=n?0:Yr.IgnoreOverlays;if(n)for(let a=r,o=a.parent;o;a=o,o=a.parent)a instanceof Qs&&a.index<0&&((i=o.enter(e,t,s))===null||i===void 0?void 0:i.from)!=a.from&&(r=o);for(;;){let a=r.enter(e,t,s);if(!a)return r;r=a}}let $E=class{cursor(e=0){return new f1(this,e)}getChild(e,t=null,n=null){let i=f_(this,e,t,n);return i.length?i[0]:null}getChildren(e,t=null,n=null){return f_(this,e,t,n)}resolve(e,t=0){return Yc(this,e,t,!1)}resolveInner(e,t=0){return Yc(this,e,t,!0)}matchContext(e){return l1(this.parent,e)}enterUnfinishedNodesBefore(e){let t=this.childBefore(e),n=this;for(;t;){let i=t.lastChild;if(!i||i.to!=t.to)break;i.type.isError&&i.from==i.to?(n=t,t=i.prevSibling):t=i}return n}get node(){return this}get next(){return this.parent}},Qs=class zu extends $E{constructor(e,t,n,i){super(),this._tree=e,this.from=t,this.index=n,this._parent=i}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,t,n,i,s=0){for(let a=this;;){for(let{children:o,positions:l}=a._tree,f=t>0?o.length:-1;e!=f;e+=t){let c=o[e],h=l[e]+a.from;if(FE(i,n,h,h+c.length)){if(c instanceof Zl){if(s&Yr.ExcludeBuffers)continue;let u=c.findChild(0,c.buffer.length,t,n-h,i);if(u>-1)return new Kc(new LK(a,c,e,h),null,u)}else if(s&Yr.IncludeAnonymous||!c.type.isAnonymous||Nx(c)){let u;if(!(s&Yr.IgnoreMounts)&&(u=t0.get(c))&&!u.overlay)return new zu(u.tree,h,e,a);let d=new zu(c,h,e,a);return s&Yr.IncludeAnonymous||!d.type.isAnonymous?d:d.nextChild(t<0?c.children.length-1:0,t,n,i)}}}if(s&Yr.IncludeAnonymous||!a.type.isAnonymous||(a.index>=0?e=a.index+t:e=t<0?-1:a._parent._tree.children.length,a=a._parent,!a))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}enter(e,t,n=0){let i;if(!(n&Yr.IgnoreOverlays)&&(i=t0.get(this._tree))&&i.overlay){let s=e-this.from;for(let{from:a,to:o}of i.overlay)if((t>0?a<=s:a<s)&&(t<0?o>=s:o>s))return new zu(i.tree,i.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,t,n)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}};function f_(r,e,t,n){let i=r.cursor(),s=[];if(!i.firstChild())return s;if(t!=null){for(let a=!1;!a;)if(a=i.type.is(t),!i.nextSibling())return s}for(;;){if(n!=null&&i.type.is(n))return s;if(i.type.is(e)&&s.push(i.node),!i.nextSibling())return n==null?s:[]}}function l1(r,e,t=e.length-1){for(let n=r;t>=0;n=n.parent){if(!n)return!1;if(!n.type.isAnonymous){if(e[t]&&e[t]!=n.name)return!1;t--}}return!0}let LK=class{constructor(e,t,n,i){this.parent=e,this.buffer=t,this.index=n,this.start=i}},Kc=class qf extends $E{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(e,t,n){super(),this.context=e,this._parent=t,this.index=n,this.type=e.buffer.set.types[e.buffer.buffer[n]]}child(e,t,n){let{buffer:i}=this.context,s=i.findChild(this.index+4,i.buffer[this.index+3],e,t-this.context.start,n);return s<0?null:new qf(this.context,this,s)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}enter(e,t,n=0){if(n&Yr.ExcludeBuffers)return null;let{buffer:i}=this.context,s=i.findChild(this.index+4,i.buffer[this.index+3],t>0?1:-1,e-this.context.start,t);return s<0?null:new qf(this.context,this,s)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,t=e.buffer[this.index+3];return t<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new qf(this.context,this._parent,t):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,t=this._parent?this._parent.index+4:0;return this.index==t?this.externalSibling(-1):new qf(this.context,this._parent,e.findChild(t,this.index,-1,0,4))}get tree(){return null}toTree(){let e=[],t=[],{buffer:n}=this.context,i=this.index+4,s=n.buffer[this.index+3];if(s>i){let a=n.buffer[this.index+1];e.push(n.slice(i,s,a)),t.push(0)}return new hi(this.type,e,t,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}};function DE(r){if(!r.length)return null;let e=0,t=r[0];for(let s=1;s<r.length;s++){let a=r[s];(a.from>t.from||a.to<t.to)&&(t=a,e=s)}let n=t instanceof Qs&&t.index<0?null:t.parent,i=r.slice();return n?i[e]=n:i.splice(e,1),new BK(i,t)}let BK=class{constructor(e,t){this.heads=e,this.node=t}get next(){return DE(this.heads)}};function ZK(r,e,t){let n=r.resolveInner(e,t),i=null;for(let s=n instanceof Qs?n:n.context.parent;s;s=s.parent)if(s.index<0){let a=s.parent;(i||(i=[n])).push(a.resolve(e,t)),s=a}else{let a=t0.get(s.tree);if(a&&a.overlay&&a.overlay[0].from<=e&&a.overlay[a.overlay.length-1].to>=e){let o=new Qs(a.tree,a.overlay[0].from+s.from,-1,s);(i||(i=[n])).push(Yc(o,e,t,!1))}}return i?DE(i):n}let f1=class{get name(){return this.type.name}constructor(e,t=0){if(this.mode=t,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,e instanceof Qs)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let n=e._parent;n;n=n._parent)this.stack.unshift(n.index);this.bufferNode=e,this.yieldBuf(e.index)}}yieldNode(e){return e?(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0):!1}yieldBuf(e,t){this.index=e;let{start:n,buffer:i}=this.buffer;return this.type=t||i.set.types[i.buffer[e]],this.from=n+i.buffer[e+1],this.to=n+i.buffer[e+2],!0}yield(e){return e?e instanceof Qs?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,t,n){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,t,n,this.mode));let{buffer:i}=this.buffer,s=i.findChild(this.index+4,i.buffer[this.index+3],e,t-this.buffer.start,n);return s<0?!1:(this.stack.push(this.index),this.yieldBuf(s))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,t,n=this.mode){return this.buffer?n&Yr.ExcludeBuffers?!1:this.enterChild(1,e,t):this.yield(this._tree.enter(e,t,n))}parent(){if(!this.buffer)return this.yieldNode(this.mode&Yr.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&Yr.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode)):!1;let{buffer:t}=this.buffer,n=this.stack.length-1;if(e<0){let i=n<0?0:this.stack[n]+4;if(this.index!=i)return this.yieldBuf(t.findChild(i,this.index,-1,0,4))}else{let i=t.buffer[this.index+3];if(i<(n<0?t.buffer.length:t.buffer[this.stack[n]+3]))return this.yieldBuf(i)}return n<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let t,n,{buffer:i}=this;if(i){if(e>0){if(this.index<i.buffer.buffer.length)return!1}else for(let s=0;s<this.index;s++)if(i.buffer.buffer[s+3]<this.index)return!1;({index:t,parent:n}=i)}else({index:t,_parent:n}=this._tree);for(;n;{index:t,_parent:n}=n)if(t>-1)for(let s=t+e,a=e<0?-1:n._tree.children.length;s!=a;s+=e){let o=n._tree.children[s];if(this.mode&Yr.IncludeAnonymous||o instanceof Zl||!o.type.isAnonymous||Nx(o))return!1}return!0}move(e,t){if(t&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,t=0){for(;(this.from==this.to||(t<1?this.from>=e:this.from>e)||(t>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,t););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,t=null,n=0;if(e&&e.context==this.buffer)e:for(let i=this.index,s=this.stack.length;s>=0;){for(let a=e;a;a=a._parent)if(a.index==i){if(i==this.index)return a;t=a,n=s+1;break e}i=this.stack[--s]}for(let i=n;i<this.stack.length;i++)t=new Kc(this.buffer,t,this.stack[i]);return this.bufferNode=new Kc(this.buffer,t,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,t){for(let n=0;;){let i=!1;if(this.type.isAnonymous||e(this)!==!1){if(this.firstChild()){n++;continue}this.type.isAnonymous||(i=!0)}for(;;){if(i&&t&&t(this),i=this.type.isAnonymous,!n)return;if(this.nextSibling())break;this.parent(),n--,i=!0}}}matchContext(e){if(!this.buffer)return l1(this.node.parent,e);let{buffer:t}=this.buffer,{types:n}=t.set;for(let i=e.length-1,s=this.stack.length-1;i>=0;s--){if(s<0)return l1(this._tree,e,i);let a=n[t.buffer[this.stack[s]]];if(!a.isAnonymous){if(e[i]&&e[i]!=a.name)return!1;i--}}return!0}};function Nx(r){return r.children.some(e=>e instanceof Zl||!e.type.isAnonymous||Nx(e))}function WK(r){var e;let{buffer:t,nodeSet:n,maxBufferLength:i=DK,reused:s=[],minRepeatType:a=n.types.length}=r,o=Array.isArray(t)?new IK(t,t.length):t,l=n.types,f=0,c=0;function h(y,b,x,A,k,E){let{id:T,start:_,end:N,size:Z}=o,z=c,ee=f;for(;Z<0;)if(o.next(),Z==-1){let ie=s[T];x.push(ie),A.push(_-y);return}else if(Z==-3){f=T;return}else if(Z==-4){c=T;return}else throw new RangeError(`Unrecognized record size: ${Z}`);let ae=l[T],xe,V,ue=_-y;if(N-_<=i&&(V=g(o.pos-b,k))){let ie=new Uint16Array(V.size-V.skip),P=o.pos-V.size,I=ie.length;for(;o.pos>P;)I=O(V.start,ie,I);xe=new Zl(ie,N-V.start,n),ue=V.start-y}else{let ie=o.pos-Z;o.next();let P=[],I=[],B=T>=a?T:-1,W=0,K=N;for(;o.pos>ie;)B>=0&&o.id==B&&o.size>=0?(o.end<=K-i&&(p(P,I,_,W,o.end,K,B,z,ee),W=P.length,K=o.end),o.next()):E>2500?u(_,ie,P,I):h(_,ie,P,I,B,E+1);if(B>=0&&W>0&&W<P.length&&p(P,I,_,W,_,K,B,z,ee),P.reverse(),I.reverse(),B>-1&&W>0){let re=d(ae,ee);xe=Mx(ae,P,I,0,P.length,0,N-_,re,re)}else xe=m(ae,P,I,N-_,z-N,ee)}x.push(xe),A.push(ue)}function u(y,b,x,A){let k=[],E=0,T=-1;for(;o.pos>b;){let{id:_,start:N,end:Z,size:z}=o;if(z>4)o.next();else{if(T>-1&&N<T)break;T<0&&(T=Z-i),k.push(_,N,Z),E++,o.next()}}if(E){let _=new Uint16Array(E*4),N=k[k.length-2];for(let Z=k.length-3,z=0;Z>=0;Z-=3)_[z++]=k[Z],_[z++]=k[Z+1]-N,_[z++]=k[Z+2]-N,_[z++]=z;x.push(new Zl(_,k[2]-N,n)),A.push(N-y)}}function d(y,b){return(x,A,k)=>{let E=0,T=x.length-1,_,N;if(T>=0&&(_=x[T])instanceof hi){if(!T&&_.type==y&&_.length==k)return _;(N=_.prop(er.lookAhead))&&(E=A[T]+_.length+N)}return m(y,x,A,k,E,b)}}function p(y,b,x,A,k,E,T,_,N){let Z=[],z=[];for(;y.length>A;)Z.push(y.pop()),z.push(b.pop()+x-k);y.push(m(n.types[T],Z,z,E-k,_-E,N)),b.push(k-x)}function m(y,b,x,A,k,E,T){if(E){let _=[er.contextHash,E];T=T?[_].concat(T):[_]}if(k>25){let _=[er.lookAhead,k];T=T?[_].concat(T):[_]}return new hi(y,b,x,A,T)}function g(y,b){let x=o.fork(),A=0,k=0,E=0,T=x.end-i,_={size:0,start:0,skip:0};e:for(let N=x.pos-y;x.pos>N;){let Z=x.size;if(x.id==b&&Z>=0){_.size=A,_.start=k,_.skip=E,E+=4,A+=4,x.next();continue}let z=x.pos-Z;if(Z<0||z<N||x.start<T)break;let ee=x.id>=a?4:0,ae=x.start;for(x.next();x.pos>z;){if(x.size<0)if(x.size==-3)ee+=4;else break e;else x.id>=a&&(ee+=4);x.next()}k=ae,A+=Z,E+=ee}return(b<0||A==y)&&(_.size=A,_.start=k,_.skip=E),_.size>4?_:void 0}function O(y,b,x){let{id:A,start:k,end:E,size:T}=o;if(o.next(),T>=0&&A<a){let _=x;if(T>4){let N=o.pos-(T-4);for(;o.pos>N;)x=O(y,b,x)}b[--x]=_,b[--x]=E-y,b[--x]=k-y,b[--x]=A}else T==-3?f=A:T==-4&&(c=A);return x}let w=[],v=[];for(;o.pos>0;)h(r.start||0,r.bufferStart||0,w,v,-1,0);let S=(e=r.length)!==null&&e!==void 0?e:w.length?v[0]+w[0].length:0;return new hi(l[r.topID],w.reverse(),v.reverse(),S)}const c_=new WeakMap;function Gu(r,e){if(!r.isAnonymous||e instanceof Zl||e.type!=r)return 1;let t=c_.get(e);if(t==null){t=1;for(let n of e.children){if(n.type!=r||!(n instanceof hi)){t=1;break}t+=Gu(r,n)}c_.set(e,t)}return t}function Mx(r,e,t,n,i,s,a,o,l){let f=0;for(let p=n;p<i;p++)f+=Gu(r,e[p]);let c=Math.ceil(f*1.5/8),h=[],u=[];function d(p,m,g,O,w){for(let v=g;v<O;){let S=v,y=m[v],b=Gu(r,p[v]);for(v++;v<O;v++){let x=Gu(r,p[v]);if(b+x>=c)break;b+=x}if(v==S+1){if(b>c){let x=p[S];d(x.children,x.positions,0,x.children.length,m[S]+w);continue}h.push(p[S])}else{let x=m[v-1]+p[v-1].length-y;h.push(Mx(r,p,m,S,v,y,x,null,l))}u.push(y+w-s)}}return d(e,t,n,i,0),(o||l)(h,u,a)}class UK{constructor(){this.map=new WeakMap}setBuffer(e,t,n){let i=this.map.get(e);i||this.map.set(e,i=new Map),i.set(t,n)}getBuffer(e,t){let n=this.map.get(e);return n&&n.get(t)}set(e,t){e instanceof Kc?this.setBuffer(e.context.buffer,e.index,t):e instanceof Qs&&this.map.set(e.tree,t)}get(e){return e instanceof Kc?this.getBuffer(e.context.buffer,e.index):e instanceof Qs?this.map.get(e.tree):void 0}cursorSet(e,t){e.buffer?this.setBuffer(e.buffer.buffer,e.index,t):this.map.set(e.tree,t)}cursorGet(e){return e.buffer?this.getBuffer(e.buffer.buffer,e.index):this.map.get(e.tree)}}let Hu=class c1{constructor(e,t,n,i,s=!1,a=!1){this.from=e,this.to=t,this.tree=n,this.offset=i,this.open=(s?1:0)|(a?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(e,t=[],n=!1){let i=[new c1(0,e.length,e,0,!1,n)];for(let s of t)s.to>e.length&&i.push(s);return i}static applyChanges(e,t,n=128){if(!t.length)return e;let i=[],s=1,a=e.length?e[0]:null;for(let o=0,l=0,f=0;;o++){let c=o<t.length?t[o]:null,h=c?c.fromA:1e9;if(h-l>=n)for(;a&&a.from<h;){let u=a;if(l>=u.from||h<=u.to||f){let d=Math.max(u.from,l)-f,p=Math.min(u.to,h)-f;u=d>=p?null:new c1(d,p,u.tree,u.offset+f,o>0,!!c)}if(u&&i.push(u),a.to>h)break;a=s<e.length?e[s++]:null}if(!c)break;l=c.toA,f=c.toA-c.toB}return i}},XK=class{startParse(e,t,n){return typeof e=="string"&&(e=new VK(e)),n=n?n.length?n.map(i=>new qp(i.from,i.to)):[new qp(0,0)]:[new qp(0,e.length)],this.createParse(e,t||[],n)}parse(e,t,n){let i=this.startParse(e,t,n);for(;;){let s=i.advance();if(s)return s}}},VK=class{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,t){return this.string.slice(e,t)}};new er({perNode:!0});var jp;const ol=new er;function NE(r){return Ze.define({combine:r?e=>e.concat(r):void 0})}const Ix=new er;let ji=class{constructor(e,t,n=[],i=""){this.data=e,this.name=i,st.prototype.hasOwnProperty("tree")||Object.defineProperty(st.prototype,"tree",{get(){return Wl(this)}}),this.parser=t,this.extension=[Ul.of(this),st.languageData.of((s,a,o)=>{let l=h_(s,a,o),f=l.type.prop(ol);if(!f)return[];let c=s.facet(f),h=l.type.prop(Ix);if(h){let u=l.resolve(a-l.from,o);for(let d of h)if(d.test(u,s)){let p=s.facet(d.facet);return d.type=="replace"?p:p.concat(c)}}return c})].concat(n)}isActiveAt(e,t,n=-1){return h_(e,t,n).type.prop(ol)==this.data}findRegions(e){let t=e.facet(Ul);if((t==null?void 0:t.data)==this.data)return[{from:0,to:e.doc.length}];if(!t||!t.allowsNesting)return[];let n=[],i=(s,a)=>{if(s.prop(ol)==this.data){n.push({from:a,to:a+s.length});return}let o=s.prop(er.mounted);if(o){if(o.tree.prop(ol)==this.data){if(o.overlay)for(let l of o.overlay)n.push({from:l.from+a,to:l.to+a});else n.push({from:a,to:a+s.length});return}else if(o.overlay){let l=n.length;if(i(o.tree,o.overlay[0].from+a),n.length>l)return}}for(let l=0;l<s.children.length;l++){let f=s.children[l];f instanceof hi&&i(f,s.positions[l]+a)}};return i(Wl(e),0),n}get allowsNesting(){return!0}};ji.setState=rt.define();function h_(r,e,t){let n=r.facet(Ul),i=Wl(r).topNode;if(!n||n.allowsNesting)for(let s=i;s;s=s.enter(e,t,Yr.ExcludeBuffers))s.type.isTop&&(i=s);return i}let qK=class h1 extends ji{constructor(e,t,n){super(e,t,[],n),this.parser=t}static define(e){let t=NE(e.languageData);return new h1(t,e.parser.configure({props:[ol.add(n=>n.isTop?t:void 0)]}),e.name)}configure(e,t){return new h1(this.data,this.parser.configure(e),t||this.name)}get allowsNesting(){return this.parser.hasWrappers()}};function Wl(r){let e=r.field(ji.state,!1);return e?e.tree:hi.empty}let jK=class{constructor(e){this.doc=e,this.cursorPos=0,this.string="",this.cursor=e.iter()}get length(){return this.doc.length}syncTo(e){return this.string=this.cursor.next(e-this.cursorPos).value,this.cursorPos=e+this.string.length,this.cursorPos-this.string.length}chunk(e){return this.syncTo(e),this.string}get lineChunks(){return!0}read(e,t){let n=this.cursorPos-this.string.length;return e<n||t>=this.cursorPos?this.doc.sliceString(e,t):this.string.slice(e-n,t-n)}},bf=null,zK=class u1{constructor(e,t,n=[],i,s,a,o,l){this.parser=e,this.state=t,this.fragments=n,this.tree=i,this.treeLen=s,this.viewport=a,this.skipped=o,this.scheduleOn=l,this.parse=null,this.tempSkipped=[]}static create(e,t,n){return new u1(e,t,[],hi.empty,0,n,[],null)}startParse(){return this.parser.startParse(new jK(this.state.doc),this.fragments)}work(e,t){return t!=null&&t>=this.state.doc.length&&(t=void 0),this.tree!=hi.empty&&this.isDone(t??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var n;if(typeof e=="number"){let i=Date.now()+e;e=()=>Date.now()>i}for(this.parse||(this.parse=this.startParse()),t!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>t)&&t<this.state.doc.length&&this.parse.stopAt(t);;){let i=this.parse.advance();if(i)if(this.fragments=this.withoutTempSkipped(Hu.addTree(i,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(n=this.parse.stoppedAt)!==null&&n!==void 0?n:this.state.doc.length,this.tree=i,this.parse=null,this.treeLen<(t??this.state.doc.length))this.parse=this.startParse();else return!0;if(e())return!1}})}takeTree(){let e,t;this.parse&&(e=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>e)&&this.parse.stopAt(e),this.withContext(()=>{for(;!(t=this.parse.advance()););}),this.treeLen=e,this.tree=t,this.fragments=this.withoutTempSkipped(Hu.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(e){let t=bf;bf=this;try{return e()}finally{bf=t}}withoutTempSkipped(e){for(let t;t=this.tempSkipped.pop();)e=u_(e,t.from,t.to);return e}changes(e,t){let{fragments:n,tree:i,treeLen:s,viewport:a,skipped:o}=this;if(this.takeTree(),!e.empty){let l=[];if(e.iterChangedRanges((f,c,h,u)=>l.push({fromA:f,toA:c,fromB:h,toB:u})),n=Hu.applyChanges(n,l),i=hi.empty,s=0,a={from:e.mapPos(a.from,-1),to:e.mapPos(a.to,1)},this.skipped.length){o=[];for(let f of this.skipped){let c=e.mapPos(f.from,1),h=e.mapPos(f.to,-1);c<h&&o.push({from:c,to:h})}}}return new u1(this.parser,t,n,i,s,a,o,this.scheduleOn)}updateViewport(e){if(this.viewport.from==e.from&&this.viewport.to==e.to)return!1;this.viewport=e;let t=this.skipped.length;for(let n=0;n<this.skipped.length;n++){let{from:i,to:s}=this.skipped[n];i<e.to&&s>e.from&&(this.fragments=u_(this.fragments,i,s),this.skipped.splice(n--,1))}return this.skipped.length>=t?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(e,t){this.skipped.push({from:e,to:t})}static getSkippingParser(e){return new class extends XK{createParse(t,n,i){let s=i[0].from,a=i[i.length-1].to;return{parsedPos:s,advance(){let l=bf;if(l){for(let f of i)l.tempSkipped.push(f);e&&(l.scheduleOn=l.scheduleOn?Promise.all([l.scheduleOn,e]):e)}return this.parsedPos=a,new hi(Rs.none,[],[],a-s)},stoppedAt:null,stopAt(){}}}}}isDone(e){e=Math.min(e,this.state.doc.length);let t=this.fragments;return this.treeLen>=e&&t.length&&t[0].from==0&&t[0].to>=e}static get(){return bf}};function u_(r,e,t){return Hu.applyChanges(r,[{fromA:e,toA:t,fromB:e,toB:t}])}let d1=class p1{constructor(e){this.context=e,this.tree=e.tree}apply(e){if(!e.docChanged&&this.tree==this.context.tree)return this;let t=this.context.changes(e.changes,e.state),n=this.context.treeLen==e.startState.doc.length?void 0:Math.max(e.changes.mapPos(this.context.treeLen),t.viewport.to);return t.work(20,n)||t.takeTree(),new p1(t)}static init(e){let t=Math.min(3e3,e.doc.length),n=zK.create(e.facet(Ul).parser,e,{from:0,to:t});return n.work(20,t)||n.takeTree(),new p1(n)}};ji.state=Cr.define({create:d1.init,update(r,e){for(let t of e.effects)if(t.is(ji.setState))return t.value;return e.startState.facet(Ul)!=e.state.facet(Ul)?d1.init(e.state):r.apply(e)}});let ME=r=>{let e=setTimeout(()=>r(),500);return()=>clearTimeout(e)};typeof requestIdleCallback<"u"&&(ME=r=>{let e=-1,t=setTimeout(()=>{e=requestIdleCallback(r,{timeout:400})},100);return()=>e<0?clearTimeout(t):cancelIdleCallback(e)});const zp=typeof navigator<"u"&&(!((jp=navigator.scheduling)===null||jp===void 0)&&jp.isInputPending)?()=>navigator.scheduling.isInputPending():null,GK=pr.fromClass(class{constructor(e){this.view=e,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(e){let t=this.view.state.field(ji.state).context;(t.updateViewport(e.view.viewport)||this.view.viewport.to>t.treeLen)&&this.scheduleWork(),(e.docChanged||e.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(t)}scheduleWork(){if(this.working)return;let{state:e}=this.view,t=e.field(ji.state);(t.tree!=t.context.tree||!t.context.isDone(e.doc.length))&&(this.working=ME(this.work))}work(e){this.working=null;let t=Date.now();if(this.chunkEnd<t&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=t+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:n,viewport:{to:i}}=this.view,s=n.field(ji.state);if(s.tree==s.context.tree&&s.context.isDone(i+1e5))return;let a=Date.now()+Math.min(this.chunkBudget,100,e&&!zp?Math.max(25,e.timeRemaining()-5):1e9),o=s.context.treeLen<i&&n.doc.length>i+1e3,l=s.context.work(()=>zp&&zp()||Date.now()>a,i+(o?0:1e5));this.chunkBudget-=Date.now()-t,(l||this.chunkBudget<=0)&&(s.context.takeTree(),this.view.dispatch({effects:ji.setState.of(new d1(s.context))})),this.chunkBudget>0&&!(l&&!o)&&this.scheduleWork(),this.checkAsyncSchedule(s.context)}checkAsyncSchedule(e){e.scheduleOn&&(this.workScheduled++,e.scheduleOn.then(()=>this.scheduleWork()).catch(t=>tn(this.view.state,t)).then(()=>this.workScheduled--),e.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),Ul=Ze.define({combine(r){return r.length?r[0]:null},enables:r=>[ji.state,GK,We.contentAttributes.compute([r],e=>{let t=e.facet(r);return t&&t.name?{"data-language":t.name}:{}})]});let HK=class{constructor(e,t=[]){this.language=e,this.support=t,this.extension=[e,t]}};const YK=Ze.define({combine:r=>{if(!r.length)return"  ";let e=r[0];if(!e||/\S/.test(e)||Array.from(e).some(t=>t!=e[0]))throw new Error("Invalid indent unit: "+JSON.stringify(r[0]));return e}}),KK=new er;function JK(r){let e=r.node,t=e.childAfter(e.from),n=e.lastChild;if(!t)return null;let i=r.options.simulateBreak,s=r.state.doc.lineAt(t.from),a=i==null||i<=s.from?s.to:Math.min(s.to,i);for(let o=t.to;;){let l=e.childAfter(o);if(!l||l==n)return null;if(!l.type.isSkipped){if(l.from>=a)return null;let f=/^ */.exec(s.text.slice(t.to-s.from))[0].length;return{from:t.from,to:t.to+f}}o=l.to}}function eJ({closing:r,align:e=!0,units:t=1}){return n=>tJ(n,e,t,r)}function tJ(r,e,t,n,i){let s=r.textAfter,a=s.match(/^\s*/)[0].length,o=n&&s.slice(a,a+n.length)==n||i==r.pos+a,l=e?JK(r):null;return l?o?r.column(l.from):r.column(l.to):r.baseIndent+(o?0:r.unit*t)}const rJ=r=>r.baseIndent;function Gp({except:r,units:e=1}={}){return t=>{let n=r&&r.test(t.textAfter);return t.baseIndent+(n?0:e*t.unit)}}const nJ=new er;function iJ(r){let e=r.firstChild,t=r.lastChild;return e&&e.to<t.from?{from:e.to,to:t.type.isError?r.to:t.from}:null}let sJ=class IE{constructor(e,t){this.specs=e;let n;function i(o){let l=An.newName();return(n||(n=Object.create(null)))["."+l]=o,l}const s=typeof t.all=="string"?t.all:t.all?i(t.all):void 0,a=t.scope;this.scope=a instanceof ji?o=>o.prop(ol)==a.data:a?o=>o==a:void 0,this.style=af(e.map(o=>({tag:o.tag,class:o.class||i(Object.assign({},o,{tag:null}))})),{all:s}).style,this.module=n?new An(n):null,this.themeType=t.themeType}static define(e,t){return new IE(e,t||{})}};L.meta,L.link,L.heading,L.emphasis,L.strong,L.strikethrough,L.keyword,L.atom,L.bool,L.url,L.contentSeparator,L.labelName,L.literal,L.inserted,L.string,L.deleted,L.regexp,L.escape,L.string,L.variableName,L.variableName,L.typeName,L.namespace,L.className,L.variableName,L.macroName,L.propertyName,L.comment,L.invalid;const aJ=Object.create(null),d_=[Rs.none],p_=[],m_=Object.create(null),oJ=Object.create(null);for(let[r,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])oJ[r]=lJ(aJ,e);function Hp(r,e){p_.indexOf(r)>-1||(p_.push(r),console.warn(e))}function lJ(r,e){let t=[];for(let o of e.split(" ")){let l=[];for(let f of o.split(".")){let c=r[f]||L[f];c?typeof c=="function"?l.length?l=l.map(c):Hp(f,`Modifier ${f} used at start of tag`):l.length?Hp(f,`Tag ${f} used as modifier`):l=Array.isArray(c)?c:[c]:Hp(f,`Unknown highlighting tag ${f}`)}for(let f of l)t.push(f)}if(!t.length)return 0;let n=e.replace(/ /g,"_"),i=n+" "+t.map(o=>o.id),s=m_[i];if(s)return s.id;let a=m_[i]=Rs.define({id:d_.length,name:n,props:[oa({[n]:t})]});return d_.push(a),a.id}Et.RTL,Et.LTR;function g_(r){let e=Object.keys(r).join(""),t=/\w/.test(e);return t&&(e=e.replace(/\w/g,"")),`[${t?"\\w":""}${e.replace(/[^\w\s]/g,"\\$&")}]`}function fJ(r){let e=Object.create(null),t=Object.create(null);for(let{label:i}of r){e[i[0]]=!0;for(let s=1;s<i.length;s++)t[i[s]]=!0}let n=g_(e)+g_(t)+"*$";return[new RegExp("^"+n),new RegExp(n)]}function cJ(r){let e=r.map(i=>typeof i=="string"?{label:i}:i),[t,n]=e.every(i=>/^\w+$/.test(i.label))?[/\w*$/,/\w+$/]:fJ(e);return i=>{let s=i.matchBefore(n);return s||i.explicit?{from:s?s.from:i.pos,options:e,validFor:t}:null}}function hJ(r,e){return t=>{for(let n=Wl(t.state).resolveInner(t.pos,-1);n;n=n.parent){if(r.indexOf(n.name)>-1)return null;if(n.type.isTop)break}return e(t)}}const uJ=Is.define(),dJ=We.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'""',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"400px",boxSizing:"border-box",whiteSpace:"pre-line"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:"30px"},".cm-completionInfo.cm-completionInfo-right-narrow":{left:"30px"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"''"}},".cm-completionIcon-class":{"&:after":{content:"''"}},".cm-completionIcon-interface":{"&:after":{content:"''"}},".cm-completionIcon-variable":{"&:after":{content:"''"}},".cm-completionIcon-constant":{"&:after":{content:"''"}},".cm-completionIcon-type":{"&:after":{content:"''"}},".cm-completionIcon-enum":{"&:after":{content:"''"}},".cm-completionIcon-property":{"&:after":{content:"''"}},".cm-completionIcon-keyword":{"&:after":{content:"''"}},".cm-completionIcon-namespace":{"&:after":{content:"''"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}});class pJ{constructor(e,t,n,i){this.field=e,this.line=t,this.from=n,this.to=i}}class Lx{constructor(e,t,n){this.field=e,this.from=t,this.to=n}map(e){let t=e.mapPos(this.from,-1,dn.TrackDel),n=e.mapPos(this.to,1,dn.TrackDel);return t==null||n==null?null:new Lx(this.field,t,n)}}class Bx{constructor(e,t){this.lines=e,this.fieldPositions=t}instantiate(e,t){let n=[],i=[t],s=e.doc.lineAt(t),a=/^\s*/.exec(s.text)[0];for(let l of this.lines){if(n.length){let f=a,c=/^\t*/.exec(l)[0].length;for(let h=0;h<c;h++)f+=e.facet(YK);i.push(t+f.length-c),l=f+l.slice(c)}n.push(l),t+=l.length+1}let o=this.fieldPositions.map(l=>new Lx(l.field,i[l.line]+l.from,i[l.line]+l.to));return{text:n,ranges:o}}static parse(e){let t=[],n=[],i=[],s;for(let a of e.split(/\r\n?|\n/)){for(;s=/[#$]\{(?:(\d+)(?::([^}]*))?|((?:\\[{}]|[^}])*))\}/.exec(a);){let o=s[1]?+s[1]:null,l=s[2]||s[3]||"",f=-1,c=l.replace(/\\[{}]/g,h=>h[1]);for(let h=0;h<t.length;h++)(o!=null?t[h].seq==o:c&&t[h].name==c)&&(f=h);if(f<0){let h=0;for(;h<t.length&&(o==null||t[h].seq!=null&&t[h].seq<o);)h++;t.splice(h,0,{seq:o,name:c}),f=h;for(let u of i)u.field>=f&&u.field++}i.push(new pJ(f,n.length,s.index,s.index+c.length)),a=a.slice(0,s.index)+l+a.slice(s.index+s[0].length)}a=a.replace(/\\([{}])/g,(o,l,f)=>{for(let c of i)c.line==n.length&&c.from>f&&(c.from--,c.to--);return l}),n.push(a)}return new Bx(n,i)}}let mJ=je.widget({widget:new class extends aa{toDOM(){let r=document.createElement("span");return r.className="cm-snippetFieldPosition",r}ignoreEvent(){return!1}}}),gJ=je.mark({class:"cm-snippetField"});class ff{constructor(e,t){this.ranges=e,this.active=t,this.deco=je.set(e.map(n=>(n.from==n.to?mJ:gJ).range(n.from,n.to)))}map(e){let t=[];for(let n of this.ranges){let i=n.map(e);if(!i)return null;t.push(i)}return new ff(t,this.active)}selectionInsideField(e){return e.ranges.every(t=>this.ranges.some(n=>n.field==this.active&&n.from<=t.from&&n.to>=t.to))}}const Ah=rt.define({map(r,e){return r&&r.map(e)}}),OJ=rt.define(),Jc=Cr.define({create(){return null},update(r,e){for(let t of e.effects){if(t.is(Ah))return t.value;if(t.is(OJ)&&r)return new ff(r.ranges,t.value)}return r&&e.docChanged&&(r=r.map(e.changes)),r&&e.selection&&!r.selectionInsideField(e.selection)&&(r=null),r},provide:r=>We.decorations.from(r,e=>e?e.deco:je.none)});function Zx(r,e){return Oe.create(r.filter(t=>t.field==e).map(t=>Oe.range(t.from,t.to)))}function xJ(r){let e=Bx.parse(r);return(t,n,i,s)=>{let{text:a,ranges:o}=e.instantiate(t.state,i),{main:l}=t.state.selection,f={changes:{from:i,to:s==l.from?l.to:s,insert:Ft.of(a)},scrollIntoView:!0,annotations:n?[uJ.of(n),Br.userEvent.of("input.complete")]:void 0};if(o.length&&(f.selection=Zx(o,0)),o.some(c=>c.field>0)){let c=new ff(o,0),h=f.effects=[Ah.of(c)];t.state.field(Jc,!1)===void 0&&h.push(rt.appendConfig.of([Jc,_J,kJ,dJ]))}t.dispatch(t.state.update(f))}}function LE(r){return({state:e,dispatch:t})=>{let n=e.field(Jc,!1);if(!n||r<0&&n.active==0)return!1;let i=n.active+r,s=r>0&&!n.ranges.some(a=>a.field==i+r);return t(e.update({selection:Zx(n.ranges,i),effects:Ah.of(s?null:new ff(n.ranges,i)),scrollIntoView:!0})),!0}}const vJ=({state:r,dispatch:e})=>r.field(Jc,!1)?(e(r.update({effects:Ah.of(null)})),!0):!1,yJ=LE(1),wJ=LE(-1),bJ=[{key:"Tab",run:yJ,shift:wJ},{key:"Escape",run:vJ}],O_=Ze.define({combine(r){return r.length?r[0]:bJ}}),_J=ja.highest(Q0.compute([O_],r=>r.facet(O_)));function Xn(r,e){return Object.assign(Object.assign({},e),{apply:xJ(r)})}const kJ=We.domEventHandlers({mousedown(r,e){let t=e.state.field(Jc,!1),n;if(!t||(n=e.posAtCoords({x:r.clientX,y:r.clientY}))==null)return!1;let i=t.ranges.find(s=>s.from<=n&&s.to>=n);return!i||i.field==t.active?!1:(e.dispatch({selection:Zx(t.ranges,i.field),effects:Ah.of(t.ranges.some(s=>s.field>i.field)?new ff(t.ranges,i.field):null),scrollIntoView:!0}),!0)}}),BE=new class extends Ks{};BE.startSide=1;BE.endSide=-1;const ZE=[Xn("function ${name}(${params}) {\n	${}\n}",{label:"function",detail:"definition",type:"keyword"}),Xn("for (let ${index} = 0; ${index} < ${bound}; ${index}++) {\n	${}\n}",{label:"for",detail:"loop",type:"keyword"}),Xn("for (let ${name} of ${collection}) {\n	${}\n}",{label:"for",detail:"of loop",type:"keyword"}),Xn("do {\n	${}\n} while (${})",{label:"do",detail:"loop",type:"keyword"}),Xn("while (${}) {\n	${}\n}",{label:"while",detail:"loop",type:"keyword"}),Xn(`try {
	\${}
} catch (\${error}) {
	\${}
}`,{label:"try",detail:"/ catch block",type:"keyword"}),Xn("if (${}) {\n	${}\n}",{label:"if",detail:"block",type:"keyword"}),Xn(`if (\${}) {
	\${}
} else {
	\${}
}`,{label:"if",detail:"/ else block",type:"keyword"}),Xn(`class \${name} {
	constructor(\${params}) {
		\${}
	}
}`,{label:"class",detail:"definition",type:"keyword"}),Xn('import {${names}} from "${module}"\n${}',{label:"import",detail:"named",type:"keyword"}),Xn('import ${name} from "${module}"\n${}',{label:"import",detail:"default",type:"keyword"})],SJ=ZE.concat([Xn("interface ${name} {\n	${}\n}",{label:"interface",detail:"definition",type:"keyword"}),Xn("type ${name} = ${type}",{label:"type",detail:"definition",type:"keyword"}),Xn("enum ${name} {\n	${}\n}",{label:"enum",detail:"definition",type:"keyword"})]),x_=new UK,WE=new Set(["Script","Block","FunctionExpression","FunctionDeclaration","ArrowFunction","MethodDeclaration","ForStatement"]);function _f(r){return(e,t)=>{let n=e.node.getChild("VariableDefinition");return n&&t(n,r),!0}}const TJ=["FunctionDeclaration"],CJ={FunctionDeclaration:_f("function"),ClassDeclaration:_f("class"),ClassExpression:()=>!0,EnumDeclaration:_f("constant"),TypeAliasDeclaration:_f("type"),NamespaceDeclaration:_f("namespace"),VariableDefinition(r,e){r.matchContext(TJ)||e(r,"variable")},TypeDefinition(r,e){e(r,"type")},__proto__:null};function UE(r,e){let t=x_.get(e);if(t)return t;let n=[],i=!0;function s(a,o){let l=r.sliceString(a.from,a.to);n.push({label:l,type:o})}return e.cursor(Yr.IncludeAnonymous).iterate(a=>{if(i)i=!1;else if(a.name){let o=CJ[a.name];if(o&&o(a,s)||WE.has(a.name))return!1}else if(a.to-a.from>8192){for(let o of UE(r,a.node))n.push(o);return!1}}),x_.set(e,n),n}const v_=/^[\w$\xa1-\uffff][\w$\d\xa1-\uffff]*$/,XE=["TemplateString","String","RegExp","LineComment","BlockComment","VariableDefinition","TypeDefinition","Label","PropertyDefinition","PropertyName","PrivatePropertyDefinition","PrivatePropertyName",".","?."];function AJ(r){let e=Wl(r.state).resolveInner(r.pos,-1);if(XE.indexOf(e.name)>-1)return null;let t=e.name=="VariableName"||e.to-e.from<20&&v_.test(r.state.sliceDoc(e.from,e.to));if(!t&&!r.explicit)return null;let n=[];for(let i=e;i;i=i.parent)WE.has(i.name)&&(n=n.concat(UE(r.state.doc,i)));return{options:n,from:t?e.from:r.pos,validFor:v_}}const bo=qK.define({name:"javascript",parser:$K.configure({props:[KK.add({IfStatement:Gp({except:/^\s*({|else\b)/}),TryStatement:Gp({except:/^\s*({|catch\b|finally\b)/}),LabeledStatement:rJ,SwitchBody:r=>{let e=r.textAfter,t=/^\s*\}/.test(e),n=/^\s*(case|default)\b/.test(e);return r.baseIndent+(t?0:n?1:2)*r.unit},Block:eJ({closing:"}"}),ArrowFunction:r=>r.baseIndent+r.unit,"TemplateString BlockComment":()=>null,"Statement Property":Gp({except:/^{/}),JSXElement(r){let e=/^\s*<\//.test(r.textAfter);return r.lineIndent(r.node.from)+(e?0:r.unit)},JSXEscape(r){let e=/\s*\}/.test(r.textAfter);return r.lineIndent(r.node.from)+(e?0:r.unit)},"JSXOpenTag JSXSelfClosingTag"(r){return r.column(r.node.from)+r.unit}}),nJ.add({"Block ClassBody SwitchBody EnumBody ObjectExpression ArrayExpression ObjectType":iJ,BlockComment(r){return{from:r.from+2,to:r.to-2}}})]}),languageData:{closeBrackets:{brackets:["(","[","{","'",'"',"`"]},commentTokens:{line:"//",block:{open:"/*",close:"*/"}},indentOnInput:/^\s*(?:case |default:|\{|\}|<\/)$/,wordChars:"$"}}),VE={test:r=>/^JSX/.test(r.name),facet:NE({commentTokens:{block:{open:"{/*",close:"*/}"}}})},EJ=bo.configure({dialect:"ts"},"typescript"),PJ=bo.configure({dialect:"jsx",props:[Ix.add(r=>r.isTop?[VE]:void 0)]}),RJ=bo.configure({dialect:"jsx ts",props:[Ix.add(r=>r.isTop?[VE]:void 0)]},"typescript");let qE=r=>({label:r,type:"keyword"});const jE="break case const continue default delete export extends false finally in instanceof let new return static super switch this throw true typeof var yield".split(" ").map(qE),QJ=jE.concat(["declare","implements","private","protected","public"].map(qE));function FJ(r={}){let e=r.jsx?r.typescript?RJ:PJ:r.typescript?EJ:bo,t=r.typescript?SJ.concat(QJ):ZE.concat(jE);return new HK(e,[bo.data.of({autocomplete:hJ(XE,cJ(t))}),bo.data.of({autocomplete:AJ}),r.jsx?NJ:[]])}function $J(r){for(;;){if(r.name=="JSXOpenTag"||r.name=="JSXSelfClosingTag"||r.name=="JSXFragmentTag")return r;if(r.name=="JSXEscape"||!r.parent)return null;r=r.parent}}function y_(r,e,t=r.length){for(let n=e==null?void 0:e.firstChild;n;n=n.nextSibling)if(n.name=="JSXIdentifier"||n.name=="JSXBuiltin"||n.name=="JSXNamespacedName"||n.name=="JSXMemberExpression")return r.sliceString(n.from,Math.min(n.to,t));return""}const DJ=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),NJ=We.inputHandler.of((r,e,t,n,i)=>{if((DJ?r.composing:r.compositionStarted)||r.state.readOnly||e!=t||n!=">"&&n!="/"||!bo.isActiveAt(r.state,e,-1))return!1;let s=i(),{state:a}=s,o=a.changeByRange(l=>{var f;let{head:c}=l,h=Wl(a).resolveInner(c-1,-1),u;if(h.name=="JSXStartTag"&&(h=h.parent),!(a.doc.sliceString(c-1,c)!=n||h.name=="JSXAttributeValue"&&h.to>c)){if(n==">"&&h.name=="JSXFragmentTag")return{range:l,changes:{from:c,insert:"</>"}};if(n=="/"&&h.name=="JSXStartCloseTag"){let d=h.parent,p=d.parent;if(p&&d.from==c-2&&((u=y_(a.doc,p.firstChild,c))||((f=p.firstChild)===null||f===void 0?void 0:f.name)=="JSXFragmentTag")){let m=`${u}>`;return{range:Oe.cursor(c+m.length,-1),changes:{from:c,insert:m}}}}else if(n==">"){let d=$J(h);if(d&&d.name=="JSXOpenTag"&&!/^\/?>|^<\//.test(a.doc.sliceString(c,c+2))&&(u=y_(a.doc,d,c)))return{range:l,changes:{from:c,insert:`</${u}>`}}}}return{range:l}});return o.changes.empty?!1:(r.dispatch([s,a.update(o,{userEvent:"input.complete",scrollIntoView:!0})]),!0)}),MJ=oa({String:L.string,Number:L.number,"True False":L.bool,PropertyName:L.propertyName,Null:L.null,", :":L.separator,"[ ]":L.squareBracket,"{ }":L.brace}),IJ=No.deserialize({version:14,states:"$bOVQPOOOOQO'#Cb'#CbOnQPO'#CeOvQPO'#ClOOQO'#Cr'#CrQOQPOOOOQO'#Cg'#CgO}QPO'#CfO!SQPO'#CtOOQO,59P,59PO![QPO,59PO!aQPO'#CuOOQO,59W,59WO!iQPO,59WOVQPO,59QOqQPO'#CmO!nQPO,59`OOQO1G.k1G.kOVQPO'#CnO!vQPO,59aOOQO1G.r1G.rOOQO1G.l1G.lOOQO,59X,59XOOQO-E6k-E6kOOQO,59Y,59YOOQO-E6l-E6l",stateData:"#O~OeOS~OQSORSOSSOTSOWQO_ROgPO~OVXOgUO~O^[O~PVO[^O~O]_OVhX~OVaO~O]bO^iX~O^dO~O]_OVha~O]bO^ia~O",goto:"!kjPPPPPPkPPkqwPPPPk{!RPPP!XP!e!hXSOR^bQWQRf_TVQ_Q`WRg`QcZRicQTOQZRQe^RhbRYQR]R",nodeNames:" JsonText True False Null Number String } { Object Property PropertyName : , ] [ Array",maxTerm:25,nodeProps:[["isolate",-2,6,11,""],["openedBy",7,"{",14,"["],["closedBy",8,"}",15,"]"]],propSources:[MJ],skippedNodes:[0],repeatNodeCount:2,tokenData:"(|~RaXY!WYZ!W]^!Wpq!Wrs!]|}$u}!O$z!Q!R%T!R![&c![!]&t!}#O&y#P#Q'O#Y#Z'T#b#c'r#h#i(Z#o#p(r#q#r(w~!]Oe~~!`Wpq!]qr!]rs!xs#O!]#O#P!}#P;'S!];'S;=`$o<%lO!]~!}Og~~#QXrs!]!P!Q!]#O#P!]#U#V!]#Y#Z!]#b#c!]#f#g!]#h#i!]#i#j#m~#pR!Q![#y!c!i#y#T#Z#y~#|R!Q![$V!c!i$V#T#Z$V~$YR!Q![$c!c!i$c#T#Z$c~$fR!Q![!]!c!i!]#T#Z!]~$rP;=`<%l!]~$zO]~~$}Q!Q!R%T!R![&c~%YRT~!O!P%c!g!h%w#X#Y%w~%fP!Q![%i~%nRT~!Q![%i!g!h%w#X#Y%w~%zR{|&T}!O&T!Q![&Z~&WP!Q![&Z~&`PT~!Q![&Z~&hST~!O!P%c!Q![&c!g!h%w#X#Y%w~&yO[~~'OO_~~'TO^~~'WP#T#U'Z~'^P#`#a'a~'dP#g#h'g~'jP#X#Y'm~'rOR~~'uP#i#j'x~'{P#`#a(O~(RP#`#a(U~(ZOS~~(^P#f#g(a~(dP#i#j(g~(jP#X#Y(m~(rOQ~~(wOW~~(|OV~",tokenizers:[0],topRules:{JsonText:[0,1]},tokenPrec:0}),LJ=1024;let BJ=0,Yp=class{constructor(e,t){this.from=e,this.to=t}},tr=class{constructor(e={}){this.id=BJ++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof e!="function"&&(e=Fs.match(e)),t=>{let n=e(t);return n===void 0?null:[this,n]}}};tr.closedBy=new tr({deserialize:r=>r.split(" ")});tr.openedBy=new tr({deserialize:r=>r.split(" ")});tr.group=new tr({deserialize:r=>r.split(" ")});tr.isolate=new tr({deserialize:r=>{if(r&&r!="rtl"&&r!="ltr"&&r!="auto")throw new RangeError("Invalid value for isolate: "+r);return r||"auto"}});tr.contextHash=new tr({perNode:!0});tr.lookAhead=new tr({perNode:!0});tr.mounted=new tr({perNode:!0});let r0=class{constructor(e,t,n){this.tree=e,this.overlay=t,this.parser=n}static get(e){return e&&e.props&&e.props[tr.mounted.id]}};const ZJ=Object.create(null);let Fs=class zE{constructor(e,t,n,i=0){this.name=e,this.props=t,this.id=n,this.flags=i}static define(e){let t=e.props&&e.props.length?Object.create(null):ZJ,n=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(e.name==null?8:0),i=new zE(e.name||"",t,e.id,n);if(e.props){for(let s of e.props)if(Array.isArray(s)||(s=s(i)),s){if(s[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");t[s[0].id]=s[1]}}return i}prop(e){return this.props[e.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(e){if(typeof e=="string"){if(this.name==e)return!0;let t=this.prop(tr.group);return t?t.indexOf(e)>-1:!1}return this.id==e}static match(e){let t=Object.create(null);for(let n in e)for(let i of n.split(" "))t[i]=e[n];return n=>{for(let i=n.prop(tr.group),s=-1;s<(i?i.length:0);s++){let a=t[s<0?n.name:i[s]];if(a)return a}}}};Fs.none=new Fs("",Object.create(null),0,8);const vu=new WeakMap,w_=new WeakMap;var fn;(function(r){r[r.ExcludeBuffers=1]="ExcludeBuffers",r[r.IncludeAnonymous=2]="IncludeAnonymous",r[r.IgnoreMounts=4]="IgnoreMounts",r[r.IgnoreOverlays=8]="IgnoreOverlays"})(fn||(fn={}));let ui=class m1{constructor(e,t,n,i,s){if(this.type=e,this.children=t,this.positions=n,this.length=i,this.props=null,s&&s.length){this.props=Object.create(null);for(let[a,o]of s)this.props[typeof a=="number"?a:a.id]=o}}toString(){let e=r0.get(this);if(e&&!e.overlay)return e.tree.toString();let t="";for(let n of this.children){let i=n.toString();i&&(t&&(t+=","),t+=i)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(t.length?"("+t+")":""):t}cursor(e=0){return new x1(this.topNode,e)}cursorAt(e,t=0,n=0){let i=vu.get(this)||this.topNode,s=new x1(i);return s.moveTo(e,t),vu.set(this,s._tree),s}get topNode(){return new Ba(this,0,0,null)}resolve(e,t=0){let n=eh(vu.get(this)||this.topNode,e,t,!1);return vu.set(this,n),n}resolveInner(e,t=0){let n=eh(w_.get(this)||this.topNode,e,t,!0);return w_.set(this,n),n}resolveStack(e,t=0){return VJ(this,e,t)}iterate(e){let{enter:t,leave:n,from:i=0,to:s=this.length}=e,a=e.mode||0,o=(a&fn.IncludeAnonymous)>0;for(let l=this.cursor(a|fn.IncludeAnonymous);;){let f=!1;if(l.from<=s&&l.to>=i&&(!o&&l.type.isAnonymous||t(l)!==!1)){if(l.firstChild())continue;f=!0}for(;f&&n&&(o||!l.type.isAnonymous)&&n(l),!l.nextSibling();){if(!l.parent())return;f=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let t in this.props)e.push([+t,this.props[t]]);return e}balance(e={}){return this.children.length<=8?this:Ux(Fs.none,this.children,this.positions,0,this.children.length,0,this.length,(t,n,i)=>new m1(this.type,t,n,i,this.propValues),e.makeTree||((t,n,i)=>new m1(Fs.none,t,n,i)))}static build(e){return qJ(e)}};ui.empty=new ui(Fs.none,[],[],0);let WJ=class GE{constructor(e,t){this.buffer=e,this.index=t}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new GE(this.buffer,this.index)}},Xl=class HE{constructor(e,t,n){this.buffer=e,this.length=t,this.set=n}get type(){return Fs.none}toString(){let e=[];for(let t=0;t<this.buffer.length;)e.push(this.childString(t)),t=this.buffer[t+3];return e.join(",")}childString(e){let t=this.buffer[e],n=this.buffer[e+3],i=this.set.types[t],s=i.name;if(/\W/.test(s)&&!i.isError&&(s=JSON.stringify(s)),e+=4,n==e)return s;let a=[];for(;e<n;)a.push(this.childString(e)),e=this.buffer[e+3];return s+"("+a.join(",")+")"}findChild(e,t,n,i,s){let{buffer:a}=this,o=-1;for(let l=e;l!=t&&!(YE(s,i,a[l+1],a[l+2])&&(o=l,n>0));l=a[l+3]);return o}slice(e,t,n){let i=this.buffer,s=new Uint16Array(t-e),a=0;for(let o=e,l=0;o<t;){s[l++]=i[o++],s[l++]=i[o++]-n;let f=s[l++]=i[o++]-n;s[l++]=i[o++]-e,a=Math.max(a,f)}return new HE(s,a,this.set)}};function YE(r,e,t,n){switch(r){case-2:return t<e;case-1:return n>=e&&t<e;case 0:return t<e&&n>e;case 1:return t<=e&&n>e;case 2:return n>e;case 4:return!0}}function eh(r,e,t,n){for(var i;r.from==r.to||(t<1?r.from>=e:r.from>e)||(t>-1?r.to<=e:r.to<e);){let a=!n&&r instanceof Ba&&r.index<0?null:r.parent;if(!a)return r;r=a}let s=n?0:fn.IgnoreOverlays;if(n)for(let a=r,o=a.parent;o;a=o,o=a.parent)a instanceof Ba&&a.index<0&&((i=o.enter(e,t,s))===null||i===void 0?void 0:i.from)!=a.from&&(r=o);for(;;){let a=r.enter(e,t,s);if(!a)return r;r=a}}let KE=class{cursor(e=0){return new x1(this,e)}getChild(e,t=null,n=null){let i=b_(this,e,t,n);return i.length?i[0]:null}getChildren(e,t=null,n=null){return b_(this,e,t,n)}resolve(e,t=0){return eh(this,e,t,!1)}resolveInner(e,t=0){return eh(this,e,t,!0)}matchContext(e){return g1(this.parent,e)}enterUnfinishedNodesBefore(e){let t=this.childBefore(e),n=this;for(;t;){let i=t.lastChild;if(!i||i.to!=t.to)break;i.type.isError&&i.from==i.to?(n=t,t=i.prevSibling):t=i}return n}get node(){return this}get next(){return this.parent}},Ba=class Yu extends KE{constructor(e,t,n,i){super(),this._tree=e,this.from=t,this.index=n,this._parent=i}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,t,n,i,s=0){for(let a=this;;){for(let{children:o,positions:l}=a._tree,f=t>0?o.length:-1;e!=f;e+=t){let c=o[e],h=l[e]+a.from;if(YE(i,n,h,h+c.length)){if(c instanceof Xl){if(s&fn.ExcludeBuffers)continue;let u=c.findChild(0,c.buffer.length,t,n-h,i);if(u>-1)return new O1(new UJ(a,c,e,h),null,u)}else if(s&fn.IncludeAnonymous||!c.type.isAnonymous||Wx(c)){let u;if(!(s&fn.IgnoreMounts)&&(u=r0.get(c))&&!u.overlay)return new Yu(u.tree,h,e,a);let d=new Yu(c,h,e,a);return s&fn.IncludeAnonymous||!d.type.isAnonymous?d:d.nextChild(t<0?c.children.length-1:0,t,n,i)}}}if(s&fn.IncludeAnonymous||!a.type.isAnonymous||(a.index>=0?e=a.index+t:e=t<0?-1:a._parent._tree.children.length,a=a._parent,!a))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}enter(e,t,n=0){let i;if(!(n&fn.IgnoreOverlays)&&(i=r0.get(this._tree))&&i.overlay){let s=e-this.from;for(let{from:a,to:o}of i.overlay)if((t>0?a<=s:a<s)&&(t<0?o>=s:o>s))return new Yu(i.tree,i.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,t,n)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}};function b_(r,e,t,n){let i=r.cursor(),s=[];if(!i.firstChild())return s;if(t!=null){for(let a=!1;!a;)if(a=i.type.is(t),!i.nextSibling())return s}for(;;){if(n!=null&&i.type.is(n))return s;if(i.type.is(e)&&s.push(i.node),!i.nextSibling())return n==null?s:[]}}function g1(r,e,t=e.length-1){for(let n=r;t>=0;n=n.parent){if(!n)return!1;if(!n.type.isAnonymous){if(e[t]&&e[t]!=n.name)return!1;t--}}return!0}let UJ=class{constructor(e,t,n,i){this.parent=e,this.buffer=t,this.index=n,this.start=i}},O1=class jf extends KE{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(e,t,n){super(),this.context=e,this._parent=t,this.index=n,this.type=e.buffer.set.types[e.buffer.buffer[n]]}child(e,t,n){let{buffer:i}=this.context,s=i.findChild(this.index+4,i.buffer[this.index+3],e,t-this.context.start,n);return s<0?null:new jf(this.context,this,s)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}enter(e,t,n=0){if(n&fn.ExcludeBuffers)return null;let{buffer:i}=this.context,s=i.findChild(this.index+4,i.buffer[this.index+3],t>0?1:-1,e-this.context.start,t);return s<0?null:new jf(this.context,this,s)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,t=e.buffer[this.index+3];return t<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new jf(this.context,this._parent,t):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,t=this._parent?this._parent.index+4:0;return this.index==t?this.externalSibling(-1):new jf(this.context,this._parent,e.findChild(t,this.index,-1,0,4))}get tree(){return null}toTree(){let e=[],t=[],{buffer:n}=this.context,i=this.index+4,s=n.buffer[this.index+3];if(s>i){let a=n.buffer[this.index+1];e.push(n.slice(i,s,a)),t.push(0)}return new ui(this.type,e,t,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}};function JE(r){if(!r.length)return null;let e=0,t=r[0];for(let s=1;s<r.length;s++){let a=r[s];(a.from>t.from||a.to<t.to)&&(t=a,e=s)}let n=t instanceof Ba&&t.index<0?null:t.parent,i=r.slice();return n?i[e]=n:i.splice(e,1),new XJ(i,t)}let XJ=class{constructor(e,t){this.heads=e,this.node=t}get next(){return JE(this.heads)}};function VJ(r,e,t){let n=r.resolveInner(e,t),i=null;for(let s=n instanceof Ba?n:n.context.parent;s;s=s.parent)if(s.index<0){let a=s.parent;(i||(i=[n])).push(a.resolve(e,t)),s=a}else{let a=r0.get(s.tree);if(a&&a.overlay&&a.overlay[0].from<=e&&a.overlay[a.overlay.length-1].to>=e){let o=new Ba(a.tree,a.overlay[0].from+s.from,-1,s);(i||(i=[n])).push(eh(o,e,t,!1))}}return i?JE(i):n}let x1=class{get name(){return this.type.name}constructor(e,t=0){if(this.mode=t,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,e instanceof Ba)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let n=e._parent;n;n=n._parent)this.stack.unshift(n.index);this.bufferNode=e,this.yieldBuf(e.index)}}yieldNode(e){return e?(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0):!1}yieldBuf(e,t){this.index=e;let{start:n,buffer:i}=this.buffer;return this.type=t||i.set.types[i.buffer[e]],this.from=n+i.buffer[e+1],this.to=n+i.buffer[e+2],!0}yield(e){return e?e instanceof Ba?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,t,n){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,t,n,this.mode));let{buffer:i}=this.buffer,s=i.findChild(this.index+4,i.buffer[this.index+3],e,t-this.buffer.start,n);return s<0?!1:(this.stack.push(this.index),this.yieldBuf(s))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,t,n=this.mode){return this.buffer?n&fn.ExcludeBuffers?!1:this.enterChild(1,e,t):this.yield(this._tree.enter(e,t,n))}parent(){if(!this.buffer)return this.yieldNode(this.mode&fn.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&fn.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode)):!1;let{buffer:t}=this.buffer,n=this.stack.length-1;if(e<0){let i=n<0?0:this.stack[n]+4;if(this.index!=i)return this.yieldBuf(t.findChild(i,this.index,-1,0,4))}else{let i=t.buffer[this.index+3];if(i<(n<0?t.buffer.length:t.buffer[this.stack[n]+3]))return this.yieldBuf(i)}return n<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let t,n,{buffer:i}=this;if(i){if(e>0){if(this.index<i.buffer.buffer.length)return!1}else for(let s=0;s<this.index;s++)if(i.buffer.buffer[s+3]<this.index)return!1;({index:t,parent:n}=i)}else({index:t,_parent:n}=this._tree);for(;n;{index:t,_parent:n}=n)if(t>-1)for(let s=t+e,a=e<0?-1:n._tree.children.length;s!=a;s+=e){let o=n._tree.children[s];if(this.mode&fn.IncludeAnonymous||o instanceof Xl||!o.type.isAnonymous||Wx(o))return!1}return!0}move(e,t){if(t&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,t=0){for(;(this.from==this.to||(t<1?this.from>=e:this.from>e)||(t>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,t););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,t=null,n=0;if(e&&e.context==this.buffer)e:for(let i=this.index,s=this.stack.length;s>=0;){for(let a=e;a;a=a._parent)if(a.index==i){if(i==this.index)return a;t=a,n=s+1;break e}i=this.stack[--s]}for(let i=n;i<this.stack.length;i++)t=new O1(this.buffer,t,this.stack[i]);return this.bufferNode=new O1(this.buffer,t,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,t){for(let n=0;;){let i=!1;if(this.type.isAnonymous||e(this)!==!1){if(this.firstChild()){n++;continue}this.type.isAnonymous||(i=!0)}for(;;){if(i&&t&&t(this),i=this.type.isAnonymous,!n)return;if(this.nextSibling())break;this.parent(),n--,i=!0}}}matchContext(e){if(!this.buffer)return g1(this.node.parent,e);let{buffer:t}=this.buffer,{types:n}=t.set;for(let i=e.length-1,s=this.stack.length-1;i>=0;s--){if(s<0)return g1(this._tree,e,i);let a=n[t.buffer[this.stack[s]]];if(!a.isAnonymous){if(e[i]&&e[i]!=a.name)return!1;i--}}return!0}};function Wx(r){return r.children.some(e=>e instanceof Xl||!e.type.isAnonymous||Wx(e))}function qJ(r){var e;let{buffer:t,nodeSet:n,maxBufferLength:i=LJ,reused:s=[],minRepeatType:a=n.types.length}=r,o=Array.isArray(t)?new WJ(t,t.length):t,l=n.types,f=0,c=0;function h(y,b,x,A,k,E){let{id:T,start:_,end:N,size:Z}=o,z=c,ee=f;for(;Z<0;)if(o.next(),Z==-1){let ie=s[T];x.push(ie),A.push(_-y);return}else if(Z==-3){f=T;return}else if(Z==-4){c=T;return}else throw new RangeError(`Unrecognized record size: ${Z}`);let ae=l[T],xe,V,ue=_-y;if(N-_<=i&&(V=g(o.pos-b,k))){let ie=new Uint16Array(V.size-V.skip),P=o.pos-V.size,I=ie.length;for(;o.pos>P;)I=O(V.start,ie,I);xe=new Xl(ie,N-V.start,n),ue=V.start-y}else{let ie=o.pos-Z;o.next();let P=[],I=[],B=T>=a?T:-1,W=0,K=N;for(;o.pos>ie;)B>=0&&o.id==B&&o.size>=0?(o.end<=K-i&&(p(P,I,_,W,o.end,K,B,z,ee),W=P.length,K=o.end),o.next()):E>2500?u(_,ie,P,I):h(_,ie,P,I,B,E+1);if(B>=0&&W>0&&W<P.length&&p(P,I,_,W,_,K,B,z,ee),P.reverse(),I.reverse(),B>-1&&W>0){let re=d(ae,ee);xe=Ux(ae,P,I,0,P.length,0,N-_,re,re)}else xe=m(ae,P,I,N-_,z-N,ee)}x.push(xe),A.push(ue)}function u(y,b,x,A){let k=[],E=0,T=-1;for(;o.pos>b;){let{id:_,start:N,end:Z,size:z}=o;if(z>4)o.next();else{if(T>-1&&N<T)break;T<0&&(T=Z-i),k.push(_,N,Z),E++,o.next()}}if(E){let _=new Uint16Array(E*4),N=k[k.length-2];for(let Z=k.length-3,z=0;Z>=0;Z-=3)_[z++]=k[Z],_[z++]=k[Z+1]-N,_[z++]=k[Z+2]-N,_[z++]=z;x.push(new Xl(_,k[2]-N,n)),A.push(N-y)}}function d(y,b){return(x,A,k)=>{let E=0,T=x.length-1,_,N;if(T>=0&&(_=x[T])instanceof ui){if(!T&&_.type==y&&_.length==k)return _;(N=_.prop(tr.lookAhead))&&(E=A[T]+_.length+N)}return m(y,x,A,k,E,b)}}function p(y,b,x,A,k,E,T,_,N){let Z=[],z=[];for(;y.length>A;)Z.push(y.pop()),z.push(b.pop()+x-k);y.push(m(n.types[T],Z,z,E-k,_-E,N)),b.push(k-x)}function m(y,b,x,A,k,E,T){if(E){let _=[tr.contextHash,E];T=T?[_].concat(T):[_]}if(k>25){let _=[tr.lookAhead,k];T=T?[_].concat(T):[_]}return new ui(y,b,x,A,T)}function g(y,b){let x=o.fork(),A=0,k=0,E=0,T=x.end-i,_={size:0,start:0,skip:0};e:for(let N=x.pos-y;x.pos>N;){let Z=x.size;if(x.id==b&&Z>=0){_.size=A,_.start=k,_.skip=E,E+=4,A+=4,x.next();continue}let z=x.pos-Z;if(Z<0||z<N||x.start<T)break;let ee=x.id>=a?4:0,ae=x.start;for(x.next();x.pos>z;){if(x.size<0)if(x.size==-3)ee+=4;else break e;else x.id>=a&&(ee+=4);x.next()}k=ae,A+=Z,E+=ee}return(b<0||A==y)&&(_.size=A,_.start=k,_.skip=E),_.size>4?_:void 0}function O(y,b,x){let{id:A,start:k,end:E,size:T}=o;if(o.next(),T>=0&&A<a){let _=x;if(T>4){let N=o.pos-(T-4);for(;o.pos>N;)x=O(y,b,x)}b[--x]=_,b[--x]=E-y,b[--x]=k-y,b[--x]=A}else T==-3?f=A:T==-4&&(c=A);return x}let w=[],v=[];for(;o.pos>0;)h(r.start||0,r.bufferStart||0,w,v,-1,0);let S=(e=r.length)!==null&&e!==void 0?e:w.length?v[0]+w[0].length:0;return new ui(l[r.topID],w.reverse(),v.reverse(),S)}const __=new WeakMap;function Ku(r,e){if(!r.isAnonymous||e instanceof Xl||e.type!=r)return 1;let t=__.get(e);if(t==null){t=1;for(let n of e.children){if(n.type!=r||!(n instanceof ui)){t=1;break}t+=Ku(r,n)}__.set(e,t)}return t}function Ux(r,e,t,n,i,s,a,o,l){let f=0;for(let p=n;p<i;p++)f+=Ku(r,e[p]);let c=Math.ceil(f*1.5/8),h=[],u=[];function d(p,m,g,O,w){for(let v=g;v<O;){let S=v,y=m[v],b=Ku(r,p[v]);for(v++;v<O;v++){let x=Ku(r,p[v]);if(b+x>=c)break;b+=x}if(v==S+1){if(b>c){let x=p[S];d(x.children,x.positions,0,x.children.length,m[S]+w);continue}h.push(p[S])}else{let x=m[v-1]+p[v-1].length-y;h.push(Ux(r,p,m,S,v,y,x,null,l))}u.push(y+w-s)}}return d(e,t,n,i,0),(o||l)(h,u,a)}let Ju=class v1{constructor(e,t,n,i,s=!1,a=!1){this.from=e,this.to=t,this.tree=n,this.offset=i,this.open=(s?1:0)|(a?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(e,t=[],n=!1){let i=[new v1(0,e.length,e,0,!1,n)];for(let s of t)s.to>e.length&&i.push(s);return i}static applyChanges(e,t,n=128){if(!t.length)return e;let i=[],s=1,a=e.length?e[0]:null;for(let o=0,l=0,f=0;;o++){let c=o<t.length?t[o]:null,h=c?c.fromA:1e9;if(h-l>=n)for(;a&&a.from<h;){let u=a;if(l>=u.from||h<=u.to||f){let d=Math.max(u.from,l)-f,p=Math.min(u.to,h)-f;u=d>=p?null:new v1(d,p,u.tree,u.offset+f,o>0,!!c)}if(u&&i.push(u),a.to>h)break;a=s<e.length?e[s++]:null}if(!c)break;l=c.toA,f=c.toA-c.toB}return i}},jJ=class{startParse(e,t,n){return typeof e=="string"&&(e=new zJ(e)),n=n?n.length?n.map(i=>new Yp(i.from,i.to)):[new Yp(0,0)]:[new Yp(0,e.length)],this.createParse(e,t||[],n)}parse(e,t,n){let i=this.startParse(e,t,n);for(;;){let s=i.advance();if(s)return s}}},zJ=class{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,t){return this.string.slice(e,t)}};new tr({perNode:!0});var Kp;const ll=new tr;function GJ(r){return Ze.define({combine:r?e=>e.concat(r):void 0})}const HJ=new tr;let zi=class{constructor(e,t,n=[],i=""){this.data=e,this.name=i,st.prototype.hasOwnProperty("tree")||Object.defineProperty(st.prototype,"tree",{get(){return w1(this)}}),this.parser=t,this.extension=[Vl.of(this),st.languageData.of((s,a,o)=>{let l=k_(s,a,o),f=l.type.prop(ll);if(!f)return[];let c=s.facet(f),h=l.type.prop(HJ);if(h){let u=l.resolve(a-l.from,o);for(let d of h)if(d.test(u,s)){let p=s.facet(d.facet);return d.type=="replace"?p:p.concat(c)}}return c})].concat(n)}isActiveAt(e,t,n=-1){return k_(e,t,n).type.prop(ll)==this.data}findRegions(e){let t=e.facet(Vl);if((t==null?void 0:t.data)==this.data)return[{from:0,to:e.doc.length}];if(!t||!t.allowsNesting)return[];let n=[],i=(s,a)=>{if(s.prop(ll)==this.data){n.push({from:a,to:a+s.length});return}let o=s.prop(tr.mounted);if(o){if(o.tree.prop(ll)==this.data){if(o.overlay)for(let l of o.overlay)n.push({from:l.from+a,to:l.to+a});else n.push({from:a,to:a+s.length});return}else if(o.overlay){let l=n.length;if(i(o.tree,o.overlay[0].from+a),n.length>l)return}}for(let l=0;l<s.children.length;l++){let f=s.children[l];f instanceof ui&&i(f,s.positions[l]+a)}};return i(w1(e),0),n}get allowsNesting(){return!0}};zi.setState=rt.define();function k_(r,e,t){let n=r.facet(Vl),i=w1(r).topNode;if(!n||n.allowsNesting)for(let s=i;s;s=s.enter(e,t,fn.ExcludeBuffers))s.type.isTop&&(i=s);return i}let YJ=class y1 extends zi{constructor(e,t,n){super(e,t,[],n),this.parser=t}static define(e){let t=GJ(e.languageData);return new y1(t,e.parser.configure({props:[ll.add(n=>n.isTop?t:void 0)]}),e.name)}configure(e,t){return new y1(this.data,this.parser.configure(e),t||this.name)}get allowsNesting(){return this.parser.hasWrappers()}};function w1(r){let e=r.field(zi.state,!1);return e?e.tree:ui.empty}let KJ=class{constructor(e){this.doc=e,this.cursorPos=0,this.string="",this.cursor=e.iter()}get length(){return this.doc.length}syncTo(e){return this.string=this.cursor.next(e-this.cursorPos).value,this.cursorPos=e+this.string.length,this.cursorPos-this.string.length}chunk(e){return this.syncTo(e),this.string}get lineChunks(){return!0}read(e,t){let n=this.cursorPos-this.string.length;return e<n||t>=this.cursorPos?this.doc.sliceString(e,t):this.string.slice(e-n,t-n)}},kf=null,JJ=class b1{constructor(e,t,n=[],i,s,a,o,l){this.parser=e,this.state=t,this.fragments=n,this.tree=i,this.treeLen=s,this.viewport=a,this.skipped=o,this.scheduleOn=l,this.parse=null,this.tempSkipped=[]}static create(e,t,n){return new b1(e,t,[],ui.empty,0,n,[],null)}startParse(){return this.parser.startParse(new KJ(this.state.doc),this.fragments)}work(e,t){return t!=null&&t>=this.state.doc.length&&(t=void 0),this.tree!=ui.empty&&this.isDone(t??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var n;if(typeof e=="number"){let i=Date.now()+e;e=()=>Date.now()>i}for(this.parse||(this.parse=this.startParse()),t!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>t)&&t<this.state.doc.length&&this.parse.stopAt(t);;){let i=this.parse.advance();if(i)if(this.fragments=this.withoutTempSkipped(Ju.addTree(i,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(n=this.parse.stoppedAt)!==null&&n!==void 0?n:this.state.doc.length,this.tree=i,this.parse=null,this.treeLen<(t??this.state.doc.length))this.parse=this.startParse();else return!0;if(e())return!1}})}takeTree(){let e,t;this.parse&&(e=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>e)&&this.parse.stopAt(e),this.withContext(()=>{for(;!(t=this.parse.advance()););}),this.treeLen=e,this.tree=t,this.fragments=this.withoutTempSkipped(Ju.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(e){let t=kf;kf=this;try{return e()}finally{kf=t}}withoutTempSkipped(e){for(let t;t=this.tempSkipped.pop();)e=S_(e,t.from,t.to);return e}changes(e,t){let{fragments:n,tree:i,treeLen:s,viewport:a,skipped:o}=this;if(this.takeTree(),!e.empty){let l=[];if(e.iterChangedRanges((f,c,h,u)=>l.push({fromA:f,toA:c,fromB:h,toB:u})),n=Ju.applyChanges(n,l),i=ui.empty,s=0,a={from:e.mapPos(a.from,-1),to:e.mapPos(a.to,1)},this.skipped.length){o=[];for(let f of this.skipped){let c=e.mapPos(f.from,1),h=e.mapPos(f.to,-1);c<h&&o.push({from:c,to:h})}}}return new b1(this.parser,t,n,i,s,a,o,this.scheduleOn)}updateViewport(e){if(this.viewport.from==e.from&&this.viewport.to==e.to)return!1;this.viewport=e;let t=this.skipped.length;for(let n=0;n<this.skipped.length;n++){let{from:i,to:s}=this.skipped[n];i<e.to&&s>e.from&&(this.fragments=S_(this.fragments,i,s),this.skipped.splice(n--,1))}return this.skipped.length>=t?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(e,t){this.skipped.push({from:e,to:t})}static getSkippingParser(e){return new class extends jJ{createParse(t,n,i){let s=i[0].from,a=i[i.length-1].to;return{parsedPos:s,advance(){let l=kf;if(l){for(let f of i)l.tempSkipped.push(f);e&&(l.scheduleOn=l.scheduleOn?Promise.all([l.scheduleOn,e]):e)}return this.parsedPos=a,new ui(Fs.none,[],[],a-s)},stoppedAt:null,stopAt(){}}}}}isDone(e){e=Math.min(e,this.state.doc.length);let t=this.fragments;return this.treeLen>=e&&t.length&&t[0].from==0&&t[0].to>=e}static get(){return kf}};function S_(r,e,t){return Ju.applyChanges(r,[{fromA:e,toA:t,fromB:e,toB:t}])}let _1=class k1{constructor(e){this.context=e,this.tree=e.tree}apply(e){if(!e.docChanged&&this.tree==this.context.tree)return this;let t=this.context.changes(e.changes,e.state),n=this.context.treeLen==e.startState.doc.length?void 0:Math.max(e.changes.mapPos(this.context.treeLen),t.viewport.to);return t.work(20,n)||t.takeTree(),new k1(t)}static init(e){let t=Math.min(3e3,e.doc.length),n=JJ.create(e.facet(Vl).parser,e,{from:0,to:t});return n.work(20,t)||n.takeTree(),new k1(n)}};zi.state=Cr.define({create:_1.init,update(r,e){for(let t of e.effects)if(t.is(zi.setState))return t.value;return e.startState.facet(Vl)!=e.state.facet(Vl)?_1.init(e.state):r.apply(e)}});let eP=r=>{let e=setTimeout(()=>r(),500);return()=>clearTimeout(e)};typeof requestIdleCallback<"u"&&(eP=r=>{let e=-1,t=setTimeout(()=>{e=requestIdleCallback(r,{timeout:400})},100);return()=>e<0?clearTimeout(t):cancelIdleCallback(e)});const Jp=typeof navigator<"u"&&(!((Kp=navigator.scheduling)===null||Kp===void 0)&&Kp.isInputPending)?()=>navigator.scheduling.isInputPending():null,eee=pr.fromClass(class{constructor(e){this.view=e,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(e){let t=this.view.state.field(zi.state).context;(t.updateViewport(e.view.viewport)||this.view.viewport.to>t.treeLen)&&this.scheduleWork(),(e.docChanged||e.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(t)}scheduleWork(){if(this.working)return;let{state:e}=this.view,t=e.field(zi.state);(t.tree!=t.context.tree||!t.context.isDone(e.doc.length))&&(this.working=eP(this.work))}work(e){this.working=null;let t=Date.now();if(this.chunkEnd<t&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=t+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:n,viewport:{to:i}}=this.view,s=n.field(zi.state);if(s.tree==s.context.tree&&s.context.isDone(i+1e5))return;let a=Date.now()+Math.min(this.chunkBudget,100,e&&!Jp?Math.max(25,e.timeRemaining()-5):1e9),o=s.context.treeLen<i&&n.doc.length>i+1e3,l=s.context.work(()=>Jp&&Jp()||Date.now()>a,i+(o?0:1e5));this.chunkBudget-=Date.now()-t,(l||this.chunkBudget<=0)&&(s.context.takeTree(),this.view.dispatch({effects:zi.setState.of(new _1(s.context))})),this.chunkBudget>0&&!(l&&!o)&&this.scheduleWork(),this.checkAsyncSchedule(s.context)}checkAsyncSchedule(e){e.scheduleOn&&(this.workScheduled++,e.scheduleOn.then(()=>this.scheduleWork()).catch(t=>tn(this.view.state,t)).then(()=>this.workScheduled--),e.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),Vl=Ze.define({combine(r){return r.length?r[0]:null},enables:r=>[zi.state,eee,We.contentAttributes.compute([r],e=>{let t=e.facet(r);return t&&t.name?{"data-language":t.name}:{}})]});let tee=class{constructor(e,t=[]){this.language=e,this.support=t,this.extension=[e,t]}};const ree=new tr;function T_({except:r,units:e=1}={}){return t=>{let n=r&&r.test(t.textAfter);return t.baseIndent+(n?0:e*t.unit)}}const nee=new tr;function iee(r){let e=r.firstChild,t=r.lastChild;return e&&e.to<t.from?{from:e.to,to:t.type.isError?r.to:t.from}:null}let see=class tP{constructor(e,t){this.specs=e;let n;function i(o){let l=An.newName();return(n||(n=Object.create(null)))["."+l]=o,l}const s=typeof t.all=="string"?t.all:t.all?i(t.all):void 0,a=t.scope;this.scope=a instanceof zi?o=>o.prop(ll)==a.data:a?o=>o==a:void 0,this.style=af(e.map(o=>({tag:o.tag,class:o.class||i(Object.assign({},o,{tag:null}))})),{all:s}).style,this.module=n?new An(n):null,this.themeType=t.themeType}static define(e,t){return new tP(e,t||{})}};L.meta,L.link,L.heading,L.emphasis,L.strong,L.strikethrough,L.keyword,L.atom,L.bool,L.url,L.contentSeparator,L.labelName,L.literal,L.inserted,L.string,L.deleted,L.regexp,L.escape,L.string,L.variableName,L.variableName,L.typeName,L.namespace,L.className,L.variableName,L.macroName,L.propertyName,L.comment,L.invalid;const aee=Object.create(null),C_=[Fs.none],A_=[],E_=Object.create(null),oee=Object.create(null);for(let[r,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])oee[r]=lee(aee,e);function em(r,e){A_.indexOf(r)>-1||(A_.push(r),console.warn(e))}function lee(r,e){let t=[];for(let o of e.split(" ")){let l=[];for(let f of o.split(".")){let c=r[f]||L[f];c?typeof c=="function"?l.length?l=l.map(c):em(f,`Modifier ${f} used at start of tag`):l.length?em(f,`Tag ${f} used as modifier`):l=Array.isArray(c)?c:[c]:em(f,`Unknown highlighting tag ${f}`)}for(let f of l)t.push(f)}if(!t.length)return 0;let n=e.replace(/ /g,"_"),i=n+" "+t.map(o=>o.id),s=E_[i];if(s)return s.id;let a=E_[i]=Fs.define({id:C_.length,name:n,props:[oa({[n]:t})]});return C_.push(a),a.id}Et.RTL,Et.LTR;const fee=YJ.define({name:"json",parser:IJ.configure({props:[ree.add({Object:T_({except:/^\s*\}/}),Array:T_({except:/^\s*\]/})}),nee.add({"Object Array":iee})]}),languageData:{closeBrackets:{brackets:["[","{",'"']},indentOnInput:/^\s*[\}\]]$/}});function cee(){return new tee(fee)}const S1=1,hee=2,uee=3,dee=4,pee=5,mee=36,gee=37,Oee=38,xee=11,vee=13;function yee(r){return r==45||r==46||r==58||r>=65&&r<=90||r==95||r>=97&&r<=122||r>=161}function wee(r){return r==9||r==10||r==13||r==32}let P_=null,R_=null,Q_=0;function T1(r,e){let t=r.pos+e;if(R_==r&&Q_==t)return P_;for(;wee(r.peek(e));)e++;let n="";for(;;){let i=r.peek(e);if(!yee(i))break;n+=String.fromCharCode(i),e++}return R_=r,Q_=t,P_=n||null}function F_(r,e){this.name=r,this.parent=e}const bee=new AE({start:null,shift(r,e,t,n){return e==S1?new F_(T1(n,1)||"",r):r},reduce(r,e){return e==xee&&r?r.parent:r},reuse(r,e,t,n){let i=e.type.id;return i==S1||i==vee?new F_(T1(n,1)||"",r):r},strict:!1}),_ee=new Ga((r,e)=>{if(r.next==60){if(r.advance(),r.next==47){r.advance();let t=T1(r,0);if(!t)return r.acceptToken(pee);if(e.context&&t==e.context.name)return r.acceptToken(hee);for(let n=e.context;n;n=n.parent)if(n.name==t)return r.acceptToken(uee,-2);r.acceptToken(dee)}else if(r.next!=33&&r.next!=63)return r.acceptToken(S1)}},{contextual:!0});function Xx(r,e){return new Ga(t=>{let n=0,i=e.charCodeAt(0);e:for(;!(t.next<0);t.advance(),n++)if(t.next==i){for(let s=1;s<e.length;s++)if(t.peek(s)!=e.charCodeAt(s))continue e;break}n&&t.acceptToken(r)})}const kee=Xx(mee,"-->"),See=Xx(gee,"?>"),Tee=Xx(Oee,"]]>"),Cee=oa({Text:L.content,"StartTag StartCloseTag EndTag SelfCloseEndTag":L.angleBracket,TagName:L.tagName,"MismatchedCloseTag/TagName":[L.tagName,L.invalid],AttributeName:L.attributeName,AttributeValue:L.attributeValue,Is:L.definitionOperator,"EntityReference CharacterReference":L.character,Comment:L.blockComment,ProcessingInst:L.processingInstruction,DoctypeDecl:L.documentMeta,Cdata:L.special(L.string)}),Aee=No.deserialize({version:14,states:",lOQOaOOOrOxO'#CfOzOpO'#CiO!tOaO'#CgOOOP'#Cg'#CgO!{OrO'#CrO#TOtO'#CsO#]OpO'#CtOOOP'#DT'#DTOOOP'#Cv'#CvQQOaOOOOOW'#Cw'#CwO#eOxO,59QOOOP,59Q,59QOOOO'#Cx'#CxO#mOpO,59TO#uO!bO,59TOOOP'#C|'#C|O$TOaO,59RO$[OpO'#CoOOOP,59R,59ROOOQ'#C}'#C}O$dOrO,59^OOOP,59^,59^OOOS'#DO'#DOO$lOtO,59_OOOP,59_,59_O$tOpO,59`O$|OpO,59`OOOP-E6t-E6tOOOW-E6u-E6uOOOP1G.l1G.lOOOO-E6v-E6vO%UO!bO1G.oO%UO!bO1G.oO%dOpO'#CkO%lO!bO'#CyO%zO!bO1G.oOOOP1G.o1G.oOOOP1G.w1G.wOOOP-E6z-E6zOOOP1G.m1G.mO&VOpO,59ZO&_OpO,59ZOOOQ-E6{-E6{OOOP1G.x1G.xOOOS-E6|-E6|OOOP1G.y1G.yO&gOpO1G.zO&gOpO1G.zOOOP1G.z1G.zO&oO!bO7+$ZO&}O!bO7+$ZOOOP7+$Z7+$ZOOOP7+$c7+$cO'YOpO,59VO'bOpO,59VO'mO!bO,59eOOOO-E6w-E6wO'{OpO1G.uO'{OpO1G.uOOOP1G.u1G.uO(TOpO7+$fOOOP7+$f7+$fO(]O!bO<<GuOOOP<<Gu<<GuOOOP<<G}<<G}O'bOpO1G.qO'bOpO1G.qO(hO#tO'#CnO(vO&jO'#CnOOOO1G.q1G.qO)UOpO7+$aOOOP7+$a7+$aOOOP<<HQ<<HQOOOPAN=aAN=aOOOPAN=iAN=iO'bOpO7+$]OOOO7+$]7+$]OOOO'#Cz'#CzO)^O#tO,59YOOOO,59Y,59YOOOO'#C{'#C{O)lO&jO,59YOOOP<<G{<<G{OOOO<<Gw<<GwOOOO-E6x-E6xOOOO1G.t1G.tOOOO-E6y-E6y",stateData:")z~OPQOSVOTWOVWOWWOXWOiXOyPO!QTO!SUO~OvZOx]O~O^`Oz^O~OPQOQcOSVOTWOVWOWWOXWOyPO!QTO!SUO~ORdO~P!SOteO!PgO~OuhO!RjO~O^lOz^O~OvZOxoO~O^qOz^O~O[vO`sOdwOz^O~ORyO~P!SO^{Oz^O~OteO!P}O~OuhO!R!PO~O^!QOz^O~O[!SOz^O~O[!VO`sOd!WOz^O~Oa!YOz^O~Oz^O[mX`mXdmX~O[!VO`sOd!WO~O^!]Oz^O~O[!_Oz^O~O[!aOz^O~O[!cO`sOd!dOz^O~O[!cO`sOd!dO~Oa!eOz^O~Oz^O{!gO}!hO~Oz^O[ma`madma~O[!kOz^O~O[!lOz^O~O[!mO`sOd!nO~OW!qOX!qO{!sO|!qO~OW!tOX!tO}!sO!O!tO~O[!vOz^O~OW!qOX!qO{!yO|!qO~OW!tOX!tO}!yO!O!tO~O",goto:"%cxPPPPPPPPPPyyP!PP!VPP!`!jP!pyyyP!v!|#S$[$k$q$w$}%TPPPP%ZXWORYbXRORYb_t`qru!T!U!bQ!i!YS!p!e!fR!w!oQdRRybXSORYbQYORmYQ[PRn[Q_QQkVjp_krz!R!T!X!Z!^!`!f!j!oQr`QzcQ!RlQ!TqQ!XsQ!ZtQ!^{Q!`!QQ!f!YQ!j!]R!o!eQu`S!UqrU![u!U!bR!b!TQ!r!gR!x!rQ!u!hR!z!uQbRRxbQfTR|fQiUR!OiSXOYTaRb",nodeNames:" StartTag StartCloseTag MissingCloseTag StartCloseTag StartCloseTag Document Text EntityReference CharacterReference Cdata Element EndTag OpenTag TagName Attribute AttributeName Is AttributeValue CloseTag SelfCloseEndTag SelfClosingTag Comment ProcessingInst MismatchedCloseTag DoctypeDecl",maxTerm:50,context:bee,nodeProps:[["closedBy",1,"SelfCloseEndTag EndTag",13,"CloseTag MissingCloseTag"],["openedBy",12,"StartTag StartCloseTag",19,"OpenTag",20,"StartTag"],["isolate",-6,13,18,19,21,22,24,""]],propSources:[Cee],skippedNodes:[0],repeatNodeCount:9,tokenData:"!)v~R!YOX$qXY)iYZ)iZ]$q]^)i^p$qpq)iqr$qrs*vsv$qvw+fwx/ix}$q}!O0[!O!P$q!P!Q2z!Q![$q![!]4n!]!^$q!^!_8U!_!`!#t!`!a!$l!a!b!%d!b!c$q!c!}4n!}#P$q#P#Q!'W#Q#R$q#R#S4n#S#T$q#T#o4n#o%W$q%W%o4n%o%p$q%p&a4n&a&b$q&b1p4n1p4U$q4U4d4n4d4e$q4e$IS4n$IS$I`$q$I`$Ib4n$Ib$Kh$q$Kh%#t4n%#t&/x$q&/x&Et4n&Et&FV$q&FV;'S4n;'S;:j8O;:j;=`)c<%l?&r$q?&r?Ah4n?Ah?BY$q?BY?Mn4n?MnO$qi$zXVP|W!O`Or$qrs%gsv$qwx'^x!^$q!^!_(o!_;'S$q;'S;=`)c<%lO$qa%nVVP!O`Ov%gwx&Tx!^%g!^!_&o!_;'S%g;'S;=`'W<%lO%gP&YTVPOv&Tw!^&T!_;'S&T;'S;=`&i<%lO&TP&lP;=`<%l&T`&tS!O`Ov&ox;'S&o;'S;=`'Q<%lO&o`'TP;=`<%l&oa'ZP;=`<%l%gX'eWVP|WOr'^rs&Tsv'^w!^'^!^!_'}!_;'S'^;'S;=`(i<%lO'^W(ST|WOr'}sv'}w;'S'};'S;=`(c<%lO'}W(fP;=`<%l'}X(lP;=`<%l'^h(vV|W!O`Or(ors&osv(owx'}x;'S(o;'S;=`)]<%lO(oh)`P;=`<%l(oi)fP;=`<%l$qo)t`VP|W!O`zUOX$qXY)iYZ)iZ]$q]^)i^p$qpq)iqr$qrs%gsv$qwx'^x!^$q!^!_(o!_;'S$q;'S;=`)c<%lO$qk+PV{YVP!O`Ov%gwx&Tx!^%g!^!_&o!_;'S%g;'S;=`'W<%lO%g~+iast,n![!]-r!c!}-r#R#S-r#T#o-r%W%o-r%p&a-r&b1p-r4U4d-r4e$IS-r$I`$Ib-r$Kh%#t-r&/x&Et-r&FV;'S-r;'S;:j/c?&r?Ah-r?BY?Mn-r~,qQ!Q![,w#l#m-V~,zQ!Q![,w!]!^-Q~-VOX~~-YR!Q![-c!c!i-c#T#Z-c~-fS!Q![-c!]!^-Q!c!i-c#T#Z-c~-ug}!O-r!O!P-r!Q![-r![!]-r!]!^/^!c!}-r#R#S-r#T#o-r$}%O-r%W%o-r%p&a-r&b1p-r1p4U-r4U4d-r4e$IS-r$I`$Ib-r$Je$Jg-r$Kh%#t-r&/x&Et-r&FV;'S-r;'S;:j/c?&r?Ah-r?BY?Mn-r~/cOW~~/fP;=`<%l-rk/rW}bVP|WOr'^rs&Tsv'^w!^'^!^!_'}!_;'S'^;'S;=`(i<%lO'^k0eZVP|W!O`Or$qrs%gsv$qwx'^x}$q}!O1W!O!^$q!^!_(o!_;'S$q;'S;=`)c<%lO$qk1aZVP|W!O`Or$qrs%gsv$qwx'^x!^$q!^!_(o!_!`$q!`!a2S!a;'S$q;'S;=`)c<%lO$qk2_X!PQVP|W!O`Or$qrs%gsv$qwx'^x!^$q!^!_(o!_;'S$q;'S;=`)c<%lO$qm3TZVP|W!O`Or$qrs%gsv$qwx'^x!^$q!^!_(o!_!`$q!`!a3v!a;'S$q;'S;=`)c<%lO$qm4RXdSVP|W!O`Or$qrs%gsv$qwx'^x!^$q!^!_(o!_;'S$q;'S;=`)c<%lO$qo4{!P`S^QVP|W!O`Or$qrs%gsv$qwx'^x}$q}!O4n!O!P4n!P!Q$q!Q![4n![!]4n!]!^$q!^!_(o!_!c$q!c!}4n!}#R$q#R#S4n#S#T$q#T#o4n#o$}$q$}%O4n%O%W$q%W%o4n%o%p$q%p&a4n&a&b$q&b1p4n1p4U4n4U4d4n4d4e$q4e$IS4n$IS$I`$q$I`$Ib4n$Ib$Je$q$Je$Jg4n$Jg$Kh$q$Kh%#t4n%#t&/x$q&/x&Et4n&Et&FV$q&FV;'S4n;'S;:j8O;:j;=`)c<%l?&r$q?&r?Ah4n?Ah?BY$q?BY?Mn4n?MnO$qo8RP;=`<%l4ni8]Y|W!O`Oq(oqr8{rs&osv(owx'}x!a(o!a!b!#U!b;'S(o;'S;=`)]<%lO(oi9S_|W!O`Or(ors&osv(owx'}x}(o}!O:R!O!f(o!f!g;e!g!}(o!}#ODh#O#W(o#W#XLp#X;'S(o;'S;=`)]<%lO(oi:YX|W!O`Or(ors&osv(owx'}x}(o}!O:u!O;'S(o;'S;=`)]<%lO(oi;OV!QP|W!O`Or(ors&osv(owx'}x;'S(o;'S;=`)]<%lO(oi;lX|W!O`Or(ors&osv(owx'}x!q(o!q!r<X!r;'S(o;'S;=`)]<%lO(oi<`X|W!O`Or(ors&osv(owx'}x!e(o!e!f<{!f;'S(o;'S;=`)]<%lO(oi=SX|W!O`Or(ors&osv(owx'}x!v(o!v!w=o!w;'S(o;'S;=`)]<%lO(oi=vX|W!O`Or(ors&osv(owx'}x!{(o!{!|>c!|;'S(o;'S;=`)]<%lO(oi>jX|W!O`Or(ors&osv(owx'}x!r(o!r!s?V!s;'S(o;'S;=`)]<%lO(oi?^X|W!O`Or(ors&osv(owx'}x!g(o!g!h?y!h;'S(o;'S;=`)]<%lO(oi@QY|W!O`Or?yrs@psv?yvwA[wxBdx!`?y!`!aCr!a;'S?y;'S;=`Db<%lO?ya@uV!O`Ov@pvxA[x!`@p!`!aAy!a;'S@p;'S;=`B^<%lO@pPA_TO!`A[!`!aAn!a;'SA[;'S;=`As<%lOA[PAsOiPPAvP;=`<%lA[aBQSiP!O`Ov&ox;'S&o;'S;=`'Q<%lO&oaBaP;=`<%l@pXBiX|WOrBdrsA[svBdvwA[w!`Bd!`!aCU!a;'SBd;'S;=`Cl<%lOBdXC]TiP|WOr'}sv'}w;'S'};'S;=`(c<%lO'}XCoP;=`<%lBdiC{ViP|W!O`Or(ors&osv(owx'}x;'S(o;'S;=`)]<%lO(oiDeP;=`<%l?yiDoZ|W!O`Or(ors&osv(owx'}x!e(o!e!fEb!f#V(o#V#WIr#W;'S(o;'S;=`)]<%lO(oiEiX|W!O`Or(ors&osv(owx'}x!f(o!f!gFU!g;'S(o;'S;=`)]<%lO(oiF]X|W!O`Or(ors&osv(owx'}x!c(o!c!dFx!d;'S(o;'S;=`)]<%lO(oiGPX|W!O`Or(ors&osv(owx'}x!v(o!v!wGl!w;'S(o;'S;=`)]<%lO(oiGsX|W!O`Or(ors&osv(owx'}x!c(o!c!dH`!d;'S(o;'S;=`)]<%lO(oiHgX|W!O`Or(ors&osv(owx'}x!}(o!}#OIS#O;'S(o;'S;=`)]<%lO(oiI]V|W!O`yPOr(ors&osv(owx'}x;'S(o;'S;=`)]<%lO(oiIyX|W!O`Or(ors&osv(owx'}x#W(o#W#XJf#X;'S(o;'S;=`)]<%lO(oiJmX|W!O`Or(ors&osv(owx'}x#T(o#T#UKY#U;'S(o;'S;=`)]<%lO(oiKaX|W!O`Or(ors&osv(owx'}x#h(o#h#iK|#i;'S(o;'S;=`)]<%lO(oiLTX|W!O`Or(ors&osv(owx'}x#T(o#T#UH`#U;'S(o;'S;=`)]<%lO(oiLwX|W!O`Or(ors&osv(owx'}x#c(o#c#dMd#d;'S(o;'S;=`)]<%lO(oiMkX|W!O`Or(ors&osv(owx'}x#V(o#V#WNW#W;'S(o;'S;=`)]<%lO(oiN_X|W!O`Or(ors&osv(owx'}x#h(o#h#iNz#i;'S(o;'S;=`)]<%lO(oi! RX|W!O`Or(ors&osv(owx'}x#m(o#m#n! n#n;'S(o;'S;=`)]<%lO(oi! uX|W!O`Or(ors&osv(owx'}x#d(o#d#e!!b#e;'S(o;'S;=`)]<%lO(oi!!iX|W!O`Or(ors&osv(owx'}x#X(o#X#Y?y#Y;'S(o;'S;=`)]<%lO(oi!#_V!SP|W!O`Or(ors&osv(owx'}x;'S(o;'S;=`)]<%lO(ok!$PXaQVP|W!O`Or$qrs%gsv$qwx'^x!^$q!^!_(o!_;'S$q;'S;=`)c<%lO$qo!$wX[UVP|W!O`Or$qrs%gsv$qwx'^x!^$q!^!_(o!_;'S$q;'S;=`)c<%lO$qk!%mZVP|W!O`Or$qrs%gsv$qwx'^x!^$q!^!_(o!_!`$q!`!a!&`!a;'S$q;'S;=`)c<%lO$qk!&kX!RQVP|W!O`Or$qrs%gsv$qwx'^x!^$q!^!_(o!_;'S$q;'S;=`)c<%lO$qk!'aZVP|W!O`Or$qrs%gsv$qwx'^x!^$q!^!_(o!_#P$q#P#Q!(S#Q;'S$q;'S;=`)c<%lO$qk!(]ZVP|W!O`Or$qrs%gsv$qwx'^x!^$q!^!_(o!_!`$q!`!a!)O!a;'S$q;'S;=`)c<%lO$qk!)ZXxQVP|W!O`Or$qrs%gsv$qwx'^x!^$q!^!_(o!_;'S$q;'S;=`)c<%lO$q",tokenizers:[_ee,kee,See,Tee,0,1,2,3,4],topRules:{Document:[0,6]},tokenPrec:0}),Eee=1024;let Pee=0,tm=class{constructor(e,t){this.from=e,this.to=t}},zt=class{constructor(e={}){this.id=Pee++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof e!="function"&&(e=$s.match(e)),t=>{let n=e(t);return n===void 0?null:[this,n]}}};zt.closedBy=new zt({deserialize:r=>r.split(" ")});zt.openedBy=new zt({deserialize:r=>r.split(" ")});zt.group=new zt({deserialize:r=>r.split(" ")});zt.isolate=new zt({deserialize:r=>{if(r&&r!="rtl"&&r!="ltr"&&r!="auto")throw new RangeError("Invalid value for isolate: "+r);return r||"auto"}});zt.contextHash=new zt({perNode:!0});zt.lookAhead=new zt({perNode:!0});zt.mounted=new zt({perNode:!0});let n0=class{constructor(e,t,n){this.tree=e,this.overlay=t,this.parser=n}static get(e){return e&&e.props&&e.props[zt.mounted.id]}};const Ree=Object.create(null);let $s=class rP{constructor(e,t,n,i=0){this.name=e,this.props=t,this.id=n,this.flags=i}static define(e){let t=e.props&&e.props.length?Object.create(null):Ree,n=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(e.name==null?8:0),i=new rP(e.name||"",t,e.id,n);if(e.props){for(let s of e.props)if(Array.isArray(s)||(s=s(i)),s){if(s[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");t[s[0].id]=s[1]}}return i}prop(e){return this.props[e.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(e){if(typeof e=="string"){if(this.name==e)return!0;let t=this.prop(zt.group);return t?t.indexOf(e)>-1:!1}return this.id==e}static match(e){let t=Object.create(null);for(let n in e)for(let i of n.split(" "))t[i]=e[n];return n=>{for(let i=n.prop(zt.group),s=-1;s<(i?i.length:0);s++){let a=t[s<0?n.name:i[s]];if(a)return a}}}};$s.none=new $s("",Object.create(null),0,8);const yu=new WeakMap,$_=new WeakMap;var cn;(function(r){r[r.ExcludeBuffers=1]="ExcludeBuffers",r[r.IncludeAnonymous=2]="IncludeAnonymous",r[r.IgnoreMounts=4]="IgnoreMounts",r[r.IgnoreOverlays=8]="IgnoreOverlays"})(cn||(cn={}));let di=class C1{constructor(e,t,n,i,s){if(this.type=e,this.children=t,this.positions=n,this.length=i,this.props=null,s&&s.length){this.props=Object.create(null);for(let[a,o]of s)this.props[typeof a=="number"?a:a.id]=o}}toString(){let e=n0.get(this);if(e&&!e.overlay)return e.tree.toString();let t="";for(let n of this.children){let i=n.toString();i&&(t&&(t+=","),t+=i)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(t.length?"("+t+")":""):t}cursor(e=0){return new P1(this.topNode,e)}cursorAt(e,t=0,n=0){let i=yu.get(this)||this.topNode,s=new P1(i);return s.moveTo(e,t),yu.set(this,s._tree),s}get topNode(){return new Za(this,0,0,null)}resolve(e,t=0){let n=th(yu.get(this)||this.topNode,e,t,!1);return yu.set(this,n),n}resolveInner(e,t=0){let n=th($_.get(this)||this.topNode,e,t,!0);return $_.set(this,n),n}resolveStack(e,t=0){return Dee(this,e,t)}iterate(e){let{enter:t,leave:n,from:i=0,to:s=this.length}=e,a=e.mode||0,o=(a&cn.IncludeAnonymous)>0;for(let l=this.cursor(a|cn.IncludeAnonymous);;){let f=!1;if(l.from<=s&&l.to>=i&&(!o&&l.type.isAnonymous||t(l)!==!1)){if(l.firstChild())continue;f=!0}for(;f&&n&&(o||!l.type.isAnonymous)&&n(l),!l.nextSibling();){if(!l.parent())return;f=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let t in this.props)e.push([+t,this.props[t]]);return e}balance(e={}){return this.children.length<=8?this:qx($s.none,this.children,this.positions,0,this.children.length,0,this.length,(t,n,i)=>new C1(this.type,t,n,i,this.propValues),e.makeTree||((t,n,i)=>new C1($s.none,t,n,i)))}static build(e){return Nee(e)}};di.empty=new di($s.none,[],[],0);let Qee=class nP{constructor(e,t){this.buffer=e,this.index=t}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new nP(this.buffer,this.index)}},ql=class iP{constructor(e,t,n){this.buffer=e,this.length=t,this.set=n}get type(){return $s.none}toString(){let e=[];for(let t=0;t<this.buffer.length;)e.push(this.childString(t)),t=this.buffer[t+3];return e.join(",")}childString(e){let t=this.buffer[e],n=this.buffer[e+3],i=this.set.types[t],s=i.name;if(/\W/.test(s)&&!i.isError&&(s=JSON.stringify(s)),e+=4,n==e)return s;let a=[];for(;e<n;)a.push(this.childString(e)),e=this.buffer[e+3];return s+"("+a.join(",")+")"}findChild(e,t,n,i,s){let{buffer:a}=this,o=-1;for(let l=e;l!=t&&!(sP(s,i,a[l+1],a[l+2])&&(o=l,n>0));l=a[l+3]);return o}slice(e,t,n){let i=this.buffer,s=new Uint16Array(t-e),a=0;for(let o=e,l=0;o<t;){s[l++]=i[o++],s[l++]=i[o++]-n;let f=s[l++]=i[o++]-n;s[l++]=i[o++]-e,a=Math.max(a,f)}return new iP(s,a,this.set)}};function sP(r,e,t,n){switch(r){case-2:return t<e;case-1:return n>=e&&t<e;case 0:return t<e&&n>e;case 1:return t<=e&&n>e;case 2:return n>e;case 4:return!0}}function th(r,e,t,n){for(var i;r.from==r.to||(t<1?r.from>=e:r.from>e)||(t>-1?r.to<=e:r.to<e);){let a=!n&&r instanceof Za&&r.index<0?null:r.parent;if(!a)return r;r=a}let s=n?0:cn.IgnoreOverlays;if(n)for(let a=r,o=a.parent;o;a=o,o=a.parent)a instanceof Za&&a.index<0&&((i=o.enter(e,t,s))===null||i===void 0?void 0:i.from)!=a.from&&(r=o);for(;;){let a=r.enter(e,t,s);if(!a)return r;r=a}}let aP=class{cursor(e=0){return new P1(this,e)}getChild(e,t=null,n=null){let i=D_(this,e,t,n);return i.length?i[0]:null}getChildren(e,t=null,n=null){return D_(this,e,t,n)}resolve(e,t=0){return th(this,e,t,!1)}resolveInner(e,t=0){return th(this,e,t,!0)}matchContext(e){return A1(this.parent,e)}enterUnfinishedNodesBefore(e){let t=this.childBefore(e),n=this;for(;t;){let i=t.lastChild;if(!i||i.to!=t.to)break;i.type.isError&&i.from==i.to?(n=t,t=i.prevSibling):t=i}return n}get node(){return this}get next(){return this.parent}},Za=class ed extends aP{constructor(e,t,n,i){super(),this._tree=e,this.from=t,this.index=n,this._parent=i}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,t,n,i,s=0){for(let a=this;;){for(let{children:o,positions:l}=a._tree,f=t>0?o.length:-1;e!=f;e+=t){let c=o[e],h=l[e]+a.from;if(sP(i,n,h,h+c.length)){if(c instanceof ql){if(s&cn.ExcludeBuffers)continue;let u=c.findChild(0,c.buffer.length,t,n-h,i);if(u>-1)return new E1(new Fee(a,c,e,h),null,u)}else if(s&cn.IncludeAnonymous||!c.type.isAnonymous||Vx(c)){let u;if(!(s&cn.IgnoreMounts)&&(u=n0.get(c))&&!u.overlay)return new ed(u.tree,h,e,a);let d=new ed(c,h,e,a);return s&cn.IncludeAnonymous||!d.type.isAnonymous?d:d.nextChild(t<0?c.children.length-1:0,t,n,i)}}}if(s&cn.IncludeAnonymous||!a.type.isAnonymous||(a.index>=0?e=a.index+t:e=t<0?-1:a._parent._tree.children.length,a=a._parent,!a))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}enter(e,t,n=0){let i;if(!(n&cn.IgnoreOverlays)&&(i=n0.get(this._tree))&&i.overlay){let s=e-this.from;for(let{from:a,to:o}of i.overlay)if((t>0?a<=s:a<s)&&(t<0?o>=s:o>s))return new ed(i.tree,i.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,t,n)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}};function D_(r,e,t,n){let i=r.cursor(),s=[];if(!i.firstChild())return s;if(t!=null){for(let a=!1;!a;)if(a=i.type.is(t),!i.nextSibling())return s}for(;;){if(n!=null&&i.type.is(n))return s;if(i.type.is(e)&&s.push(i.node),!i.nextSibling())return n==null?s:[]}}function A1(r,e,t=e.length-1){for(let n=r;t>=0;n=n.parent){if(!n)return!1;if(!n.type.isAnonymous){if(e[t]&&e[t]!=n.name)return!1;t--}}return!0}let Fee=class{constructor(e,t,n,i){this.parent=e,this.buffer=t,this.index=n,this.start=i}},E1=class zf extends aP{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(e,t,n){super(),this.context=e,this._parent=t,this.index=n,this.type=e.buffer.set.types[e.buffer.buffer[n]]}child(e,t,n){let{buffer:i}=this.context,s=i.findChild(this.index+4,i.buffer[this.index+3],e,t-this.context.start,n);return s<0?null:new zf(this.context,this,s)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}enter(e,t,n=0){if(n&cn.ExcludeBuffers)return null;let{buffer:i}=this.context,s=i.findChild(this.index+4,i.buffer[this.index+3],t>0?1:-1,e-this.context.start,t);return s<0?null:new zf(this.context,this,s)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,t=e.buffer[this.index+3];return t<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new zf(this.context,this._parent,t):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,t=this._parent?this._parent.index+4:0;return this.index==t?this.externalSibling(-1):new zf(this.context,this._parent,e.findChild(t,this.index,-1,0,4))}get tree(){return null}toTree(){let e=[],t=[],{buffer:n}=this.context,i=this.index+4,s=n.buffer[this.index+3];if(s>i){let a=n.buffer[this.index+1];e.push(n.slice(i,s,a)),t.push(0)}return new di(this.type,e,t,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}};function oP(r){if(!r.length)return null;let e=0,t=r[0];for(let s=1;s<r.length;s++){let a=r[s];(a.from>t.from||a.to<t.to)&&(t=a,e=s)}let n=t instanceof Za&&t.index<0?null:t.parent,i=r.slice();return n?i[e]=n:i.splice(e,1),new $ee(i,t)}let $ee=class{constructor(e,t){this.heads=e,this.node=t}get next(){return oP(this.heads)}};function Dee(r,e,t){let n=r.resolveInner(e,t),i=null;for(let s=n instanceof Za?n:n.context.parent;s;s=s.parent)if(s.index<0){let a=s.parent;(i||(i=[n])).push(a.resolve(e,t)),s=a}else{let a=n0.get(s.tree);if(a&&a.overlay&&a.overlay[0].from<=e&&a.overlay[a.overlay.length-1].to>=e){let o=new Za(a.tree,a.overlay[0].from+s.from,-1,s);(i||(i=[n])).push(th(o,e,t,!1))}}return i?oP(i):n}let P1=class{get name(){return this.type.name}constructor(e,t=0){if(this.mode=t,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,e instanceof Za)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let n=e._parent;n;n=n._parent)this.stack.unshift(n.index);this.bufferNode=e,this.yieldBuf(e.index)}}yieldNode(e){return e?(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0):!1}yieldBuf(e,t){this.index=e;let{start:n,buffer:i}=this.buffer;return this.type=t||i.set.types[i.buffer[e]],this.from=n+i.buffer[e+1],this.to=n+i.buffer[e+2],!0}yield(e){return e?e instanceof Za?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,t,n){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,t,n,this.mode));let{buffer:i}=this.buffer,s=i.findChild(this.index+4,i.buffer[this.index+3],e,t-this.buffer.start,n);return s<0?!1:(this.stack.push(this.index),this.yieldBuf(s))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,t,n=this.mode){return this.buffer?n&cn.ExcludeBuffers?!1:this.enterChild(1,e,t):this.yield(this._tree.enter(e,t,n))}parent(){if(!this.buffer)return this.yieldNode(this.mode&cn.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&cn.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode)):!1;let{buffer:t}=this.buffer,n=this.stack.length-1;if(e<0){let i=n<0?0:this.stack[n]+4;if(this.index!=i)return this.yieldBuf(t.findChild(i,this.index,-1,0,4))}else{let i=t.buffer[this.index+3];if(i<(n<0?t.buffer.length:t.buffer[this.stack[n]+3]))return this.yieldBuf(i)}return n<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let t,n,{buffer:i}=this;if(i){if(e>0){if(this.index<i.buffer.buffer.length)return!1}else for(let s=0;s<this.index;s++)if(i.buffer.buffer[s+3]<this.index)return!1;({index:t,parent:n}=i)}else({index:t,_parent:n}=this._tree);for(;n;{index:t,_parent:n}=n)if(t>-1)for(let s=t+e,a=e<0?-1:n._tree.children.length;s!=a;s+=e){let o=n._tree.children[s];if(this.mode&cn.IncludeAnonymous||o instanceof ql||!o.type.isAnonymous||Vx(o))return!1}return!0}move(e,t){if(t&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,t=0){for(;(this.from==this.to||(t<1?this.from>=e:this.from>e)||(t>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,t););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,t=null,n=0;if(e&&e.context==this.buffer)e:for(let i=this.index,s=this.stack.length;s>=0;){for(let a=e;a;a=a._parent)if(a.index==i){if(i==this.index)return a;t=a,n=s+1;break e}i=this.stack[--s]}for(let i=n;i<this.stack.length;i++)t=new E1(this.buffer,t,this.stack[i]);return this.bufferNode=new E1(this.buffer,t,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,t){for(let n=0;;){let i=!1;if(this.type.isAnonymous||e(this)!==!1){if(this.firstChild()){n++;continue}this.type.isAnonymous||(i=!0)}for(;;){if(i&&t&&t(this),i=this.type.isAnonymous,!n)return;if(this.nextSibling())break;this.parent(),n--,i=!0}}}matchContext(e){if(!this.buffer)return A1(this.node.parent,e);let{buffer:t}=this.buffer,{types:n}=t.set;for(let i=e.length-1,s=this.stack.length-1;i>=0;s--){if(s<0)return A1(this._tree,e,i);let a=n[t.buffer[this.stack[s]]];if(!a.isAnonymous){if(e[i]&&e[i]!=a.name)return!1;i--}}return!0}};function Vx(r){return r.children.some(e=>e instanceof ql||!e.type.isAnonymous||Vx(e))}function Nee(r){var e;let{buffer:t,nodeSet:n,maxBufferLength:i=Eee,reused:s=[],minRepeatType:a=n.types.length}=r,o=Array.isArray(t)?new Qee(t,t.length):t,l=n.types,f=0,c=0;function h(y,b,x,A,k,E){let{id:T,start:_,end:N,size:Z}=o,z=c,ee=f;for(;Z<0;)if(o.next(),Z==-1){let ie=s[T];x.push(ie),A.push(_-y);return}else if(Z==-3){f=T;return}else if(Z==-4){c=T;return}else throw new RangeError(`Unrecognized record size: ${Z}`);let ae=l[T],xe,V,ue=_-y;if(N-_<=i&&(V=g(o.pos-b,k))){let ie=new Uint16Array(V.size-V.skip),P=o.pos-V.size,I=ie.length;for(;o.pos>P;)I=O(V.start,ie,I);xe=new ql(ie,N-V.start,n),ue=V.start-y}else{let ie=o.pos-Z;o.next();let P=[],I=[],B=T>=a?T:-1,W=0,K=N;for(;o.pos>ie;)B>=0&&o.id==B&&o.size>=0?(o.end<=K-i&&(p(P,I,_,W,o.end,K,B,z,ee),W=P.length,K=o.end),o.next()):E>2500?u(_,ie,P,I):h(_,ie,P,I,B,E+1);if(B>=0&&W>0&&W<P.length&&p(P,I,_,W,_,K,B,z,ee),P.reverse(),I.reverse(),B>-1&&W>0){let re=d(ae,ee);xe=qx(ae,P,I,0,P.length,0,N-_,re,re)}else xe=m(ae,P,I,N-_,z-N,ee)}x.push(xe),A.push(ue)}function u(y,b,x,A){let k=[],E=0,T=-1;for(;o.pos>b;){let{id:_,start:N,end:Z,size:z}=o;if(z>4)o.next();else{if(T>-1&&N<T)break;T<0&&(T=Z-i),k.push(_,N,Z),E++,o.next()}}if(E){let _=new Uint16Array(E*4),N=k[k.length-2];for(let Z=k.length-3,z=0;Z>=0;Z-=3)_[z++]=k[Z],_[z++]=k[Z+1]-N,_[z++]=k[Z+2]-N,_[z++]=z;x.push(new ql(_,k[2]-N,n)),A.push(N-y)}}function d(y,b){return(x,A,k)=>{let E=0,T=x.length-1,_,N;if(T>=0&&(_=x[T])instanceof di){if(!T&&_.type==y&&_.length==k)return _;(N=_.prop(zt.lookAhead))&&(E=A[T]+_.length+N)}return m(y,x,A,k,E,b)}}function p(y,b,x,A,k,E,T,_,N){let Z=[],z=[];for(;y.length>A;)Z.push(y.pop()),z.push(b.pop()+x-k);y.push(m(n.types[T],Z,z,E-k,_-E,N)),b.push(k-x)}function m(y,b,x,A,k,E,T){if(E){let _=[zt.contextHash,E];T=T?[_].concat(T):[_]}if(k>25){let _=[zt.lookAhead,k];T=T?[_].concat(T):[_]}return new di(y,b,x,A,T)}function g(y,b){let x=o.fork(),A=0,k=0,E=0,T=x.end-i,_={size:0,start:0,skip:0};e:for(let N=x.pos-y;x.pos>N;){let Z=x.size;if(x.id==b&&Z>=0){_.size=A,_.start=k,_.skip=E,E+=4,A+=4,x.next();continue}let z=x.pos-Z;if(Z<0||z<N||x.start<T)break;let ee=x.id>=a?4:0,ae=x.start;for(x.next();x.pos>z;){if(x.size<0)if(x.size==-3)ee+=4;else break e;else x.id>=a&&(ee+=4);x.next()}k=ae,A+=Z,E+=ee}return(b<0||A==y)&&(_.size=A,_.start=k,_.skip=E),_.size>4?_:void 0}function O(y,b,x){let{id:A,start:k,end:E,size:T}=o;if(o.next(),T>=0&&A<a){let _=x;if(T>4){let N=o.pos-(T-4);for(;o.pos>N;)x=O(y,b,x)}b[--x]=_,b[--x]=E-y,b[--x]=k-y,b[--x]=A}else T==-3?f=A:T==-4&&(c=A);return x}let w=[],v=[];for(;o.pos>0;)h(r.start||0,r.bufferStart||0,w,v,-1,0);let S=(e=r.length)!==null&&e!==void 0?e:w.length?v[0]+w[0].length:0;return new di(l[r.topID],w.reverse(),v.reverse(),S)}const N_=new WeakMap;function td(r,e){if(!r.isAnonymous||e instanceof ql||e.type!=r)return 1;let t=N_.get(e);if(t==null){t=1;for(let n of e.children){if(n.type!=r||!(n instanceof di)){t=1;break}t+=td(r,n)}N_.set(e,t)}return t}function qx(r,e,t,n,i,s,a,o,l){let f=0;for(let p=n;p<i;p++)f+=td(r,e[p]);let c=Math.ceil(f*1.5/8),h=[],u=[];function d(p,m,g,O,w){for(let v=g;v<O;){let S=v,y=m[v],b=td(r,p[v]);for(v++;v<O;v++){let x=td(r,p[v]);if(b+x>=c)break;b+=x}if(v==S+1){if(b>c){let x=p[S];d(x.children,x.positions,0,x.children.length,m[S]+w);continue}h.push(p[S])}else{let x=m[v-1]+p[v-1].length-y;h.push(qx(r,p,m,S,v,y,x,null,l))}u.push(y+w-s)}}return d(e,t,n,i,0),(o||l)(h,u,a)}let rd=class R1{constructor(e,t,n,i,s=!1,a=!1){this.from=e,this.to=t,this.tree=n,this.offset=i,this.open=(s?1:0)|(a?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(e,t=[],n=!1){let i=[new R1(0,e.length,e,0,!1,n)];for(let s of t)s.to>e.length&&i.push(s);return i}static applyChanges(e,t,n=128){if(!t.length)return e;let i=[],s=1,a=e.length?e[0]:null;for(let o=0,l=0,f=0;;o++){let c=o<t.length?t[o]:null,h=c?c.fromA:1e9;if(h-l>=n)for(;a&&a.from<h;){let u=a;if(l>=u.from||h<=u.to||f){let d=Math.max(u.from,l)-f,p=Math.min(u.to,h)-f;u=d>=p?null:new R1(d,p,u.tree,u.offset+f,o>0,!!c)}if(u&&i.push(u),a.to>h)break;a=s<e.length?e[s++]:null}if(!c)break;l=c.toA,f=c.toA-c.toB}return i}},Mee=class{startParse(e,t,n){return typeof e=="string"&&(e=new Iee(e)),n=n?n.length?n.map(i=>new tm(i.from,i.to)):[new tm(0,0)]:[new tm(0,e.length)],this.createParse(e,t||[],n)}parse(e,t,n){let i=this.startParse(e,t,n);for(;;){let s=i.advance();if(s)return s}}},Iee=class{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,t){return this.string.slice(e,t)}};new zt({perNode:!0});var rm;const fl=new zt;function Lee(r){return Ze.define({combine:r?e=>e.concat(r):void 0})}const Bee=new zt;let Gi=class{constructor(e,t,n=[],i=""){this.data=e,this.name=i,st.prototype.hasOwnProperty("tree")||Object.defineProperty(st.prototype,"tree",{get(){return rh(this)}}),this.parser=t,this.extension=[jl.of(this),st.languageData.of((s,a,o)=>{let l=M_(s,a,o),f=l.type.prop(fl);if(!f)return[];let c=s.facet(f),h=l.type.prop(Bee);if(h){let u=l.resolve(a-l.from,o);for(let d of h)if(d.test(u,s)){let p=s.facet(d.facet);return d.type=="replace"?p:p.concat(c)}}return c})].concat(n)}isActiveAt(e,t,n=-1){return M_(e,t,n).type.prop(fl)==this.data}findRegions(e){let t=e.facet(jl);if((t==null?void 0:t.data)==this.data)return[{from:0,to:e.doc.length}];if(!t||!t.allowsNesting)return[];let n=[],i=(s,a)=>{if(s.prop(fl)==this.data){n.push({from:a,to:a+s.length});return}let o=s.prop(zt.mounted);if(o){if(o.tree.prop(fl)==this.data){if(o.overlay)for(let l of o.overlay)n.push({from:l.from+a,to:l.to+a});else n.push({from:a,to:a+s.length});return}else if(o.overlay){let l=n.length;if(i(o.tree,o.overlay[0].from+a),n.length>l)return}}for(let l=0;l<s.children.length;l++){let f=s.children[l];f instanceof di&&i(f,s.positions[l]+a)}};return i(rh(e),0),n}get allowsNesting(){return!0}};Gi.setState=rt.define();function M_(r,e,t){let n=r.facet(jl),i=rh(r).topNode;if(!n||n.allowsNesting)for(let s=i;s;s=s.enter(e,t,cn.ExcludeBuffers))s.type.isTop&&(i=s);return i}let Zee=class Q1 extends Gi{constructor(e,t,n){super(e,t,[],n),this.parser=t}static define(e){let t=Lee(e.languageData);return new Q1(t,e.parser.configure({props:[fl.add(n=>n.isTop?t:void 0)]}),e.name)}configure(e,t){return new Q1(this.data,this.parser.configure(e),t||this.name)}get allowsNesting(){return this.parser.hasWrappers()}};function rh(r){let e=r.field(Gi.state,!1);return e?e.tree:di.empty}let Wee=class{constructor(e){this.doc=e,this.cursorPos=0,this.string="",this.cursor=e.iter()}get length(){return this.doc.length}syncTo(e){return this.string=this.cursor.next(e-this.cursorPos).value,this.cursorPos=e+this.string.length,this.cursorPos-this.string.length}chunk(e){return this.syncTo(e),this.string}get lineChunks(){return!0}read(e,t){let n=this.cursorPos-this.string.length;return e<n||t>=this.cursorPos?this.doc.sliceString(e,t):this.string.slice(e-n,t-n)}},Sf=null,Uee=class F1{constructor(e,t,n=[],i,s,a,o,l){this.parser=e,this.state=t,this.fragments=n,this.tree=i,this.treeLen=s,this.viewport=a,this.skipped=o,this.scheduleOn=l,this.parse=null,this.tempSkipped=[]}static create(e,t,n){return new F1(e,t,[],di.empty,0,n,[],null)}startParse(){return this.parser.startParse(new Wee(this.state.doc),this.fragments)}work(e,t){return t!=null&&t>=this.state.doc.length&&(t=void 0),this.tree!=di.empty&&this.isDone(t??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var n;if(typeof e=="number"){let i=Date.now()+e;e=()=>Date.now()>i}for(this.parse||(this.parse=this.startParse()),t!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>t)&&t<this.state.doc.length&&this.parse.stopAt(t);;){let i=this.parse.advance();if(i)if(this.fragments=this.withoutTempSkipped(rd.addTree(i,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(n=this.parse.stoppedAt)!==null&&n!==void 0?n:this.state.doc.length,this.tree=i,this.parse=null,this.treeLen<(t??this.state.doc.length))this.parse=this.startParse();else return!0;if(e())return!1}})}takeTree(){let e,t;this.parse&&(e=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>e)&&this.parse.stopAt(e),this.withContext(()=>{for(;!(t=this.parse.advance()););}),this.treeLen=e,this.tree=t,this.fragments=this.withoutTempSkipped(rd.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(e){let t=Sf;Sf=this;try{return e()}finally{Sf=t}}withoutTempSkipped(e){for(let t;t=this.tempSkipped.pop();)e=I_(e,t.from,t.to);return e}changes(e,t){let{fragments:n,tree:i,treeLen:s,viewport:a,skipped:o}=this;if(this.takeTree(),!e.empty){let l=[];if(e.iterChangedRanges((f,c,h,u)=>l.push({fromA:f,toA:c,fromB:h,toB:u})),n=rd.applyChanges(n,l),i=di.empty,s=0,a={from:e.mapPos(a.from,-1),to:e.mapPos(a.to,1)},this.skipped.length){o=[];for(let f of this.skipped){let c=e.mapPos(f.from,1),h=e.mapPos(f.to,-1);c<h&&o.push({from:c,to:h})}}}return new F1(this.parser,t,n,i,s,a,o,this.scheduleOn)}updateViewport(e){if(this.viewport.from==e.from&&this.viewport.to==e.to)return!1;this.viewport=e;let t=this.skipped.length;for(let n=0;n<this.skipped.length;n++){let{from:i,to:s}=this.skipped[n];i<e.to&&s>e.from&&(this.fragments=I_(this.fragments,i,s),this.skipped.splice(n--,1))}return this.skipped.length>=t?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(e,t){this.skipped.push({from:e,to:t})}static getSkippingParser(e){return new class extends Mee{createParse(t,n,i){let s=i[0].from,a=i[i.length-1].to;return{parsedPos:s,advance(){let l=Sf;if(l){for(let f of i)l.tempSkipped.push(f);e&&(l.scheduleOn=l.scheduleOn?Promise.all([l.scheduleOn,e]):e)}return this.parsedPos=a,new di($s.none,[],[],a-s)},stoppedAt:null,stopAt(){}}}}}isDone(e){e=Math.min(e,this.state.doc.length);let t=this.fragments;return this.treeLen>=e&&t.length&&t[0].from==0&&t[0].to>=e}static get(){return Sf}};function I_(r,e,t){return rd.applyChanges(r,[{fromA:e,toA:t,fromB:e,toB:t}])}let $1=class D1{constructor(e){this.context=e,this.tree=e.tree}apply(e){if(!e.docChanged&&this.tree==this.context.tree)return this;let t=this.context.changes(e.changes,e.state),n=this.context.treeLen==e.startState.doc.length?void 0:Math.max(e.changes.mapPos(this.context.treeLen),t.viewport.to);return t.work(20,n)||t.takeTree(),new D1(t)}static init(e){let t=Math.min(3e3,e.doc.length),n=Uee.create(e.facet(jl).parser,e,{from:0,to:t});return n.work(20,t)||n.takeTree(),new D1(n)}};Gi.state=Cr.define({create:$1.init,update(r,e){for(let t of e.effects)if(t.is(Gi.setState))return t.value;return e.startState.facet(jl)!=e.state.facet(jl)?$1.init(e.state):r.apply(e)}});let lP=r=>{let e=setTimeout(()=>r(),500);return()=>clearTimeout(e)};typeof requestIdleCallback<"u"&&(lP=r=>{let e=-1,t=setTimeout(()=>{e=requestIdleCallback(r,{timeout:400})},100);return()=>e<0?clearTimeout(t):cancelIdleCallback(e)});const nm=typeof navigator<"u"&&(!((rm=navigator.scheduling)===null||rm===void 0)&&rm.isInputPending)?()=>navigator.scheduling.isInputPending():null,Xee=pr.fromClass(class{constructor(e){this.view=e,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(e){let t=this.view.state.field(Gi.state).context;(t.updateViewport(e.view.viewport)||this.view.viewport.to>t.treeLen)&&this.scheduleWork(),(e.docChanged||e.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(t)}scheduleWork(){if(this.working)return;let{state:e}=this.view,t=e.field(Gi.state);(t.tree!=t.context.tree||!t.context.isDone(e.doc.length))&&(this.working=lP(this.work))}work(e){this.working=null;let t=Date.now();if(this.chunkEnd<t&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=t+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:n,viewport:{to:i}}=this.view,s=n.field(Gi.state);if(s.tree==s.context.tree&&s.context.isDone(i+1e5))return;let a=Date.now()+Math.min(this.chunkBudget,100,e&&!nm?Math.max(25,e.timeRemaining()-5):1e9),o=s.context.treeLen<i&&n.doc.length>i+1e3,l=s.context.work(()=>nm&&nm()||Date.now()>a,i+(o?0:1e5));this.chunkBudget-=Date.now()-t,(l||this.chunkBudget<=0)&&(s.context.takeTree(),this.view.dispatch({effects:Gi.setState.of(new $1(s.context))})),this.chunkBudget>0&&!(l&&!o)&&this.scheduleWork(),this.checkAsyncSchedule(s.context)}checkAsyncSchedule(e){e.scheduleOn&&(this.workScheduled++,e.scheduleOn.then(()=>this.scheduleWork()).catch(t=>tn(this.view.state,t)).then(()=>this.workScheduled--),e.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),jl=Ze.define({combine(r){return r.length?r[0]:null},enables:r=>[Gi.state,Xee,We.contentAttributes.compute([r],e=>{let t=e.facet(r);return t&&t.name?{"data-language":t.name}:{}})]});let Vee=class{constructor(e,t=[]){this.language=e,this.support=t,this.extension=[e,t]}};const qee=new zt,jee=new zt;let zee=class fP{constructor(e,t){this.specs=e;let n;function i(o){let l=An.newName();return(n||(n=Object.create(null)))["."+l]=o,l}const s=typeof t.all=="string"?t.all:t.all?i(t.all):void 0,a=t.scope;this.scope=a instanceof Gi?o=>o.prop(fl)==a.data:a?o=>o==a:void 0,this.style=af(e.map(o=>({tag:o.tag,class:o.class||i(Object.assign({},o,{tag:null}))})),{all:s}).style,this.module=n?new An(n):null,this.themeType=t.themeType}static define(e,t){return new fP(e,t||{})}};L.meta,L.link,L.heading,L.emphasis,L.strong,L.strikethrough,L.keyword,L.atom,L.bool,L.url,L.contentSeparator,L.labelName,L.literal,L.inserted,L.string,L.deleted,L.regexp,L.escape,L.string,L.variableName,L.variableName,L.typeName,L.namespace,L.className,L.variableName,L.macroName,L.propertyName,L.comment,L.invalid;const Gee=new zt,Hee=Object.create(null),L_=[$s.none],B_=[],Z_=Object.create(null),Yee=Object.create(null);for(let[r,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])Yee[r]=Kee(Hee,e);function im(r,e){B_.indexOf(r)>-1||(B_.push(r),console.warn(e))}function Kee(r,e){let t=[];for(let o of e.split(" ")){let l=[];for(let f of o.split(".")){let c=r[f]||L[f];c?typeof c=="function"?l.length?l=l.map(c):im(f,`Modifier ${f} used at start of tag`):l.length?im(f,`Tag ${f} used as modifier`):l=Array.isArray(c)?c:[c]:im(f,`Unknown highlighting tag ${f}`)}for(let f of l)t.push(f)}if(!t.length)return 0;let n=e.replace(/ /g,"_"),i=n+" "+t.map(o=>o.id),s=Z_[i];if(s)return s.id;let a=Z_[i]=$s.define({id:L_.length,name:n,props:[oa({[n]:t})]});return L_.push(a),a.id}Et.RTL,Et.LTR;function nd(r,e){let t=e&&e.getChild("TagName");return t?r.sliceString(t.from,t.to):""}function sm(r,e){let t=e&&e.firstChild;return!t||t.name!="OpenTag"?"":nd(r,t)}function Jee(r,e,t){let n=e&&e.getChildren("Attribute").find(s=>s.from<=t&&s.to>=t),i=n&&n.getChild("AttributeName");return i?r.sliceString(i.from,i.to):""}function am(r){for(let e=r&&r.parent;e;e=e.parent)if(e.name=="Element")return e;return null}function ete(r,e){var t;let n=rh(r).resolveInner(e,-1),i=null;for(let s=n;!i&&s.parent;s=s.parent)(s.name=="OpenTag"||s.name=="CloseTag"||s.name=="SelfClosingTag"||s.name=="MismatchedCloseTag")&&(i=s);if(i&&(i.to>e||i.lastChild.type.isError)){let s=i.parent;if(n.name=="TagName")return i.name=="CloseTag"||i.name=="MismatchedCloseTag"?{type:"closeTag",from:n.from,context:s}:{type:"openTag",from:n.from,context:am(s)};if(n.name=="AttributeName")return{type:"attrName",from:n.from,context:i};if(n.name=="AttributeValue")return{type:"attrValue",from:n.from,context:i};let a=n==i||n.name=="Attribute"?n.childBefore(e):n;return(a==null?void 0:a.name)=="StartTag"?{type:"openTag",from:e,context:am(s)}:(a==null?void 0:a.name)=="StartCloseTag"&&a.to<=e?{type:"closeTag",from:e,context:s}:(a==null?void 0:a.name)=="Is"?{type:"attrValue",from:e,context:i}:a?{type:"attrName",from:e,context:i}:null}else if(n.name=="StartCloseTag")return{type:"closeTag",from:e,context:n.parent};for(;n.parent&&n.to==e&&!(!((t=n.lastChild)===null||t===void 0)&&t.type.isError);)n=n.parent;return n.name=="Element"||n.name=="Text"||n.name=="Document"?{type:"tag",from:e,context:n.name=="Element"?n:am(n)}:null}let tte=class{constructor(e,t,n){this.attrs=t,this.attrValues=n,this.children=[],this.name=e.name,this.completion=Object.assign(Object.assign({type:"type"},e.completion||{}),{label:this.name}),this.openCompletion=Object.assign(Object.assign({},this.completion),{label:"<"+this.name}),this.closeCompletion=Object.assign(Object.assign({},this.completion),{label:"</"+this.name+">",boost:2}),this.closeNameCompletion=Object.assign(Object.assign({},this.completion),{label:this.name+">"}),this.text=e.textContent?e.textContent.map(i=>({label:i,type:"text"})):[]}};const om=/^[:\-\.\w\u00b7-\uffff]*$/;function W_(r){return Object.assign(Object.assign({type:"property"},r.completion||{}),{label:r.name})}function U_(r){return typeof r=="string"?{label:`"${r}"`,type:"constant"}:/^"/.test(r.label)?r:Object.assign(Object.assign({},r),{label:`"${r.label}"`})}function rte(r,e){let t=[],n=[],i=Object.create(null);for(let l of e){let f=W_(l);t.push(f),l.global&&n.push(f),l.values&&(i[l.name]=l.values.map(U_))}let s=[],a=[],o=Object.create(null);for(let l of r){let f=n,c=i;l.attributes&&(f=f.concat(l.attributes.map(u=>typeof u=="string"?t.find(d=>d.label==u)||{label:u,type:"property"}:(u.values&&(c==i&&(c=Object.create(c)),c[u.name]=u.values.map(U_)),W_(u)))));let h=new tte(l,f,c);o[h.name]=h,s.push(h),l.top&&a.push(h)}a.length||(a=s);for(let l=0;l<s.length;l++){let f=r[l],c=s[l];if(f.children)for(let h of f.children)o[h]&&c.children.push(o[h]);else c.children=s}return l=>{var f;let{doc:c}=l.state,h=ete(l.state,l.pos);if(!h||h.type=="tag"&&!l.explicit)return null;let{type:u,from:d,context:p}=h;if(u=="openTag"){let m=a,g=sm(c,p);if(g){let O=o[g];m=(O==null?void 0:O.children)||s}return{from:d,options:m.map(O=>O.completion),validFor:om}}else if(u=="closeTag"){let m=sm(c,p);return m?{from:d,to:l.pos+(c.sliceString(l.pos,l.pos+1)==">"?1:0),options:[((f=o[m])===null||f===void 0?void 0:f.closeNameCompletion)||{label:m+">",type:"type"}],validFor:om}:null}else if(u=="attrName"){let m=o[nd(c,p)];return{from:d,options:(m==null?void 0:m.attrs)||n,validFor:om}}else if(u=="attrValue"){let m=Jee(c,p,d);if(!m)return null;let g=o[nd(c,p)],O=((g==null?void 0:g.attrValues)||i)[m];return!O||!O.length?null:{from:d,to:l.pos+(c.sliceString(l.pos,l.pos+1)=='"'?1:0),options:O,validFor:/^"[^"]*"?$/}}else if(u=="tag"){let m=sm(c,p),g=o[m],O=[],w=p&&p.lastChild;m&&(!w||w.name!="CloseTag"||nd(c,w)!=m)&&O.push(g?g.closeCompletion:{label:"</"+m+">",type:"type",boost:2});let v=O.concat(((g==null?void 0:g.children)||(p?s:a)).map(S=>S.openCompletion));if(p&&(g!=null&&g.text.length)){let S=p.firstChild;S.to>l.pos-20&&!/\S/.test(l.state.sliceDoc(S.to,l.pos))&&(v=v.concat(g.text))}return{from:d,options:v,validFor:/^<\/?[:\-\.\w\u00b7-\uffff]*$/}}else return null}}const N1=Zee.define({name:"xml",parser:Aee.configure({props:[qee.add({Element(r){let e=/^\s*<\//.test(r.textAfter);return r.lineIndent(r.node.from)+(e?0:r.unit)},"OpenTag CloseTag SelfClosingTag"(r){return r.column(r.node.from)+r.unit}}),jee.add({Element(r){let e=r.firstChild,t=r.lastChild;return!e||e.name!="OpenTag"?null:{from:e.to,to:t.name=="CloseTag"?t.from:r.to}}}),Gee.add({"OpenTag CloseTag":r=>r.getChild("TagName")})]}),languageData:{commentTokens:{block:{open:"<!--",close:"-->"}},indentOnInput:/^\s*<\/$/}});function X_(r={}){let e=[N1.data.of({autocomplete:rte(r.elements||[],r.attributes||[])})];return r.autoCloseTags!==!1&&e.push(nte),new Vee(N1,e)}function V_(r,e,t=r.length){if(!e)return"";let n=e.firstChild,i=n&&n.getChild("TagName");return i?r.sliceString(i.from,Math.min(i.to,t)):""}const nte=We.inputHandler.of((r,e,t,n,i)=>{if(r.composing||r.state.readOnly||e!=t||n!=">"&&n!="/"||!N1.isActiveAt(r.state,e,-1))return!1;let s=i(),{state:a}=s,o=a.changeByRange(l=>{var f,c,h;let{head:u}=l,d=a.doc.sliceString(u-1,u)==n,p=rh(a).resolveInner(u,-1),m;if(d&&n==">"&&p.name=="EndTag"){let g=p.parent;if(((c=(f=g.parent)===null||f===void 0?void 0:f.lastChild)===null||c===void 0?void 0:c.name)!="CloseTag"&&(m=V_(a.doc,g.parent,u))){let O=u+(a.doc.sliceString(u,u+1)===">"?1:0),w=`</${m}>`;return{range:l,changes:{from:u,to:O,insert:w}}}}else if(d&&n=="/"&&p.name=="StartCloseTag"){let g=p.parent;if(p.from==u-2&&((h=g.lastChild)===null||h===void 0?void 0:h.name)!="CloseTag"&&(m=V_(a.doc,g,u))){let O=u+(a.doc.sliceString(u,u+1)===">"?1:0),w=`${m}>`;return{range:Oe.cursor(u+w.length,-1),changes:{from:u,to:O,insert:w}}}}return{range:l}});return o.changes.empty?!1:(r.dispatch([s,a.update(o,{userEvent:"input.complete",scrollIntoView:!0})]),!0)}),ite=1024;let ste=0;class lm{constructor(e,t){this.from=e,this.to=t}}class rr{constructor(e={}){this.id=ste++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof e!="function"&&(e=Mi.match(e)),t=>{let n=e(t);return n===void 0?null:[this,n]}}}rr.closedBy=new rr({deserialize:r=>r.split(" ")});rr.openedBy=new rr({deserialize:r=>r.split(" ")});rr.group=new rr({deserialize:r=>r.split(" ")});rr.isolate=new rr({deserialize:r=>{if(r&&r!="rtl"&&r!="ltr"&&r!="auto")throw new RangeError("Invalid value for isolate: "+r);return r||"auto"}});rr.contextHash=new rr({perNode:!0});rr.lookAhead=new rr({perNode:!0});rr.mounted=new rr({perNode:!0});class i0{constructor(e,t,n){this.tree=e,this.overlay=t,this.parser=n}static get(e){return e&&e.props&&e.props[rr.mounted.id]}}const ate=Object.create(null);class Mi{constructor(e,t,n,i=0){this.name=e,this.props=t,this.id=n,this.flags=i}static define(e){let t=e.props&&e.props.length?Object.create(null):ate,n=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(e.name==null?8:0),i=new Mi(e.name||"",t,e.id,n);if(e.props){for(let s of e.props)if(Array.isArray(s)||(s=s(i)),s){if(s[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");t[s[0].id]=s[1]}}return i}prop(e){return this.props[e.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(e){if(typeof e=="string"){if(this.name==e)return!0;let t=this.prop(rr.group);return t?t.indexOf(e)>-1:!1}return this.id==e}static match(e){let t=Object.create(null);for(let n in e)for(let i of n.split(" "))t[i]=e[n];return n=>{for(let i=n.prop(rr.group),s=-1;s<(i?i.length:0);s++){let a=t[s<0?n.name:i[s]];if(a)return a}}}}Mi.none=new Mi("",Object.create(null),0,8);const wu=new WeakMap,q_=new WeakMap;var hn;(function(r){r[r.ExcludeBuffers=1]="ExcludeBuffers",r[r.IncludeAnonymous=2]="IncludeAnonymous",r[r.IgnoreMounts=4]="IgnoreMounts",r[r.IgnoreOverlays=8]="IgnoreOverlays"})(hn||(hn={}));class kn{constructor(e,t,n,i,s){if(this.type=e,this.children=t,this.positions=n,this.length=i,this.props=null,s&&s.length){this.props=Object.create(null);for(let[a,o]of s)this.props[typeof a=="number"?a:a.id]=o}}toString(){let e=i0.get(this);if(e&&!e.overlay)return e.tree.toString();let t="";for(let n of this.children){let i=n.toString();i&&(t&&(t+=","),t+=i)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(t.length?"("+t+")":""):t}cursor(e=0){return new I1(this.topNode,e)}cursorAt(e,t=0,n=0){let i=wu.get(this)||this.topNode,s=new I1(i);return s.moveTo(e,t),wu.set(this,s._tree),s}get topNode(){return new Di(this,0,0,null)}resolve(e,t=0){let n=nh(wu.get(this)||this.topNode,e,t,!1);return wu.set(this,n),n}resolveInner(e,t=0){let n=nh(q_.get(this)||this.topNode,e,t,!0);return q_.set(this,n),n}resolveStack(e,t=0){return fte(this,e,t)}iterate(e){let{enter:t,leave:n,from:i=0,to:s=this.length}=e,a=e.mode||0,o=(a&hn.IncludeAnonymous)>0;for(let l=this.cursor(a|hn.IncludeAnonymous);;){let f=!1;if(l.from<=s&&l.to>=i&&(!o&&l.type.isAnonymous||t(l)!==!1)){if(l.firstChild())continue;f=!0}for(;f&&n&&(o||!l.type.isAnonymous)&&n(l),!l.nextSibling();){if(!l.parent())return;f=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let t in this.props)e.push([+t,this.props[t]]);return e}balance(e={}){return this.children.length<=8?this:Gx(Mi.none,this.children,this.positions,0,this.children.length,0,this.length,(t,n,i)=>new kn(this.type,t,n,i,this.propValues),e.makeTree||((t,n,i)=>new kn(Mi.none,t,n,i)))}static build(e){return cte(e)}}kn.empty=new kn(Mi.none,[],[],0);class jx{constructor(e,t){this.buffer=e,this.index=t}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new jx(this.buffer,this.index)}}class Wa{constructor(e,t,n){this.buffer=e,this.length=t,this.set=n}get type(){return Mi.none}toString(){let e=[];for(let t=0;t<this.buffer.length;)e.push(this.childString(t)),t=this.buffer[t+3];return e.join(",")}childString(e){let t=this.buffer[e],n=this.buffer[e+3],i=this.set.types[t],s=i.name;if(/\W/.test(s)&&!i.isError&&(s=JSON.stringify(s)),e+=4,n==e)return s;let a=[];for(;e<n;)a.push(this.childString(e)),e=this.buffer[e+3];return s+"("+a.join(",")+")"}findChild(e,t,n,i,s){let{buffer:a}=this,o=-1;for(let l=e;l!=t&&!(cP(s,i,a[l+1],a[l+2])&&(o=l,n>0));l=a[l+3]);return o}slice(e,t,n){let i=this.buffer,s=new Uint16Array(t-e),a=0;for(let o=e,l=0;o<t;){s[l++]=i[o++],s[l++]=i[o++]-n;let f=s[l++]=i[o++]-n;s[l++]=i[o++]-e,a=Math.max(a,f)}return new Wa(s,a,this.set)}}function cP(r,e,t,n){switch(r){case-2:return t<e;case-1:return n>=e&&t<e;case 0:return t<e&&n>e;case 1:return t<=e&&n>e;case 2:return n>e;case 4:return!0}}function nh(r,e,t,n){for(var i;r.from==r.to||(t<1?r.from>=e:r.from>e)||(t>-1?r.to<=e:r.to<e);){let a=!n&&r instanceof Di&&r.index<0?null:r.parent;if(!a)return r;r=a}let s=n?0:hn.IgnoreOverlays;if(n)for(let a=r,o=a.parent;o;a=o,o=a.parent)a instanceof Di&&a.index<0&&((i=o.enter(e,t,s))===null||i===void 0?void 0:i.from)!=a.from&&(r=o);for(;;){let a=r.enter(e,t,s);if(!a)return r;r=a}}class hP{cursor(e=0){return new I1(this,e)}getChild(e,t=null,n=null){let i=j_(this,e,t,n);return i.length?i[0]:null}getChildren(e,t=null,n=null){return j_(this,e,t,n)}resolve(e,t=0){return nh(this,e,t,!1)}resolveInner(e,t=0){return nh(this,e,t,!0)}matchContext(e){return M1(this.parent,e)}enterUnfinishedNodesBefore(e){let t=this.childBefore(e),n=this;for(;t;){let i=t.lastChild;if(!i||i.to!=t.to)break;i.type.isError&&i.from==i.to?(n=t,t=i.prevSibling):t=i}return n}get node(){return this}get next(){return this.parent}}class Di extends hP{constructor(e,t,n,i){super(),this._tree=e,this.from=t,this.index=n,this._parent=i}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,t,n,i,s=0){for(let a=this;;){for(let{children:o,positions:l}=a._tree,f=t>0?o.length:-1;e!=f;e+=t){let c=o[e],h=l[e]+a.from;if(cP(i,n,h,h+c.length)){if(c instanceof Wa){if(s&hn.ExcludeBuffers)continue;let u=c.findChild(0,c.buffer.length,t,n-h,i);if(u>-1)return new Aa(new ote(a,c,e,h),null,u)}else if(s&hn.IncludeAnonymous||!c.type.isAnonymous||zx(c)){let u;if(!(s&hn.IgnoreMounts)&&(u=i0.get(c))&&!u.overlay)return new Di(u.tree,h,e,a);let d=new Di(c,h,e,a);return s&hn.IncludeAnonymous||!d.type.isAnonymous?d:d.nextChild(t<0?c.children.length-1:0,t,n,i)}}}if(s&hn.IncludeAnonymous||!a.type.isAnonymous||(a.index>=0?e=a.index+t:e=t<0?-1:a._parent._tree.children.length,a=a._parent,!a))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}enter(e,t,n=0){let i;if(!(n&hn.IgnoreOverlays)&&(i=i0.get(this._tree))&&i.overlay){let s=e-this.from;for(let{from:a,to:o}of i.overlay)if((t>0?a<=s:a<s)&&(t<0?o>=s:o>s))return new Di(i.tree,i.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,t,n)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}}function j_(r,e,t,n){let i=r.cursor(),s=[];if(!i.firstChild())return s;if(t!=null){for(let a=!1;!a;)if(a=i.type.is(t),!i.nextSibling())return s}for(;;){if(n!=null&&i.type.is(n))return s;if(i.type.is(e)&&s.push(i.node),!i.nextSibling())return n==null?s:[]}}function M1(r,e,t=e.length-1){for(let n=r;t>=0;n=n.parent){if(!n)return!1;if(!n.type.isAnonymous){if(e[t]&&e[t]!=n.name)return!1;t--}}return!0}class ote{constructor(e,t,n,i){this.parent=e,this.buffer=t,this.index=n,this.start=i}}class Aa extends hP{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(e,t,n){super(),this.context=e,this._parent=t,this.index=n,this.type=e.buffer.set.types[e.buffer.buffer[n]]}child(e,t,n){let{buffer:i}=this.context,s=i.findChild(this.index+4,i.buffer[this.index+3],e,t-this.context.start,n);return s<0?null:new Aa(this.context,this,s)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}enter(e,t,n=0){if(n&hn.ExcludeBuffers)return null;let{buffer:i}=this.context,s=i.findChild(this.index+4,i.buffer[this.index+3],t>0?1:-1,e-this.context.start,t);return s<0?null:new Aa(this.context,this,s)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,t=e.buffer[this.index+3];return t<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new Aa(this.context,this._parent,t):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,t=this._parent?this._parent.index+4:0;return this.index==t?this.externalSibling(-1):new Aa(this.context,this._parent,e.findChild(t,this.index,-1,0,4))}get tree(){return null}toTree(){let e=[],t=[],{buffer:n}=this.context,i=this.index+4,s=n.buffer[this.index+3];if(s>i){let a=n.buffer[this.index+1];e.push(n.slice(i,s,a)),t.push(0)}return new kn(this.type,e,t,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function uP(r){if(!r.length)return null;let e=0,t=r[0];for(let s=1;s<r.length;s++){let a=r[s];(a.from>t.from||a.to<t.to)&&(t=a,e=s)}let n=t instanceof Di&&t.index<0?null:t.parent,i=r.slice();return n?i[e]=n:i.splice(e,1),new lte(i,t)}class lte{constructor(e,t){this.heads=e,this.node=t}get next(){return uP(this.heads)}}function fte(r,e,t){let n=r.resolveInner(e,t),i=null;for(let s=n instanceof Di?n:n.context.parent;s;s=s.parent)if(s.index<0){let a=s.parent;(i||(i=[n])).push(a.resolve(e,t)),s=a}else{let a=i0.get(s.tree);if(a&&a.overlay&&a.overlay[0].from<=e&&a.overlay[a.overlay.length-1].to>=e){let o=new Di(a.tree,a.overlay[0].from+s.from,-1,s);(i||(i=[n])).push(nh(o,e,t,!1))}}return i?uP(i):n}class I1{get name(){return this.type.name}constructor(e,t=0){if(this.mode=t,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,e instanceof Di)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let n=e._parent;n;n=n._parent)this.stack.unshift(n.index);this.bufferNode=e,this.yieldBuf(e.index)}}yieldNode(e){return e?(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0):!1}yieldBuf(e,t){this.index=e;let{start:n,buffer:i}=this.buffer;return this.type=t||i.set.types[i.buffer[e]],this.from=n+i.buffer[e+1],this.to=n+i.buffer[e+2],!0}yield(e){return e?e instanceof Di?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,t,n){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,t,n,this.mode));let{buffer:i}=this.buffer,s=i.findChild(this.index+4,i.buffer[this.index+3],e,t-this.buffer.start,n);return s<0?!1:(this.stack.push(this.index),this.yieldBuf(s))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,t,n=this.mode){return this.buffer?n&hn.ExcludeBuffers?!1:this.enterChild(1,e,t):this.yield(this._tree.enter(e,t,n))}parent(){if(!this.buffer)return this.yieldNode(this.mode&hn.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&hn.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode)):!1;let{buffer:t}=this.buffer,n=this.stack.length-1;if(e<0){let i=n<0?0:this.stack[n]+4;if(this.index!=i)return this.yieldBuf(t.findChild(i,this.index,-1,0,4))}else{let i=t.buffer[this.index+3];if(i<(n<0?t.buffer.length:t.buffer[this.stack[n]+3]))return this.yieldBuf(i)}return n<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let t,n,{buffer:i}=this;if(i){if(e>0){if(this.index<i.buffer.buffer.length)return!1}else for(let s=0;s<this.index;s++)if(i.buffer.buffer[s+3]<this.index)return!1;({index:t,parent:n}=i)}else({index:t,_parent:n}=this._tree);for(;n;{index:t,_parent:n}=n)if(t>-1)for(let s=t+e,a=e<0?-1:n._tree.children.length;s!=a;s+=e){let o=n._tree.children[s];if(this.mode&hn.IncludeAnonymous||o instanceof Wa||!o.type.isAnonymous||zx(o))return!1}return!0}move(e,t){if(t&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,t=0){for(;(this.from==this.to||(t<1?this.from>=e:this.from>e)||(t>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,t););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,t=null,n=0;if(e&&e.context==this.buffer)e:for(let i=this.index,s=this.stack.length;s>=0;){for(let a=e;a;a=a._parent)if(a.index==i){if(i==this.index)return a;t=a,n=s+1;break e}i=this.stack[--s]}for(let i=n;i<this.stack.length;i++)t=new Aa(this.buffer,t,this.stack[i]);return this.bufferNode=new Aa(this.buffer,t,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,t){for(let n=0;;){let i=!1;if(this.type.isAnonymous||e(this)!==!1){if(this.firstChild()){n++;continue}this.type.isAnonymous||(i=!0)}for(;;){if(i&&t&&t(this),i=this.type.isAnonymous,!n)return;if(this.nextSibling())break;this.parent(),n--,i=!0}}}matchContext(e){if(!this.buffer)return M1(this.node.parent,e);let{buffer:t}=this.buffer,{types:n}=t.set;for(let i=e.length-1,s=this.stack.length-1;i>=0;s--){if(s<0)return M1(this._tree,e,i);let a=n[t.buffer[this.stack[s]]];if(!a.isAnonymous){if(e[i]&&e[i]!=a.name)return!1;i--}}return!0}}function zx(r){return r.children.some(e=>e instanceof Wa||!e.type.isAnonymous||zx(e))}function cte(r){var e;let{buffer:t,nodeSet:n,maxBufferLength:i=ite,reused:s=[],minRepeatType:a=n.types.length}=r,o=Array.isArray(t)?new jx(t,t.length):t,l=n.types,f=0,c=0;function h(y,b,x,A,k,E){let{id:T,start:_,end:N,size:Z}=o,z=c,ee=f;for(;Z<0;)if(o.next(),Z==-1){let ie=s[T];x.push(ie),A.push(_-y);return}else if(Z==-3){f=T;return}else if(Z==-4){c=T;return}else throw new RangeError(`Unrecognized record size: ${Z}`);let ae=l[T],xe,V,ue=_-y;if(N-_<=i&&(V=g(o.pos-b,k))){let ie=new Uint16Array(V.size-V.skip),P=o.pos-V.size,I=ie.length;for(;o.pos>P;)I=O(V.start,ie,I);xe=new Wa(ie,N-V.start,n),ue=V.start-y}else{let ie=o.pos-Z;o.next();let P=[],I=[],B=T>=a?T:-1,W=0,K=N;for(;o.pos>ie;)B>=0&&o.id==B&&o.size>=0?(o.end<=K-i&&(p(P,I,_,W,o.end,K,B,z,ee),W=P.length,K=o.end),o.next()):E>2500?u(_,ie,P,I):h(_,ie,P,I,B,E+1);if(B>=0&&W>0&&W<P.length&&p(P,I,_,W,_,K,B,z,ee),P.reverse(),I.reverse(),B>-1&&W>0){let re=d(ae,ee);xe=Gx(ae,P,I,0,P.length,0,N-_,re,re)}else xe=m(ae,P,I,N-_,z-N,ee)}x.push(xe),A.push(ue)}function u(y,b,x,A){let k=[],E=0,T=-1;for(;o.pos>b;){let{id:_,start:N,end:Z,size:z}=o;if(z>4)o.next();else{if(T>-1&&N<T)break;T<0&&(T=Z-i),k.push(_,N,Z),E++,o.next()}}if(E){let _=new Uint16Array(E*4),N=k[k.length-2];for(let Z=k.length-3,z=0;Z>=0;Z-=3)_[z++]=k[Z],_[z++]=k[Z+1]-N,_[z++]=k[Z+2]-N,_[z++]=z;x.push(new Wa(_,k[2]-N,n)),A.push(N-y)}}function d(y,b){return(x,A,k)=>{let E=0,T=x.length-1,_,N;if(T>=0&&(_=x[T])instanceof kn){if(!T&&_.type==y&&_.length==k)return _;(N=_.prop(rr.lookAhead))&&(E=A[T]+_.length+N)}return m(y,x,A,k,E,b)}}function p(y,b,x,A,k,E,T,_,N){let Z=[],z=[];for(;y.length>A;)Z.push(y.pop()),z.push(b.pop()+x-k);y.push(m(n.types[T],Z,z,E-k,_-E,N)),b.push(k-x)}function m(y,b,x,A,k,E,T){if(E){let _=[rr.contextHash,E];T=T?[_].concat(T):[_]}if(k>25){let _=[rr.lookAhead,k];T=T?[_].concat(T):[_]}return new kn(y,b,x,A,T)}function g(y,b){let x=o.fork(),A=0,k=0,E=0,T=x.end-i,_={size:0,start:0,skip:0};e:for(let N=x.pos-y;x.pos>N;){let Z=x.size;if(x.id==b&&Z>=0){_.size=A,_.start=k,_.skip=E,E+=4,A+=4,x.next();continue}let z=x.pos-Z;if(Z<0||z<N||x.start<T)break;let ee=x.id>=a?4:0,ae=x.start;for(x.next();x.pos>z;){if(x.size<0)if(x.size==-3)ee+=4;else break e;else x.id>=a&&(ee+=4);x.next()}k=ae,A+=Z,E+=ee}return(b<0||A==y)&&(_.size=A,_.start=k,_.skip=E),_.size>4?_:void 0}function O(y,b,x){let{id:A,start:k,end:E,size:T}=o;if(o.next(),T>=0&&A<a){let _=x;if(T>4){let N=o.pos-(T-4);for(;o.pos>N;)x=O(y,b,x)}b[--x]=_,b[--x]=E-y,b[--x]=k-y,b[--x]=A}else T==-3?f=A:T==-4&&(c=A);return x}let w=[],v=[];for(;o.pos>0;)h(r.start||0,r.bufferStart||0,w,v,-1,0);let S=(e=r.length)!==null&&e!==void 0?e:w.length?v[0]+w[0].length:0;return new kn(l[r.topID],w.reverse(),v.reverse(),S)}const z_=new WeakMap;function id(r,e){if(!r.isAnonymous||e instanceof Wa||e.type!=r)return 1;let t=z_.get(e);if(t==null){t=1;for(let n of e.children){if(n.type!=r||!(n instanceof kn)){t=1;break}t+=id(r,n)}z_.set(e,t)}return t}function Gx(r,e,t,n,i,s,a,o,l){let f=0;for(let p=n;p<i;p++)f+=id(r,e[p]);let c=Math.ceil(f*1.5/8),h=[],u=[];function d(p,m,g,O,w){for(let v=g;v<O;){let S=v,y=m[v],b=id(r,p[v]);for(v++;v<O;v++){let x=id(r,p[v]);if(b+x>=c)break;b+=x}if(v==S+1){if(b>c){let x=p[S];d(x.children,x.positions,0,x.children.length,m[S]+w);continue}h.push(p[S])}else{let x=m[v-1]+p[v-1].length-y;h.push(Gx(r,p,m,S,v,y,x,null,l))}u.push(y+w-s)}}return d(e,t,n,i,0),(o||l)(h,u,a)}class _o{constructor(e,t,n,i,s=!1,a=!1){this.from=e,this.to=t,this.tree=n,this.offset=i,this.open=(s?1:0)|(a?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(e,t=[],n=!1){let i=[new _o(0,e.length,e,0,!1,n)];for(let s of t)s.to>e.length&&i.push(s);return i}static applyChanges(e,t,n=128){if(!t.length)return e;let i=[],s=1,a=e.length?e[0]:null;for(let o=0,l=0,f=0;;o++){let c=o<t.length?t[o]:null,h=c?c.fromA:1e9;if(h-l>=n)for(;a&&a.from<h;){let u=a;if(l>=u.from||h<=u.to||f){let d=Math.max(u.from,l)-f,p=Math.min(u.to,h)-f;u=d>=p?null:new _o(d,p,u.tree,u.offset+f,o>0,!!c)}if(u&&i.push(u),a.to>h)break;a=s<e.length?e[s++]:null}if(!c)break;l=c.toA,f=c.toA-c.toB}return i}}class hte{startParse(e,t,n){return typeof e=="string"&&(e=new ute(e)),n=n?n.length?n.map(i=>new lm(i.from,i.to)):[new lm(0,0)]:[new lm(0,e.length)],this.createParse(e,t||[],n)}parse(e,t,n){let i=this.startParse(e,t,n);for(;;){let s=i.advance();if(s)return s}}}class ute{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,t){return this.string.slice(e,t)}}new rr({perNode:!0});var fm;const cl=new rr;function dte(r){return Ze.define({combine:r?e=>e.concat(r):void 0})}const pte=new rr;class Hi{constructor(e,t,n=[],i=""){this.data=e,this.name=i,st.prototype.hasOwnProperty("tree")||Object.defineProperty(st.prototype,"tree",{get(){return ih(this)}}),this.parser=t,this.extension=[Gl.of(this),st.languageData.of((s,a,o)=>{let l=G_(s,a,o),f=l.type.prop(cl);if(!f)return[];let c=s.facet(f),h=l.type.prop(pte);if(h){let u=l.resolve(a-l.from,o);for(let d of h)if(d.test(u,s)){let p=s.facet(d.facet);return d.type=="replace"?p:p.concat(c)}}return c})].concat(n)}isActiveAt(e,t,n=-1){return G_(e,t,n).type.prop(cl)==this.data}findRegions(e){let t=e.facet(Gl);if((t==null?void 0:t.data)==this.data)return[{from:0,to:e.doc.length}];if(!t||!t.allowsNesting)return[];let n=[],i=(s,a)=>{if(s.prop(cl)==this.data){n.push({from:a,to:a+s.length});return}let o=s.prop(rr.mounted);if(o){if(o.tree.prop(cl)==this.data){if(o.overlay)for(let l of o.overlay)n.push({from:l.from+a,to:l.to+a});else n.push({from:a,to:a+s.length});return}else if(o.overlay){let l=n.length;if(i(o.tree,o.overlay[0].from+a),n.length>l)return}}for(let l=0;l<s.children.length;l++){let f=s.children[l];f instanceof kn&&i(f,s.positions[l]+a)}};return i(ih(e),0),n}get allowsNesting(){return!0}}Hi.setState=rt.define();function G_(r,e,t){let n=r.facet(Gl),i=ih(r).topNode;if(!n||n.allowsNesting)for(let s=i;s;s=s.enter(e,t,hn.ExcludeBuffers))s.type.isTop&&(i=s);return i}class s0 extends Hi{constructor(e,t,n){super(e,t,[],n),this.parser=t}static define(e){let t=dte(e.languageData);return new s0(t,e.parser.configure({props:[cl.add(n=>n.isTop?t:void 0)]}),e.name)}configure(e,t){return new s0(this.data,this.parser.configure(e),t||this.name)}get allowsNesting(){return this.parser.hasWrappers()}}function ih(r){let e=r.field(Hi.state,!1);return e?e.tree:kn.empty}class mte{constructor(e){this.doc=e,this.cursorPos=0,this.string="",this.cursor=e.iter()}get length(){return this.doc.length}syncTo(e){return this.string=this.cursor.next(e-this.cursorPos).value,this.cursorPos=e+this.string.length,this.cursorPos-this.string.length}chunk(e){return this.syncTo(e),this.string}get lineChunks(){return!0}read(e,t){let n=this.cursorPos-this.string.length;return e<n||t>=this.cursorPos?this.doc.sliceString(e,t):this.string.slice(e-n,t-n)}}let Tf=null;class a0{constructor(e,t,n=[],i,s,a,o,l){this.parser=e,this.state=t,this.fragments=n,this.tree=i,this.treeLen=s,this.viewport=a,this.skipped=o,this.scheduleOn=l,this.parse=null,this.tempSkipped=[]}static create(e,t,n){return new a0(e,t,[],kn.empty,0,n,[],null)}startParse(){return this.parser.startParse(new mte(this.state.doc),this.fragments)}work(e,t){return t!=null&&t>=this.state.doc.length&&(t=void 0),this.tree!=kn.empty&&this.isDone(t??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var n;if(typeof e=="number"){let i=Date.now()+e;e=()=>Date.now()>i}for(this.parse||(this.parse=this.startParse()),t!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>t)&&t<this.state.doc.length&&this.parse.stopAt(t);;){let i=this.parse.advance();if(i)if(this.fragments=this.withoutTempSkipped(_o.addTree(i,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(n=this.parse.stoppedAt)!==null&&n!==void 0?n:this.state.doc.length,this.tree=i,this.parse=null,this.treeLen<(t??this.state.doc.length))this.parse=this.startParse();else return!0;if(e())return!1}})}takeTree(){let e,t;this.parse&&(e=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>e)&&this.parse.stopAt(e),this.withContext(()=>{for(;!(t=this.parse.advance()););}),this.treeLen=e,this.tree=t,this.fragments=this.withoutTempSkipped(_o.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(e){let t=Tf;Tf=this;try{return e()}finally{Tf=t}}withoutTempSkipped(e){for(let t;t=this.tempSkipped.pop();)e=H_(e,t.from,t.to);return e}changes(e,t){let{fragments:n,tree:i,treeLen:s,viewport:a,skipped:o}=this;if(this.takeTree(),!e.empty){let l=[];if(e.iterChangedRanges((f,c,h,u)=>l.push({fromA:f,toA:c,fromB:h,toB:u})),n=_o.applyChanges(n,l),i=kn.empty,s=0,a={from:e.mapPos(a.from,-1),to:e.mapPos(a.to,1)},this.skipped.length){o=[];for(let f of this.skipped){let c=e.mapPos(f.from,1),h=e.mapPos(f.to,-1);c<h&&o.push({from:c,to:h})}}}return new a0(this.parser,t,n,i,s,a,o,this.scheduleOn)}updateViewport(e){if(this.viewport.from==e.from&&this.viewport.to==e.to)return!1;this.viewport=e;let t=this.skipped.length;for(let n=0;n<this.skipped.length;n++){let{from:i,to:s}=this.skipped[n];i<e.to&&s>e.from&&(this.fragments=H_(this.fragments,i,s),this.skipped.splice(n--,1))}return this.skipped.length>=t?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(e,t){this.skipped.push({from:e,to:t})}static getSkippingParser(e){return new class extends hte{createParse(t,n,i){let s=i[0].from,a=i[i.length-1].to;return{parsedPos:s,advance(){let l=Tf;if(l){for(let f of i)l.tempSkipped.push(f);e&&(l.scheduleOn=l.scheduleOn?Promise.all([l.scheduleOn,e]):e)}return this.parsedPos=a,new kn(Mi.none,[],[],a-s)},stoppedAt:null,stopAt(){}}}}}isDone(e){e=Math.min(e,this.state.doc.length);let t=this.fragments;return this.treeLen>=e&&t.length&&t[0].from==0&&t[0].to>=e}static get(){return Tf}}function H_(r,e,t){return _o.applyChanges(r,[{fromA:e,toA:t,fromB:e,toB:t}])}class zl{constructor(e){this.context=e,this.tree=e.tree}apply(e){if(!e.docChanged&&this.tree==this.context.tree)return this;let t=this.context.changes(e.changes,e.state),n=this.context.treeLen==e.startState.doc.length?void 0:Math.max(e.changes.mapPos(this.context.treeLen),t.viewport.to);return t.work(20,n)||t.takeTree(),new zl(t)}static init(e){let t=Math.min(3e3,e.doc.length),n=a0.create(e.facet(Gl).parser,e,{from:0,to:t});return n.work(20,t)||n.takeTree(),new zl(n)}}Hi.state=Cr.define({create:zl.init,update(r,e){for(let t of e.effects)if(t.is(Hi.setState))return t.value;return e.startState.facet(Gl)!=e.state.facet(Gl)?zl.init(e.state):r.apply(e)}});let dP=r=>{let e=setTimeout(()=>r(),500);return()=>clearTimeout(e)};typeof requestIdleCallback<"u"&&(dP=r=>{let e=-1,t=setTimeout(()=>{e=requestIdleCallback(r,{timeout:400})},100);return()=>e<0?clearTimeout(t):cancelIdleCallback(e)});const cm=typeof navigator<"u"&&(!((fm=navigator.scheduling)===null||fm===void 0)&&fm.isInputPending)?()=>navigator.scheduling.isInputPending():null,gte=pr.fromClass(class{constructor(e){this.view=e,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(e){let t=this.view.state.field(Hi.state).context;(t.updateViewport(e.view.viewport)||this.view.viewport.to>t.treeLen)&&this.scheduleWork(),(e.docChanged||e.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(t)}scheduleWork(){if(this.working)return;let{state:e}=this.view,t=e.field(Hi.state);(t.tree!=t.context.tree||!t.context.isDone(e.doc.length))&&(this.working=dP(this.work))}work(e){this.working=null;let t=Date.now();if(this.chunkEnd<t&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=t+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:n,viewport:{to:i}}=this.view,s=n.field(Hi.state);if(s.tree==s.context.tree&&s.context.isDone(i+1e5))return;let a=Date.now()+Math.min(this.chunkBudget,100,e&&!cm?Math.max(25,e.timeRemaining()-5):1e9),o=s.context.treeLen<i&&n.doc.length>i+1e3,l=s.context.work(()=>cm&&cm()||Date.now()>a,i+(o?0:1e5));this.chunkBudget-=Date.now()-t,(l||this.chunkBudget<=0)&&(s.context.takeTree(),this.view.dispatch({effects:Hi.setState.of(new zl(s.context))})),this.chunkBudget>0&&!(l&&!o)&&this.scheduleWork(),this.checkAsyncSchedule(s.context)}checkAsyncSchedule(e){e.scheduleOn&&(this.workScheduled++,e.scheduleOn.then(()=>this.scheduleWork()).catch(t=>tn(this.view.state,t)).then(()=>this.workScheduled--),e.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),Gl=Ze.define({combine(r){return r.length?r[0]:null},enables:r=>[Hi.state,gte,We.contentAttributes.compute([r],e=>{let t=e.facet(r);return t&&t.name?{"data-language":t.name}:{}})]});class Ote{constructor(e,t=[]){this.language=e,this.support=t,this.extension=[e,t]}}const xte=new rr;function vte({except:r,units:e=1}={}){return t=>{let n=r&&r.test(t.textAfter);return t.baseIndent+(n?0:e*t.unit)}}const yte=new rr;class Hx{constructor(e,t){this.specs=e;let n;function i(o){let l=An.newName();return(n||(n=Object.create(null)))["."+l]=o,l}const s=typeof t.all=="string"?t.all:t.all?i(t.all):void 0,a=t.scope;this.scope=a instanceof Hi?o=>o.prop(cl)==a.data:a?o=>o==a:void 0,this.style=af(e.map(o=>({tag:o.tag,class:o.class||i(Object.assign({},o,{tag:null}))})),{all:s}).style,this.module=n?new An(n):null,this.themeType=t.themeType}static define(e,t){return new Hx(e,t||{})}}L.meta,L.link,L.heading,L.emphasis,L.strong,L.strikethrough,L.keyword,L.atom,L.bool,L.url,L.contentSeparator,L.labelName,L.literal,L.inserted,L.string,L.deleted,L.regexp,L.escape,L.string,L.variableName,L.variableName,L.typeName,L.namespace,L.className,L.variableName,L.macroName,L.propertyName,L.comment,L.invalid;const wte=Object.create(null),Y_=[Mi.none],K_=[],J_=Object.create(null),bte=Object.create(null);for(let[r,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])bte[r]=_te(wte,e);function hm(r,e){K_.indexOf(r)>-1||(K_.push(r),console.warn(e))}function _te(r,e){let t=[];for(let o of e.split(" ")){let l=[];for(let f of o.split(".")){let c=r[f]||L[f];c?typeof c=="function"?l.length?l=l.map(c):hm(f,`Modifier ${f} used at start of tag`):l.length?hm(f,`Tag ${f} used as modifier`):l=Array.isArray(c)?c:[c]:hm(f,`Unknown highlighting tag ${f}`)}for(let f of l)t.push(f)}if(!t.length)return 0;let n=e.replace(/ /g,"_"),i=n+" "+t.map(o=>o.id),s=J_[i];if(s)return s.id;let a=J_[i]=Mi.define({id:Y_.length,name:n,props:[oa({[n]:t})]});return Y_.push(a),a.id}Et.RTL,Et.LTR;function e2(r){let e=Object.keys(r).join(""),t=/\w/.test(e);return t&&(e=e.replace(/\w/g,"")),`[${t?"\\w":""}${e.replace(/[^\w\s]/g,"\\$&")}]`}function kte(r){let e=Object.create(null),t=Object.create(null);for(let{label:i}of r){e[i[0]]=!0;for(let s=1;s<i.length;s++)t[i[s]]=!0}let n=e2(e)+e2(t)+"*$";return[new RegExp("^"+n),new RegExp(n)]}function Ste(r){let e=r.map(i=>typeof i=="string"?{label:i}:i),[t,n]=e.every(i=>/^\w+$/.test(i.label))?[/\w*$/,/\w+$/]:kte(e);return i=>{let s=i.matchBefore(n);return s||i.explicit?{from:s?s.from:i.pos,options:e,validFor:t}:null}}function Tte(r,e){return t=>{for(let n=ih(t.state).resolveInner(t.pos,-1);n;n=n.parent){if(r.indexOf(n.name)>-1)return null;if(n.type.isTop)break}return e(t)}}const pP=new class extends Ks{};pP.startSide=1;pP.endSide=-1;const Cte=36,t2=1,Ate=2,Ko=3,um=4,Ete=5,Pte=6,Rte=7,Qte=8,Fte=9,$te=10,Dte=11,Nte=12,Mte=13,Ite=14,Lte=15,Bte=16,Zte=17,r2=18,Wte=19,mP=20,gP=21,n2=22,Ute=23,Xte=24;function L1(r){return r>=65&&r<=90||r>=97&&r<=122||r>=48&&r<=57}function Vte(r){return r>=48&&r<=57||r>=97&&r<=102||r>=65&&r<=70}function so(r,e,t){for(let n=!1;;){if(r.next<0)return;if(r.next==e&&!n){r.advance();return}n=t&&!n&&r.next==92,r.advance()}}function qte(r,e){e:for(;;){if(r.next<0)return;if(r.next==36){r.advance();for(let t=0;t<e.length;t++){if(r.next!=e.charCodeAt(t))continue e;r.advance()}if(r.next==36){r.advance();return}}else r.advance()}}function jte(r,e){let t="[{<(".indexOf(String.fromCharCode(e)),n=t<0?e:"]}>)".charCodeAt(t);for(;;){if(r.next<0)return;if(r.next==n&&r.peek(1)==39){r.advance(2);return}r.advance()}}function B1(r,e){for(;!(r.next!=95&&!L1(r.next));)e!=null&&(e+=String.fromCharCode(r.next)),r.advance();return e}function zte(r){if(r.next==39||r.next==34||r.next==96){let e=r.next;r.advance(),so(r,e,!1)}else B1(r)}function i2(r,e){for(;r.next==48||r.next==49;)r.advance();e&&r.next==e&&r.advance()}function s2(r,e){for(;;){if(r.next==46){if(e)break;e=!0}else if(r.next<48||r.next>57)break;r.advance()}if(r.next==69||r.next==101)for(r.advance(),(r.next==43||r.next==45)&&r.advance();r.next>=48&&r.next<=57;)r.advance()}function a2(r){for(;!(r.next<0||r.next==10);)r.advance()}function no(r,e){for(let t=0;t<e.length;t++)if(e.charCodeAt(t)==r)return!0;return!1}const dm=` 	\r
`;function OP(r,e,t){let n=Object.create(null);n.true=n.false=Ete,n.null=n.unknown=Pte;for(let i of r.split(" "))i&&(n[i]=mP);for(let i of e.split(" "))i&&(n[i]=gP);for(let i of(t||"").split(" "))i&&(n[i]=Xte);return n}const Gte="array binary bit boolean char character clob date decimal double float int integer interval large national nchar nclob numeric object precision real smallint time timestamp varchar varying ",Hte="absolute action add after all allocate alter and any are as asc assertion at authorization before begin between both breadth by call cascade cascaded case cast catalog check close collate collation column commit condition connect connection constraint constraints constructor continue corresponding count create cross cube current current_date current_default_transform_group current_transform_group_for_type current_path current_role current_time current_timestamp current_user cursor cycle data day deallocate declare default deferrable deferred delete depth deref desc describe descriptor deterministic diagnostics disconnect distinct do domain drop dynamic each else elseif end end-exec equals escape except exception exec execute exists exit external fetch first for foreign found from free full function general get global go goto grant group grouping handle having hold hour identity if immediate in indicator initially inner inout input insert intersect into is isolation join key language last lateral leading leave left level like limit local localtime localtimestamp locator loop map match method minute modifies module month names natural nesting new next no none not of old on only open option or order ordinality out outer output overlaps pad parameter partial path prepare preserve primary prior privileges procedure public read reads recursive redo ref references referencing relative release repeat resignal restrict result return returns revoke right role rollback rollup routine row rows savepoint schema scroll search second section select session session_user set sets signal similar size some space specific specifictype sql sqlexception sqlstate sqlwarning start state static system_user table temporary then timezone_hour timezone_minute to trailing transaction translation treat trigger under undo union unique unnest until update usage user using value values view when whenever where while with without work write year zone ",Z1={backslashEscapes:!1,hashComments:!1,spaceAfterDashes:!1,slashComments:!1,doubleQuotedStrings:!1,doubleDollarQuotedStrings:!1,unquotedBitLiterals:!1,treatBitsAsBytes:!1,charSetCasts:!1,plsqlQuotingMechanism:!1,operatorChars:"*+-%<>!=&|~^/",specialVar:"?",identifierQuotes:'"',caseInsensitiveIdentifiers:!1,words:OP(Hte,Gte)};function Yte(r,e,t,n){let i={};for(let s in Z1)i[s]=(r.hasOwnProperty(s)?r:Z1)[s];return e&&(i.words=OP(e,t||"",n)),i}function xP(r){return new Ga(e=>{var t;let{next:n}=e;if(e.advance(),no(n,dm)){for(;no(e.next,dm);)e.advance();e.acceptToken(Cte)}else if(n==36&&r.doubleDollarQuotedStrings){let i=B1(e,"");e.next==36&&(e.advance(),qte(e,i),e.acceptToken(Ko))}else if(n==39||n==34&&r.doubleQuotedStrings)so(e,n,r.backslashEscapes),e.acceptToken(Ko);else if(n==35&&r.hashComments||n==47&&e.next==47&&r.slashComments)a2(e),e.acceptToken(t2);else if(n==45&&e.next==45&&(!r.spaceAfterDashes||e.peek(1)==32))a2(e),e.acceptToken(t2);else if(n==47&&e.next==42){e.advance();for(let i=1;;){let s=e.next;if(e.next<0)break;if(e.advance(),s==42&&e.next==47){if(i--,e.advance(),!i)break}else s==47&&e.next==42&&(i++,e.advance())}e.acceptToken(Ate)}else if((n==101||n==69)&&e.next==39)e.advance(),so(e,39,!0),e.acceptToken(Ko);else if((n==110||n==78)&&e.next==39&&r.charSetCasts)e.advance(),so(e,39,r.backslashEscapes),e.acceptToken(Ko);else if(n==95&&r.charSetCasts)for(let i=0;;i++){if(e.next==39&&i>1){e.advance(),so(e,39,r.backslashEscapes),e.acceptToken(Ko);break}if(!L1(e.next))break;e.advance()}else if(r.plsqlQuotingMechanism&&(n==113||n==81)&&e.next==39&&e.peek(1)>0&&!no(e.peek(1),dm)){let i=e.peek(1);e.advance(2),jte(e,i),e.acceptToken(Ko)}else if(n==40)e.acceptToken(Rte);else if(n==41)e.acceptToken(Qte);else if(n==123)e.acceptToken(Fte);else if(n==125)e.acceptToken($te);else if(n==91)e.acceptToken(Dte);else if(n==93)e.acceptToken(Nte);else if(n==59)e.acceptToken(Mte);else if(r.unquotedBitLiterals&&n==48&&e.next==98)e.advance(),i2(e),e.acceptToken(n2);else if((n==98||n==66)&&(e.next==39||e.next==34)){const i=e.next;e.advance(),r.treatBitsAsBytes?(so(e,i,r.backslashEscapes),e.acceptToken(Ute)):(i2(e,i),e.acceptToken(n2))}else if(n==48&&(e.next==120||e.next==88)||(n==120||n==88)&&e.next==39){let i=e.next==39;for(e.advance();Vte(e.next);)e.advance();i&&e.next==39&&e.advance(),e.acceptToken(um)}else if(n==46&&e.next>=48&&e.next<=57)s2(e,!0),e.acceptToken(um);else if(n==46)e.acceptToken(Ite);else if(n>=48&&n<=57)s2(e,!1),e.acceptToken(um);else if(no(n,r.operatorChars)){for(;no(e.next,r.operatorChars);)e.advance();e.acceptToken(Lte)}else if(no(n,r.specialVar))e.next==n&&e.advance(),zte(e),e.acceptToken(Zte);else if(no(n,r.identifierQuotes))so(e,n,!1),e.acceptToken(Wte);else if(n==58||n==44)e.acceptToken(Bte);else if(L1(n)){let i=B1(e,String.fromCharCode(n));e.acceptToken(e.next==46||e.peek(-i.length-1)==46?r2:(t=r.words[i.toLowerCase()])!==null&&t!==void 0?t:r2)}})}const vP=xP(Z1),Kte=No.deserialize({version:14,states:"%vQ]QQOOO#wQRO'#DSO$OQQO'#CwO%eQQO'#CxO%lQQO'#CyO%sQQO'#CzOOQQ'#DS'#DSOOQQ'#C}'#C}O'UQRO'#C{OOQQ'#Cv'#CvOOQQ'#C|'#C|Q]QQOOQOQQOOO'`QQO'#DOO(xQRO,59cO)PQQO,59cO)UQQO'#DSOOQQ,59d,59dO)cQQO,59dOOQQ,59e,59eO)jQQO,59eOOQQ,59f,59fO)qQQO,59fOOQQ-E6{-E6{OOQQ,59b,59bOOQQ-E6z-E6zOOQQ,59j,59jOOQQ-E6|-E6|O+VQRO1G.}O+^QQO,59cOOQQ1G/O1G/OOOQQ1G/P1G/POOQQ1G/Q1G/QP+kQQO'#C}O+rQQO1G.}O)PQQO,59cO,PQQO'#Cw",stateData:",[~OtOSPOSQOS~ORUOSUOTUOUUOVROXSOZTO]XO^QO_UO`UOaPObPOcPOdUOeUOfUOgUOhUO~O^]ORvXSvXTvXUvXVvXXvXZvX]vX_vX`vXavXbvXcvXdvXevXfvXgvXhvX~OsvX~P!jOa_Ob_Oc_O~ORUOSUOTUOUUOVROXSOZTO^tO_UO`UOa`Ob`Oc`OdUOeUOfUOgUOhUO~OWaO~P$ZOYcO~P$ZO[eO~P$ZORUOSUOTUOUUOVROXSOZTO^QO_UO`UOaPObPOcPOdUOeUOfUOgUOhUO~O]hOsoX~P%zOajObjOcjO~O^]ORkaSkaTkaUkaVkaXkaZka]ka_ka`kaakabkackadkaekafkagkahka~Oska~P'kO^]O~OWvXYvX[vX~P!jOWnO~P$ZOYoO~P$ZO[pO~P$ZO^]ORkiSkiTkiUkiVkiXkiZki]ki_ki`kiakibkickidkiekifkigkihki~Oski~P)xOWkaYka[ka~P'kO]hO~P$ZOWkiYki[ki~P)xOasObsOcsO~O",goto:"#hwPPPPPPPPPPPPPPPPPPPPPPPPPPx||||!Y!^!d!xPPP#[TYOZeUORSTWZbdfqT[OZQZORiZSWOZQbRQdSQfTZgWbdfqQ^PWk^lmrQl_Qm`RrseVORSTWZbdfq",nodeNames:" LineComment BlockComment String Number Bool Null ( ) { } [ ] ; . Operator Punctuation SpecialVar Identifier QuotedIdentifier Keyword Type Bits Bytes Builtin Script Statement CompositeIdentifier Parens Braces Brackets Statement",maxTerm:38,nodeProps:[["isolate",-4,1,2,3,19,""]],skippedNodes:[0,1,2],repeatNodeCount:3,tokenData:"RORO",tokenizers:[0,vP],topRules:{Script:[0,25]},tokenPrec:0});function W1(r){let e=r.cursor().moveTo(r.from,-1);for(;/Comment/.test(e.name);)e.moveTo(e.from,-1);return e.node}function sh(r,e){let t=r.sliceString(e.from,e.to),n=/^([`'"])(.*)\1$/.exec(t);return n?n[2]:t}function o0(r){return r&&(r.name=="Identifier"||r.name=="QuotedIdentifier")}function Jte(r,e){if(e.name=="CompositeIdentifier"){let t=[];for(let n=e.firstChild;n;n=n.nextSibling)o0(n)&&t.push(sh(r,n));return t}return[sh(r,e)]}function o2(r,e){for(let t=[];;){if(!e||e.name!=".")return t;let n=W1(e);if(!o0(n))return t;t.unshift(sh(r,n)),e=W1(n)}}function ere(r,e){let t=ih(r).resolveInner(e,-1),n=rre(r.doc,t);return t.name=="Identifier"||t.name=="QuotedIdentifier"||t.name=="Keyword"?{from:t.from,quoted:t.name=="QuotedIdentifier"?r.doc.sliceString(t.from,t.from+1):null,parents:o2(r.doc,W1(t)),aliases:n}:t.name=="."?{from:e,quoted:null,parents:o2(r.doc,t),aliases:n}:{from:e,quoted:null,parents:[],empty:!0,aliases:n}}const tre=new Set("where group having order union intersect except all distinct limit offset fetch for".split(" "));function rre(r,e){let t;for(let i=e;!t;i=i.parent){if(!i)return null;i.name=="Statement"&&(t=i)}let n=null;for(let i=t.firstChild,s=!1,a=null;i;i=i.nextSibling){let o=i.name=="Keyword"?r.sliceString(i.from,i.to).toLowerCase():null,l=null;if(!s)s=o=="from";else if(o=="as"&&a&&o0(i.nextSibling))l=sh(r,i.nextSibling);else{if(o&&tre.has(o))break;a&&o0(i)&&(l=sh(r,i))}l&&(n||(n=Object.create(null)),n[l]=Jte(r,a)),a=/Identifier$/.test(i.name)?i:null}return n}function nre(r,e){return r?e.map(t=>Object.assign(Object.assign({},t),{label:t.label[0]==r?t.label:r+t.label+r,apply:void 0})):e}const ire=/^\w*$/,sre=/^[`'"]?\w*[`'"]?$/;function l2(r){return r.self&&typeof r.self.label=="string"}class Yx{constructor(e,t){this.idQuote=e,this.idCaseInsensitive=t,this.list=[],this.children=void 0}child(e){let t=this.children||(this.children=Object.create(null)),n=t[e];return n||(e&&!this.list.some(i=>i.label==e)&&this.list.push(f2(e,"type",this.idQuote,this.idCaseInsensitive)),t[e]=new Yx(this.idQuote,this.idCaseInsensitive))}maybeChild(e){return this.children?this.children[e]:null}addCompletion(e){let t=this.list.findIndex(n=>n.label==e.label);t>-1?this.list[t]=e:this.list.push(e)}addCompletions(e){for(let t of e)this.addCompletion(typeof t=="string"?f2(t,"property",this.idQuote,this.idCaseInsensitive):t)}addNamespace(e){Array.isArray(e)?this.addCompletions(e):l2(e)?this.addNamespace(e.children):this.addNamespaceObject(e)}addNamespaceObject(e){for(let t of Object.keys(e)){let n=e[t],i=null,s=t.replace(/\\?\./g,o=>o=="."?"\0":o).split("\0"),a=this;l2(n)&&(i=n.self,n=n.children);for(let o=0;o<s.length;o++)i&&o==s.length-1&&a.addCompletion(i),a=a.child(s[o].replace(/\\\./g,"."));a.addNamespace(n)}}}function f2(r,e,t,n){return new RegExp("^[a-z_][a-z_\\d]*$",n?"i":"").test(r)?{label:r,type:e}:{label:r,type:e,apply:t+r+t}}function are(r,e,t,n,i,s){var a;let o=((a=s==null?void 0:s.spec.identifierQuotes)===null||a===void 0?void 0:a[0])||'"',l=new Yx(o,!!(s!=null&&s.spec.caseInsensitiveIdentifiers)),f=i?l.child(i):null;return l.addNamespace(r),e&&(f||l).addCompletions(e),t&&l.addCompletions(t),f&&l.addCompletions(f.list),n&&l.addCompletions((f||l).child(n).list),c=>{let{parents:h,from:u,quoted:d,empty:p,aliases:m}=ere(c.state,c.pos);if(p&&!c.explicit)return null;m&&h.length==1&&(h=m[h[0]]||h);let g=l;for(let v of h){for(;!g.children||!g.children[v];)if(g==l&&f)g=f;else if(g==f&&n)g=g.child(n);else return null;let S=g.maybeChild(v);if(!S)return null;g=S}let O=d&&c.state.sliceDoc(c.pos,c.pos+1)==d,w=g.list;return g==l&&m&&(w=w.concat(Object.keys(m).map(v=>({label:v,type:"constant"})))),{from:u,to:O?c.pos+1:void 0,options:nre(d,w),validFor:d?sre:ire}}}function ore(r){return r==gP?"type":r==mP?"keyword":"variable"}function lre(r,e,t){let n=Object.keys(r).map(i=>t(e?i.toUpperCase():i,ore(r[i])));return Tte(["QuotedIdentifier","SpecialVar","String","LineComment","BlockComment","."],Ste(n))}let fre=Kte.configure({props:[xte.add({Statement:vte()}),yte.add({Statement(r,e){return{from:Math.min(r.from+100,e.doc.lineAt(r.from).to),to:r.to}},BlockComment(r){return{from:r.from+2,to:r.to-2}}}),oa({Keyword:L.keyword,Type:L.typeName,Builtin:L.standard(L.name),Bits:L.number,Bytes:L.string,Bool:L.bool,Null:L.null,Number:L.number,String:L.string,Identifier:L.name,QuotedIdentifier:L.special(L.string),SpecialVar:L.special(L.name),LineComment:L.lineComment,BlockComment:L.blockComment,Operator:L.operator,"Semi Punctuation":L.punctuation,"( )":L.paren,"{ }":L.brace,"[ ]":L.squareBracket})]});class Kx{constructor(e,t,n){this.dialect=e,this.language=t,this.spec=n}get extension(){return this.language.extension}static define(e){let t=Yte(e,e.keywords,e.types,e.builtin),n=s0.define({name:"sql",parser:fre.configure({tokenizers:[{from:vP,to:xP(t)}]}),languageData:{commentTokens:{line:"--",block:{open:"/*",close:"*/"}},closeBrackets:{brackets:["(","[","{","'",'"',"`"]}}});return new Kx(t,n,e)}}function cre(r,e){return{label:r,type:e,boost:-1}}function hre(r,e=!1,t){return lre(r.dialect.words,e,t||cre)}function ure(r){return r.schema?are(r.schema,r.tables,r.schemas,r.defaultTable,r.defaultSchema,r.dialect||Jx):()=>null}function dre(r){return r.schema?(r.dialect||Jx).language.data.of({autocomplete:ure(r)}):[]}function pre(r={}){let e=r.dialect||Jx;return new Ote(e.language,[dre(r),e.language.data.of({autocomplete:hre(e,r.upperCaseKeywords,r.keywordCompletion)})])}const Jx=Kx.define({});var mre=(r,e)=>{e()},gre=J("<option> </option>"),Ore=J('<i class="fa-solid fa-triangle-exclamation"></i>'),xre=J('<div class="field is-horizontal"><div class="field-label is-small"><label class="label">Language</label></div> <div class="field-body"><div class="field is-narrow"><div class="control has-icons-left"><div><select></select> <span class="icon is-small is-left"><!></span></div></div></div></div></div>'),vre=J('<div class="control"><div class="tags has-addons"><span class="tag is-dark">Format</span> <span> </span></div></div>'),yre=async(r,e)=>{await e()},wre=J('<button class="button is-small">Format</button>'),bre=(r,e)=>{e()},_re=J('<button class="button is-small"><span class="icon is-small"><i class="fa-solid fa-rotate-left"></i></span> <span>Reset</span></button>'),kre=(r,e)=>{e(!e())},Sre=J('<i class="fa-solid fa-eye-slash"></i>'),Tre=J('<i class="fa-solid fa-eye"></i>'),Cre=J('<button title="Hide or show Code" class="button is-small"><span class="icon is-small"><!></span></button>'),Are=J("<!> <!> <!>",1),Ere=J("<!> <div></div>",1);function is(r,e){gt(e,!0);const t=V=>{var ue=Ee(),ie=be(ue);{var P=B=>{var W=xre(),K=ne(Q(W),2),re=Q(K),pe=Q(re),fe=Q(pe),de=Q(fe);de.__change=[mre,T],_r(de,21,()=>S,Qr,(Qe,De)=>{var Fe=gre(),ve={},it=Q(Fe,!0);R(Fe),Me(()=>{ve!==(ve=C(De).value)&&(Fe.value=(Fe.__value=C(De).value)==null?"":C(De).value),Ge(it,C(De).label)}),U(Qe,Fe)}),R(de);var Ue=ne(de,2),q=Q(Ue);{var ze=Qe=>{var De=Ore();U(Qe,De)};ce(q,Qe=>{C(g)&&Qe(ze)})}R(Ue),R(fe),R(pe),R(re),R(K),R(W),Me(()=>ht(fe,`select is-small ${(C(g)?"is-danger":"")??""}`)),Sl(de,o),U(B,W)},I=B=>{var W=vre(),K=Q(W),re=ne(Q(K),2),pe=Q(re,!0);R(re),R(K),R(W),Me(()=>{ht(re,`tag ${(C(g)?"is-danger":"is-success")??""}`),Ge(pe,o())}),U(B,W)};ce(ie,B=>{f()?B(P):B(I,!1)})}U(V,ue)},n=V=>{var ue=Are(),ie=be(ue);{var P=re=>{var pe=wre();pe.__click=[yre,_],U(re,pe)};ce(ie,re=>{l()&&o()=="json"&&re(P)})}var I=ne(ie,2);{var B=re=>{var pe=_re();pe.__click=[bre,A],U(re,pe)};ce(I,re=>{u()&&re(B)})}var W=ne(I,2);{var K=re=>{var pe=Cre();pe.__click=[kre,d];var fe=Q(pe),de=Q(fe);{var Ue=ze=>{var Qe=Sre();U(ze,Qe)},q=ze=>{var Qe=Tre();U(ze,Qe)};ce(de,ze=>{d()?ze(Ue):ze(q,!1)})}R(fe),R(pe),U(re,pe)};ce(W,re=>{h()&&re(K)})}U(V,ue)};let i,s,a=ge(e,"code",15,""),o=ge(e,"lang",15,"json"),l=ge(e,"showFormat",11,!1),f=ge(e,"showSelectLang",11,!1),c=ge(e,"isReadOnly",11,!1),h=ge(e,"showHiddenButton",11,!0),u=ge(e,"showResetButton",11,!1),d=ge(e,"showCode",15,!0),p=ge(e,"onchange",3,V=>{}),m="",g=Se(!1),O="",w;const v={js:FJ(),json:cee(),html:X_(),sql:pre(),xml:X_()};let S=Y([{label:"None",value:"none"},{label:"HTML",value:"html"},{label:"Javascript",value:"js"},{label:"JSON",value:"json"},{label:"SQL",value:"sql"},{label:"XML",value:"xml"},{label:"Text",value:"text"}]),y;j1(()=>{k()});function b(V){a(V)}function x(){try{return H(g,!1),o()==="json"?JSON.parse(i.state.doc.toString()):i.state.doc.toString()}catch{return H(g,!0),i.state.doc.toString()}}function A(){O=m,k()}function k(){m=a();let V=N(m);H(g,Y(V.error)),O=V.code,E(O)}function E(V){if(i&&i.state&&V!=i.state.doc.toString()){const ue=i.state.update({changes:{from:0,to:i.state.doc.length,insert:V}});i.dispatch(ue)}}function T(){if(s){i&&i.destroy(),_();let V=v[o()]?v[o()]:[];i=new We({doc:O,extensions:[BY,c()?st.readOnly.of(!0):[],V,We.updateListener.of(async ue=>{ue.changes&&ue.changedRanges.length>0&&(O=ue.state.doc.toString(),clearTimeout(w),w=setTimeout(()=>{if(_(),!C(g))try{o()==="json"?a(JSON.parse(O)):a(O),p()({lang:o(),code:a()}),k()}catch(ie){console.log(ie)}},750))})],parent:s})}}function _(){if(i&&i.state){let V=N(i.state.doc.toString());H(g,Y(V.error)),O=V.code}}function N(V){let ue={code:V,error:void 0};if(o()=="json")try{typeof V=="object"?ue.code=JSON.stringify(V,null,2):ue.code=JSON.stringify(JSON.parse(V),null,2)}catch(ie){ue.error=ie}else ue.code=typeof V!="string"?JSON.stringify(V):V;return ue}Ut(()=>{T()}),Ua(()=>{clearTimeout(w),clearTimeout(y)});var Z=Ere(),z=be(Z),ee=kl(()=>[e.left,t]),ae=kl(()=>[e.right,n]);Cl(z,{get left(){return C(ee)},get right(){return C(ae)}});var xe=ne(z,2);return b2(xe,V=>s=V,()=>s),Me(()=>ht(xe,Qi(d()?"":"is-hidden"))),U(r,Z),Ot({setCode:b,getCode:x,reset:A})}vr(["change","click"]);function Pre(r,e,t){e()({value:t()})}var Rre=J("<option> </option>"),Qre=J("<div><select><!></select></div>");function pm(r,e){gt(e,!0);let t=ge(e,"option",15,""),n=ge(e,"options",27,()=>Y([{id:"TEST",value:"TEST",enabled:!0}])),i=ge(e,"css_class",11," is-small "),s=ge(e,"onselect",3,c=>{});var a=Qre(),o=Q(a);o.__change=[Pre,s,t];var l=Q(o);{var f=c=>{var h=Ee(),u=be(h);_r(u,17,n,Qr,(d,p)=>{var m=Rre(),g={},O=Q(m,!0);R(m),Me(()=>{g!==(g=C(p).id)&&(m.value=(m.__value=C(p).id)==null?"":C(p).id),Ge(O,C(p).value)}),U(d,m)}),U(c,h)};ce(l,c=>{n()&&Array.isArray(n())&&c(f)})}R(o),R(a),Me(()=>ht(a,`select ${i()??""}`)),Sl(o,t),U(r,a),Ot()}vr(["change"]);var Fre=J('<div><div class="overlay svelte-10va6op"><div class="overlay-content box svelte-10va6op"><!></div></div></div>');function $re(r,e){gt(e,!0);let t=ge(e,"show",11,!1);var n=Fre(),i=Q(n),s=Q(i),a=Q(s);pc(a,()=>e.children??dc),R(s),R(i),R(n),Me(()=>Ea(i,"style",`width: ${(t()?"100%":"0%")??""};`)),U(r,n),Ot()}function U1(r,e){gt(e,!0);let t=ge(e,"data",15),n={enabled:{label:"Enabled",decorator:{component:mc,props:{ontrue:{label:"Enabled"},onfalse:{label:"Unabled"},editInline:!0}}},key:{label:"Key",decorator:{component:Rm,props:{editInline:!0}}},value:{label:"Value",decorator:{component:Rm,props:{editInline:!0}}}};function i(){!t()||!Array.isArray(t())?(t([]),t().push({enabled:!1,key:"",value:""})):t()&&Array.isArray(t())&&!t().find(s=>s.key=="")&&t().push({enabled:!0,key:"",value:""})}Ut(()=>{i()}),vh(r,{columns:n,ShowNewButton:!0,ShowDeleteButton:!0,onnewrow:()=>{i()},get RawDataTable(){return t()},set RawDataTable(s){t(s)}}),Ot()}const Dre=r=>{var e=Nre();U(r,e)};var Nre=J('<label class="label is-small">No Authentication Selected</label>'),Mre=J('<div class="control has-icons-left has-icons-right"><input class="input is-small" type="text" placeholder="Username"> <span class="icon is-small is-left"><i class="fa-solid fa-user"></i></span></div>'),Ire=J('<div class="control has-icons-left has-icons-right"><input class="input is-small" type="text" placeholder="Password"> <span class="icon is-small is-left"><i class="fa-solid fa-key"></i></span></div>'),Lre=J('<div><div class="field"><label class="label is-small">Username</label> <!></div> <div class="field"><label class="label is-small">Password</label> <!></div></div>'),Bre=J('<textarea class="textarea is-small" placeholder="Token"></textarea>'),Zre=J('<div><div class="field"><label class="label is-small">Token</label> <div class="control"><!></div></div></div>');function Wre(r,e){gt(e,!0);const t=c=>{var h=Ee(),u=be(h);{var d=p=>{var m=Lre(),g=Q(m),O=ne(Q(g),2);{var w=b=>{var x=Mre(),A=Q(x);wt(A),Kt(2),R(x),Jt(A,()=>i().basic.username,k=>i(i().basic.username=k,!0)),U(b,x)};ce(O,b=>{i()&&i().basic&&b(w)})}R(g);var v=ne(g,2),S=ne(Q(v),2);{var y=b=>{var x=Ire(),A=Q(x);wt(A),Kt(2),R(x),Jt(A,()=>i().basic.passsword,k=>i(i().basic.passsword=k,!0)),U(b,x)};ce(S,b=>{i()&&i().basic&&b(y)})}R(v),R(m),U(p,m)};ce(u,p=>{i()&&p(d)})}U(c,h)},n=c=>{var h=Ee(),u=be(h);{var d=p=>{var m=Zre(),g=Q(m),O=ne(Q(g),2),w=Q(O);{var v=S=>{var y=Bre();l0(y),Jt(y,()=>i().bearer.token,b=>i(i().bearer.token=b,!0)),U(S,y)};ce(w,S=>{i()&&i().bearer&&S(v)})}R(O),R(g),R(m),U(p,m)};ce(u,p=>{i()!=null&&p(d)})}U(c,h)};let i=ge(e,"data",31,()=>Y({selection:0,basic:{username:"",passsword:""},bearer:{token:""}})),s=Se(Y([{label:"None",component:Dre},{label:"Basic",component:t},{label:"Bearer",component:n}]));function a(){i()==null&&i({basic:{username:"",passsword:""},bearer:{token:""}}),i()&&i().basic==null&&i(i().basic={username:"",passsword:""},!0),i()&&i().bearer==null&&i(i().bearer={token:""},!0),i()&&i().selection==null&&i(i().selection=0,!0)}Ut(()=>{a()});var o=Ee(),l=be(o);{var f=c=>{Jn(c,{get tabs(){return C(s)},set tabs(h){H(s,Y(h))},get active(){return i().selection},set active(h){i(i().selection=h,!0)}})};ce(l,c=>{i()!=null&&c(f)})}U(r,o),Ot()}var Ure=J("<div><!></div>"),Xre=J('<textarea class="textarea is-small" placeholder="Content"></textarea>'),Vre=J('<div><div class="field"><label class="label is-small">Content</label> <div class="control"><!></div></div></div>'),qre=J("<div><!></div>"),jre=(r,e)=>{r.target.files.length>0&&H(e,Y(r.target.files[0].name))},zre=J('<div><div class="file has-name is-small"><label class="file-label"><input class="file-input is-small" type="file" name="resume"> <span class="file-cta"><span class="file-icon is-small"><i class="fas fa-upload"></i></span> <span class="file-label">Choose a file</span></span> <span class="file-name"> </span></label></div></div>');function Gre(r,e){gt(e,!0);const t=g=>{var O=Ure(),w=Q(O);{var v=S=>{is(S,{lang:"json",get code(){return o().json.code},set code(y){o(o().json.code=y,!0)}})};ce(w,S=>{o()&&o().json&&S(v)})}R(O),U(g,O)},n=g=>{var O=Ee(),w=be(O);{var v=S=>{is(S,{lang:"xml",get code(){return o().xml.code},set code(y){o(o().xml.code=y,!0)}})};ce(w,S=>{o()&&o().xml&&S(v)})}U(g,O)},i=g=>{var O=Ee(),w=be(O);{var v=S=>{var y=Vre(),b=Q(y),x=ne(Q(b),2),A=Q(x);{var k=E=>{var T=Xre();l0(T),Jt(T,()=>o().text.value,_=>o(o().text.value=_,!0)),U(E,T)};ce(A,E=>{o()&&o().text&&E(k)})}R(x),R(b),R(y),U(S,y)};ce(w,S=>{o()&&S(v)})}U(g,O)},s=g=>{var O=Ee(),w=be(O);{var v=S=>{var y=qre(),b=Q(y);U1(b,{}),R(y),U(S,y)};ce(w,S=>{o()&&S(v)})}U(g,O)},a=g=>{var O=Ee(),w=be(O);{var v=S=>{var y=zre(),b=Q(y),x=Q(b),A=Q(x);A.__change=[jre,l];var k=ne(A,4),E=Q(k,!0);R(k),R(x),R(b),R(y),Me(()=>Ge(E,C(l))),U(S,y)};ce(w,S=>{o()&&S(v)})}U(g,O)};let o=ge(e,"data",31,()=>Y({selection:0,json:{code:{}},xml:{code:""},text:{}})),l=Se(""),f=Se(Y([{label:"JSON",component:t},{label:"XML",disabled:!0,component:n},{label:"Text",disabled:!0,component:i},{label:"Form-Encode",disabled:!0,component:s},{label:"Binary",disabled:!0,component:a}]));function c(){}function h(){}function u(){o()||o({selection:0,json:{code:{}},xml:{code:""},text:{}}),o()&&!o().json&&o(o().json={},!0),o()&&o().json&&!o().json.code&&o(o().json.code={},!0),o()&&!o().xml&&o(o().xml={},!0),o()&&o().xml&&!o().xml.code&&o(o().xml.code="",!0),o()&&!o().text&&o(o().text={},!0),o()&&!o().selection&&o(o().selection=0,!0)}Ut(()=>{u()});var d=Ee(),p=be(d);{var m=g=>{Jn(g,{get tabs(){return C(f)},set tabs(O){H(f,Y(O))},get active(){return o().selection},set active(O){o(o().selection=O,!0)}})};ce(p,g=>{o()&&g(m)})}return U(r,d),Ot({getCode:c,reset:h})}vr(["change"]);var Hre=J('<div class="box"><code><!></code></div>');function Cs(r,e){gt(e,!0);let t=ge(e,"jsonObject",27,()=>Y({}));function n(f){return JSON.stringify(f,null,2).replace(/\n/g,"<br/>").replace(/ /g,"&nbsp;")}var i=Hre(),s=Q(i),a=Q(s);{var o=f=>{var c=Ee(),h=be(c);a3(h,()=>n(t())),U(f,c)},l=f=>{var c=vs();Me(()=>Ge(c,t())),U(f,c)};ce(a,f=>{t()&&typeof t()=="object"?f(o):f(l,!1)})}R(s),R(i),U(r,i),Ot()}var Yre=J('<span class="tag"> </span>'),Kre=J('<span class="tag"></span>'),Jre=J('<span class="tag"> </span>'),ene=J('<span class="tag"></span>'),tne=J('<span class="tag"> </span>'),rne=J('<span class="tag"></span>'),nne=J('<span class="tag"> </span>'),ine=J('<span class="tag">ms</span>'),sne=J('<span class="tag"> </span>'),ane=J('<span class="tag">KB</span>'),one=J("<code> </code>"),lne=(r,e,t,n)=>{C(e)=="json"?t(JSON.stringify(C(n)),"response.json","text/json"):C(e)=="text"&&t(C(n),"response.txt","text/plain")},fne=J('<div class="container is-max-tablet is-small"><p class="block"> </p> <div class="is-align-content-center"><button class="button is-link is-outlined is-small">Download</button></div></div>'),cne=J('<div class="field is-grouped is-grouped-multiline"><div class="control"><div class="tags has-addons"><span>Status</span> <!></div></div> <div class="control"><div class="tags has-addons"><span>Status Text</span> <!></div></div> <div class="control"><div class="tags has-addons"><span>Ok</span> <!></div></div> <div class="control"><div class="tags has-addons"><span class="tag is-dark">Time</span> <!></div></div> <div class="control"><div class="tags has-addons"><span>Size</span> <!></div></div></div> <div><!></div>',1),hne=J("<option> </option>"),une=J("<option> </option>"),dne=async(r,e,t,n,i,s,a,o,l,f,c,h,u,d,p,m,g)=>{if(H(e,4),C(t))alert("There is an execution in progress");else{H(t,!0);let O={};try{if(n()=="GET"||n()=="HEAD"||n()=="OPTIONS"||n()=="CONNECT"||n()=="TRACE")O=i(s().query);else if(n()=="POST"||n()=="PUT"||n()=="PATCH"){let S=a();S?O=S:O=i(s().query)}o();let w=Date.now();H(l,Y(await f[n()]({url:c(),data:O,headers:h(s().headers)})));let v=Date.now();if(H(u,v-w),console.warn(C(l)),C(l).ok)switch(C(d)){case"json":H(p,Y(await C(l).json())),H(m,Y(g(C(p))));break;case"text":H(p,Y(await C(l).text()));break;case"datatable":H(p,Y(await C(l).json())),H(m,Y(g(C(p))));break;default:H(p,""),H(m,-1);break}else H(p,Y(await C(l).json()))}catch(w){H(t,!1),console.error(w),H(p,Y(w)),alert(w)}H(t,!1)}},pne=J('<i class="fa-solid fa-cog fa-spin"></i>'),mne=J('<i class="fa-solid fa-play"></i>'),gne=J('<div class="block block_marg svelte-1ndugcm"><div class="columns"><div class="column is-half"><div class="field has-addons"><p class="control"><a class="button is-static is-small">Url</a></p> <p class="control is-expanded"><input class="input is-small is-expanded" type="text" placeholder="URL"></p></div></div> <div class="column"><nav class="level"><div class="level-right"><span class="level-item"><div class="field has-addons"><p class="control"><button class="button is-static is-small">Method:</button></p> <p class="control"><span class="select is-small"><select></select></span></p></div></span> <span class="level-item"><div class="field has-addons"><p class="control"><button class="button is-static is-small">Show as:</button></p> <p class="control"><span class="select is-small"><select></select></span></p></div></span> <span class="level-item"><button class="button is-success is-small is-outlined"><span class="icon is-small"><!></span> <span>Execute</span></button></span></div></nav></div></div> <!></div>');function Ha(r,e){gt(e,!0);const t=Ce=>{var Ve=Ee(),Ae=be(Ve);{var Te=Re=>{U1(Re,{get data(){return h().query},set data(Nt){h(h().query=Nt,!0)}})};ce(Ae,Re=>{h()&&Re(Te)})}U(Ce,Ve)},n=Ce=>{var Ve=Ee(),Ae=be(Ve);{var Te=Re=>{U1(Re,{get data(){return h().headers},set data(Nt){h(h().headers=Nt,!0)}})};ce(Ae,Re=>{h()!=null&&Re(Te)})}U(Ce,Ve)},i=Ce=>{var Ve=Ee(),Ae=be(Ve);{var Te=Re=>{Wre(Re,{get data(){return h().auth},set data(Nt){h(h().auth=Nt,!0)}})};ce(Ae,Re=>{h()!=null&&Re(Te)})}U(Ce,Ve)},s=Ce=>{var Ve=Ee(),Ae=be(Ve);{var Te=Re=>{Gre(Re,{get data(){return h().body},set data(Nt){h(h().body=Nt,!0)}})};ce(Ae,Re=>{h()&&Re(Te)})}U(Ce,Ve)},a=Ce=>{var Ve=cne(),Ae=be(Ve),Te=Q(Ae),Re=Q(Te),Nt=Q(Re),yr=ne(Nt,2);{var qr=D=>{var M=Yre(),X=Q(M,!0);R(M),Me(()=>Ge(X,C(d).status)),U(D,M)},at=D=>{var M=Kre();U(D,M)};ce(yr,D=>{C(d)&&C(d).status?D(qr):D(at,!1)})}R(Re),R(Te);var Mt=ne(Te,2),jr=Q(Mt),Gt=Q(jr),Bi=ne(Gt,2);{var la=D=>{var M=Jre(),X=Q(M,!0);R(M),Me(()=>Ge(X,C(d).statusText)),U(D,M)},Vo=D=>{var M=ene();U(D,M)};ce(Bi,D=>{C(d)&&C(d).statusText?D(la):D(Vo,!1)})}R(jr),R(Mt);var fa=ne(Mt,2),Ka=Q(fa),Le=Q(Ka),Je=ne(Le,2);{var lr=D=>{var M=tne(),X=Q(M,!0);R(M),Me(()=>Ge(X,C(d).ok)),U(D,M)},Ht=D=>{var M=rne();U(D,M)};ce(Je,D=>{C(d)&&C(d).ok?D(lr):D(Ht,!1)})}R(Ka),R(fa);var fr=ne(fa,2),ei=Q(fr),xi=ne(Q(ei),2);{var ti=D=>{var M=nne(),X=Q(M);R(M),Me(()=>Ge(X,`${C(p)??""} ms`)),U(D,M)},Ar=D=>{var M=ine();U(D,M)};ce(xi,D=>{C(p)?D(ti):D(Ar,!1)})}R(ei),R(fr);var Rt=ne(fr,2),cr=Q(Rt),hr=Q(cr),xt=ne(hr,2);{var vt=D=>{var M=sne(),X=Q(M);R(M),Me(()=>Ge(X,`${C(v)??""} KB`)),U(D,M)},mr=D=>{var M=ane();U(D,M)};ce(xt,D=>{C(v)?D(vt):D(mr,!1)})}R(cr),R(Rt),R(Ae);var zr=ne(Ae,2),mn=Q(zr);{var F=D=>{var M=Ee(),X=be(M);{var G=he=>{Cs(he,{get jsonObject(){return C(O)},set jsonObject(te){H(O,Y(te))}})},oe=he=>{var te=Ee(),se=be(te);{var le=ye=>{Cs(ye,{get jsonObject(){return C(O)},set jsonObject(Pe){H(O,Y(Pe))}})},we=ye=>{var Pe=Ee(),ke=be(Pe);{var Ie=ut=>{var mt=one(),Xt=Q(mt,!0);R(mt),Me(()=>Ge(Xt,C(O))),U(ut,mt)},He=ut=>{var mt=Ee(),Xt=be(mt);{var Qn=Er=>{vh(Er,{get RawDataTable(){return C(O)},set RawDataTable(Bn){H(O,Y(Bn))}})};ce(Xt,Er=>{C(m)=="datatable"&&C(O)&&Er(Qn)},!0)}U(ut,mt)};ce(ke,ut=>{C(m)=="text"&&C(O)?ut(Ie):ut(He,!1)},!0)}U(ye,Pe)};ce(se,ye=>{C(m)=="json"&&C(O)?ye(le):ye(we,!1)},!0)}U(he,te)};ce(X,he=>{C(d)&&!C(d).ok&&C(O)?he(G):he(oe,!1)})}U(D,M)},j=D=>{var M=fne(),X=Q(M),G=Q(X);R(X);var oe=ne(X,2),he=Q(oe);he.__click=[lne,m,T,O],R(oe),R(M),Me(()=>Ge(G,`The response exceeds ${f()??""} KB, it cannot be displayed in the view.`)),U(D,M)};ce(mn,D=>{Number(C(v))<Number(f())?D(F):D(j,!1)})}R(zr),Me(()=>{ht(Nt,`tag ${(C(d)&&C(d).ok?"is-success":"is-danger")??""}`),ht(Gt,`tag ${(C(d)&&C(d).ok?"is-success":"is-dark")??""}`),ht(Le,`tag ${(C(d)&&C(d).ok?"is-success":"is-dark")??""}`),ht(hr,`tag ${(C(v)>f()?"is-danger":"is-dark")??""}  `)}),U(Ce,Ve)};let o=ge(e,"url",15),l=ge(e,"method",15,"GET"),f=ge(e,"limitSizeResponseView",11,2e4),c=ge(e,"methodDisabled",11,!1),h=ge(e,"data",31,()=>Y({query:[],headers:[],auth:{},body:{}}));ge(e,"onchange",3,()=>{});let u=new as,d=Se(void 0),p=Se(void 0),m=Se("json"),g=Se(0),O=Se(""),w=Se(!1),v=Se(0),S=[{method:"CONNECT",label:"CONNECT"},{method:"DELETE",label:"DELETE"},{method:"GET",label:"GET"},{method:"HEAD",label:"HEAD"},{method:"OPTIONS",label:"OPTIONS"},{method:"POST",label:"POST"},{method:"PATCH",label:"PATCH"},{method:"PUT",label:"PUT"},{method:"TRACE",label:"TRACE"}],y=[{as:"json",label:"JSON"},{as:"datatable",label:"Table"},{as:"text",label:"Text"}],b=Se(Y([{label:"Query Parameters",isActive:!0,component:t},{label:"HTTP Headers",component:n},{label:"Auth",component:i},{label:"Body",component:s},{label:"Result",component:a}])),x;function A(){h()==null&&h({}),h()&&h().auth==null&&h(h().auth={selection:0},!0),h()&&h().auth&&h().auth.selection==null&&h(h().auth.selection=0,!0),h()&&h().body==null&&h(h().body={selection:0},!0),h()&&h().body&&h().body.selection==null&&h(h().body.selection=0,!0),h()&&h().query==null&&h(h().query={},!0),h()&&h().headers==null&&h(h().headers={},!0)}function k(Ce){const Ve=JSON.stringify(Ce);return E(Ve)}function E(Ce){return(new TextEncoder().encode(Ce).length/1024).toFixed(4)}function T(Ce,Ve,Ae="text/plain"){const Te=new Blob([Ce],{type:Ae}),Re=URL.createObjectURL(Te),Nt=document.createElement("a");Nt.href=Re,Nt.download=Ve,document.body.appendChild(Nt),Nt.click(),document.body.removeChild(Nt),URL.revokeObjectURL(Re)}function _(){H(d,Y({})),H(O,void 0),H(p,void 0)}function N(){var Ve,Ae,Te;let Ce;switch(h().body.selection){case 0:try{let Re=((Te=(Ae=(Ve=h())==null?void 0:Ve.body)==null?void 0:Ae.json)==null?void 0:Te.code)??void 0;typeof Re=="object"?Ce=Re:Ce=JSON.parse(Re)}catch(Re){console.warn(Re),Ce={}}break;default:Ce=void 0;break}return Ce}function Z(Ce){let Ve={};if(Ce&&Array.isArray(Ce))for(let Ae=0;Ae<Ce.length;Ae++)Ce[Ae].enabled&&Ce[Ae].key&&Ce[Ae].key.length>0&&(Ve[Ce[Ae].key]=Ce[Ae].value);return Ve}function z(Ce){let Ve={};if(Ce&&Array.isArray(Ce))for(let Ae=0;Ae<Ce.length;Ae++)Ce[Ae].enabled&&Ce[Ae].key&&Ce[Ae].key.length>0&&(Ve[Ce[Ae].key]=Ce[Ae].value);return Ve}Ut(()=>{A()}),Ua(()=>{clearTimeout(x)});var ee=gne(),ae=Q(ee),xe=Q(ae),V=Q(xe),ue=ne(Q(V),2),ie=Q(ue);wt(ie),R(ue),R(V),R(xe);var P=ne(xe,2),I=Q(P),B=Q(I),W=Q(B),K=Q(W),re=ne(Q(K),2),pe=Q(re),fe=Q(pe);_r(fe,21,()=>S,Qr,(Ce,Ve)=>{var Ae=hne(),Te={},Re=Q(Ae,!0);R(Ae),Me(()=>{Te!==(Te=C(Ve).method)&&(Ae.value=(Ae.__value=C(Ve).method)==null?"":C(Ve).method),Ge(Re,C(Ve).label)}),U(Ce,Ae)}),R(fe),R(pe),R(re),R(K),R(W);var de=ne(W,2),Ue=Q(de),q=ne(Q(Ue),2),ze=Q(q),Qe=Q(ze);_r(Qe,21,()=>y,Qr,(Ce,Ve)=>{var Ae=une(),Te={},Re=Q(Ae,!0);R(Ae),Me(()=>{Te!==(Te=C(Ve).as)&&(Ae.value=(Ae.__value=C(Ve).as)==null?"":C(Ve).as),Ge(Re,C(Ve).label)}),U(Ce,Ae)}),R(Qe),R(ze),R(q),R(Ue),R(de);var De=ne(de,2),Fe=Q(De);Fe.__click=[dne,g,w,l,z,h,N,_,d,u,o,Z,p,m,O,v,k];var ve=Q(Fe),it=Q(ve);{var ot=Ce=>{var Ve=pne();U(Ce,Ve)},bt=Ce=>{var Ve=mne();U(Ce,Ve)};ce(it,Ce=>{C(w)?Ce(ot):Ce(bt,!1)})}R(ve),Kt(2),R(Fe),R(De),R(B),R(I),R(P),R(ae);var $t=ne(ae,2);Jn($t,{get tabs(){return C(b)},set tabs(Ce){H(b,Y(Ce))},get active(){return C(g)},set active(Ce){H(g,Y(Ce))}}),R(ee),Me(()=>fe.disabled=c()),Jt(ie,o),Sl(fe,l),Sl(Qe,()=>C(m),Ce=>H(m,Ce)),U(r,ee),Ot()}vr(["click"]);async function yP(r){let e={result:!1,error:void 0};if(navigator.clipboard&&navigator.clipboard.writeText)try{await navigator.clipboard.writeText(r),e.result=!0}catch{e.error=err}else{let t=document.createElement("input");t.style.position="absolute",t.style.left="-9999px",t.setAttribute("readonly","true"),t.value=r,document.body.appendChild(t),t.select(),t.setSelectionRange(0,99999);try{document.execCommand("copy"),e.result=!0}catch(n){e.error=n}document.body.removeChild(t)}return e}var One=J('<span class="icon-text"><span><i></i></span> <span> </span></span>');function wP(r,e){let t=ge(e,"color",11,""),n=ge(e,"label",11," Label "),i=ge(e,"icon",11,"fas fa-home");var s=One(),a=Q(s),o=Q(a);R(a);var l=ne(a,2),f=Q(l,!0);R(l),R(s),Me(()=>{ht(a,`icon has-text-${t()??""}`),ht(o,Qi(i())),Ge(f,n())}),U(r,s)}var xne=J("<td><!></td>");function vne(r,e){gt(e,!0);let t=ge(e,"value",15,""),n=Se(""),i=Se("fas fa-home");function s(f){let c=P2[f];c?(H(n,Y(c.color)),H(i,Y(c.icon))):(H(n,""),H(i,""))}Ut(()=>{s(t())});var a=xne(),o=Q(a);{var l=f=>{wP(f,{get color(){return C(n)},set color(c){H(n,Y(c))},get label(){return t()},set label(c){t(c)},get icon(){return C(i)},set icon(c){H(i,Y(c))}})};ce(o,f=>{t()!=null&&f(l)})}R(a),U(r,a),Ot()}function yne(r,e,t){e()(t())}var wne=J("<option> </option>"),bne=J('<div class="control"><div><select><!></select></div></div>');function Z0(r,e){gt(e,!0);let t=ge(e,"onchange",3,()=>{}),n=ge(e,"option",15,"NA"),i=ge(e,"css_class",11," is-small "),s=ge(e,"options",27,()=>Y([{id:"TEST",value:"TEST",enabled:!0}]));var a=bne(),o=Q(a),l=Q(o);l.__change=[yne,t,n];var f=Q(l);{var c=h=>{var u=Ee(),d=be(u);_r(d,17,s,Qr,(p,m)=>{var g=wne(),O={},w=Q(g,!0);R(g),Me(()=>{O!==(O=C(m).id)&&(g.value=(g.__value=C(m).id)==null?"":C(m).id),Ge(w,C(m).value)}),U(p,g)}),U(h,u)};ce(f,h=>{s()&&s().length>0&&h(c)})}R(l),R(o),R(a),Me(()=>ht(o,`select ${i()??""}`)),Sl(l,n),U(r,a),Ot()}vr(["change"]);var _ne=J("<td><!></td>");function kne(r,e){gt(e,!0);let t=ge(e,"value",15);Ut(()=>{});var n=_ne(),i=Q(n);Z0(i,{options:E2,onselect:s=>{console.log("Cambia",s,t())},get option(){return t()},set option(s){t(s)}}),R(n),U(r,n),Ot()}var Sne=J("<td><!></td>");function Tne(r,e){gt(e,!0);let t=Se(""),n=Se(""),i=Se("fas fa-home");function s(f){let c=bm[f];c?(H(n,Y(c.color)),H(i,Y(c.icon))):(H(n,""),H(i,"")),c&&c.label?H(t,Y(c.label)):H(t,Y(e.value))}Ut(()=>{s(e.value)});var a=Sne(),o=Q(a);{var l=f=>{wP(f,{get color(){return C(n)},set color(c){H(n,Y(c))},get label(){return C(t)},set label(c){H(t,Y(c))},get icon(){return C(i)},set icon(c){H(i,Y(c))}})};ce(o,f=>{e.row.method!=="WS"&&f(l)})}R(a),U(r,a),Ot()}var Cne=J('<span class="tag is-info"> </span>'),Ane=J('<span class="tag is-success"> </span>'),Ene=J('<span class="tag is-primary"> </span>'),Pne=J('<span class="tag is-warning"> </span>'),Rne=J('<span class="tag is-danger"> </span>'),Qne=J('<span class="tag is-dark"> </span>'),Fne=J('<div class="control"><div class="tags has-addons"><!> <span class="tag is-dark"> </span></div></div>'),$ne=J('<div class="field is-grouped is-grouped-multiline"></div>'),Dne=J("<td><!></td>");function Nne(r,e){gt(e,!0);let t=Se(Y({}));A2.subscribe(a=>{if(e.row&&e.row.endpoint){let o=`${e.row.endpoint.toLowerCase()}|${e.row.method}`;if(a&&Array.isArray(a))if(a.length>0){let l=a.find(f=>f[o]);l&&l[o]?H(t,Y(l[o])):H(t,Y([]))}else H(t,Y([]))}}),Ut(()=>{});var n=Dne(),i=Q(n);{var s=a=>{var o=Ee(),l=be(o);{var f=c=>{var h=$ne();_r(h,21,()=>Object.keys(C(t)),Qr,(u,d)=>{var p=Fne(),m=Q(p),g=Q(m);{var O=y=>{var b=Cne(),x=Q(b,!0);R(b),Me(()=>Ge(x,C(d))),U(y,b)},w=y=>{var b=Ee(),x=be(b);{var A=E=>{var T=Ane(),_=Q(T,!0);R(T),Me(()=>Ge(_,C(d))),U(E,T)},k=E=>{var T=Ee(),_=be(T);{var N=z=>{var ee=Ene(),ae=Q(ee,!0);R(ee),Me(()=>Ge(ae,C(d))),U(z,ee)},Z=z=>{var ee=Ee(),ae=be(ee);{var xe=ue=>{var ie=Pne(),P=Q(ie,!0);R(ie),Me(()=>Ge(P,C(d))),U(ue,ie)},V=ue=>{var ie=Ee(),P=be(ie);{var I=W=>{var K=Rne(),re=Q(K,!0);R(K),Me(()=>Ge(re,C(d))),U(W,K)},B=W=>{var K=Qne(),re=Q(K,!0);R(K),Me(()=>Ge(re,C(d))),U(W,K)};ce(P,W=>{C(d)>=500&&C(d)<600?W(I):W(B,!1)},!0)}U(ue,ie)};ce(ae,ue=>{C(d)>=400&&C(d)<500?ue(xe):ue(V,!1)},!0)}U(z,ee)};ce(_,z=>{C(d)>=300&&C(d)<400?z(N):z(Z,!1)},!0)}U(E,T)};ce(x,E=>{C(d)>=200&&C(d)<300?E(A):E(k,!1)},!0)}U(y,b)};ce(g,y=>{C(d)>=100&&C(d)<200?y(O):y(w,!1)})}var v=ne(g,2),S=Q(v,!0);R(v),R(m),R(p),Me(()=>Ge(S,C(t)[C(d)])),U(u,p)}),R(h),U(c,h)};ce(l,c=>{C(t)&&c(f)})}U(a,o)};ce(i,a=>{e.row.method!=="WS"&&a(s)})}R(n),U(r,n),Ot()}var Mne=J("<span><i></i></span>"),Ine=J('<span class="icon"><i class="fa-solid fa-question"></i></span>'),Lne=J('<td><div class="icon-text"><!> <span> </span></div></td>');function Bne(r,e){gt(e,!0),Ut(()=>{});var t=Lne(),n=Q(t),i=Q(n);{var s=f=>{var c=Mne(),h=Q(c);R(c),Me(()=>{ht(c,`icon ${Yf[e.row.environment].color??""}`),ht(h,Qi(Yf[e.row.environment].icon))}),U(f,c)},a=f=>{var c=Ine();U(f,c)};ce(i,f=>{var c;(c=e.row)!=null&&c.environment&&Yf[e.row.environment]?f(s):f(a,!1)})}var o=ne(i,2),l=Q(o,!0);R(o),R(n),R(t),Me(()=>Ge(l,e.value)),U(r,t),Ot()}var Zne=J('<a class="button is-small has-text-success"><span class="icon"><i class="fa-solid fa-star bolt fa-beat-fade" style="--fa-beat-fade-opacity: 0.1; --fa-beat-fade-scale: 1.25;"></i></span> <span> </span></a>'),Wne=J('<a class="button is-small"><span class="icon"><i class="fa-regular fa-star"></i></span> <span>0.0000 KB</span></a>'),Une=J('<div class="field has-addons"><div class="control is-small"><input class="input is-small" type="number" placeholder="Cache time" step="1" min="0"></div> <div class="control"><a class="button is-small">seg.</a></div> <div class="control"><!></div></div>'),Xne=J("<td><!></td>");function Vne(r,e){gt(e,!0);let t=ge(e,"value",15),n=Se(Y({}));C2.subscribe(o=>{if(o&&Array.isArray(o))if(o.length>0&&e.row){let l=o.find(f=>f.url.toLowerCase()==`${e.row.endpoint}|${e.row.method}`.toLowerCase());l?H(n,Y(l)):C(n).bytes=0}else C(n).bytes=0}),Ut(()=>{});var i=Xne(),s=Q(i);{var a=o=>{var l=Une(),f=Q(l),c=Q(f);wt(c),R(f);var h=ne(f,4),u=Q(h);{var d=m=>{var g=Zne(),O=ne(Q(g),2),w=Q(O);R(O),R(g),Me(()=>Ge(w,`${C(n).bytes??""} KB`)),U(m,g)},p=m=>{var g=Wne();U(m,g)};ce(u,m=>{e.row&&C(n)&&C(n).bytes&&C(n).bytes>0?m(d):m(p,!1)})}R(h),R(l),Jt(c,t),U(o,l)};ce(s,o=>{e.row.method!=="WS"&&o(a)})}R(i),U(r,i),Ot()}var qne=(r,e,t)=>{let n="$_VAR_"+C(e).toUpperCase();t()[n]?alert("Var "+n+" already exists."):t(t()[n]={},!0)},jne=J('<div class="field has-addons"><div class="control"><button class="button is-small is-static">$_VAR_</button></div> <div class="control"><input class="input is-small" type="text" placeholder="New app variable"></div> <div class="control"><button class="button is-success is-small">New</button></div></div>'),zne=J("<div><!></div>"),Gne=J('<p class="control"><input class="input is-success is-small" type="text" placeholder="Edit variable name"></p> <p class="control"><button class="button is-small is-outlined is-success" title="Apply"><span class="icon is-small"><i class="fa-solid fa-check"></i></span></button></p> <p class="control"><button class="button is-small is-outlined is-danger" title="Cancel"><span class="icon is-small"><i class="fa-solid fa-xmark"></i></span></button></p>',1),Hne=J('<p class="control"><button class="button is-small" title="Edit variable name"><span class="icon is-small"><i class="fa-solid fa-pen"></i></span></button></p>'),Yne=async(r,e,t)=>{(await yP(C(e))).result&&(H(t,Y(C(e))),setTimeout(()=>{H(t,"")},1500))},Kne=async(r,e,t,n)=>{(await yP(e()[C(t)]?JSON.stringify(e()[C(t)]):"")).result&&(H(n,Y(C(t))),setTimeout(()=>{H(n,"")},1500))},Jne=J('<span><div class="field has-addons"><p class="control"><a class="button is-static is-small"> </a></p> <!> <p class="control"><button class="button is-small" title="Copy Name"><span class="icon is-small has-text-info"><i></i></span></button></p> <p class="control"><button class="button is-small has-text-success" title="Copy Value"><span class="icon is-small"><i></i></span></button></p></div></span>'),eie=(r,e,t)=>{confirm("Are you sure you want to remove the variable "+C(e)+"?")&&t(C(e))},tie=J('<div class="field has-addons"><p class="control"><button class="button is-small is-outlined is-danger" title="Delete variable"><span class="icon is-small"><i class="fa-solid fa-trash"></i></span></button></p></div>'),rie=J("<span><!></span>"),nie=J('<!> <hr class="reset_margin svelte-192jd83">',1),iie=J('<!> <div class="box"></div>',1);function mm(r,e){gt(e,!0);let t=ge(e,"isReadOnly",11,!1),n=ge(e,"showCode",11,!1),i=ge(e,"appVars",31,()=>Y({})),s=ge(e,"title",11,""),a=Se(""),o={},l={},f=Se(""),c=Se("");function h(){return i()}function u(g){delete i()[g],i(i())}Ut(()=>{});var d=Ee(),p=be(d);{var m=g=>{var O=iie(),w=be(O);{const S=b=>{Kt();var x=vs();Me(()=>Ge(x,s())),U(b,x)},y=b=>{var x=zne(),A=Q(x);{var k=E=>{var T=jne(),_=ne(Q(T),2),N=Q(_);wt(N),R(_);var Z=ne(_,2),z=Q(Z);z.__click=[qne,a,i],R(Z),R(T),Jt(N,()=>C(a),ee=>H(a,ee)),U(E,T)};ce(A,E=>{t()||E(k)})}R(x),U(b,x)};Cl(w,{left:[S],right:[y],l01:S,r01:y,$$slots:{l01:!0,r01:!0}})}var v=ne(w,2);_r(v,21,()=>Object.keys(i()),Qr,(S,y)=>{var b=Ee(),x=be(b);{var A=k=>{var E=nie(),T=be(E);{const _=Z=>{var z=Jne(),ee=Q(z),ae=Q(ee),xe=Q(ae),V=Q(xe,!0);R(xe),R(ae);var ue=ne(ae,2);{var ie=de=>{var Ue=Ee(),q=be(Ue);{var ze=De=>{var Fe=Gne(),ve=be(Fe),it=Q(ve);wt(it),R(ve);var ot=ne(ve,2),bt=Q(ot);bt.__click=()=>{i(i()[o[C(y)]]={...o[C(y)]},!0),u(C(y))},R(ot);var $t=ne(ot,2),Ce=Q($t);Ce.__click=()=>{l[C(y)]=!1},R($t),Jt(it,()=>o[C(y)],Ve=>o[C(y)]=Ve),U(De,Fe)},Qe=De=>{var Fe=Hne(),ve=Q(Fe);ve.__click=()=>{l[C(y)]=!l[C(y)],o[C(y)]=C(y)},R(Fe),U(De,Fe)};ce(q,De=>{l[C(y)]?De(ze):De(Qe,!1)})}U(de,Ue)};ce(ue,de=>{t()||de(ie)})}var P=ne(ue,2),I=Q(P);I.__click=[Yne,y,f];var B=Q(I),W=Q(B);R(B),R(I),R(P);var K=ne(P,2),re=Q(K);re.__click=[Kne,i,y,c];var pe=Q(re),fe=Q(pe);R(pe),R(re),R(K),R(ee),R(z),Me(()=>{Ge(V,C(y)),ht(W,`fa-solid fa-copy ${(C(f)==C(y)?" fa-shake ":"")??""}`),ht(fe,`fa-regular fa-copy ${(C(c)==C(y)?" fa-shake ":"")??""}`)}),U(Z,z)},N=Z=>{var z=rie(),ee=Q(z);{var ae=xe=>{var V=tie(),ue=Q(V),ie=Q(ue);ie.__click=[eie,y,u],R(ue),R(V),U(xe,V)};ce(ee,xe=>{t()||xe(ae)})}R(z),U(Z,z)};is(T,{left:_,right:N,get showCode(){return n()},get isReadOnly(){return t()},get code(){return i()[C(y)]},set code(Z){i(i()[C(y)]=Z,!0)},left_Editor:_,right_Editor:N,$$slots:{left_Editor:!0,right_Editor:!0}})}Kt(2),U(k,E)};ce(x,k=>{i()[C(y)]&&k(A)})}U(S,b)}),R(v),U(g,O)};ce(p,g=>{i()&&g(m)})}return U(r,d),Ot({getCode:h})}vr(["click"]);var sie=J('<div class="column"><!></div>'),aie=J('<div class="column"><!></div>'),oie=J('<div class="column"><!></div>'),lie=J("<div><!> <!> <!></div>");function Ya(r,e){gt(e,!0);let t=ge(e,"environment",11,"*"),n=ge(e,"isReadOnly",11,!1);ge(e,"onchanged",3,()=>{});let i=Se(Y({}));Cf.subscribe(u=>{H(i,Y(u||{}))}),Ut(()=>{});var s=lie(),a=Q(s);{var o=u=>{var d=Ee(),p=be(d);{var m=g=>{var O=sie(),w=Q(O);mm(w,{get appVars(){return C(i).dev},get isReadOnly(){return n()},title:"DEVELOPMENT"}),R(O),U(g,O)};ce(p,g=>{C(i)&&C(i).dev&&g(m)})}U(u,d)};ce(a,u=>{(t()=="dev"||t()=="*")&&u(o)})}var l=ne(a,2);{var f=u=>{var d=Ee(),p=be(d);{var m=g=>{var O=aie(),w=Q(O);mm(w,{get appVars(){return C(i).qa},get isReadOnly(){return n()},title:"QUALITY"}),R(O),U(g,O)};ce(p,g=>{C(i)&&C(i).qa&&g(m)})}U(u,d)};ce(l,u=>{(t()=="qa"||t()=="*")&&u(f)})}var c=ne(l,2);{var h=u=>{var d=Ee(),p=be(d);{var m=g=>{var O=oie(),w=Q(O);mm(w,{get appVars(){return C(i).prd},get isReadOnly(){return n()},title:"PRODUCTION"}),R(O),U(g,O)};ce(p,g=>{C(i)&&C(i).prd&&g(m)})}U(u,d)};ce(c,u=>{(t()=="prd"||t()=="*")&&u(h)})}R(s),U(r,s),Ot()}var fie=(r,e)=>{e()},cie=J('<div class="field"><label class="label">Url to make the request. The operation is similar to a proxy</label> <div class="control has-icons-right"><input class="input is-small" type="text" placeholder="http://your.url/path"> <span class="icon is-small is-right"><i class="fa-solid fa-globe"></i></span></div></div>'),hie=J("<div><!></div>");function uie(r,e){gt(e,!0);const t=c=>{var h=cie(),u=ne(Q(h),2),d=Q(u);wt(d),d.__change=[fie,f],Kt(2),R(u),R(h),Jt(d,()=>s().code,p=>s(s().code=p,!0)),U(c,h)},n=c=>{Ya(c,{get environment(){return s().environment},isReadOnly:!0})},i=c=>{var h=hie(),u=Q(h);Ha(u,{get method(){return s().method},get url(){return s().endpoint},methodDisabled:!0,onchange:d=>{f()},get data(){return s().data_test},set data(d){s(s().data_test=d,!0)}}),R(h),U(c,h)};let s=ge(e,"row",31,()=>Y({})),a=ge(e,"onchange",3,()=>{}),o=Se(Y([{label:"Url",isActive:!0,component:t},{label:"App Variables",component:n},{label:"Tester",component:i}]));function l(){return{code:gr(s().code),data_test:gr(s().data_test)}}function f(){a()(l())}Ut(()=>{}),Jn(r,{get tabs(){return C(o)},set tabs(c){H(o,Y(c))}}),Ot()}vr(["change"]);const die=r=>{var e=pie();U(r,e)};var pie=J(`<div class="content is-small"><h3>Predefined variables</h3> <ul><li><strong>$_RETURN_DATA_:</strong> Variable that returns the return of the function</li> <li><strong>$_UFETCH_:</strong> Instance of the uFetch class. More information at <a href="https://github.com/edwinspire/universal-fetch">universal-fetch</a></li> <li><strong>$_REQUEST_:</strong> Represents the HTTP request received by the server. Contains information
				about the request made by the client, such as URL parameters, headers, body data, and more.</li> <li><strong>$_GET_INTERNAL_URL_:</strong> Function that allows obtaining the full path of an
				OFAPI endpoint. <br> Example: <code>let relative_path = '/api/test/ap001'; <br>let fullURL = $_GET_INTERNAL_URL_(relative_path); <br>// $_GET_INTERNAL_URL_ return 'http://localhost:3000/api/test/ap001'</code></li> <li><strong>$_FETCH_OFAPI_:</strong> Build a <a href="https://github.com/edwinspire/universal-fetch/">uFetch</a> intance. <br> The url can be absolute or relative. When it is relative, it internally repoints to the port
				used by OFAPI. <br>Example: <code>let url = 'http://example.net/api/test'; <br> let fetch_instance = $_FETCH_OFAPI_(url);</code></li> <li><strong>$_SECUENTIAL_PROMISES_:</strong> PromiseSequence class. More information at <a href="https://github.com/edwinspire/sequential-promises">sequential-promises</a>.</li></ul></div>`),mie=J("<div><!></div>");function gie(r,e){gt(e,!0);const t=u=>{is(u,{lang:"js",onchange:d=>{c()},get code(){return C(o)},set code(d){H(o,Y(d))}})},n=u=>{Ya(u,{get environment(){return s().environment},isReadOnly:!0})},i=u=>{var d=mie(),p=Q(d);Ha(p,{get method(){return s().method},get url(){return s().endpoint},methodDisabled:!0,onchange:m=>{c()},get data(){return s().data_test},set data(m){s(s().data_test=m,!0)}}),R(d),U(u,d)};let s=ge(e,"row",31,()=>Y({})),a=ge(e,"onchange",3,()=>{}),o=Se("");function l(){s()||s({code:{}}),s()&&!s().code&&s(s().code={},!0)}function f(){return{code:gr(C(o)),data_test:gr(s().data_test)}}function c(){a()(f())}let h=Se(Y([{label:"Code",isActive:!0,component:t},{label:"Predefined Variables",component:die},{label:"App Variables",component:n},{label:"Tester",component:i}]));Ut(()=>{l()}),Jn(r,{get tabs(){return C(h)},set tabs(u){H(h,Y(u))}}),Ot()}var Oie=J(`<div class="block"><div class="icon-text"><span class="icon has-text-warning"><i class="fas fa-exclamationcode-triangle"></i></span> <span>Warning</span></div> <p class="block">The GET method is recommended only for simple requests where there are no input
					parameters, or failing which the parameters are key-value.</p></div>`),xie=J("<div><div><div>Service connection parameters.</div></div> <!> <!></div>"),vie=J(`<div>Enter the parameters in json format like the following example: <!> <div style="margin-top: 1em;">The variables with the following: <ul class="list_params svelte-enisc9"><li><strong>wsdl:</strong> url where the wsdl is located. (Required)</li> <li><strong>functionName:</strong> Function or method to call. Required when the method used
					is <strong>GET</strong>, in the <strong>POST</strong> method it can be passed as a parameter.</li> <li><strong>BasicAuthSecurity:</strong> Only if required. BearerSecurity is also supported.</li> <li><strong>RequestArgs:</strong> When you use the <strong>GET</strong> method, this parameter
					is replaced by the data sent in the Query. When using <strong>POST</strong> the parameter can
					be sent directly in the Body.</li> <li><strong>options:</strong> additional options passed to soap client. By example: <!></li></ul> <br> <div class="block"><div class="icon-text"><span class="icon has-text-warning"><i class="fas fa-exclamation-triangle"></i></span> <span>Warning: The parameters configured here will override those that the user sends through
						the service.</span></div></div> <br> <div class="block"><div class="icon-text"><span class="icon has-text-success"><i class="fas fa-info-circle"></i></span> <span>If you want to <strong>get description</strong> of the SOAP service, you can send the
						following JSON request: <code></code></span></div></div></div></div>`),yie=J("<div><!></div>");function wie(r,e){gt(e,!0);const t=O=>{var w=xie(),v=ne(Q(w),2);is(v,{lang:"json",get code(){return C(l)},set code(b){H(l,Y(b))}});var S=ne(v,2);{var y=b=>{var x=Oie();U(b,x)};ce(S,b=>{a().method==="GET"&&b(y)})}R(w),U(O,w)},n=O=>{var w=vie(),v=ne(Q(w));Cs(v,{get jsonObject(){return C(d)},set jsonObject(_){H(d,Y(_))}});var S=ne(v,2),y=ne(Q(S)),b=ne(Q(y),8),x=ne(Q(b),2);Cs(x,{get jsonObject(){return C(c)},set jsonObject(_){H(c,Y(_))}}),R(b),R(y);var A=ne(y,8),k=Q(A),E=ne(Q(k),2),T=ne(Q(E),3);T.textContent=f,R(E),R(k),R(A),R(S),R(w),U(O,w)},i=O=>{Ya(O,{get environment(){return a().environment},isReadOnly:!0})},s=O=>{var w=yie(),v=Q(w);Ha(v,{get method(){return a().method},get url(){return a().endpoint},methodDisabled:!0,onchange:S=>{m()},get data(){return a().data_test},set data(S){a(a().data_test=S,!0)}}),R(w),U(O,w)};let a=ge(e,"row",31,()=>Y({})),o=ge(e,"onchange",3,()=>{}),l=Se(""),f=JSON.stringify({"describe()":!0}),c=Se(Y({wsdl_options:{strictSSL:!0,rejectUnauthorized:!1}})),h,u=Se(Y([{label:"Parameters",isActive:!0,component:t},{label:"Information",isActive:!1,component:n},{label:"App Variables",component:i},{label:"Tester",component:s}])),d=Se(Y({wsdl:"https://www.dataaccess.com/webservicesserver/numberconversion.wso?WSDL",functionName:"NumberToDollars",BasicAuthSecurity:{User:"any",Password:"any"},RequestArgs:{dNum:236.08}}));function p(){return C(l)}function m(){o()(g())}function g(){return{code:p(),data_test:gr(a().data_test)}}Ut(()=>{}),Ua(()=>{clearTimeout(h)}),Jn(r,{get tabs(){return C(u)},set tabs(O){H(u,Y(O))}}),Ot()}var bie=J(`<div><div><div class="content is-small">The parameters must have a name like <span style="font-style: oblique; font-weight: bold;">$nameparameter</span> to bind, or <span style="font-style: oblique; font-weight: bold;">:nameparameter</span> to
				replacements. The values you send in the request. For more information you can consult the <a href="https://sequelize.org/docs/v6/core-concepts/raw-queries/#bind-parameter">sequelize</a> documentation.</div></div></div> <!>`,1),_ie=J(`<div class="block"><div class="icon-text"><span class="icon has-text-warning"><i class="fas fa-exclamation-triangle"></i></span> <span>GET Method - Warning</span></div> <p class="block">The GET method is recommended only for simple requests where there is no input parameters,
					or failing that the parameters are key-value on query request, which will be used to join
					with the variables of the SQL query.</p> <div class="block">If you send a parameter that is not present in the query you will get an error similar to: <code>Column index out of range</code></div></div>`),kie=J(`<div class="block"><div class="icon-text"><span class="icon has-text-info"><i class="fa-solid fa-circle-exclamation"></i></span> <span>When you use the POST method, the input parameters must be sent in the BODY in JSON
						format, using the following example:</span></div> <br> <!> <br> <div class="icon-text"><span class="icon has-text-info"><i class="fa-solid fa-circle-exclamation"></i></span> <span>You can also use "replacements" used by sequelize., for example:</span></div> <br> <!></div> <div class="icon-text"><span class="icon has-text-warning"><i class="fa-solid fa-circle-exclamation"></i></span> <span>Only "bind" or "replacements" can be used at the same time.</span></div>`,1),Sie=J('<div class="content is-small"><p>In sequelize you can pass parameters using <strong>"bind"</strong> or <strong>"replacements"</strong> depending on the case. You can refer to <a href="https://sequelize.org/docs/v6/core-concepts/raw-queries/#bind-parameter">Sequelize Parameters</a> for more details.</p> <!></div>'),Tie=(r,e)=>{H(e,!1)},Cie=(r,e)=>{H(e,!0)},Aie=J('<div class="control has-icons-left"><input class="input is-small" type="text" placeholder="$_VAR_NAME"> <span class="icon is-small is-left"><i class="fa-regular fa-keyboard"></i></span></div>'),Eie=J('<div><div class="content is-small">Configuration parameters used by sequelize, visit <a href="https://sequelize.org/">https://sequelize.org/</a> for more information. <br> You can also use the name of an application variable to use it, for example <strong>$_VAR_NAME</strong>.</div></div> <div class="box"><div class="buttons has-addons"><button>JSON Parameters</button> <button>Use Variable</button></div> <!></div>',1),Pie=J("<div><!></div>");function Rie(r,e){gt(e,!0);const t=y=>{var b=bie(),x=ne(be(b),2);is(x,{isReadOnly:!1,title:"Query to be executed",lang:"sql",get code(){return C(m)},set code(A){H(m,Y(A))}}),U(y,b)},n=y=>{var b=Sie(),x=ne(Q(b),2);{var A=E=>{var T=_ie();U(E,T)},k=E=>{var T=Ee(),_=be(T);{var N=Z=>{var z=kie(),ee=be(z),ae=ne(Q(ee),4);Cs(ae,{get jsonObject(){return C(u)},set jsonObject(V){H(u,Y(V))}});var xe=ne(ae,8);Cs(xe,{get jsonObject(){return C(d)},set jsonObject(V){H(d,Y(V))}}),R(ee),Kt(2),U(Z,z)};ce(_,Z=>{o().method==="POST"&&Z(N)},!0)}U(E,T)};ce(x,E=>{o().method==="GET"?E(A):E(k,!1)})}R(b),U(y,b)},i=y=>{var b=Eie(),x=ne(be(b),2),A=Q(x),k=Q(A);k.__click=[Tie,f];var E=ne(k,2);E.__click=[Cie,f],R(A);var T=ne(A,2);{var _=Z=>{is(Z,{isReadOnly:!1,lang:"json",get code(){return C(c)},set code(z){H(c,Y(z))}})},N=Z=>{var z=Aie(),ee=Q(z);wt(ee),Kt(2),R(z),Jt(ee,()=>C(h),ae=>H(h,ae)),U(Z,z)};ce(T,Z=>{C(f)?Z(N,!1):Z(_)})}R(x),Me(()=>{ht(k,`button is-small ${(C(f)?"":"is-active is-primary")??""}`),ht(E,`button is-small ${(C(f)?"is-active is-primary":"")??""}`)}),U(y,b)},s=y=>{Ya(y,{get environment(){return o().environment},isReadOnly:!0})},a=y=>{var b=Pie(),x=Q(b);Ha(x,{get method(){return o().method},get url(){return o().endpoint},methodDisabled:!0,onchange:A=>{w()},get data(){return o().data_test},set data(A){o(o().data_test=A,!0)}}),R(b),U(y,b)};let o=ge(e,"row",31,()=>Y({endpoint:"",method:"",environment:""})),l=ge(e,"onchange",3,()=>{}),f=Se(!1),c=Se(Y({})),h=Se(""),u=Se(Y({bind:{your_param_01:"0002081614",your_param_02:123,your_param_03:"ABC"}})),d=Se(Y({replacements:{your_param_01:["0002081614","986535OKE"]}})),p=Se(Y([{label:"Query",isActive:!0,classIcon:" fa-solid fa-database ",component:t},{label:"Pass Parameters",component:n},{label:"Connection Parameters",component:i},{label:"App Variables",component:s},{label:"Tester",component:a}])),m=Se("SELECT 1+1;"),g;function O(){try{let y=JSON.parse(o().code||"{}");y&&y.query&&H(m,Y(y.query)),y&&y.config&&(typeof y.config=="object"?(H(c,Y(y.config)),H(f,!1)):(H(h,Y(y.config)),H(f,!0)))}catch(y){H(c,Y({})),H(h,""),H(m,"SELECT 1;"),console.error("Error",y)}}function w(){l()(v())}function v(){return{code:S(),data_test:gr(o().data_test)}}function S(){let y={},b={};try{C(f)?y=C(h):y=typeof C(c)=="object"?C(c):JSON.parse(C(c))}catch(x){console.warn("No se pudo parsear getCode SQL",x,C(h),C(c)),y=""}try{return b.config=y,b.query=C(m),JSON.stringify(b,null,2)}catch(x){return console.warn(x),code}}Ut(()=>{O()}),Ua(()=>{clearTimeout(g)}),Jn(r,{get tabs(){return C(p)},set tabs(y){H(p,Y(y))}}),Ot()}vr(["click"]);var Qie=J(`<div><br> <div class="control"><input class="input is-small" type="text" placeholder="Table name"></div> <br></div> <div class="content is-small"><h4>Bulk INSERT</h4> <div>Performs a bulk insert into a SQL database table.</div> <div>The necessary parameters are the "table name" and an array with the data.<br> The data you send must contain a JSON where the key must contain the exact name of the database
			field. <br> <details><summary>For example, the following JSON represents a list of rows to be inserted:</summary> <!></details></div> <div><span class="icon-text"><span class="icon has-text-warning"><i class="fas fa-exclamation-triangle fa-fade"></i></span> <span class="label is-small">Depending on the database engine you may have a <strong>lock</strong> on the table during
					the bulk insert process.</span></span></div></div>`,1),Fie=(r,e)=>{H(e,!1)},$ie=(r,e)=>{H(e,!0)},Die=J('<div class="control has-icons-left"><input class="input is-small" type="text" placeholder="$_VAR_NAME"> <span class="icon is-small is-left"><i class="fa-regular fa-keyboard"></i></span></div>'),Nie=J('<div><div class="content is-small">Configuration parameters used by sequelize, visit <a href="https://sequelize.org/">https://sequelize.org/</a> for more information. <br> You can also use the name of an application variable to use it, for example <strong>$_VAR_NAME</strong>.</div></div> <div class="box"><div class="buttons has-addons"><button>JSON Parameters</button> <button>Use Variable</button></div> <!></div>',1),Mie=J("<div><!></div>");function Iie(r,e){gt(e,!0);const t=w=>{var v=Qie(),S=be(v),y=ne(Q(S),2),b=Q(y);wt(b),R(y),Kt(2),R(S);var x=ne(S,2),A=ne(Q(x),4),k=ne(Q(A),5),E=ne(Q(k),2);Cs(E,{get jsonObject(){return C(u)},set jsonObject(T){H(u,Y(T))}}),R(k),R(A),Kt(2),R(x),Jt(b,()=>C(d),T=>H(d,T)),U(w,v)},n=w=>{var v=Nie(),S=ne(be(v),2),y=Q(S),b=Q(y);b.__click=[Fie,l];var x=ne(b,2);x.__click=[$ie,l],R(y);var A=ne(y,2);{var k=T=>{is(T,{isReadOnly:!1,lang:"json",get code(){return C(f)},set code(_){H(f,Y(_))}})},E=T=>{var _=Die(),N=Q(_);wt(N),Kt(2),R(_),Jt(N,()=>C(c),Z=>H(c,Z)),U(T,_)};ce(A,T=>{C(l)?T(E,!1):T(k)})}R(S),Me(()=>{ht(b,`button is-small ${(C(l)?"":"is-active is-primary")??""}`),ht(x,`button is-small ${(C(l)?"is-active is-primary":"")??""}`)}),U(w,v)},i=w=>{Ya(w,{get environment(){return a().environment},isReadOnly:!0})},s=w=>{var v=Mie(),S=Q(v);Ha(S,{get method(){return a().method},get url(){return a().endpoint},methodDisabled:!0,onchange:y=>{g()},get data(){return a().data_test},set data(y){a(a().data_test=y,!0)}}),R(v),U(w,v)};let a=ge(e,"row",31,()=>Y({endpoint:"",method:"",environment:""})),o=ge(e,"onchange",3,()=>{}),l=Se(!1),f=Se(Y({})),c=Se(""),h=Se(Y([{label:"Table Name",isActive:!0,classIcon:" fa-solid fa-database ",component:t},{label:"Connection Parameters",component:n},{label:"App Variables",component:i},{label:"Tester",component:s}])),u=Se(Y({data:[{field01:1,field02:"demo",field03:new Date},{field01:2,field02:"test",field03:new Date},{field01:5,field02:"app",field03:new Date},{field01:12,field02:"red",field03:new Date},{field01:20,field02:"dog",field03:new Date},{field01:3,field02:"edwinspire",field03:new Date}]})),d=Se("");function p(){try{let w=JSON.parse(a().code||"{}");w&&w.table_name&&H(d,Y(w.table_name)),w&&w.config&&(typeof w.config=="object"?(H(f,Y(w.config)),H(l,!1)):(H(c,Y(w.config)),H(l,!0)))}catch(w){H(f,Y({})),H(c,""),H(d,""),console.error("Error",w)}}function m(){return{code:gr(O()),data_test:gr(a().data_test)}}function g(){o()(m())}function O(){let w={},v={};try{C(l)?w=C(c):w=JSON.parse(C(f))}catch(S){console.warn("No se pudo parsear getCode SQL",S,C(c),C(f)),w=""}try{return v.config=w,v.table_name=C(d),JSON.stringify(v,null,2)}catch(S){return console.warn(S),code}}Ut(()=>{p()}),Jn(r,{get tabs(){return C(h)},set tabs(w){H(h,Y(w))}}),Ot()}vr(["click"]);var Lie=J(`<div><div><div><div class="content is-small"><span style="font-style: oblique; font-weight: bold;">$nameparameter</span> to bind, or <span style="font-style: oblique; font-weight: bold;">:nameparameter</span> to
					use array bind. The values you send in the request. For more information go to the "Pass
					parameters" tab.</div></div></div> <!></div>`),Bie=J(`<div class="block"><div class="icon-text"><span class="icon has-text-warning"><i class="fas fa-exclamation-triangle"></i></span> <span>GET Method - Warning</span></div> <div class="block">The GET method is recommended only for simple requests where there is no input
						parameters, or failing that the parameters are key-value on query request, which will be
						used to bind with the variables of the SQL query.</div></div>`),Zie=J(`<div class="block"><div class="icon-text"><span class="icon has-text-info"><i class="fa-solid fa-circle-exclamation"></i></span> <span>When you use the POST method, the input parameters must be sent in the BODY in JSON
							format, using the following example:</span></div> <br> <!></div>`),Wie=J(`<div><div class="content is-small"><p>This "handler" uses <a href="https://help.sap.com/docs/HANA_SERVICE_CF/1efad1691c1f496b8b580064a6536c2d/a5c332936d9f47d8b820a4ecc427352c.html">@sap/hana-client internally</a>. However, the way the parameters are passed is a little different in order to facilitate
				its use.</p> <div class="block"><h4>Parameter name</h4> <div class="block">If in the query you use the parameter with the prefix <strong>"$"</strong> (<code>$param_name</code>), it is expected that this variable corresponds to a value that will be injected into
					the query. <br> <div class="block">For example the following query: <br> <code></code> <br> Internally the query becomes:: <br> <code></code></div></div> <div class="block">If in the query you use the parameter with the prefix <strong>":"</strong> (<code>:param_name</code>), this variable is expected to contain an array of values that will be injected into
					the query. <br> <div class="block">For example the following query: <br> <code></code> <br> The parameters you must send should look like the following example: <br> <!> <br> Internally the query becomes: <br> <code></code></div></div> <div class="icon-text"><span class="icon has-text-warning"><i class="fa-solid fa-circle-exclamation"></i></span> <span>Note that parameter names when sent in the request should not include the prefix.</span></div> <div class="icon-text"><span class="icon has-text-warning"><i class="fas fa-exclamation-triangle"></i></span> <span>If you send a parameter that is not present in the query you will get an error similar
						to: <code>There are missing parameters.</code></span></div></div> <!></div></div>`),Uie=(r,e)=>{H(e,!1)},Xie=(r,e)=>{H(e,!0)},Vie=J('<div class="content is-small"><details><summary>By example, in most cases the following connection parameters are sufficient:</summary> <!></details></div> <!>',1),qie=J('<div class="content is-small">You can also use the name of an application variable to use it, for example <strong>$_VAR_NAME</strong>.</div> <div class="control has-icons-left"><input class="input is-small" type="text" placeholder="$_VAR_NAME"> <span class="icon is-small is-left"><i class="fa-regular fa-keyboard"></i></span></div>',1),jie=J('<div><div><div class="content is-small">Configuration parameters used by @sap/hana-client, visit <a href="https://help.sap.com/docs/HANA_SERVICE_CF/1efad1691c1f496b8b580064a6536c2d/4fe9978ebac44f35b9369ef5a4a26f4c.html">@sap/hana-client</a> for more information.</div></div> <div class="box"><div class="buttons has-addons"><button>JSON Parameters</button> <button>Use Variable</button></div> <!></div></div>'),zie=J("<div><!></div>");function Gie(r,e){gt(e,!0);const t=k=>{var E=Lie(),T=ne(Q(E),2);is(T,{isReadOnly:!1,lang:"sql",get code(){return C(v)},set code(_){H(v,Y(_))}}),R(E),U(k,E)},n=k=>{var E=Wie(),T=Q(E),_=ne(Q(T),2),N=ne(Q(_),2),Z=ne(Q(N),7),z=ne(Q(Z),3);z.textContent=d;var ee=ne(z,6);ee.textContent=p,R(Z),R(N);var ae=ne(N,2),xe=ne(Q(ae),7),V=ne(Q(xe),3);V.textContent=m;var ue=ne(V,6);Cs(ue,{get jsonObject(){return C(O)},set jsonObject(W){H(O,Y(W))}});var ie=ne(ue,6);ie.textContent=g,R(xe),R(ae),Kt(4),R(_);var P=ne(_,2);{var I=W=>{var K=Bie();U(W,K)},B=W=>{var K=Ee(),re=be(K);{var pe=fe=>{var de=Zie(),Ue=ne(Q(de),4);Cs(Ue,{get jsonObject(){return C(O)},set jsonObject(q){H(O,Y(q))}}),R(de),U(fe,de)};ce(re,fe=>{o().method==="POST"&&fe(pe)},!0)}U(W,K)};ce(P,W=>{o().method==="GET"?W(I):W(B,!1)})}R(T),R(E),U(k,E)},i=k=>{var E=jie(),T=ne(Q(E),2),_=Q(T),N=Q(_);N.__click=[Uie,f];var Z=ne(N,2);Z.__click=[Xie,f],R(_);var z=ne(_,2);{var ee=xe=>{var V=Vie(),ue=be(V),ie=Q(ue),P=ne(Q(ie),2);Cs(P,{get jsonObject(){return C(u)},set jsonObject(B){H(u,Y(B))}}),R(ie),R(ue);var I=ne(ue,2);is(I,{isReadOnly:!1,lang:"json",get code(){return C(c)},set code(B){H(c,Y(B))}}),U(xe,V)},ae=xe=>{var V=qie(),ue=ne(be(V),2),ie=Q(ue);wt(ie),Kt(2),R(ue),Jt(ie,()=>C(h),P=>H(h,P)),U(xe,V)};ce(z,xe=>{C(f)?xe(ae,!1):xe(ee)})}R(T),R(E),Me(()=>{ht(N,`button is-small ${(C(f)?"":"is-active is-primary")??""}`),ht(Z,`button is-small ${(C(f)?"is-active is-primary":"")??""}`)}),U(k,E)},s=k=>{Ya(k,{get environment(){return o().environment},isReadOnly:!0})},a=k=>{var E=zie(),T=Q(E);Ha(T,{get method(){return o().method},get url(){return o().endpoint},methodDisabled:!0,onchange:_=>{b()},get data(){return o().data_test},set data(_){o(o().data_test=_,!0)}}),R(E),U(k,E)};let o=ge(e,"row",31,()=>Y({})),l=ge(e,"onchange",3,()=>{}),f=Se(!1),c=Se(Y({})),h=Se(""),u=Se(Y({host:"<host-name>",port:"<port>",user:"SYSTEM",password:"manager",pooling:!0})),d="SELECT * FROM YOUR_TABLE WHERE FIELD_01 = $value_01;",p="SELECT * FROM YOUR_TABLE WHERE FIELD_01 = ?;",m="SELECT * FROM YOUR_TABLE WHERE FIELD_01 = $value_01 AND FIELD_02 IN (:list_your_values);",g="SELECT * FROM YOUR_TABLE WHERE FIELD_01 = ? AND FIELD_02 IN (?, ?);",O=Se(Y({params:{value_01:1234,list_your_values:["0002000157","0002000158"]}})),w=Se(Y([{label:"Query",isActive:!0,classIcon:" fa-solid fa-database ",component:t},{label:"Pass Parameters",component:n},{label:"Connection Parameters",component:i},{label:"App Variables",component:s},{label:"Tester",component:a}])),v=Se(""),S;function y(){try{let k=JSON.parse(o().code||"{}");k&&k.query&&H(v,Y(k.query)),k&&k.config&&(typeof k.config=="object"?(H(c,Y(k.config)),H(f,!1)):(H(h,Y(k.config)),H(f,!0)))}catch(k){H(c,Y({})),H(h,""),H(v,"SELECT 1;"),console.error("Error",k)}}function b(){l()(x())}function x(){return{code:A(),data_test:gr(o().data_test)}}function A(){let k={},E={};try{C(f)?k=C(h):k=typeof C(c)=="object"?C(c):JSON.parse(C(c))}catch(T){console.warn("No se pudo parsear getCode SQL",T,C(h),C(c)),k=""}try{return E.config=k,E.query=C(v),JSON.stringify(E,null,2)}catch(T){return console.warn(T),code}}Ut(()=>{y()}),Ua(()=>{clearTimeout(S)}),Jn(r,{get tabs(){return C(w)},set tabs(k){H(w,Y(k))}}),Ot()}vr(["click"]);var Hie=J('<div><div><div><div class="field is-horizontal"><div class="field-label is-small"><label class="label">MIME Type</label></div> <div class="field-body"><div class="field is-narrow"><div class="control"><div class="is-fullwidth"><!></div></div></div></div></div> <div class="content is-small">Plain Text that will be returned by the Endpoint.</div></div></div> <!></div>'),Yie=J("<div><!></div>");function Kie(r,e){gt(e,!0);const t=g=>{var O=Hie(),w=Q(O),v=Q(w),S=Q(v),y=ne(Q(S),2),b=Q(y),x=Q(b),A=Q(x),k=Q(A);Z0(k,{onchange:T=>{let _=C(o).find(N=>N.id==C(f));_?H(h,Y(_.editor)):H(h,"text")},get options(){return C(o)},set options(T){H(o,Y(T))},get option(){return C(f)},set option(T){H(f,Y(T))}}),R(A),R(x),R(b),R(y),R(S),Kt(2),R(v),R(w);var E=ne(w,2);is(E,{get lang(){return C(h)},set lang(T){H(h,Y(T))},get code(){return C(c)},set code(T){H(c,Y(T))}}),R(O),U(g,O)},n=g=>{Ya(g,{get environment(){return s().environment},isReadOnly:!0})},i=g=>{var O=Yie(),w=Q(O);Ha(w,{get method(){return s().method},get url(){return s().endpoint},methodDisabled:!0,onchange:v=>{m()},get data(){return s().data_test},set data(v){s(s().data_test=v,!0)}}),R(O),U(g,O)};let s=ge(e,"row",31,()=>Y({})),a=ge(e,"onchange",3,()=>{}),o=Se(Y([{id:"text/plain",value:"text/plain",enabled:!0,editor:"text"},{id:"text/html",value:"text/html",enabled:!0,editor:"html"},{id:"text/css",value:"text/css",enabled:!0,editor:"text"},{id:"text/javascript",value:"text/javascript",enabled:!0,editor:"js"},{id:"text/xml",value:"text/xml",enabled:!0,editor:"xml"},{id:"application/wsdl+xml",value:"application/wsdl+xml",enabled:!0,editor:"xml"},{id:"text/csv",value:"text/csv",enabled:!0,editor:"text"},{id:"text/markdown",value:"text/markdown",enabled:!0,editor:"text"},{id:"text/cache-manifest",value:"text/cache-manifest",enabled:!0,editor:"text"},{id:"text/calendar",value:"text/calendar",enabled:!0,editor:"text"},{id:"text/vnd.sun.j2me.app-descriptor",value:"text/vnd.sun.j2me.app-descriptor",enabled:!0,editor:"text"},{id:"text/vnd.wap.wml",value:"text/vnd.wap.wml",enabled:!0,editor:"text"},{id:"text/vnd.wap.wmlscript",value:"text/vnd.wap.wmlscript",enabled:!0,editor:"text"},{id:"text/x-asm",value:"text/x-asm",enabled:!0,editor:"text"},{id:"text/x-c",value:"text/x-c",enabled:!0,editor:"text"},{id:"text/x-fortran",value:"text/x-fortran",enabled:!0,editor:"text"},{id:"text/x-java-source",value:"text/x-java-source",enabled:!0,editor:"text"},{id:"text/x-markdown",value:"text/x-markdown",enabled:!0,editor:"text"},{id:"text/x-nfo",value:"text/x-nfo",enabled:!0,editor:"text"},{id:"text/x-opml",value:"text/x-opml",enabled:!0,editor:"text"},{id:"text/x-pascal",value:"text/x-pascal",enabled:!0,editor:"text"},{id:"text/x-script",value:"text/x-script",enabled:!0,editor:"text"},{id:"text/x-script.perl",value:"text/x-script.perl",enabled:!0,editor:"text"},{id:"text/x-script.python",value:"text/x-script.python",enabled:!0,editor:"text"},{id:"text/x-server-parsed-html",value:"text/x-server-parsed-html",enabled:!0,editor:"html"},{id:"text/x-setext",value:"text/x-setext",enabled:!0,editor:"text"},{id:"text/x-sfv",value:"text/x-sfv",enabled:!0,editor:"text"},{id:"text/x-uuencode",value:"text/x-uuencode",enabled:!0,editor:"text"},{id:"text/x-vcalendar",value:"text/x-vcalendar",enabled:!0,editor:"text"},{id:"text/x-vcard",value:"text/x-vcard",enabled:!0,editor:"text"},{id:"text/troff",value:"text/troff",enabled:!0,editor:"text"},{id:"text/x-component",value:"text/x-component",enabled:!0,editor:"text"}])),l=Se(Y([{label:"Payload",isActive:!0,component:t},{label:"App Variables",component:n},{label:"Tester",component:i}])),f=Se("text/plain"),c=Se(""),h=Se("txt");function u(){try{let g=JSON.parse(s().code||"{}");g&&g.payload&&H(c,Y(g.payload)),g&&g.mimeType&&H(f,Y(g.mimeType))}catch(g){H(f,"text/plain"),H(c,""),console.error("Error",g)}}function d(){let g={};try{return g.mimeType=C(f),g.payload=C(c),JSON.stringify(g,null,2)}catch{return s().code}}function p(){return{code:gr(d()),data_test:gr(s().data_test)}}function m(){a()(p())}Ut(()=>{u()}),Jn(r,{get tabs(){return C(l)},set tabs(g){H(l,Y(g))}}),Ot()}var Jie=J('<div class="content is-small">Use the selected function to return a response.</div> <div class="field is-horizontal"><div class="field-label is-normal"><label class="label is-small">Function</label></div> <div class="field-body"><div class="field is-narrow"><!></div></div></div>',1),ese=J("<div><!></div>");function tse(r,e){gt(e,!0);const t=d=>{var p=Jie(),m=ne(be(p),2),g=ne(Q(m),2),O=Q(g),w=Q(O);Z0(w,{onchange:v=>{u()},get options(){return C(a)},set options(v){H(a,Y(v))},get option(){return i().code},set option(v){i(i().code=v,!0)}}),R(O),R(g),R(m),U(d,p)},n=d=>{var p=ese(),m=Q(p);Ha(m,{get method(){return i().method},get url(){return i().endpoint},methodDisabled:!0,onchange:g=>{u()},get data(){return i().data_test},set data(g){i(i().data_test=g,!0)}}),R(p),U(d,p)};let i=ge(e,"row",31,()=>Y({})),s=ge(e,"onchange",3,()=>{}),a=Se(Y([])),o=[],l=[],f=[],c=Se(Y([{label:"Function",isActive:!0,component:t},{label:"Tester",component:n}]));function h(){return{code:gr(i().code),data_test:gr(i().data_test)}}function u(){s()(h())}vm.subscribe(d=>{o=d}),ym.subscribe(d=>{l=d}),wm.subscribe(d=>{f=d}),Ut(()=>{switch(i().environment){case"dev":H(a,Y(o));break;case"qa":H(a,Y(l));break;case"prd":H(a,Y(f));break}}),Jn(r,{get tabs(){return C(c)},set tabs(d){H(c,Y(d))}}),Ot()}var rse=J('<div class="icon-text is-small"><span class="icon has-text-success"><i class="fas fa-check-square"></i></span> <span>Url Success</span></div>'),nse=J('<div class="icon-text is-small"><span class="icon has-text-danger"><i class="fas fa-ban"></i></span> <span>Url Invalid</span></div>'),ise=J('<div class="icon-text is-small"><span class="icon has-text-success"><i class="fas fa-check-square"></i></span> <span>Available URL</span></div>'),sse=J('<div class="icon-text is-small"><span class="icon has-text-danger"><i class="fas fa-ban"></i></span> <span>Url not available</span></div>'),ase=J('<div><input class="input" type="hidden" placeholder="Name"> <div class="field is-horizontal"><div class="field-label is-small"><label class="label">Enabled</label></div> <div class="field-body"><div class="field"><div class="control"><label class="checkbox"><input type="checkbox"></label></div></div></div></div> <div class="field is-horizontal"><div class="field-label is-small"><label class="label">Method</label></div> <div class="field-body"><div class="field"><div class="control"><!></div></div></div></div> <div class="field is-horizontal"><div class="field-label is-small"><label class="label">Access</label></div> <div class="field-body"><div class="field"><div class="control"><!></div></div></div></div> <div class="field is-horizontal"><div class="field-label is-small"><label class="label">Handler</label></div> <div class="field-body"><div class="field"><div class="control"><!></div></div></div></div> <div class="field"><div class="field is-horizontal"><div class="field-label is-small"><strong>API Resource:</strong></div> <div class="field-body"><div class="field is-expanded"><div class="field has-addons"><p class="control"><a class="button is-small is-static"> </a></p> <p class="control is-expanded"><input class="input is-small" type="text" placeholder="Resourse"></p> <p class="control"><a class="button is-small is-static">/</a></p> <p class="control"><!></p></div> <div class="help"><!> <!></div></div></div></div></div> <div class="field"><label class="label is-small">Description</label> <div class="control"><textarea class="textarea is-small" placeholder="Textarea"></textarea></div></div></div>');function ose(r,e){gt(e,!0);let t=ge(e,"environment_list",31,()=>Y([])),n=ge(e,"row",31,()=>Y({method:"X",access:0})),i=ge(e,"app",27,()=>Y({})),s=ge(e,"validateResource",15,!1),a=ge(e,"availableURL",15,!1),o=Se(Y([])),l=Se(Y([])),f=new as;xm.subscribe(Te=>{H(o,Y(Te))}),sd.subscribe(Te=>{f.setBearerAuthorization(Te.token)}),Om.subscribe(Te=>{H(l,Y(Te))}),j1(()=>{s(k3(n().resource)),a(c()),n(n().endpoint=S3(n().method,i().app,n().resource,n().environment),!0)});function c(){return!i().endpoints.some(Re=>n().resource==Re.resource&&n().environment==Re.environment&&n().method==Re.method&&n().idendpoint!=Re.idendpoint)}async function h(){try{let Re=await(await f.GET({url:wn.listEnv})).json();Re&&Array.isArray(Re)&&Re.length>0?t(Re.map(Nt=>({id:Nt.id,value:Nt.text}))):t([])}catch(Te){alert(Te.message)}}Ut(async()=>{await h()});var u=ase(),d=Q(u);wt(d);var p=ne(d,2),m=ne(Q(p),2),g=Q(m),O=Q(g),w=Q(O),v=Q(w);wt(v),R(w),R(O),R(g),R(m),R(p);var S=ne(p,2),y=ne(Q(S),2),b=Q(y),x=Q(b),A=Q(x);{var k=Te=>{pm(Te,{onselect:Re=>{console.log("Row",n())},get options(){return C(l)},set options(Re){H(l,Y(Re))},get option(){return n().method},set option(Re){n(n().method=Re,!0)}})};ce(A,Te=>{n()&&n().method&&Te(k)})}R(x),R(b),R(y),R(S);var E=ne(S,2),T=ne(Q(E),2),_=Q(T),N=Q(_),Z=Q(N);{var z=Te=>{pm(Te,{options:E2,onselect:Re=>{console.log("Row",n())},get option(){return n().access},set option(Re){n(n().access=Re,!0)}})};ce(Z,Te=>{n()&&Te(z)})}R(N),R(_),R(T),R(E);var ee=ne(E,2),ae=ne(Q(ee),2),xe=Q(ae),V=Q(xe),ue=Q(V);{var ie=Te=>{pm(Te,{onselect:Re=>{console.log("Row",n())},get options(){return C(o)},set options(Re){H(o,Y(Re))},get option(){return n().handler},set option(Re){n(n().handler=Re,!0)}})};ce(ue,Te=>{n()&&n().handler&&Te(ie)})}R(V),R(xe),R(ae),R(ee);var P=ne(ee,2),I=Q(P),B=ne(Q(I),2),W=Q(B),K=Q(W),re=Q(K),pe=Q(re),fe=Q(pe);R(pe),R(re);var de=ne(re,2),Ue=Q(de);wt(Ue),R(de);var q=ne(de,4),ze=Q(q);{var Qe=Te=>{Z0(Te,{onselect:Re=>{},get options(){return t()},set options(Re){t(Re)},get option(){return n().environment},set option(Re){n(n().environment=Re,!0)}})};ce(ze,Te=>{n()&&n().environment&&Te(Qe)})}R(q),R(K);var De=ne(K,2),Fe=Q(De);{var ve=Te=>{var Re=rse();U(Te,Re)},it=Te=>{var Re=nse();U(Te,Re)};ce(Fe,Te=>{s()?Te(ve):Te(it,!1)})}var ot=ne(Fe,2);{var bt=Te=>{var Re=ise();U(Te,Re)},$t=Te=>{var Re=Ee(),Nt=be(Re);{var yr=qr=>{var at=sse();U(qr,at)};ce(Nt,qr=>{s()&&!a()&&qr(yr)},!0)}U(Te,Re)};ce(ot,Te=>{s()&&a()?Te(bt):Te($t,!1)})}R(De),R(W),R(B),R(I),R(P);var Ce=ne(P,2),Ve=ne(Q(Ce),2),Ae=Q(Ve);l0(Ae),R(Ve),R(Ce),R(u),Me(()=>Ge(fe,`${(n().method=="WS"?"/ws/":"/api/")??""}${i().app??""}`)),Jt(d,()=>n().idendpoint,Te=>n(n().idendpoint=Te,!0)),oo(v,()=>n().enabled,Te=>n(n().enabled=Te,!0)),Jt(Ue,()=>n().resource,Te=>n(n().resource=Te,!0)),Jt(Ae,()=>n().description,Te=>n(n().description=Te,!0)),U(r,u),Ot()}function lse(r,e){gt(e,!0);let t=ge(e,"users",31,()=>Y({})),n=Se(Y([])),i=[],s=Se(Y({auth:{label:"Authorization",decorator:{component:mc,props:{ontrue:{label:"Enabled"},onfalse:{label:"Unabled"},editInline:!0}}},iduser:{label:"iduser",hidden:!0},enabled:{label:"Enabled",decorator:{component:mc,props:{ontrue:{label:"Enabled"},onfalse:{label:"Unabled"},editInline:!1}}},name:{label:"name"},username:{label:"username"},email:{label:"email"}})),a;Su.subscribe(f=>{i=f,l()});function o(){t()||t([])}function l(){o(),i&&Array.isArray(i)&&H(n,Y(i.map(f=>({auth:t().includes(f.iduser),...f}))))}Ut(()=>{o()}),Ua(()=>{clearTimeout(a)}),vh(r,{get RawDataTable(){return C(n)},set RawDataTable(f){H(n,Y(f))},get columns(){return C(s)},set columns(f){H(s,Y(f))}}),Ot()}var fse=J("<option> </option>"),cse=J(`<div><span><div class="field is-horizontal"><div class="field-label is-small"><label class="label">Log Level</label></div> <div class="field-body"><div class="field"><div class="control"><div class="select is-fullwidth is-small"><select><!></select></div></div> <span class="help is-success"><div><!></div></span></div></div></div></span></div> <br> <div class="content is-small"><table class="table is-bordered is-striped is-hoverable"><thead><tr><th><span>Log</span></th><th><span>Codes</span></th><th><span>Description</span></th><th><span>Details</span></th></tr></thead><tbody><tr><td><input type="checkbox"></td><td><div>1XX</div></td><td><div>Informational: They indicate that the request has been received and is being
							processed.</div></td><td><div>100 (Continue), 101 (Switching Protocols), 102 (Processing)</div></td></tr><tr><td><input type="checkbox"></td><td><div>2XX</div></td><td><div>Success: The request has been received, understood and processed correctly.</div></td><td><div>200 (OK), 201 (Created), 202 (Accepted), 203 (Non-Authoritative Information), 204 (No
							Content), 205 (Reset Content), 206 (Partial Content), 207 (Multi-Status), 208 (Already
							Reported), 226 (IM Used)</div></td></tr><tr><td><input type="checkbox"></td><td><div>3XX</div></td><td><div>Redirection: The customer must take additional actions to complete the request.</div></td><td><div>300 (Multiple Choices), 301 (Moved Permanently), 302 (Found), 303 (See Other), 304
							(Not Modified), 305 (Use Proxy), 307 (Temporary Redirect), 308 (Permanent Redirect)</div></td></tr><tr><td><input type="checkbox"></td><td><div>4XX</div></td><td><div></div> Client error: The request contains an error or cannot be processed.</td><td><div>400 (Bad Request), 401 (Unauthorized), 402 (Payment Required), 403 (Forbidden), 404
							(Not Found), 405 (Method Not Allowed), 406 (Not Acceptable), 407 (Proxy Authentication
							Required), 408 (Request Timeout), 409 (Conflict), 410 (Gone), 411 (Length Required),
							412 (Precondition Failed), 413 (Payload Too Large), 414 (URI Too Long), 415
							(Unsupported Media Type), 416 (Range Not Satisfiable), 417 (Expectation Failed), 418
							(I'm a teapot), 421 (Misdirected Request), 422 (Unprocessable Entity), 423 (Locked),
							424 (Failed Dependency), 425 (Too Early), 426 (Upgrade Required), 428 (Precondition
							Required), 429 (Too Many Requests), 431 (Request Header Fields Too Large), 451
							(Unavailable For Legal Reasons)</div></td></tr><tr><td><input type="checkbox"></td><td><div>5XX</div></td><td><div>Server error: The server was unable to fulfill an apparently valid request.</div></td><td><div>500 (Internal Server Error), 501 (Not Implemented), 502 (Bad Gateway), 503 (Service
							Unavailable), 504 (Gateway Timeout), 505 (HTTP Version Not Supported), 506 (Variant
							Also Negotiates), 507 (Insufficient Storage), 508 (Loop Detected), 510 (Not Extended),
							511 (Network Authentication Required)</div></td></tr></tbody></table></div>`,1);function hse(r,e){gt(e,!0);const t=c=>{var h=cse(),u=be(h),d=Q(u),p=Q(d),m=ne(Q(p),2),g=Q(m),O=Q(g),w=Q(O),v=Q(w),S=Q(v);{var y=fe=>{var de=Ee(),Ue=be(de);_r(Ue,17,s,Qr,(q,ze)=>{var Qe=fse(),De={},Fe=Q(Qe,!0);R(Qe),Me(()=>{De!==(De=C(ze).id)&&(Qe.value=(Qe.__value=C(ze).id)==null?"":C(ze).id),Ge(Fe,C(ze).value)}),U(q,Qe)}),U(fe,de)};ce(S,fe=>{s()&&s().length>0&&fe(y)})}R(v),R(w),R(O);var b=ne(O,2),x=Q(b),A=Q(x);{var k=fe=>{var de=vs("Does not save any log.");U(fe,de)},E=fe=>{var de=Ee(),Ue=be(de);{var q=Qe=>{var De=vs("Save the minimum data.");U(Qe,De)},ze=Qe=>{var De=Ee(),Fe=be(De);{var ve=ot=>{var bt=vs("Save the most useful data.");U(ot,bt)},it=ot=>{var bt=Ee(),$t=be(bt);{var Ce=Ve=>{var Ae=vs("Saves all request and response data.");U(Ve,Ae)};ce($t,Ve=>{i().level==3&&Ve(Ce)},!0)}U(ot,bt)};ce(Fe,ot=>{i().level==2?ot(ve):ot(it,!1)},!0)}U(Qe,De)};ce(Ue,Qe=>{i().level==1?Qe(q):Qe(ze,!1)},!0)}U(fe,de)};ce(A,fe=>{i().level==0?fe(k):fe(E,!1)})}R(x),R(b),R(g),R(m),R(p),R(d),R(u);var T=ne(u,4),_=Q(T),N=ne(Q(_)),Z=Q(N),z=Q(Z),ee=Q(z);wt(ee),R(z),Kt(3),R(Z);var ae=ne(Z),xe=Q(ae),V=Q(xe);wt(V),R(xe),Kt(3),R(ae);var ue=ne(ae),ie=Q(ue),P=Q(ie);wt(P),R(ie),Kt(3),R(ue);var I=ne(ue),B=Q(I),W=Q(B);wt(W),R(B),Kt(3),R(I);var K=ne(I),re=Q(K),pe=Q(re);wt(pe),R(re),Kt(3),R(K),R(N),R(_),R(T),Sl(v,()=>i().level,fe=>i(i().level=fe,!0)),oo(ee,()=>i().infor,fe=>i(i().infor=fe,!0)),oo(V,()=>i().success,fe=>i(i().success=fe,!0)),oo(P,()=>i().redirection,fe=>i(i().redirection=fe,!0)),oo(W,()=>i().clientError,fe=>i(i().clientError=fe,!0)),oo(pe,()=>i().serverError,fe=>i(i().serverError=fe,!0)),U(c,h)},n=c=>{vh(c,{get requestData(){return C(o)},set requestData(h){H(o,Y(h))}})};let i=ge(e,"log",31,()=>Y({})),s=ge(e,"options",27,()=>Y([{id:0,value:"Disabled",enabled:!0},{id:1,value:"Basic",enabled:!0},{id:2,value:"Normal",enabled:!0},{id:3,value:"Full",enabled:!0}]));ge(e,"ondata",3,c=>{});let a=Se(0),o=Se(Y({url:wn.getLogs,params:{startDate:new Date,endDate:new Date}})),l=Se(Y([{label:"Parametrization",classIcon:"fa-solid fa-rectangle-list",slot:"parameterization",isActive:!0,component:t},{label:"Registered logs",classIcon:"fa-solid fa-file-lines",slot:"logs",isActive:!1,component:n}]));function f(){i()==null&&i({})}Ut(()=>{f()}),Jn(r,{get tabs(){return C(l)},set tabs(c){H(l,Y(c))},get active(){return C(a)},set active(c){H(a,Y(c))}}),Ot()}var use=J('<nav class="level"><div class="level-left"><div class="level-item"><h4 class="subtitle is-5"><div class="icon-text"><span class="icon has-text-info"><i class="fa-solid fa-link"></i></span> <span> </span></div></h4></div></div> <div class="level-right"><span class="level-item"><div class="field is-grouped is-grouped-multiline"><div class="control"><div class="tags has-addons"><span class="tag is-dark">Method</span> <span> </span></div></div> <div class="control"><div class="tags has-addons"><span class="tag is-dark">Handler</span> <span> </span></div></div> <div class="control"><div class="tags has-addons"><span class="tag is-dark">Env</span> <span> </span></div></div></div></span></div></nav>');function dse(r,e){gt(e,!0);let t=ge(e,"environment",11,"?"),n=ge(e,"endpoint",11,"?"),i=ge(e,"method",11,"?"),s=ge(e,"handler",11,"?");var a=use(),o=Q(a),l=Q(o),f=Q(l),c=Q(f),h=ne(Q(c),2),u=Q(h,!0);R(h),R(c),R(f),R(l),R(o);var d=ne(o,2),p=Q(d),m=Q(p),g=Q(m),O=Q(g),w=ne(Q(O),2),v=Q(w,!0);R(w),R(O),R(g);var S=ne(g,2),y=Q(S),b=ne(Q(y),2),x=Q(b,!0);R(b),R(y),R(S);var A=ne(S,2),k=Q(A),E=ne(Q(k),2),T=Q(E,!0);R(E),R(k),R(A),R(m),R(p),R(d),R(a),Me(()=>{var _,N,Z,z,ee;Ge(u,n()),ht(w,`tag is-${((_=P2[i()])==null?void 0:_.color)??""}`),Ge(v,i()),ht(b,`tag is-${((N=bm[s()])==null?void 0:N.color)??""}`),Ge(x,(Z=bm[s()])==null?void 0:Z.label),ht(E,`tag is-${((z=Yf[t()])==null?void 0:z.background)??""}`),Ge(T,(ee=Yf[t()])==null?void 0:ee.label)}),U(r,a),Ot()}var pse=J("<div>No Handler</div>"),mse=J("<div><!></div>"),gse=(r,e,t)=>{e({}),t(!1)},Ose=J('<div class="field has-addons"><p class="control"><button class="button is-success is-small"><span class="icon is-small"><i class="fa-solid fa-check"></i></span> <span>Accept</span></button></p> <p class="control"><button class="button is-small"><span class="icon is-small"><i class="fa-solid fa-xmark"></i></span> <span>Cancel</span></button></p></div>'),xse=J("<!> <!>",1);function vse(r,e){gt(e,!0);const t=g=>{var O=Ee(),w=be(O);{var v=S=>{ose(S,{get row(){return o()},set row(y){o(y)},get app(){return l()},set app(y){l(y)},get validateResource(){return C(h)},set validateResource(y){H(h,Y(y))},get availableURL(){return C(u)},set availableURL(y){H(u,Y(y))}})};ce(w,S=>{o()&&l()&&S(v)})}U(g,O)},n=g=>{var O=Ee(),w=be(O);{var v=S=>{var y=mse(),b=Q(y);{var x=k=>{gie(k,{onchange:E=>{c[o().handler]=E},get row(){return o()},set row(E){o(E)}})},A=k=>{var E=Ee(),T=be(E);{var _=Z=>{wie(Z,{onchange:z=>{c[o().handler]=z},get row(){return o()},set row(z){o(z)}})},N=Z=>{var z=Ee(),ee=be(z);{var ae=V=>{Rie(V,{onchange:ue=>{c[o().handler]=ue},get row(){return o()},set row(ue){o(ue)}})},xe=V=>{var ue=Ee(),ie=be(ue);{var P=B=>{Gie(B,{onchange:W=>{c[o().handler]=W},get row(){return o()},set row(W){o(W)}})},I=B=>{var W=Ee(),K=be(W);{var re=fe=>{Iie(fe,{onchange:de=>{c[o().handler]=de},get row(){return o()},set row(de){o(de)}})},pe=fe=>{var de=Ee(),Ue=be(de);{var q=Qe=>{uie(Qe,{onchange:De=>{c[o().handler]=De},get row(){return o()},set row(De){o(De)}})},ze=Qe=>{var De=Ee(),Fe=be(De);{var ve=ot=>{tse(ot,{onchange:bt=>{c[o().handler]=bt},get row(){return o()},set row(bt){o(bt)}})},it=ot=>{var bt=Ee(),$t=be(bt);{var Ce=Ae=>{Kie(Ae,{onchange:Te=>{c[o().handler]=Te},get row(){return o()},set row(Te){o(Te)}})},Ve=Ae=>{var Te=pse();U(Ae,Te)};ce($t,Ae=>{o()&&o().handler=="TEXT"?Ae(Ce):Ae(Ve,!1)},!0)}U(ot,bt)};ce(Fe,ot=>{o()&&o().handler=="FUNCTION"?ot(ve):ot(it,!1)},!0)}U(Qe,De)};ce(Ue,Qe=>{o()&&o().handler=="FETCH"?Qe(q):Qe(ze,!1)},!0)}U(fe,de)};ce(K,fe=>{o()&&o().handler=="SQL_BULK_I"?fe(re):fe(pe,!1)},!0)}U(B,W)};ce(ie,B=>{o()&&o().handler=="HANA"?B(P):B(I,!1)},!0)}U(V,ue)};ce(ee,V=>{o()&&o().handler=="SQL"?V(ae):V(xe,!1)},!0)}U(Z,z)};ce(T,Z=>{o()&&o().handler=="SOAP"?Z(_):Z(N,!1)},!0)}U(k,E)};ce(b,k=>{o()&&o().handler=="JS"?k(x):k(A,!1)})}R(y),U(S,y)};ce(w,S=>{o()&&S(v)})}U(g,O)},i=g=>{var O=Ee(),w=be(O);{var v=S=>{lse(S,{get users(){return o().ctrl.users},set users(y){o(o().ctrl.users=y,!0)}})};ce(w,S=>{o()&&o().ctrl&&S(v)})}U(g,O)},s=g=>{var O=Ee(),w=be(O);{var v=S=>{hse(S,{get log(){return o().ctrl.log},set log(y){o(o().ctrl.log=y,!0)}})};ce(w,S=>{o()&&o().ctrl&&S(v)})}U(g,O)};let a=ge(e,"showEditor",15,!1),o=ge(e,"row",31,()=>Y({})),l=ge(e,"app",31,()=>Y({})),f=ge(e,"ondata",3,g=>{}),c=[],h=Se(!1),u=Se(!1),d=Se(Y([{label:"Endpoint",isActive:!0,component:t},{label:"Configuration",component:n},{label:"Authorizations",component:i},{label:"Logs",component:s}]));function p(){m();let g={row:gr(o()),validateResource:C(h),availableURL:C(u)};console.log("ACCEPT => ",g),f()(g)}function m(){o()||o({}),o()&&!o().environment&&o(o().environment="?",!0),o()&&!o().endpoint&&o(o().endpoint="",!0),o()&&!o().method&&o(o().method="",!0),o()&&!o().handler&&o(o().handler="",!0),o()&&o().ctrl==null&&o(o().ctrl={},!0),o()&&o().ctrl.users==null&&o(o().ctrl.users=[],!0),o()&&o().ctrl.log==null&&o(o().ctrl.log={},!0),l()==null&&l({endpoints:[]}),l()&&l().endpoints==null&&l(l().endpoints=[],!0)}Ut(()=>{m()}),$re(r,{get show(){return a()},set show(g){a(g)},children:(g,O)=>{var w=xse(),v=be(w);{const y=x=>{dse(x,{get endpoint(){return o().endpoint},set endpoint(A){o(o().endpoint=A,!0)},get environment(){return o().environment},set environment(A){o(o().environment=A,!0)},get method(){return o().method},set method(A){o(o().method=A,!0)},get handler(){return o().handler},set handler(A){o(o().handler=A,!0)}})},b=x=>{var A=Ose(),k=Q(A),E=Q(k);E.__click=()=>{if(!C(h))alert("URL is invalid.");else if(!C(u))alert("URL already exists.");else{let N=c[o().handler];N&&(o(o().data_test=N.data_test,!0),o(o().code=N.code,!0)),p(),a(!1)}},R(k);var T=ne(k,2),_=Q(T);_.__click=[gse,o,a],R(T),R(A),U(x,A)};Cl(v,{left:[y],right:[b],endpoint_path:y,r01:b,$$slots:{endpoint_path:!0,r01:!0}})}var S=ne(v,2);Jn(S,{onselect:()=>{m()},get tabs(){return C(d)},set tabs(y){H(d,Y(y))}}),U(g,w)},$$slots:{default:!0}}),Ot()}vr(["click"]);var yse=J('<textarea class="textarea is-small" placeholder="Description"></textarea>'),wse=(r,e)=>{e()},bse=J('<span><button class="button is-small"><span class="icon is-small"><i class="fa-solid fa-eraser"></i></span> <span>Cache</span></button></span>'),_se=J("<div><!></div>"),kse=(r,e,t)=>{H(e,Y({app:"",idapp:null})),H(t,Y([]))},Sse=J('<button class="button is-small is-primary is-outlined"><span class="icon is-small"><i class="fab fa-github"></i></span> <span>New App</span></button>'),Tse=J('<input class="input is-small" type="text" placeholder="Application name">'),Cse=J('<div class="field has-addons"><p class="control"><a class="button is-static is-small">Application</a></p> <p class="control"><!></p></div>'),Ase=(r,e)=>{C(e).enabled=!C(e).enabled},Ese=J('<input type="button">'),Pse=J('<div class="field has-addons"><p class="control"><a class="button is-static is-small">Enabled</a></p> <p class="control"><!></p></div>'),Rse=J('<button class="button is-small is-link is-outlined"><span class="icon is-small"><i class="fab fa-github"></i></span> <span>Save</span></button>'),Qse=J('<button class="button is-small"><span class="icon is-small"><i class="fa-solid fa-file-export"></i></span> <span>Download</span></button>'),Fse=J('<div class="field has-addons"><p class="control file"><input class="input is-small" type="file" accept=".json"></p> <p class="control"><button class="button is-small"><span class="icon is-small"><i class="fas fa-align-left"></i></span> <span>Upload</span></button></p></div>'),$se=J("<div><!> <!></div>"),Dse=J("<!> <!> <!>",1);function toe(r,e){gt(e,!0);const t=e3(),n=()=>t3(sd,"$userStore",t),i=P=>{var I=yse();l0(I),Jt(I,()=>C(y).description,B=>C(y).description=B),U(P,I)},s=P=>{Ya(P,{isReadOnly:!1,onchanged:I=>{f=I}})},a=P=>{var I=_se(),B=Q(I);{const W=re=>{Kt();var pe=vs("Endpoints");U(re,pe)},K=re=>{var pe=bse(),fe=Q(pe);fe.__click=[wse,k],R(pe),U(re,pe)};b2(vh(B,{ShowNewButton:"true",ShowEditButton:"true",left_items:[W],right_items:[K],onnewrow:()=>{C(y)&&C(y).idapp&&C(y).idapp.length>0?(H(p,Y(q0())),H(d,!0)):alert("No App selected")},oneditrow:re=>{H(p,Y(q0(re))),H(d,!0)},get RawDataTable(){return C(h)},set RawDataTable(re){H(h,Y(re))},get columns(){return C(w)},set columns(re){H(w,Y(re))},get SelectionType(){return C(m)},set SelectionType(re){H(m,Y(re))},lt01:W,rt1:K,$$slots:{lt01:!0,rt1:!0}}),re=>H(g,Y(re)),()=>C(g))}R(I),U(P,I)};let o=0,l,f,c,h=Se(Y([])),u=[],d=Se(!1),p=Se(Y(q0())),m=Se(0),g=Se(void 0),O=Se(0),w=Se(Y({enabled:{label:"Enabled",decorator:{component:mc,props:{custom:{ontrue:{label:"Enabled"},onfalse:{label:"Unabled"},editInline:!0}}}},endpoint:{label:"Endpoint",decorator:{component:Bne}},method:{decorator:{component:vne},label:"Method"},handler:{decorator:{component:Tne},label:"Handler"},access:{label:"Access",decorator:{component:kne}},cache_time:{label:"Cache Time",decorator:{component:Vne}},ctrl:{hidden:!0,label:"Users"},resource:{hidden:!0},code:{label:"Code",hidden:!0},idapp:{hidden:!0},rowkey:{decorator:{component:Nne},label:"Status Code"},app:{hidden:!0},namespace:{hidden:!0},name:{hidden:!0},version:{hidden:!0},description:{hidden:!0},vars:{hidden:!0},idendpoint:{hidden:!0},cors:{hidden:!0},headers_test:{hidden:!0},data_test:{hidden:!0},latest_updater:{hidden:!0},environment:{hidden:!0},cache_size:{hidden:!0}})),v=Se(Y([{label:"Endpoints",classIcon:"fa-solid fa-rectangle-list",component:a},{label:"Description",classIcon:"fa-solid fa-file-lines",slot:"description",isActive:!1,component:i},{label:"Application variables",classIcon:"fa-solid fa-box-archive",slot:"vars",isActive:!1,component:s},{label:"Application parameters",classIcon:"fa-regular fa-rectangle-list",slot:"parameters",isActive:!1}])),S=Se(Y([])),y=Se(Y(uv())),b=new as;function x(){window.location.reload()}async function A(){try{let I=await(await b.GET({url:wn.listEnv})).json();I&&Array.isArray(I)&&I.length>0?u=I.map(B=>({id:B.id,value:B.text})):u=[]}catch(P){alert(P.message)}}async function k(){let P=C(g).GetSelectedRows().map(I=>`${I.endpoint}|${I.method}`);try{if(P&&Array.isArray(P)&&P.length>0){let B=await(await b.POST({url:wn.clearCache,data:P})).json();alert("Cache deleted")}else alert("You must select at least one record."),H(m,2)}catch(I){alert(I.message)}}async function E(){try{let I=await(await b.GET({url:wn.listApps})).json();I&&Array.isArray(I)&&I.length>0?H(S,Y(I.map(B=>({name:B.app,value:B.idapp})))):H(S,Y([]))}catch(P){alert(P.message)}}function T(P){if(P&&P.length>0){if(H(O,0),H(y,Y(uv(P[0]))),console.log(P[0],C(y)),C(y)&&C(y).vars&&typeof C(y).vars=="object")Cf.set(C(y).vars);else if(C(y)&&C(y).vars&&typeof C(y).vars=="string")try{Cf.set(JSON.parse(C(y).vars))}catch(I){console.error(I),Cf.set({})}else Cf.set({});x3(n().token,C(y).app,C(y).environment),C(y).endpoints&&(console.log("Procesar endpoints... "),H(h,Y(C(y).endpoints.map(I=>({endpoint:`${I.method=="WS"?"/ws/":"/api/"}${C(y).app}${I.resource}/${I.environment}`,...I})))),console.log("Procesardos endpoints... ",C(h)),H(h,Y(C(h))))}}async function _(){if(f=void 0,console.log("getapp",o,C(y)),o)try{await O3();let I=await(await b.GET({url:wn.getApp,data:{idapp:o,raw:!1}})).json();T(I)}catch(P){console.error(P),alert(P.message)}}sd.subscribe(P=>{b.setBearerAuthorization(P.token)});function N(){let P={...C(y)};return P.endpoints=C(h),console.log("appToStore >>>> ",gr(P)),gr(P)}async function Z(){try{let P=await b.POST({url:wn.saveApp,data:N()});if(P.status==200){let I=await P.json();o==I.idapp?(alert("Saved successfully."),_()):o=I.idapp,await E()}else P.status==401?(alert("The session has expired."),x()):alert("Error: "+P.status)}catch(P){alert(P.message)}}function z(){return!(c&&c.app&&c.app==C(y).app)}Ut(async()=>{await E(),await A(),l=setInterval(async()=>{var P;(P=C(y))!=null&&P.app&&(await b3(C(y).app,n().token),await _3(C(y).app,n().token))},5e3)}),Ua(()=>{clearInterval(l)});var ee=Dse(),ae=be(ee);{const P=B=>{var W=Ee(),K=be(W);{var re=pe=>{var fe=Sse();fe.__click=[kse,y,h],U(pe,fe)};ce(K,pe=>{n()&&pe(re)})}U(B,W)},I=B=>{_Z(B,{label:"Application: ",classLabel:"is-small",classInput:"is-small",onselect:W=>{console.log("PredictiveInput =>> ",n(),W),n()?(o=W.value,_()):alert("You do not have authorization")},get options(){return C(S)},set options(W){H(S,Y(W))}})};Cl(ae,{right:[I,P],r1:P,r2:I,$$slots:{r1:!0,r2:!0}})}var xe=ne(ae,2);{var V=P=>{var I=$se(),B=Q(I);{const K=Ue=>{var q=Cse(),ze=ne(Q(q),2),Qe=Q(ze);{var De=Fe=>{var ve=Tse();wt(ve),Jt(ve,()=>C(y).app,it=>C(y).app=it),U(Fe,ve)};ce(Qe,Fe=>{C(y)&&Fe(De)})}R(ze),R(q),U(Ue,q)},re=Ue=>{var q=Pse(),ze=ne(Q(q),2),Qe=Q(ze);{var De=Fe=>{var ve=Ese();wt(ve),ve.__click=[Ase,y],Me(()=>ht(ve,Qi(C(y).enabled?"button is-success is-selected is-small":"button is-danger is-small"))),Jt(ve,()=>C(y).enabled,it=>C(y).enabled=it),U(Fe,ve)};ce(Qe,Fe=>{C(y)&&Fe(De)})}R(ze),R(q),U(Ue,q)},pe=Ue=>{var q=Ee(),ze=be(q);{var Qe=De=>{var Fe=Rse();Fe.__click=()=>{confirm("Do you want to save the application data?")&&(f&&(C(y).vars=f),Z())},U(De,Fe)};ce(ze,De=>{n()&&De(Qe)})}U(Ue,q)},fe=Ue=>{var q=Ee(),ze=be(q);{var Qe=De=>{var Fe=Qse();Fe.__click=()=>{const ve=new Date,it=ve.getFullYear(),ot=String(ve.getMonth()+1).padStart(2,"0"),bt=String(ve.getDate()).padStart(2,"0"),$t=String(ve.getHours()).padStart(2,"0"),Ce=String(ve.getMinutes()).padStart(2,"0"),Ve=JSON.stringify(N(),null,2),Ae=new Blob([Ve],{type:"application/json"}),Te=window.URL.createObjectURL(Ae),Re=document.createElement("a");Re.href=Te,Re.download=`app_${C(y).app}_${it}${ot}${bt}_${$t}${Ce}.json`,Re.click(),window.URL.revokeObjectURL(Te)},U(De,Fe)};ce(ze,De=>{n()&&De(Qe)})}U(Ue,q)},de=Ue=>{var q=Ee(),ze=be(q);{var Qe=De=>{var Fe=Fse(),ve=Q(Fe),it=Q(ve);it.__change=$t=>{const Ce=$t.target.files[0];if(!Ce){alert("Por favor, selecciona un archivo JSON vlido.");return}const Ve=new FileReader;Ve.onload=function(Ae){const Te=Ae.target.result;try{c=JSON.parse(Te),z()&&alert("The file does not correspond to the same application.")}catch(Re){console.error("Error al analizar el archivo JSON:",Re)}},Ve.readAsText(Ce)},R(ve);var ot=ne(ve,2),bt=Q(ot);bt.__click=()=>{if(z())alert("The file does not correspond to the same application.");else if(c){if(confirm("Are you sure to merge the file with your data?")&&c.endpoints&&Array.isArray(c.endpoints)){c.endpoints=c.endpoints.map(Ce=>{let Ve=C(y).endpoints.find(Ae=>Ae.environment==Ce.environment&&Ae.method==Ce.method&&Ae.resource==Ce.resource);return Ve&&(Ce.idendpoint=Ve.idendpoint),Ce});const $t=C(y).endpoints.filter(Ce=>!c.endpoints.some(Ve=>Ce.idendpoint===Ve.idendpoint));c.endpoints=c.endpoints.concat($t),T([c]),c=null}}else alert("Please new select file!")},R(ot),R(Fe),U(De,Fe)};ce(ze,De=>{n()&&De(Qe)})}U(Ue,q)};Cl(B,{left:[K,re],right:[de,fe,pe],l01:K,l02:re,r01:pe,r02:fe,r03:de,$$slots:{l01:!0,l02:!0,r01:!0,r02:!0,r03:!0}})}var W=ne(B,2);Jn(W,{get tabs(){return C(v)},set tabs(K){H(v,Y(K))},get active(){return C(O)},set active(K){H(O,Y(K))}}),R(I),U(P,I)};ce(xe,P=>{n()&&P(V)})}var ue=ne(xe,2);{var ie=P=>{vse(P,{ondata:I=>{let B=I.row;if(B.idendpoint&&B.idendpoint.length>10){let W=C(h).findIndex(K=>K.idendpoint==B.idendpoint);W>=0&&(C(h)[W]={...B})}else C(h).unshift({idapp:C(y).idapp,idendpoint:void 0,endpoint:B.endpoint,resource:B.resource,enabled:B.enabled,access:B.access,environment:B.environment,resource:B.resource,method:B.method,handler:B.handler,cors:B.cors,code:B.code,description:B.description,headers_test:B.headers_test,data_test:B.data_test,rowkey:0,latest_updater:n().iduser,cache_time:B.cache_time}),H(h,Y(C(h)))},get showEditor(){return C(d)},set showEditor(I){H(d,Y(I))},get row(){return C(p)},set row(I){H(p,Y(I))},get app(){return C(y)},set app(I){H(y,Y(I))}})};ce(ue,P=>{C(y)&&P(ie)})}U(r,ee),Ot()}vr(["click","change"]);export{toe as A,Xse as L,Ea as s};
