import{d as hv,e as WP,a as W,t as J,c as Ae,b as ms}from"./disclose-version.DE3B7_8X.js";import{U as v2,ae as y2,a7 as UP,k as Qn,H as Eu,C as w2,B as XP,G as Tm,h as b2,a4 as _2,af as VP,ag as uv,Z as J0,l as fo,a1 as qP,ax as Pu,ah as k2,i as eO,ai as jP,V as zP,D as dv,ay as tO,az as pv,aA as rO,aB as GP,O as HP,aC as YP,j as S2,aD as T2,R as KP,aE as JP,K as e3,a9 as mv,aF as t3,Y as C2,a2 as r3,a0 as n3,aG as i3,aH as s3,aI as a3,aJ as o3,b as A2,ak as E2,aj as P2,p as Ot,y as te,w as R,x as P,aK as Lt,q as xt,g as C,z as H,N as be,o as ye,v as Re,f as Pa,n as dd,a as Js,aL as l3}from"./runtime.CfgX6eQG.js";import{b as f3,l as nO,d as Or,s as Ge,e as c3,r as x0}from"./render.DWIGZODM.js";import{d as h3,p as me,i as se,a as Y,c as u3,s as gv,b as R2,e as d3,f as p3}from"./props.CQel5Sq1.js";import{o as It,a as ea}from"./index-client.BCAZJJkF.js";import{w as Ji}from"./index.CX0t67y6.js";import{s as pd}from"./snippet.Dt_8T1af.js";import"./legacy.CNaPTmXt.js";const m3=[];function Ht(r,e=!1){return Ru(r,new Map,"",m3)}function Ru(r,e,t,n,i=null){if(typeof r=="object"&&r!==null){var s=e.get(r);if(s!==void 0)return s;if(r instanceof Map)return new Map(r);if(r instanceof Set)return new Set(r);if(v2(r)){var a=Array(r.length);e.set(r,a),i!==null&&e.set(i,a);for(var o=0;o<r.length;o+=1){var l=r[o];o in r&&(a[o]=Ru(l,e,t,n))}return a}if(y2(r)===UP){a={},e.set(r,a),i!==null&&e.set(i,a);for(var f in r)a[f]=Ru(r[f],e,t,n);return a}if(r instanceof Date)return structuredClone(r);if(typeof r.toJSON=="function")return Ru(r.toJSON(),e,t,n,r)}if(r instanceof EventTarget)return r;try{return structuredClone(r)}catch{return r}}function Lr(r,e){return e}function g3(r,e,t,n){for(var i=[],s=e.length,a=0;a<s;a++)GP(e[a].e,i,!0);var o=s>0&&i.length===0&&t!==null;if(o){var l=t.parentNode;HP(l),l.append(t),n.clear(),ma(r,e[0].prev,e[s-1].next)}YP(i,()=>{for(var f=0;f<s;f++){var c=e[f];o||(n.delete(c.k),ma(r,c.prev,c.next)),S2(c.e,!o)}})}function Pr(r,e,t,n,i,s=null){var a=r,o={flags:e,items:new Map,first:null},l=(e&T2)!==0;if(l){var f=r;a=Qn?Eu(w2(f)):f.appendChild(XP())}Qn&&Tm();var c=null,h=!1;b2(()=>{var u=t(),d=v2(u)?u:u==null?[]:_2(u),p=d.length;if(h&&p===0)return;h=p===0;let m=!1;if(Qn){var g=a.data===VP;g!==(p===0)&&(a=uv(),Eu(a),J0(!1),m=!0)}if(Qn){for(var v=null,w,x=0;x<p;x++){if(fo.nodeType===8&&fo.data===qP){a=fo,m=!0,J0(!1);break}var S=d[x],y=n(S,x);w=Q2(fo,o,v,null,S,y,x,i,e),o.items.set(y,w),v=w}p>0&&Eu(uv())}if(!Qn){var b=KP;O3(d,o,a,i,e,(b.f&Pu)!==0,n)}s!==null&&(p===0?c?k2(c):c=eO(()=>s(a)):c!==null&&jP(c,()=>{c=null})),m&&J0(!0),t()}),Qn&&(a=fo)}function O3(r,e,t,n,i,s,a,o){var z,K,re,ge;var l=(i&JP)!==0,f=(i&(tO|rO))!==0,c=r.length,h=e.items,u=e.first,d=u,p,m=null,g,v=[],w=[],x,S,y,b;if(l)for(b=0;b<c;b+=1)x=r[b],S=a(x,b),y=h.get(S),y!==void 0&&((z=y.a)==null||z.measure(),(g??(g=new Set)).add(y));for(b=0;b<c;b+=1){if(x=r[b],S=a(x,b),y=h.get(S),y===void 0){var O=d?d.e.nodes_start:t;m=Q2(O,e,m,m===null?e.first:m.next,x,S,b,n,i),h.set(S,m),v=[],w=[],d=m.next;continue}if(f&&x3(y,x,b,i),y.e.f&Pu&&(k2(y.e),l&&((K=y.a)==null||K.unfix(),(g??(g=new Set)).delete(y))),y!==d){if(p!==void 0&&p.has(y)){if(v.length<w.length){var T=w[0],k;m=T.prev;var Q=v[0],A=v[v.length-1];for(k=0;k<v.length;k+=1)Ov(v[k],T,t);for(k=0;k<w.length;k+=1)p.delete(w[k]);ma(e,Q.prev,A.next),ma(e,m,Q),ma(e,A,T),d=T,m=A,b-=1,v=[],w=[]}else p.delete(y),Ov(y,d,t),ma(e,y.prev,y.next),ma(e,y,m===null?e.first:m.next),ma(e,m,y),m=y;continue}for(v=[],w=[];d!==null&&d.k!==S;)(s||!(d.e.f&Pu))&&(p??(p=new Set)).add(d),w.push(d),d=d.next;if(d===null)continue;y=d}v.push(y),m=y,d=y.next}if(d!==null||p!==void 0){for(var _=p===void 0?[]:_2(p);d!==null;)(s||!(d.e.f&Pu))&&_.push(d),d=d.next;var N=_.length;if(N>0){var U=i&T2&&c===0?t:null;if(l){for(b=0;b<N;b+=1)(re=_[b].a)==null||re.measure();for(b=0;b<N;b+=1)(ge=_[b].a)==null||ge.fix()}g3(e,_,U,h)}}l&&zP(()=>{var V;if(g!==void 0)for(y of g)(V=y.a)==null||V.apply()}),dv.first=e.first&&e.first.e,dv.last=m&&m.e}function x3(r,e,t,n){n&tO&&pv(r.v,e),n&rO?pv(r.i,t):r.i=t}function Q2(r,e,t,n,i,s,a,o,l,f){var c=(l&tO)!==0,h=(l&t3)===0,u=c?h?e3(i):mv(i):i,d=l&rO?mv(a):a,p={i:d,v:u,k:s,a:null,e:null,prev:t,next:n};try{return p.e=eO(()=>o(r,u,d),Qn),p.e.prev=t&&t.e,p.e.next=n&&n.e,t===null?e.first=p:(t.next=p,t.e.next=p.e),n!==null&&(n.prev=p,n.e.prev=p.e),p}finally{}}function Ov(r,e,t){for(var n=r.next?r.next.e.nodes_start:t,i=e?e.e.nodes_start:t,s=r.e.nodes_start;s!==n;){var a=C2(s);i.before(s),s=a}}function ma(r,e,t){e===null?r.first=t:(e.next=t,e.e.next=t&&t.e),t!==null&&(t.prev=e,t.e.prev=e&&e.e)}function F2(r,e,t,n,i){var s=r,a="",o;b2(()=>{if(a===(a=e()??"")){Qn&&Tm();return}o!==void 0&&(S2(o),o=void 0),a!==""&&(o=eO(()=>{if(Qn){fo.data;for(var l=Tm(),f=l;l!==null&&(l.nodeType!==8||l.data!=="");)f=l,l=C2(l);if(l===null)throw r3(),n3;hv(fo,f),s=Eu(l);return}var c=a+"",h=WP(c);hv(w2(h),h.lastChild),s.before(h)}))})}function $2(r){var e,t,n="";if(typeof r=="string"||typeof r=="number")n+=r;else if(typeof r=="object")if(Array.isArray(r)){var i=r.length;for(e=0;e<i;e++)r[e]&&(t=$2(r[e]))&&(n&&(n+=" "),n+=t)}else for(t in r)r[t]&&(n&&(n+=" "),n+=t);return n}function v3(){for(var r,e,t=0,n="",i=arguments.length;t<i;t++)(r=arguments[t])&&(e=$2(r))&&(n&&(n+=" "),n+=e);return n}function oi(r){return typeof r=="object"?v3(r):r??""}function Et(r){if(Qn){var e=!1,t=()=>{if(!e){if(e=!0,r.hasAttribute("value")){var n=r.value;Ra(r,"value",null),r.value=n}if(r.hasAttribute("checked")){var i=r.checked;Ra(r,"checked",null),r.checked=i}}};r.__on_r=t,a3(t),f3()}}function ol(r,e){var t=r.__attributes??(r.__attributes={});t.checked!==(t.checked=e??void 0)&&(r.checked=e)}function y3(r,e){e?r.hasAttribute("selected")||r.setAttribute("selected",""):r.removeAttribute("selected")}function Ra(r,e,t,n){var i=r.__attributes??(r.__attributes={});Qn&&(i[e]=r.getAttribute(e),e==="src"||e==="srcset"||e==="href"&&r.nodeName==="LINK")||i[e]!==(i[e]=t)&&(e==="style"&&"__styles"in r&&(r.__styles={}),e==="loading"&&(r[i3]=t),t==null?r.removeAttribute(e):typeof t!="string"&&w3(r).includes(e)?r[e]=t:r.setAttribute(e,t))}var xv=new Map;function w3(r){var e=xv.get(r.nodeName);if(e)return e;xv.set(r.nodeName,e=[]);for(var t,n=r,i=Element.prototype;i!==n;){t=s3(n);for(var s in t)t[s].set&&e.push(s);n=y2(n)}return e}function ft(r,e,t){var n=r.__className,i=b3(e,t);Qn&&r.className===i?r.__className=i:(n!==i||Qn&&r.className!==i)&&(e==null&&!t?r.removeAttribute("class"):r.className=i,r.__className=i)}function b3(r,e){return(r??"")+(e?" "+e:"")}function N2(r,e,t){if(t){if(r.classList.contains(e))return;r.classList.add(e)}else{if(!r.classList.contains(e))return;r.classList.remove(e)}}function Xt(r,e,t=e){var n=o3();nO(r,"input",i=>{var s=i?r.defaultValue:r.value;if(s=ep(r)?tp(s):s,t(s),n&&s!==(s=e())){var a=r.selectionStart,o=r.selectionEnd;r.value=s??"",o!==null&&(r.selectionStart=a,r.selectionEnd=Math.min(o,r.value.length))}}),(Qn&&r.defaultValue!==r.value||A2(e)==null&&r.value)&&t(ep(r)?tp(r.value):r.value),E2(()=>{var i=e();ep(r)&&i===tp(r.value)||r.type==="date"&&!i&&!r.value||i!==r.value&&(r.value=i??"")})}function D2(r,e,t=e){nO(r,"change",n=>{var i=n?r.defaultChecked:r.checked;t(i)}),(Qn&&r.defaultChecked!==r.checked||A2(e)==null)&&t(r.checked),E2(()=>{var n=e();r.checked=!!n})}function ep(r){var e=r.type;return e==="number"||e==="range"}function tp(r){return r===""?null:+r}function M2(r,e,t){if(r.multiple)return k3(r,e);for(var n of r.options){var i=ic(n);if(h3(i,e)){n.selected=!0;return}}(!t||e!==void 0)&&(r.selectedIndex=-1)}function _3(r,e){P2(()=>{var t=new MutationObserver(()=>{var n=r.__value;M2(r,n)});return t.observe(r,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{t.disconnect()}})}function Fl(r,e,t=e){var n=!0;nO(r,"change",i=>{var s=i?"[selected]":":checked",a;if(r.multiple)a=[].map.call(r.querySelectorAll(s),ic);else{var o=r.querySelector(s)??r.querySelector("option:not([disabled])");a=o&&ic(o)}t(a)}),P2(()=>{var i=e();if(M2(r,i,n),n&&i===void 0){var s=r.querySelector(":checked");s!==null&&(i=ic(s),t(i))}r.__value=i,n=!1}),_3(r)}function k3(r,e){for(var t of r.options)t.selected=~e.indexOf(ic(t))}function ic(r){return"__value"in r?r.__value:r.value}var vv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function S3(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var Mh={exports:{}},yv;function T3(){return yv||(yv=1,function(r,e){var t=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof vv<"u")return vv;throw new Error("unable to locate global object")},n=t();r.exports=e=n.fetch,n.fetch&&(e.default=n.fetch.bind(n)),e.Headers=n.Headers,e.Request=n.Request,e.Response=n.Response}(Mh,Mh.exports)),Mh.exports}let sc;typeof window<"u"?sc=window.fetch:sc=T3();class C3{constructor(e=void 0,t=void 0){this._redirect_in_unauthorized_internal=t,this._basic_authentication,this._bearer_authentication,this._url=e,this._defaultHeaders=new Map}SetBasicAuthorization(e,t){return e&&t?(this._basic_authentication="Basic "+Buffer.from(e+":"+t).toString("base64"),this._bearer_authentication=void 0):this._basic_authentication=void 0,this}ClearAuthorizationHeader(){this._basic_authentication=void 0,this._bearer_authentication=void 0}SetBasicAuthentication(e,t){return this.SetBasicAuthorization(e,t)}setBearerAuthorization(e){return e?(this._bearer_authentication="Bearer "+e,this._basic_authentication=void 0):this._bearer_authentication=void 0,this}_addAuthorizationHeader(e){return this._basic_authentication?e.Authorization=this._basic_authentication:this._bearer_authentication?e.Authorization=this._bearer_authentication:delete e.Authorization,e}addHeader(e,t){this._defaultHeaders.set(e,t)}async request(e,t,n,i={}){let s,a=t?t.toUpperCase():"GET",o=e&&e.length>0?e:this._url;if(!(a=="GET"||a=="POST"||a=="HEAD"||a=="PUT"||a=="DELETE"||a=="CONNECT"||a=="OPTIONS"||a=="TRACE"||a=="PATCH"))throw"Invalid method";i||(i={"Content-Type":"application/json"}),i=this._addAuthorizationHeader(i);for(const[f,c]of this._defaultHeaders)i[f]=c,!l&&f.toUpperCase()=="Content-Type".toUpperCase()&&(l=!0);let l=!1;for(const[f,c]of Object.entries(i))if(!l&&f.toUpperCase()=="Content-Type".toUpperCase()){l=!0;break}l||(i["Content-Type"]="application/json");try{switch(a){case"POST":s=await sc(o,{method:a,body:JSON.stringify(n),headers:i});break;case"PUT":s=await sc(o,{method:a,body:JSON.stringify(n),headers:i});break;default:let f=new URLSearchParams(n);o=o+"?"+f.toString(),s=await sc(o,{method:a,headers:i});break}return typeof window<"u"&&this._redirect_in_unauthorized&&s.status==401&&(window.location.href=this._redirect_in_unauthorized),s}catch(f){if(console.error(f),s)return s;throw f}}async put(e=void 0,t=void 0,n=void 0){return console.warn("Method put deprecated. Use new method PUT"),this.request(e,"PUT",t,n)}PUT(e={}){return this.request(e.url,"PUT",e.data,e.headers)}async delete(e=void 0,t=void 0,n=void 0){return this.request(e,"DELETE",t,n)}DELETE(e={}){return console.warn("Method delete deprecated. Use new method DELETE"),this.request(e.url,"DELETE",e.data,e.headers)}async post(e=void 0,t=void 0,n=void 0){return console.warn("Method post deprecated. Use new method POST"),this.request(e,"POST",t,n)}POST(e={}){return this.request(e.url,"POST",e.data,e.headers)}async get(e=void 0,t=void 0,n=void 0){return console.warn("Method get deprecated. Use new method GET"),this.request(e,"GET",t,n)}GET(e={}){return this.request(e.url,"GET",e.data,e.headers)}async patch(e=void 0,t=void 0,n=void 0){return console.warn("Method patch deprecated. Use new method PATCH"),this.request(e,"PATCH",t,n)}PATCH(e={}){return this.request(e.url,"PATCH",e.data,e.headers)}}var A3=C3;const es=S3(A3),Ln=R3(""),vn={getfunctions:Ln+"/api/system/api/function_names/prd",getHandler:Ln+"/api/system/system/handler/0.01/prd",Methods:Ln+"/api/system/system/method/0.01/prd",listEnv:Ln+"/api/system/system/environment/0.01/prd",listApps:Ln+"/api/system/api/apps/0.01/prd",getApp:Ln+"/api/system/api/app/0.01/prd",saveApp:Ln+"/api/system/api/app/0.01/prd",saveMethod:Ln+"/api/system/system/method/0.01/prd",login:Ln+"/api/system/system/login/0.01/prd",getCacheSize:Ln+"/api/system/cache/response/size/prd",clearCache:Ln+"/api/system/cache/clear/prd",getUsersList:Ln+"/api/system/users/list/prd",getResponsesCountStatusCode:Ln+"/api/system/responses/status_code/count/prd",getLogs:Ln+"/api/system/system/log/prd"},md=Ji({}),Cm=Ji({}),Am=Ji({}),Em=Ji({}),Pm=Ji({}),Rm=Ji({}),hl=Ji({}),I2=Ji({}),Qu=Ji({}),L2=Ji({}),E3=async r=>{let e=new es;e.setBearerAuthorization(r);try{let n=await(await e.GET({url:vn.getUsersList})).json();n&&Array.isArray(n)?Qu.set(n):Qu.set([])}catch(t){console.error(t),Qu.set([])}},P3=async(r,e)=>{let t=new es;t.setBearerAuthorization(r);try{let i=await(await t.GET({url:vn.getfunctions,data:{appName:e,environment:"dev"}})).json();if(i&&Array.isArray(i)){let s=i.map(a=>({id:a,value:a}));Em.set(s)}}catch(n){console.error(n),Em.set([])}try{let i=await(await t.GET({url:vn.getfunctions,data:{appName:e,environment:"qa"}})).json();if(i&&Array.isArray(i)){let s=i.map(a=>({id:a,value:a}));Pm.set(s)}}catch(n){console.error(n),Pm.set([])}try{let i=await(await t.GET({url:vn.getfunctions,data:{appName:e,environment:"prd"}})).json();if(i&&Array.isArray(i)){let s=i.map(a=>({id:a,value:a}));Rm.set(s)}}catch(n){console.error(n),Rm.set([])}};function R3(r){try{const e=new URL(r);return e.protocol==="http:"||e.protocol==="https:"?r:""}catch{return""}}const Q3=async r=>{let e=new es;e.setBearerAuthorization(r);try{let n=await(await e.GET({url:vn.getHandler})).json();if(n&&Array.isArray(n)){let i=n.map(s=>({id:s.handler,value:s.label,enabled:s.enabled,description:s.description}));Am.set(i)}}catch(t){console.error(t),Am.set([])}},F3=async r=>{let e=new es;e.setBearerAuthorization(r);try{let n=await(await e.GET({url:vn.Methods})).json();if(n&&Array.isArray(n)){let i=n.map(s=>({id:s.method,value:s.label,enabled:s.enabled,description:""}));Cm.set(i)}}catch(t){console.error(t),Cm.set([])}},$3=async(r,e)=>{let t=new es;try{if(r){let i=await(await t.GET({url:vn.getCacheSize,data:{appName:r}})).json();I2.set(i)}}catch(n){console.trace(n)}},wv=r=>(r==null&&(r={app:"",params:{telegram:{}}}),r&&r.idapp==null&&(r.idapp=0),r&&r.app==null&&(r.app=""),r&&r.environment==null&&(r.environment="dev"),r&&r.description==null&&(r.description=""),r&&r.endpoints==null&&(r.endpoints=[]),r&&r.params==null&&(r.params={telegram:{idgroup:""}}),r&&r.params.telegram==null&&(r.params.telegram={idgroup:""}),r&&r.params.telegram&&r.params.telegram.idgroup==null&&(r.params.telegram.idgroup=""),r&&r.vars==null&&(r.vars={}),r),rp=r=>(r==null&&(r={}),r&&r.idendpoint==null&&(r.idendpoint=void 0),r&&r.enabled==null&&(r.enabled=!1),r&&r.access==null&&(r.access=0),r&&r.environment==null&&(r.environment="dev"),r&&r.resource==null&&(r.resource=""),r&&r.method==null&&(r.method="GET"),r&&r.handler==null&&(r.handler="NA"),r&&r.cors==null&&(r.cors={}),r&&r.code==null&&(r.code=""),r&&r.description==null&&(r.description=""),r&&r.description==null&&(r.description=""),r&&r.headers_test==null&&(r.headers_test={}),r&&r.data_test==null&&(r.data_test={}),r&&r.rowkey==null&&(r.rowkey=0),r&&r.cache_time==null&&(r.cache_time=0),r&&!r.environment&&(r.environment="?"),r&&!r.endpoint&&(r.endpoint=""),r&&!r.method&&(r.method=""),r&&!r.handler&&(r.handler=""),r&&r.ctrl==null&&(r.ctrl={}),r&&r.ctrl.users==null&&(r.ctrl.users=[]),r&&r.ctrl.log==null&&(r.ctrl.log={}),r&&r.data_test==null&&(r.data_test={query:{},body:{},headers:{},auth:{}}),r&&r.data_test.query==null&&(r.data_test.query={}),r&&r.data_test.body==null&&(r.data_test.body={}),r&&r.data_test.headers==null&&(r.data_test.headers={}),r&&r.data_test.auth==null&&(r.data_test.auth={}),r),N3=async(r,e)=>{let t=new es;try{if(r){let i=await(await t.GET({url:vn.getResponsesCountStatusCode,data:{appName:r}})).json();L2.set(i)}}catch(n){console.error(n)}};function D3(r){return!!/^\/[a-zA-Z0-9\-._~%]+(\/[a-zA-Z0-9\-._~%]+)*\/?$/.test(r)}function M3(r,e,t,n){return`${r=="WS"?"/ws/":"/api/"}${e}${t}/${n}`}const B2=[{value:"Public",id:0},{value:"Basic",id:1},{value:"Bearer",id:2},{value:"Basic & Bearer",id:3}],Z2={GET:{color:"primary",icon:"fa-brands fa-get-pocket"},POST:{color:"link",icon:"fa-solid fa-signs-post"},DELETE:{color:"danger",icon:"fa-solid fa-trash"},PUT:{color:"info",icon:"fa-solid fa-file-pen"},WS:{color:"warning",icon:"fa-solid fa-tower-broadcast"}},Qm={JS:{color:"success",icon:"fa-brands fa-js",label:"Javascript"},SQL:{color:"link",icon:"fa-solid fa-database",label:"SQL"},SQL_BULK_I:{color:"danger",icon:"fa-solid fa-database",label:"SQL BULK INSERT"},HANA:{color:"",icon:"fa-solid fa-database",label:"Hana"},FETCH:{color:"primary",icon:"fa-solid fa-globe",label:"Fetch"},SOAP:{color:"info",icon:"fa-solid fa-soap",label:"SOAP"},TEXT:{color:"warning",icon:"fa-regular fa-file-lines",label:"Text"},FUNCTION:{color:"danger",icon:"fa-solid fa-robot",label:"Function"},MONGODB:{color:"",icon:"fa-solid fa-database",label:"MongoDB"}},ac={prd:{color:" has-text-success ",background:"success",icon:" fa-solid fa-gear fa-spin ",label:"Production"},qa:{color:" has-text-link ",background:"link",icon:" fa-solid fa-eye ",label:"Quality"},dev:{color:" has-text-danger ",background:"danger",icon:" fa-solid fa-bug ",label:"Development"}},I3="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAABwRJREFUWEeNl1tsXNUVhr+195mZYztxlCo3gngiKFWwhFQqpVGT2M7F5ELpQ2ugQUV9gaoqvfDQIKWFxA4EikMCTVtQCmpJo8Z1EuOmoiShVGrVhz4godL0pRdBLpCQW6P4NuOZOavZ+5yZOWPPAJZGPnPOnr3+9a9//WsfmVwuTxqjq9WAWFSMaGTAWDQSxWTw34k/6u9bUOGvuUH6pJew0MoBAuaIQbGo2mS9FcSoaiCKKNg4htvHrwn4ueSXsxlhGEvggyQLqtfx9+S+gNE4CBwLh/gaX6e1YDmFZZ4YUCMqgapLyK1zoPx1EO+jVtRY//xcMaJHdAm5/HxeF0N3HQBLAcsFLBGCOuQqyUYOvfDH3CDf5Uu0TM3jhBrm1kCLe+6AoAYrloVqMTEAt5dEWH02fJwBtyX5FWzAMoKQqTJgmRDDC1nlF5SZcOtoh1F/AYUyU/OPua+CbtG5oxmMY3lWBnXPR0Mkl2URlq2RsNlYjGMiBsC50hQ9s57mI0FAbyVXWMgbGDo9APdx0CwlLG9JxLbscf7hlibxZ/xzy+MfgXZpMNHBpiBgmxpZitFUCVARngn7GXBr4184FlbJXYiOYMiI4d9qacP4DBz1F0UYyE7xijnJ+PTocfD4b/wRFlvlMTXcL5acWKLI8C8JWITQjuGDsmV9Wx8X6gDoRnKFMY7fyHgVhtMKD5ks31bLBsQLtIThzRJsbxvhXcdGOvDbD5PpEHoQ+rDc5uttGDMBLxPwT4V9GhCI4elwJ7t96uoYSO1SWOm1cFQtWTH0XbnKnnkLeaBs2CaWmxKROWEOXFdeXXCYMZfFxIPcbAK2SsAWFXJOuGrkHQLtu3CNvy2ex281kFUYPV8qsnbWQJx9wkANwallZJcs4ASWlSqcCQ0rOMmlsc18Nmvpx7JB43Yti/CnkrDd5rjlBrAdCLe5PlfLKEb2hzn9iezlav5R1mnAb8QSRIanWnfxXK2ELn8fvwJCKHSynkBfUyGrhv7wJE8Jomd7tWV+mQdV2FplI+CaGnJiJIdV167vRFl2tCzgz7KDSHvJFm5hyIs74MOyYV3bLs6nNVQVYeWmLiObX8QfxP3IcKYorJh9gouV56Nf4fZswHaEHg3IeFczjBrh5WzIHnmR/8XaVvLfp0cMBxPWdrX8mN11beTtIi2CSkd0cxeWI1hyKmwPj/NMugXP9NIyP+AHxvBYZMmXlS1tt/Km9BFV2NSHyRRaOewSUcv5clHWtj2vddlXos/oab2TTOEz/B7DGnVtM8UXZr3lTKPWbvkHuFtUBiPLWLGkHe2HuJyubf472oPloGvrCPpb97C3kYfUSlCTgY+S72GjCEMefVl6207o39Mb5O/jbgIGI8NYqUQCoNJbwuQjfAPDTrE6VrJ0p5UfE69JG84oQbzJ23eSWTaPR42Ro+Eb+t/p6D0Ay6B6BuiYc4jL6frqDszYVTqDgAXhHoZ8CdMUVtuwwc2qIMEPuAhk/B4WzDrGR1XnTBhwZuMAtA9y2SVV7iIYv505s3/GlUaUp7OPNTADQNWiPEWXvsjs9rl8C0tvSfly2zH50Ct8OoBEA5PfZK0E0lcWfbb1Aq/LEcoNgaTCTHtej2hiE8utceNWQoz+KDfCc47ORgC88g3DYlmNkf9k0W7ZJ9cr9U6LtCLneh9oUA7fEYsZQtiI5YNI6Gwd5lwjAMWHWFOyDInxbvlk+NOa5zcuR2oaVozZjzUPy+UZy6q4iXXlDMOupTA8ER6Vgfx96rvAacB1wekS15fMZRhhNZbTU+PS1f6qNtZBKlH5GA1WQXsWbuYwhg0EnI2KrDEhdxDIoBodKxbpCNq4QwxDzvNvnAj7w5fSnp8aPf6y1i8zrLgZVcV76C5bfneD2gDLTuAUGTnkAEQZPmeFVzCsxPBeTllj9nO5bl7XUZyw7Mdx3V/tXOMxpujxg6XMEYT1GM5i2YNltyuBBnzPGF5MwG0PX5rmes1oTgZBs6RT8eMdJr9KlygjWD8p3xVLhxryYnkfy1Is72dzrDH7uDR94jU7ywlOBYnYGg2m9Ea+za54AN3J2dG/K3ikgX9neCK7v7HnV1VQCZe4cQMjaupfXjrFXjrLgjs75ipnfQ/CyOmcapf5JZfqJZbKfXqy7n3l48NVdFAromNh6poH0K3xy4Y/RUfK462/4vmm9WzyoApgmvyqo6LqWAl1bt3EvXSL4SgBueRAcrZUpnP2r93B5dM0dtoT06ZQ16EzMNR8oYugcJOMYNW9TTmOfxge4IV4QSMAlTyTcqTmwIwSfBr8bs3kFtbhzguGi6HKajmo1WNbcyAz6+CdsN6bPlEVPsfIueNSf2D5S8tB9n7SO1MzUIkVN887DXD6qvH7+XxrlvfkQIPZX1ncdGvXgMr/Adgcxpok5CivAAAAAElFTkSuQmCC";var L3=(r,e)=>{e()},B3=J('<div class="modal is-active"><div class="modal-background"></div> <div class="modal-content"><div class="box"><div class="media t1 svelte-fhc20z"><div class="media-left"><figure class="image is-48x48"><img alt="OpenFusionAPI"></figure></div> <div class="media-content"><p class="title is-family-sans-serif">Open Fusion API</p></div></div> <div class="field"><p class="control has-icons-left has-icons-right"><input class="input" type="text" placeholder="Username"> <span class="icon is-small is-left"><i class="fa-solid fa-user"></i></span></p></div> <div class="field"><p class="control has-icons-left"><input class="input" type="password" placeholder="Password"> <span class="icon is-small is-left"><i class="fas fa-lock"></i></span></p></div> <div class="field"><p class="control"><button class="button is-success">Login</button></p></div></div></div></div>');function vae(r,e){Ot(e,!0);let t=me(e,"onlogin",3,()=>{}),n=be(""),i=be(""),s=new es;async function a(){try{let T=await(await s.POST({url:vn.login,data:{username:C(n),password:C(i)}})).json();T.login?(md.set(T),await F3(T.token),await Q3(T.token),t()({login:T.login})):alert("Invalid credentials")}catch(O){console.trace(O),alert(O.message)}}It(()=>{});var o=B3(),l=te(R(o),2),f=R(l),c=R(f),h=R(c),u=R(h),d=R(u);Ra(d,"src",I3),P(u),P(h),Lt(2),P(c);var p=te(c,2),m=R(p),g=R(m);Et(g),Lt(2),P(m),P(p);var v=te(p,2),w=R(v),x=R(w);Et(x),Lt(2),P(w),P(v);var S=te(v,2),y=R(S),b=R(y);b.__click=[L3,a],P(y),P(S),P(f),P(l),P(o),Xt(g,()=>C(n),O=>H(n,O)),Xt(x,()=>C(i),O=>H(i,O)),W(r,o),xt()}Or(["click"]);var Z3=(r,e,t)=>{e.editInline&&t(!t())},W3=J("<i></i>"),U3=J("<i></i>"),X3=J("<span> </span>"),V3=J("<span> </span>"),q3=J('<td><span><span class="icon"><!></span> <!></span></td>'),j3=J('<input type="checkbox">'),z3=r=>{r.preventDefault()},G3=J('<input type="checkbox">'),H3=J("<td><!></td>");function bc(r,e){Ot(e,!0);let t=me(e,"value",15),n=me(e,"css_cell",3,"has-text-centered"),i={ontrue:{label:"",iconClass:"fa-regular fa-square-check",iconColorClass:" has-text-success ",css_cell:"has-text-centered"},onfalse:{label:"",iconClass:"fa-regular fa-square",iconColorClass:" has-text-danger ",css_cell:"has-text-centered"}};var s=Ae(),a=ye(s);{var o=f=>{var c=q3();c.__click=function(...x){var S;(S=e.onclick_cell)==null||S.apply(this,x)};var h=R(c);h.__click=[Z3,e,t];var u=R(h),d=R(u);{var p=x=>{var S=W3();Re(()=>{var y,b,O,T,k,Q;return ft(S,`${((y=e.custom.ontrue)!=null&&y.iconClass?(b=e.custom.ontrue)==null?void 0:b.iconClass:(O=i.ontrue)==null?void 0:O.iconClass)??""} ${((T=e.custom.ontrue)!=null&&T.iconColorClass?(k=e.custom.ontrue)==null?void 0:k.iconColorClass:(Q=i.ontrue)==null?void 0:Q.iconColorClass)??""}`)}),W(x,S)},m=x=>{var S=U3();Re(()=>{var y,b,O,T,k,Q;return ft(S,`${((y=e.custom.onfalse)!=null&&y.iconClass?(b=e.custom.onfalse)==null?void 0:b.iconClass:(O=i.onfalse)==null?void 0:O.iconClass)??""} ${((T=e.custom.onfalse)!=null&&T.iconColorClass?(k=e.custom.onfalse)==null?void 0:k.iconColorClass:(Q=i.onfalse)==null?void 0:Q.iconColorClass)??""}`)}),W(x,S)};se(d,x=>{t()?x(p):x(m,!1)})}P(u);var g=te(u,2);{var v=x=>{var S=X3(),y=R(S,!0);P(S),Re(()=>{var b;return Ge(y,(b=e.custom.ontrue)!=null&&b.label?e.custom.ontrue.label:i.ontrue.label)}),W(x,S)},w=x=>{var S=V3(),y=R(S,!0);P(S),Re(()=>{var b;return Ge(y,(b=e.custom.onfalse)!=null&&b.label?e.custom.onfalse.label:i.onfalse.label)}),W(x,S)};se(g,x=>{t()?x(v):x(w,!1)})}P(h),P(c),Re(()=>{var x,S;ft(c,oi(t()?(x=e.custom.ontrue)!=null&&x.css_cell?e.custom.ontrue.css_cell:n():(S=e.custom.onfalse)!=null&&S.css_cell?e.custom.onfalse.css_cell:n())),ft(h,`icon-text ${(e.editInline?"is-clickable":"")??""}`)}),W(f,c)},l=f=>{var c=H3();c.__click=function(...p){var m;(m=e.onclick_cell)==null||m.apply(this,p)};var h=R(c);{var u=p=>{var m=j3();Et(m),D2(m,t),W(p,m)},d=p=>{var m=G3();Et(m),m.__click=[z3],Re(()=>ol(m,t())),W(p,m)};se(h,p=>{e.editInline?p(u):p(d,!1)})}P(c),Re(()=>ft(c,oi(n()))),W(f,c)};se(a,f=>{e.custom?f(o):f(l,!1)})}W(r,s),xt()}Or(["click"]);Or(["click"]);class Lo extends Error{}class Y3 extends Lo{constructor(e){super(`Invalid DateTime: ${e.toMessage()}`)}}class K3 extends Lo{constructor(e){super(`Invalid Interval: ${e.toMessage()}`)}}class J3 extends Lo{constructor(e){super(`Invalid Duration: ${e.toMessage()}`)}}class If extends Lo{}class W2 extends Lo{constructor(e){super(`Invalid unit ${e}`)}}class wi extends Lo{}class da extends Lo{constructor(){super("Zone is an abstract class")}}const Ue="numeric",Gi="short",li="long",Fm={year:Ue,month:Ue,day:Ue},U2={year:Ue,month:Gi,day:Ue},e5={year:Ue,month:Gi,day:Ue,weekday:Gi},X2={year:Ue,month:li,day:Ue},V2={year:Ue,month:li,day:Ue,weekday:li},q2={hour:Ue,minute:Ue},j2={hour:Ue,minute:Ue,second:Ue},z2={hour:Ue,minute:Ue,second:Ue,timeZoneName:Gi},G2={hour:Ue,minute:Ue,second:Ue,timeZoneName:li},H2={hour:Ue,minute:Ue,hourCycle:"h23"},Y2={hour:Ue,minute:Ue,second:Ue,hourCycle:"h23"},K2={hour:Ue,minute:Ue,second:Ue,hourCycle:"h23",timeZoneName:Gi},J2={hour:Ue,minute:Ue,second:Ue,hourCycle:"h23",timeZoneName:li},ek={year:Ue,month:Ue,day:Ue,hour:Ue,minute:Ue},tk={year:Ue,month:Ue,day:Ue,hour:Ue,minute:Ue,second:Ue},rk={year:Ue,month:Gi,day:Ue,hour:Ue,minute:Ue},nk={year:Ue,month:Gi,day:Ue,hour:Ue,minute:Ue,second:Ue},t5={year:Ue,month:Gi,day:Ue,weekday:Gi,hour:Ue,minute:Ue},ik={year:Ue,month:li,day:Ue,hour:Ue,minute:Ue,timeZoneName:Gi},sk={year:Ue,month:li,day:Ue,hour:Ue,minute:Ue,second:Ue,timeZoneName:Gi},ak={year:Ue,month:li,day:Ue,weekday:li,hour:Ue,minute:Ue,timeZoneName:li},ok={year:Ue,month:li,day:Ue,weekday:li,hour:Ue,minute:Ue,second:Ue,timeZoneName:li};function kt(r){return typeof r>"u"}function Oo(r){return typeof r=="number"}function v0(r){return typeof r=="number"&&r%1===0}function r5(r){return typeof r=="string"}function n5(r){return Object.prototype.toString.call(r)==="[object Date]"}function lk(){try{return typeof Intl<"u"&&!!Intl.RelativeTimeFormat}catch{return!1}}function i5(r){return Array.isArray(r)?r:[r]}function bv(r,e,t){if(r.length!==0)return r.reduce((n,i)=>{const s=[e(i),i];return n&&t(n[0],s[0])===n[0]?n:s},null)[1]}function s5(r,e){return e.reduce((t,n)=>(t[n]=r[n],t),{})}function $l(r,e){return Object.prototype.hasOwnProperty.call(r,e)}function Zs(r,e,t){return v0(r)&&r>=e&&r<=t}function a5(r,e){return r-e*Math.floor(r/e)}function Ir(r,e=2){const t=r<0;let n;return t?n="-"+(""+-r).padStart(e,"0"):n=(""+r).padStart(e,"0"),n}function ga(r){if(!(kt(r)||r===null||r===""))return parseInt(r,10)}function no(r){if(!(kt(r)||r===null||r===""))return parseFloat(r)}function iO(r){if(!(kt(r)||r===null||r==="")){const e=parseFloat("0."+r)*1e3;return Math.floor(e)}}function sO(r,e,t=!1){const n=10**e;return(t?Math.trunc:Math.round)(r*n)/n}function dh(r){return r%4===0&&(r%100!==0||r%400===0)}function oc(r){return dh(r)?366:365}function gd(r,e){const t=a5(e-1,12)+1,n=r+(e-t)/12;return t===2?dh(n)?29:28:[31,null,31,30,31,30,31,31,30,31,30,31][t-1]}function aO(r){let e=Date.UTC(r.year,r.month-1,r.day,r.hour,r.minute,r.second,r.millisecond);return r.year<100&&r.year>=0&&(e=new Date(e),e.setUTCFullYear(e.getUTCFullYear()-1900)),+e}function Od(r){const e=(r+Math.floor(r/4)-Math.floor(r/100)+Math.floor(r/400))%7,t=r-1,n=(t+Math.floor(t/4)-Math.floor(t/100)+Math.floor(t/400))%7;return e===4||n===3?53:52}function $m(r){return r>99?r:r>60?1900+r:2e3+r}function fk(r,e,t,n=null){const i=new Date(r),s={hourCycle:"h23",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"};n&&(s.timeZone=n);const a={timeZoneName:e,...s},o=new Intl.DateTimeFormat(t,a).formatToParts(i).find(l=>l.type.toLowerCase()==="timezonename");return o?o.value:null}function y0(r,e){let t=parseInt(r,10);Number.isNaN(t)&&(t=0);const n=parseInt(e,10)||0,i=t<0||Object.is(t,-0)?-n:n;return t*60+i}function ck(r){const e=Number(r);if(typeof r=="boolean"||r===""||Number.isNaN(e))throw new wi(`Invalid unit value ${r}`);return e}function xd(r,e){const t={};for(const n in r)if($l(r,n)){const i=r[n];if(i==null)continue;t[e(n)]=ck(i)}return t}function lc(r,e){const t=Math.trunc(Math.abs(r/60)),n=Math.trunc(Math.abs(r%60)),i=r>=0?"+":"-";switch(e){case"short":return`${i}${Ir(t,2)}:${Ir(n,2)}`;case"narrow":return`${i}${t}${n>0?`:${n}`:""}`;case"techie":return`${i}${Ir(t,2)}${Ir(n,2)}`;default:throw new RangeError(`Value format ${e} is out of range for property format`)}}function w0(r){return s5(r,["hour","minute","second","millisecond"])}const hk=/[A-Za-z_+-]{1,256}(?::?\/[A-Za-z0-9_+-]{1,256}(?:\/[A-Za-z0-9_+-]{1,256})?)?/,o5=["January","February","March","April","May","June","July","August","September","October","November","December"],uk=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],l5=["J","F","M","A","M","J","J","A","S","O","N","D"];function dk(r){switch(r){case"narrow":return[...l5];case"short":return[...uk];case"long":return[...o5];case"numeric":return["1","2","3","4","5","6","7","8","9","10","11","12"];case"2-digit":return["01","02","03","04","05","06","07","08","09","10","11","12"];default:return null}}const pk=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],mk=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],f5=["M","T","W","T","F","S","S"];function gk(r){switch(r){case"narrow":return[...f5];case"short":return[...mk];case"long":return[...pk];case"numeric":return["1","2","3","4","5","6","7"];default:return null}}const Ok=["AM","PM"],c5=["Before Christ","Anno Domini"],h5=["BC","AD"],u5=["B","A"];function xk(r){switch(r){case"narrow":return[...u5];case"short":return[...h5];case"long":return[...c5];default:return null}}function d5(r){return Ok[r.hour<12?0:1]}function p5(r,e){return gk(e)[r.weekday-1]}function m5(r,e){return dk(e)[r.month-1]}function g5(r,e){return xk(e)[r.year<0?0:1]}function O5(r,e,t="always",n=!1){const i={years:["year","yr."],quarters:["quarter","qtr."],months:["month","mo."],weeks:["week","wk."],days:["day","day","days"],hours:["hour","hr."],minutes:["minute","min."],seconds:["second","sec."]},s=["hours","minutes","seconds"].indexOf(r)===-1;if(t==="auto"&&s){const h=r==="days";switch(e){case 1:return h?"tomorrow":`next ${i[r][0]}`;case-1:return h?"yesterday":`last ${i[r][0]}`;case 0:return h?"today":`this ${i[r][0]}`}}const a=Object.is(e,-0)||e<0,o=Math.abs(e),l=o===1,f=i[r],c=n?l?f[1]:f[2]||f[1]:l?i[r][0]:r;return a?`${o} ${c} ago`:`in ${o} ${c}`}function _v(r,e){let t="";for(const n of r)n.literal?t+=n.val:t+=e(n.val);return t}const x5={D:Fm,DD:U2,DDD:X2,DDDD:V2,t:q2,tt:j2,ttt:z2,tttt:G2,T:H2,TT:Y2,TTT:K2,TTTT:J2,f:ek,ff:rk,fff:ik,ffff:ak,F:tk,FF:nk,FFF:sk,FFFF:ok};class Vn{static create(e,t={}){return new Vn(e,t)}static parseFormat(e){let t=null,n="",i=!1;const s=[];for(let a=0;a<e.length;a++){const o=e.charAt(a);o==="'"?(n.length>0&&s.push({literal:i,val:n}),t=null,n="",i=!i):i||o===t?n+=o:(n.length>0&&s.push({literal:!1,val:n}),n=o,t=o)}return n.length>0&&s.push({literal:i,val:n}),s}static macroTokenToFormatOpts(e){return x5[e]}constructor(e,t){this.opts=t,this.loc=e,this.systemLoc=null}formatWithSystemDefault(e,t){return this.systemLoc===null&&(this.systemLoc=this.loc.redefaultToSystem()),this.systemLoc.dtFormatter(e,{...this.opts,...t}).format()}formatDateTime(e,t={}){return this.loc.dtFormatter(e,{...this.opts,...t}).format()}formatDateTimeParts(e,t={}){return this.loc.dtFormatter(e,{...this.opts,...t}).formatToParts()}resolvedOptions(e,t={}){return this.loc.dtFormatter(e,{...this.opts,...t}).resolvedOptions()}num(e,t=0){if(this.opts.forceSimple)return Ir(e,t);const n={...this.opts};return t>0&&(n.padTo=t),this.loc.numberFormatter(n).format(e)}formatDateTimeFromString(e,t){const n=this.loc.listingMode()==="en",i=this.loc.outputCalendar&&this.loc.outputCalendar!=="gregory",s=(d,p)=>this.loc.extract(e,d,p),a=d=>e.isOffsetFixed&&e.offset===0&&d.allowZ?"Z":e.isValid?e.zone.formatOffset(e.ts,d.format):"",o=()=>n?d5(e):s({hour:"numeric",hourCycle:"h12"},"dayperiod"),l=(d,p)=>n?m5(e,d):s(p?{month:d}:{month:d,day:"numeric"},"month"),f=(d,p)=>n?p5(e,d):s(p?{weekday:d}:{weekday:d,month:"long",day:"numeric"},"weekday"),c=d=>{const p=Vn.macroTokenToFormatOpts(d);return p?this.formatWithSystemDefault(e,p):d},h=d=>n?g5(e,d):s({era:d},"era"),u=d=>{switch(d){case"S":return this.num(e.millisecond);case"u":case"SSS":return this.num(e.millisecond,3);case"s":return this.num(e.second);case"ss":return this.num(e.second,2);case"uu":return this.num(Math.floor(e.millisecond/10),2);case"uuu":return this.num(Math.floor(e.millisecond/100));case"m":return this.num(e.minute);case"mm":return this.num(e.minute,2);case"h":return this.num(e.hour%12===0?12:e.hour%12);case"hh":return this.num(e.hour%12===0?12:e.hour%12,2);case"H":return this.num(e.hour);case"HH":return this.num(e.hour,2);case"Z":return a({format:"narrow",allowZ:this.opts.allowZ});case"ZZ":return a({format:"short",allowZ:this.opts.allowZ});case"ZZZ":return a({format:"techie",allowZ:this.opts.allowZ});case"ZZZZ":return e.zone.offsetName(e.ts,{format:"short",locale:this.loc.locale});case"ZZZZZ":return e.zone.offsetName(e.ts,{format:"long",locale:this.loc.locale});case"z":return e.zoneName;case"a":return o();case"d":return i?s({day:"numeric"},"day"):this.num(e.day);case"dd":return i?s({day:"2-digit"},"day"):this.num(e.day,2);case"c":return this.num(e.weekday);case"ccc":return f("short",!0);case"cccc":return f("long",!0);case"ccccc":return f("narrow",!0);case"E":return this.num(e.weekday);case"EEE":return f("short",!1);case"EEEE":return f("long",!1);case"EEEEE":return f("narrow",!1);case"L":return i?s({month:"numeric",day:"numeric"},"month"):this.num(e.month);case"LL":return i?s({month:"2-digit",day:"numeric"},"month"):this.num(e.month,2);case"LLL":return l("short",!0);case"LLLL":return l("long",!0);case"LLLLL":return l("narrow",!0);case"M":return i?s({month:"numeric"},"month"):this.num(e.month);case"MM":return i?s({month:"2-digit"},"month"):this.num(e.month,2);case"MMM":return l("short",!1);case"MMMM":return l("long",!1);case"MMMMM":return l("narrow",!1);case"y":return i?s({year:"numeric"},"year"):this.num(e.year);case"yy":return i?s({year:"2-digit"},"year"):this.num(e.year.toString().slice(-2),2);case"yyyy":return i?s({year:"numeric"},"year"):this.num(e.year,4);case"yyyyyy":return i?s({year:"numeric"},"year"):this.num(e.year,6);case"G":return h("short");case"GG":return h("long");case"GGGGG":return h("narrow");case"kk":return this.num(e.weekYear.toString().slice(-2),2);case"kkkk":return this.num(e.weekYear,4);case"W":return this.num(e.weekNumber);case"WW":return this.num(e.weekNumber,2);case"o":return this.num(e.ordinal);case"ooo":return this.num(e.ordinal,3);case"q":return this.num(e.quarter);case"qq":return this.num(e.quarter,2);case"X":return this.num(Math.floor(e.ts/1e3));case"x":return this.num(e.ts);default:return c(d)}};return _v(Vn.parseFormat(t),u)}formatDurationFromString(e,t){const n=l=>{switch(l[0]){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":return"hour";case"d":return"day";case"w":return"week";case"M":return"month";case"y":return"year";default:return null}},i=l=>f=>{const c=n(f);return c?this.num(l.get(c),f.length):f},s=Vn.parseFormat(t),a=s.reduce((l,{literal:f,val:c})=>f?l:l.concat(c),[]),o=e.shiftTo(...a.map(n).filter(l=>l));return _v(s,i(o))}}class Li{constructor(e,t){this.reason=e,this.explanation=t}toMessage(){return this.explanation?`${this.reason}: ${this.explanation}`:this.reason}}class ph{get type(){throw new da}get name(){throw new da}get ianaName(){return this.name}get isUniversal(){throw new da}offsetName(e,t){throw new da}formatOffset(e,t){throw new da}offset(e){throw new da}equals(e){throw new da}get isValid(){throw new da}}let np=null;class oO extends ph{static get instance(){return np===null&&(np=new oO),np}get type(){return"system"}get name(){return new Intl.DateTimeFormat().resolvedOptions().timeZone}get isUniversal(){return!1}offsetName(e,{format:t,locale:n}){return fk(e,t,n)}formatOffset(e,t){return lc(this.offset(e),t)}offset(e){return-new Date(e).getTimezoneOffset()}equals(e){return e.type==="system"}get isValid(){return!0}}let Fu={};function v5(r){return Fu[r]||(Fu[r]=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:r,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",era:"short"})),Fu[r]}const y5={year:0,month:1,day:2,era:3,hour:4,minute:5,second:6};function w5(r,e){const t=r.format(e).replace(/\u200E/g,""),n=/(\d+)\/(\d+)\/(\d+) (AD|BC),? (\d+):(\d+):(\d+)/.exec(t),[,i,s,a,o,l,f,c]=n;return[a,i,s,o,l,f,c]}function b5(r,e){const t=r.formatToParts(e),n=[];for(let i=0;i<t.length;i++){const{type:s,value:a}=t[i],o=y5[s];s==="era"?n[o]=a:kt(o)||(n[o]=parseInt(a,10))}return n}let Ih={};class qs extends ph{static create(e){return Ih[e]||(Ih[e]=new qs(e)),Ih[e]}static resetCache(){Ih={},Fu={}}static isValidSpecifier(e){return this.isValidZone(e)}static isValidZone(e){if(!e)return!1;try{return new Intl.DateTimeFormat("en-US",{timeZone:e}).format(),!0}catch{return!1}}constructor(e){super(),this.zoneName=e,this.valid=qs.isValidZone(e)}get type(){return"iana"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(e,{format:t,locale:n}){return fk(e,t,n,this.name)}formatOffset(e,t){return lc(this.offset(e),t)}offset(e){const t=new Date(e);if(isNaN(t))return NaN;const n=v5(this.name);let[i,s,a,o,l,f,c]=n.formatToParts?b5(n,t):w5(n,t);o==="BC"&&(i=-Math.abs(i)+1);const u=aO({year:i,month:s,day:a,hour:l===24?0:l,minute:f,second:c,millisecond:0});let d=+t;const p=d%1e3;return d-=p>=0?p:1e3+p,(u-d)/(60*1e3)}equals(e){return e.type==="iana"&&e.name===this.name}get isValid(){return this.valid}}let ip=null;class Fn extends ph{static get utcInstance(){return ip===null&&(ip=new Fn(0)),ip}static instance(e){return e===0?Fn.utcInstance:new Fn(e)}static parseSpecifier(e){if(e){const t=e.match(/^utc(?:([+-]\d{1,2})(?::(\d{2}))?)?$/i);if(t)return new Fn(y0(t[1],t[2]))}return null}constructor(e){super(),this.fixed=e}get type(){return"fixed"}get name(){return this.fixed===0?"UTC":`UTC${lc(this.fixed,"narrow")}`}get ianaName(){return this.fixed===0?"Etc/UTC":`Etc/GMT${lc(-this.fixed,"narrow")}`}offsetName(){return this.name}formatOffset(e,t){return lc(this.fixed,t)}get isUniversal(){return!0}offset(){return this.fixed}equals(e){return e.type==="fixed"&&e.fixed===this.fixed}get isValid(){return!0}}class _5 extends ph{constructor(e){super(),this.zoneName=e}get type(){return"invalid"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(){return null}formatOffset(){return""}offset(){return NaN}equals(){return!1}get isValid(){return!1}}function ya(r,e){if(kt(r)||r===null)return e;if(r instanceof ph)return r;if(r5(r)){const t=r.toLowerCase();return t==="local"||t==="system"?e:t==="utc"||t==="gmt"?Fn.utcInstance:Fn.parseSpecifier(t)||qs.create(r)}else return Oo(r)?Fn.instance(r):typeof r=="object"&&r.offset&&typeof r.offset=="number"?r:new _5(r)}let kv=()=>Date.now(),Sv="system",Tv=null,Cv=null,Av=null,Ev;class Wr{static get now(){return kv}static set now(e){kv=e}static set defaultZone(e){Sv=e}static get defaultZone(){return ya(Sv,oO.instance)}static get defaultLocale(){return Tv}static set defaultLocale(e){Tv=e}static get defaultNumberingSystem(){return Cv}static set defaultNumberingSystem(e){Cv=e}static get defaultOutputCalendar(){return Av}static set defaultOutputCalendar(e){Av=e}static get throwOnInvalid(){return Ev}static set throwOnInvalid(e){Ev=e}static resetCaches(){yr.resetCache(),qs.resetCache()}}let Pv={};function k5(r,e={}){const t=JSON.stringify([r,e]);let n=Pv[t];return n||(n=new Intl.ListFormat(r,e),Pv[t]=n),n}let Nm={};function Dm(r,e={}){const t=JSON.stringify([r,e]);let n=Nm[t];return n||(n=new Intl.DateTimeFormat(r,e),Nm[t]=n),n}let Mm={};function S5(r,e={}){const t=JSON.stringify([r,e]);let n=Mm[t];return n||(n=new Intl.NumberFormat(r,e),Mm[t]=n),n}let Im={};function T5(r,e={}){const{base:t,...n}=e,i=JSON.stringify([r,n]);let s=Im[i];return s||(s=new Intl.RelativeTimeFormat(r,e),Im[i]=s),s}let Lf=null;function C5(){return Lf||(Lf=new Intl.DateTimeFormat().resolvedOptions().locale,Lf)}function A5(r){const e=r.indexOf("-u-");if(e===-1)return[r];{let t;const n=r.substring(0,e);try{t=Dm(r).resolvedOptions()}catch{t=Dm(n).resolvedOptions()}const{numberingSystem:i,calendar:s}=t;return[n,i,s]}}function E5(r,e,t){return(t||e)&&(r+="-u",t&&(r+=`-ca-${t}`),e&&(r+=`-nu-${e}`)),r}function P5(r){const e=[];for(let t=1;t<=12;t++){const n=st.utc(2016,t,1);e.push(r(n))}return e}function R5(r){const e=[];for(let t=1;t<=7;t++){const n=st.utc(2016,11,13+t);e.push(r(n))}return e}function Lh(r,e,t,n,i){const s=r.listingMode(t);return s==="error"?null:s==="en"?n(e):i(e)}function Q5(r){return r.numberingSystem&&r.numberingSystem!=="latn"?!1:r.numberingSystem==="latn"||!r.locale||r.locale.startsWith("en")||new Intl.DateTimeFormat(r.intl).resolvedOptions().numberingSystem==="latn"}class F5{constructor(e,t,n){this.padTo=n.padTo||0,this.floor=n.floor||!1;const{padTo:i,floor:s,...a}=n;if(!t||Object.keys(a).length>0){const o={useGrouping:!1,...n};n.padTo>0&&(o.minimumIntegerDigits=n.padTo),this.inf=S5(e,o)}}format(e){if(this.inf){const t=this.floor?Math.floor(e):e;return this.inf.format(t)}else{const t=this.floor?Math.floor(e):sO(e,3);return Ir(t,this.padTo)}}}class $5{constructor(e,t,n){this.opts=n;let i;if(e.zone.isUniversal){const a=-1*(e.offset/60),o=a>=0?`Etc/GMT+${a}`:`Etc/GMT${a}`;e.offset!==0&&qs.create(o).valid?(i=o,this.dt=e):(i="UTC",n.timeZoneName?this.dt=e:this.dt=e.offset===0?e:st.fromMillis(e.ts+e.offset*60*1e3))}else e.zone.type==="system"?this.dt=e:(this.dt=e,i=e.zone.name);const s={...this.opts};i&&(s.timeZone=i),this.dtf=Dm(t,s)}format(){return this.dtf.format(this.dt.toJSDate())}formatToParts(){return this.dtf.formatToParts(this.dt.toJSDate())}resolvedOptions(){return this.dtf.resolvedOptions()}}class N5{constructor(e,t,n){this.opts={style:"long",...n},!t&&lk()&&(this.rtf=T5(e,n))}format(e,t){return this.rtf?this.rtf.format(e,t):O5(t,e,this.opts.numeric,this.opts.style!=="long")}formatToParts(e,t){return this.rtf?this.rtf.formatToParts(e,t):[]}}class yr{static fromOpts(e){return yr.create(e.locale,e.numberingSystem,e.outputCalendar,e.defaultToEN)}static create(e,t,n,i=!1){const s=e||Wr.defaultLocale,a=s||(i?"en-US":C5()),o=t||Wr.defaultNumberingSystem,l=n||Wr.defaultOutputCalendar;return new yr(a,o,l,s)}static resetCache(){Lf=null,Nm={},Mm={},Im={}}static fromObject({locale:e,numberingSystem:t,outputCalendar:n}={}){return yr.create(e,t,n)}constructor(e,t,n,i){const[s,a,o]=A5(e);this.locale=s,this.numberingSystem=t||a||null,this.outputCalendar=n||o||null,this.intl=E5(this.locale,this.numberingSystem,this.outputCalendar),this.weekdaysCache={format:{},standalone:{}},this.monthsCache={format:{},standalone:{}},this.meridiemCache=null,this.eraCache={},this.specifiedLocale=i,this.fastNumbersCached=null}get fastNumbers(){return this.fastNumbersCached==null&&(this.fastNumbersCached=Q5(this)),this.fastNumbersCached}listingMode(){const e=this.isEnglish(),t=(this.numberingSystem===null||this.numberingSystem==="latn")&&(this.outputCalendar===null||this.outputCalendar==="gregory");return e&&t?"en":"intl"}clone(e){return!e||Object.getOwnPropertyNames(e).length===0?this:yr.create(e.locale||this.specifiedLocale,e.numberingSystem||this.numberingSystem,e.outputCalendar||this.outputCalendar,e.defaultToEN||!1)}redefaultToEN(e={}){return this.clone({...e,defaultToEN:!0})}redefaultToSystem(e={}){return this.clone({...e,defaultToEN:!1})}months(e,t=!1,n=!0){return Lh(this,e,n,dk,()=>{const i=t?{month:e,day:"numeric"}:{month:e},s=t?"format":"standalone";return this.monthsCache[s][e]||(this.monthsCache[s][e]=P5(a=>this.extract(a,i,"month"))),this.monthsCache[s][e]})}weekdays(e,t=!1,n=!0){return Lh(this,e,n,gk,()=>{const i=t?{weekday:e,year:"numeric",month:"long",day:"numeric"}:{weekday:e},s=t?"format":"standalone";return this.weekdaysCache[s][e]||(this.weekdaysCache[s][e]=R5(a=>this.extract(a,i,"weekday"))),this.weekdaysCache[s][e]})}meridiems(e=!0){return Lh(this,void 0,e,()=>Ok,()=>{if(!this.meridiemCache){const t={hour:"numeric",hourCycle:"h12"};this.meridiemCache=[st.utc(2016,11,13,9),st.utc(2016,11,13,19)].map(n=>this.extract(n,t,"dayperiod"))}return this.meridiemCache})}eras(e,t=!0){return Lh(this,e,t,xk,()=>{const n={era:e};return this.eraCache[e]||(this.eraCache[e]=[st.utc(-40,1,1),st.utc(2017,1,1)].map(i=>this.extract(i,n,"era"))),this.eraCache[e]})}extract(e,t,n){const i=this.dtFormatter(e,t),s=i.formatToParts(),a=s.find(o=>o.type.toLowerCase()===n);return a?a.value:null}numberFormatter(e={}){return new F5(this.intl,e.forceSimple||this.fastNumbers,e)}dtFormatter(e,t={}){return new $5(e,this.intl,t)}relFormatter(e={}){return new N5(this.intl,this.isEnglish(),e)}listFormatter(e={}){return k5(this.intl,e)}isEnglish(){return this.locale==="en"||this.locale.toLowerCase()==="en-us"||new Intl.DateTimeFormat(this.intl).resolvedOptions().locale.startsWith("en-us")}equals(e){return this.locale===e.locale&&this.numberingSystem===e.numberingSystem&&this.outputCalendar===e.outputCalendar}}function sf(...r){const e=r.reduce((t,n)=>t+n.source,"");return RegExp(`^${e}$`)}function af(...r){return e=>r.reduce(([t,n,i],s)=>{const[a,o,l]=s(e,i);return[{...t,...a},o||n,l]},[{},null,1]).slice(0,2)}function of(r,...e){if(r==null)return[null,null];for(const[t,n]of e){const i=t.exec(r);if(i)return n(i)}return[null,null]}function vk(...r){return(e,t)=>{const n={};let i;for(i=0;i<r.length;i++)n[r[i]]=ga(e[t+i]);return[n,null,t+i]}}const yk=/(?:(Z)|([+-]\d\d)(?::?(\d\d))?)/,D5=`(?:${yk.source}?(?:\\[(${hk.source})\\])?)?`,lO=/(\d\d)(?::?(\d\d)(?::?(\d\d)(?:[.,](\d{1,30}))?)?)?/,wk=RegExp(`${lO.source}${D5}`),fO=RegExp(`(?:T${wk.source})?`),M5=/([+-]\d{6}|\d{4})(?:-?(\d\d)(?:-?(\d\d))?)?/,I5=/(\d{4})-?W(\d\d)(?:-?(\d))?/,L5=/(\d{4})-?(\d{3})/,B5=vk("weekYear","weekNumber","weekDay"),Z5=vk("year","ordinal"),W5=/(\d{4})-(\d\d)-(\d\d)/,bk=RegExp(`${lO.source} ?(?:${yk.source}|(${hk.source}))?`),U5=RegExp(`(?: ${bk.source})?`);function yl(r,e,t){const n=r[e];return kt(n)?t:ga(n)}function X5(r,e){return[{year:yl(r,e),month:yl(r,e+1,1),day:yl(r,e+2,1)},null,e+3]}function lf(r,e){return[{hours:yl(r,e,0),minutes:yl(r,e+1,0),seconds:yl(r,e+2,0),milliseconds:iO(r[e+3])},null,e+4]}function mh(r,e){const t=!r[e]&&!r[e+1],n=y0(r[e+1],r[e+2]),i=t?null:Fn.instance(n);return[{},i,e+3]}function gh(r,e){const t=r[e]?qs.create(r[e]):null;return[{},t,e+1]}const V5=RegExp(`^T?${lO.source}$`),q5=/^-?P(?:(?:(-?\d{1,20}(?:\.\d{1,20})?)Y)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20}(?:\.\d{1,20})?)W)?(?:(-?\d{1,20}(?:\.\d{1,20})?)D)?(?:T(?:(-?\d{1,20}(?:\.\d{1,20})?)H)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20})(?:[.,](-?\d{1,20}))?S)?)?)$/;function j5(r){const[e,t,n,i,s,a,o,l,f]=r,c=e[0]==="-",h=l&&l[0]==="-",u=(d,p=!1)=>d!==void 0&&(p||d&&c)?-d:d;return[{years:u(no(t)),months:u(no(n)),weeks:u(no(i)),days:u(no(s)),hours:u(no(a)),minutes:u(no(o)),seconds:u(no(l),l==="-0"),milliseconds:u(iO(f),h)}]}const z5={GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function cO(r,e,t,n,i,s,a){const o={year:e.length===2?$m(ga(e)):ga(e),month:uk.indexOf(t)+1,day:ga(n),hour:ga(i),minute:ga(s)};return a&&(o.second=ga(a)),r&&(o.weekday=r.length>3?pk.indexOf(r)+1:mk.indexOf(r)+1),o}const G5=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|(?:([+-]\d\d)(\d\d)))$/;function H5(r){const[,e,t,n,i,s,a,o,l,f,c,h]=r,u=cO(e,i,n,t,s,a,o);let d;return l?d=z5[l]:f?d=0:d=y0(c,h),[u,new Fn(d)]}function Y5(r){return r.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim()}const K5=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d\d) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d\d):(\d\d):(\d\d) GMT$/,J5=/^(Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday), (\d\d)-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d\d) (\d\d):(\d\d):(\d\d) GMT$/,eR=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( \d|\d\d) (\d\d):(\d\d):(\d\d) (\d{4})$/;function Rv(r){const[,e,t,n,i,s,a,o]=r;return[cO(e,i,n,t,s,a,o),Fn.utcInstance]}function tR(r){const[,e,t,n,i,s,a,o]=r;return[cO(e,o,t,n,i,s,a),Fn.utcInstance]}const rR=sf(M5,fO),nR=sf(I5,fO),iR=sf(L5,fO),sR=sf(wk),_k=af(X5,lf,mh,gh),aR=af(B5,lf,mh,gh),oR=af(Z5,lf,mh,gh),lR=af(lf,mh,gh);function fR(r){return of(r,[rR,_k],[nR,aR],[iR,oR],[sR,lR])}function cR(r){return of(Y5(r),[G5,H5])}function hR(r){return of(r,[K5,Rv],[J5,Rv],[eR,tR])}function uR(r){return of(r,[q5,j5])}const dR=af(lf);function pR(r){return of(r,[V5,dR])}const mR=sf(W5,U5),gR=sf(bk),OR=af(lf,mh,gh);function xR(r){return of(r,[mR,_k],[gR,OR])}const vR="Invalid Duration",kk={weeks:{days:7,hours:7*24,minutes:7*24*60,seconds:7*24*60*60,milliseconds:7*24*60*60*1e3},days:{hours:24,minutes:24*60,seconds:24*60*60,milliseconds:24*60*60*1e3},hours:{minutes:60,seconds:60*60,milliseconds:60*60*1e3},minutes:{seconds:60,milliseconds:60*1e3},seconds:{milliseconds:1e3}},yR={years:{quarters:4,months:12,weeks:52,days:365,hours:365*24,minutes:365*24*60,seconds:365*24*60*60,milliseconds:365*24*60*60*1e3},quarters:{months:3,weeks:13,days:91,hours:91*24,minutes:91*24*60,seconds:91*24*60*60,milliseconds:91*24*60*60*1e3},months:{weeks:4,days:30,hours:30*24,minutes:30*24*60,seconds:30*24*60*60,milliseconds:30*24*60*60*1e3},...kk},pi=146097/400,tl=146097/4800,wR={years:{quarters:4,months:12,weeks:pi/7,days:pi,hours:pi*24,minutes:pi*24*60,seconds:pi*24*60*60,milliseconds:pi*24*60*60*1e3},quarters:{months:3,weeks:pi/28,days:pi/4,hours:pi*24/4,minutes:pi*24*60/4,seconds:pi*24*60*60/4,milliseconds:pi*24*60*60*1e3/4},months:{weeks:tl/7,days:tl,hours:tl*24,minutes:tl*24*60,seconds:tl*24*60*60,milliseconds:tl*24*60*60*1e3},...kk},oo=["years","quarters","months","weeks","days","hours","minutes","seconds","milliseconds"],bR=oo.slice(0).reverse();function io(r,e,t=!1){const n={values:t?e.values:{...r.values,...e.values||{}},loc:r.loc.clone(e.loc),conversionAccuracy:e.conversionAccuracy||r.conversionAccuracy};return new Ct(n)}function _R(r){return r<0?Math.floor(r):Math.ceil(r)}function Sk(r,e,t,n,i){const s=r[i][t],a=e[t]/s,o=Math.sign(a)===Math.sign(n[i]),l=!o&&n[i]!==0&&Math.abs(a)<=1?_R(a):Math.trunc(a);n[i]+=l,e[t]-=l*s}function kR(r,e){bR.reduce((t,n)=>kt(e[n])?t:(t&&Sk(r,e,t,e,n),n),null)}class Ct{constructor(e){const t=e.conversionAccuracy==="longterm"||!1;this.values=e.values,this.loc=e.loc||yr.create(),this.conversionAccuracy=t?"longterm":"casual",this.invalid=e.invalid||null,this.matrix=t?wR:yR,this.isLuxonDuration=!0}static fromMillis(e,t){return Ct.fromObject({milliseconds:e},t)}static fromObject(e,t={}){if(e==null||typeof e!="object")throw new wi(`Duration.fromObject: argument expected to be an object, got ${e===null?"null":typeof e}`);return new Ct({values:xd(e,Ct.normalizeUnit),loc:yr.fromObject(t),conversionAccuracy:t.conversionAccuracy})}static fromDurationLike(e){if(Oo(e))return Ct.fromMillis(e);if(Ct.isDuration(e))return e;if(typeof e=="object")return Ct.fromObject(e);throw new wi(`Unknown duration argument ${e} of type ${typeof e}`)}static fromISO(e,t){const[n]=uR(e);return n?Ct.fromObject(n,t):Ct.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static fromISOTime(e,t){const[n]=pR(e);return n?Ct.fromObject(n,t):Ct.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static invalid(e,t=null){if(!e)throw new wi("need to specify a reason the Duration is invalid");const n=e instanceof Li?e:new Li(e,t);if(Wr.throwOnInvalid)throw new J3(n);return new Ct({invalid:n})}static normalizeUnit(e){const t={year:"years",years:"years",quarter:"quarters",quarters:"quarters",month:"months",months:"months",week:"weeks",weeks:"weeks",day:"days",days:"days",hour:"hours",hours:"hours",minute:"minutes",minutes:"minutes",second:"seconds",seconds:"seconds",millisecond:"milliseconds",milliseconds:"milliseconds"}[e&&e.toLowerCase()];if(!t)throw new W2(e);return t}static isDuration(e){return e&&e.isLuxonDuration||!1}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}toFormat(e,t={}){const n={...t,floor:t.round!==!1&&t.floor!==!1};return this.isValid?Vn.create(this.loc,n).formatDurationFromString(this,e):vR}toHuman(e={}){const t=oo.map(n=>{const i=this.values[n];return kt(i)?null:this.loc.numberFormatter({style:"unit",unitDisplay:"long",...e,unit:n.slice(0,-1)}).format(i)}).filter(n=>n);return this.loc.listFormatter({type:"conjunction",style:e.listStyle||"narrow",...e}).format(t)}toObject(){return this.isValid?{...this.values}:{}}toISO(){if(!this.isValid)return null;let e="P";return this.years!==0&&(e+=this.years+"Y"),(this.months!==0||this.quarters!==0)&&(e+=this.months+this.quarters*3+"M"),this.weeks!==0&&(e+=this.weeks+"W"),this.days!==0&&(e+=this.days+"D"),(this.hours!==0||this.minutes!==0||this.seconds!==0||this.milliseconds!==0)&&(e+="T"),this.hours!==0&&(e+=this.hours+"H"),this.minutes!==0&&(e+=this.minutes+"M"),(this.seconds!==0||this.milliseconds!==0)&&(e+=sO(this.seconds+this.milliseconds/1e3,3)+"S"),e==="P"&&(e+="T0S"),e}toISOTime(e={}){if(!this.isValid)return null;const t=this.toMillis();if(t<0||t>=864e5)return null;e={suppressMilliseconds:!1,suppressSeconds:!1,includePrefix:!1,format:"extended",...e};const n=this.shiftTo("hours","minutes","seconds","milliseconds");let i=e.format==="basic"?"hhmm":"hh:mm";(!e.suppressSeconds||n.seconds!==0||n.milliseconds!==0)&&(i+=e.format==="basic"?"ss":":ss",(!e.suppressMilliseconds||n.milliseconds!==0)&&(i+=".SSS"));let s=n.toFormat(i);return e.includePrefix&&(s="T"+s),s}toJSON(){return this.toISO()}toString(){return this.toISO()}toMillis(){return this.as("milliseconds")}valueOf(){return this.toMillis()}plus(e){if(!this.isValid)return this;const t=Ct.fromDurationLike(e),n={};for(const i of oo)($l(t.values,i)||$l(this.values,i))&&(n[i]=t.get(i)+this.get(i));return io(this,{values:n},!0)}minus(e){if(!this.isValid)return this;const t=Ct.fromDurationLike(e);return this.plus(t.negate())}mapUnits(e){if(!this.isValid)return this;const t={};for(const n of Object.keys(this.values))t[n]=ck(e(this.values[n],n));return io(this,{values:t},!0)}get(e){return this[Ct.normalizeUnit(e)]}set(e){if(!this.isValid)return this;const t={...this.values,...xd(e,Ct.normalizeUnit)};return io(this,{values:t})}reconfigure({locale:e,numberingSystem:t,conversionAccuracy:n}={}){const i=this.loc.clone({locale:e,numberingSystem:t}),s={loc:i};return n&&(s.conversionAccuracy=n),io(this,s)}as(e){return this.isValid?this.shiftTo(e).get(e):NaN}normalize(){if(!this.isValid)return this;const e=this.toObject();return kR(this.matrix,e),io(this,{values:e},!0)}shiftTo(...e){if(!this.isValid)return this;if(e.length===0)return this;e=e.map(a=>Ct.normalizeUnit(a));const t={},n={},i=this.toObject();let s;for(const a of oo)if(e.indexOf(a)>=0){s=a;let o=0;for(const f in n)o+=this.matrix[f][a]*n[f],n[f]=0;Oo(i[a])&&(o+=i[a]);const l=Math.trunc(o);t[a]=l,n[a]=(o*1e3-l*1e3)/1e3;for(const f in i)oo.indexOf(f)>oo.indexOf(a)&&Sk(this.matrix,i,f,t,a)}else Oo(i[a])&&(n[a]=i[a]);for(const a in n)n[a]!==0&&(t[s]+=a===s?n[a]:n[a]/this.matrix[s][a]);return io(this,{values:t},!0).normalize()}negate(){if(!this.isValid)return this;const e={};for(const t of Object.keys(this.values))e[t]=this.values[t]===0?0:-this.values[t];return io(this,{values:e},!0)}get years(){return this.isValid?this.values.years||0:NaN}get quarters(){return this.isValid?this.values.quarters||0:NaN}get months(){return this.isValid?this.values.months||0:NaN}get weeks(){return this.isValid?this.values.weeks||0:NaN}get days(){return this.isValid?this.values.days||0:NaN}get hours(){return this.isValid?this.values.hours||0:NaN}get minutes(){return this.isValid?this.values.minutes||0:NaN}get seconds(){return this.isValid?this.values.seconds||0:NaN}get milliseconds(){return this.isValid?this.values.milliseconds||0:NaN}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}equals(e){if(!this.isValid||!e.isValid||!this.loc.equals(e.loc))return!1;function t(n,i){return n===void 0||n===0?i===void 0||i===0:n===i}for(const n of oo)if(!t(this.values[n],e.values[n]))return!1;return!0}}const yf="Invalid Interval";function SR(r,e){return!r||!r.isValid?br.invalid("missing or invalid start"):!e||!e.isValid?br.invalid("missing or invalid end"):e<r?br.invalid("end before start",`The end of an interval must be after its start, but you had start=${r.toISO()} and end=${e.toISO()}`):null}class br{constructor(e){this.s=e.start,this.e=e.end,this.invalid=e.invalid||null,this.isLuxonInterval=!0}static invalid(e,t=null){if(!e)throw new wi("need to specify a reason the Interval is invalid");const n=e instanceof Li?e:new Li(e,t);if(Wr.throwOnInvalid)throw new K3(n);return new br({invalid:n})}static fromDateTimes(e,t){const n=_f(e),i=_f(t),s=SR(n,i);return s??new br({start:n,end:i})}static after(e,t){const n=Ct.fromDurationLike(t),i=_f(e);return br.fromDateTimes(i,i.plus(n))}static before(e,t){const n=Ct.fromDurationLike(t),i=_f(e);return br.fromDateTimes(i.minus(n),i)}static fromISO(e,t){const[n,i]=(e||"").split("/",2);if(n&&i){let s,a;try{s=st.fromISO(n,t),a=s.isValid}catch{a=!1}let o,l;try{o=st.fromISO(i,t),l=o.isValid}catch{l=!1}if(a&&l)return br.fromDateTimes(s,o);if(a){const f=Ct.fromISO(i,t);if(f.isValid)return br.after(s,f)}else if(l){const f=Ct.fromISO(n,t);if(f.isValid)return br.before(o,f)}}return br.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static isInterval(e){return e&&e.isLuxonInterval||!1}get start(){return this.isValid?this.s:null}get end(){return this.isValid?this.e:null}get isValid(){return this.invalidReason===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}length(e="milliseconds"){return this.isValid?this.toDuration(e).get(e):NaN}count(e="milliseconds"){if(!this.isValid)return NaN;const t=this.start.startOf(e),n=this.end.startOf(e);return Math.floor(n.diff(t,e).get(e))+1}hasSame(e){return this.isValid?this.isEmpty()||this.e.minus(1).hasSame(this.s,e):!1}isEmpty(){return this.s.valueOf()===this.e.valueOf()}isAfter(e){return this.isValid?this.s>e:!1}isBefore(e){return this.isValid?this.e<=e:!1}contains(e){return this.isValid?this.s<=e&&this.e>e:!1}set({start:e,end:t}={}){return this.isValid?br.fromDateTimes(e||this.s,t||this.e):this}splitAt(...e){if(!this.isValid)return[];const t=e.map(_f).filter(a=>this.contains(a)).sort(),n=[];let{s:i}=this,s=0;for(;i<this.e;){const a=t[s]||this.e,o=+a>+this.e?this.e:a;n.push(br.fromDateTimes(i,o)),i=o,s+=1}return n}splitBy(e){const t=Ct.fromDurationLike(e);if(!this.isValid||!t.isValid||t.as("milliseconds")===0)return[];let{s:n}=this,i=1,s;const a=[];for(;n<this.e;){const o=this.start.plus(t.mapUnits(l=>l*i));s=+o>+this.e?this.e:o,a.push(br.fromDateTimes(n,s)),n=s,i+=1}return a}divideEqually(e){return this.isValid?this.splitBy(this.length()/e).slice(0,e):[]}overlaps(e){return this.e>e.s&&this.s<e.e}abutsStart(e){return this.isValid?+this.e==+e.s:!1}abutsEnd(e){return this.isValid?+e.e==+this.s:!1}engulfs(e){return this.isValid?this.s<=e.s&&this.e>=e.e:!1}equals(e){return!this.isValid||!e.isValid?!1:this.s.equals(e.s)&&this.e.equals(e.e)}intersection(e){if(!this.isValid)return this;const t=this.s>e.s?this.s:e.s,n=this.e<e.e?this.e:e.e;return t>=n?null:br.fromDateTimes(t,n)}union(e){if(!this.isValid)return this;const t=this.s<e.s?this.s:e.s,n=this.e>e.e?this.e:e.e;return br.fromDateTimes(t,n)}static merge(e){const[t,n]=e.sort((i,s)=>i.s-s.s).reduce(([i,s],a)=>s?s.overlaps(a)||s.abutsStart(a)?[i,s.union(a)]:[i.concat([s]),a]:[i,a],[[],null]);return n&&t.push(n),t}static xor(e){let t=null,n=0;const i=[],s=e.map(l=>[{time:l.s,type:"s"},{time:l.e,type:"e"}]),a=Array.prototype.concat(...s),o=a.sort((l,f)=>l.time-f.time);for(const l of o)n+=l.type==="s"?1:-1,n===1?t=l.time:(t&&+t!=+l.time&&i.push(br.fromDateTimes(t,l.time)),t=null);return br.merge(i)}difference(...e){return br.xor([this].concat(e)).map(t=>this.intersection(t)).filter(t=>t&&!t.isEmpty())}toString(){return this.isValid?`[${this.s.toISO()}  ${this.e.toISO()})`:yf}toISO(e){return this.isValid?`${this.s.toISO(e)}/${this.e.toISO(e)}`:yf}toISODate(){return this.isValid?`${this.s.toISODate()}/${this.e.toISODate()}`:yf}toISOTime(e){return this.isValid?`${this.s.toISOTime(e)}/${this.e.toISOTime(e)}`:yf}toFormat(e,{separator:t="  "}={}){return this.isValid?`${this.s.toFormat(e)}${t}${this.e.toFormat(e)}`:yf}toDuration(e,t){return this.isValid?this.e.diff(this.s,e,t):Ct.invalid(this.invalidReason)}mapEndpoints(e){return br.fromDateTimes(e(this.s),e(this.e))}}class Bh{static hasDST(e=Wr.defaultZone){const t=st.now().setZone(e).set({month:12});return!e.isUniversal&&t.offset!==t.set({month:6}).offset}static isValidIANAZone(e){return qs.isValidZone(e)}static normalizeZone(e){return ya(e,Wr.defaultZone)}static months(e="long",{locale:t=null,numberingSystem:n=null,locObj:i=null,outputCalendar:s="gregory"}={}){return(i||yr.create(t,n,s)).months(e)}static monthsFormat(e="long",{locale:t=null,numberingSystem:n=null,locObj:i=null,outputCalendar:s="gregory"}={}){return(i||yr.create(t,n,s)).months(e,!0)}static weekdays(e="long",{locale:t=null,numberingSystem:n=null,locObj:i=null}={}){return(i||yr.create(t,n,null)).weekdays(e)}static weekdaysFormat(e="long",{locale:t=null,numberingSystem:n=null,locObj:i=null}={}){return(i||yr.create(t,n,null)).weekdays(e,!0)}static meridiems({locale:e=null}={}){return yr.create(e).meridiems()}static eras(e="short",{locale:t=null}={}){return yr.create(t,null,"gregory").eras(e)}static features(){return{relative:lk()}}}function Qv(r,e){const t=i=>i.toUTC(0,{keepLocalTime:!0}).startOf("day").valueOf(),n=t(e)-t(r);return Math.floor(Ct.fromMillis(n).as("days"))}function TR(r,e,t){const n=[["years",(o,l)=>l.year-o.year],["quarters",(o,l)=>l.quarter-o.quarter],["months",(o,l)=>l.month-o.month+(l.year-o.year)*12],["weeks",(o,l)=>{const f=Qv(o,l);return(f-f%7)/7}],["days",Qv]],i={};let s,a;for(const[o,l]of n)if(t.indexOf(o)>=0){s=o;let f=l(r,e);a=r.plus({[o]:f}),a>e?(r=r.plus({[o]:f-1}),f-=1):r=a,i[o]=f}return[r,i,a,s]}function CR(r,e,t,n){let[i,s,a,o]=TR(r,e,t);const l=e-i,f=t.filter(h=>["hours","minutes","seconds","milliseconds"].indexOf(h)>=0);f.length===0&&(a<e&&(a=i.plus({[o]:1})),a!==i&&(s[o]=(s[o]||0)+l/(a-i)));const c=Ct.fromObject(s,n);return f.length>0?Ct.fromMillis(l,n).shiftTo(...f).plus(c):c}const hO={arab:"[-]",arabext:"[-]",bali:"[-]",beng:"[-]",deva:"[-]",fullwide:"[-]",gujr:"[-]",hanidec:"[|||||||||]",khmr:"[-]",knda:"[-]",laoo:"[-]",limb:"[-]",mlym:"[-]",mong:"[-]",mymr:"[-]",orya:"[-]",tamldec:"[-]",telu:"[-]",thai:"[-]",tibt:"[-]",latn:"\\d"},Fv={arab:[1632,1641],arabext:[1776,1785],bali:[6992,7001],beng:[2534,2543],deva:[2406,2415],fullwide:[65296,65303],gujr:[2790,2799],khmr:[6112,6121],knda:[3302,3311],laoo:[3792,3801],limb:[6470,6479],mlym:[3430,3439],mong:[6160,6169],mymr:[4160,4169],orya:[2918,2927],tamldec:[3046,3055],telu:[3174,3183],thai:[3664,3673],tibt:[3872,3881]},AR=hO.hanidec.replace(/[\[|\]]/g,"").split("");function ER(r){let e=parseInt(r,10);if(isNaN(e)){e="";for(let t=0;t<r.length;t++){const n=r.charCodeAt(t);if(r[t].search(hO.hanidec)!==-1)e+=AR.indexOf(r[t]);else for(const i in Fv){const[s,a]=Fv[i];n>=s&&n<=a&&(e+=n-s)}}return parseInt(e,10)}else return e}function Ni({numberingSystem:r},e=""){return new RegExp(`${hO[r||"latn"]}${e}`)}const PR="missing Intl.DateTimeFormat.formatToParts support";function Mt(r,e=t=>t){return{regex:r,deser:([t])=>e(ER(t))}}const RR="",Tk=`[ ${RR}]`,Ck=new RegExp(Tk,"g");function QR(r){return r.replace(/\./g,"\\.?").replace(Ck,Tk)}function $v(r){return r.replace(/\./g,"").replace(Ck," ").toLowerCase()}function Di(r,e){return r===null?null:{regex:RegExp(r.map(QR).join("|")),deser:([t])=>r.findIndex(n=>$v(t)===$v(n))+e}}function Nv(r,e){return{regex:r,deser:([,t,n])=>y0(t,n),groups:e}}function sp(r){return{regex:r,deser:([e])=>e}}function FR(r){return r.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function $R(r,e){const t=Ni(e),n=Ni(e,"{2}"),i=Ni(e,"{3}"),s=Ni(e,"{4}"),a=Ni(e,"{6}"),o=Ni(e,"{1,2}"),l=Ni(e,"{1,3}"),f=Ni(e,"{1,6}"),c=Ni(e,"{1,9}"),h=Ni(e,"{2,4}"),u=Ni(e,"{4,6}"),d=g=>({regex:RegExp(FR(g.val)),deser:([v])=>v,literal:!0}),m=(g=>{if(r.literal)return d(g);switch(g.val){case"G":return Di(e.eras("short",!1),0);case"GG":return Di(e.eras("long",!1),0);case"y":return Mt(f);case"yy":return Mt(h,$m);case"yyyy":return Mt(s);case"yyyyy":return Mt(u);case"yyyyyy":return Mt(a);case"M":return Mt(o);case"MM":return Mt(n);case"MMM":return Di(e.months("short",!0,!1),1);case"MMMM":return Di(e.months("long",!0,!1),1);case"L":return Mt(o);case"LL":return Mt(n);case"LLL":return Di(e.months("short",!1,!1),1);case"LLLL":return Di(e.months("long",!1,!1),1);case"d":return Mt(o);case"dd":return Mt(n);case"o":return Mt(l);case"ooo":return Mt(i);case"HH":return Mt(n);case"H":return Mt(o);case"hh":return Mt(n);case"h":return Mt(o);case"mm":return Mt(n);case"m":return Mt(o);case"q":return Mt(o);case"qq":return Mt(n);case"s":return Mt(o);case"ss":return Mt(n);case"S":return Mt(l);case"SSS":return Mt(i);case"u":return sp(c);case"uu":return sp(o);case"uuu":return Mt(t);case"a":return Di(e.meridiems(),0);case"kkkk":return Mt(s);case"kk":return Mt(h,$m);case"W":return Mt(o);case"WW":return Mt(n);case"E":case"c":return Mt(t);case"EEE":return Di(e.weekdays("short",!1,!1),1);case"EEEE":return Di(e.weekdays("long",!1,!1),1);case"ccc":return Di(e.weekdays("short",!0,!1),1);case"cccc":return Di(e.weekdays("long",!0,!1),1);case"Z":case"ZZ":return Nv(new RegExp(`([+-]${o.source})(?::(${n.source}))?`),2);case"ZZZ":return Nv(new RegExp(`([+-]${o.source})(${n.source})?`),2);case"z":return sp(/[a-z_+-/]{1,256}?/i);default:return d(g)}})(r)||{invalidReason:PR};return m.token=r,m}const NR={year:{"2-digit":"yy",numeric:"yyyyy"},month:{numeric:"M","2-digit":"MM",short:"MMM",long:"MMMM"},day:{numeric:"d","2-digit":"dd"},weekday:{short:"EEE",long:"EEEE"},dayperiod:"a",dayPeriod:"a",hour:{numeric:"h","2-digit":"hh"},minute:{numeric:"m","2-digit":"mm"},second:{numeric:"s","2-digit":"ss"}};function DR(r,e,t){const{type:n,value:i}=r;if(n==="literal")return{literal:!0,val:i};const s=t[n];let a=NR[n];if(typeof a=="object"&&(a=a[s]),a)return{literal:!1,val:a}}function MR(r){return[`^${r.map(t=>t.regex).reduce((t,n)=>`${t}(${n.source})`,"")}$`,r]}function IR(r,e,t){const n=r.match(e);if(n){const i={};let s=1;for(const a in t)if($l(t,a)){const o=t[a],l=o.groups?o.groups+1:1;!o.literal&&o.token&&(i[o.token.val[0]]=o.deser(n.slice(s,s+l))),s+=l}return[n,i]}else return[n,{}]}function LR(r){const e=s=>{switch(s){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":case"H":return"hour";case"d":return"day";case"o":return"ordinal";case"L":case"M":return"month";case"y":return"year";case"E":case"c":return"weekday";case"W":return"weekNumber";case"k":return"weekYear";case"q":return"quarter";default:return null}};let t=null,n;return kt(r.z)||(t=qs.create(r.z)),kt(r.Z)||(t||(t=new Fn(r.Z)),n=r.Z),kt(r.q)||(r.M=(r.q-1)*3+1),kt(r.h)||(r.h<12&&r.a===1?r.h+=12:r.h===12&&r.a===0&&(r.h=0)),r.G===0&&r.y&&(r.y=-r.y),kt(r.u)||(r.S=iO(r.u)),[Object.keys(r).reduce((s,a)=>{const o=e(a);return o&&(s[o]=r[a]),s},{}),t,n]}let ap=null;function BR(){return ap||(ap=st.fromMillis(1555555555555)),ap}function ZR(r,e){if(r.literal)return r;const t=Vn.macroTokenToFormatOpts(r.val);if(!t)return r;const s=Vn.create(e,t).formatDateTimeParts(BR()).map(a=>DR(a,e,t));return s.includes(void 0)?r:s}function WR(r,e){return Array.prototype.concat(...r.map(t=>ZR(t,e)))}function Ak(r,e,t){const n=WR(Vn.parseFormat(t),r),i=n.map(a=>$R(a,r)),s=i.find(a=>a.invalidReason);if(s)return{input:e,tokens:n,invalidReason:s.invalidReason};{const[a,o]=MR(i),l=RegExp(a,"i"),[f,c]=IR(e,l,o),[h,u,d]=c?LR(c):[null,null,void 0];if($l(c,"a")&&$l(c,"H"))throw new If("Can't include meridiem when specifying 24-hour format");return{input:e,tokens:n,regex:l,rawMatches:f,matches:c,result:h,zone:u,specificOffset:d}}}function UR(r,e,t){const{result:n,zone:i,specificOffset:s,invalidReason:a}=Ak(r,e,t);return[n,i,s,a]}const Ek=[0,31,59,90,120,151,181,212,243,273,304,334],Pk=[0,31,60,91,121,152,182,213,244,274,305,335];function _i(r,e){return new Li("unit out of range",`you specified ${e} (of type ${typeof e}) as a ${r}, which is invalid`)}function Rk(r,e,t){const n=new Date(Date.UTC(r,e-1,t));r<100&&r>=0&&n.setUTCFullYear(n.getUTCFullYear()-1900);const i=n.getUTCDay();return i===0?7:i}function Qk(r,e,t){return t+(dh(r)?Pk:Ek)[e-1]}function Fk(r,e){const t=dh(r)?Pk:Ek,n=t.findIndex(s=>s<e),i=e-t[n];return{month:n+1,day:i}}function Lm(r){const{year:e,month:t,day:n}=r,i=Qk(e,t,n),s=Rk(e,t,n);let a=Math.floor((i-s+10)/7),o;return a<1?(o=e-1,a=Od(o)):a>Od(e)?(o=e+1,a=1):o=e,{weekYear:o,weekNumber:a,weekday:s,...w0(r)}}function Dv(r){const{weekYear:e,weekNumber:t,weekday:n}=r,i=Rk(e,1,4),s=oc(e);let a=t*7+n-i-3,o;a<1?(o=e-1,a+=oc(o)):a>s?(o=e+1,a-=oc(e)):o=e;const{month:l,day:f}=Fk(o,a);return{year:o,month:l,day:f,...w0(r)}}function op(r){const{year:e,month:t,day:n}=r,i=Qk(e,t,n);return{year:e,ordinal:i,...w0(r)}}function Mv(r){const{year:e,ordinal:t}=r,{month:n,day:i}=Fk(e,t);return{year:e,month:n,day:i,...w0(r)}}function XR(r){const e=v0(r.weekYear),t=Zs(r.weekNumber,1,Od(r.weekYear)),n=Zs(r.weekday,1,7);return e?t?n?!1:_i("weekday",r.weekday):_i("week",r.week):_i("weekYear",r.weekYear)}function VR(r){const e=v0(r.year),t=Zs(r.ordinal,1,oc(r.year));return e?t?!1:_i("ordinal",r.ordinal):_i("year",r.year)}function $k(r){const e=v0(r.year),t=Zs(r.month,1,12),n=Zs(r.day,1,gd(r.year,r.month));return e?t?n?!1:_i("day",r.day):_i("month",r.month):_i("year",r.year)}function Nk(r){const{hour:e,minute:t,second:n,millisecond:i}=r,s=Zs(e,0,23)||e===24&&t===0&&n===0&&i===0,a=Zs(t,0,59),o=Zs(n,0,59),l=Zs(i,0,999);return s?a?o?l?!1:_i("millisecond",i):_i("second",n):_i("minute",t):_i("hour",e)}const lp="Invalid DateTime",qR=864e13;function Zh(r){return new Li("unsupported zone",`the zone "${r.name}" is not supported`)}function fp(r){return r.weekData===null&&(r.weekData=Lm(r.c)),r.weekData}function wf(r,e){const t={ts:r.ts,zone:r.zone,c:r.c,o:r.o,loc:r.loc,invalid:r.invalid};return new st({...t,...e,old:t})}function Dk(r,e,t){let n=r-e*60*1e3;const i=t.offset(n);if(e===i)return[n,e];n-=(i-e)*60*1e3;const s=t.offset(n);return i===s?[n,i]:[r-Math.min(i,s)*60*1e3,Math.max(i,s)]}function Iv(r,e){r+=e*60*1e3;const t=new Date(r);return{year:t.getUTCFullYear(),month:t.getUTCMonth()+1,day:t.getUTCDate(),hour:t.getUTCHours(),minute:t.getUTCMinutes(),second:t.getUTCSeconds(),millisecond:t.getUTCMilliseconds()}}function $u(r,e,t){return Dk(aO(r),e,t)}function Lv(r,e){const t=r.o,n=r.c.year+Math.trunc(e.years),i=r.c.month+Math.trunc(e.months)+Math.trunc(e.quarters)*3,s={...r.c,year:n,month:i,day:Math.min(r.c.day,gd(n,i))+Math.trunc(e.days)+Math.trunc(e.weeks)*7},a=Ct.fromObject({years:e.years-Math.trunc(e.years),quarters:e.quarters-Math.trunc(e.quarters),months:e.months-Math.trunc(e.months),weeks:e.weeks-Math.trunc(e.weeks),days:e.days-Math.trunc(e.days),hours:e.hours,minutes:e.minutes,seconds:e.seconds,milliseconds:e.milliseconds}).as("milliseconds"),o=aO(s);let[l,f]=Dk(o,t,r.zone);return a!==0&&(l+=a,f=r.zone.offset(l)),{ts:l,o:f}}function bf(r,e,t,n,i,s){const{setZone:a,zone:o}=t;if(r&&Object.keys(r).length!==0){const l=e||o,f=st.fromObject(r,{...t,zone:l,specificOffset:s});return a?f:f.setZone(o)}else return st.invalid(new Li("unparsable",`the input "${i}" can't be parsed as ${n}`))}function Wh(r,e,t=!0){return r.isValid?Vn.create(yr.create("en-US"),{allowZ:t,forceSimple:!0}).formatDateTimeFromString(r,e):null}function cp(r,e){const t=r.c.year>9999||r.c.year<0;let n="";return t&&r.c.year>=0&&(n+="+"),n+=Ir(r.c.year,t?6:4),e?(n+="-",n+=Ir(r.c.month),n+="-",n+=Ir(r.c.day)):(n+=Ir(r.c.month),n+=Ir(r.c.day)),n}function Bv(r,e,t,n,i,s){let a=Ir(r.c.hour);return e?(a+=":",a+=Ir(r.c.minute),(r.c.second!==0||!t)&&(a+=":")):a+=Ir(r.c.minute),(r.c.second!==0||!t)&&(a+=Ir(r.c.second),(r.c.millisecond!==0||!n)&&(a+=".",a+=Ir(r.c.millisecond,3))),i&&(r.isOffsetFixed&&r.offset===0&&!s?a+="Z":r.o<0?(a+="-",a+=Ir(Math.trunc(-r.o/60)),a+=":",a+=Ir(Math.trunc(-r.o%60))):(a+="+",a+=Ir(Math.trunc(r.o/60)),a+=":",a+=Ir(Math.trunc(r.o%60)))),s&&(a+="["+r.zone.ianaName+"]"),a}const Mk={month:1,day:1,hour:0,minute:0,second:0,millisecond:0},jR={weekNumber:1,weekday:1,hour:0,minute:0,second:0,millisecond:0},zR={ordinal:1,hour:0,minute:0,second:0,millisecond:0},Ik=["year","month","day","hour","minute","second","millisecond"],GR=["weekYear","weekNumber","weekday","hour","minute","second","millisecond"],HR=["year","ordinal","hour","minute","second","millisecond"];function Zv(r){const e={year:"year",years:"year",month:"month",months:"month",day:"day",days:"day",hour:"hour",hours:"hour",minute:"minute",minutes:"minute",quarter:"quarter",quarters:"quarter",second:"second",seconds:"second",millisecond:"millisecond",milliseconds:"millisecond",weekday:"weekday",weekdays:"weekday",weeknumber:"weekNumber",weeksnumber:"weekNumber",weeknumbers:"weekNumber",weekyear:"weekYear",weekyears:"weekYear",ordinal:"ordinal"}[r.toLowerCase()];if(!e)throw new W2(r);return e}function Wv(r,e){const t=ya(e.zone,Wr.defaultZone),n=yr.fromObject(e),i=Wr.now();let s,a;if(kt(r.year))s=i;else{for(const f of Ik)kt(r[f])&&(r[f]=Mk[f]);const o=$k(r)||Nk(r);if(o)return st.invalid(o);const l=t.offset(i);[s,a]=$u(r,l,t)}return new st({ts:s,zone:t,loc:n,o:a})}function Uv(r,e,t){const n=kt(t.round)?!0:t.round,i=(a,o)=>(a=sO(a,n||t.calendary?0:2,!0),e.loc.clone(t).relFormatter(t).format(a,o)),s=a=>t.calendary?e.hasSame(r,a)?0:e.startOf(a).diff(r.startOf(a),a).get(a):e.diff(r,a).get(a);if(t.unit)return i(s(t.unit),t.unit);for(const a of t.units){const o=s(a);if(Math.abs(o)>=1)return i(o,a)}return i(r>e?-0:0,t.units[t.units.length-1])}function Xv(r){let e={},t;return r.length>0&&typeof r[r.length-1]=="object"?(e=r[r.length-1],t=Array.from(r).slice(0,r.length-1)):t=Array.from(r),[e,t]}class st{constructor(e){const t=e.zone||Wr.defaultZone;let n=e.invalid||(Number.isNaN(e.ts)?new Li("invalid input"):null)||(t.isValid?null:Zh(t));this.ts=kt(e.ts)?Wr.now():e.ts;let i=null,s=null;if(!n)if(e.old&&e.old.ts===this.ts&&e.old.zone.equals(t))[i,s]=[e.old.c,e.old.o];else{const o=t.offset(this.ts);i=Iv(this.ts,o),n=Number.isNaN(i.year)?new Li("invalid input"):null,i=n?null:i,s=n?null:o}this._zone=t,this.loc=e.loc||yr.create(),this.invalid=n,this.weekData=null,this.c=i,this.o=s,this.isLuxonDateTime=!0}static now(){return new st({})}static local(){const[e,t]=Xv(arguments),[n,i,s,a,o,l,f]=t;return Wv({year:n,month:i,day:s,hour:a,minute:o,second:l,millisecond:f},e)}static utc(){const[e,t]=Xv(arguments),[n,i,s,a,o,l,f]=t;return e.zone=Fn.utcInstance,Wv({year:n,month:i,day:s,hour:a,minute:o,second:l,millisecond:f},e)}static fromJSDate(e,t={}){const n=n5(e)?e.valueOf():NaN;if(Number.isNaN(n))return st.invalid("invalid input");const i=ya(t.zone,Wr.defaultZone);return i.isValid?new st({ts:n,zone:i,loc:yr.fromObject(t)}):st.invalid(Zh(i))}static fromMillis(e,t={}){if(Oo(e))return e<-864e13||e>qR?st.invalid("Timestamp out of range"):new st({ts:e,zone:ya(t.zone,Wr.defaultZone),loc:yr.fromObject(t)});throw new wi(`fromMillis requires a numerical input, but received a ${typeof e} with value ${e}`)}static fromSeconds(e,t={}){if(Oo(e))return new st({ts:e*1e3,zone:ya(t.zone,Wr.defaultZone),loc:yr.fromObject(t)});throw new wi("fromSeconds requires a numerical input")}static fromObject(e,t={}){e=e||{};const n=ya(t.zone,Wr.defaultZone);if(!n.isValid)return st.invalid(Zh(n));const i=Wr.now(),s=kt(t.specificOffset)?n.offset(i):t.specificOffset,a=xd(e,Zv),o=!kt(a.ordinal),l=!kt(a.year),f=!kt(a.month)||!kt(a.day),c=l||f,h=a.weekYear||a.weekNumber,u=yr.fromObject(t);if((c||o)&&h)throw new If("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(f&&o)throw new If("Can't mix ordinal dates with month/day");const d=h||a.weekday&&!c;let p,m,g=Iv(i,s);d?(p=GR,m=jR,g=Lm(g)):o?(p=HR,m=zR,g=op(g)):(p=Ik,m=Mk);let v=!1;for(const T of p){const k=a[T];kt(k)?v?a[T]=m[T]:a[T]=g[T]:v=!0}const w=d?XR(a):o?VR(a):$k(a),x=w||Nk(a);if(x)return st.invalid(x);const S=d?Dv(a):o?Mv(a):a,[y,b]=$u(S,s,n),O=new st({ts:y,zone:n,o:b,loc:u});return a.weekday&&c&&e.weekday!==O.weekday?st.invalid("mismatched weekday",`you can't specify both a weekday of ${a.weekday} and a date of ${O.toISO()}`):O}static fromISO(e,t={}){const[n,i]=fR(e);return bf(n,i,t,"ISO 8601",e)}static fromRFC2822(e,t={}){const[n,i]=cR(e);return bf(n,i,t,"RFC 2822",e)}static fromHTTP(e,t={}){const[n,i]=hR(e);return bf(n,i,t,"HTTP",t)}static fromFormat(e,t,n={}){if(kt(e)||kt(t))throw new wi("fromFormat requires an input string and a format");const{locale:i=null,numberingSystem:s=null}=n,a=yr.fromOpts({locale:i,numberingSystem:s,defaultToEN:!0}),[o,l,f,c]=UR(a,e,t);return c?st.invalid(c):bf(o,l,n,`format ${t}`,e,f)}static fromString(e,t,n={}){return st.fromFormat(e,t,n)}static fromSQL(e,t={}){const[n,i]=xR(e);return bf(n,i,t,"SQL",e)}static invalid(e,t=null){if(!e)throw new wi("need to specify a reason the DateTime is invalid");const n=e instanceof Li?e:new Li(e,t);if(Wr.throwOnInvalid)throw new Y3(n);return new st({invalid:n})}static isDateTime(e){return e&&e.isLuxonDateTime||!1}get(e){return this[e]}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}get outputCalendar(){return this.isValid?this.loc.outputCalendar:null}get zone(){return this._zone}get zoneName(){return this.isValid?this.zone.name:null}get year(){return this.isValid?this.c.year:NaN}get quarter(){return this.isValid?Math.ceil(this.c.month/3):NaN}get month(){return this.isValid?this.c.month:NaN}get day(){return this.isValid?this.c.day:NaN}get hour(){return this.isValid?this.c.hour:NaN}get minute(){return this.isValid?this.c.minute:NaN}get second(){return this.isValid?this.c.second:NaN}get millisecond(){return this.isValid?this.c.millisecond:NaN}get weekYear(){return this.isValid?fp(this).weekYear:NaN}get weekNumber(){return this.isValid?fp(this).weekNumber:NaN}get weekday(){return this.isValid?fp(this).weekday:NaN}get ordinal(){return this.isValid?op(this.c).ordinal:NaN}get monthShort(){return this.isValid?Bh.months("short",{locObj:this.loc})[this.month-1]:null}get monthLong(){return this.isValid?Bh.months("long",{locObj:this.loc})[this.month-1]:null}get weekdayShort(){return this.isValid?Bh.weekdays("short",{locObj:this.loc})[this.weekday-1]:null}get weekdayLong(){return this.isValid?Bh.weekdays("long",{locObj:this.loc})[this.weekday-1]:null}get offset(){return this.isValid?+this.o:NaN}get offsetNameShort(){return this.isValid?this.zone.offsetName(this.ts,{format:"short",locale:this.locale}):null}get offsetNameLong(){return this.isValid?this.zone.offsetName(this.ts,{format:"long",locale:this.locale}):null}get isOffsetFixed(){return this.isValid?this.zone.isUniversal:null}get isInDST(){return this.isOffsetFixed?!1:this.offset>this.set({month:1,day:1}).offset||this.offset>this.set({month:5}).offset}get isInLeapYear(){return dh(this.year)}get daysInMonth(){return gd(this.year,this.month)}get daysInYear(){return this.isValid?oc(this.year):NaN}get weeksInWeekYear(){return this.isValid?Od(this.weekYear):NaN}resolvedLocaleOptions(e={}){const{locale:t,numberingSystem:n,calendar:i}=Vn.create(this.loc.clone(e),e).resolvedOptions(this);return{locale:t,numberingSystem:n,outputCalendar:i}}toUTC(e=0,t={}){return this.setZone(Fn.instance(e),t)}toLocal(){return this.setZone(Wr.defaultZone)}setZone(e,{keepLocalTime:t=!1,keepCalendarTime:n=!1}={}){if(e=ya(e,Wr.defaultZone),e.equals(this.zone))return this;if(e.isValid){let i=this.ts;if(t||n){const s=e.offset(this.ts),a=this.toObject();[i]=$u(a,s,e)}return wf(this,{ts:i,zone:e})}else return st.invalid(Zh(e))}reconfigure({locale:e,numberingSystem:t,outputCalendar:n}={}){const i=this.loc.clone({locale:e,numberingSystem:t,outputCalendar:n});return wf(this,{loc:i})}setLocale(e){return this.reconfigure({locale:e})}set(e){if(!this.isValid)return this;const t=xd(e,Zv),n=!kt(t.weekYear)||!kt(t.weekNumber)||!kt(t.weekday),i=!kt(t.ordinal),s=!kt(t.year),a=!kt(t.month)||!kt(t.day),o=s||a,l=t.weekYear||t.weekNumber;if((o||i)&&l)throw new If("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(a&&i)throw new If("Can't mix ordinal dates with month/day");let f;n?f=Dv({...Lm(this.c),...t}):kt(t.ordinal)?(f={...this.toObject(),...t},kt(t.day)&&(f.day=Math.min(gd(f.year,f.month),f.day))):f=Mv({...op(this.c),...t});const[c,h]=$u(f,this.o,this.zone);return wf(this,{ts:c,o:h})}plus(e){if(!this.isValid)return this;const t=Ct.fromDurationLike(e);return wf(this,Lv(this,t))}minus(e){if(!this.isValid)return this;const t=Ct.fromDurationLike(e).negate();return wf(this,Lv(this,t))}startOf(e){if(!this.isValid)return this;const t={},n=Ct.normalizeUnit(e);switch(n){case"years":t.month=1;case"quarters":case"months":t.day=1;case"weeks":case"days":t.hour=0;case"hours":t.minute=0;case"minutes":t.second=0;case"seconds":t.millisecond=0;break}if(n==="weeks"&&(t.weekday=1),n==="quarters"){const i=Math.ceil(this.month/3);t.month=(i-1)*3+1}return this.set(t)}endOf(e){return this.isValid?this.plus({[e]:1}).startOf(e).minus(1):this}toFormat(e,t={}){return this.isValid?Vn.create(this.loc.redefaultToEN(t)).formatDateTimeFromString(this,e):lp}toLocaleString(e=Fm,t={}){return this.isValid?Vn.create(this.loc.clone(t),e).formatDateTime(this):lp}toLocaleParts(e={}){return this.isValid?Vn.create(this.loc.clone(e),e).formatDateTimeParts(this):[]}toISO({format:e="extended",suppressSeconds:t=!1,suppressMilliseconds:n=!1,includeOffset:i=!0,extendedZone:s=!1}={}){if(!this.isValid)return null;const a=e==="extended";let o=cp(this,a);return o+="T",o+=Bv(this,a,t,n,i,s),o}toISODate({format:e="extended"}={}){return this.isValid?cp(this,e==="extended"):null}toISOWeekDate(){return Wh(this,"kkkk-'W'WW-c")}toISOTime({suppressMilliseconds:e=!1,suppressSeconds:t=!1,includeOffset:n=!0,includePrefix:i=!1,extendedZone:s=!1,format:a="extended"}={}){return this.isValid?(i?"T":"")+Bv(this,a==="extended",t,e,n,s):null}toRFC2822(){return Wh(this,"EEE, dd LLL yyyy HH:mm:ss ZZZ",!1)}toHTTP(){return Wh(this.toUTC(),"EEE, dd LLL yyyy HH:mm:ss 'GMT'")}toSQLDate(){return this.isValid?cp(this,!0):null}toSQLTime({includeOffset:e=!0,includeZone:t=!1,includeOffsetSpace:n=!0}={}){let i="HH:mm:ss.SSS";return(t||e)&&(n&&(i+=" "),t?i+="z":e&&(i+="ZZ")),Wh(this,i,!0)}toSQL(e={}){return this.isValid?`${this.toSQLDate()} ${this.toSQLTime(e)}`:null}toString(){return this.isValid?this.toISO():lp}valueOf(){return this.toMillis()}toMillis(){return this.isValid?this.ts:NaN}toSeconds(){return this.isValid?this.ts/1e3:NaN}toUnixInteger(){return this.isValid?Math.floor(this.ts/1e3):NaN}toJSON(){return this.toISO()}toBSON(){return this.toJSDate()}toObject(e={}){if(!this.isValid)return{};const t={...this.c};return e.includeConfig&&(t.outputCalendar=this.outputCalendar,t.numberingSystem=this.loc.numberingSystem,t.locale=this.loc.locale),t}toJSDate(){return new Date(this.isValid?this.ts:NaN)}diff(e,t="milliseconds",n={}){if(!this.isValid||!e.isValid)return Ct.invalid("created by diffing an invalid DateTime");const i={locale:this.locale,numberingSystem:this.numberingSystem,...n},s=i5(t).map(Ct.normalizeUnit),a=e.valueOf()>this.valueOf(),o=a?this:e,l=a?e:this,f=CR(o,l,s,i);return a?f.negate():f}diffNow(e="milliseconds",t={}){return this.diff(st.now(),e,t)}until(e){return this.isValid?br.fromDateTimes(this,e):this}hasSame(e,t){if(!this.isValid)return!1;const n=e.valueOf(),i=this.setZone(e.zone,{keepLocalTime:!0});return i.startOf(t)<=n&&n<=i.endOf(t)}equals(e){return this.isValid&&e.isValid&&this.valueOf()===e.valueOf()&&this.zone.equals(e.zone)&&this.loc.equals(e.loc)}toRelative(e={}){if(!this.isValid)return null;const t=e.base||st.fromObject({},{zone:this.zone}),n=e.padding?this<t?-e.padding:e.padding:0;let i=["years","months","days","hours","minutes","seconds"],s=e.unit;return Array.isArray(e.unit)&&(i=e.unit,s=void 0),Uv(t,this.plus(n),{...e,numeric:"always",units:i,unit:s})}toRelativeCalendar(e={}){return this.isValid?Uv(e.base||st.fromObject({},{zone:this.zone}),this,{...e,numeric:"auto",units:["years","months","days"],calendary:!0}):null}static min(...e){if(!e.every(st.isDateTime))throw new wi("min requires all arguments be DateTimes");return bv(e,t=>t.valueOf(),Math.min)}static max(...e){if(!e.every(st.isDateTime))throw new wi("max requires all arguments be DateTimes");return bv(e,t=>t.valueOf(),Math.max)}static fromFormatExplain(e,t,n={}){const{locale:i=null,numberingSystem:s=null}=n,a=yr.fromOpts({locale:i,numberingSystem:s,defaultToEN:!0});return Ak(a,e,t)}static fromStringExplain(e,t,n={}){return st.fromFormatExplain(e,t,n)}static get DATE_SHORT(){return Fm}static get DATE_MED(){return U2}static get DATE_MED_WITH_WEEKDAY(){return e5}static get DATE_FULL(){return X2}static get DATE_HUGE(){return V2}static get TIME_SIMPLE(){return q2}static get TIME_WITH_SECONDS(){return j2}static get TIME_WITH_SHORT_OFFSET(){return z2}static get TIME_WITH_LONG_OFFSET(){return G2}static get TIME_24_SIMPLE(){return H2}static get TIME_24_WITH_SECONDS(){return Y2}static get TIME_24_WITH_SHORT_OFFSET(){return K2}static get TIME_24_WITH_LONG_OFFSET(){return J2}static get DATETIME_SHORT(){return ek}static get DATETIME_SHORT_WITH_SECONDS(){return tk}static get DATETIME_MED(){return rk}static get DATETIME_MED_WITH_SECONDS(){return nk}static get DATETIME_MED_WITH_WEEKDAY(){return t5}static get DATETIME_FULL(){return ik}static get DATETIME_FULL_WITH_SECONDS(){return sk}static get DATETIME_HUGE(){return ak}static get DATETIME_HUGE_WITH_SECONDS(){return ok}}function _f(r){if(st.isDateTime(r))return r;if(r&&r.valueOf&&Oo(r.valueOf()))return st.fromJSDate(r);if(r&&typeof r=="object")return st.fromObject(r);throw new wi(`Unknown datetime argument: ${r}, of type ${typeof r}`)}var YR=J('<span class="icon-text" title="Incorrect date"><span class="icon"><i class="fas fa-exclamation-triangle"></i></span> <span> </span></span>'),KR=J("<td><!></td>");function JR(r,e){Ot(e,!0);let t=me(e,"onclick_cell",3,()=>{}),n=me(e,"format",3,"yyyy-MM-dd HH:mm:ss"),i=me(e,"fromFormat",3,"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'"),s=me(e,"HighlightIsntToday",3,!1);me(e,"editInline",3,!1),me(e,"css_cell",3,"");let a=Pa(()=>s()&&st.fromISO(e.value).toFormat("yyyy-MM-dd")!==st.local().toFormat("yyyy-MM-dd")),o=Pa(l);function l(){try{return st.fromFormat(e.value,i()).toLocal().toFormat(n())}catch{return""}}var f=KR();f.__click=function(...d){var p;(p=t())==null||p.apply(this,d)};var c=R(f);{var h=d=>{var p=YR(),m=te(R(p),2),g=R(m,!0);P(m),P(p),Re(()=>Ge(g,e.value)),W(d,p)},u=d=>{var p=ms();Re(()=>Ge(p,C(o))),W(d,p)};se(c,d=>{C(a)?d(h):d(u,!1)})}P(f),Re(()=>N2(f,"has-text-danger",C(a))),W(r,f),xt()}Or(["click"]);var eQ=J('<li class="svelte-1p0q13"><!></li>'),tQ=J('<li class="svelte-1p0q13"><!></li>'),rQ=J('<ul class="svelte-1p0q13"><!></ul>'),nQ=J("<details><summary><b> </b> </summary> <!></details>"),iQ=J('<li style="list-style: disc; margin: 0.2em 0 0 1em;" class="svelte-1p0q13"><b> </b> </li>');function Bm(r,e){let t=me(e,"key",3,"");var n=Ae(),i=ye(n);{var s=o=>{var l=nQ(),f=R(l),c=R(f),h=R(c,!0);P(c);var u=te(c);Re(()=>Ge(u,` ${(typeof e.value!="object"||e.value===null?String(e.value):"")??""}`)),P(f);var d=te(f,2);{var p=g=>{var v=rQ(),w=R(v);{var x=y=>{var b=Ae(),O=ye(b);Pr(O,17,()=>e.value,Lr,(T,k,Q)=>{var A=eQ(),_=R(A);Bm(_,{key:`[${Q}]`,get value(){return C(k)}}),P(A),W(T,A)}),W(y,b)},S=y=>{var b=Ae(),O=ye(b);Pr(O,17,()=>Object.entries(e.value),Lr,(T,k)=>{let Q=()=>C(k)[0],A=()=>C(k)[1];var _=tQ(),N=R(_);Bm(N,{get key(){return Q()},get value(){return A()}}),P(_),W(T,_)}),W(y,b)};se(w,y=>{Array.isArray(e.value)?y(x):y(S,!1)})}P(v),W(g,v)},m=g=>{var v=ms("hhhh");W(g,v)};se(d,g=>{typeof e.value=="object"&&e.value!==null?g(p):g(m,!1)})}P(l),Re(()=>Ge(h,t())),W(o,l)},a=o=>{var l=iQ(),f=R(l),c=R(f);P(f);var h=te(f);P(l),Re(()=>{Ge(c,`${t()??""}:`),Ge(h,` ${e.value??""}`)}),W(o,l)};se(i,o=>{typeof e.value=="object"&&e.value!==null?o(s):o(a,!1)})}W(r,n)}var sQ=J('<td><details class="left_space"><summary><b>root</b></summary> <ul class="svelte-il86sa"></ul></details></td>');function aQ(r,e){let t=me(e,"onclick_cell",3,()=>{}),n=me(e,"css_cell",3,"");var i=sQ();i.__click=function(...o){var l;(l=t())==null||l.apply(this,o)};var s=R(i),a=te(R(s),2);Pr(a,21,()=>Object.entries(e.value),Lr,(o,l)=>{let f=()=>C(l)[0],c=()=>C(l)[1];Bm(o,{get key(){return f()},get value(){return c()}})}),P(a),P(s),P(i),Re(()=>ft(i,oi(n()),"svelte-il86sa")),W(r,i)}Or(["click"]);var oQ=J('<input class="input is-small" type="number" placeholder="Input">'),lQ=J('<div class="text_end svelte-1ea09en"> </div>'),fQ=J("<td><!></td>"),cQ=J('<input class="input is-small" type="text" placeholder="Input">'),hQ=J("<div> </div>"),uQ=J("<td><!></td>"),dQ=J("<td><span> </span></td>");function Zm(r,e){let t=me(e,"value",15),n=me(e,"row",15),i=me(e,"editInline",3,!1);var s=Ae(),a=ye(s);{var o=f=>{aQ(f,{get value(){return t()},get editInline(){return i()},get css_cell(){return e.css_cell}})},l=f=>{var c=Ae(),h=ye(c);{var u=p=>{bc(p,{get editInline(){return i()},get css_cell(){return e.css_cell},get value(){return t()},set value(m){t(m)},get row(){return n()},set row(m){n(m)}})},d=p=>{var m=Ae(),g=ye(m);{var v=x=>{var S=fQ();S.__click=function(...T){var k;(k=e.onclickcell)==null||k.apply(this,T)};var y=R(S);{var b=T=>{var k=oQ();Et(k),Xt(k,t),W(T,k)},O=T=>{var k=lQ(),Q=R(k,!0);P(k),Re(()=>Ge(Q,t())),W(T,k)};se(y,T=>{i()?T(b):T(O,!1)})}P(S),W(x,S)},w=x=>{var S=Ae(),y=ye(S);{var b=T=>{var k=uQ();k.__click=function(...N){var U;(U=e.onclickcell)==null||U.apply(this,N)};var Q=R(k);{var A=N=>{var U=cQ();Et(U),Xt(U,t),W(N,U)},_=N=>{var U=hQ(),z=R(U,!0);P(U),Re(()=>Ge(z,t())),W(N,U)};se(Q,N=>{i()?N(A):N(_,!1)})}P(k),W(T,k)},O=T=>{var k=dQ();k.__click=function(..._){var N;(N=e.onclickcell)==null||N.apply(this,_)};var Q=R(k),A=R(Q,!0);Re(()=>Ge(A,JSON.stringify(t()))),P(Q),P(k),W(T,k)};se(y,T=>{typeof t()=="string"?T(b):T(O,!1)},!0)}W(x,S)};se(g,x=>{typeof t()=="number"||typeof t()=="bigint"?x(v):x(w,!1)},!0)}W(p,m)};se(h,p=>{typeof t()=="boolean"?p(u):p(d,!1)},!0)}W(f,c)};se(a,f=>{t()&&(typeof t()=="object"||Array.isArray(t()))?f(o):f(l,!1)})}W(r,s)}Or(["click"]);var Lk={exports:{}},wl=typeof Reflect=="object"?Reflect:null,Vv=wl&&typeof wl.apply=="function"?wl.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)},Nu;wl&&typeof wl.ownKeys=="function"?Nu=wl.ownKeys:Object.getOwnPropertySymbols?Nu=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Nu=function(e){return Object.getOwnPropertyNames(e)};function pQ(r){console&&console.warn&&console.warn(r)}var Bk=Number.isNaN||function(e){return e!==e};function jt(){jt.init.call(this)}Lk.exports=jt;Lk.exports.once=xQ;jt.EventEmitter=jt;jt.prototype._events=void 0;jt.prototype._eventsCount=0;jt.prototype._maxListeners=void 0;var qv=10;function b0(r){if(typeof r!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof r)}Object.defineProperty(jt,"defaultMaxListeners",{enumerable:!0,get:function(){return qv},set:function(r){if(typeof r!="number"||r<0||Bk(r))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+r+".");qv=r}});jt.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};jt.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||Bk(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function Zk(r){return r._maxListeners===void 0?jt.defaultMaxListeners:r._maxListeners}jt.prototype.getMaxListeners=function(){return Zk(this)};jt.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var i=e==="error",s=this._events;if(s!==void 0)i=i&&s.error===void 0;else if(!i)return!1;if(i){var a;if(t.length>0&&(a=t[0]),a instanceof Error)throw a;var o=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw o.context=a,o}var l=s[e];if(l===void 0)return!1;if(typeof l=="function")Vv(l,this,t);else for(var f=l.length,c=qk(l,f),n=0;n<f;++n)Vv(c[n],this,t);return!0};function Wk(r,e,t,n){var i,s,a;if(b0(t),s=r._events,s===void 0?(s=r._events=Object.create(null),r._eventsCount=0):(s.newListener!==void 0&&(r.emit("newListener",e,t.listener?t.listener:t),s=r._events),a=s[e]),a===void 0)a=s[e]=t,++r._eventsCount;else if(typeof a=="function"?a=s[e]=n?[t,a]:[a,t]:n?a.unshift(t):a.push(t),i=Zk(r),i>0&&a.length>i&&!a.warned){a.warned=!0;var o=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");o.name="MaxListenersExceededWarning",o.emitter=r,o.type=e,o.count=a.length,pQ(o)}return r}jt.prototype.addListener=function(e,t){return Wk(this,e,t,!1)};jt.prototype.on=jt.prototype.addListener;jt.prototype.prependListener=function(e,t){return Wk(this,e,t,!0)};function mQ(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Uk(r,e,t){var n={fired:!1,wrapFn:void 0,target:r,type:e,listener:t},i=mQ.bind(n);return i.listener=t,n.wrapFn=i,i}jt.prototype.once=function(e,t){return b0(t),this.on(e,Uk(this,e,t)),this};jt.prototype.prependOnceListener=function(e,t){return b0(t),this.prependListener(e,Uk(this,e,t)),this};jt.prototype.removeListener=function(e,t){var n,i,s,a,o;if(b0(t),i=this._events,i===void 0)return this;if(n=i[e],n===void 0)return this;if(n===t||n.listener===t)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||t));else if(typeof n!="function"){for(s=-1,a=n.length-1;a>=0;a--)if(n[a]===t||n[a].listener===t){o=n[a].listener,s=a;break}if(s<0)return this;s===0?n.shift():gQ(n,s),n.length===1&&(i[e]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",e,o||t)}return this};jt.prototype.off=jt.prototype.removeListener;jt.prototype.removeAllListeners=function(e){var t,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var s=Object.keys(n),a;for(i=0;i<s.length;++i)a=s[i],a!=="removeListener"&&this.removeAllListeners(a);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=n[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this};function Xk(r,e,t){var n=r._events;if(n===void 0)return[];var i=n[e];return i===void 0?[]:typeof i=="function"?t?[i.listener||i]:[i]:t?OQ(i):qk(i,i.length)}jt.prototype.listeners=function(e){return Xk(this,e,!0)};jt.prototype.rawListeners=function(e){return Xk(this,e,!1)};jt.listenerCount=function(r,e){return typeof r.listenerCount=="function"?r.listenerCount(e):Vk.call(r,e)};jt.prototype.listenerCount=Vk;function Vk(r){var e=this._events;if(e!==void 0){var t=e[r];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}jt.prototype.eventNames=function(){return this._eventsCount>0?Nu(this._events):[]};function qk(r,e){for(var t=new Array(e),n=0;n<e;++n)t[n]=r[n];return t}function gQ(r,e){for(;e+1<r.length;e++)r[e]=r[e+1];r.pop()}function OQ(r){for(var e=new Array(r.length),t=0;t<e.length;++t)e[t]=r[t].listener||r[t];return e}function xQ(r,e){return new Promise(function(t,n){function i(a){r.removeListener(e,s),n(a)}function s(){typeof r.removeListener=="function"&&r.removeListener("error",i),t([].slice.call(arguments))}jk(r,e,s,{once:!0}),e!=="error"&&vQ(r,i,{once:!0})})}function vQ(r,e,t){typeof r.on=="function"&&jk(r,"error",e,t)}function jk(r,e,t,n){if(typeof r.on=="function")n.once?r.once(e,t):r.on(e,t);else if(typeof r.addEventListener=="function")r.addEventListener(e,function i(s){n.once&&r.removeEventListener(e,i),t(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof r)}const yQ=Ji({});var wQ=J('<span class="slot_padding svelte-mjwhk5"><!></span>'),bQ=J('<span class="slot_padding svelte-mjwhk5"><!></span>'),_Q=J(`<nav class="nav_margin svelte-mjwhk5"><div class="columns is-multiline is-mobile"><div class="column is-full-mobile
    is-half-tablet
    is-half-desktop
    is-half-widescreen
    is-half-fullhd"><div class="container_left svelte-mjwhk5"><!></div></div> <div class="column is-full-mobile
    is-half-tablet
    is-half-desktop
    is-half-widescreen
    is-half-fullhd"><div class="container_right svelte-mjwhk5"><!></div></div></div></nav>`);function Nl(r,e){var t=_Q(),n=R(t),i=R(n),s=R(i),a=R(s);{var o=u=>{var d=Ae(),p=ye(d);Pr(p,17,()=>e.left,Lr,(m,g)=>{var v=wQ(),w=R(v);pd(w,()=>C(g)??dd),P(v),W(m,v)}),W(u,d)};se(a,u=>{Array.isArray(e.left)&&u(o)})}P(s),P(i);var l=te(i,2),f=R(l),c=R(f);{var h=u=>{var d=Ae(),p=ye(d);Pr(p,17,()=>e.right,Lr,(m,g)=>{var v=bQ(),w=R(v);pd(w,()=>C(g)??dd),P(v),W(m,v)}),W(u,d)};se(c,u=>{Array.isArray(e.right)&&u(h)})}P(f),P(l),P(n),P(t),W(r,t)}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var _c={};_c.version="0.18.5";var fi=1200,To=1252,kQ=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],uO={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},_0=function(r){kQ.indexOf(r)!=-1&&(To=uO[0]=r)};function SQ(){_0(1252)}var ki=function(r){fi=r,_0(r)};function k0(){ki(1200),SQ()}function vd(r){for(var e=[],t=0,n=r.length;t<n;++t)e[t]=r.charCodeAt(t);return e}function TQ(r){for(var e=[],t=0;t<r.length>>1;++t)e[t]=String.fromCharCode(r.charCodeAt(2*t)+(r.charCodeAt(2*t+1)<<8));return e.join("")}function zk(r){for(var e=[],t=0;t<r.length>>1;++t)e[t]=String.fromCharCode(r.charCodeAt(2*t+1)+(r.charCodeAt(2*t)<<8));return e.join("")}var ul=function(r){var e=r.charCodeAt(0),t=r.charCodeAt(1);return e==255&&t==254?TQ(r.slice(2)):e==254&&t==255?zk(r.slice(2)):e==65279?r.slice(1):r},Bf=function(e){return String.fromCharCode(e)},Wm=function(e){return String.fromCharCode(e)},St;function CQ(r){St=r,ki=function(e){fi=e,_0(e)},ul=function(e){return e.charCodeAt(0)===255&&e.charCodeAt(1)===254?St.utils.decode(1200,vd(e.slice(2))):e},Bf=function(t){return fi===1200?String.fromCharCode(t):St.utils.decode(fi,[t&255,t>>8])[0]},Wm=function(t){return St.utils.decode(To,[t])[0]},_S()}var ba="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function kc(r){for(var e="",t=0,n=0,i=0,s=0,a=0,o=0,l=0,f=0;f<r.length;)t=r.charCodeAt(f++),s=t>>2,n=r.charCodeAt(f++),a=(t&3)<<4|n>>4,i=r.charCodeAt(f++),o=(n&15)<<2|i>>6,l=i&63,isNaN(n)?o=l=64:isNaN(i)&&(l=64),e+=ba.charAt(s)+ba.charAt(a)+ba.charAt(o)+ba.charAt(l);return e}function ci(r){var e="",t=0,n=0,i=0,s=0,a=0,o=0,l=0;r=r.replace(/[^\w\+\/\=]/g,"");for(var f=0;f<r.length;)s=ba.indexOf(r.charAt(f++)),a=ba.indexOf(r.charAt(f++)),t=s<<2|a>>4,e+=String.fromCharCode(t),o=ba.indexOf(r.charAt(f++)),n=(a&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(n)),l=ba.indexOf(r.charAt(f++)),i=(o&3)<<6|l,l!==64&&(e+=String.fromCharCode(i));return e}var gt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),ta=function(){if(typeof Buffer<"u"){var r=!Buffer.from;if(!r)try{Buffer.from("foo","utf8")}catch{r=!0}return r?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function Fa(r){return gt?Buffer.alloc?Buffer.alloc(r):new Buffer(r):typeof Uint8Array<"u"?new Uint8Array(r):new Array(r)}function jv(r){return gt?Buffer.allocUnsafe?Buffer.allocUnsafe(r):new Buffer(r):typeof Uint8Array<"u"?new Uint8Array(r):new Array(r)}var ei=function(e){return gt?ta(e,"binary"):e.split("").map(function(t){return t.charCodeAt(0)&255})};function Oh(r){if(typeof ArrayBuffer>"u")return ei(r);for(var e=new ArrayBuffer(r.length),t=new Uint8Array(e),n=0;n!=r.length;++n)t[n]=r.charCodeAt(n)&255;return e}function Va(r){if(Array.isArray(r))return r.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],t=0;t<r.length;++t)e[t]=String.fromCharCode(r[t]);return e.join("")}function AQ(r){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(r)}function dO(r){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(r instanceof ArrayBuffer)return dO(new Uint8Array(r));for(var e=new Array(r.length),t=0;t<r.length;++t)e[t]=r[t];return e}var Hr=gt?function(r){return Buffer.concat(r.map(function(e){return Buffer.isBuffer(e)?e:ta(e)}))}:function(r){if(typeof Uint8Array<"u"){var e=0,t=0;for(e=0;e<r.length;++e)t+=r[e].length;var n=new Uint8Array(t),i=0;for(e=0,t=0;e<r.length;t+=i,++e)if(i=r[e].length,r[e]instanceof Uint8Array)n.set(r[e],t);else{if(typeof r[e]=="string")throw"wtf";n.set(new Uint8Array(r[e]),t)}return n}return[].concat.apply([],r.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function EQ(r){for(var e=[],t=0,n=r.length+250,i=Fa(r.length+255),s=0;s<r.length;++s){var a=r.charCodeAt(s);if(a<128)i[t++]=a;else if(a<2048)i[t++]=192|a>>6&31,i[t++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=r.charCodeAt(++s)&1023;i[t++]=240|a>>8&7,i[t++]=128|a>>2&63,i[t++]=128|o>>6&15|(a&3)<<4,i[t++]=128|o&63}else i[t++]=224|a>>12&15,i[t++]=128|a>>6&63,i[t++]=128|a&63;t>n&&(e.push(i.slice(0,t)),t=0,i=Fa(65535),n=65530)}return e.push(i.slice(0,t)),Hr(e)}var _n=/\u0000/g,Zf=/[\u0001-\u0006]/g;function bl(r){for(var e="",t=r.length-1;t>=0;)e+=r.charAt(t--);return e}function Bi(r,e){var t=""+r;return t.length>=e?t:_r("0",e-t.length)+t}function pO(r,e){var t=""+r;return t.length>=e?t:_r(" ",e-t.length)+t}function yd(r,e){var t=""+r;return t.length>=e?t:t+_r(" ",e-t.length)}function PQ(r,e){var t=""+Math.round(r);return t.length>=e?t:_r("0",e-t.length)+t}function RQ(r,e){var t=""+r;return t.length>=e?t:_r("0",e-t.length)+t}var zv=Math.pow(2,32);function rl(r,e){if(r>zv||r<-zv)return PQ(r,e);var t=Math.round(r);return RQ(t,e)}function wd(r,e){return e=e||0,r.length>=7+e&&(r.charCodeAt(e)|32)===103&&(r.charCodeAt(e+1)|32)===101&&(r.charCodeAt(e+2)|32)===110&&(r.charCodeAt(e+3)|32)===101&&(r.charCodeAt(e+4)|32)===114&&(r.charCodeAt(e+5)|32)===97&&(r.charCodeAt(e+6)|32)===108}var Gv=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],hp=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function QQ(r){return r||(r={}),r[0]="General",r[1]="0",r[2]="0.00",r[3]="#,##0",r[4]="#,##0.00",r[9]="0%",r[10]="0.00%",r[11]="0.00E+00",r[12]="# ?/?",r[13]="# ??/??",r[14]="m/d/yy",r[15]="d-mmm-yy",r[16]="d-mmm",r[17]="mmm-yy",r[18]="h:mm AM/PM",r[19]="h:mm:ss AM/PM",r[20]="h:mm",r[21]="h:mm:ss",r[22]="m/d/yy h:mm",r[37]="#,##0 ;(#,##0)",r[38]="#,##0 ;[Red](#,##0)",r[39]="#,##0.00;(#,##0.00)",r[40]="#,##0.00;[Red](#,##0.00)",r[45]="mm:ss",r[46]="[h]:mm:ss",r[47]="mmss.0",r[48]="##0.0E+0",r[49]="@",r[56]='"/ "hh""mm""ss" "',r}var et={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Hv={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},FQ={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function bd(r,e,t){for(var n=r<0?-1:1,i=r*n,s=0,a=1,o=0,l=1,f=0,c=0,h=Math.floor(i);f<e&&(h=Math.floor(i),o=h*a+s,c=h*f+l,!(i-h<5e-8));)i=1/(i-h),s=a,a=o,l=f,f=c;if(c>e&&(f>e?(c=l,o=s):(c=f,o=a)),!t)return[0,n*o,c];var u=Math.floor(n*o/c);return[u,n*o-u*c,c]}function _a(r,e,t){if(r>2958465||r<0)return null;var n=r|0,i=Math.floor(86400*(r-n)),s=0,a=[],o={D:n,T:i,u:86400*(r-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++n,++o.D)),n===60)a=t?[1317,10,29]:[1900,2,29],s=3;else if(n===0)a=t?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),a=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),n<60&&(s=(s+6)%7),t&&(s=LQ(l,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=s,o}var Gk=new Date(1899,11,31,0,0,0),$Q=Gk.getTime(),NQ=new Date(1900,2,1,0,0,0);function Hk(r,e){var t=r.getTime();return e?t-=1461*24*60*60*1e3:r>=NQ&&(t+=24*60*60*1e3),(t-($Q+(r.getTimezoneOffset()-Gk.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function mO(r){return r.indexOf(".")==-1?r:r.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function DQ(r){return r.indexOf("E")==-1?r:r.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function MQ(r){var e=r<0?12:11,t=mO(r.toFixed(12));return t.length<=e||(t=r.toPrecision(10),t.length<=e)?t:r.toExponential(5)}function IQ(r){var e=mO(r.toFixed(11));return e.length>(r<0?12:11)||e==="0"||e==="-0"?r.toPrecision(6):e}function Sc(r){var e=Math.floor(Math.log(Math.abs(r))*Math.LOG10E),t;return e>=-4&&e<=-1?t=r.toPrecision(10+e):Math.abs(e)<=9?t=MQ(r):e===10?t=r.toFixed(10).substr(0,12):t=IQ(r),mO(DQ(t.toUpperCase()))}function Co(r,e){switch(typeof r){case"string":return r;case"boolean":return r?"TRUE":"FALSE";case"number":return(r|0)===r?r.toString(10):Sc(r);case"undefined":return"";case"object":if(r==null)return"";if(r instanceof Date)return hi(14,Hk(r,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+r)}function LQ(r,e){e[0]-=581;var t=r.getDay();return r<60&&(t=(t+6)%7),t}function BQ(r,e,t,n){var i="",s=0,a=0,o=t.y,l,f=0;switch(r){case 98:o=t.y+543;case 121:switch(e.length){case 1:case 2:l=o%100,f=2;break;default:l=o%1e4,f=4;break}break;case 109:switch(e.length){case 1:case 2:l=t.m,f=e.length;break;case 3:return hp[t.m-1][1];case 5:return hp[t.m-1][0];default:return hp[t.m-1][2]}break;case 100:switch(e.length){case 1:case 2:l=t.d,f=e.length;break;case 3:return Gv[t.q][0];default:return Gv[t.q][1]}break;case 104:switch(e.length){case 1:case 2:l=1+(t.H+11)%12,f=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:l=t.H,f=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:l=t.M,f=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return t.u===0&&(e=="s"||e=="ss")?Bi(t.S,e.length):(n>=2?a=n===3?1e3:100:a=n===1?10:1,s=Math.round(a*(t.S+t.u)),s>=60*a&&(s=0),e==="s"?s===0?"0":""+s/a:(i=Bi(s,2+n),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":l=t.D*24+t.H;break;case"[m]":case"[mm]":l=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":l=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+e}f=e.length===3?1:2;break;case 101:l=o,f=1;break}var c=f>0?Bi(l,f):"";return c}function ka(r){var e=3;if(r.length<=e)return r;for(var t=r.length%e,n=r.substr(0,t);t!=r.length;t+=e)n+=(n.length>0?",":"")+r.substr(t,e);return n}var Yk=/%/g;function ZQ(r,e,t){var n=e.replace(Yk,""),i=e.length-n.length;return Us(r,n,t*Math.pow(10,2*i))+_r("%",i)}function WQ(r,e,t){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Us(r,e.substr(0,n),t/Math.pow(10,3*(e.length-n)))}function Kk(r,e){var t,n=r.indexOf("E")-r.indexOf(".")-1;if(r.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+Kk(r,-e);var i=r.indexOf(".");i===-1&&(i=r.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),t=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),t.indexOf("e")===-1){var a=Math.floor(Math.log(e)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(a-t.length+s):t+="E+"+(a-s);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,i)+"."+t.substr(2+i),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,f,c){return l+f+c.substr(0,(i+s)%i)+"."+c.substr(s)+"E"})}else t=e.toExponential(n);return r.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),r.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var Jk=/# (\?+)( ?)\/( ?)(\d+)/;function UQ(r,e,t){var n=parseInt(r[4],10),i=Math.round(e*n),s=Math.floor(i/n),a=i-s*n,o=n;return t+(s===0?"":""+s)+" "+(a===0?_r(" ",r[1].length+1+r[4].length):pO(a,r[1].length)+r[2]+"/"+r[3]+Bi(o,r[4].length))}function XQ(r,e,t){return t+(e===0?"":""+e)+_r(" ",r[1].length+2+r[4].length)}var eS=/^#*0*\.([0#]+)/,tS=/\).*[0#]/,rS=/\(###\) ###\\?-####/;function Pn(r){for(var e="",t,n=0;n!=r.length;++n)switch(t=r.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(t)}return e}function Yv(r,e){var t=Math.pow(10,e);return""+Math.round(r*t)/t}function Kv(r,e){var t=r-Math.floor(r),n=Math.pow(10,e);return e<(""+Math.round(t*n)).length?0:Math.round(t*n)}function VQ(r,e){return e<(""+Math.round((r-Math.floor(r))*Math.pow(10,e))).length?1:0}function qQ(r){return r<2147483647&&r>-2147483648?""+(r>=0?r|0:r-1|0):""+Math.floor(r)}function gi(r,e,t){if(r.charCodeAt(0)===40&&!e.match(tS)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?gi("n",n,t):"("+gi("n",n,-t)+")"}if(e.charCodeAt(e.length-1)===44)return WQ(r,e,t);if(e.indexOf("%")!==-1)return ZQ(r,e,t);if(e.indexOf("E")!==-1)return Kk(e,t);if(e.charCodeAt(0)===36)return"$"+gi(r,e.substr(e.charAt(1)==" "?2:1),t);var i,s,a,o,l=Math.abs(t),f=t<0?"-":"";if(e.match(/^00+$/))return f+rl(l,e.length);if(e.match(/^[#?]+$/))return i=rl(t,0),i==="0"&&(i=""),i.length>e.length?i:Pn(e.substr(0,e.length-i.length))+i;if(s=e.match(Jk))return UQ(s,l,f);if(e.match(/^#+0+$/))return f+rl(l,e.length-e.indexOf("0"));if(s=e.match(eS))return i=Yv(t,s[1].length).replace(/^([^\.]+)$/,"$1."+Pn(s[1])).replace(/\.$/,"."+Pn(s[1])).replace(/\.(\d*)$/,function(p,m){return"."+m+_r("0",Pn(s[1]).length-m.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return f+Yv(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return f+ka(rl(l,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+gi(r,e,-t):ka(""+(Math.floor(t)+VQ(t,s[1].length)))+"."+Bi(Kv(t,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return gi(r,e.replace(/^#,#*,/,""),t);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=bl(gi(r,e.replace(/[\\-]/g,""),t)),a=0,bl(bl(e.replace(/\\/g,"")).replace(/[0#]/g,function(p){return a<i.length?i.charAt(a++):p==="0"?"0":""}));if(e.match(rS))return i=gi(r,"##########",t),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var c="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=bd(l,Math.pow(10,a)-1,!1),i=""+f,c=Us("n",s[1],o[1]),c.charAt(c.length-1)==" "&&(c=c.substr(0,c.length-1)+"0"),i+=c+s[2]+"/"+s[3],c=yd(o[2],a),c.length<s[4].length&&(c=Pn(s[4].substr(s[4].length-c.length))+c),i+=c,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=bd(l,Math.pow(10,a)-1,!0),f+(o[0]||(o[1]?"":"0"))+" "+(o[1]?pO(o[1],a)+s[2]+"/"+s[3]+yd(o[2],a):_r(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=rl(t,0),e.length<=i.length?i:Pn(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var h=e.indexOf(".")-a,u=e.length-i.length-h;return Pn(e.substr(0,h)+i+e.substr(e.length-u))}if(s=e.match(/^00,000\.([#0]*0)$/))return a=Kv(t,s[1].length),t<0?"-"+gi(r,e,-t):ka(qQ(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?Bi(0,3-p.length):"")+p})+"."+Bi(a,s[1].length);switch(e){case"###,##0.00":return gi(r,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var d=ka(rl(l,0));return d!=="0"?f+d:"";case"###,###.00":return gi(r,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return gi(r,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function jQ(r,e,t){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Us(r,e.substr(0,n),t/Math.pow(10,3*(e.length-n)))}function zQ(r,e,t){var n=e.replace(Yk,""),i=e.length-n.length;return Us(r,n,t*Math.pow(10,2*i))+_r("%",i)}function nS(r,e){var t,n=r.indexOf("E")-r.indexOf(".")-1;if(r.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+nS(r,-e);var i=r.indexOf(".");i===-1&&(i=r.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),t=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!t.match(/[Ee]/)){var a=Math.floor(Math.log(e)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(a-t.length+s):t+="E+"+(a-s),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,f,c){return l+f+c.substr(0,(i+s)%i)+"."+c.substr(s)+"E"})}else t=e.toExponential(n);return r.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),r.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function fs(r,e,t){if(r.charCodeAt(0)===40&&!e.match(tS)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?fs("n",n,t):"("+fs("n",n,-t)+")"}if(e.charCodeAt(e.length-1)===44)return jQ(r,e,t);if(e.indexOf("%")!==-1)return zQ(r,e,t);if(e.indexOf("E")!==-1)return nS(e,t);if(e.charCodeAt(0)===36)return"$"+fs(r,e.substr(e.charAt(1)==" "?2:1),t);var i,s,a,o,l=Math.abs(t),f=t<0?"-":"";if(e.match(/^00+$/))return f+Bi(l,e.length);if(e.match(/^[#?]+$/))return i=""+t,t===0&&(i=""),i.length>e.length?i:Pn(e.substr(0,e.length-i.length))+i;if(s=e.match(Jk))return XQ(s,l,f);if(e.match(/^#+0+$/))return f+Bi(l,e.length-e.indexOf("0"));if(s=e.match(eS))return i=(""+t).replace(/^([^\.]+)$/,"$1."+Pn(s[1])).replace(/\.$/,"."+Pn(s[1])),i=i.replace(/\.(\d*)$/,function(p,m){return"."+m+_r("0",Pn(s[1]).length-m.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return f+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return f+ka(""+l);if(s=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+fs(r,e,-t):ka(""+t)+"."+_r("0",s[1].length);if(s=e.match(/^#,#*,#0/))return fs(r,e.replace(/^#,#*,/,""),t);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=bl(fs(r,e.replace(/[\\-]/g,""),t)),a=0,bl(bl(e.replace(/\\/g,"")).replace(/[0#]/g,function(p){return a<i.length?i.charAt(a++):p==="0"?"0":""}));if(e.match(rS))return i=fs(r,"##########",t),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var c="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=bd(l,Math.pow(10,a)-1,!1),i=""+f,c=Us("n",s[1],o[1]),c.charAt(c.length-1)==" "&&(c=c.substr(0,c.length-1)+"0"),i+=c+s[2]+"/"+s[3],c=yd(o[2],a),c.length<s[4].length&&(c=Pn(s[4].substr(s[4].length-c.length))+c),i+=c,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=bd(l,Math.pow(10,a)-1,!0),f+(o[0]||(o[1]?"":"0"))+" "+(o[1]?pO(o[1],a)+s[2]+"/"+s[3]+yd(o[2],a):_r(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=""+t,e.length<=i.length?i:Pn(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0]+)\.([#0]+)$/)){i=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var h=e.indexOf(".")-a,u=e.length-i.length-h;return Pn(e.substr(0,h)+i+e.substr(e.length-u))}if(s=e.match(/^00,000\.([#0]*0)$/))return t<0?"-"+fs(r,e,-t):ka(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?Bi(0,3-p.length):"")+p})+"."+Bi(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var d=ka(""+l);return d!=="0"?f+d:"";default:if(e.match(/\.[0#?]*$/))return fs(r,e.slice(0,e.lastIndexOf(".")),t)+Pn(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Us(r,e,t){return(t|0)===t?fs(r,e,t):gi(r,e,t)}function GQ(r){for(var e=[],t=!1,n=0,i=0;n<r.length;++n)switch(r.charCodeAt(n)){case 34:t=!t;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=r.substr(i,n-i),i=n+1}if(e[e.length]=r.substr(i),t===!0)throw new Error("Format |"+r+"| unterminated string ");return e}var iS=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Bo(r){for(var e=0,t="",n="";e<r.length;)switch(t=r.charAt(e)){case"G":wd(r,e)&&(e+=6),e++;break;case'"':for(;r.charCodeAt(++e)!==34&&e<r.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(r.charAt(e+1)==="1"||r.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(r.substr(e,3).toUpperCase()==="A/P"||r.substr(e,5).toUpperCase()==="AM/PM"||r.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=t;r.charAt(e++)!=="]"&&e<r.length;)n+=r.charAt(e);if(n.match(iS))return!0;break;case".":case"0":case"#":for(;e<r.length&&("0#?.,E+-%".indexOf(t=r.charAt(++e))>-1||t=="\\"&&r.charAt(e+1)=="-"&&"0#".indexOf(r.charAt(e+2))>-1););break;case"?":for(;r.charAt(++e)===t;);break;case"*":++e,(r.charAt(e)==" "||r.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<r.length&&"0123456789".indexOf(r.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function HQ(r,e,t,n){for(var i=[],s="",a=0,o="",l="t",f,c,h,u="H";a<r.length;)switch(o=r.charAt(a)){case"G":if(!wd(r,a))throw new Error("unrecognized character "+o+" in "+r);i[i.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(h=r.charCodeAt(++a))!==34&&a<r.length;)s+=String.fromCharCode(h);i[i.length]={t:"t",v:s},++a;break;case"\\":var d=r.charAt(++a),p=d==="("||d===")"?d:"t";i[i.length]={t:p,v:d},++a;break;case"_":i[i.length]={t:"t",v:" "},a+=2;break;case"@":i[i.length]={t:"T",v:e},++a;break;case"B":case"b":if(r.charAt(a+1)==="1"||r.charAt(a+1)==="2"){if(f==null&&(f=_a(e,t,r.charAt(a+1)==="2"),f==null))return"";i[i.length]={t:"X",v:r.substr(a,2)},l=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||f==null&&(f=_a(e,t),f==null))return"";for(s=o;++a<r.length&&r.charAt(a).toLowerCase()===o;)s+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=u),i[i.length]={t:o,v:s},l=o;break;case"A":case"a":case"":var m={t:o,v:o};if(f==null&&(f=_a(e,t)),r.substr(a,3).toUpperCase()==="A/P"?(f!=null&&(m.v=f.H>=12?"P":"A"),m.t="T",u="h",a+=3):r.substr(a,5).toUpperCase()==="AM/PM"?(f!=null&&(m.v=f.H>=12?"PM":"AM"),m.t="T",a+=5,u="h"):r.substr(a,5).toUpperCase()==="/"?(f!=null&&(m.v=f.H>=12?"":""),m.t="T",a+=5,u="h"):(m.t="t",++a),f==null&&m.t==="T")return"";i[i.length]=m,l=o;break;case"[":for(s=o;r.charAt(a++)!=="]"&&a<r.length;)s+=r.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(iS)){if(f==null&&(f=_a(e,t),f==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",Bo(r)||(i[i.length]={t:"t",v:s}));break;case".":if(f!=null){for(s=o;++a<r.length&&(o=r.charAt(a))==="0";)s+=o;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++a<r.length&&"0#?.,E+-%".indexOf(o=r.charAt(a))>-1;)s+=o;i[i.length]={t:"n",v:s};break;case"?":for(s=o;r.charAt(++a)===o;)s+=o;i[i.length]={t:o,v:s},l=o;break;case"*":++a,(r.charAt(a)==" "||r.charAt(a)=="*")&&++a;break;case"(":case")":i[i.length]={t:n===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;a<r.length&&"0123456789".indexOf(r.charAt(++a))>-1;)s+=r.charAt(a);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:o,v:o},++a;break;case"$":i[i.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+r);i[i.length]={t:"t",v:o},++a;break}var g=0,v=0,w;for(a=i.length-1,l="t";a>=0;--a)switch(i[a].t){case"h":case"H":i[a].t=u,l="h",g<1&&(g=1);break;case"s":(w=i[a].v.match(/\.0+$/))&&(v=Math.max(v,w[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":l=i[a].t;break;case"m":l==="s"&&(i[a].t="M",g<2&&(g=2));break;case"X":break;case"Z":g<1&&i[a].v.match(/[Hh]/)&&(g=1),g<2&&i[a].v.match(/[Mm]/)&&(g=2),g<3&&i[a].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M),f.M>=60&&(f.M=0,++f.H);break;case 2:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M);break}var x="",S;for(a=0;a<i.length;++a)switch(i[a].t){case"t":case"T":case" ":case"D":break;case"X":i[a].v="",i[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[a].v=BQ(i[a].t.charCodeAt(0),i[a].v,f,v),i[a].t="t";break;case"n":case"?":for(S=a+1;i[S]!=null&&((o=i[S].t)==="?"||o==="D"||(o===" "||o==="t")&&i[S+1]!=null&&(i[S+1].t==="?"||i[S+1].t==="t"&&i[S+1].v==="/")||i[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[S].v==="/"||i[S].v===" "&&i[S+1]!=null&&i[S+1].t=="?"));)i[a].v+=i[S].v,i[S]={v:"",t:";"},++S;x+=i[a].v,a=S-1;break;case"G":i[a].t="t",i[a].v=Co(e,t);break}var y="",b,O;if(x.length>0){x.charCodeAt(0)==40?(b=e<0&&x.charCodeAt(0)===45?-e:e,O=Us("n",x,b)):(b=e<0&&n>1?-e:e,O=Us("n",x,b),b<0&&i[0]&&i[0].t=="t"&&(O=O.substr(1),i[0].v="-"+i[0].v)),S=O.length-1;var T=i.length;for(a=0;a<i.length;++a)if(i[a]!=null&&i[a].t!="t"&&i[a].v.indexOf(".")>-1){T=a;break}var k=i.length;if(T===i.length&&O.indexOf("E")===-1){for(a=i.length-1;a>=0;--a)i[a]==null||"n?".indexOf(i[a].t)===-1||(S>=i[a].v.length-1?(S-=i[a].v.length,i[a].v=O.substr(S+1,i[a].v.length)):S<0?i[a].v="":(i[a].v=O.substr(0,S+1),S=-1),i[a].t="t",k=a);S>=0&&k<i.length&&(i[k].v=O.substr(0,S+1)+i[k].v)}else if(T!==i.length&&O.indexOf("E")===-1){for(S=O.indexOf(".")-1,a=T;a>=0;--a)if(!(i[a]==null||"n?".indexOf(i[a].t)===-1)){for(c=i[a].v.indexOf(".")>-1&&a===T?i[a].v.indexOf(".")-1:i[a].v.length-1,y=i[a].v.substr(c+1);c>=0;--c)S>=0&&(i[a].v.charAt(c)==="0"||i[a].v.charAt(c)==="#")&&(y=O.charAt(S--)+y);i[a].v=y,i[a].t="t",k=a}for(S>=0&&k<i.length&&(i[k].v=O.substr(0,S+1)+i[k].v),S=O.indexOf(".")+1,a=T;a<i.length;++a)if(!(i[a]==null||"n?(".indexOf(i[a].t)===-1&&a!==T)){for(c=i[a].v.indexOf(".")>-1&&a===T?i[a].v.indexOf(".")+1:0,y=i[a].v.substr(0,c);c<i[a].v.length;++c)S<O.length&&(y+=O.charAt(S++));i[a].v=y,i[a].t="t",k=a}}}for(a=0;a<i.length;++a)i[a]!=null&&"n?".indexOf(i[a].t)>-1&&(b=n>1&&e<0&&a>0&&i[a-1].v==="-"?-e:e,i[a].v=Us(i[a].t,i[a].v,b),i[a].t="t");var Q="";for(a=0;a!==i.length;++a)i[a]!=null&&(Q+=i[a].v);return Q}var Jv=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function ey(r,e){if(e==null)return!1;var t=parseFloat(e[2]);switch(e[1]){case"=":if(r==t)return!0;break;case">":if(r>t)return!0;break;case"<":if(r<t)return!0;break;case"<>":if(r!=t)return!0;break;case">=":if(r>=t)return!0;break;case"<=":if(r<=t)return!0;break}return!1}function YQ(r,e){var t=GQ(r),n=t.length,i=t[n-1].indexOf("@");if(n<4&&i>-1&&--n,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof e!="number")return[4,t.length===4||i>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=i>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=i>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=i>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var s=e>0?t[0]:e<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[n,s];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var a=t[0].match(Jv),o=t[1].match(Jv);return ey(e,a)?[n,t[0]]:ey(e,o)?[n,t[1]]:[n,t[a!=null&&o!=null?2:1]]}return[n,s]}function hi(r,e,t){t==null&&(t={});var n="";switch(typeof r){case"string":r=="m/d/yy"&&t.dateNF?n=t.dateNF:n=r;break;case"number":r==14&&t.dateNF?n=t.dateNF:n=(t.table!=null?t.table:et)[r],n==null&&(n=t.table&&t.table[Hv[r]]||et[Hv[r]]),n==null&&(n=FQ[r]||"General");break}if(wd(n,0))return Co(e,t);e instanceof Date&&(e=Hk(e,t.date1904));var i=YQ(n,e);if(wd(i[1]))return Co(e,t);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return HQ(i[1],e,t,i[0])}function ys(r,e){if(typeof e!="number"){e=+e||-1;for(var t=0;t<392;++t){if(et[t]==null){e<0&&(e=t);continue}if(et[t]==r){e=t;break}}e<0&&(e=391)}return et[e]=r,e}function xh(r){for(var e=0;e!=392;++e)r[e]!==void 0&&ys(r[e],e)}function ff(){et=QQ()}var sS={format:hi,load:ys,_table:et,load_table:xh,parse_date_code:_a,is_date:Bo,get_table:function(){return sS._table=et}},KQ={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},aS=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function JQ(r){var e=typeof r=="number"?et[r]:r;return e=e.replace(aS,"(\\d+)"),new RegExp("^"+e+"$")}function eF(r,e,t){var n=-1,i=-1,s=-1,a=-1,o=-1,l=-1;(e.match(aS)||[]).forEach(function(h,u){var d=parseInt(t[u+1],10);switch(h.toLowerCase().charAt(0)){case"y":n=d;break;case"d":s=d;break;case"h":a=d;break;case"s":l=d;break;case"m":a>=0?o=d:i=d;break}}),l>=0&&o==-1&&i>=0&&(o=i,i=-1);var f=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);f.length==7&&(f="0"+f),f.length==8&&(f="20"+f);var c=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return a==-1&&o==-1&&l==-1?f:n==-1&&i==-1&&s==-1?c:f+"T"+c}var tF=function(){var r={};r.version="1.2.0";function e(){for(var O=0,T=new Array(256),k=0;k!=256;++k)O=k,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,T[k]=O;return typeof Int32Array<"u"?new Int32Array(T):T}var t=e();function n(O){var T=0,k=0,Q=0,A=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(Q=0;Q!=256;++Q)A[Q]=O[Q];for(Q=0;Q!=256;++Q)for(k=O[Q],T=256+Q;T<4096;T+=256)k=A[T]=k>>>8^O[k&255];var _=[];for(Q=1;Q!=16;++Q)_[Q-1]=typeof Int32Array<"u"?A.subarray(Q*256,Q*256+256):A.slice(Q*256,Q*256+256);return _}var i=n(t),s=i[0],a=i[1],o=i[2],l=i[3],f=i[4],c=i[5],h=i[6],u=i[7],d=i[8],p=i[9],m=i[10],g=i[11],v=i[12],w=i[13],x=i[14];function S(O,T){for(var k=T^-1,Q=0,A=O.length;Q<A;)k=k>>>8^t[(k^O.charCodeAt(Q++))&255];return~k}function y(O,T){for(var k=T^-1,Q=O.length-15,A=0;A<Q;)k=x[O[A++]^k&255]^w[O[A++]^k>>8&255]^v[O[A++]^k>>16&255]^g[O[A++]^k>>>24]^m[O[A++]]^p[O[A++]]^d[O[A++]]^u[O[A++]]^h[O[A++]]^c[O[A++]]^f[O[A++]]^l[O[A++]]^o[O[A++]]^a[O[A++]]^s[O[A++]]^t[O[A++]];for(Q+=15;A<Q;)k=k>>>8^t[(k^O[A++])&255];return~k}function b(O,T){for(var k=T^-1,Q=0,A=O.length,_=0,N=0;Q<A;)_=O.charCodeAt(Q++),_<128?k=k>>>8^t[(k^_)&255]:_<2048?(k=k>>>8^t[(k^(192|_>>6&31))&255],k=k>>>8^t[(k^(128|_&63))&255]):_>=55296&&_<57344?(_=(_&1023)+64,N=O.charCodeAt(Q++)&1023,k=k>>>8^t[(k^(240|_>>8&7))&255],k=k>>>8^t[(k^(128|_>>2&63))&255],k=k>>>8^t[(k^(128|N>>6&15|(_&3)<<4))&255],k=k>>>8^t[(k^(128|N&63))&255]):(k=k>>>8^t[(k^(224|_>>12&15))&255],k=k>>>8^t[(k^(128|_>>6&63))&255],k=k>>>8^t[(k^(128|_&63))&255]);return~k}return r.table=t,r.bstr=S,r.buf=y,r.str=b,r}(),Ye=function(){var e={};e.version="1.2.1";function t(F,j){for(var D=F.split("/"),M=j.split("/"),X=0,G=0,oe=Math.min(D.length,M.length);X<oe;++X){if(G=D[X].length-M[X].length)return G;if(D[X]!=M[X])return D[X]<M[X]?-1:1}return D.length-M.length}function n(F){if(F.charAt(F.length-1)=="/")return F.slice(0,-1).indexOf("/")===-1?F:n(F.slice(0,-1));var j=F.lastIndexOf("/");return j===-1?F:F.slice(0,j+1)}function i(F){if(F.charAt(F.length-1)=="/")return i(F.slice(0,-1));var j=F.lastIndexOf("/");return j===-1?F:F.slice(j+1)}function s(F,j){typeof j=="string"&&(j=new Date(j));var D=j.getHours();D=D<<6|j.getMinutes(),D=D<<5|j.getSeconds()>>>1,F.write_shift(2,D);var M=j.getFullYear()-1980;M=M<<4|j.getMonth()+1,M=M<<5|j.getDate(),F.write_shift(2,M)}function a(F){var j=F.read_shift(2)&65535,D=F.read_shift(2)&65535,M=new Date,X=D&31;D>>>=5;var G=D&15;D>>>=4,M.setMilliseconds(0),M.setFullYear(D+1980),M.setMonth(G-1),M.setDate(X);var oe=j&31;j>>>=5;var ue=j&63;return j>>>=6,M.setHours(j),M.setMinutes(ue),M.setSeconds(oe<<1),M}function o(F){rn(F,0);for(var j={},D=0;F.l<=F.length-4;){var M=F.read_shift(2),X=F.read_shift(2),G=F.l+X,oe={};switch(M){case 21589:D=F.read_shift(1),D&1&&(oe.mtime=F.read_shift(4)),X>5&&(D&2&&(oe.atime=F.read_shift(4)),D&4&&(oe.ctime=F.read_shift(4))),oe.mtime&&(oe.mt=new Date(oe.mtime*1e3));break}F.l=G,j[M]=oe}return j}var l;function f(){return l||(l={})}function c(F,j){if(F[0]==80&&F[1]==75)return fa(F,j);if((F[0]|32)==109&&(F[1]|32)==105)return qe(F,j);if(F.length<512)throw new Error("CFB file size "+F.length+" < 512");var D=3,M=512,X=0,G=0,oe=0,ue=0,ie=0,le=[],ce=F.slice(0,512);rn(ce,0);var _e=h(ce);switch(D=_e[0],D){case 3:M=512;break;case 4:M=4096;break;case 0:if(_e[1]==0)return fa(F,j);default:throw new Error("Major Version: Expected 3 or 4 saw "+D)}M!==512&&(ce=F.slice(0,M),rn(ce,28));var Pe=F.slice(0,M);u(ce,D);var We=ce.read_shift(4,"i");if(D===3&&We!==0)throw new Error("# Directory Sectors: Expected 0 saw "+We);ce.l+=4,oe=ce.read_shift(4,"i"),ce.l+=4,ce.chk("00100000","Mini Stream Cutoff Size: "),ue=ce.read_shift(4,"i"),X=ce.read_shift(4,"i"),ie=ce.read_shift(4,"i"),G=ce.read_shift(4,"i");for(var Se=-1,Ze=0;Ze<109&&(Se=ce.read_shift(4,"i"),!(Se<0));++Ze)le[Ze]=Se;var rt=d(F,M);g(ie,G,rt,M,le);var Je=w(rt,oe,le,M);Je[oe].name="!Directory",X>0&&ue!==N&&(Je[ue].name="!MiniFAT"),Je[le[0]].name="!FAT",Je.fat_addrs=le,Je.ssz=M;var nt={},Tt=[],ar=[],vt=[];x(oe,Je,rt,Tt,X,nt,ar,ue),p(ar,vt,Tt),Tt.shift();var vr={FileIndex:ar,FullPaths:vt};return j&&j.raw&&(vr.raw={header:Pe,sectors:rt}),vr}function h(F){if(F[F.l]==80&&F[F.l+1]==75)return[0,0];F.chk(U,"Header Signature: "),F.l+=16;var j=F.read_shift(2,"u");return[F.read_shift(2,"u"),j]}function u(F,j){var D=9;switch(F.l+=2,D=F.read_shift(2)){case 9:if(j!=3)throw new Error("Sector Shift: Expected 9 saw "+D);break;case 12:if(j!=4)throw new Error("Sector Shift: Expected 12 saw "+D);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+D)}F.chk("0600","Mini Sector Shift: "),F.chk("000000000000","Reserved: ")}function d(F,j){for(var D=Math.ceil(F.length/j)-1,M=[],X=1;X<D;++X)M[X-1]=F.slice(X*j,(X+1)*j);return M[D-1]=F.slice(D*j),M}function p(F,j,D){for(var M=0,X=0,G=0,oe=0,ue=0,ie=D.length,le=[],ce=[];M<ie;++M)le[M]=ce[M]=M,j[M]=D[M];for(;ue<ce.length;++ue)M=ce[ue],X=F[M].L,G=F[M].R,oe=F[M].C,le[M]===M&&(X!==-1&&le[X]!==X&&(le[M]=le[X]),G!==-1&&le[G]!==G&&(le[M]=le[G])),oe!==-1&&(le[oe]=M),X!==-1&&M!=le[M]&&(le[X]=le[M],ce.lastIndexOf(X)<ue&&ce.push(X)),G!==-1&&M!=le[M]&&(le[G]=le[M],ce.lastIndexOf(G)<ue&&ce.push(G));for(M=1;M<ie;++M)le[M]===M&&(G!==-1&&le[G]!==G?le[M]=le[G]:X!==-1&&le[X]!==X&&(le[M]=le[X]));for(M=1;M<ie;++M)if(F[M].type!==0){if(ue=M,ue!=le[ue])do ue=le[ue],j[M]=j[ue]+"/"+j[M];while(ue!==0&&le[ue]!==-1&&ue!=le[ue]);le[M]=-1}for(j[0]+="/",M=1;M<ie;++M)F[M].type!==2&&(j[M]+="/")}function m(F,j,D){for(var M=F.start,X=F.size,G=[],oe=M;D&&X>0&&oe>=0;)G.push(j.slice(oe*_,oe*_+_)),X-=_,oe=co(D,oe*4);return G.length===0?Oe(0):Hr(G).slice(0,F.size)}function g(F,j,D,M,X){var G=N;if(F===N){if(j!==0)throw new Error("DIFAT chain shorter than expected")}else if(F!==-1){var oe=D[F],ue=(M>>>2)-1;if(!oe)return;for(var ie=0;ie<ue&&(G=co(oe,ie*4))!==N;++ie)X.push(G);g(co(oe,M-4),j-1,D,M,X)}}function v(F,j,D,M,X){var G=[],oe=[];X||(X=[]);var ue=M-1,ie=0,le=0;for(ie=j;ie>=0;){X[ie]=!0,G[G.length]=ie,oe.push(F[ie]);var ce=D[Math.floor(ie*4/M)];if(le=ie*4&ue,M<4+le)throw new Error("FAT boundary crossed: "+ie+" 4 "+M);if(!F[ce])break;ie=co(F[ce],le)}return{nodes:G,data:uy([oe])}}function w(F,j,D,M){var X=F.length,G=[],oe=[],ue=[],ie=[],le=M-1,ce=0,_e=0,Pe=0,We=0;for(ce=0;ce<X;++ce)if(ue=[],Pe=ce+j,Pe>=X&&(Pe-=X),!oe[Pe]){ie=[];var Se=[];for(_e=Pe;_e>=0;){Se[_e]=!0,oe[_e]=!0,ue[ue.length]=_e,ie.push(F[_e]);var Ze=D[Math.floor(_e*4/M)];if(We=_e*4&le,M<4+We)throw new Error("FAT boundary crossed: "+_e+" 4 "+M);if(!F[Ze]||(_e=co(F[Ze],We),Se[_e]))break}G[Pe]={nodes:ue,data:uy([ie])}}return G}function x(F,j,D,M,X,G,oe,ue){for(var ie=0,le=M.length?2:0,ce=j[F].data,_e=0,Pe=0,We;_e<ce.length;_e+=128){var Se=ce.slice(_e,_e+128);rn(Se,64),Pe=Se.read_shift(2),We=A0(Se,0,Pe-le),M.push(We);var Ze={name:We,type:Se.read_shift(1),color:Se.read_shift(1),L:Se.read_shift(4,"i"),R:Se.read_shift(4,"i"),C:Se.read_shift(4,"i"),clsid:Se.read_shift(16),state:Se.read_shift(4,"i"),start:0,size:0},rt=Se.read_shift(2)+Se.read_shift(2)+Se.read_shift(2)+Se.read_shift(2);rt!==0&&(Ze.ct=S(Se,Se.l-8));var Je=Se.read_shift(2)+Se.read_shift(2)+Se.read_shift(2)+Se.read_shift(2);Je!==0&&(Ze.mt=S(Se,Se.l-8)),Ze.start=Se.read_shift(4,"i"),Ze.size=Se.read_shift(4,"i"),Ze.size<0&&Ze.start<0&&(Ze.size=Ze.type=0,Ze.start=N,Ze.name=""),Ze.type===5?(ie=Ze.start,X>0&&ie!==N&&(j[ie].name="!StreamData")):Ze.size>=4096?(Ze.storage="fat",j[Ze.start]===void 0&&(j[Ze.start]=v(D,Ze.start,j.fat_addrs,j.ssz)),j[Ze.start].name=Ze.name,Ze.content=j[Ze.start].data.slice(0,Ze.size)):(Ze.storage="minifat",Ze.size<0?Ze.size=0:ie!==N&&Ze.start!==N&&j[ie]&&(Ze.content=m(Ze,j[ie].data,(j[ue]||{}).data))),Ze.content&&rn(Ze.content,0),G[We]=Ze,oe.push(Ze)}}function S(F,j){return new Date((zr(F,j+4)/1e7*Math.pow(2,32)+zr(F,j)/1e7-11644473600)*1e3)}function y(F,j){return f(),c(l.readFileSync(F),j)}function b(F,j){var D=j&&j.type;switch(D||gt&&Buffer.isBuffer(F)&&(D="buffer"),D||"base64"){case"file":return y(F,j);case"base64":return c(ei(ci(F)),j);case"binary":return c(ei(F),j)}return c(F,j)}function O(F,j){var D=j||{},M=D.root||"Root Entry";if(F.FullPaths||(F.FullPaths=[]),F.FileIndex||(F.FileIndex=[]),F.FullPaths.length!==F.FileIndex.length)throw new Error("inconsistent CFB structure");F.FullPaths.length===0&&(F.FullPaths[0]=M+"/",F.FileIndex[0]={name:M,type:5}),D.CLSID&&(F.FileIndex[0].clsid=D.CLSID),T(F)}function T(F){var j="Sh33tJ5";if(!Ye.find(F,"/"+j)){var D=Oe(4);D[0]=55,D[1]=D[3]=50,D[2]=54,F.FileIndex.push({name:j,type:2,content:D,size:4,L:69,R:69,C:69}),F.FullPaths.push(F.FullPaths[0]+j),k(F)}}function k(F,j){O(F);for(var D=!1,M=!1,X=F.FullPaths.length-1;X>=0;--X){var G=F.FileIndex[X];switch(G.type){case 0:M?D=!0:(F.FileIndex.pop(),F.FullPaths.pop());break;case 1:case 2:case 5:M=!0,isNaN(G.R*G.L*G.C)&&(D=!0),G.R>-1&&G.L>-1&&G.R==G.L&&(D=!0);break;default:D=!0;break}}if(!(!D&&!j)){var oe=new Date(1987,1,19),ue=0,ie=Object.create?Object.create(null):{},le=[];for(X=0;X<F.FullPaths.length;++X)ie[F.FullPaths[X]]=!0,F.FileIndex[X].type!==0&&le.push([F.FullPaths[X],F.FileIndex[X]]);for(X=0;X<le.length;++X){var ce=n(le[X][0]);M=ie[ce],M||(le.push([ce,{name:i(ce).replace("/",""),type:1,clsid:K,ct:oe,mt:oe,content:null}]),ie[ce]=!0)}for(le.sort(function(We,Se){return t(We[0],Se[0])}),F.FullPaths=[],F.FileIndex=[],X=0;X<le.length;++X)F.FullPaths[X]=le[X][0],F.FileIndex[X]=le[X][1];for(X=0;X<le.length;++X){var _e=F.FileIndex[X],Pe=F.FullPaths[X];if(_e.name=i(Pe).replace("/",""),_e.L=_e.R=_e.C=-(_e.color=1),_e.size=_e.content?_e.content.length:0,_e.start=0,_e.clsid=_e.clsid||K,X===0)_e.C=le.length>1?1:-1,_e.size=0,_e.type=5;else if(Pe.slice(-1)=="/"){for(ue=X+1;ue<le.length&&n(F.FullPaths[ue])!=Pe;++ue);for(_e.C=ue>=le.length?-1:ue,ue=X+1;ue<le.length&&n(F.FullPaths[ue])!=n(Pe);++ue);_e.R=ue>=le.length?-1:ue,_e.type=1}else n(F.FullPaths[X+1]||"")==n(Pe)&&(_e.R=X+1),_e.type=2}}}function Q(F,j){var D=j||{};if(D.fileType=="mad")return pt(F,D);switch(k(F),D.fileType){case"zip":return eo(F,D)}var M=function(We){for(var Se=0,Ze=0,rt=0;rt<We.FileIndex.length;++rt){var Je=We.FileIndex[rt];if(Je.content){var nt=Je.content.length;nt>0&&(nt<4096?Se+=nt+63>>6:Ze+=nt+511>>9)}}for(var Tt=We.FullPaths.length+3>>2,ar=Se+7>>3,vt=Se+127>>7,vr=ar+Ze+Tt+vt,Qr=vr+127>>7,is=Qr<=109?0:Math.ceil((Qr-109)/127);vr+Qr+is+127>>7>Qr;)is=++Qr<=109?0:Math.ceil((Qr-109)/127);var Fr=[1,is,Qr,vt,Tt,Ze,Se,0];return We.FileIndex[0].size=Se<<6,Fr[7]=(We.FileIndex[0].start=Fr[0]+Fr[1]+Fr[2]+Fr[3]+Fr[4]+Fr[5])+(Fr[6]+7>>3),Fr}(F),X=Oe(M[7]<<9),G=0,oe=0;{for(G=0;G<8;++G)X.write_shift(1,z[G]);for(G=0;G<8;++G)X.write_shift(2,0);for(X.write_shift(2,62),X.write_shift(2,3),X.write_shift(2,65534),X.write_shift(2,9),X.write_shift(2,6),G=0;G<3;++G)X.write_shift(2,0);for(X.write_shift(4,0),X.write_shift(4,M[2]),X.write_shift(4,M[0]+M[1]+M[2]+M[3]-1),X.write_shift(4,0),X.write_shift(4,4096),X.write_shift(4,M[3]?M[0]+M[1]+M[2]-1:N),X.write_shift(4,M[3]),X.write_shift(-4,M[1]?M[0]-1:N),X.write_shift(4,M[1]),G=0;G<109;++G)X.write_shift(-4,G<M[2]?M[1]+G:-1)}if(M[1])for(oe=0;oe<M[1];++oe){for(;G<236+oe*127;++G)X.write_shift(-4,G<M[2]?M[1]+G:-1);X.write_shift(-4,oe===M[1]-1?N:oe+1)}var ue=function(We){for(oe+=We;G<oe-1;++G)X.write_shift(-4,G+1);We&&(++G,X.write_shift(-4,N))};for(oe=G=0,oe+=M[1];G<oe;++G)X.write_shift(-4,re.DIFSECT);for(oe+=M[2];G<oe;++G)X.write_shift(-4,re.FATSECT);ue(M[3]),ue(M[4]);for(var ie=0,le=0,ce=F.FileIndex[0];ie<F.FileIndex.length;++ie)ce=F.FileIndex[ie],ce.content&&(le=ce.content.length,!(le<4096)&&(ce.start=oe,ue(le+511>>9)));for(ue(M[6]+7>>3);X.l&511;)X.write_shift(-4,re.ENDOFCHAIN);for(oe=G=0,ie=0;ie<F.FileIndex.length;++ie)ce=F.FileIndex[ie],ce.content&&(le=ce.content.length,!(!le||le>=4096)&&(ce.start=oe,ue(le+63>>6)));for(;X.l&511;)X.write_shift(-4,re.ENDOFCHAIN);for(G=0;G<M[4]<<2;++G){var _e=F.FullPaths[G];if(!_e||_e.length===0){for(ie=0;ie<17;++ie)X.write_shift(4,0);for(ie=0;ie<3;++ie)X.write_shift(4,-1);for(ie=0;ie<12;++ie)X.write_shift(4,0);continue}ce=F.FileIndex[G],G===0&&(ce.start=ce.size?ce.start-1:N);var Pe=G===0&&D.root||ce.name;if(le=2*(Pe.length+1),X.write_shift(64,Pe,"utf16le"),X.write_shift(2,le),X.write_shift(1,ce.type),X.write_shift(1,ce.color),X.write_shift(-4,ce.L),X.write_shift(-4,ce.R),X.write_shift(-4,ce.C),ce.clsid)X.write_shift(16,ce.clsid,"hex");else for(ie=0;ie<4;++ie)X.write_shift(4,0);X.write_shift(4,ce.state||0),X.write_shift(4,0),X.write_shift(4,0),X.write_shift(4,0),X.write_shift(4,0),X.write_shift(4,ce.start),X.write_shift(4,ce.size),X.write_shift(4,0)}for(G=1;G<F.FileIndex.length;++G)if(ce=F.FileIndex[G],ce.size>=4096)if(X.l=ce.start+1<<9,gt&&Buffer.isBuffer(ce.content))ce.content.copy(X,X.l,0,ce.size),X.l+=ce.size+511&-512;else{for(ie=0;ie<ce.size;++ie)X.write_shift(1,ce.content[ie]);for(;ie&511;++ie)X.write_shift(1,0)}for(G=1;G<F.FileIndex.length;++G)if(ce=F.FileIndex[G],ce.size>0&&ce.size<4096)if(gt&&Buffer.isBuffer(ce.content))ce.content.copy(X,X.l,0,ce.size),X.l+=ce.size+63&-64;else{for(ie=0;ie<ce.size;++ie)X.write_shift(1,ce.content[ie]);for(;ie&63;++ie)X.write_shift(1,0)}if(gt)X.l=X.length;else for(;X.l<X.length;)X.write_shift(1,0);return X}function A(F,j){var D=F.FullPaths.map(function(ie){return ie.toUpperCase()}),M=D.map(function(ie){var le=ie.split("/");return le[le.length-(ie.slice(-1)=="/"?2:1)]}),X=!1;j.charCodeAt(0)===47?(X=!0,j=D[0].slice(0,-1)+j):X=j.indexOf("/")!==-1;var G=j.toUpperCase(),oe=X===!0?D.indexOf(G):M.indexOf(G);if(oe!==-1)return F.FileIndex[oe];var ue=!G.match(Zf);for(G=G.replace(_n,""),ue&&(G=G.replace(Zf,"!")),oe=0;oe<D.length;++oe)if((ue?D[oe].replace(Zf,"!"):D[oe]).replace(_n,"")==G||(ue?M[oe].replace(Zf,"!"):M[oe]).replace(_n,"")==G)return F.FileIndex[oe];return null}var _=64,N=-2,U="d0cf11e0a1b11ae1",z=[208,207,17,224,161,177,26,225],K="00000000000000000000000000000000",re={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:N,FREESECT:-1,HEADER_SIGNATURE:U,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:K,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ge(F,j,D){f();var M=Q(F,D);l.writeFileSync(j,M)}function V(F){for(var j=new Array(F.length),D=0;D<F.length;++D)j[D]=String.fromCharCode(F[D]);return j.join("")}function he(F,j){var D=Q(F,j);switch(j&&j.type||"buffer"){case"file":return f(),l.writeFileSync(j.filename,D),D;case"binary":return typeof D=="string"?D:V(D);case"base64":return kc(typeof D=="string"?D:V(D));case"buffer":if(gt)return Buffer.isBuffer(D)?D:ta(D);case"array":return typeof D=="string"?ei(D):D}return D}var ae;function E(F){try{var j=F.InflateRaw,D=new j;if(D._processChunk(new Uint8Array([3,0]),D._finishFlushFlag),D.bytesRead)ae=F;else throw new Error("zlib does not expose bytesRead")}catch(M){console.error("cannot use native zlib: "+(M.message||M))}}function L(F,j){if(!ae)return Ka(F,j);var D=ae.InflateRaw,M=new D,X=M._processChunk(F.slice(F.l),M._finishFlushFlag);return F.l+=M.bytesRead,X}function I(F){return ae?ae.deflateRawSync(F):Ke(F)}var Z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ee=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ne=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function de(F){var j=(F<<1|F<<11)&139536|(F<<5|F<<15)&558144;return(j>>16|j>>8|j)&255}for(var fe=typeof Uint8Array<"u",pe=fe?new Uint8Array(256):[],Me=0;Me<256;++Me)pe[Me]=de(Me);function q(F,j){var D=pe[F&255];return j<=8?D>>>8-j:(D=D<<8|pe[F>>8&255],j<=16?D>>>16-j:(D=D<<8|pe[F>>16&255],D>>>24-j))}function He(F,j){var D=j&7,M=j>>>3;return(F[M]|(D<=6?0:F[M+1]<<8))>>>D&3}function Ve(F,j){var D=j&7,M=j>>>3;return(F[M]|(D<=5?0:F[M+1]<<8))>>>D&7}function Te(F,j){var D=j&7,M=j>>>3;return(F[M]|(D<=4?0:F[M+1]<<8))>>>D&15}function Ne(F,j){var D=j&7,M=j>>>3;return(F[M]|(D<=3?0:F[M+1]<<8))>>>D&31}function ve(F,j){var D=j&7,M=j>>>3;return(F[M]|(D<=1?0:F[M+1]<<8))>>>D&127}function ct(F,j,D){var M=j&7,X=j>>>3,G=(1<<D)-1,oe=F[X]>>>M;return D<8-M||(oe|=F[X+1]<<8-M,D<16-M)||(oe|=F[X+2]<<16-M,D<24-M)||(oe|=F[X+3]<<24-M),oe&G}function bt(F,j,D){var M=j&7,X=j>>>3;return M<=5?F[X]|=(D&7)<<M:(F[X]|=D<<M&255,F[X+1]=(D&7)>>8-M),j+3}function Bt(F,j,D){var M=j&7,X=j>>>3;return D=(D&1)<<M,F[X]|=D,j+1}function er(F,j,D){var M=j&7,X=j>>>3;return D<<=M,F[X]|=D&255,D>>>=8,F[X+1]=D,j+8}function Qe(F,j,D){var M=j&7,X=j>>>3;return D<<=M,F[X]|=D&255,D>>>=8,F[X+1]=D&255,F[X+2]=D>>>8,j+16}function Xe(F,j){var D=F.length,M=2*D>j?2*D:j+5,X=0;if(D>=j)return F;if(gt){var G=jv(M);if(F.copy)F.copy(G);else for(;X<F.length;++X)G[X]=F[X];return G}else if(fe){var oe=new Uint8Array(M);if(oe.set)oe.set(F);else for(;X<D;++X)oe[X]=F[X];return oe}return F.length=M,F}function De(F){for(var j=new Array(F),D=0;D<F;++D)j[D]=0;return j}function ke(F,j,D){var M=1,X=0,G=0,oe=0,ue=0,ie=F.length,le=fe?new Uint16Array(32):De(32);for(G=0;G<32;++G)le[G]=0;for(G=ie;G<D;++G)F[G]=0;ie=F.length;var ce=fe?new Uint16Array(ie):De(ie);for(G=0;G<ie;++G)le[X=F[G]]++,M<X&&(M=X),ce[G]=0;for(le[0]=0,G=1;G<=M;++G)le[G+16]=ue=ue+le[G-1]<<1;for(G=0;G<ie;++G)ue=F[G],ue!=0&&(ce[G]=le[ue+16]++);var _e=0;for(G=0;G<ie;++G)if(_e=F[G],_e!=0)for(ue=q(ce[G],M)>>M-_e,oe=(1<<M+4-_e)-1;oe>=0;--oe)j[ue|oe<<_e]=_e&15|G<<4;return M}var Ee=fe?new Uint16Array(512):De(512),Ft=fe?new Uint16Array(32):De(32);if(!fe){for(var xr=0;xr<512;++xr)Ee[xr]=0;for(xr=0;xr<32;++xr)Ft[xr]=0}(function(){for(var F=[],j=0;j<32;j++)F.push(5);ke(F,Ft,32);var D=[];for(j=0;j<=143;j++)D.push(8);for(;j<=255;j++)D.push(9);for(;j<=279;j++)D.push(7);for(;j<=287;j++)D.push(8);ke(D,Ee,288)})();var Vt=function(){for(var j=fe?new Uint8Array(32768):[],D=0,M=0;D<ne.length-1;++D)for(;M<ne[D+1];++M)j[M]=D;for(;M<32768;++M)j[M]=29;var X=fe?new Uint8Array(259):[];for(D=0,M=0;D<ee.length-1;++D)for(;M<ee[D+1];++M)X[M]=D;function G(ue,ie){for(var le=0;le<ue.length;){var ce=Math.min(65535,ue.length-le),_e=le+ce==ue.length;for(ie.write_shift(1,+_e),ie.write_shift(2,ce),ie.write_shift(2,~ce&65535);ce-- >0;)ie[ie.l++]=ue[le++]}return ie.l}function oe(ue,ie){for(var le=0,ce=0,_e=fe?new Uint16Array(32768):[];ce<ue.length;){var Pe=Math.min(65535,ue.length-ce);if(Pe<10){for(le=bt(ie,le,+(ce+Pe==ue.length)),le&7&&(le+=8-(le&7)),ie.l=le/8|0,ie.write_shift(2,Pe),ie.write_shift(2,~Pe&65535);Pe-- >0;)ie[ie.l++]=ue[ce++];le=ie.l*8;continue}le=bt(ie,le,+(ce+Pe==ue.length)+2);for(var We=0;Pe-- >0;){var Se=ue[ce];We=(We<<5^Se)&32767;var Ze=-1,rt=0;if((Ze=_e[We])&&(Ze|=ce&-32768,Ze>ce&&(Ze-=32768),Ze<ce))for(;ue[Ze+rt]==ue[ce+rt]&&rt<250;)++rt;if(rt>2){Se=X[rt],Se<=22?le=er(ie,le,pe[Se+1]>>1)-1:(er(ie,le,3),le+=5,er(ie,le,pe[Se-23]>>5),le+=3);var Je=Se<8?0:Se-4>>2;Je>0&&(Qe(ie,le,rt-ee[Se]),le+=Je),Se=j[ce-Ze],le=er(ie,le,pe[Se]>>3),le-=3;var nt=Se<4?0:Se-2>>1;nt>0&&(Qe(ie,le,ce-Ze-ne[Se]),le+=nt);for(var Tt=0;Tt<rt;++Tt)_e[We]=ce&32767,We=(We<<5^ue[ce])&32767,++ce;Pe-=rt-1}else Se<=143?Se=Se+48:le=Bt(ie,le,1),le=er(ie,le,pe[Se]),_e[We]=ce&32767,++ce}le=er(ie,le,0)-1}return ie.l=(le+7)/8|0,ie.l}return function(ie,le){return ie.length<8?G(ie,le):oe(ie,le)}}();function Ke(F){var j=Oe(50+Math.floor(F.length*1.1)),D=Vt(F,j);return j.slice(0,D)}var zt=fe?new Uint16Array(32768):De(32768),tr=fe?new Uint16Array(32768):De(32768),ur=fe?new Uint16Array(128):De(128),di=1,Ya=1;function xf(F,j){var D=Ne(F,j)+257;j+=5;var M=Ne(F,j)+1;j+=5;var X=Te(F,j)+4;j+=4;for(var G=0,oe=fe?new Uint8Array(19):De(19),ue=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ie=1,le=fe?new Uint8Array(8):De(8),ce=fe?new Uint8Array(8):De(8),_e=oe.length,Pe=0;Pe<X;++Pe)oe[Z[Pe]]=G=Ve(F,j),ie<G&&(ie=G),le[G]++,j+=3;var We=0;for(le[0]=0,Pe=1;Pe<=ie;++Pe)ce[Pe]=We=We+le[Pe-1]<<1;for(Pe=0;Pe<_e;++Pe)(We=oe[Pe])!=0&&(ue[Pe]=ce[We]++);var Se=0;for(Pe=0;Pe<_e;++Pe)if(Se=oe[Pe],Se!=0){We=pe[ue[Pe]]>>8-Se;for(var Ze=(1<<7-Se)-1;Ze>=0;--Ze)ur[We|Ze<<Se]=Se&7|Pe<<3}var rt=[];for(ie=1;rt.length<D+M;)switch(We=ur[ve(F,j)],j+=We&7,We>>>=3){case 16:for(G=3+He(F,j),j+=2,We=rt[rt.length-1];G-- >0;)rt.push(We);break;case 17:for(G=3+Ve(F,j),j+=3;G-- >0;)rt.push(0);break;case 18:for(G=11+ve(F,j),j+=7;G-- >0;)rt.push(0);break;default:rt.push(We),ie<We&&(ie=We);break}var Je=rt.slice(0,D),nt=rt.slice(D);for(Pe=D;Pe<286;++Pe)Je[Pe]=0;for(Pe=M;Pe<30;++Pe)nt[Pe]=0;return di=ke(Je,zt,286),Ya=ke(nt,tr,30),j}function la(F,j){if(F[0]==3&&!(F[1]&3))return[Fa(j),2];for(var D=0,M=0,X=jv(j||1<<18),G=0,oe=X.length>>>0,ue=0,ie=0;!(M&1);){if(M=Ve(F,D),D+=3,M>>>1)M>>1==1?(ue=9,ie=5):(D=xf(F,D),ue=di,ie=Ya);else{D&7&&(D+=8-(D&7));var le=F[D>>>3]|F[(D>>>3)+1]<<8;if(D+=32,le>0)for(!j&&oe<G+le&&(X=Xe(X,G+le),oe=X.length);le-- >0;)X[G++]=F[D>>>3],D+=8;continue}for(;;){!j&&oe<G+32767&&(X=Xe(X,G+32767),oe=X.length);var ce=ct(F,D,ue),_e=M>>>1==1?Ee[ce]:zt[ce];if(D+=_e&15,_e>>>=4,!(_e>>>8&255))X[G++]=_e;else{if(_e==256)break;_e-=257;var Pe=_e<8?0:_e-4>>2;Pe>5&&(Pe=0);var We=G+ee[_e];Pe>0&&(We+=ct(F,D,Pe),D+=Pe),ce=ct(F,D,ie),_e=M>>>1==1?Ft[ce]:tr[ce],D+=_e&15,_e>>>=4;var Se=_e<4?0:_e-2>>1,Ze=ne[_e];for(Se>0&&(Ze+=ct(F,D,Se),D+=Se),!j&&oe<We&&(X=Xe(X,We+100),oe=X.length);G<We;)X[G]=X[G-Ze],++G}}}return j?[X,D+7>>>3]:[X.slice(0,G),D+7>>>3]}function Ka(F,j){var D=F.slice(F.l||0),M=la(D,j);return F.l+=M[1],M[0]}function Ja(F,j){if(F)typeof console<"u"&&console.error(j);else throw new Error(j)}function fa(F,j){var D=F;rn(D,0);var M=[],X=[],G={FileIndex:M,FullPaths:X};O(G,{root:j.root});for(var oe=D.length-4;(D[oe]!=80||D[oe+1]!=75||D[oe+2]!=5||D[oe+3]!=6)&&oe>=0;)--oe;D.l=oe+4,D.l+=4;var ue=D.read_shift(2);D.l+=6;var ie=D.read_shift(4);for(D.l=ie,oe=0;oe<ue;++oe){D.l+=20;var le=D.read_shift(4),ce=D.read_shift(4),_e=D.read_shift(2),Pe=D.read_shift(2),We=D.read_shift(2);D.l+=8;var Se=D.read_shift(4),Ze=o(D.slice(D.l+_e,D.l+_e+Pe));D.l+=_e+Pe+We;var rt=D.l;D.l=Se+4,jo(D,le,ce,G,Ze),D.l=rt}return G}function jo(F,j,D,M,X){F.l+=2;var G=F.read_shift(2),oe=F.read_shift(2),ue=a(F);if(G&8257)throw new Error("Unsupported ZIP encryption");for(var ie=F.read_shift(4),le=F.read_shift(4),ce=F.read_shift(4),_e=F.read_shift(2),Pe=F.read_shift(2),We="",Se=0;Se<_e;++Se)We+=String.fromCharCode(F[F.l++]);if(Pe){var Ze=o(F.slice(F.l,F.l+Pe));(Ze[21589]||{}).mt&&(ue=Ze[21589].mt),((X||{})[21589]||{}).mt&&(ue=X[21589].mt)}F.l+=Pe;var rt=F.slice(F.l,F.l+le);switch(oe){case 8:rt=L(F,ce);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+oe)}var Je=!1;G&8&&(ie=F.read_shift(4),ie==134695760&&(ie=F.read_shift(4),Je=!0),le=F.read_shift(4),ce=F.read_shift(4)),le!=j&&Ja(Je,"Bad compressed size: "+j+" != "+le),ce!=D&&Ja(Je,"Bad uncompressed size: "+D+" != "+ce),tt(M,We,rt,{unsafe:!0,mt:ue})}function eo(F,j){var D=j||{},M=[],X=[],G=Oe(1),oe=D.compression?8:0,ue=0,ie=0,le=0,ce=0,_e=0,Pe=F.FullPaths[0],We=Pe,Se=F.FileIndex[0],Ze=[],rt=0;for(ie=1;ie<F.FullPaths.length;++ie)if(We=F.FullPaths[ie].slice(Pe.length),Se=F.FileIndex[ie],!(!Se.size||!Se.content||We=="Sh33tJ5")){var Je=ce,nt=Oe(We.length);for(le=0;le<We.length;++le)nt.write_shift(1,We.charCodeAt(le)&127);nt=nt.slice(0,nt.l),Ze[_e]=tF.buf(Se.content,0);var Tt=Se.content;oe==8&&(Tt=I(Tt)),G=Oe(30),G.write_shift(4,67324752),G.write_shift(2,20),G.write_shift(2,ue),G.write_shift(2,oe),Se.mt?s(G,Se.mt):G.write_shift(4,0),G.write_shift(-4,Ze[_e]),G.write_shift(4,Tt.length),G.write_shift(4,Se.content.length),G.write_shift(2,nt.length),G.write_shift(2,0),ce+=G.length,M.push(G),ce+=nt.length,M.push(nt),ce+=Tt.length,M.push(Tt),G=Oe(46),G.write_shift(4,33639248),G.write_shift(2,0),G.write_shift(2,20),G.write_shift(2,ue),G.write_shift(2,oe),G.write_shift(4,0),G.write_shift(-4,Ze[_e]),G.write_shift(4,Tt.length),G.write_shift(4,Se.content.length),G.write_shift(2,nt.length),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(4,0),G.write_shift(4,Je),rt+=G.l,X.push(G),rt+=nt.length,X.push(nt),++_e}return G=Oe(22),G.write_shift(4,101010256),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(2,_e),G.write_shift(2,_e),G.write_shift(4,rt),G.write_shift(4,ce),G.write_shift(2,0),Hr([Hr(M),Hr(X),G])}var ns={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ca(F,j){if(F.ctype)return F.ctype;var D=F.name||"",M=D.match(/\.([^\.]+)$/);return M&&ns[M[1]]||j&&(M=(D=j).match(/[\.\\]([^\.\\])+$/),M&&ns[M[1]])?ns[M[1]]:"application/octet-stream"}function zo(F){for(var j=kc(F),D=[],M=0;M<j.length;M+=76)D.push(j.slice(M,M+76));return D.join(`\r
`)+`\r
`}function Go(F){var j=F.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(le){var ce=le.charCodeAt(0).toString(16).toUpperCase();return"="+(ce.length==1?"0"+ce:ce)});j=j.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),j.charAt(0)==`
`&&(j="=0D"+j.slice(1)),j=j.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var D=[],M=j.split(`\r
`),X=0;X<M.length;++X){var G=M[X];if(G.length==0){D.push("");continue}for(var oe=0;oe<G.length;){var ue=76,ie=G.slice(oe,oe+ue);ie.charAt(ue-1)=="="?ue--:ie.charAt(ue-2)=="="?ue-=2:ie.charAt(ue-3)=="="&&(ue-=3),ie=G.slice(oe,oe+ue),oe+=ue,oe<G.length&&(ie+="="),D.push(ie)}}return D.join(`\r
`)}function vf(F){for(var j=[],D=0;D<F.length;++D){for(var M=F[D];D<=F.length&&M.charAt(M.length-1)=="=";)M=M.slice(0,M.length-1)+F[++D];j.push(M)}for(var X=0;X<j.length;++X)j[X]=j[X].replace(/[=][0-9A-Fa-f]{2}/g,function(G){return String.fromCharCode(parseInt(G.slice(1),16))});return ei(j.join(`\r
`))}function Ce(F,j,D){for(var M="",X="",G="",oe,ue=0;ue<10;++ue){var ie=j[ue];if(!ie||ie.match(/^\s*$/))break;var le=ie.match(/^(.*?):\s*([^\s].*)$/);if(le)switch(le[1].toLowerCase()){case"content-location":M=le[2].trim();break;case"content-type":G=le[2].trim();break;case"content-transfer-encoding":X=le[2].trim();break}}switch(++ue,X.toLowerCase()){case"base64":oe=ei(ci(j.slice(ue).join("")));break;case"quoted-printable":oe=vf(j.slice(ue));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+X)}var ce=tt(F,M.slice(D.length),oe,{unsafe:!0});G&&(ce.ctype=G)}function qe(F,j){if(V(F.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var D=j&&j.root||"",M=(gt&&Buffer.isBuffer(F)?F.toString("binary"):V(F)).split(`\r
`),X=0,G="";for(X=0;X<M.length;++X)if(G=M[X],!!/^Content-Location:/i.test(G)&&(G=G.slice(G.indexOf("file")),D||(D=G.slice(0,G.lastIndexOf("/")+1)),G.slice(0,D.length)!=D))for(;D.length>0&&(D=D.slice(0,D.length-1),D=D.slice(0,D.lastIndexOf("/")+1),G.slice(0,D.length)!=D););var oe=(M[1]||"").match(/boundary="(.*?)"/);if(!oe)throw new Error("MAD cannot find boundary");var ue="--"+(oe[1]||""),ie=[],le=[],ce={FileIndex:ie,FullPaths:le};O(ce);var _e,Pe=0;for(X=0;X<M.length;++X){var We=M[X];We!==ue&&We!==ue+"--"||(Pe++&&Ce(ce,M.slice(_e,X),D),_e=X)}return ce}function pt(F,j){var D=j||{},M=D.boundary||"SheetJS";M="------="+M;for(var X=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+M.slice(2)+'"',"","",""],G=F.FullPaths[0],oe=G,ue=F.FileIndex[0],ie=1;ie<F.FullPaths.length;++ie)if(oe=F.FullPaths[ie].slice(G.length),ue=F.FileIndex[ie],!(!ue.size||!ue.content||oe=="Sh33tJ5")){oe=oe.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(rt){return"_x"+rt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(rt){return"_u"+rt.charCodeAt(0).toString(16)+"_"});for(var le=ue.content,ce=gt&&Buffer.isBuffer(le)?le.toString("binary"):V(le),_e=0,Pe=Math.min(1024,ce.length),We=0,Se=0;Se<=Pe;++Se)(We=ce.charCodeAt(Se))>=32&&We<128&&++_e;var Ze=_e>=Pe*4/5;X.push(M),X.push("Content-Location: "+(D.root||"file:///C:/SheetJS/")+oe),X.push("Content-Transfer-Encoding: "+(Ze?"quoted-printable":"base64")),X.push("Content-Type: "+ca(ue,oe)),X.push(""),X.push(Ze?Go(ce):zo(ce))}return X.push(M+`--\r
`),X.join(`\r
`)}function ut(F){var j={};return O(j,F),j}function tt(F,j,D,M){var X=M&&M.unsafe;X||O(F);var G=!X&&Ye.find(F,j);if(!G){var oe=F.FullPaths[0];j.slice(0,oe.length)==oe?oe=j:(oe.slice(-1)!="/"&&(oe+="/"),oe=(oe+j).replace("//","/")),G={name:i(j),type:2},F.FileIndex.push(G),F.FullPaths.push(oe),X||Ye.utils.cfb_gc(F)}return G.content=D,G.size=D?D.length:0,M&&(M.CLSID&&(G.clsid=M.CLSID),M.mt&&(G.mt=M.mt),M.ct&&(G.ct=M.ct)),G}function mt(F,j){O(F);var D=Ye.find(F,j);if(D){for(var M=0;M<F.FileIndex.length;++M)if(F.FileIndex[M]==D)return F.FileIndex.splice(M,1),F.FullPaths.splice(M,1),!0}return!1}function dr(F,j,D){O(F);var M=Ye.find(F,j);if(M){for(var X=0;X<F.FileIndex.length;++X)if(F.FileIndex[X]==M)return F.FileIndex[X].name=i(D),F.FullPaths[X]=D,!0}return!1}function Zr(F){k(F,!0)}return e.find=A,e.read=b,e.parse=c,e.write=he,e.writeFile=ge,e.utils={cfb_new:ut,cfb_add:tt,cfb_del:mt,cfb_mov:dr,cfb_gc:Zr,ReadShift:fc,CheckField:kS,prep_blob:rn,bconcat:Hr,use_zlib:E,_deflateRaw:Ke,_inflateRaw:Ka,consts:re},e}();let Sa;function rF(r){Sa=r}function nF(r){return typeof r=="string"?Oh(r):Array.isArray(r)?AQ(r):r}function vh(r,e,t){if(typeof Sa<"u"&&Sa.writeFileSync)return t?Sa.writeFileSync(r,e,t):Sa.writeFileSync(r,e);if(typeof Deno<"u"){if(t&&typeof e=="string")switch(t){case"utf8":e=new TextEncoder(t).encode(e);break;case"binary":e=Oh(e);break;default:throw new Error("Unsupported encoding "+t)}return Deno.writeFileSync(r,e)}var n=t=="utf8"?gs(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,r);if(typeof Blob<"u"){var i=new Blob([nF(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,r);if(typeof saveAs<"u")return saveAs(i,r);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:r,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=r,a.href=s,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(r);return o.open("w"),o.encoding="binary",Array.isArray(e)&&(e=Va(e)),o.write(e),o.close(),e}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+r)}function iF(r){if(typeof Sa<"u")return Sa.readFileSync(r);if(typeof Deno<"u")return Deno.readFileSync(r);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(r);e.open("r"),e.encoding="binary";var t=e.read();return e.close(),t}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+r)}function Tr(r){for(var e=Object.keys(r),t=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(r,e[n])&&t.push(e[n]);return t}function ty(r,e){for(var t=[],n=Tr(r),i=0;i!==n.length;++i)t[r[n[i]][e]]==null&&(t[r[n[i]][e]]=n[i]);return t}function S0(r){for(var e=[],t=Tr(r),n=0;n!==t.length;++n)e[r[t[n]]]=t[n];return e}function T0(r){for(var e=[],t=Tr(r),n=0;n!==t.length;++n)e[r[t[n]]]=parseInt(t[n],10);return e}function sF(r){for(var e=[],t=Tr(r),n=0;n!==t.length;++n)e[r[t[n]]]==null&&(e[r[t[n]]]=[]),e[r[t[n]]].push(t[n]);return e}var _d=new Date(1899,11,30,0,0,0);function Vr(r,e){var t=r.getTime(),n=_d.getTime()+(r.getTimezoneOffset()-_d.getTimezoneOffset())*6e4;return(t-n)/(24*60*60*1e3)}var oS=new Date,aF=_d.getTime()+(oS.getTimezoneOffset()-_d.getTimezoneOffset())*6e4,ry=oS.getTimezoneOffset();function C0(r){var e=new Date;return e.setTime(r*24*60*60*1e3+aF),e.getTimezoneOffset()!==ry&&e.setTime(e.getTime()+(e.getTimezoneOffset()-ry)*6e4),e}function oF(r){var e=0,t=0,n=!1,i=r.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+r+"| is not an ISO8601 Duration");for(var s=1;s!=i.length;++s)if(i[s]){switch(t=1,s>3&&(n=!0),i[s].slice(i[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[s].slice(i[s].length-1));case"D":t*=24;case"H":t*=60;case"M":if(n)t*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=t*parseInt(i[s],10)}return e}var ny=new Date("2017-02-19T19:06:09.000Z"),lS=isNaN(ny.getFullYear())?new Date("2/19/17"):ny,lF=lS.getFullYear()==2017;function hr(r,e){var t=new Date(r);if(lF)return e>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):e<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(r instanceof Date)return r;if(lS.getFullYear()==1917&&!isNaN(t.getFullYear())){var n=t.getFullYear();return r.indexOf(""+n)>-1||t.setFullYear(t.getFullYear()+100),t}var i=r.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return r.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function Ao(r,e){if(gt&&Buffer.isBuffer(r)){if(e){if(r[0]==255&&r[1]==254)return gs(r.slice(2).toString("utf16le"));if(r[1]==254&&r[2]==255)return gs(zk(r.slice(2).toString("binary")))}return r.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(r[0]==255&&r[1]==254)return gs(new TextDecoder("utf-16le").decode(r.slice(2)));if(r[0]==254&&r[1]==255)return gs(new TextDecoder("utf-16be").decode(r.slice(2)))}var t={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(r)&&(r=new Uint8Array(r)),new TextDecoder("latin1").decode(r).replace(/[]/g,function(s){return t[s]||s})}catch{}for(var n=[],i=0;i!=r.length;++i)n.push(String.fromCharCode(r[i]));return n.join("")}function Kt(r){if(typeof JSON<"u"&&!Array.isArray(r))return JSON.parse(JSON.stringify(r));if(typeof r!="object"||r==null)return r;if(r instanceof Date)return new Date(r.getTime());var e={};for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=Kt(r[t]));return e}function _r(r,e){for(var t="";t.length<e;)t+=r;return t}function Vi(r){var e=Number(r);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(r))return e;var t=1,n=r.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return t=-t,s}),!isNaN(e=Number(n)))?e/t:e}var fF=["january","february","march","april","may","june","july","august","september","october","november","december"];function Dl(r){var e=new Date(r),t=new Date(NaN),n=e.getYear(),i=e.getMonth(),s=e.getDate();if(isNaN(s))return t;var a=r.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&fF.indexOf(a)==-1)return t}else if(a.match(/[a-z]/))return t;return n<0||n>8099?t:(i>0||s>1)&&n!=101?e:r.match(/[^-0-9:,\/\\]/)?t:e}var cF=function(){var r="abacaba".split(/(:?b)/i).length==5;return function(t,n,i){if(r||typeof n=="string")return t.split(n);for(var s=t.split(n),a=[s[0]],o=1;o<s.length;++o)a.push(i),a.push(s[o]);return a}}();function fS(r){return r?r.content&&r.type?Ao(r.content,!0):r.data?ul(r.data):r.asNodeBuffer&&gt?ul(r.asNodeBuffer().toString("binary")):r.asBinary?ul(r.asBinary()):r._data&&r._data.getContent?ul(Ao(Array.prototype.slice.call(r._data.getContent(),0))):null:null}function cS(r){if(!r)return null;if(r.data)return vd(r.data);if(r.asNodeBuffer&&gt)return r.asNodeBuffer();if(r._data&&r._data.getContent){var e=r._data.getContent();return typeof e=="string"?vd(e):Array.prototype.slice.call(e)}return r.content&&r.type?r.content:null}function hF(r){return r&&r.name.slice(-4)===".bin"?cS(r):fS(r)}function vi(r,e){for(var t=r.FullPaths||Tr(r.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),s=0;s<t.length;++s){var a=t[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==a||i==a)return r.files?r.files[t[s]]:r.FileIndex[s]}return null}function gO(r,e){var t=vi(r,e);if(t==null)throw new Error("Cannot find file "+e+" in zip");return t}function Nr(r,e,t){if(!t)return hF(gO(r,e));if(!e)return null;try{return Nr(r,e)}catch{return null}}function ti(r,e,t){if(!t)return fS(gO(r,e));if(!e)return null;try{return ti(r,e)}catch{return null}}function uF(r,e,t){return cS(gO(r,e))}function iy(r){for(var e=r.FullPaths||Tr(r.files),t=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&t.push(e[n].replace(/^Root Entry[\/]/,""));return t.sort()}function dt(r,e,t){if(r.FullPaths){if(typeof t=="string"){var n;return gt?n=ta(t):n=EQ(t),Ye.utils.cfb_add(r,e,n)}Ye.utils.cfb_add(r,e,t)}else r.file(e,t)}function OO(){return Ye.utils.cfb_new()}function hS(r,e){switch(e.type){case"base64":return Ye.read(r,{type:"base64"});case"binary":return Ye.read(r,{type:"binary"});case"buffer":case"array":return Ye.read(r,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function Wf(r,e){if(r.charAt(0)=="/")return r.slice(1);var t=e.split("/");e.slice(-1)!="/"&&t.pop();for(var n=r.split("/");n.length!==0;){var i=n.shift();i===".."?t.pop():i!=="."&&t.push(i)}return t.join("/")}var Rr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,dF=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,sy=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,pF=/<[^>]*>/g,An=Rr.match(sy)?sy:pF,mF=/<\w*:/,gF=/<(\/?)\w+:/;function at(r,e,t){for(var n={},i=0,s=0;i!==r.length&&!((s=r.charCodeAt(i))===32||s===10||s===13);++i);if(e||(n[0]=r.slice(0,i)),i===r.length)return n;var a=r.match(dF),o=0,l="",f=0,c="",h="",u=1;if(a)for(f=0;f!=a.length;++f){for(h=a[f],s=0;s!=h.length&&h.charCodeAt(s)!==61;++s);for(c=h.slice(0,s).trim();h.charCodeAt(s+1)==32;)++s;for(u=(i=h.charCodeAt(s+1))==34||i==39?1:0,l=h.slice(s+1+u,h.length-u),o=0;o!=c.length&&c.charCodeAt(o)!==58;++o);if(o===c.length)c.indexOf("_")>0&&(c=c.slice(0,c.indexOf("_"))),n[c]=l,n[c.toLowerCase()]=l;else{var d=(o===5&&c.slice(0,5)==="xmlns"?"xmlns":"")+c.slice(o+1);if(n[d]&&c.slice(o-3,o)=="ext")continue;n[d]=l,n[d.toLowerCase()]=l}}return n}function Ps(r){return r.replace(gF,"<$1")}var uS={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},xO=S0(uS),Pt=function(){var r=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function t(n){var i=n+"",s=i.indexOf("<![CDATA[");if(s==-1)return i.replace(r,function(o,l){return uS[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(e,function(o,l){return String.fromCharCode(parseInt(l,16))});var a=i.indexOf("]]>");return t(i.slice(0,s))+i.slice(s+9,a)+t(i.slice(a+3))}}(),vO=/[&<>'"]/g,OF=/[\u0000-\u0008\u000b-\u001f]/g;function Ut(r){var e=r+"";return e.replace(vO,function(t){return xO[t]}).replace(OF,function(t){return"_x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+"_"})}function ay(r){return Ut(r).replace(/ /g,"_x0020_")}var dS=/[\u0000-\u001f]/g;function yO(r){var e=r+"";return e.replace(vO,function(t){return xO[t]}).replace(/\n/g,"<br/>").replace(dS,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}function xF(r){var e=r+"";return e.replace(vO,function(t){return xO[t]}).replace(dS,function(t){return"&#x"+t.charCodeAt(0).toString(16).toUpperCase()+";"})}var oy=function(){var r=/&#(\d+);/g;function e(t,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(r,e)}}();function vF(r){return r.replace(/(\r\n|[\r\n])/g,"&#10;")}function fr(r){switch(r){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function up(r){for(var e="",t=0,n=0,i=0,s=0,a=0,o=0;t<r.length;){if(n=r.charCodeAt(t++),n<128){e+=String.fromCharCode(n);continue}if(i=r.charCodeAt(t++),n>191&&n<224){a=(n&31)<<6,a|=i&63,e+=String.fromCharCode(a);continue}if(s=r.charCodeAt(t++),n<240){e+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}a=r.charCodeAt(t++),o=((n&7)<<18|(i&63)<<12|(s&63)<<6|a&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function ly(r){var e=Fa(2*r.length),t,n,i=1,s=0,a=0,o;for(n=0;n<r.length;n+=i)i=1,(o=r.charCodeAt(n))<128?t=o:o<224?(t=(o&31)*64+(r.charCodeAt(n+1)&63),i=2):o<240?(t=(o&15)*4096+(r.charCodeAt(n+1)&63)*64+(r.charCodeAt(n+2)&63),i=3):(i=4,t=(o&7)*262144+(r.charCodeAt(n+1)&63)*4096+(r.charCodeAt(n+2)&63)*64+(r.charCodeAt(n+3)&63),t-=65536,a=55296+(t>>>10&1023),t=56320+(t&1023)),a!==0&&(e[s++]=a&255,e[s++]=a>>>8,a=0),e[s++]=t%256,e[s++]=t>>>8;return e.slice(0,s).toString("ucs2")}function fy(r){return ta(r,"binary").toString("utf8")}var Uh="foo bar baz",qt=gt&&(fy(Uh)==up(Uh)&&fy||ly(Uh)==up(Uh)&&ly)||up,gs=gt?function(r){return ta(r,"utf8").toString("binary")}:function(r){for(var e=[],t=0,n=0,i=0;t<r.length;)switch(n=r.charCodeAt(t++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=r.charCodeAt(t++)-56320+(n<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},Tc=function(){var r={};return function(t,n){var i=t+"|"+(n||"");return r[i]?r[i]:r[i]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",n||"")}}(),pS=function(){var r=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(t){for(var n=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<r.length;++i)n=n.replace(r[i][0],r[i][1]);return n}}(),yF=function(){var r={};return function(t){return r[t]!==void 0?r[t]:r[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}}(),wF=/<\/?(?:vt:)?variant>/g,bF=/<(?:vt:)([^>]*)>([\s\S]*)</;function cy(r,e){var t=at(r),n=r.match(yF(t.baseType))||[],i=[];if(n.length!=t.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+t.size);return i}return n.forEach(function(s){var a=s.replace(wF,"").match(bF);a&&i.push({v:qt(a[2]),t:a[1]})}),i}var mS=/(^\s|\s$|\n)/;function cn(r,e){return"<"+r+(e.match(mS)?' xml:space="preserve"':"")+">"+e+"</"+r+">"}function Cc(r){return Tr(r).map(function(e){return" "+e+'="'+r[e]+'"'}).join("")}function Fe(r,e,t){return"<"+r+(t!=null?Cc(t):"")+(e!=null?(e.match(mS)?' xml:space="preserve"':"")+">"+e+"</"+r:"/")+">"}function Um(r,e){try{return r.toISOString().replace(/\.\d*/,"")}catch(t){if(e)throw t}return""}function _F(r,e){switch(typeof r){case"string":var t=Fe("vt:lpwstr",Ut(r));return t=t.replace(/&quot;/g,"_x0022_"),t;case"number":return Fe((r|0)==r?"vt:i4":"vt:r8",Ut(String(r)));case"boolean":return Fe("vt:bool",r?"true":"false")}if(r instanceof Date)return Fe("vt:filetime",Um(r));throw new Error("Unable to serialize "+r)}function wO(r){if(gt&&Buffer.isBuffer(r))return r.toString("utf8");if(typeof r=="string")return r;if(typeof Uint8Array<"u"&&r instanceof Uint8Array)return qt(Va(dO(r)));throw new Error("Bad input format: expected Buffer or string")}var Ac=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Xr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Zo=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Jn={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function kF(r,e){for(var t=1-2*(r[e+7]>>>7),n=((r[e+7]&127)<<4)+(r[e+6]>>>4&15),i=r[e+6]&15,s=5;s>=0;--s)i=i*256+r[e+s];return n==2047?i==0?t*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),t*Math.pow(2,n-52)*i)}function SF(r,e,t){var n=(e<0||1/e==-1/0?1:0)<<7,i=0,s=0,a=n?-e:e;isFinite(a)?a==0?i=s=0:(i=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(e)?26985:0);for(var o=0;o<=5;++o,s/=256)r[t+o]=s&255;r[t+6]=(i&15)<<4|s&15,r[t+7]=i>>4|n}var hy=function(r){for(var e=[],t=10240,n=0;n<r[0].length;++n)if(r[0][n])for(var i=0,s=r[0][n].length;i<s;i+=t)e.push.apply(e,r[0][n].slice(i,i+t));return e},uy=gt?function(r){return r[0].length>0&&Buffer.isBuffer(r[0][0])?Buffer.concat(r[0].map(function(e){return Buffer.isBuffer(e)?e:ta(e)})):hy(r)}:hy,dy=function(r,e,t){for(var n=[],i=e;i<t;i+=2)n.push(String.fromCharCode(Ws(r,i)));return n.join("").replace(_n,"")},A0=gt?function(r,e,t){return Buffer.isBuffer(r)?r.toString("utf16le",e,t).replace(_n,""):dy(r,e,t)}:dy,py=function(r,e,t){for(var n=[],i=e;i<e+t;++i)n.push(("0"+r[i].toString(16)).slice(-2));return n.join("")},gS=gt?function(r,e,t){return Buffer.isBuffer(r)?r.toString("hex",e,e+t):py(r,e,t)}:py,my=function(r,e,t){for(var n=[],i=e;i<t;i++)n.push(String.fromCharCode(ll(r,i)));return n.join("")},cf=gt?function(e,t,n){return Buffer.isBuffer(e)?e.toString("utf8",t,n):my(e,t,n)}:my,OS=function(r,e){var t=zr(r,e);return t>0?cf(r,e+4,e+4+t-1):""},bO=OS,xS=function(r,e){var t=zr(r,e);return t>0?cf(r,e+4,e+4+t-1):""},_O=xS,vS=function(r,e){var t=2*zr(r,e);return t>0?cf(r,e+4,e+4+t-1):""},kO=vS,yS=function(e,t){var n=zr(e,t);return n>0?A0(e,t+4,t+4+n):""},SO=yS,wS=function(r,e){var t=zr(r,e);return t>0?cf(r,e+4,e+4+t):""},TO=wS,bS=function(r,e){return kF(r,e)},kd=bS,CO=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};gt&&(bO=function(e,t){if(!Buffer.isBuffer(e))return OS(e,t);var n=e.readUInt32LE(t);return n>0?e.toString("utf8",t+4,t+4+n-1):""},_O=function(e,t){if(!Buffer.isBuffer(e))return xS(e,t);var n=e.readUInt32LE(t);return n>0?e.toString("utf8",t+4,t+4+n-1):""},kO=function(e,t){if(!Buffer.isBuffer(e))return vS(e,t);var n=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+n-1)},SO=function(e,t){if(!Buffer.isBuffer(e))return yS(e,t);var n=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+n)},TO=function(e,t){if(!Buffer.isBuffer(e))return wS(e,t);var n=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+n)},kd=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):bS(e,t)},CO=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});function _S(){A0=function(r,e,t){return St.utils.decode(1200,r.slice(e,t)).replace(_n,"")},cf=function(r,e,t){return St.utils.decode(65001,r.slice(e,t))},bO=function(r,e){var t=zr(r,e);return t>0?St.utils.decode(To,r.slice(e+4,e+4+t-1)):""},_O=function(r,e){var t=zr(r,e);return t>0?St.utils.decode(fi,r.slice(e+4,e+4+t-1)):""},kO=function(r,e){var t=2*zr(r,e);return t>0?St.utils.decode(1200,r.slice(e+4,e+4+t-1)):""},SO=function(r,e){var t=zr(r,e);return t>0?St.utils.decode(1200,r.slice(e+4,e+4+t)):""},TO=function(r,e){var t=zr(r,e);return t>0?St.utils.decode(65001,r.slice(e+4,e+4+t)):""}}typeof St<"u"&&_S();var ll=function(r,e){return r[e]},Ws=function(r,e){return r[e+1]*256+r[e]},TF=function(r,e){var t=r[e+1]*256+r[e];return t<32768?t:(65535-t+1)*-1},zr=function(r,e){return r[e+3]*(1<<24)+(r[e+2]<<16)+(r[e+1]<<8)+r[e]},co=function(r,e){return r[e+3]<<24|r[e+2]<<16|r[e+1]<<8|r[e]},CF=function(r,e){return r[e]<<24|r[e+1]<<16|r[e+2]<<8|r[e+3]};function fc(r,e){var t="",n,i,s=[],a,o,l,f;switch(e){case"dbcs":if(f=this.l,gt&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*r).toString("utf16le");else for(l=0;l<r;++l)t+=String.fromCharCode(Ws(this,f)),f+=2;r*=2;break;case"utf8":t=cf(this,this.l,this.l+r);break;case"utf16le":r*=2,t=A0(this,this.l,this.l+r);break;case"wstr":if(typeof St<"u")t=St.utils.decode(fi,this.slice(this.l,this.l+2*r));else return fc.call(this,r,"dbcs");r=2*r;break;case"lpstr-ansi":t=bO(this,this.l),r=4+zr(this,this.l);break;case"lpstr-cp":t=_O(this,this.l),r=4+zr(this,this.l);break;case"lpwstr":t=kO(this,this.l),r=4+2*zr(this,this.l);break;case"lpp4":r=4+zr(this,this.l),t=SO(this,this.l),r&2&&(r+=2);break;case"8lpp4":r=4+zr(this,this.l),t=TO(this,this.l),r&3&&(r+=4-(r&3));break;case"cstr":for(r=0,t="";(a=ll(this,this.l+r++))!==0;)s.push(Bf(a));t=s.join("");break;case"_wstr":for(r=0,t="";(a=Ws(this,this.l+r))!==0;)s.push(Bf(a)),r+=2;r+=2,t=s.join("");break;case"dbcs-cont":for(t="",f=this.l,l=0;l<r;++l){if(this.lens&&this.lens.indexOf(f)!==-1)return a=ll(this,f),this.l=f+1,o=fc.call(this,r-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Bf(Ws(this,f))),f+=2}t=s.join(""),r*=2;break;case"cpstr":if(typeof St<"u"){t=St.utils.decode(fi,this.slice(this.l,this.l+r));break}case"sbcs-cont":for(t="",f=this.l,l=0;l!=r;++l){if(this.lens&&this.lens.indexOf(f)!==-1)return a=ll(this,f),this.l=f+1,o=fc.call(this,r-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Bf(ll(this,f))),f+=1}t=s.join("");break;default:switch(r){case 1:return n=ll(this,this.l),this.l++,n;case 2:return n=(e==="i"?TF:Ws)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(n=(r>0?co:CF)(this,this.l),this.l+=4,n):(i=zr(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return r==8?i=kd(this,this.l):i=kd([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;r=8;case 16:t=gS(this,this.l,r);break}}return this.l+=r,t}var AF=function(r,e,t){r[t]=e&255,r[t+1]=e>>>8&255,r[t+2]=e>>>16&255,r[t+3]=e>>>24&255},EF=function(r,e,t){r[t]=e&255,r[t+1]=e>>8&255,r[t+2]=e>>16&255,r[t+3]=e>>24&255},PF=function(r,e,t){r[t]=e&255,r[t+1]=e>>>8&255};function RF(r,e,t){var n=0,i=0;if(t==="dbcs"){for(i=0;i!=e.length;++i)PF(this,e.charCodeAt(i),this.l+2*i);n=2*e.length}else if(t==="sbcs"){if(typeof St<"u"&&To==874)for(i=0;i!=e.length;++i){var s=St.utils.encode(To,e.charAt(i));this[this.l+i]=s[0]}else for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;n=e.length}else if(t==="hex"){for(;i<r;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(t==="utf16le"){var a=Math.min(this.l+r,this.length);for(i=0;i<Math.min(e.length,r);++i){var o=e.charCodeAt(i);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(r){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,AF(this,e,this.l);break;case 8:if(n=8,t==="f"){SF(this,e,this.l);break}case 16:break;case-4:n=4,EF(this,e,this.l);break}return this.l+=n,this}function kS(r,e){var t=gS(this,this.l,r.length>>1);if(t!==r)throw new Error(e+"Expected "+r+" saw "+t);this.l+=r.length>>1}function rn(r,e){r.l=e,r.read_shift=fc,r.chk=kS,r.write_shift=RF}function Sn(r,e){r.l+=e}function Oe(r){var e=Fa(r);return rn(e,0),e}function ra(r,e,t){if(r){var n,i,s;rn(r,r.l||0);for(var a=r.length,o=0,l=0;r.l<a;){o=r.read_shift(1),o&128&&(o=(o&127)+((r.read_shift(1)&127)<<7));var f=$c[o]||$c[65535];for(n=r.read_shift(1),s=n&127,i=1;i<4&&n&128;++i)s+=((n=r.read_shift(1))&127)<<7*i;l=r.l+s;var c=f.f&&f.f(r,s,t);if(r.l=l,e(c,f,o))return}}}function zn(){var r=[],e=gt?256:2048,t=function(f){var c=Oe(f);return rn(c,0),c},n=t(e),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&r.push(n),n=null)},s=function(f){return n&&f<n.length-n.l?n:(i(),n=t(Math.max(f+1,e)))},a=function(){return i(),Hr(r)},o=function(f){i(),n=f,n.l==null&&(n.l=n.length),s(e)};return{next:s,push:o,end:a,_bufs:r}}function we(r,e,t,n){var i=+e,s;if(!isNaN(i)){n||(n=$c[i].p||(t||[]).length||0),s=1+(i>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var a=r.next(s);i<=127?a.write_shift(1,i):(a.write_shift(1,(i&127)+128),a.write_shift(1,i>>7));for(var o=0;o!=4;++o)if(n>=128)a.write_shift(1,(n&127)+128),n>>=7;else{a.write_shift(1,n);break}n>0&&CO(t)&&r.push(t)}}function cc(r,e,t){var n=Kt(r);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!t||t.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function gy(r,e,t){var n=Kt(r);return n.s=cc(n.s,e.s,t),n.e=cc(n.e,e.s,t),n}function hc(r,e){if(r.cRel&&r.c<0)for(r=Kt(r);r.c<0;)r.c+=e>8?16384:256;if(r.rRel&&r.r<0)for(r=Kt(r);r.r<0;)r.r+=e>8?1048576:e>5?65536:16384;var t=it(r);return!r.cRel&&r.cRel!=null&&(t=$F(t)),!r.rRel&&r.rRel!=null&&(t=QF(t)),t}function dp(r,e){return r.s.r==0&&!r.s.rRel&&r.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!r.e.rRel?(r.s.cRel?"":"$")+cr(r.s.c)+":"+(r.e.cRel?"":"$")+cr(r.e.c):r.s.c==0&&!r.s.cRel&&r.e.c==(e.biff>=12?16383:255)&&!r.e.cRel?(r.s.rRel?"":"$")+kr(r.s.r)+":"+(r.e.rRel?"":"$")+kr(r.e.r):hc(r.s,e.biff)+":"+hc(r.e,e.biff)}function AO(r){return parseInt(FF(r),10)-1}function kr(r){return""+(r+1)}function QF(r){return r.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function FF(r){return r.replace(/\$(\d+)$/,"$1")}function EO(r){for(var e=NF(r),t=0,n=0;n!==e.length;++n)t=26*t+e.charCodeAt(n)-64;return t-1}function cr(r){if(r<0)throw new Error("invalid column "+r);var e="";for(++r;r;r=Math.floor((r-1)/26))e=String.fromCharCode((r-1)%26+65)+e;return e}function $F(r){return r.replace(/^([A-Z])/,"$$$1")}function NF(r){return r.replace(/^\$([A-Z])/,"$1")}function DF(r){return r.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function wr(r){for(var e=0,t=0,n=0;n<r.length;++n){var i=r.charCodeAt(n);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(t=26*t+(i-64))}return{c:t-1,r:e-1}}function it(r){for(var e=r.c+1,t="";e;e=(e-1)/26|0)t=String.fromCharCode((e-1)%26+65)+t;return t+(r.r+1)}function Dn(r){var e=r.indexOf(":");return e==-1?{s:wr(r),e:wr(r)}:{s:wr(r.slice(0,e)),e:wr(r.slice(e+1))}}function ht(r,e){return typeof e>"u"||typeof e=="number"?ht(r.s,r.e):(typeof r!="string"&&(r=it(r)),typeof e!="string"&&(e=it(e)),r==e?r:r+":"+e)}function wt(r){var e={s:{c:0,r:0},e:{c:0,r:0}},t=0,n=0,i=0,s=r.length;for(t=0;n<s&&!((i=r.charCodeAt(n)-64)<1||i>26);++n)t=26*t+i;for(e.s.c=--t,t=0;n<s&&!((i=r.charCodeAt(n)-48)<0||i>9);++n)t=10*t+i;if(e.s.r=--t,n===s||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,t=0;n!=s&&!((i=r.charCodeAt(n)-64)<1||i>26);++n)t=26*t+i;for(e.e.c=--t,t=0;n!=s&&!((i=r.charCodeAt(n)-48)<0||i>9);++n)t=10*t+i;return e.e.r=--t,e}function Oy(r,e){var t=r.t=="d"&&e instanceof Date;if(r.z!=null)try{return r.w=hi(r.z,t?Vr(e):e)}catch{}try{return r.w=hi((r.XF||{}).numFmtId||(t?14:0),t?Vr(e):e)}catch{return""+e}}function _s(r,e,t){return r==null||r.t==null||r.t=="z"?"":r.w!==void 0?r.w:(r.t=="d"&&!r.z&&t&&t.dateNF&&(r.z=t.dateNF),r.t=="e"?na[r.v]||r.v:e==null?Oy(r,r.v):Oy(r,e))}function qa(r,e){var t=e&&e.sheet?e.sheet:"Sheet1",n={};return n[t]=r,{SheetNames:[t],Sheets:n}}function SS(r,e,t){var n=t||{},i=r?Array.isArray(r):n.dense,s=r||(i?[]:{}),a=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?wr(n.origin):n.origin;a=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var f={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var c=wt(s["!ref"]);f.s.c=c.s.c,f.s.r=c.s.r,f.e.c=Math.max(f.e.c,c.e.c),f.e.r=Math.max(f.e.r,c.e.r),a==-1&&(f.e.r=a=c.e.r+1)}for(var h=0;h!=e.length;++h)if(e[h]){if(!Array.isArray(e[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var u=0;u!=e[h].length;++u)if(!(typeof e[h][u]>"u")){var d={v:e[h][u]},p=a+h,m=o+u;if(f.s.r>p&&(f.s.r=p),f.s.c>m&&(f.s.c=m),f.e.r<p&&(f.e.r=p),f.e.c<m&&(f.e.c=m),e[h][u]&&typeof e[h][u]=="object"&&!Array.isArray(e[h][u])&&!(e[h][u]instanceof Date))d=e[h][u];else if(Array.isArray(d.v)&&(d.f=e[h][u][1],d.v=d.v[0]),d.v===null)if(d.f)d.t="n";else if(n.nullError)d.t="e",d.v=0;else if(n.sheetStubs)d.t="z";else continue;else typeof d.v=="number"?d.t="n":typeof d.v=="boolean"?d.t="b":d.v instanceof Date?(d.z=n.dateNF||et[14],n.cellDates?(d.t="d",d.w=hi(d.z,Vr(d.v))):(d.t="n",d.v=Vr(d.v),d.w=hi(d.z,d.v))):d.t="s";if(i)s[p]||(s[p]=[]),s[p][m]&&s[p][m].z&&(d.z=s[p][m].z),s[p][m]=d;else{var g=it({c:m,r:p});s[g]&&s[g].z&&(d.z=s[g].z),s[g]=d}}}return f.s.c<1e7&&(s["!ref"]=ht(f)),s}function hf(r,e){return SS(null,r,e)}function MF(r){return r.read_shift(4,"i")}function qi(r,e){return e||(e=Oe(4)),e.write_shift(4,r),e}function kn(r){var e=r.read_shift(4);return e===0?"":r.read_shift(e,"dbcs")}function Kr(r,e){var t=!1;return e==null&&(t=!0,e=Oe(4+2*r.length)),e.write_shift(4,r.length),r.length>0&&e.write_shift(0,r,"dbcs"),t?e.slice(0,e.l):e}function IF(r){return{ich:r.read_shift(2),ifnt:r.read_shift(2)}}function LF(r,e){return e||(e=Oe(4)),e.write_shift(2,0),e.write_shift(2,0),e}function PO(r,e){var t=r.l,n=r.read_shift(1),i=kn(r),s=[],a={t:i,h:i};if(n&1){for(var o=r.read_shift(4),l=0;l!=o;++l)s.push(IF(r));a.r=s}else a.r=[{ich:0,ifnt:0}];return r.l=t+e,a}function BF(r,e){var t=!1;return e==null&&(t=!0,e=Oe(15+4*r.t.length)),e.write_shift(1,0),Kr(r.t,e),t?e.slice(0,e.l):e}var ZF=PO;function WF(r,e){var t=!1;return e==null&&(t=!0,e=Oe(23+4*r.t.length)),e.write_shift(1,1),Kr(r.t,e),e.write_shift(4,1),LF({ich:0,ifnt:0},e),t?e.slice(0,e.l):e}function Qi(r){var e=r.read_shift(4),t=r.read_shift(2);return t+=r.read_shift(1)<<16,r.l++,{c:e,iStyleRef:t}}function Wo(r,e){return e==null&&(e=Oe(8)),e.write_shift(-4,r.c),e.write_shift(3,r.iStyleRef||r.s),e.write_shift(1,0),e}function Uo(r){var e=r.read_shift(2);return e+=r.read_shift(1)<<16,r.l++,{c:-1,iStyleRef:e}}function Xo(r,e){return e==null&&(e=Oe(4)),e.write_shift(3,r.iStyleRef||r.s),e.write_shift(1,0),e}var UF=kn,TS=Kr;function RO(r){var e=r.read_shift(4);return e===0||e===4294967295?"":r.read_shift(e,"dbcs")}function Sd(r,e){var t=!1;return e==null&&(t=!0,e=Oe(127)),e.write_shift(4,r.length>0?r.length:4294967295),r.length>0&&e.write_shift(0,r,"dbcs"),t?e.slice(0,e.l):e}var XF=kn,Xm=RO,QO=Sd;function FO(r){var e=r.slice(r.l,r.l+4),t=e[0]&1,n=e[0]&2;r.l+=4;var i=n===0?kd([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):co(e,0)>>2;return t?i/100:i}function CS(r,e){e==null&&(e=Oe(4));var t=0,n=0,i=r*100;if(r==(r|0)&&r>=-536870912&&r<1<<29?n=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(n=1,t=1),n)e.write_shift(-4,((t?i:r)<<2)+(t+2));else throw new Error("unsupported RkNumber "+r)}function AS(r){var e={s:{},e:{}};return e.s.r=r.read_shift(4),e.e.r=r.read_shift(4),e.s.c=r.read_shift(4),e.e.c=r.read_shift(4),e}function VF(r,e){return e||(e=Oe(16)),e.write_shift(4,r.s.r),e.write_shift(4,r.e.r),e.write_shift(4,r.s.c),e.write_shift(4,r.e.c),e}var Vo=AS,uf=VF;function yn(r){if(r.length-r.l<8)throw"XLS Xnum Buffer underflow";return r.read_shift(8,"f")}function Eo(r,e){return(e||Oe(8)).write_shift(8,r,"f")}function qF(r){var e={},t=r.read_shift(1),n=t>>>1,i=r.read_shift(1),s=r.read_shift(2,"i"),a=r.read_shift(1),o=r.read_shift(1),l=r.read_shift(1);switch(r.l++,n){case 0:e.auto=1;break;case 1:e.index=i;var f=xo[i];f&&(e.rgb=Pc(f));break;case 2:e.rgb=Pc([a,o,l]);break;case 3:e.theme=i;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function Td(r,e){if(e||(e=Oe(8)),!r||r.auto)return e.write_shift(4,0),e.write_shift(4,0),e;r.index!=null?(e.write_shift(1,2),e.write_shift(1,r.index)):r.theme!=null?(e.write_shift(1,6),e.write_shift(1,r.theme)):(e.write_shift(1,5),e.write_shift(1,0));var t=r.tint||0;if(t>0?t*=32767:t<0&&(t*=32768),e.write_shift(2,t),!r.rgb||r.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=r.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function jF(r){var e=r.read_shift(1);r.l++;var t={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return t}function zF(r,e){e||(e=Oe(2));var t=(r.italic?2:0)|(r.strike?8:0)|(r.outline?16:0)|(r.shadow?32:0)|(r.condense?64:0)|(r.extend?128:0);return e.write_shift(1,t),e.write_shift(1,0),e}function ES(r,e){var t={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=r.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return t[r.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return r.l-=4,r.read_shift(0,e==1?"lpstr":"lpwstr")}function GF(r){return ES(r,1)}function HF(r){return ES(r,2)}var $O=2,Zn=3,Xh=11,xy=12,Cd=19,Vh=64,YF=65,KF=71,JF=4108,e$=4126,jr=80,PS=81,t$=[jr,PS],Vm={1:{n:"CodePage",t:$O},2:{n:"Category",t:jr},3:{n:"PresentationFormat",t:jr},4:{n:"ByteCount",t:Zn},5:{n:"LineCount",t:Zn},6:{n:"ParagraphCount",t:Zn},7:{n:"SlideCount",t:Zn},8:{n:"NoteCount",t:Zn},9:{n:"HiddenCount",t:Zn},10:{n:"MultimediaClipCount",t:Zn},11:{n:"ScaleCrop",t:Xh},12:{n:"HeadingPairs",t:JF},13:{n:"TitlesOfParts",t:e$},14:{n:"Manager",t:jr},15:{n:"Company",t:jr},16:{n:"LinksUpToDate",t:Xh},17:{n:"CharacterCount",t:Zn},19:{n:"SharedDoc",t:Xh},22:{n:"HyperlinksChanged",t:Xh},23:{n:"AppVersion",t:Zn,p:"version"},24:{n:"DigSig",t:YF},26:{n:"ContentType",t:jr},27:{n:"ContentStatus",t:jr},28:{n:"Language",t:jr},29:{n:"Version",t:jr},255:{},2147483648:{n:"Locale",t:Cd},2147483651:{n:"Behavior",t:Cd},1919054434:{}},qm={1:{n:"CodePage",t:$O},2:{n:"Title",t:jr},3:{n:"Subject",t:jr},4:{n:"Author",t:jr},5:{n:"Keywords",t:jr},6:{n:"Comments",t:jr},7:{n:"Template",t:jr},8:{n:"LastAuthor",t:jr},9:{n:"RevNumber",t:jr},10:{n:"EditTime",t:Vh},11:{n:"LastPrinted",t:Vh},12:{n:"CreatedDate",t:Vh},13:{n:"ModifiedDate",t:Vh},14:{n:"PageCount",t:Zn},15:{n:"WordCount",t:Zn},16:{n:"CharCount",t:Zn},17:{n:"Thumbnail",t:KF},18:{n:"Application",t:jr},19:{n:"DocSecurity",t:Zn},255:{},2147483648:{n:"Locale",t:Cd},2147483651:{n:"Behavior",t:Cd},1919054434:{}},vy={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},r$=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function n$(r){return r.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var i$=n$([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),xo=Kt(i$),na={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},RS={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},jm={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},qh={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function NO(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function s$(r){var e=NO();if(!r||!r.match)return e;var t={};if((r.match(An)||[]).forEach(function(n){var i=at(n);switch(i[0].replace(mF,"<")){case"<?xml":break;case"<Types":e.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":t[i.Extension]=i.ContentType;break;case"<Override":e[jm[i.ContentType]]!==void 0&&e[jm[i.ContentType]].push(i.PartName);break}}),e.xmlns!==Xr.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=t,delete e.calcchains,e}function QS(r,e){var t=sF(jm),n=[],i;n[n.length]=Rr,n[n.length]=Fe("Types",null,{xmlns:Xr.CT,"xmlns:xsd":Xr.xsd,"xmlns:xsi":Xr.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return Fe("Default",null,{Extension:l[0],ContentType:l[1]})}));var s=function(l){r[l]&&r[l].length>0&&(i=r[l][0],n[n.length]=Fe("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:qh[l][e.bookType]||qh[l].xlsx}))},a=function(l){(r[l]||[]).forEach(function(f){n[n.length]=Fe("Override",null,{PartName:(f[0]=="/"?"":"/")+f,ContentType:qh[l][e.bookType]||qh[l].xlsx})})},o=function(l){(r[l]||[]).forEach(function(f){n[n.length]=Fe("Override",null,{PartName:(f[0]=="/"?"":"/")+f,ContentType:t[l][0]})})};return s("workbooks"),a("sheets"),a("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),a("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var yt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Ec(r){var e=r.lastIndexOf("/");return r.slice(0,e+1)+"_rels/"+r.slice(e+1)+".rels"}function uc(r,e){var t={"!id":{}};if(!r)return t;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(r.match(An)||[]).forEach(function(i){var s=at(i);if(s[0]==="<Relationship"){var a={};a.Type=s.Type,a.Target=s.Target,a.Id=s.Id,s.TargetMode&&(a.TargetMode=s.TargetMode);var o=s.TargetMode==="External"?s.Target:Wf(s.Target,e);t[o]=a,n[s.Id]=a}}),t["!id"]=n,t}function _l(r){var e=[Rr,Fe("Relationships",null,{xmlns:Xr.RELS})];return Tr(r["!id"]).forEach(function(t){e[e.length]=Fe("Relationship",null,r["!id"][t])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function Wt(r,e,t,n,i,s){if(i||(i={}),r["!id"]||(r["!id"]={}),r["!idx"]||(r["!idx"]=1),e<0)for(e=r["!idx"];r["!id"]["rId"+e];++e);if(r["!idx"]=e+1,i.Id="rId"+e,i.Type=n,i.Target=t,[yt.HLINK,yt.XPATH,yt.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),r["!id"][i.Id])throw new Error("Cannot rewrite rId "+e);return r["!id"][i.Id]=i,r[("/"+i.Target).replace("//","/")]=i,e}var a$="application/vnd.oasis.opendocument.spreadsheet";function o$(r,e){for(var t=wO(r),n,i;n=Ac.exec(t);)switch(n[3]){case"manifest":break;case"file-entry":if(i=at(n[0],!1),i.path=="/"&&i.type!==a$)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}function l$(r){var e=[Rr];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var t=0;t<r.length;++t)e.push('  <manifest:file-entry manifest:full-path="'+r[t][0]+'" manifest:media-type="'+r[t][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function yy(r,e,t){return['  <rdf:Description rdf:about="'+r+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(t||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function f$(r,e){return['  <rdf:Description rdf:about="'+r+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function c$(r){var e=[Rr];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var t=0;t!=r.length;++t)e.push(yy(r[t][0],r[t][1])),e.push(f$("",r[t][0]));return e.push(yy("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function FS(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+_c.version+"</meta:generator></office:meta></office:document-meta>"}var Ci=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],h$=function(){for(var r=new Array(Ci.length),e=0;e<Ci.length;++e){var t=Ci[e],n="(?:"+t[0].slice(0,t[0].indexOf(":"))+":)"+t[0].slice(t[0].indexOf(":")+1);r[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return r}();function $S(r){var e={};r=qt(r);for(var t=0;t<Ci.length;++t){var n=Ci[t],i=r.match(h$[t]);i!=null&&i.length>0&&(e[n[1]]=Pt(i[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=hr(e[n[1]]))}return e}function pp(r,e,t,n,i){i[r]!=null||e==null||e===""||(i[r]=e,e=Ut(e),n[n.length]=t?Fe(r,e,t):cn(r,e))}function NS(r,e){var t=e||{},n=[Rr,Fe("cp:coreProperties",null,{"xmlns:cp":Xr.CORE_PROPS,"xmlns:dc":Xr.dc,"xmlns:dcterms":Xr.dcterms,"xmlns:dcmitype":Xr.dcmitype,"xmlns:xsi":Xr.xsi})],i={};if(!r&&!t.Props)return n.join("");r&&(r.CreatedDate!=null&&pp("dcterms:created",typeof r.CreatedDate=="string"?r.CreatedDate:Um(r.CreatedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),r.ModifiedDate!=null&&pp("dcterms:modified",typeof r.ModifiedDate=="string"?r.ModifiedDate:Um(r.ModifiedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var s=0;s!=Ci.length;++s){var a=Ci[s],o=t.Props&&t.Props[a[1]]!=null?t.Props[a[1]]:r?r[a[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&pp(a[0],o,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var vo=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],DS=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function MS(r,e,t,n){var i=[];if(typeof r=="string")i=cy(r,n);else for(var s=0;s<r.length;++s)i=i.concat(r[s].map(function(c){return{v:c}}));var a=typeof e=="string"?cy(e,n).map(function(c){return c.v}):e,o=0,l=0;if(a.length>0)for(var f=0;f!==i.length;f+=2){switch(l=+i[f+1].v,i[f].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":t.Worksheets=l,t.SheetNames=a.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":t.NamedRanges=l,t.DefinedNames=a.slice(o,o+l);break;case"Charts":case"Diagramme":t.Chartsheets=l,t.ChartNames=a.slice(o,o+l);break}o+=l}}function u$(r,e,t){var n={};return e||(e={}),r=qt(r),vo.forEach(function(i){var s=(r.match(Tc(i[0]))||[])[1];switch(i[2]){case"string":s&&(e[i[1]]=Pt(s));break;case"bool":e[i[1]]=s==="true";break;case"raw":var a=r.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));a&&a.length>0&&(n[i[1]]=a[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&MS(n.HeadingPairs,n.TitlesOfParts,e,t),e}function IS(r){var e=[],t=Fe;return r||(r={}),r.Application="SheetJS",e[e.length]=Rr,e[e.length]=Fe("Properties",null,{xmlns:Xr.EXT_PROPS,"xmlns:vt":Xr.vt}),vo.forEach(function(n){if(r[n[1]]!==void 0){var i;switch(n[2]){case"string":i=Ut(String(r[n[1]]));break;case"bool":i=r[n[1]]?"true":"false";break}i!==void 0&&(e[e.length]=t(n[0],i))}}),e[e.length]=t("HeadingPairs",t("vt:vector",t("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+t("vt:variant",t("vt:i4",String(r.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=t("TitlesOfParts",t("vt:vector",r.SheetNames.map(function(n){return"<vt:lpstr>"+Ut(n)+"</vt:lpstr>"}).join(""),{size:r.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var d$=/<[^>]+>[^<]*/g;function p$(r,e){var t={},n="",i=r.match(d$);if(i)for(var s=0;s!=i.length;++s){var a=i[s],o=at(a);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Pt(o.name);break;case"</property>":n=null;break;default:if(a.indexOf("<vt:")===0){var l=a.split(">"),f=l[0].slice(4),c=l[1];switch(f){case"lpstr":case"bstr":case"lpwstr":t[n]=Pt(c);break;case"bool":t[n]=fr(c);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":t[n]=parseInt(c,10);break;case"r4":case"r8":case"decimal":t[n]=parseFloat(c);break;case"filetime":case"date":t[n]=hr(c);break;case"cy":case"error":t[n]=Pt(c);break;default:if(f.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",a,f,l)}}else if(a.slice(0,2)!=="</"){if(e.WTF)throw new Error(a)}}}return t}function LS(r){var e=[Rr,Fe("Properties",null,{xmlns:Xr.CUST_PROPS,"xmlns:vt":Xr.vt})];if(!r)return e.join("");var t=1;return Tr(r).forEach(function(i){++t,e[e.length]=Fe("property",_F(r[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:t,name:Ut(i)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var zm={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},mp;function m$(r,e,t){mp||(mp=S0(zm)),e=mp[e]||e,r[e]=t}function g$(r,e){var t=[];return Tr(zm).map(function(n){for(var i=0;i<Ci.length;++i)if(Ci[i][1]==n)return Ci[i];for(i=0;i<vo.length;++i)if(vo[i][1]==n)return vo[i];throw n}).forEach(function(n){if(r[n[1]]!=null){var i=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:r[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),t.push(cn(zm[n[1]]||n[1],i))}}),Fe("DocumentProperties",t.join(""),{xmlns:Jn.o})}function O$(r,e){var t=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return r&&Tr(r).forEach(function(s){if(Object.prototype.hasOwnProperty.call(r,s)){for(var a=0;a<Ci.length;++a)if(s==Ci[a][1])return;for(a=0;a<vo.length;++a)if(s==vo[a][1])return;for(a=0;a<t.length;++a)if(s==t[a])return;var o=r[s],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),i.push(Fe(ay(s),o,{"dt:dt":l}))}}),e&&Tr(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)&&!(r&&Object.prototype.hasOwnProperty.call(r,s))){var a=e[s],o="string";typeof a=="number"?(o="float",a=String(a)):a===!0||a===!1?(o="boolean",a=a?"1":"0"):a instanceof Date?(o="dateTime.tz",a=a.toISOString()):a=String(a),i.push(Fe(ay(s),a,{"dt:dt":o}))}}),"<"+n+' xmlns="'+Jn.o+'">'+i.join("")+"</"+n+">"}function DO(r){var e=r.read_shift(4),t=r.read_shift(4);return new Date((t/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function x$(r){var e=typeof r=="string"?new Date(Date.parse(r)):r,t=e.getTime()/1e3+11644473600,n=t%Math.pow(2,32),i=(t-n)/Math.pow(2,32);n*=1e7,i*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),i+=s);var a=Oe(8);return a.write_shift(4,n),a.write_shift(4,i),a}function BS(r,e,t){var n=r.l,i=r.read_shift(0,"lpstr-cp");if(t)for(;r.l-n&3;)++r.l;return i}function ZS(r,e,t){var n=r.read_shift(0,"lpwstr");return n}function WS(r,e,t){return e===31?ZS(r):BS(r,e,t)}function Gm(r,e,t){return WS(r,e,t===!1?0:4)}function v$(r,e){if(!e)throw new Error("VtUnalignedString must have positive length");return WS(r,e,0)}function y$(r){for(var e=r.read_shift(4),t=[],n=0;n!=e;++n){var i=r.l;t[n]=r.read_shift(0,"lpwstr").replace(_n,""),r.l-i&2&&(r.l+=2)}return t}function w$(r){for(var e=r.read_shift(4),t=[],n=0;n!=e;++n)t[n]=r.read_shift(0,"lpstr-cp").replace(_n,"");return t}function b$(r){var e=r.l,t=Ad(r,PS);r[r.l]==0&&r[r.l+1]==0&&r.l-e&2&&(r.l+=2);var n=Ad(r,Zn);return[t,n]}function _$(r){for(var e=r.read_shift(4),t=[],n=0;n<e/2;++n)t.push(b$(r));return t}function wy(r,e){for(var t=r.read_shift(4),n={},i=0;i!=t;++i){var s=r.read_shift(4),a=r.read_shift(4);n[s]=r.read_shift(a,e===1200?"utf16le":"utf8").replace(_n,"").replace(Zf,"!"),e===1200&&a%2&&(r.l+=2)}return r.l&3&&(r.l=r.l>>3<<2),n}function US(r){var e=r.read_shift(4),t=r.slice(r.l,r.l+e);return r.l+=e,(e&3)>0&&(r.l+=4-(e&3)&3),t}function k$(r){var e={};return e.Size=r.read_shift(4),r.l+=e.Size+3-(e.Size-1)%4,e}function Ad(r,e,t){var n=r.read_shift(2),i,s=t||{};if(r.l+=2,e!==xy&&n!==e&&t$.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===xy?n:e){case 2:return i=r.read_shift(2,"i"),s.raw||(r.l+=2),i;case 3:return i=r.read_shift(4,"i"),i;case 11:return r.read_shift(4)!==0;case 19:return i=r.read_shift(4),i;case 30:return BS(r,n,4).replace(_n,"");case 31:return ZS(r);case 64:return DO(r);case 65:return US(r);case 71:return k$(r);case 80:return Gm(r,n,!s.raw).replace(_n,"");case 81:return v$(r,n).replace(_n,"");case 4108:return _$(r);case 4126:case 4127:return n==4127?y$(r):w$(r);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function by(r,e){var t=Oe(4),n=Oe(4);switch(t.write_shift(4,r==80?31:r),r){case 3:n.write_shift(-4,e);break;case 5:n=Oe(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=x$(e);break;case 31:case 80:for(n=Oe(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+r+" "+e)}return Hr([t,n])}function _y(r,e){var t=r.l,n=r.read_shift(4),i=r.read_shift(4),s=[],a=0,o=0,l=-1,f={};for(a=0;a!=i;++a){var c=r.read_shift(4),h=r.read_shift(4);s[a]=[c,h+t]}s.sort(function(w,x){return w[1]-x[1]});var u={};for(a=0;a!=i;++a){if(r.l!==s[a][1]){var d=!0;if(a>0&&e)switch(e[s[a-1][0]].t){case 2:r.l+2===s[a][1]&&(r.l+=2,d=!1);break;case 80:r.l<=s[a][1]&&(r.l=s[a][1],d=!1);break;case 4108:r.l<=s[a][1]&&(r.l=s[a][1],d=!1);break}if((!e||a==0)&&r.l<=s[a][1]&&(d=!1,r.l=s[a][1]),d)throw new Error("Read Error: Expected address "+s[a][1]+" at "+r.l+" :"+a)}if(e){var p=e[s[a][0]];if(u[p.n]=Ad(r,p.t,{raw:!0}),p.p==="version"&&(u[p.n]=String(u[p.n]>>16)+"."+("0000"+String(u[p.n]&65535)).slice(-4)),p.n=="CodePage")switch(u[p.n]){case 0:u[p.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ki(o=u[p.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+u[p.n])}}else if(s[a][0]===1){if(o=u.CodePage=Ad(r,$O),ki(o),l!==-1){var m=r.l;r.l=s[l][1],f=wy(r,o),r.l=m}}else if(s[a][0]===0){if(o===0){l=a,r.l=s[a+1][1];continue}f=wy(r,o)}else{var g=f[s[a][0]],v;switch(r[r.l]){case 65:r.l+=4,v=US(r);break;case 30:r.l+=4,v=Gm(r,r[r.l-4]).replace(/\u0000+$/,"");break;case 31:r.l+=4,v=Gm(r,r[r.l-4]).replace(/\u0000+$/,"");break;case 3:r.l+=4,v=r.read_shift(4,"i");break;case 19:r.l+=4,v=r.read_shift(4);break;case 5:r.l+=4,v=r.read_shift(8,"f");break;case 11:r.l+=4,v=Ar(r,4);break;case 64:r.l+=4,v=hr(DO(r));break;default:throw new Error("unparsed value: "+r[r.l])}u[g]=v}}return r.l=t+n,u}var XS=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function S$(r){switch(typeof r){case"boolean":return 11;case"number":return(r|0)==r?3:5;case"string":return 31;case"object":if(r instanceof Date)return 64;break}return-1}function ky(r,e,t){var n=Oe(8),i=[],s=[],a=8,o=0,l=Oe(8),f=Oe(8);if(l.write_shift(4,2),l.write_shift(4,1200),f.write_shift(4,1),s.push(l),i.push(f),a+=8+l.length,!e){f=Oe(8),f.write_shift(4,0),i.unshift(f);var c=[Oe(4)];for(c[0].write_shift(4,r.length),o=0;o<r.length;++o){var h=r[o][0];for(l=Oe(8+2*(h.length+1)+(h.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,h.length+1),l.write_shift(0,h,"dbcs");l.l!=l.length;)l.write_shift(1,0);c.push(l)}l=Hr(c),s.unshift(l),a+=8+l.length}for(o=0;o<r.length;++o)if(!(e&&!e[r[o][0]])&&!(XS.indexOf(r[o][0])>-1||DS.indexOf(r[o][0])>-1)&&r[o][1]!=null){var u=r[o][1],d=0;if(e){d=+e[r[o][0]];var p=t[d];if(p.p=="version"&&typeof u=="string"){var m=u.split(".");u=(+m[0]<<16)+(+m[1]||0)}l=by(p.t,u)}else{var g=S$(u);g==-1&&(g=31,u=String(u)),l=by(g,u)}s.push(l),f=Oe(8),f.write_shift(4,e?d:2+o),i.push(f),a+=8+l.length}var v=8*(s.length+1);for(o=0;o<s.length;++o)i[o].write_shift(4,v),v+=s[o].length;return n.write_shift(4,a),n.write_shift(4,s.length),Hr([n].concat(i).concat(s))}function Sy(r,e,t){var n=r.content;if(!n)return{};rn(n,0);var i,s,a,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var f=n.read_shift(4),c=n.read_shift(16);if(c!==Ye.utils.consts.HEADER_CLSID&&c!==t)throw new Error("Bad PropertySet CLSID "+c);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(s=n.read_shift(16),o=n.read_shift(4),i===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);i===2&&(a=n.read_shift(16),l=n.read_shift(4));var h=_y(n,e),u={SystemIdentifier:f};for(var d in h)u[d]=h[d];if(u.FMTID=s,i===1)return u;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var p;try{p=_y(n,null)}catch{}for(d in p)u[d]=p[d];return u.FMTID=[s,a],u}function Ty(r,e,t,n,i,s){var a=Oe(i?68:48),o=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,Ye.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,i?2:1),a.write_shift(16,e,"hex"),a.write_shift(4,i?68:48);var l=ky(r,t,n);if(o.push(l),i){var f=ky(i,null,null);a.write_shift(16,s,"hex"),a.write_shift(4,68+l.length),o.push(f)}return Hr(o)}function pa(r,e){return r.read_shift(e),null}function T$(r,e){e||(e=Oe(r));for(var t=0;t<r;++t)e.write_shift(1,0);return e}function C$(r,e,t){for(var n=[],i=r.l+e;r.l<i;)n.push(t(r,i-r.l));if(i!==r.l)throw new Error("Slurp error");return n}function Ar(r,e){return r.read_shift(e)===1}function Rn(r,e){return e||(e=Oe(2)),e.write_shift(2,+!!r),e}function Dr(r){return r.read_shift(2,"u")}function yi(r,e){return e||(e=Oe(2)),e.write_shift(2,r),e}function VS(r,e){return C$(r,e,Dr)}function A$(r){var e=r.read_shift(1),t=r.read_shift(1);return t===1?e:e===1}function qS(r,e,t){return t||(t=Oe(2)),t.write_shift(1,e=="e"?+r:+!!r),t.write_shift(1,e=="e"?1:0),t}function yh(r,e,t){var n=r.read_shift(t&&t.biff>=12?2:1),i="sbcs-cont",s=fi;if(t&&t.biff>=8&&(fi=1200),!t||t.biff==8){var a=r.read_shift(1);a&&(i="dbcs-cont")}else t.biff==12&&(i="wstr");t.biff>=2&&t.biff<=5&&(i="cpstr");var o=n?r.read_shift(n,i):"";return fi=s,o}function E$(r){var e=fi;fi=1200;var t=r.read_shift(2),n=r.read_shift(1),i=n&4,s=n&8,a=1+(n&1),o=0,l,f={};s&&(o=r.read_shift(2)),i&&(l=r.read_shift(4));var c=a==2?"dbcs-cont":"sbcs-cont",h=t===0?"":r.read_shift(t,c);return s&&(r.l+=4*o),i&&(r.l+=l),f.t=h,s||(f.raw="<t>"+f.t+"</t>",f.r=f.t),fi=e,f}function P$(r){var e=r.t||"",t=Oe(3);t.write_shift(2,e.length),t.write_shift(1,1);var n=Oe(2*e.length);n.write_shift(2*e.length,e,"utf16le");var i=[t,n];return Hr(i)}function Po(r,e,t){var n;if(t){if(t.biff>=2&&t.biff<=5)return r.read_shift(e,"cpstr");if(t.biff>=12)return r.read_shift(e,"dbcs-cont")}var i=r.read_shift(1);return i===0?n=r.read_shift(e,"sbcs-cont"):n=r.read_shift(e,"dbcs-cont"),n}function wh(r,e,t){var n=r.read_shift(t&&t.biff==2?1:2);return n===0?(r.l++,""):Po(r,n,t)}function qo(r,e,t){if(t.biff>5)return wh(r,e,t);var n=r.read_shift(1);return n===0?(r.l++,""):r.read_shift(n,t.biff<=4||!r.lens?"cpstr":"sbcs-cont")}function jS(r,e,t){return t||(t=Oe(3+2*r.length)),t.write_shift(2,r.length),t.write_shift(1,1),t.write_shift(31,r,"utf16le"),t}function R$(r){var e=r.read_shift(1);r.l++;var t=r.read_shift(2);return r.l+=2,[e,t]}function Q$(r){var e=r.read_shift(4),t=r.l,n=!1;e>24&&(r.l+=e-24,r.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),r.l=t);var i=r.read_shift((n?e-24:e)>>1,"utf16le").replace(_n,"");return n&&(r.l+=24),i}function F$(r){for(var e=r.read_shift(2),t="";e-- >0;)t+="../";var n=r.read_shift(0,"lpstr-ansi");if(r.l+=2,r.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=r.read_shift(4);if(i===0)return t+n.replace(/\\/g,"/");var s=r.read_shift(4);if(r.read_shift(2)!=3)throw new Error("Bad FileMoniker");var a=r.read_shift(s>>1,"utf16le").replace(_n,"");return t+a}function $$(r,e){var t=r.read_shift(16);switch(t){case"e0c9ea79f9bace118c8200aa004ba90b":return Q$(r);case"0303000000000000c000000000000046":return F$(r);default:throw new Error("Unsupported Moniker "+t)}}function jh(r){var e=r.read_shift(4),t=e>0?r.read_shift(e,"utf16le").replace(_n,""):"";return t}function Cy(r,e){e||(e=Oe(6+r.length*2)),e.write_shift(4,1+r.length);for(var t=0;t<r.length;++t)e.write_shift(2,r.charCodeAt(t));return e.write_shift(2,0),e}function N$(r,e){var t=r.l+e,n=r.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=r.read_shift(2);r.l+=2;var s,a,o,l,f="",c,h;i&16&&(s=jh(r,t-r.l)),i&128&&(a=jh(r,t-r.l)),(i&257)===257&&(o=jh(r,t-r.l)),(i&257)===1&&(l=$$(r,t-r.l)),i&8&&(f=jh(r,t-r.l)),i&32&&(c=r.read_shift(16)),i&64&&(h=DO(r)),r.l=t;var u=a||o||l||"";u&&f&&(u+="#"+f),u||(u="#"+f),i&2&&u.charAt(0)=="/"&&u.charAt(1)!="/"&&(u="file://"+u);var d={Target:u};return c&&(d.guid=c),h&&(d.time=h),s&&(d.Tooltip=s),d}function D$(r){var e=Oe(512),t=0,n=r.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),s=i>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}e.write_shift(4,2),e.write_shift(4,s);var a=[8,6815827,6619237,4849780,83];for(t=0;t<a.length;++t)e.write_shift(4,a[t]);if(s==28)n=n.slice(1),Cy(n,e);else if(s&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),t=0;t<a.length;++t)e.write_shift(1,parseInt(a[t],16));var o=i>-1?n.slice(0,i):n;for(e.write_shift(4,2*(o.length+1)),t=0;t<o.length;++t)e.write_shift(2,o.charCodeAt(t));e.write_shift(2,0),s&8&&Cy(i>-1?n.slice(i+1):"",e)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),t=0;t<a.length;++t)e.write_shift(1,parseInt(a[t],16));for(var l=0;n.slice(l*3,l*3+3)=="../"||n.slice(l*3,l*3+3)=="..\\";)++l;for(e.write_shift(2,l),e.write_shift(4,n.length-3*l+1),t=0;t<n.length-3*l;++t)e.write_shift(1,n.charCodeAt(t+3*l)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),t=0;t<6;++t)e.write_shift(4,0)}return e.slice(0,e.l)}function zS(r){var e=r.read_shift(1),t=r.read_shift(1),n=r.read_shift(1),i=r.read_shift(1);return[e,t,n,i]}function GS(r,e){var t=zS(r);return t[3]=0,t}function Rs(r){var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(2);return{r:e,c:t,ixfe:n}}function Ro(r,e,t,n){return n||(n=Oe(6)),n.write_shift(2,r),n.write_shift(2,e),n.write_shift(2,t||0),n}function M$(r){var e=r.read_shift(2),t=r.read_shift(2);return r.l+=8,{type:e,flags:t}}function I$(r,e,t){return e===0?"":qo(r,e,t)}function L$(r,e,t){var n=t.biff>8?4:2,i=r.read_shift(n),s=r.read_shift(n,"i"),a=r.read_shift(n,"i");return[i,s,a]}function HS(r){var e=r.read_shift(2),t=FO(r);return[e,t]}function B$(r,e,t){r.l+=4,e-=4;var n=r.l+e,i=yh(r,e,t),s=r.read_shift(2);if(n-=r.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return r.l+=s,i}function E0(r){var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(2),i=r.read_shift(2);return{s:{c:n,r:e},e:{c:i,r:t}}}function YS(r,e){return e||(e=Oe(8)),e.write_shift(2,r.s.r),e.write_shift(2,r.e.r),e.write_shift(2,r.s.c),e.write_shift(2,r.e.c),e}function KS(r){var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(1),i=r.read_shift(1);return{s:{c:n,r:e},e:{c:i,r:t}}}var Z$=KS;function JS(r){r.l+=4;var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(2);return r.l+=12,[t,e,n]}function W$(r){var e={};return r.l+=4,r.l+=16,e.fSharedNote=r.read_shift(2),r.l+=4,e}function U$(r){var e={};return r.l+=4,r.cf=r.read_shift(2),e}function pn(r){r.l+=2,r.l+=r.read_shift(2)}var X$={0:pn,4:pn,5:pn,6:pn,7:U$,8:pn,9:pn,10:pn,11:pn,12:pn,13:W$,14:pn,15:pn,16:pn,17:pn,18:pn,19:pn,20:pn,21:JS};function V$(r,e){for(var t=r.l+e,n=[];r.l<t;){var i=r.read_shift(2);r.l-=2;try{n.push(X$[i](r,t-r.l))}catch{return r.l=t,n}}return r.l!=t&&(r.l=t),n}function zh(r,e){var t={BIFFVer:0,dt:0};switch(t.BIFFVer=r.read_shift(2),e-=2,e>=2&&(t.dt=r.read_shift(2),r.l-=2),t.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+t.BIFFVer)}return r.read_shift(e),t}function MO(r,e,t){var n=1536,i=16;switch(t.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=Oe(i);return s.write_shift(2,n),s.write_shift(2,e),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function q$(r,e){return e===0||r.read_shift(2),1200}function j$(r,e,t){if(t.enc)return r.l+=e,"";var n=r.l,i=qo(r,0,t);return r.read_shift(e+n-r.l),i}function z$(r,e){var t=!e||e.biff==8,n=Oe(t?112:54);for(n.write_shift(e.biff==8?2:1,7),t&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(t?0:536870912));n.l<n.length;)n.write_shift(1,t?0:32);return n}function G$(r,e,t){var n=t&&t.biff==8||e==2?r.read_shift(2):(r.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function H$(r,e,t){var n=r.read_shift(4),i=r.read_shift(1)&3,s=r.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var a=yh(r,0,t);return a.length===0&&(a="Sheet1"),{pos:n,hs:i,dt:s,name:a}}function Y$(r,e){var t=!e||e.biff>=8?2:1,n=Oe(8+t*r.name.length);n.write_shift(4,r.pos),n.write_shift(1,r.hs||0),n.write_shift(1,r.dt),n.write_shift(1,r.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(t*r.name.length,r.name,e.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function K$(r,e){for(var t=r.l+e,n=r.read_shift(4),i=r.read_shift(4),s=[],a=0;a!=i&&r.l<t;++a)s.push(E$(r));return s.Count=n,s.Unique=i,s}function J$(r,e){var t=Oe(8);t.write_shift(4,r.Count),t.write_shift(4,r.Unique);for(var n=[],i=0;i<r.length;++i)n[i]=P$(r[i]);var s=Hr([t].concat(n));return s.parts=[t.length].concat(n.map(function(a){return a.length})),s}function eN(r,e){var t={};return t.dsst=r.read_shift(2),r.l+=e-2,t}function tN(r){var e={};e.r=r.read_shift(2),e.c=r.read_shift(2),e.cnt=r.read_shift(2)-e.c;var t=r.read_shift(2);r.l+=4;var n=r.read_shift(1);return r.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=t/20),e}function rN(r){var e=M$(r);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var t=r.read_shift(4);return t!==0}function nN(r){return r.read_shift(2),r.read_shift(4)}function Ay(r,e,t){var n=0;t&&t.biff==2||(n=r.read_shift(2));var i=r.read_shift(2);t&&t.biff==2&&(n=1-(i>>15),i&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,i]}function iN(r){var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(2),i=r.read_shift(2),s=r.read_shift(2),a=r.read_shift(2),o=r.read_shift(2),l=r.read_shift(2),f=r.read_shift(2);return{Pos:[e,t],Dim:[n,i],Flags:s,CurTab:a,FirstTab:o,Selected:l,TabRatio:f}}function sN(){var r=Oe(18);return r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,29280),r.write_shift(2,17600),r.write_shift(2,56),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,1),r.write_shift(2,500),r}function aN(r,e,t){if(t&&t.biff>=2&&t.biff<5)return{};var n=r.read_shift(2);return{RTL:n&64}}function oN(r){var e=Oe(18),t=1718;return r&&r.RTL&&(t|=64),e.write_shift(2,t),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function lN(){}function fN(r,e,t){var n={dyHeight:r.read_shift(2),fl:r.read_shift(2)};switch(t&&t.biff||8){case 2:break;case 3:case 4:r.l+=2;break;default:r.l+=10;break}return n.name=yh(r,0,t),n}function cN(r,e){var t=r.name||"Arial",n=e.biff==5,i=n?15+t.length:16+2*t.length,s=Oe(i);return s.write_shift(2,(r.sz||12)*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,t.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*t.length,t,n?"sbcs":"utf16le"),s}function hN(r){var e=Rs(r);return e.isst=r.read_shift(4),e}function uN(r,e,t,n){var i=Oe(10);return Ro(r,e,n,i),i.write_shift(4,t),i}function dN(r,e,t){t.biffguess&&t.biff==2&&(t.biff=5);var n=r.l+e,i=Rs(r);t.biff==2&&r.l++;var s=wh(r,n-r.l,t);return i.val=s,i}function pN(r,e,t,n,i){var s=!i||i.biff==8,a=Oe(8+ +s+(1+s)*t.length);return Ro(r,e,n,a),a.write_shift(2,t.length),s&&a.write_shift(1,1),a.write_shift((1+s)*t.length,t,s?"utf16le":"sbcs"),a}function mN(r,e,t){var n=r.read_shift(2),i=qo(r,0,t);return[n,i]}function gN(r,e,t,n){var i=t.biff==5;n||(n=Oe(i?3+e.length:5+2*e.length)),n.write_shift(2,r),n.write_shift(i?1:2,e.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*e.length,e,i?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}var ON=qo;function Ey(r,e,t){var n=r.l+e,i=t.biff==8||!t.biff?4:2,s=r.read_shift(i),a=r.read_shift(i),o=r.read_shift(2),l=r.read_shift(2);return r.l=n,{s:{r:s,c:o},e:{r:a,c:l}}}function xN(r,e){var t=e.biff==8||!e.biff?4:2,n=Oe(2*t+6);return n.write_shift(t,r.s.r),n.write_shift(t,r.e.r+1),n.write_shift(2,r.s.c),n.write_shift(2,r.e.c+1),n.write_shift(2,0),n}function vN(r){var e=r.read_shift(2),t=r.read_shift(2),n=HS(r);return{r:e,c:t,ixfe:n[0],rknum:n[1]}}function yN(r,e){for(var t=r.l+e-2,n=r.read_shift(2),i=r.read_shift(2),s=[];r.l<t;)s.push(HS(r));if(r.l!==t)throw new Error("MulRK read error");var a=r.read_shift(2);if(s.length!=a-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:a,rkrec:s}}function wN(r,e){for(var t=r.l+e-2,n=r.read_shift(2),i=r.read_shift(2),s=[];r.l<t;)s.push(r.read_shift(2));if(r.l!==t)throw new Error("MulBlank read error");var a=r.read_shift(2);if(s.length!=a-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:a,ixfe:s}}function bN(r,e,t,n){var i={},s=r.read_shift(4),a=r.read_shift(4),o=r.read_shift(4),l=r.read_shift(2);return i.patternType=r$[o>>26],n.cellStyles&&(i.alc=s&7,i.fWrap=s>>3&1,i.alcV=s>>4&7,i.fJustLast=s>>7&1,i.trot=s>>8&255,i.cIndent=s>>16&15,i.fShrinkToFit=s>>20&1,i.iReadOrder=s>>22&2,i.fAtrNum=s>>26&1,i.fAtrFnt=s>>27&1,i.fAtrAlc=s>>28&1,i.fAtrBdr=s>>29&1,i.fAtrPat=s>>30&1,i.fAtrProt=s>>31&1,i.dgLeft=a&15,i.dgRight=a>>4&15,i.dgTop=a>>8&15,i.dgBottom=a>>12&15,i.icvLeft=a>>16&127,i.icvRight=a>>23&127,i.grbitDiag=a>>30&3,i.icvTop=o&127,i.icvBottom=o>>7&127,i.icvDiag=o>>14&127,i.dgDiag=o>>21&15,i.icvFore=l&127,i.icvBack=l>>7&127,i.fsxButton=l>>14&1),i}function _N(r,e,t){var n={};return n.ifnt=r.read_shift(2),n.numFmtId=r.read_shift(2),n.flags=r.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=bN(r,e,n.fStyle,t),n}function Py(r,e,t,n){var i=t.biff==5;n||(n=Oe(i?16:20)),n.write_shift(2,0),r.style?(n.write_shift(2,r.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,r.numFmtId||0),n.write_shift(2,e<<4));var s=0;return r.numFmtId>0&&i&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function kN(r){r.l+=4;var e=[r.read_shift(2),r.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function SN(r){var e=Oe(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function Ry(r,e,t){var n=Rs(r);(t.biff==2||e==9)&&++r.l;var i=A$(r);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function TN(r,e,t,n,i,s){var a=Oe(8);return Ro(r,e,n,a),qS(t,s,a),a}function CN(r,e,t){t.biffguess&&t.biff==2&&(t.biff=5);var n=Rs(r),i=yn(r);return n.val=i,n}function AN(r,e,t,n){var i=Oe(14);return Ro(r,e,n,i),Eo(t,i),i}var Qy=I$;function EN(r,e,t){var n=r.l+e,i=r.read_shift(2),s=r.read_shift(2);if(t.sbcch=s,s==1025||s==14849)return[s,i];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var a=Po(r,s),o=[];n>r.l;)o.push(wh(r));return[s,i,a,o]}function Fy(r,e,t){var n=r.read_shift(2),i,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return t.sbcch===14849&&(i=B$(r,e-2,t)),s.body=i||r.read_shift(e-2),typeof i=="string"&&(s.Name=i),s}var PN=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function $y(r,e,t){var n=r.l+e,i=r.read_shift(2),s=r.read_shift(1),a=r.read_shift(1),o=r.read_shift(t&&t.biff==2?1:2),l=0;(!t||t.biff>=5)&&(t.biff!=5&&(r.l+=2),l=r.read_shift(2),t.biff==5&&(r.l+=2),r.l+=4);var f=Po(r,a,t);i&32&&(f=PN[f.charCodeAt(0)]);var c=n-r.l;t&&t.biff==2&&--c;var h=n==r.l||o===0||!(c>0)?[]:V8(r,c,t,o);return{chKey:s,Name:f,itab:l,rgce:h}}function eT(r,e,t){if(t.biff<8)return RN(r,e,t);for(var n=[],i=r.l+e,s=r.read_shift(t.biff>8?4:2);s--!==0;)n.push(L$(r,t.biff>8?12:6,t));if(r.l!=i)throw new Error("Bad ExternSheet: "+r.l+" != "+i);return n}function RN(r,e,t){r[r.l+1]==3&&r[r.l]++;var n=yh(r,e,t);return n.charCodeAt(0)==3?n.slice(1):n}function QN(r,e,t){if(t.biff<8){r.l+=e;return}var n=r.read_shift(2),i=r.read_shift(2),s=Po(r,n,t),a=Po(r,i,t);return[s,a]}function FN(r,e,t){var n=KS(r);r.l++;var i=r.read_shift(1);return e-=8,[q8(r,e,t),i,n]}function Ny(r,e,t){var n=Z$(r);switch(t.biff){case 2:r.l++,e-=7;break;case 3:case 4:r.l+=2,e-=8;break;default:r.l+=6,e-=12}return[n,U8(r,e,t)]}function $N(r){var e=r.read_shift(4)!==0,t=r.read_shift(4)!==0,n=r.read_shift(4);return[e,t,n]}function NN(r,e,t){if(!(t.biff<8)){var n=r.read_shift(2),i=r.read_shift(2),s=r.read_shift(2),a=r.read_shift(2),o=qo(r,0,t);return t.biff<8&&r.read_shift(1),[{r:n,c:i},o,a,s]}}function DN(r,e,t){return NN(r,e,t)}function MN(r,e){for(var t=[],n=r.read_shift(2);n--;)t.push(E0(r));return t}function IN(r){var e=Oe(2+r.length*8);e.write_shift(2,r.length);for(var t=0;t<r.length;++t)YS(r[t],e);return e}function LN(r,e,t){if(t&&t.biff<8)return ZN(r,e,t);var n=JS(r),i=V$(r,e-22,n[1]);return{cmo:n,ft:i}}var BN={8:function(r,e){var t=r.l+e;r.l+=10;var n=r.read_shift(2);r.l+=4,r.l+=2,r.l+=2,r.l+=2,r.l+=4;var i=r.read_shift(1);return r.l+=i,r.l=t,{fmt:n}}};function ZN(r,e,t){r.l+=4;var n=r.read_shift(2),i=r.read_shift(2),s=r.read_shift(2);r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=6,e-=36;var a=[];return a.push((BN[n]||Sn)(r,e,t)),{cmo:[i,n,s],ft:a}}function WN(r,e,t){var n=r.l,i="";try{r.l+=4;var s=(t.lastobj||{cmo:[0,0]}).cmo[1],a;[0,5,7,11,12,14].indexOf(s)==-1?r.l+=6:a=R$(r,6,t);var o=r.read_shift(2);r.read_shift(2),Dr(r,2);var l=r.read_shift(2);r.l+=l;for(var f=1;f<r.lens.length-1;++f){if(r.l-n!=r.lens[f])throw new Error("TxO: bad continue record");var c=r[r.l],h=Po(r,r.lens[f+1]-r.lens[f]-1);if(i+=h,i.length>=(c?o:2*o))break}if(i.length!==o&&i.length!==o*2)throw new Error("cchText: "+o+" != "+i.length);return r.l=n+e,{t:i}}catch{return r.l=n+e,{t:i}}}function UN(r,e){var t=E0(r);r.l+=16;var n=N$(r,e-24);return[t,n]}function XN(r){var e=Oe(24),t=wr(r[0]);e.write_shift(2,t.r),e.write_shift(2,t.r),e.write_shift(2,t.c),e.write_shift(2,t.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)e.write_shift(1,parseInt(n[i],16));return Hr([e,D$(r[1])])}function VN(r,e){r.read_shift(2);var t=E0(r),n=r.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(_n,""),[t,n]}function qN(r){var e=r[1].Tooltip,t=Oe(10+2*(e.length+1));t.write_shift(2,2048);var n=wr(r[0]);t.write_shift(2,n.r),t.write_shift(2,n.r),t.write_shift(2,n.c),t.write_shift(2,n.c);for(var i=0;i<e.length;++i)t.write_shift(2,e.charCodeAt(i));return t.write_shift(2,0),t}function jN(r){var e=[0,0],t;return t=r.read_shift(2),e[0]=vy[t]||t,t=r.read_shift(2),e[1]=vy[t]||t,e}function zN(r){return r||(r=Oe(4)),r.write_shift(2,1),r.write_shift(2,1),r}function GN(r){for(var e=r.read_shift(2),t=[];e-- >0;)t.push(GS(r));return t}function HN(r){for(var e=r.read_shift(2),t=[];e-- >0;)t.push(GS(r));return t}function YN(r){r.l+=2;var e={cxfs:0,crc:0};return e.cxfs=r.read_shift(2),e.crc=r.read_shift(4),e}function tT(r,e,t){if(!t.cellStyles)return Sn(r,e);var n=t&&t.biff>=12?4:2,i=r.read_shift(n),s=r.read_shift(n),a=r.read_shift(n),o=r.read_shift(n),l=r.read_shift(2);n==2&&(r.l+=2);var f={s:i,e:s,w:a,ixfe:o,flags:l};return(t.biff>=5||!t.biff)&&(f.level=l>>8&7),f}function KN(r,e){var t=Oe(12);t.write_shift(2,e),t.write_shift(2,e),t.write_shift(2,r.width*256),t.write_shift(2,0);var n=0;return r.hidden&&(n|=1),t.write_shift(1,n),n=r.level||0,t.write_shift(1,n),t.write_shift(2,0),t}function JN(r,e){var t={};return e<32||(r.l+=16,t.header=yn(r),t.footer=yn(r),r.l+=2),t}function eD(r,e,t){var n={area:!1};if(t.biff!=5)return r.l+=e,n;var i=r.read_shift(1);return r.l+=3,i&16&&(n.area=!0),n}function tD(r){for(var e=Oe(2*r),t=0;t<r;++t)e.write_shift(2,t+1);return e}var rD=Rs,nD=VS,iD=wh;function sD(r){var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(4),i={fmt:e,env:t,len:n,data:r.slice(r.l,r.l+n)};return r.l+=n,i}function aD(r,e,t){t.biffguess&&t.biff==5&&(t.biff=2);var n=Rs(r);++r.l;var i=qo(r,e-7,t);return n.t="str",n.val=i,n}function oD(r){var e=Rs(r);++r.l;var t=yn(r);return e.t="n",e.val=t,e}function lD(r,e,t){var n=Oe(15);return Sh(n,r,e),n.write_shift(8,t,"f"),n}function fD(r){var e=Rs(r);++r.l;var t=r.read_shift(2);return e.t="n",e.val=t,e}function cD(r,e,t){var n=Oe(9);return Sh(n,r,e),n.write_shift(2,t),n}function hD(r){var e=r.read_shift(1);return e===0?(r.l++,""):r.read_shift(e,"sbcs-cont")}function uD(r,e){r.l+=6,r.l+=2,r.l+=1,r.l+=3,r.l+=1,r.l+=e-13}function dD(r,e,t){var n=r.l+e,i=Rs(r),s=r.read_shift(2),a=Po(r,s,t);return r.l=n,i.t="str",i.val=a,i}var pD=[2,3,48,49,131,139,140,245],Hm=function(){var r={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=S0({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(o,l){var f=[],c=Fa(1);switch(l.type){case"base64":c=ei(ci(o));break;case"binary":c=ei(o);break;case"buffer":case"array":c=o;break}rn(c,0);var h=c.read_shift(1),u=!!(h&136),d=!1,p=!1;switch(h){case 2:break;case 3:break;case 48:d=!0,u=!0;break;case 49:d=!0,u=!0;break;case 131:break;case 139:break;case 140:p=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var m=0,g=521;h==2&&(m=c.read_shift(2)),c.l+=3,h!=2&&(m=c.read_shift(4)),m>1048576&&(m=1e6),h!=2&&(g=c.read_shift(2));var v=c.read_shift(2),w=l.codepage||1252;h!=2&&(c.l+=16,c.read_shift(1),c[c.l]!==0&&(w=r[c[c.l]]),c.l+=1,c.l+=2),p&&(c.l+=36);for(var x=[],S={},y=Math.min(c.length,h==2?521:g-10-(d?264:0)),b=p?32:11;c.l<y&&c[c.l]!=13;)switch(S={},S.name=St.utils.decode(w,c.slice(c.l,c.l+b)).replace(/[\u0000\r\n].*$/g,""),c.l+=b,S.type=String.fromCharCode(c.read_shift(1)),h!=2&&!p&&(S.offset=c.read_shift(4)),S.len=c.read_shift(1),h==2&&(S.offset=c.read_shift(2)),S.dec=c.read_shift(1),S.name.length&&x.push(S),h!=2&&(c.l+=p?13:14),S.type){case"B":(!d||S.len!=8)&&l.WTF&&console.log("Skipping "+S.name+":"+S.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+S.name+":"+S.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+S.type)}if(c[c.l]!==13&&(c.l=g-1),c.read_shift(1)!==13)throw new Error("DBF Terminator not found "+c.l+" "+c[c.l]);c.l=g;var O=0,T=0;for(f[0]=[],T=0;T!=x.length;++T)f[0][T]=x[T].name;for(;m-- >0;){if(c[c.l]===42){c.l+=v;continue}for(++c.l,f[++O]=[],T=0,T=0;T!=x.length;++T){var k=c.slice(c.l,c.l+x[T].len);c.l+=x[T].len,rn(k,0);var Q=St.utils.decode(w,k);switch(x[T].type){case"C":Q.trim().length&&(f[O][T]=Q.replace(/\s+$/,""));break;case"D":Q.length===8?f[O][T]=new Date(+Q.slice(0,4),+Q.slice(4,6)-1,+Q.slice(6,8)):f[O][T]=Q;break;case"F":f[O][T]=parseFloat(Q.trim());break;case"+":case"I":f[O][T]=p?k.read_shift(-4,"i")^2147483648:k.read_shift(4,"i");break;case"L":switch(Q.trim().toUpperCase()){case"Y":case"T":f[O][T]=!0;break;case"N":case"F":f[O][T]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+Q+"|")}break;case"M":if(!u)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));f[O][T]="##MEMO##"+(p?parseInt(Q.trim(),10):k.read_shift(4));break;case"N":Q=Q.replace(/\u0000/g,"").trim(),Q&&Q!="."&&(f[O][T]=+Q||0);break;case"@":f[O][T]=new Date(k.read_shift(-8,"f")-621356832e5);break;case"T":f[O][T]=new Date((k.read_shift(4)-2440588)*864e5+k.read_shift(4));break;case"Y":f[O][T]=k.read_shift(4,"i")/1e4+k.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":f[O][T]=-k.read_shift(-8,"f");break;case"B":if(d&&x[T].len==8){f[O][T]=k.read_shift(8,"f");break}case"G":case"P":k.l+=x[T].len;break;case"0":if(x[T].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+x[T].type)}}}if(h!=2&&c.l<c.length&&c[c.l++]!=26)throw new Error("DBF EOF Marker missing "+(c.l-1)+" of "+c.length+" "+c[c.l-1].toString(16));return l.sheetRows&&(f=f.slice(0,l.sheetRows)),l.DBF=x,f}function n(o,l){var f=l||{};f.dateNF||(f.dateNF="yyyymmdd");var c=hf(t(o,f),f);return c["!cols"]=f.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete f.DBF,c}function i(o,l){try{return qa(n(o,l),l)}catch(f){if(l&&l.WTF)throw f}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,l){var f=l||{};if(+f.codepage>=0&&ki(+f.codepage),f.type=="string")throw new Error("Cannot write DBF to JS string");var c=zn(),h=Qd(o,{header:1,raw:!0,cellDates:!0}),u=h[0],d=h.slice(1),p=o["!cols"]||[],m=0,g=0,v=0,w=1;for(m=0;m<u.length;++m){if(((p[m]||{}).DBF||{}).name){u[m]=p[m].DBF.name,++v;continue}if(u[m]!=null){if(++v,typeof u[m]=="number"&&(u[m]=u[m].toString(10)),typeof u[m]!="string")throw new Error("DBF Invalid column name "+u[m]+" |"+typeof u[m]+"|");if(u.indexOf(u[m])!==m){for(g=0;g<1024;++g)if(u.indexOf(u[m]+"_"+g)==-1){u[m]+="_"+g;break}}}}var x=wt(o["!ref"]),S=[],y=[],b=[];for(m=0;m<=x.e.c-x.s.c;++m){var O="",T="",k=0,Q=[];for(g=0;g<d.length;++g)d[g][m]!=null&&Q.push(d[g][m]);if(Q.length==0||u[m]==null){S[m]="?";continue}for(g=0;g<Q.length;++g){switch(typeof Q[g]){case"number":T="B";break;case"string":T="C";break;case"boolean":T="L";break;case"object":T=Q[g]instanceof Date?"D":"C";break;default:T="C"}k=Math.max(k,String(Q[g]).length),O=O&&O!=T?"C":T}k>250&&(k=250),T=((p[m]||{}).DBF||{}).type,T=="C"&&p[m].DBF.len>k&&(k=p[m].DBF.len),O=="B"&&T=="N"&&(O="N",b[m]=p[m].DBF.dec,k=p[m].DBF.len),y[m]=O=="C"||T=="N"?k:s[O]||0,w+=y[m],S[m]=O}var A=c.next(32);for(A.write_shift(4,318902576),A.write_shift(4,d.length),A.write_shift(2,296+32*v),A.write_shift(2,w),m=0;m<4;++m)A.write_shift(4,0);for(A.write_shift(4,0|(+e[To]||3)<<8),m=0,g=0;m<u.length;++m)if(u[m]!=null){var _=c.next(32),N=(u[m].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);_.write_shift(1,N,"sbcs"),_.write_shift(1,S[m]=="?"?"C":S[m],"sbcs"),_.write_shift(4,g),_.write_shift(1,y[m]||s[S[m]]||0),_.write_shift(1,b[m]||0),_.write_shift(1,2),_.write_shift(4,0),_.write_shift(1,0),_.write_shift(4,0),_.write_shift(4,0),g+=y[m]||s[S[m]]||0}var U=c.next(264);for(U.write_shift(4,13),m=0;m<65;++m)U.write_shift(4,0);for(m=0;m<d.length;++m){var z=c.next(w);for(z.write_shift(1,0),g=0;g<u.length;++g)if(u[g]!=null)switch(S[g]){case"L":z.write_shift(1,d[m][g]==null?63:d[m][g]?84:70);break;case"B":z.write_shift(8,d[m][g]||0,"f");break;case"N":var K="0";for(typeof d[m][g]=="number"&&(K=d[m][g].toFixed(b[g]||0)),v=0;v<y[g]-K.length;++v)z.write_shift(1,32);z.write_shift(1,K,"sbcs");break;case"D":d[m][g]?(z.write_shift(4,("0000"+d[m][g].getFullYear()).slice(-4),"sbcs"),z.write_shift(2,("00"+(d[m][g].getMonth()+1)).slice(-2),"sbcs"),z.write_shift(2,("00"+d[m][g].getDate()).slice(-2),"sbcs")):z.write_shift(8,"00000000","sbcs");break;case"C":var re=String(d[m][g]!=null?d[m][g]:"").slice(0,y[g]);for(z.write_shift(1,re,"sbcs"),v=0;v<y[g]-re.length;++v)z.write_shift(1,32);break}}return c.next(1).write_shift(1,26),c.end()}return{to_workbook:i,to_sheet:n,from_sheet:a}}(),rT=function(){var r={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Tr(r).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(u,d){var p=r[d];return typeof p=="number"?Wm(p):p},n=function(u,d,p){var m=d.charCodeAt(0)-32<<4|p.charCodeAt(0)-48;return m==59?u:Wm(m)};r["|"]=254;function i(u,d){switch(d.type){case"base64":return s(ci(u),d);case"binary":return s(u,d);case"buffer":return s(gt&&Buffer.isBuffer(u)?u.toString("binary"):Va(u),d);case"array":return s(Ao(u),d)}throw new Error("Unrecognized type "+d.type)}function s(u,d){var p=u.split(/[\n\r]+/),m=-1,g=-1,v=0,w=0,x=[],S=[],y=null,b={},O=[],T=[],k=[],Q=0,A;for(+d.codepage>=0&&ki(+d.codepage);v!==p.length;++v){Q=0;var _=p[v].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,t),N=_.replace(/;;/g,"\0").split(";").map(function(Z){return Z.replace(/\u0000/g,";")}),U=N[0],z;if(_.length>0)switch(U){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":N[1].charAt(0)=="P"&&S.push(_.slice(3).replace(/;;/g,";"));break;case"C":var K=!1,re=!1,ge=!1,V=!1,he=-1,ae=-1;for(w=1;w<N.length;++w)switch(N[w].charAt(0)){case"A":break;case"X":g=parseInt(N[w].slice(1))-1,re=!0;break;case"Y":for(m=parseInt(N[w].slice(1))-1,re||(g=0),A=x.length;A<=m;++A)x[A]=[];break;case"K":z=N[w].slice(1),z.charAt(0)==='"'?z=z.slice(1,z.length-1):z==="TRUE"?z=!0:z==="FALSE"?z=!1:isNaN(Vi(z))?isNaN(Dl(z).getDate())||(z=hr(z)):(z=Vi(z),y!==null&&Bo(y)&&(z=C0(z))),typeof St<"u"&&typeof z=="string"&&(d||{}).type!="string"&&(d||{}).codepage&&(z=St.utils.decode(d.codepage,z)),K=!0;break;case"E":V=!0;var E=kl(N[w].slice(1),{r:m,c:g});x[m][g]=[x[m][g],E];break;case"S":ge=!0,x[m][g]=[x[m][g],"S5S"];break;case"G":break;case"R":he=parseInt(N[w].slice(1))-1;break;case"C":ae=parseInt(N[w].slice(1))-1;break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+_)}if(K&&(x[m][g]&&x[m][g].length==2?x[m][g][0]=z:x[m][g]=z,y=null),ge){if(V)throw new Error("SYLK shared formula cannot have own formula");var L=he>-1&&x[he][ae];if(!L||!L[1])throw new Error("SYLK shared formula cannot find base");x[m][g][1]=yT(L[1],{r:m-he,c:g-ae})}break;case"F":var I=0;for(w=1;w<N.length;++w)switch(N[w].charAt(0)){case"X":g=parseInt(N[w].slice(1))-1,++I;break;case"Y":for(m=parseInt(N[w].slice(1))-1,A=x.length;A<=m;++A)x[A]=[];break;case"M":Q=parseInt(N[w].slice(1))/20;break;case"F":break;case"G":break;case"P":y=S[parseInt(N[w].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(k=N[w].slice(1).split(" "),A=parseInt(k[0],10);A<=parseInt(k[1],10);++A)Q=parseInt(k[2],10),T[A-1]=Q===0?{hidden:!0}:{wch:Q},$a(T[A-1]);break;case"C":g=parseInt(N[w].slice(1))-1,T[g]||(T[g]={});break;case"R":m=parseInt(N[w].slice(1))-1,O[m]||(O[m]={}),Q>0?(O[m].hpt=Q,O[m].hpx=Il(Q)):Q===0&&(O[m].hidden=!0);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+_)}I<1&&(y=null);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+_)}}return O.length>0&&(b["!rows"]=O),T.length>0&&(b["!cols"]=T),d&&d.sheetRows&&(x=x.slice(0,d.sheetRows)),[x,b]}function a(u,d){var p=i(u,d),m=p[0],g=p[1],v=hf(m,d);return Tr(g).forEach(function(w){v[w]=g[w]}),v}function o(u,d){return qa(a(u,d),d)}function l(u,d,p,m){var g="C;Y"+(p+1)+";X"+(m+1)+";K";switch(u.t){case"n":g+=u.v||0,u.f&&!u.F&&(g+=";E"+UO(u.f,{r:p,c:m}));break;case"b":g+=u.v?"TRUE":"FALSE";break;case"e":g+=u.w||u.v;break;case"d":g+='"'+(u.w||u.v)+'"';break;case"s":g+='"'+u.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return g}function f(u,d){d.forEach(function(p,m){var g="F;W"+(m+1)+" "+(m+1)+" ";p.hidden?g+="0":(typeof p.width=="number"&&!p.wpx&&(p.wpx=Rc(p.width)),typeof p.wpx=="number"&&!p.wch&&(p.wch=Qc(p.wpx)),typeof p.wch=="number"&&(g+=Math.round(p.wch))),g.charAt(g.length-1)!=" "&&u.push(g)})}function c(u,d){d.forEach(function(p,m){var g="F;";p.hidden?g+="M0;":p.hpt?g+="M"+20*p.hpt+";":p.hpx&&(g+="M"+20*Fc(p.hpx)+";"),g.length>2&&u.push(g+"R"+(m+1))})}function h(u,d){var p=["ID;PWXL;N;E"],m=[],g=wt(u["!ref"]),v,w=Array.isArray(u),x=`\r
`;p.push("P;PGeneral"),p.push("F;P0;DG0G8;M255"),u["!cols"]&&f(p,u["!cols"]),u["!rows"]&&c(p,u["!rows"]),p.push("B;Y"+(g.e.r-g.s.r+1)+";X"+(g.e.c-g.s.c+1)+";D"+[g.s.c,g.s.r,g.e.c,g.e.r].join(" "));for(var S=g.s.r;S<=g.e.r;++S)for(var y=g.s.c;y<=g.e.c;++y){var b=it({r:S,c:y});v=w?(u[S]||[])[y]:u[b],!(!v||v.v==null&&(!v.f||v.F))&&m.push(l(v,u,S,y))}return p.join(x)+x+m.join(x)+x+"E"+x}return{to_workbook:o,to_sheet:a,from_sheet:h}}(),nT=function(){function r(s,a){switch(a.type){case"base64":return e(ci(s),a);case"binary":return e(s,a);case"buffer":return e(gt&&Buffer.isBuffer(s)?s.toString("binary"):Va(s),a);case"array":return e(Ao(s),a)}throw new Error("Unrecognized type "+a.type)}function e(s,a){for(var o=s.split(`
`),l=-1,f=-1,c=0,h=[];c!==o.length;++c){if(o[c].trim()==="BOT"){h[++l]=[],f=0;continue}if(!(l<0)){var u=o[c].trim().split(","),d=u[0],p=u[1];++c;for(var m=o[c]||"";(m.match(/["]/g)||[]).length&1&&c<o.length-1;)m+=`
`+o[++c];switch(m=m.trim(),+d){case-1:if(m==="BOT"){h[++l]=[],f=0;continue}else if(m!=="EOD")throw new Error("Unrecognized DIF special command "+m);break;case 0:m==="TRUE"?h[l][f]=!0:m==="FALSE"?h[l][f]=!1:isNaN(Vi(p))?isNaN(Dl(p).getDate())?h[l][f]=p:h[l][f]=hr(p):h[l][f]=Vi(p),++f;break;case 1:m=m.slice(1,m.length-1),m=m.replace(/""/g,'"'),m&&m.match(/^=".*"$/)&&(m=m.slice(2,-1)),h[l][f++]=m!==""?m:null;break}if(m==="EOD")break}}return a&&a.sheetRows&&(h=h.slice(0,a.sheetRows)),h}function t(s,a){return hf(r(s,a),a)}function n(s,a){return qa(t(s,a),a)}var i=function(){var s=function(l,f,c,h,u){l.push(f),l.push(c+","+h),l.push('"'+u.replace(/"/g,'""')+'"')},a=function(l,f,c,h){l.push(f+","+c),l.push(f==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(l){var f=[],c=wt(l["!ref"]),h,u=Array.isArray(l);s(f,"TABLE",0,1,"sheetjs"),s(f,"VECTORS",0,c.e.r-c.s.r+1,""),s(f,"TUPLES",0,c.e.c-c.s.c+1,""),s(f,"DATA",0,0,"");for(var d=c.s.r;d<=c.e.r;++d){a(f,-1,0,"BOT");for(var p=c.s.c;p<=c.e.c;++p){var m=it({r:d,c:p});if(h=u?(l[d]||[])[p]:l[m],!h){a(f,1,0,"");continue}switch(h.t){case"n":var g=h.w;!g&&h.v!=null&&(g=h.v),g==null?h.f&&!h.F?a(f,1,0,"="+h.f):a(f,1,0,""):a(f,0,g,"V");break;case"b":a(f,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":a(f,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=hi(h.z||et[14],Vr(hr(h.v)))),a(f,0,h.w,"V");break;default:a(f,1,0,"")}}}a(f,-1,0,"EOD");var v=`\r
`,w=f.join(v);return w}}();return{to_workbook:n,to_sheet:t,from_sheet:i}}(),iT=function(){function r(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(h,u){for(var d=h.split(`
`),p=-1,m=-1,g=0,v=[];g!==d.length;++g){var w=d[g].trim().split(":");if(w[0]==="cell"){var x=wr(w[1]);if(v.length<=x.r)for(p=v.length;p<=x.r;++p)v[p]||(v[p]=[]);switch(p=x.r,m=x.c,w[2]){case"t":v[p][m]=r(w[3]);break;case"v":v[p][m]=+w[3];break;case"vtf":var S=w[w.length-1];case"vtc":switch(w[3]){case"nl":v[p][m]=!!+w[4];break;default:v[p][m]=+w[4];break}w[2]=="vtf"&&(v[p][m]=[v[p][m],S])}}}return u&&u.sheetRows&&(v=v.slice(0,u.sheetRows)),v}function n(h,u){return hf(t(h,u),u)}function i(h,u){return qa(n(h,u),u)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function f(h){if(!h||!h["!ref"])return"";for(var u=[],d=[],p,m="",g=Dn(h["!ref"]),v=Array.isArray(h),w=g.s.r;w<=g.e.r;++w)for(var x=g.s.c;x<=g.e.c;++x)if(m=it({r:w,c:x}),p=v?(h[w]||[])[x]:h[m],!(!p||p.v==null||p.t==="z")){switch(d=["cell",m,"t"],p.t){case"s":case"str":d.push(e(p.v));break;case"n":p.f?(d[2]="vtf",d[3]="n",d[4]=p.v,d[5]=e(p.f)):(d[2]="v",d[3]=p.v);break;case"b":d[2]="vt"+(p.f?"f":"c"),d[3]="nl",d[4]=p.v?"1":"0",d[5]=e(p.f||(p.v?"TRUE":"FALSE"));break;case"d":var S=Vr(hr(p.v));d[2]="vtc",d[3]="nd",d[4]=""+S,d[5]=p.w||hi(p.z||et[14],S);break;case"e":continue}u.push(d.join(":"))}return u.push("sheet:c:"+(g.e.c-g.s.c+1)+":r:"+(g.e.r-g.s.r+1)+":tvf:1"),u.push("valueformat:1:text-wiki"),u.join(`
`)}function c(h){return[s,a,o,a,f(h),l].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:c}}(),Ml=function(){function r(c,h,u,d,p){p.raw?h[u][d]=c:c===""||(c==="TRUE"?h[u][d]=!0:c==="FALSE"?h[u][d]=!1:isNaN(Vi(c))?isNaN(Dl(c).getDate())?h[u][d]=c:h[u][d]=hr(c):h[u][d]=Vi(c))}function e(c,h){var u=h||{},d=[];if(!c||c.length===0)return d;for(var p=c.split(/[\r\n]/),m=p.length-1;m>=0&&p[m].length===0;)--m;for(var g=10,v=0,w=0;w<=m;++w)v=p[w].indexOf(" "),v==-1?v=p[w].length:v++,g=Math.max(g,v);for(w=0;w<=m;++w){d[w]=[];var x=0;for(r(p[w].slice(0,g).trim(),d,w,x,u),x=1;x<=(p[w].length-g)/10+1;++x)r(p[w].slice(g+(x-1)*10,g+x*10).trim(),d,w,x,u)}return u.sheetRows&&(d=d.slice(0,u.sheetRows)),d}var t={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(c){for(var h={},u=!1,d=0,p=0;d<c.length;++d)(p=c.charCodeAt(d))==34?u=!u:!u&&p in t&&(h[p]=(h[p]||0)+1);p=[];for(d in h)Object.prototype.hasOwnProperty.call(h,d)&&p.push([h[d],d]);if(!p.length){h=n;for(d in h)Object.prototype.hasOwnProperty.call(h,d)&&p.push([h[d],d])}return p.sort(function(m,g){return m[0]-g[0]||n[m[1]]-n[g[1]]}),t[p.pop()[1]]||44}function s(c,h){var u=h||{},d="",p=u.dense?[]:{},m={s:{c:0,r:0},e:{c:0,r:0}};c.slice(0,4)=="sep="?c.charCodeAt(5)==13&&c.charCodeAt(6)==10?(d=c.charAt(4),c=c.slice(7)):c.charCodeAt(5)==13||c.charCodeAt(5)==10?(d=c.charAt(4),c=c.slice(6)):d=i(c.slice(0,1024)):u.FS?d=u.FS:d=i(c.slice(0,1024));var g=0,v=0,w=0,x=0,S=0,y=d.charCodeAt(0),b=!1,O=0,T=c.charCodeAt(0);c=c.replace(/\r\n/mg,`
`);var k=u.dateNF!=null?JQ(u.dateNF):null;function Q(){var A=c.slice(x,S),_={};if(A.charAt(0)=='"'&&A.charAt(A.length-1)=='"'&&(A=A.slice(1,-1).replace(/""/g,'"')),A.length===0)_.t="z";else if(u.raw)_.t="s",_.v=A;else if(A.trim().length===0)_.t="s",_.v=A;else if(A.charCodeAt(0)==61)A.charCodeAt(1)==34&&A.charCodeAt(A.length-1)==34?(_.t="s",_.v=A.slice(2,-1).replace(/""/g,'"')):E6(A)?(_.t="n",_.f=A.slice(1)):(_.t="s",_.v=A);else if(A=="TRUE")_.t="b",_.v=!0;else if(A=="FALSE")_.t="b",_.v=!1;else if(!isNaN(w=Vi(A)))_.t="n",u.cellText!==!1&&(_.w=A),_.v=w;else if(!isNaN(Dl(A).getDate())||k&&A.match(k)){_.z=u.dateNF||et[14];var N=0;k&&A.match(k)&&(A=eF(A,u.dateNF,A.match(k)||[]),N=1),u.cellDates?(_.t="d",_.v=hr(A,N)):(_.t="n",_.v=Vr(hr(A,N))),u.cellText!==!1&&(_.w=hi(_.z,_.v instanceof Date?Vr(_.v):_.v)),u.cellNF||delete _.z}else _.t="s",_.v=A;if(_.t=="z"||(u.dense?(p[g]||(p[g]=[]),p[g][v]=_):p[it({c:v,r:g})]=_),x=S+1,T=c.charCodeAt(x),m.e.c<v&&(m.e.c=v),m.e.r<g&&(m.e.r=g),O==y)++v;else if(v=0,++g,u.sheetRows&&u.sheetRows<=g)return!0}e:for(;S<c.length;++S)switch(O=c.charCodeAt(S)){case 34:T===34&&(b=!b);break;case y:case 10:case 13:if(!b&&Q())break e;break}return S-x>0&&Q(),p["!ref"]=ht(m),p}function a(c,h){return!(h&&h.PRN)||h.FS||c.slice(0,4)=="sep="||c.indexOf("	")>=0||c.indexOf(",")>=0||c.indexOf(";")>=0?s(c,h):hf(e(c,h),h)}function o(c,h){var u="",d=h.type=="string"?[0,0,0,0]:KO(c,h);switch(h.type){case"base64":u=ci(c);break;case"binary":u=c;break;case"buffer":h.codepage==65001?u=c.toString("utf8"):h.codepage&&typeof St<"u"?u=St.utils.decode(h.codepage,c):u=gt&&Buffer.isBuffer(c)?c.toString("binary"):Va(c);break;case"array":u=Ao(c);break;case"string":u=c;break;default:throw new Error("Unrecognized type "+h.type)}return d[0]==239&&d[1]==187&&d[2]==191?u=qt(u.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?u=qt(u):h.type=="binary"&&typeof St<"u"&&h.codepage&&(u=St.utils.decode(h.codepage,St.utils.encode(28591,u))),u.slice(0,19)=="socialcalc:version:"?iT.to_sheet(h.type=="string"?u:qt(u),h):a(u,h)}function l(c,h){return qa(o(c,h),h)}function f(c){for(var h=[],u=wt(c["!ref"]),d,p=Array.isArray(c),m=u.s.r;m<=u.e.r;++m){for(var g=[],v=u.s.c;v<=u.e.c;++v){var w=it({r:m,c:v});if(d=p?(c[m]||[])[v]:c[w],!d||d.v==null){g.push("          ");continue}for(var x=(d.w||(_s(d),d.w)||"").slice(0,10);x.length<10;)x+=" ";g.push(x+(v===0?" ":""))}h.push(g.join(""))}return h.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:f}}();function mD(r,e){var t=e||{},n=!!t.WTF;t.WTF=!0;try{var i=rT.to_workbook(r,t);return t.WTF=n,i}catch(s){if(t.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return Ml.to_workbook(r,e)}}var yo=function(){function r(E,L,I){if(E){rn(E,E.l||0);for(var Z=I.Enum||he;E.l<E.length;){var ee=E.read_shift(2),ne=Z[ee]||Z[65535],de=E.read_shift(2),fe=E.l+de,pe=ne.f&&ne.f(E,de,I);if(E.l=fe,L(pe,ne,ee))return}}}function e(E,L){switch(L.type){case"base64":return t(ei(ci(E)),L);case"binary":return t(ei(E),L);case"buffer":case"array":return t(E,L)}throw"Unsupported type "+L.type}function t(E,L){if(!E)return E;var I=L||{},Z=I.dense?[]:{},ee="Sheet1",ne="",de=0,fe={},pe=[],Me=[],q={s:{r:0,c:0},e:{r:0,c:0}},He=I.sheetRows||0;if(E[2]==0&&(E[3]==8||E[3]==9)&&E.length>=16&&E[14]==5&&E[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(E[2]==2)I.Enum=he,r(E,function(ve,ct,bt){switch(bt){case 0:I.vers=ve,ve>=4096&&(I.qpro=!0);break;case 6:q=ve;break;case 204:ve&&(ne=ve);break;case 222:ne=ve;break;case 15:case 51:I.qpro||(ve[1].v=ve[1].v.slice(1));case 13:case 14:case 16:bt==14&&(ve[2]&112)==112&&(ve[2]&15)>1&&(ve[2]&15)<15&&(ve[1].z=I.dateNF||et[14],I.cellDates&&(ve[1].t="d",ve[1].v=C0(ve[1].v))),I.qpro&&ve[3]>de&&(Z["!ref"]=ht(q),fe[ee]=Z,pe.push(ee),Z=I.dense?[]:{},q={s:{r:0,c:0},e:{r:0,c:0}},de=ve[3],ee=ne||"Sheet"+(de+1),ne="");var Bt=I.dense?(Z[ve[0].r]||[])[ve[0].c]:Z[it(ve[0])];if(Bt){Bt.t=ve[1].t,Bt.v=ve[1].v,ve[1].z!=null&&(Bt.z=ve[1].z),ve[1].f!=null&&(Bt.f=ve[1].f);break}I.dense?(Z[ve[0].r]||(Z[ve[0].r]=[]),Z[ve[0].r][ve[0].c]=ve[1]):Z[it(ve[0])]=ve[1];break}},I);else if(E[2]==26||E[2]==14)I.Enum=ae,E[2]==14&&(I.qpro=!0,E.l=0),r(E,function(ve,ct,bt){switch(bt){case 204:ee=ve;break;case 22:ve[1].v=ve[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ve[3]>de&&(Z["!ref"]=ht(q),fe[ee]=Z,pe.push(ee),Z=I.dense?[]:{},q={s:{r:0,c:0},e:{r:0,c:0}},de=ve[3],ee="Sheet"+(de+1)),He>0&&ve[0].r>=He)break;I.dense?(Z[ve[0].r]||(Z[ve[0].r]=[]),Z[ve[0].r][ve[0].c]=ve[1]):Z[it(ve[0])]=ve[1],q.e.c<ve[0].c&&(q.e.c=ve[0].c),q.e.r<ve[0].r&&(q.e.r=ve[0].r);break;case 27:ve[14e3]&&(Me[ve[14e3][0]]=ve[14e3][1]);break;case 1537:Me[ve[0]]=ve[1],ve[0]==de&&(ee=ve[1]);break}},I);else throw new Error("Unrecognized LOTUS BOF "+E[2]);if(Z["!ref"]=ht(q),fe[ne||ee]=Z,pe.push(ne||ee),!Me.length)return{SheetNames:pe,Sheets:fe};for(var Ve={},Te=[],Ne=0;Ne<Me.length;++Ne)fe[pe[Ne]]?(Te.push(Me[Ne]||pe[Ne]),Ve[Me[Ne]]=fe[Me[Ne]]||fe[pe[Ne]]):(Te.push(Me[Ne]),Ve[Me[Ne]]={"!ref":"A1"});return{SheetNames:Te,Sheets:Ve}}function n(E,L){var I=L||{};if(+I.codepage>=0&&ki(+I.codepage),I.type=="string")throw new Error("Cannot write WK1 to JS string");var Z=zn(),ee=wt(E["!ref"]),ne=Array.isArray(E),de=[];$e(Z,0,s(1030)),$e(Z,6,l(ee));for(var fe=Math.min(ee.e.r,8191),pe=ee.s.r;pe<=fe;++pe)for(var Me=kr(pe),q=ee.s.c;q<=ee.e.c;++q){pe===ee.s.r&&(de[q]=cr(q));var He=de[q]+Me,Ve=ne?(E[pe]||[])[q]:E[He];if(!(!Ve||Ve.t=="z"))if(Ve.t=="n")(Ve.v|0)==Ve.v&&Ve.v>=-32768&&Ve.v<=32767?$e(Z,13,d(pe,q,Ve.v)):$e(Z,14,m(pe,q,Ve.v));else{var Te=_s(Ve);$e(Z,15,h(pe,q,Te.slice(0,239)))}}return $e(Z,1),Z.end()}function i(E,L){var I=L||{};if(+I.codepage>=0&&ki(+I.codepage),I.type=="string")throw new Error("Cannot write WK3 to JS string");var Z=zn();$e(Z,0,a(E));for(var ee=0,ne=0;ee<E.SheetNames.length;++ee)(E.Sheets[E.SheetNames[ee]]||{})["!ref"]&&$e(Z,27,V(E.SheetNames[ee],ne++));var de=0;for(ee=0;ee<E.SheetNames.length;++ee){var fe=E.Sheets[E.SheetNames[ee]];if(!(!fe||!fe["!ref"])){for(var pe=wt(fe["!ref"]),Me=Array.isArray(fe),q=[],He=Math.min(pe.e.r,8191),Ve=pe.s.r;Ve<=He;++Ve)for(var Te=kr(Ve),Ne=pe.s.c;Ne<=pe.e.c;++Ne){Ve===pe.s.r&&(q[Ne]=cr(Ne));var ve=q[Ne]+Te,ct=Me?(fe[Ve]||[])[Ne]:fe[ve];if(!(!ct||ct.t=="z"))if(ct.t=="n")$e(Z,23,Q(Ve,Ne,de,ct.v));else{var bt=_s(ct);$e(Z,22,O(Ve,Ne,de,bt.slice(0,239)))}}++de}}return $e(Z,1),Z.end()}function s(E){var L=Oe(2);return L.write_shift(2,E),L}function a(E){var L=Oe(26);L.write_shift(2,4096),L.write_shift(2,4),L.write_shift(4,0);for(var I=0,Z=0,ee=0,ne=0;ne<E.SheetNames.length;++ne){var de=E.SheetNames[ne],fe=E.Sheets[de];if(!(!fe||!fe["!ref"])){++ee;var pe=Dn(fe["!ref"]);I<pe.e.r&&(I=pe.e.r),Z<pe.e.c&&(Z=pe.e.c)}}return I>8191&&(I=8191),L.write_shift(2,I),L.write_shift(1,ee),L.write_shift(1,Z),L.write_shift(2,0),L.write_shift(2,0),L.write_shift(1,1),L.write_shift(1,2),L.write_shift(4,0),L.write_shift(4,0),L}function o(E,L,I){var Z={s:{c:0,r:0},e:{c:0,r:0}};return L==8&&I.qpro?(Z.s.c=E.read_shift(1),E.l++,Z.s.r=E.read_shift(2),Z.e.c=E.read_shift(1),E.l++,Z.e.r=E.read_shift(2),Z):(Z.s.c=E.read_shift(2),Z.s.r=E.read_shift(2),L==12&&I.qpro&&(E.l+=2),Z.e.c=E.read_shift(2),Z.e.r=E.read_shift(2),L==12&&I.qpro&&(E.l+=2),Z.s.c==65535&&(Z.s.c=Z.e.c=Z.s.r=Z.e.r=0),Z)}function l(E){var L=Oe(8);return L.write_shift(2,E.s.c),L.write_shift(2,E.s.r),L.write_shift(2,E.e.c),L.write_shift(2,E.e.r),L}function f(E,L,I){var Z=[{c:0,r:0},{t:"n",v:0},0,0];return I.qpro&&I.vers!=20768?(Z[0].c=E.read_shift(1),Z[3]=E.read_shift(1),Z[0].r=E.read_shift(2),E.l+=2):(Z[2]=E.read_shift(1),Z[0].c=E.read_shift(2),Z[0].r=E.read_shift(2)),Z}function c(E,L,I){var Z=E.l+L,ee=f(E,L,I);if(ee[1].t="s",I.vers==20768){E.l++;var ne=E.read_shift(1);return ee[1].v=E.read_shift(ne,"utf8"),ee}return I.qpro&&E.l++,ee[1].v=E.read_shift(Z-E.l,"cstr"),ee}function h(E,L,I){var Z=Oe(7+I.length);Z.write_shift(1,255),Z.write_shift(2,L),Z.write_shift(2,E),Z.write_shift(1,39);for(var ee=0;ee<Z.length;++ee){var ne=I.charCodeAt(ee);Z.write_shift(1,ne>=128?95:ne)}return Z.write_shift(1,0),Z}function u(E,L,I){var Z=f(E,L,I);return Z[1].v=E.read_shift(2,"i"),Z}function d(E,L,I){var Z=Oe(7);return Z.write_shift(1,255),Z.write_shift(2,L),Z.write_shift(2,E),Z.write_shift(2,I,"i"),Z}function p(E,L,I){var Z=f(E,L,I);return Z[1].v=E.read_shift(8,"f"),Z}function m(E,L,I){var Z=Oe(13);return Z.write_shift(1,255),Z.write_shift(2,L),Z.write_shift(2,E),Z.write_shift(8,I,"f"),Z}function g(E,L,I){var Z=E.l+L,ee=f(E,L,I);if(ee[1].v=E.read_shift(8,"f"),I.qpro)E.l=Z;else{var ne=E.read_shift(2);S(E.slice(E.l,E.l+ne),ee),E.l+=ne}return ee}function v(E,L,I){var Z=L&32768;return L&=-32769,L=(Z?E:0)+(L>=8192?L-16384:L),(Z?"":"$")+(I?cr(L):kr(L))}var w={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},x=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function S(E,L){rn(E,0);for(var I=[],Z=0,ee="",ne="",de="",fe="";E.l<E.length;){var pe=E[E.l++];switch(pe){case 0:I.push(E.read_shift(8,"f"));break;case 1:ne=v(L[0].c,E.read_shift(2),!0),ee=v(L[0].r,E.read_shift(2),!1),I.push(ne+ee);break;case 2:{var Me=v(L[0].c,E.read_shift(2),!0),q=v(L[0].r,E.read_shift(2),!1);ne=v(L[0].c,E.read_shift(2),!0),ee=v(L[0].r,E.read_shift(2),!1),I.push(Me+q+":"+ne+ee)}break;case 3:if(E.l<E.length){console.error("WK1 premature formula end");return}break;case 4:I.push("("+I.pop()+")");break;case 5:I.push(E.read_shift(2));break;case 6:{for(var He="";pe=E[E.l++];)He+=String.fromCharCode(pe);I.push('"'+He.replace(/"/g,'""')+'"')}break;case 8:I.push("-"+I.pop());break;case 23:I.push("+"+I.pop());break;case 22:I.push("NOT("+I.pop()+")");break;case 20:case 21:fe=I.pop(),de=I.pop(),I.push(["AND","OR"][pe-20]+"("+de+","+fe+")");break;default:if(pe<32&&x[pe])fe=I.pop(),de=I.pop(),I.push(de+x[pe]+fe);else if(w[pe]){if(Z=w[pe][1],Z==69&&(Z=E[E.l++]),Z>I.length){console.error("WK1 bad formula parse 0x"+pe.toString(16)+":|"+I.join("|")+"|");return}var Ve=I.slice(-Z);I.length-=Z,I.push(w[pe][0]+"("+Ve.join(",")+")")}else return pe<=7?console.error("WK1 invalid opcode "+pe.toString(16)):pe<=24?console.error("WK1 unsupported op "+pe.toString(16)):pe<=30?console.error("WK1 invalid opcode "+pe.toString(16)):pe<=115?console.error("WK1 unsupported function opcode "+pe.toString(16)):console.error("WK1 unrecognized opcode "+pe.toString(16))}}I.length==1?L[1].f=""+I[0]:console.error("WK1 bad formula parse |"+I.join("|")+"|")}function y(E){var L=[{c:0,r:0},{t:"n",v:0},0];return L[0].r=E.read_shift(2),L[3]=E[E.l++],L[0].c=E[E.l++],L}function b(E,L){var I=y(E);return I[1].t="s",I[1].v=E.read_shift(L-4,"cstr"),I}function O(E,L,I,Z){var ee=Oe(6+Z.length);ee.write_shift(2,E),ee.write_shift(1,I),ee.write_shift(1,L),ee.write_shift(1,39);for(var ne=0;ne<Z.length;++ne){var de=Z.charCodeAt(ne);ee.write_shift(1,de>=128?95:de)}return ee.write_shift(1,0),ee}function T(E,L){var I=y(E);I[1].v=E.read_shift(2);var Z=I[1].v>>1;if(I[1].v&1)switch(Z&7){case 0:Z=(Z>>3)*5e3;break;case 1:Z=(Z>>3)*500;break;case 2:Z=(Z>>3)/20;break;case 3:Z=(Z>>3)/200;break;case 4:Z=(Z>>3)/2e3;break;case 5:Z=(Z>>3)/2e4;break;case 6:Z=(Z>>3)/16;break;case 7:Z=(Z>>3)/64;break}return I[1].v=Z,I}function k(E,L){var I=y(E),Z=E.read_shift(4),ee=E.read_shift(4),ne=E.read_shift(2);if(ne==65535)return Z===0&&ee===3221225472?(I[1].t="e",I[1].v=15):Z===0&&ee===3489660928?(I[1].t="e",I[1].v=42):I[1].v=0,I;var de=ne&32768;return ne=(ne&32767)-16446,I[1].v=(1-de*2)*(ee*Math.pow(2,ne+32)+Z*Math.pow(2,ne)),I}function Q(E,L,I,Z){var ee=Oe(14);if(ee.write_shift(2,E),ee.write_shift(1,I),ee.write_shift(1,L),Z==0)return ee.write_shift(4,0),ee.write_shift(4,0),ee.write_shift(2,65535),ee;var ne=0,de=0,fe=0,pe=0;return Z<0&&(ne=1,Z=-Z),de=Math.log2(Z)|0,Z/=Math.pow(2,de-31),pe=Z>>>0,pe&2147483648||(Z/=2,++de,pe=Z>>>0),Z-=pe,pe|=2147483648,pe>>>=0,Z*=Math.pow(2,32),fe=Z>>>0,ee.write_shift(4,fe),ee.write_shift(4,pe),de+=16383+(ne?32768:0),ee.write_shift(2,de),ee}function A(E,L){var I=k(E);return E.l+=L-14,I}function _(E,L){var I=y(E),Z=E.read_shift(4);return I[1].v=Z>>6,I}function N(E,L){var I=y(E),Z=E.read_shift(8,"f");return I[1].v=Z,I}function U(E,L){var I=N(E);return E.l+=L-10,I}function z(E,L){return E[E.l+L-1]==0?E.read_shift(L,"cstr"):""}function K(E,L){var I=E[E.l++];I>L-1&&(I=L-1);for(var Z="";Z.length<I;)Z+=String.fromCharCode(E[E.l++]);return Z}function re(E,L,I){if(!(!I.qpro||L<21)){var Z=E.read_shift(1);E.l+=17,E.l+=1,E.l+=2;var ee=E.read_shift(L-21,"cstr");return[Z,ee]}}function ge(E,L){for(var I={},Z=E.l+L;E.l<Z;){var ee=E.read_shift(2);if(ee==14e3){for(I[ee]=[0,""],I[ee][0]=E.read_shift(2);E[E.l];)I[ee][1]+=String.fromCharCode(E[E.l]),E.l++;E.l++}}return I}function V(E,L){var I=Oe(5+E.length);I.write_shift(2,14e3),I.write_shift(2,L);for(var Z=0;Z<E.length;++Z){var ee=E.charCodeAt(Z);I[I.l++]=ee>127?95:ee}return I[I.l++]=0,I}var he={0:{n:"BOF",f:Dr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:u},14:{n:"NUMBER",f:p},15:{n:"LABEL",f:c},16:{n:"FORMULA",f:g},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:c},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:z},222:{n:"SHEETNAMELP",f:K},65535:{n:""}},ae={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:b},23:{n:"NUMBER17",f:k},24:{n:"NUMBER18",f:T},25:{n:"FORMULA19",f:A},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ge},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:_},38:{n:"??"},39:{n:"NUMBER27",f:N},40:{n:"FORMULA28",f:U},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:z},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:re},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:e}}();function gD(r){var e={},t=r.match(An),n=0,i=!1;if(t)for(;n!=t.length;++n){var s=at(t[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;e.cp=uO[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=s.val;break;case"<sz":e.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":s.rgb&&(e.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+s[0])}}return e}var OD=function(){var r=Tc("t"),e=Tc("rPr");function t(s){var a=s.match(r);if(!a)return{t:"s",v:""};var o={t:"s",v:Pt(a[1])},l=s.match(e);return l&&(o.s=gD(l[1])),o}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(a){return a.replace(n,"").split(i).map(t).filter(function(o){return o.v})}}(),xD=function(){var e=/(\r\n|\n)/g;function t(i,s,a){var o=[];i.u&&o.push("text-decoration: underline;"),i.uval&&o.push("text-underline-style:"+i.uval+";"),i.sz&&o.push("font-size:"+i.sz+"pt;"),i.outline&&o.push("text-effect: outline;"),i.shadow&&o.push("text-shadow: auto;"),s.push('<span style="'+o.join("")+'">'),i.b&&(s.push("<b>"),a.push("</b>")),i.i&&(s.push("<i>"),a.push("</i>")),i.strike&&(s.push("<s>"),a.push("</s>"));var l=i.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(s.push("<"+l+">"),a.push("</"+l+">")),a.push("</span>"),i}function n(i){var s=[[],i.v,[]];return i.v?(i.s&&t(i.s,s[0],s[2]),s[0].join("")+s[1].replace(e,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),vD=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,yD=/<(?:\w+:)?r>/,wD=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function IO(r,e){var t=e?e.cellHTML:!0,n={};return r?(r.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Pt(qt(r.slice(r.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=qt(r),t&&(n.h=yO(n.t))):r.match(yD)&&(n.r=qt(r),n.t=Pt(qt((r.replace(wD,"").match(vD)||[]).join("").replace(An,""))),t&&(n.h=xD(OD(n.r)))),n):{t:""}}var bD=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,_D=/<(?:\w+:)?(?:si|sstItem)>/g,kD=/<\/(?:\w+:)?(?:si|sstItem)>/;function SD(r,e){var t=[],n="";if(!r)return t;var i=r.match(bD);if(i){n=i[2].replace(_D,"").split(kD);for(var s=0;s!=n.length;++s){var a=IO(n[s].trim(),e);a!=null&&(t[t.length]=a)}i=at(i[1]),t.Count=i.count,t.Unique=i.uniqueCount}return t}var TD=/^\s|\s$|[\t\n\r]/;function sT(r,e){if(!e.bookSST)return"";var t=[Rr];t[t.length]=Fe("sst",null,{xmlns:Zo[0],count:r.Count,uniqueCount:r.Unique});for(var n=0;n!=r.length;++n)if(r[n]!=null){var i=r[n],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(TD)&&(s+=' xml:space="preserve"'),s+=">"+Ut(i.t)+"</t>"),s+="</si>",t[t.length]=s}return t.length>2&&(t[t.length]="</sst>",t[1]=t[1].replace("/>",">")),t.join("")}function CD(r){return[r.read_shift(4),r.read_shift(4)]}function AD(r,e){var t=[],n=!1;return ra(r,function(s,a,o){switch(o){case 159:t.Count=s[0],t.Unique=s[1];break;case 19:t.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(a.T,!n||e.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),t}function ED(r,e){return e||(e=Oe(8)),e.write_shift(4,r.Count),e.write_shift(4,r.Unique),e}var PD=BF;function RD(r){var e=zn();we(e,159,ED(r));for(var t=0;t<r.length;++t)we(e,19,PD(r[t]));return we(e,160),e.end()}function aT(r){if(typeof St<"u")return St.utils.encode(To,r);for(var e=[],t=r.split(""),n=0;n<t.length;++n)e[n]=t[n].charCodeAt(0);return e}function Xs(r,e){var t={};return t.Major=r.read_shift(2),t.Minor=r.read_shift(2),e>=4&&(r.l+=e-4),t}function QD(r){var e={};return e.id=r.read_shift(0,"lpp4"),e.R=Xs(r,4),e.U=Xs(r,4),e.W=Xs(r,4),e}function FD(r){for(var e=r.read_shift(4),t=r.l+e-4,n={},i=r.read_shift(4),s=[];i-- >0;)s.push({t:r.read_shift(4),v:r.read_shift(0,"lpp4")});if(n.name=r.read_shift(0,"lpp4"),n.comps=s,r.l!=t)throw new Error("Bad DataSpaceMapEntry: "+r.l+" != "+t);return n}function $D(r){var e=[];r.l+=4;for(var t=r.read_shift(4);t-- >0;)e.push(FD(r));return e}function ND(r){var e=[];r.l+=4;for(var t=r.read_shift(4);t-- >0;)e.push(r.read_shift(0,"lpp4"));return e}function DD(r){var e={};return r.read_shift(4),r.l+=4,e.id=r.read_shift(0,"lpp4"),e.name=r.read_shift(0,"lpp4"),e.R=Xs(r,4),e.U=Xs(r,4),e.W=Xs(r,4),e}function MD(r){var e=DD(r);if(e.ename=r.read_shift(0,"8lpp4"),e.blksz=r.read_shift(4),e.cmode=r.read_shift(4),r.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function oT(r,e){var t=r.l+e,n={};n.Flags=r.read_shift(4)&63,r.l+=4,n.AlgID=r.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=r.read_shift(4),n.KeySize=r.read_shift(4),n.ProviderType=r.read_shift(4),r.l+=8,n.CSPName=r.read_shift(t-r.l>>1,"utf16le"),r.l=t,n}function lT(r,e){var t={},n=r.l+e;return r.l+=4,t.Salt=r.slice(r.l,r.l+16),r.l+=16,t.Verifier=r.slice(r.l,r.l+16),r.l+=16,r.read_shift(4),t.VerifierHash=r.slice(r.l,n),r.l=n,t}function ID(r){var e=Xs(r);switch(e.Minor){case 2:return[e.Minor,LD(r)];case 3:return[e.Minor,BD()];case 4:return[e.Minor,ZD(r)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function LD(r){var e=r.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var t=r.read_shift(4),n=oT(r,t),i=lT(r,r.length-r.l);return{t:"Std",h:n,v:i}}function BD(){throw new Error("File is password-protected: ECMA-376 Extensible")}function ZD(r){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];r.l+=4;var t=r.read_shift(r.length-r.l,"utf8"),n={};return t.replace(An,function(s){var a=at(s);switch(Ps(a[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(o){n[o]=a[o]});break;case"<dataIntegrity":n.encryptedHmacKey=a.encryptedHmacKey,n.encryptedHmacValue=a.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=a.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(a);break;default:throw a[0]}}),n}function WD(r,e){var t={},n=t.EncryptionVersionInfo=Xs(r,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);t.Flags=r.read_shift(4),e-=4;var i=r.read_shift(4);return e-=4,t.EncryptionHeader=oT(r,i),e-=i,t.EncryptionVerifier=lT(r,e),t}function UD(r){var e={},t=e.EncryptionVersionInfo=Xs(r,4);if(t.Major!=1||t.Minor!=1)throw"unrecognized version code "+t.Major+" : "+t.Minor;return e.Salt=r.read_shift(16),e.EncryptedVerifier=r.read_shift(16),e.EncryptedVerifierHash=r.read_shift(16),e}function LO(r){var e=0,t,n=aT(r),i=n.length+1,s,a,o,l,f;for(t=Fa(i),t[0]=n.length,s=1;s!=i;++s)t[s]=n[s-1];for(s=i-1;s>=0;--s)a=t[s],o=e&16384?1:0,l=e<<1&32767,f=o|l,e=f^a;return e^52811}var fT=function(){var r=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],t=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(a){return(a/2|a*128)&255},i=function(a,o){return n(a^o)},s=function(a){for(var o=e[a.length-1],l=104,f=a.length-1;f>=0;--f)for(var c=a[f],h=0;h!=7;++h)c&64&&(o^=t[l]),c*=2,--l;return o};return function(a){for(var o=aT(a),l=s(o),f=o.length,c=Fa(16),h=0;h!=16;++h)c[h]=0;var u,d,p;for((f&1)===1&&(u=l>>8,c[f]=i(r[0],u),--f,u=l&255,d=o[o.length-1],c[f]=i(d,u));f>0;)--f,u=l>>8,c[f]=i(o[f],u),--f,u=l&255,c[f]=i(o[f],u);for(f=15,p=15-o.length;p>0;)u=l>>8,c[f]=i(r[p],u),--f,--p,u=l&255,c[f]=i(o[f],u),--f,--p;return c}}(),XD=function(r,e,t,n,i){i||(i=e),n||(n=fT(r));var s,a;for(s=0;s!=e.length;++s)a=e[s],a^=n[t],a=(a>>5|a<<3)&255,i[s]=a,++t;return[i,t,n]},VD=function(r){var e=0,t=fT(r);return function(n){var i=XD("",n,e,t);return e=i[1],i[0]}};function qD(r,e,t,n){var i={key:Dr(r),verificationBytes:Dr(r)};return t.password&&(i.verifier=LO(t.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=VD(t.password)),i}function jD(r,e,t){var n=t;return n.Info=r.read_shift(2),r.l-=2,n.Info===1?n.Data=UD(r):n.Data=WD(r,e),n}function zD(r,e,t){var n={Type:t.biff>=8?r.read_shift(2):0};return n.Type?jD(r,e-2,n):qD(r,t.biff>=8?e:e-2,t,n),n}var cT=function(){function r(i,s){switch(s.type){case"base64":return e(ci(i),s);case"binary":return e(i,s);case"buffer":return e(gt&&Buffer.isBuffer(i)?i.toString("binary"):Va(i),s);case"array":return e(Ao(i),s)}throw new Error("Unrecognized type "+s.type)}function e(i,s){var a=s||{},o=a.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var f={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(c,h){Array.isArray(o)&&(o[h]=[]);for(var u=/\\\w+\b/g,d=0,p,m=-1;p=u.exec(c);){switch(p[0]){case"\\cell":var g=c.slice(d,u.lastIndex-p[0].length);if(g[0]==" "&&(g=g.slice(1)),++m,g.length){var v={v:g,t:"s"};Array.isArray(o)?o[h][m]=v:o[it({r:h,c:m})]=v}break}d=u.lastIndex}m>f.e.c&&(f.e.c=m)}),o["!ref"]=ht(f),o}function t(i,s){return qa(r(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],a=wt(i["!ref"]),o,l=Array.isArray(i),f=a.s.r;f<=a.e.r;++f){s.push("\\trowd\\trautofit1");for(var c=a.s.c;c<=a.e.c;++c)s.push("\\cellx"+(c+1));for(s.push("\\pard\\intbl"),c=a.s.c;c<=a.e.c;++c){var h=it({r:f,c});o=l?(i[f]||[])[c]:i[h],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(_s(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:t,to_sheet:r,from_sheet:n}}();function GD(r){var e=r.slice(r[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function Pc(r){for(var e=0,t=1;e!=3;++e)t=t*256+(r[e]>255?255:r[e]<0?0:r[e]);return t.toString(16).toUpperCase().slice(1)}function HD(r){var e=r[0]/255,t=r[1]/255,n=r[2]/255,i=Math.max(e,t,n),s=Math.min(e,t,n),a=i-s;if(a===0)return[0,0,e];var o=0,l=0,f=i+s;switch(l=a/(f>1?2-f:f),i){case e:o=((t-n)/a+6)%6;break;case t:o=(n-e)/a+2;break;case n:o=(e-t)/a+4;break}return[o/6,l,f/2]}function YD(r){var e=r[0],t=r[1],n=r[2],i=t*2*(n<.5?n:1-n),s=n-i/2,a=[s,s,s],o=6*e,l;if(t!==0)switch(o|0){case 0:case 6:l=i*o,a[0]+=i,a[1]+=l;break;case 1:l=i*(2-o),a[0]+=l,a[1]+=i;break;case 2:l=i*(o-2),a[1]+=i,a[2]+=l;break;case 3:l=i*(4-o),a[1]+=l,a[2]+=i;break;case 4:l=i*(o-4),a[2]+=i,a[0]+=l;break;case 5:l=i*(6-o),a[2]+=l,a[0]+=i;break}for(var f=0;f!=3;++f)a[f]=Math.round(a[f]*255);return a}function Ed(r,e){if(e===0)return r;var t=HD(GD(r));return e<0?t[2]=t[2]*(1+e):t[2]=1-(1-t[2])*(1-e),Pc(YD(t))}var hT=6,KD=15,JD=1,xn=hT;function Rc(r){return Math.floor((r+Math.round(128/xn)/256)*xn)}function Qc(r){return Math.floor((r-5)/xn*100+.5)/100}function Pd(r){return Math.round((r*xn+5)/xn*256)/256}function gp(r){return Pd(Qc(Rc(r)))}function BO(r){var e=Math.abs(r-gp(r)),t=xn;if(e>.005)for(xn=JD;xn<KD;++xn)Math.abs(r-gp(r))<=e&&(e=Math.abs(r-gp(r)),t=xn);xn=t}function $a(r){r.width?(r.wpx=Rc(r.width),r.wch=Qc(r.wpx),r.MDW=xn):r.wpx?(r.wch=Qc(r.wpx),r.width=Pd(r.wch),r.MDW=xn):typeof r.wch=="number"&&(r.width=Pd(r.wch),r.wpx=Rc(r.width),r.MDW=xn),r.customWidth&&delete r.customWidth}var eM=96,uT=eM;function Fc(r){return r*96/uT}function Il(r){return r*uT/96}var tM={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function rM(r,e,t,n){e.Borders=[];var i={},s=!1;(r[0].match(An)||[]).forEach(function(a){var o=at(a);switch(Ps(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},o.diagonalUp&&(i.diagonalUp=fr(o.diagonalUp)),o.diagonalDown&&(i.diagonalDown=fr(o.diagonalDown)),e.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in borders")}})}function nM(r,e,t,n){e.Fills=[];var i={},s=!1;(r[0].match(An)||[]).forEach(function(a){var o=at(a);switch(Ps(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},e.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":o.patternType&&(i.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),o.indexed&&(i.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(i.bgColor.theme=parseInt(o.theme,10)),o.tint&&(i.bgColor.tint=parseFloat(o.tint)),o.rgb&&(i.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),o.theme&&(i.fgColor.theme=parseInt(o.theme,10)),o.tint&&(i.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(i.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fills")}})}function iM(r,e,t,n){e.Fonts=[];var i={},s=!1;(r[0].match(An)||[]).forEach(function(a){var o=at(a);switch(Ps(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(i),i={};break;case"<name":o.val&&(i.name=qt(o.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=o.val?fr(o.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=o.val?fr(o.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(o.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=o.val?fr(o.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=o.val?fr(o.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=o.val?fr(o.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=o.val?fr(o.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=o.val?fr(o.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":o.val&&(i.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(i.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(i.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(i.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=uO[parseInt(o.val,10)];break;case"<color":if(i.color||(i.color={}),o.auto&&(i.color.auto=fr(o.auto)),o.rgb)i.color.rgb=o.rgb.slice(-6);else if(o.indexed){i.color.index=parseInt(o.indexed,10);var l=xo[i.color.index];i.color.index==81&&(l=xo[1]),l||(l=xo[1]),i.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(i.color.theme=parseInt(o.theme,10),o.tint&&(i.color.tint=parseFloat(o.tint)),o.theme&&t.themeElements&&t.themeElements.clrScheme&&(i.color.rgb=Ed(t.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fonts")}})}function sM(r,e,t){e.NumberFmt=[];for(var n=Tr(et),i=0;i<n.length;++i)e.NumberFmt[n[i]]=et[n[i]];var s=r[0].match(An);if(s)for(i=0;i<s.length;++i){var a=at(s[i]);switch(Ps(a[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=Pt(qt(a.formatCode)),l=parseInt(a.numFmtId,10);if(e.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&e.NumberFmt[l]!=null;--l);e.NumberFmt[l]=o}ys(o,l)}}break;case"</numFmt>":break;default:if(t.WTF)throw new Error("unrecognized "+a[0]+" in numFmts")}}}function aM(r){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var n=t[0];n<=t[1];++n)r[n]!=null&&(e[e.length]=Fe("numFmt",null,{numFmtId:n,formatCode:Ut(r[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=Fe("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var Gh=["numFmtId","fillId","fontId","borderId","xfId"],Hh=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function oM(r,e,t){e.CellXf=[];var n,i=!1;(r[0].match(An)||[]).forEach(function(s){var a=at(s),o=0;switch(Ps(a[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=a,delete n[0],o=0;o<Gh.length;++o)n[Gh[o]]&&(n[Gh[o]]=parseInt(n[Gh[o]],10));for(o=0;o<Hh.length;++o)n[Hh[o]]&&(n[Hh[o]]=fr(n[Hh[o]]));if(e.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[o]){n.numFmtId=o;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};a.vertical&&(l.vertical=a.vertical),a.horizontal&&(l.horizontal=a.horizontal),a.textRotation!=null&&(l.textRotation=a.textRotation),a.indent&&(l.indent=a.indent),a.wrapText&&(l.wrapText=fr(a.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(t&&t.WTF&&!i)throw new Error("unrecognized "+a[0]+" in cellXfs")}})}function lM(r){var e=[];return e[e.length]=Fe("cellXfs",null),r.forEach(function(t){e[e.length]=Fe("xf",null,t)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=Fe("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var fM=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,f){var c={};if(!o)return c;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var h;return(h=o.match(e))&&sM(h,c,f),(h=o.match(i))&&iM(h,c,l,f),(h=o.match(n))&&nM(h,c,l,f),(h=o.match(s))&&rM(h,c,l,f),(h=o.match(t))&&oM(h,c,f),c}}();function dT(r,e){var t=[Rr,Fe("styleSheet",null,{xmlns:Zo[0],"xmlns:vt":Xr.vt})],n;return r.SSF&&(n=aM(r.SSF))!=null&&(t[t.length]=n),t[t.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',t[t.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',t[t.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',t[t.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=lM(e.cellXfs))&&(t[t.length]=n),t[t.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',t[t.length]='<dxfs count="0"/>',t[t.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',t.length>2&&(t[t.length]="</styleSheet>",t[1]=t[1].replace("/>",">")),t.join("")}function cM(r,e){var t=r.read_shift(2),n=kn(r);return[t,n]}function hM(r,e,t){t||(t=Oe(6+4*e.length)),t.write_shift(2,r),Kr(e,t);var n=t.length>t.l?t.slice(0,t.l):t;return t.l==null&&(t.l=t.length),n}function uM(r,e,t){var n={};n.sz=r.read_shift(2)/20;var i=jF(r);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=r.read_shift(2);switch(s===700&&(n.bold=1),r.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var a=r.read_shift(1);a!=0&&(n.underline=a);var o=r.read_shift(1);o>0&&(n.family=o);var l=r.read_shift(1);switch(l>0&&(n.charset=l),r.l++,n.color=qF(r),r.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=kn(r),n}function dM(r,e){e||(e=Oe(25+4*32)),e.write_shift(2,r.sz*20),zF(r,e),e.write_shift(2,r.bold?700:400);var t=0;r.vertAlign=="superscript"?t=1:r.vertAlign=="subscript"&&(t=2),e.write_shift(2,t),e.write_shift(1,r.underline||0),e.write_shift(1,r.family||0),e.write_shift(1,r.charset||0),e.write_shift(1,0),Td(r.color,e);var n=0;return r.scheme=="major"&&(n=1),r.scheme=="minor"&&(n=2),e.write_shift(1,n),Kr(r.name,e),e.length>e.l?e.slice(0,e.l):e}var pM=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Op,mM=Sn;function Dy(r,e){e||(e=Oe(4*3+8*7+16*1)),Op||(Op=S0(pM));var t=Op[r.patternType];t==null&&(t=40),e.write_shift(4,t);var n=0;if(t!=40)for(Td({auto:1},e),Td({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function gM(r,e){var t=r.l+e,n=r.read_shift(2),i=r.read_shift(2);return r.l=t,{ixfe:n,numFmtId:i}}function pT(r,e,t){t||(t=Oe(16)),t.write_shift(2,e||0),t.write_shift(2,r.numFmtId||0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);var n=0;return t.write_shift(1,n),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t}function kf(r,e){return e||(e=Oe(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var OM=Sn;function xM(r,e){return e||(e=Oe(51)),e.write_shift(1,0),kf(null,e),kf(null,e),kf(null,e),kf(null,e),kf(null,e),e.length>e.l?e.slice(0,e.l):e}function vM(r,e){return e||(e=Oe(12+4*10)),e.write_shift(4,r.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),Sd(r.name||"",e),e.length>e.l?e.slice(0,e.l):e}function yM(r,e,t){var n=Oe(2052);return n.write_shift(4,r),Sd(e,n),Sd(t,n),n.length>n.l?n.slice(0,n.l):n}function wM(r,e,t){var n={};n.NumberFmt=[];for(var i in et)n.NumberFmt[i]=et[i];n.CellXf=[],n.Fonts=[];var s=[],a=!1;return ra(r,function(l,f,c){switch(c){case 44:n.NumberFmt[l[0]]=l[1],ys(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(l.color.rgb=Ed(e.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:s.push(c),a=!0;break;case 38:s.pop(),a=!1;break;default:if(f.T>0)s.push(c);else if(f.T<0)s.pop();else if(!a||t.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+c.toString(16))}}),n}function bM(r,e){if(e){var t=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&++t}),t!=0&&(we(r,615,qi(t)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&we(r,44,hM(i,e[i]))}),we(r,616))}}function _M(r){var e=1;we(r,611,qi(e)),we(r,43,dM({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),we(r,612)}function kM(r){var e=2;we(r,603,qi(e)),we(r,45,Dy({patternType:"none"})),we(r,45,Dy({patternType:"gray125"})),we(r,604)}function SM(r){var e=1;we(r,613,qi(e)),we(r,46,xM()),we(r,614)}function TM(r){var e=1;we(r,626,qi(e)),we(r,47,pT({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),we(r,627)}function CM(r,e){we(r,617,qi(e.length)),e.forEach(function(t){we(r,47,pT(t,0))}),we(r,618)}function AM(r){var e=1;we(r,619,qi(e)),we(r,48,vM({xfId:0,builtinId:0,name:"Normal"})),we(r,620)}function EM(r){var e=0;we(r,505,qi(e)),we(r,506)}function PM(r){var e=0;we(r,508,yM(e,"TableStyleMedium9","PivotStyleMedium4")),we(r,509)}function RM(r,e){var t=zn();return we(t,278),bM(t,r.SSF),_M(t),kM(t),SM(t),TM(t),CM(t,e.cellXfs),AM(t),EM(t),PM(t),we(t,279),t.end()}var QM=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function FM(r,e,t){e.themeElements.clrScheme=[];var n={};(r[0].match(An)||[]).forEach(function(i){var s=at(i);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(e.themeElements.clrScheme[QM.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(t&&t.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function $M(){}function NM(){}var DM=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,MM=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,IM=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function LM(r,e,t){e.themeElements={};var n;[["clrScheme",DM,FM],["fontScheme",MM,$M],["fmtScheme",IM,NM]].forEach(function(i){if(!(n=r.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,e,t)})}var BM=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function mT(r,e){(!r||r.length===0)&&(r=ZO());var t,n={};if(!(t=r.match(BM)))throw new Error("themeElements not found in theme");return LM(t[0],n,e),n.raw=r,n}function ZO(r,e){if(e&&e.themeXLSX)return e.themeXLSX;if(r&&typeof r.raw=="string")return r.raw;var t=[Rr];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function ZM(r,e,t){var n=r.l+e,i=r.read_shift(4);if(i!==124226){if(!t.cellStyles){r.l=n;return}var s=r.slice(r.l);r.l=n;var a;try{a=hS(s,{type:"array"})}catch{return}var o=ti(a,"theme/theme/theme1.xml",!0);if(o)return mT(o,t)}}function WM(r){return r.read_shift(4)}function UM(r){var e={};switch(e.xclrType=r.read_shift(2),e.nTintShade=r.read_shift(2),e.xclrType){case 0:r.l+=4;break;case 1:e.xclrValue=XM(r,4);break;case 2:e.xclrValue=zS(r);break;case 3:e.xclrValue=WM(r);break;case 4:r.l+=4;break}return r.l+=8,e}function XM(r,e){return Sn(r,e)}function VM(r,e){return Sn(r,e)}function qM(r){var e=r.read_shift(2),t=r.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=UM(r);break;case 6:n[1]=VM(r,t);break;case 14:case 15:n[1]=r.read_shift(t===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+t)}return n}function jM(r,e){var t=r.l+e;r.l+=2;var n=r.read_shift(2);r.l+=2;for(var i=r.read_shift(2),s=[];i-- >0;)s.push(qM(r,t-r.l));return{ixfe:n,ext:s}}function zM(r,e){e.forEach(function(t){switch(t[0]){}})}function GM(r,e){return{flags:r.read_shift(4),version:r.read_shift(4),name:kn(r)}}function HM(r){var e=Oe(12+2*r.name.length);return e.write_shift(4,r.flags),e.write_shift(4,r.version),Kr(r.name,e),e.slice(0,e.l)}function YM(r){for(var e=[],t=r.read_shift(4);t-- >0;)e.push([r.read_shift(4),r.read_shift(4)]);return e}function KM(r){var e=Oe(4+8*r.length);e.write_shift(4,r.length);for(var t=0;t<r.length;++t)e.write_shift(4,r[t][0]),e.write_shift(4,r[t][1]);return e}function JM(r,e){var t=Oe(8+2*e.length);return t.write_shift(4,r),Kr(e,t),t.slice(0,t.l)}function e6(r){return r.l+=4,r.read_shift(4)!=0}function t6(r,e){var t=Oe(8);return t.write_shift(4,r),t.write_shift(4,1),t}function r6(r,e,t){var n={Types:[],Cell:[],Value:[]},i=t||{},s=[],a=!1,o=2;return ra(r,function(l,f,c){switch(c){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(h){o==1?n.Cell.push({type:n.Types[h[0]-1].name,index:h[1]}):o==0&&n.Value.push({type:n.Types[h[0]-1].name,index:h[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:s.push(c),a=!0;break;case 36:s.pop(),a=!1;break;default:if(!f.T){if(!a||i.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+c.toString(16))}}}),n}function n6(){var r=zn();return we(r,332),we(r,334,qi(1)),we(r,335,HM({name:"XLDAPR",version:12e4,flags:3496657072})),we(r,336),we(r,339,JM(1,"XLDAPR")),we(r,52),we(r,35,qi(514)),we(r,4096,qi(0)),we(r,4097,yi(1)),we(r,36),we(r,53),we(r,340),we(r,337,t6(1)),we(r,51,KM([[1,0]])),we(r,338),we(r,333),r.end()}function i6(r,e,t){var n={Types:[],Cell:[],Value:[]};if(!r)return n;var i=!1,s=2,a;return r.replace(An,function(o){var l=at(o);switch(Ps(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var f=0;f<n.Types.length;++f)n.Types[f].name==l.name&&(a=n.Types[f]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):s==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!a)break;a.offsets||(a.offsets=[]),a.offsets.push(+l.i);break;default:if(!i&&t.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function gT(){var r=[Rr];return r.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),r.join("")}function s6(r){var e=[];if(!r)return e;var t=1;return(r.match(An)||[]).forEach(function(n){var i=at(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?t=i.i:i.i=t,e.push(i);break}}),e}function a6(r){var e={};e.i=r.read_shift(4);var t={};t.r=r.read_shift(4),t.c=r.read_shift(4),e.r=it(t);var n=r.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function o6(r,e,t){var n=[];return ra(r,function(s,a,o){switch(o){case 63:n.push(s);break;default:if(!a.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function l6(r,e,t,n){if(!r)return r;var i=n||{},s=!1;ra(r,function(o,l,f){switch(f){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!l.T){if(!s||i.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}},i)}function f6(r,e){if(!r)return"??";var t=(r.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][t].Target}var dl=1024;function OT(r,e){for(var t=[21600,21600],n=["m0,0l0",t[1],t[0],t[1],t[0],"0xe"].join(","),i=[Fe("xml",null,{"xmlns:v":Jn.v,"xmlns:o":Jn.o,"xmlns:x":Jn.x,"xmlns:mv":Jn.mv}).replace(/\/>/,">"),Fe("o:shapelayout",Fe("o:idmap",null,{"v:ext":"edit",data:r}),{"v:ext":"edit"}),Fe("v:shapetype",[Fe("v:stroke",null,{joinstyle:"miter"}),Fe("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:t.join(","),path:n})];dl<r*1e3;)dl+=1e3;return e.forEach(function(s){var a=wr(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?Fe("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,f=Fe("v:fill",l,o),c={on:"t",obscured:"t"};++dl,i=i.concat(["<v:shape"+Cc({id:"_x0000_s"+dl,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",f,Fe("v:shadow",null,c),Fe("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",cn("x:Anchor",[a.c+1,0,a.r+1,0,a.c+3,20,a.r+5,20].join(",")),cn("x:AutoFill","False"),cn("x:Row",String(a.r)),cn("x:Column",String(a.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function My(r,e,t,n){var i=Array.isArray(r),s;e.forEach(function(a){var o=wr(a.ref);if(i?(r[o.r]||(r[o.r]=[]),s=r[o.r][o.c]):s=r[a.ref],!s){s={t:"z"},i?r[o.r][o.c]=s:r[a.ref]=s;var l=wt(r["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var f=ht(l);f!==r["!ref"]&&(r["!ref"]=f)}s.c||(s.c=[]);var c={a:a.author,t:a.t,r:a.r,T:t};a.h&&(c.h=a.h);for(var h=s.c.length-1;h>=0;--h){if(!t&&s.c[h].T)return;t&&!s.c[h].T&&s.c.splice(h,1)}if(t&&n){for(h=0;h<n.length;++h)if(c.a==n[h].id){c.a=n[h].name||c.a;break}}s.c.push(c)})}function c6(r,e){if(r.match(/<(?:\w+:)?comments *\/>/))return[];var t=[],n=[],i=r.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&t.push(o[1])}});var s=r.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=at(o[0]),f={author:l.authorId&&t[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},c=wr(l.ref);if(!(e.sheetRows&&e.sheetRows<=c.r)){var h=a.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),u=!!h&&!!h[1]&&IO(h[1])||{r:"",t:"",h:""};f.r=u.r,u.r=="<t></t>"&&(u.t=u.h=""),f.t=(u.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(f.h=u.h),n.push(f)}}}}),n}function xT(r){var e=[Rr,Fe("comments",null,{xmlns:Zo[0]})],t=[];return e.push("<authors>"),r.forEach(function(n){n[1].forEach(function(i){var s=Ut(i.a);t.indexOf(s)==-1&&(t.push(s),e.push("<author>"+s+"</author>")),i.T&&i.ID&&t.indexOf("tc="+i.ID)==-1&&(t.push("tc="+i.ID),e.push("<author>tc="+i.ID+"</author>"))})}),t.length==0&&(t.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),r.forEach(function(n){var i=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=t.indexOf("tc="+n[1][0].ID):n[1].forEach(function(l){l.a&&(i=t.indexOf(Ut(l.a))),s.push(l.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),s.length<=1)e.push(cn("t",Ut(s[0]||"")));else{for(var a=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)a+=`Reply:
    `+s[o]+`
`;e.push(cn("t",Ut(a)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function h6(r,e){var t=[],n=!1,i={},s=0;return r.replace(An,function(o,l){var f=at(o);switch(Ps(f[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:f.personId,guid:f.id,ref:f.ref,T:1};break;case"</threadedComment>":i.t!=null&&t.push(i);break;case"<text>":case"<text":s=l+o.length;break;case"</text>":i.t=r.slice(s,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+f[0]+" in threaded comments")}return o}),t}function u6(r,e,t){var n=[Rr,Fe("ThreadedComments",null,{xmlns:Xr.TCMNT}).replace(/[\/]>/,">")];return r.forEach(function(i){var s="";(i[1]||[]).forEach(function(a,o){if(!a.T){delete a.ID;return}a.a&&e.indexOf(a.a)==-1&&e.push(a.a);var l={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+t.tcid++).slice(-12)+"}"};o==0?s=l.id:l.parentId=s,a.ID=l.id,a.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(a.a)).slice(-12)+"}"),n.push(Fe("threadedComment",cn("text",a.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function d6(r,e){var t=[],n=!1;return r.replace(An,function(s){var a=at(s);switch(Ps(a[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":t.push({name:a.displayname,id:a.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+a[0]+" in threaded comments")}return s}),t}function p6(r){var e=[Rr,Fe("personList",null,{xmlns:Xr.TCMNT,"xmlns:x":Zo[0]}).replace(/[\/]>/,">")];return r.forEach(function(t,n){e.push(Fe("person",null,{displayName:t,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:t,providerId:"None"}))}),e.push("</personList>"),e.join("")}function m6(r){var e={};e.iauthor=r.read_shift(4);var t=Vo(r);return e.rfx=t.s,e.ref=it(t.s),r.l+=16,e}function g6(r,e){return e==null&&(e=Oe(36)),e.write_shift(4,r[1].iauthor),uf(r[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var O6=kn;function x6(r){return Kr(r.slice(0,54))}function v6(r,e){var t=[],n=[],i={},s=!1;return ra(r,function(o,l,f){switch(f){case 632:n.push(o);break;case 635:i=o;break;case 637:i.t=o.t,i.h=o.h,i.r=o.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,e.sheetRows&&i.rfx&&e.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,t.push(i);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!s||e.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}),t}function y6(r){var e=zn(),t=[];return we(e,628),we(e,630),r.forEach(function(n){n[1].forEach(function(i){t.indexOf(i.a)>-1||(t.push(i.a.slice(0,54)),we(e,632,x6(i.a)))})}),we(e,631),we(e,633),r.forEach(function(n){n[1].forEach(function(i){i.iauthor=t.indexOf(i.a);var s={s:wr(n[0]),e:wr(n[0])};we(e,635,g6([s,i])),i.t&&i.t.length>0&&we(e,637,WF(i)),we(e,636),delete i.iauthor})}),we(e,634),we(e,629),e.end()}var w6="application/vnd.ms-office.vbaProject";function b6(r){var e=Ye.utils.cfb_new({root:"R"});return r.FullPaths.forEach(function(t,n){if(!(t.slice(-1)==="/"||!t.match(/_VBA_PROJECT_CUR/))){var i=t.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Ye.utils.cfb_add(e,i,r.FileIndex[n].content)}}),Ye.write(e)}function _6(r,e){e.FullPaths.forEach(function(t,n){if(n!=0){var i=t.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&Ye.utils.cfb_add(r,i,e.FileIndex[n].content)}})}var vT=["xlsb","xlsm","xlam","biff8","xla"];function k6(){return{"!type":"dialog"}}function S6(){return{"!type":"dialog"}}function T6(){return{"!type":"macro"}}function C6(){return{"!type":"macro"}}var kl=function(){var r=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function t(n,i,s,a){var o=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var f=s.length>0?parseInt(s,10)|0:0,c=a.length>0?parseInt(a,10)|0:0;return o?c+=e.c:--c,l?f+=e.r:--f,i+(o?"":"$")+cr(c)+(l?"":"$")+kr(f)}return function(i,s){return e=s,i.replace(r,t)}}(),WO=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,UO=function(){return function(e,t){return e.replace(WO,function(n,i,s,a,o,l){var f=EO(a)-(s?0:t.c),c=AO(l)-(o?0:t.r),h=c==0?"":o?c+1:"["+c+"]",u=f==0?"":s?f+1:"["+f+"]";return i+"R"+h+"C"+u})}}();function yT(r,e){return r.replace(WO,function(t,n,i,s,a,o){return n+(i=="$"?i+s:cr(EO(s)+e.c))+(a=="$"?a+o:kr(AO(o)+e.r))})}function A6(r,e,t){var n=Dn(e),i=n.s,s=wr(t),a={r:s.r-i.r,c:s.c-i.c};return yT(r,a)}function E6(r){return r.length!=1}function Iy(r){return r.replace(/_xlfn\./g,"")}function $r(r){r.l+=1}function Na(r,e){var t=r.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function wT(r,e,t){var n=2;if(t){if(t.biff>=2&&t.biff<=5)return bT(r);t.biff==12&&(n=4)}var i=r.read_shift(n),s=r.read_shift(n),a=Na(r),o=Na(r);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function bT(r){var e=Na(r),t=Na(r),n=r.read_shift(1),i=r.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:t[0],c:i,cRel:t[1],rRel:t[2]}}}function P6(r,e,t){if(t.biff<8)return bT(r);var n=r.read_shift(t.biff==12?4:2),i=r.read_shift(t.biff==12?4:2),s=Na(r),a=Na(r);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:a[0],cRel:a[1],rRel:a[2]}}}function _T(r,e,t){if(t&&t.biff>=2&&t.biff<=5)return R6(r);var n=r.read_shift(t&&t.biff==12?4:2),i=Na(r);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function R6(r){var e=Na(r),t=r.read_shift(1);return{r:e[0],c:t,cRel:e[1],rRel:e[2]}}function Q6(r){var e=r.read_shift(2),t=r.read_shift(2);return{r:e,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function F6(r,e,t){var n=t&&t.biff?t.biff:8;if(n>=2&&n<=5)return $6(r);var i=r.read_shift(n>=12?4:2),s=r.read_shift(2),a=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;i>524287;)i-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:a,rRel:o}}function $6(r){var e=r.read_shift(2),t=r.read_shift(1),n=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),i==1&&t>=128&&(t=t-256),{r:e,c:t,cRel:i,rRel:n}}function N6(r,e,t){var n=(r[r.l++]&96)>>5,i=wT(r,t.biff>=2&&t.biff<=5?6:8,t);return[n,i]}function D6(r,e,t){var n=(r[r.l++]&96)>>5,i=r.read_shift(2,"i"),s=8;if(t)switch(t.biff){case 5:r.l+=12,s=6;break;case 12:s=12;break}var a=wT(r,s,t);return[n,i,a]}function M6(r,e,t){var n=(r[r.l++]&96)>>5;return r.l+=t&&t.biff>8?12:t.biff<8?6:8,[n]}function I6(r,e,t){var n=(r[r.l++]&96)>>5,i=r.read_shift(2),s=8;if(t)switch(t.biff){case 5:r.l+=12,s=6;break;case 12:s=12;break}return r.l+=s,[n,i]}function L6(r,e,t){var n=(r[r.l++]&96)>>5,i=P6(r,e-1,t);return[n,i]}function B6(r,e,t){var n=(r[r.l++]&96)>>5;return r.l+=t.biff==2?6:t.biff==12?14:7,[n]}function Ly(r){var e=r[r.l+1]&1,t=1;return r.l+=4,[e,t]}function Z6(r,e,t){r.l+=2;for(var n=r.read_shift(t&&t.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(r.read_shift(t&&t.biff==2?1:2));return i}function W6(r,e,t){var n=r[r.l+1]&255?1:0;return r.l+=2,[n,r.read_shift(t&&t.biff==2?1:2)]}function U6(r,e,t){var n=r[r.l+1]&255?1:0;return r.l+=2,[n,r.read_shift(t&&t.biff==2?1:2)]}function X6(r){var e=r[r.l+1]&255?1:0;return r.l+=2,[e,r.read_shift(2)]}function V6(r,e,t){var n=r[r.l+1]&255?1:0;return r.l+=t&&t.biff==2?3:4,[n]}function kT(r){var e=r.read_shift(1),t=r.read_shift(1);return[e,t]}function q6(r){return r.read_shift(2),kT(r)}function j6(r){return r.read_shift(2),kT(r)}function z6(r,e,t){var n=(r[r.l]&96)>>5;r.l+=1;var i=_T(r,0,t);return[n,i]}function G6(r,e,t){var n=(r[r.l]&96)>>5;r.l+=1;var i=F6(r,0,t);return[n,i]}function H6(r,e,t){var n=(r[r.l]&96)>>5;r.l+=1;var i=r.read_shift(2);t&&t.biff==5&&(r.l+=12);var s=_T(r,0,t);return[n,i,s]}function Y6(r,e,t){var n=(r[r.l]&96)>>5;r.l+=1;var i=r.read_shift(t&&t.biff<=3?1:2);return[eI[i],CT[i],n]}function K6(r,e,t){var n=r[r.l++],i=r.read_shift(1),s=t&&t.biff<=3?[n==88?-1:0,r.read_shift(1)]:J6(r);return[i,(s[0]===0?CT:J8)[s[1]]]}function J6(r){return[r[r.l+1]>>7,r.read_shift(2)&32767]}function e8(r,e,t){r.l+=t&&t.biff==2?3:4}function t8(r,e,t){if(r.l++,t&&t.biff==12)return[r.read_shift(4,"i"),0];var n=r.read_shift(2),i=r.read_shift(t&&t.biff==2?1:2);return[n,i]}function r8(r){return r.l++,na[r.read_shift(1)]}function n8(r){return r.l++,r.read_shift(2)}function i8(r){return r.l++,r.read_shift(1)!==0}function s8(r){return r.l++,yn(r)}function a8(r,e,t){return r.l++,yh(r,e-1,t)}function o8(r,e){var t=[r.read_shift(1)];if(e==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=Ar(r,1)?"TRUE":"FALSE",e!=12&&(r.l+=7);break;case 37:case 16:t[1]=na[r[r.l]],r.l+=e==12?4:8;break;case 0:r.l+=8;break;case 1:t[1]=yn(r);break;case 2:t[1]=qo(r,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function l8(r,e,t){for(var n=r.read_shift(t.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((t.biff==12?Vo:E0)(r));return i}function f8(r,e,t){var n=0,i=0;t.biff==12?(n=r.read_shift(4),i=r.read_shift(4)):(i=1+r.read_shift(1),n=1+r.read_shift(2)),t.biff>=2&&t.biff<8&&(--n,--i==0&&(i=256));for(var s=0,a=[];s!=n&&(a[s]=[]);++s)for(var o=0;o!=i;++o)a[s][o]=o8(r,t.biff);return a}function c8(r,e,t){var n=r.read_shift(1)>>>5&3,i=!t||t.biff>=8?4:2,s=r.read_shift(i);switch(t.biff){case 2:r.l+=5;break;case 3:case 4:r.l+=8;break;case 5:r.l+=12;break}return[n,0,s]}function h8(r,e,t){if(t.biff==5)return u8(r);var n=r.read_shift(1)>>>5&3,i=r.read_shift(2),s=r.read_shift(4);return[n,i,s]}function u8(r){var e=r.read_shift(1)>>>5&3,t=r.read_shift(2,"i");r.l+=8;var n=r.read_shift(2);return r.l+=12,[e,t,n]}function d8(r,e,t){var n=r.read_shift(1)>>>5&3;r.l+=t&&t.biff==2?3:4;var i=r.read_shift(t&&t.biff==2?1:2);return[n,i]}function p8(r,e,t){var n=r.read_shift(1)>>>5&3,i=r.read_shift(t&&t.biff==2?1:2);return[n,i]}function m8(r,e,t){var n=r.read_shift(1)>>>5&3;return r.l+=4,t.biff<8&&r.l--,t.biff==12&&(r.l+=2),[n]}function g8(r,e,t){var n=(r[r.l++]&96)>>5,i=r.read_shift(2),s=4;if(t)switch(t.biff){case 5:s=15;break;case 12:s=6;break}return r.l+=s,[n,i]}var O8=Sn,x8=Sn,v8=Sn;function bh(r,e,t){return r.l+=2,[Q6(r)]}function XO(r){return r.l+=6,[]}var y8=bh,w8=XO,b8=XO,_8=bh;function ST(r){return r.l+=2,[Dr(r),r.read_shift(2)&1]}var k8=bh,S8=ST,T8=XO,C8=bh,A8=bh,E8=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function P8(r){r.l+=2;var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(4),i=r.read_shift(2),s=r.read_shift(2),a=E8[t>>2&31];return{ixti:e,coltype:t&3,rt:a,idx:n,c:i,C:s}}function R8(r){return r.l+=2,[r.read_shift(4)]}function Q8(r,e,t){return r.l+=5,r.l+=2,r.l+=t.biff==2?1:4,["PTGSHEET"]}function F8(r,e,t){return r.l+=t.biff==2?4:5,["PTGENDSHEET"]}function $8(r){var e=r.read_shift(1)>>>5&3,t=r.read_shift(2);return[e,t]}function N8(r){var e=r.read_shift(1)>>>5&3,t=r.read_shift(2);return[e,t]}function D8(r){return r.l+=4,[0,0]}var By={1:{n:"PtgExp",f:t8},2:{n:"PtgTbl",f:v8},3:{n:"PtgAdd",f:$r},4:{n:"PtgSub",f:$r},5:{n:"PtgMul",f:$r},6:{n:"PtgDiv",f:$r},7:{n:"PtgPower",f:$r},8:{n:"PtgConcat",f:$r},9:{n:"PtgLt",f:$r},10:{n:"PtgLe",f:$r},11:{n:"PtgEq",f:$r},12:{n:"PtgGe",f:$r},13:{n:"PtgGt",f:$r},14:{n:"PtgNe",f:$r},15:{n:"PtgIsect",f:$r},16:{n:"PtgUnion",f:$r},17:{n:"PtgRange",f:$r},18:{n:"PtgUplus",f:$r},19:{n:"PtgUminus",f:$r},20:{n:"PtgPercent",f:$r},21:{n:"PtgParen",f:$r},22:{n:"PtgMissArg",f:$r},23:{n:"PtgStr",f:a8},26:{n:"PtgSheet",f:Q8},27:{n:"PtgEndSheet",f:F8},28:{n:"PtgErr",f:r8},29:{n:"PtgBool",f:i8},30:{n:"PtgInt",f:n8},31:{n:"PtgNum",f:s8},32:{n:"PtgArray",f:B6},33:{n:"PtgFunc",f:Y6},34:{n:"PtgFuncVar",f:K6},35:{n:"PtgName",f:c8},36:{n:"PtgRef",f:z6},37:{n:"PtgArea",f:N6},38:{n:"PtgMemArea",f:d8},39:{n:"PtgMemErr",f:O8},40:{n:"PtgMemNoMem",f:x8},41:{n:"PtgMemFunc",f:p8},42:{n:"PtgRefErr",f:m8},43:{n:"PtgAreaErr",f:M6},44:{n:"PtgRefN",f:G6},45:{n:"PtgAreaN",f:L6},46:{n:"PtgMemAreaN",f:$8},47:{n:"PtgMemNoMemN",f:N8},57:{n:"PtgNameX",f:h8},58:{n:"PtgRef3d",f:H6},59:{n:"PtgArea3d",f:D6},60:{n:"PtgRefErr3d",f:g8},61:{n:"PtgAreaErr3d",f:I6},255:{}},M8={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},I8={1:{n:"PtgElfLel",f:ST},2:{n:"PtgElfRw",f:C8},3:{n:"PtgElfCol",f:y8},6:{n:"PtgElfRwV",f:A8},7:{n:"PtgElfColV",f:_8},10:{n:"PtgElfRadical",f:k8},11:{n:"PtgElfRadicalS",f:T8},13:{n:"PtgElfColS",f:w8},15:{n:"PtgElfColSV",f:b8},16:{n:"PtgElfRadicalLel",f:S8},25:{n:"PtgList",f:P8},29:{n:"PtgSxName",f:R8},255:{}},L8={0:{n:"PtgAttrNoop",f:D8},1:{n:"PtgAttrSemi",f:V6},2:{n:"PtgAttrIf",f:U6},4:{n:"PtgAttrChoose",f:Z6},8:{n:"PtgAttrGoto",f:W6},16:{n:"PtgAttrSum",f:e8},32:{n:"PtgAttrBaxcel",f:Ly},33:{n:"PtgAttrBaxcel",f:Ly},64:{n:"PtgAttrSpace",f:q6},65:{n:"PtgAttrSpaceSemi",f:j6},128:{n:"PtgAttrIfError",f:X6},255:{}};function _h(r,e,t,n){if(n.biff<8)return Sn(r,e);for(var i=r.l+e,s=[],a=0;a!==t.length;++a)switch(t[a][0]){case"PtgArray":t[a][1]=f8(r,0,n),s.push(t[a][1]);break;case"PtgMemArea":t[a][2]=l8(r,t[a][1],n),s.push(t[a][2]);break;case"PtgExp":n&&n.biff==12&&(t[a][1][1]=r.read_shift(4),s.push(t[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[a][0]}return e=i-r.l,e!==0&&s.push(Sn(r,e)),s}function kh(r,e,t){for(var n=r.l+e,i,s,a=[];n!=r.l;)e=n-r.l,s=r[r.l],i=By[s]||By[M8[s]],(s===24||s===25)&&(i=(s===24?I8:L8)[r[r.l+1]]),!i||!i.f?Sn(r,e):a.push([i.n,i.f(r,e,t)]);return a}function B8(r){for(var e=[],t=0;t<r.length;++t){for(var n=r[t],i=[],s=0;s<n.length;++s){var a=n[s];if(a)switch(a[0]){case 2:i.push('"'+a[1].replace(/"/g,'""')+'"');break;default:i.push(a[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var Z8={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function W8(r,e){if(!r&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(r)?"'"+r+"'":r}function TT(r,e,t){if(!r)return"SH33TJSERR0";if(t.biff>8&&(!r.XTI||!r.XTI[e]))return r.SheetNames[e];if(!r.XTI)return"SH33TJSERR6";var n=r.XTI[e];if(t.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":r.XTI[e-1];if(!n)return"SH33TJSERR1";var i="";if(t.biff>8)switch(r[n[0]][0]){case 357:return i=n[1]==-1?"#REF":r.SheetNames[n[1]],n[1]==n[2]?i:i+":"+r.SheetNames[n[2]];case 358:return t.SID!=null?r.SheetNames[t.SID]:"SH33TJSSAME"+r[n[0]][0];case 355:default:return"SH33TJSSRC"+r[n[0]][0]}switch(r[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":r.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+r.SheetNames[n[2]];case 14849:return r[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return r[n[0]][0][3]?(i=n[1]==-1?"#REF":r[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+r[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Zy(r,e,t){var n=TT(r,e,t);return n=="#REF"?n:W8(n,t)}function gn(r,e,t,n,i){var s=i&&i.biff||8,a={s:{c:0,r:0},e:{c:0,r:0}},o=[],l,f,c,h=0,u=0,d,p="";if(!r[0]||!r[0][0])return"";for(var m=-1,g="",v=0,w=r[0].length;v<w;++v){var x=r[0][v];switch(x[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),f=o.pop(),m>=0){switch(r[0][m][1][0]){case 0:g=_r(" ",r[0][m][1][1]);break;case 1:g=_r("\r",r[0][m][1][1]);break;default:if(g="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+r[0][m][1][0])}f=f+g,m=-1}o.push(f+Z8[x[0]]+l);break;case"PtgIsect":l=o.pop(),f=o.pop(),o.push(f+" "+l);break;case"PtgUnion":l=o.pop(),f=o.pop(),o.push(f+","+l);break;case"PtgRange":l=o.pop(),f=o.pop(),o.push(f+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":c=cc(x[1][1],a,i),o.push(hc(c,s));break;case"PtgRefN":c=t?cc(x[1][1],t,i):x[1][1],o.push(hc(c,s));break;case"PtgRef3d":h=x[1][1],c=cc(x[1][2],a,i),p=Zy(n,h,i),o.push(p+"!"+hc(c,s));break;case"PtgFunc":case"PtgFuncVar":var S=x[1][0],y=x[1][1];S||(S=0),S&=127;var b=S==0?[]:o.slice(-S);o.length-=S,y==="User"&&(y=b.shift()),o.push(y+"("+b.join(",")+")");break;case"PtgBool":o.push(x[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(x[1]);break;case"PtgNum":o.push(String(x[1]));break;case"PtgStr":o.push('"'+x[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(x[1]);break;case"PtgAreaN":d=gy(x[1][1],t?{s:t}:a,i),o.push(dp(d,i));break;case"PtgArea":d=gy(x[1][1],a,i),o.push(dp(d,i));break;case"PtgArea3d":h=x[1][1],d=x[1][2],p=Zy(n,h,i),o.push(p+"!"+dp(d,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":u=x[1][2];var O=(n.names||[])[u-1]||(n[0]||[])[u],T=O?O.Name:"SH33TJSNAME"+String(u);T&&T.slice(0,6)=="_xlfn."&&!i.xlfn&&(T=T.slice(6)),o.push(T);break;case"PtgNameX":var k=x[1][1];u=x[1][2];var Q;if(i.biff<=5)k<0&&(k=-k),n[k]&&(Q=n[k][u]);else{var A="";if(((n[k]||[])[0]||[])[0]==14849||(((n[k]||[])[0]||[])[0]==1025?n[k][u]&&n[k][u].itab>0&&(A=n.SheetNames[n[k][u].itab-1]+"!"):A=n.SheetNames[u-1]+"!"),n[k]&&n[k][u])A+=n[k][u].Name;else if(n[0]&&n[0][u])A+=n[0][u].Name;else{var _=(TT(n,k,i)||"").split(";;");_[u-1]?A=_[u-1]:A+="SH33TJSERRX"}o.push(A);break}Q||(Q={Name:"SH33TJSERRY"}),o.push(Q.Name);break;case"PtgParen":var N="(",U=")";if(m>=0){switch(g="",r[0][m][1][0]){case 2:N=_r(" ",r[0][m][1][1])+N;break;case 3:N=_r("\r",r[0][m][1][1])+N;break;case 4:U=_r(" ",r[0][m][1][1])+U;break;case 5:U=_r("\r",r[0][m][1][1])+U;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+r[0][m][1][0])}m=-1}o.push(N+o.pop()+U);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":c={c:x[1][1],r:x[1][0]};var z={c:t.c,r:t.r};if(n.sharedf[it(c)]){var K=n.sharedf[it(c)];o.push(gn(K,a,z,n,i))}else{var re=!1;for(l=0;l!=n.arrayf.length;++l)if(f=n.arrayf[l],!(c.c<f[0].s.c||c.c>f[0].e.c)&&!(c.r<f[0].s.r||c.r>f[0].e.r)){o.push(gn(f[1],a,z,n,i)),re=!0;break}re||o.push(x[1])}break;case"PtgArray":o.push("{"+B8(x[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=v;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+x[1].idx+"[#"+x[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(x));default:throw new Error("Unrecognized Formula Token: "+String(x))}var ge=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&m>=0&&ge.indexOf(r[0][v][0])==-1){x=r[0][m];var V=!0;switch(x[1][0]){case 4:V=!1;case 0:g=_r(" ",x[1][1]);break;case 5:V=!1;case 1:g=_r("\r",x[1][1]);break;default:if(g="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+x[1][0])}o.push((V?g:"")+o.pop()+(V?"":g)),m=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function U8(r,e,t){var n=r.l+e,i=t.biff==2?1:2,s,a=r.read_shift(i);if(a==65535)return[[],Sn(r,e-2)];var o=kh(r,a,t);return e!==a+i&&(s=_h(r,e-a-i,o,t)),r.l=n,[o,s]}function X8(r,e,t){var n=r.l+e,i=t.biff==2?1:2,s,a=r.read_shift(i);if(a==65535)return[[],Sn(r,e-2)];var o=kh(r,a,t);return e!==a+i&&(s=_h(r,e-a-i,o,t)),r.l=n,[o,s]}function V8(r,e,t,n){var i=r.l+e,s=kh(r,n,t),a;return i!==r.l&&(a=_h(r,i-r.l,s,t)),[s,a]}function q8(r,e,t){var n=r.l+e,i,s=r.read_shift(2),a=kh(r,s,t);return s==65535?[[],Sn(r,e-2)]:(e!==s+2&&(i=_h(r,n-s-2,a,t)),[a,i])}function j8(r){var e;if(Ws(r,r.l+6)!==65535)return[yn(r),"n"];switch(r[r.l]){case 0:return r.l+=8,["String","s"];case 1:return e=r[r.l+2]===1,r.l+=8,[e,"b"];case 2:return e=r[r.l+2],r.l+=8,[e,"e"];case 3:return r.l+=8,["","s"]}return[]}function z8(r){if(r==null){var e=Oe(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof r=="number")return Eo(r);return Eo(0)}function xp(r,e,t){var n=r.l+e,i=Rs(r);t.biff==2&&++r.l;var s=j8(r),a=r.read_shift(1);t.biff!=2&&(r.read_shift(1),t.biff>=5&&r.read_shift(4));var o=X8(r,n-r.l,t);return{cell:i,val:s[0],formula:o,shared:a>>3&1,tt:s[1]}}function G8(r,e,t,n,i){var s=Ro(e,t,i),a=z8(r.v),o=Oe(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var f=Oe(r.bf.length),c=0;c<r.bf.length;++c)f[c]=r.bf[c];var h=Hr([s,a,o,f]);return h}function P0(r,e,t){var n=r.read_shift(4),i=kh(r,n,t),s=r.read_shift(4),a=s>0?_h(r,s,i,t):null;return[i,a]}var H8=P0,R0=P0,Y8=P0,K8=P0,J8={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},CT={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},eI={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Wy(r){return r.slice(0,3)=="of:"&&(r=r.slice(3)),r.charCodeAt(0)==61&&(r=r.slice(1),r.charCodeAt(0)==61&&(r=r.slice(1))),r=r.replace(/COM\.MICROSOFT\./g,""),r=r.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,t){return t.replace(/\./g,"")}),r=r.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),r.replace(/[;~]/g,",").replace(/\|/g,";")}function tI(r){var e="of:="+r.replace(WO,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function vp(r){var e=r.split(":"),t=e[0].split(".")[0];return[t,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function rI(r){return r.replace(/\./,"!")}var dc={},Sl={},pc=typeof Map<"u";function VO(r,e,t){var n=0,i=r.length;if(t){if(pc?t.has(e):Object.prototype.hasOwnProperty.call(t,e)){for(var s=pc?t.get(e):t[e];n<s.length;++n)if(r[s[n]].t===e)return r.Count++,s[n]}}else for(;n<i;++n)if(r[n].t===e)return r.Count++,n;return r[i]={t:e},r.Count++,r.Unique++,t&&(pc?(t.has(e)||t.set(e,[]),t.get(e).push(i)):(Object.prototype.hasOwnProperty.call(t,e)||(t[e]=[]),t[e].push(i))),i}function Q0(r,e){var t={min:r+1,max:r+1},n=-1;return e.MDW&&(xn=e.MDW),e.width!=null?t.customWidth=1:e.wpx!=null?n=Qc(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(t.width=Pd(n),t.customWidth=1):e.width!=null&&(t.width=e.width),e.hidden&&(t.hidden=!0),e.level!=null&&(t.outlineLevel=t.level=e.level),t}function wo(r,e){if(r){var t=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(t=[1,1,1,1,.5,.5]),r.left==null&&(r.left=t[0]),r.right==null&&(r.right=t[1]),r.top==null&&(r.top=t[2]),r.bottom==null&&(r.bottom=t[3]),r.header==null&&(r.header=t[4]),r.footer==null&&(r.footer=t[5])}}function ja(r,e,t){var n=t.revssf[e.z!=null?e.z:"General"],i=60,s=r.length;if(n==null&&t.ssf){for(;i<392;++i)if(t.ssf[i]==null){ys(e.z,i),t.ssf[i]=e.z,t.revssf[e.z]=n=i;break}}for(i=0;i!=s;++i)if(r[i].numFmtId===n)return i;return r[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function AT(r,e,t,n,i,s){try{n.cellNF&&(r.z=et[e])}catch(o){if(n.WTF)throw o}if(!(r.t==="z"&&!n.cellStyles)){if(r.t==="d"&&typeof r.v=="string"&&(r.v=hr(r.v)),(!n||n.cellText!==!1)&&r.t!=="z")try{if(et[e]==null&&ys(KQ[e]||"General",e),r.t==="e")r.w=r.w||na[r.v];else if(e===0)if(r.t==="n")(r.v|0)===r.v?r.w=r.v.toString(10):r.w=Sc(r.v);else if(r.t==="d"){var a=Vr(r.v);(a|0)===a?r.w=a.toString(10):r.w=Sc(a)}else{if(r.v===void 0)return"";r.w=Co(r.v,Sl)}else r.t==="d"?r.w=hi(e,Vr(r.v),Sl):r.w=hi(e,r.v,Sl)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&t!=null)try{r.s=s.Fills[t],r.s.fgColor&&r.s.fgColor.theme&&!r.s.fgColor.rgb&&(r.s.fgColor.rgb=Ed(i.themeElements.clrScheme[r.s.fgColor.theme].rgb,r.s.fgColor.tint||0),n.WTF&&(r.s.fgColor.raw_rgb=i.themeElements.clrScheme[r.s.fgColor.theme].rgb)),r.s.bgColor&&r.s.bgColor.theme&&(r.s.bgColor.rgb=Ed(i.themeElements.clrScheme[r.s.bgColor.theme].rgb,r.s.bgColor.tint||0),n.WTF&&(r.s.bgColor.raw_rgb=i.themeElements.clrScheme[r.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&s.Fills)throw o}}}function nI(r,e,t){if(r&&r["!ref"]){var n=wt(r["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+t+"): "+r["!ref"])}}function iI(r,e){var t=wt(e);t.s.r<=t.e.r&&t.s.c<=t.e.c&&t.s.r>=0&&t.s.c>=0&&(r["!ref"]=ht(t))}var sI=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,aI=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,oI=/<(?:\w:)?hyperlink [^>]*>/mg,lI=/"(\w*:\w*)"/,fI=/<(?:\w:)?col\b[^>]*[\/]?>/g,cI=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,hI=/<(?:\w:)?pageMargins[^>]*\/>/g,ET=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,uI=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,dI=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function pI(r,e,t,n,i,s,a){if(!r)return r;n||(n={"!id":{}});var o=e.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},f="",c="",h=r.match(aI);h?(f=r.slice(0,h.index),c=r.slice(h.index+h[0].length)):f=c=r;var u=f.match(ET);u?qO(u[0],o,i,t):(u=f.match(uI))&&gI(u[0],u[1]||"",o,i,t);var d=(f.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(d>0){var p=f.slice(d,d+50).match(lI);p&&iI(o,p[1])}var m=f.match(dI);m&&m[1]&&EI(m[1],i);var g=[];if(e.cellStyles){var v=f.match(fI);v&&kI(g,v)}h&&QI(h[1],o,e,l,s,a);var w=c.match(cI);w&&(o["!autofilter"]=TI(w[0]));var x=[],S=c.match(sI);if(S)for(d=0;d!=S.length;++d)x[d]=wt(S[d].slice(S[d].indexOf('"')+1));var y=c.match(oI);y&&wI(o,y,n);var b=c.match(hI);if(b&&(o["!margins"]=bI(at(b[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=ht(l)),e.sheetRows>0&&o["!ref"]){var O=wt(o["!ref"]);e.sheetRows<=+O.e.r&&(O.e.r=e.sheetRows-1,O.e.r>l.e.r&&(O.e.r=l.e.r),O.e.r<O.s.r&&(O.s.r=O.e.r),O.e.c>l.e.c&&(O.e.c=l.e.c),O.e.c<O.s.c&&(O.s.c=O.e.c),o["!fullref"]=o["!ref"],o["!ref"]=ht(O))}return g.length>0&&(o["!cols"]=g),x.length>0&&(o["!merges"]=x),o}function mI(r){if(r.length===0)return"";for(var e='<mergeCells count="'+r.length+'">',t=0;t!=r.length;++t)e+='<mergeCell ref="'+ht(r[t])+'"/>';return e+"</mergeCells>"}function qO(r,e,t,n){var i=at(r);t.Sheets[n]||(t.Sheets[n]={}),i.codeName&&(t.Sheets[n].CodeName=Pt(qt(i.codeName)))}function gI(r,e,t,n,i){qO(r.slice(0,r.indexOf(">")),t,n,i)}function OI(r,e,t,n,i){var s=!1,a={},o=null;if(n.bookType!=="xlsx"&&e.vbaraw){var l=e.SheetNames[t];try{e.Workbook&&(l=e.Workbook.Sheets[t].CodeName||l)}catch{}s=!0,a.codeName=gs(Ut(l))}if(r&&r["!outline"]){var f={summaryBelow:1,summaryRight:1};r["!outline"].above&&(f.summaryBelow=0),r["!outline"].left&&(f.summaryRight=0),o=(o||"")+Fe("outlinePr",null,f)}!s&&!o||(i[i.length]=Fe("sheetPr",o,a))}var xI=["objects","scenarios","selectLockedCells","selectUnlockedCells"],vI=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function yI(r){var e={sheet:1};return xI.forEach(function(t){r[t]!=null&&r[t]&&(e[t]="1")}),vI.forEach(function(t){r[t]!=null&&!r[t]&&(e[t]="0")}),r.password&&(e.password=LO(r.password).toString(16).toUpperCase()),Fe("sheetProtection",null,e)}function wI(r,e,t){for(var n=Array.isArray(r),i=0;i!=e.length;++i){var s=at(qt(e[i]),!0);if(!s.ref)return;var a=((t||{})["!id"]||[])[s.id];a?(s.Target=a.Target,s.location&&(s.Target+="#"+Pt(s.location))):(s.Target="#"+Pt(s.location),a={Target:s.Target,TargetMode:"Internal"}),s.Rel=a,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=wt(s.ref),l=o.s.r;l<=o.e.r;++l)for(var f=o.s.c;f<=o.e.c;++f){var c=it({c:f,r:l});n?(r[l]||(r[l]=[]),r[l][f]||(r[l][f]={t:"z",v:void 0}),r[l][f].l=s):(r[c]||(r[c]={t:"z",v:void 0}),r[c].l=s)}}}function bI(r){var e={};return["left","right","top","bottom","header","footer"].forEach(function(t){r[t]&&(e[t]=parseFloat(r[t]))}),e}function _I(r){return wo(r),Fe("pageMargins",null,r)}function kI(r,e){for(var t=!1,n=0;n!=e.length;++n){var i=at(e[n],!0);i.hidden&&(i.hidden=fr(i.hidden));var s=parseInt(i.min,10)-1,a=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!t&&i.width&&(t=!0,BO(i.width)),$a(i);s<=a;)r[s++]=Kt(i)}}function SI(r,e){for(var t=["<cols>"],n,i=0;i!=e.length;++i)(n=e[i])&&(t[t.length]=Fe("col",null,Q0(i,n)));return t[t.length]="</cols>",t.join("")}function TI(r){var e={ref:(r.match(/ref="([^"]*)"/)||[])[1]};return e}function CI(r,e,t,n){var i=typeof r.ref=="string"?r.ref:ht(r.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var s=t.Workbook.Names,a=Dn(i);a.s.r==a.e.r&&(a.e.r=Dn(e["!ref"]).e.r,i=ht(a));for(var o=0;o<s.length;++o){var l=s[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+t.SheetNames[n]+"'!"+i;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+t.SheetNames[n]+"'!"+i}),Fe("autoFilter",null,{ref:i})}var AI=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function EI(r,e){e.Views||(e.Views=[{}]),(r.match(AI)||[]).forEach(function(t,n){var i=at(t);e.Views[n]||(e.Views[n]={}),+i.zoomScale&&(e.Views[n].zoom=+i.zoomScale),fr(i.rightToLeft)&&(e.Views[n].RTL=!0)})}function PI(r,e,t,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Fe("sheetViews",Fe("sheetView",null,i),{})}function RI(r,e,t,n){if(r.c&&t["!comments"].push([e,r.c]),r.v===void 0&&typeof r.f!="string"||r.t==="z"&&!r.f)return"";var i="",s=r.t,a=r.v;if(r.t!=="z")switch(r.t){case"b":i=r.v?"1":"0";break;case"n":i=""+r.v;break;case"e":i=na[r.v];break;case"d":n&&n.cellDates?i=hr(r.v,-1).toISOString():(r=Kt(r),r.t="n",i=""+(r.v=Vr(hr(r.v)))),typeof r.z>"u"&&(r.z=et[14]);break;default:i=r.v;break}var o=cn("v",Ut(i)),l={r:e},f=ja(n.cellXfs,r,n);switch(f!==0&&(l.s=f),r.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(r.v==null){delete r.t;break}if(r.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=cn("v",""+VO(n.Strings,r.v,n.revStrings)),l.t="s";break}l.t="str";break}if(r.t!=s&&(r.t=s,r.v=a),typeof r.f=="string"&&r.f){var c=r.F&&r.F.slice(0,e.length)==e?{t:"array",ref:r.F}:null;o=Fe("f",Ut(r.f),c)+(r.v!=null?o:"")}return r.l&&t["!links"].push([e,r.l]),r.D&&(l.cm=1),Fe("c",o,l)}var QI=function(){var r=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,t=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,s=Tc("v"),a=Tc("f");return function(l,f,c,h,u,d){for(var p=0,m="",g=[],v=[],w=0,x=0,S=0,y="",b,O,T=0,k=0,Q,A,_=0,N=0,U=Array.isArray(d.CellXf),z,K=[],re=[],ge=Array.isArray(f),V=[],he={},ae=!1,E=!!c.sheetStubs,L=l.split(e),I=0,Z=L.length;I!=Z;++I){m=L[I].trim();var ee=m.length;if(ee!==0){var ne=0;e:for(p=0;p<ee;++p)switch(m[p]){case">":if(m[p-1]!="/"){++p;break e}if(c&&c.cellStyles){if(O=at(m.slice(ne,p),!0),T=O.r!=null?parseInt(O.r,10):T+1,k=-1,c.sheetRows&&c.sheetRows<T)continue;he={},ae=!1,O.ht&&(ae=!0,he.hpt=parseFloat(O.ht),he.hpx=Il(he.hpt)),O.hidden=="1"&&(ae=!0,he.hidden=!0),O.outlineLevel!=null&&(ae=!0,he.level=+O.outlineLevel),ae&&(V[T-1]=he)}break;case"<":ne=p;break}if(ne>=p)break;if(O=at(m.slice(ne,p),!0),T=O.r!=null?parseInt(O.r,10):T+1,k=-1,!(c.sheetRows&&c.sheetRows<T)){h.s.r>T-1&&(h.s.r=T-1),h.e.r<T-1&&(h.e.r=T-1),c&&c.cellStyles&&(he={},ae=!1,O.ht&&(ae=!0,he.hpt=parseFloat(O.ht),he.hpx=Il(he.hpt)),O.hidden=="1"&&(ae=!0,he.hidden=!0),O.outlineLevel!=null&&(ae=!0,he.level=+O.outlineLevel),ae&&(V[T-1]=he)),g=m.slice(p).split(r);for(var de=0;de!=g.length&&g[de].trim().charAt(0)=="<";++de);for(g=g.slice(de),p=0;p!=g.length;++p)if(m=g[p].trim(),m.length!==0){if(v=m.match(t),w=p,x=0,S=0,m="<c "+(m.slice(0,1)=="<"?">":"")+m,v!=null&&v.length===2){for(w=0,y=v[1],x=0;x!=y.length&&!((S=y.charCodeAt(x)-64)<1||S>26);++x)w=26*w+S;--w,k=w}else++k;for(x=0;x!=m.length&&m.charCodeAt(x)!==62;++x);if(++x,O=at(m.slice(0,x),!0),O.r||(O.r=it({r:T-1,c:k})),y=m.slice(x),b={t:""},(v=y.match(s))!=null&&v[1]!==""&&(b.v=Pt(v[1])),c.cellFormula){if((v=y.match(a))!=null&&v[1]!==""){if(b.f=Pt(qt(v[1])).replace(/\r\n/g,`
`),c.xlfn||(b.f=Iy(b.f)),v[0].indexOf('t="array"')>-1)b.F=(y.match(i)||[])[1],b.F.indexOf(":")>-1&&K.push([wt(b.F),b.F]);else if(v[0].indexOf('t="shared"')>-1){A=at(v[0]);var fe=Pt(qt(v[1]));c.xlfn||(fe=Iy(fe)),re[parseInt(A.si,10)]=[A,fe,O.r]}}else(v=y.match(/<f[^>]*\/>/))&&(A=at(v[0]),re[A.si]&&(b.f=A6(re[A.si][1],re[A.si][2],O.r)));var pe=wr(O.r);for(x=0;x<K.length;++x)pe.r>=K[x][0].s.r&&pe.r<=K[x][0].e.r&&pe.c>=K[x][0].s.c&&pe.c<=K[x][0].e.c&&(b.F=K[x][1])}if(O.t==null&&b.v===void 0)if(b.f||b.F)b.v=0,b.t="n";else if(E)b.t="z";else continue;else b.t=O.t||"n";switch(h.s.c>k&&(h.s.c=k),h.e.c<k&&(h.e.c=k),b.t){case"n":if(b.v==""||b.v==null){if(!E)continue;b.t="z"}else b.v=parseFloat(b.v);break;case"s":if(typeof b.v>"u"){if(!E)continue;b.t="z"}else Q=dc[parseInt(b.v,10)],b.v=Q.t,b.r=Q.r,c.cellHTML&&(b.h=Q.h);break;case"str":b.t="s",b.v=b.v!=null?qt(b.v):"",c.cellHTML&&(b.h=yO(b.v));break;case"inlineStr":v=y.match(n),b.t="s",v!=null&&(Q=IO(v[1]))?(b.v=Q.t,c.cellHTML&&(b.h=Q.h)):b.v="";break;case"b":b.v=fr(b.v);break;case"d":c.cellDates?b.v=hr(b.v,1):(b.v=Vr(hr(b.v,1)),b.t="n");break;case"e":(!c||c.cellText!==!1)&&(b.w=b.v),b.v=RS[b.v];break}if(_=N=0,z=null,U&&O.s!==void 0&&(z=d.CellXf[O.s],z!=null&&(z.numFmtId!=null&&(_=z.numFmtId),c.cellStyles&&z.fillId!=null&&(N=z.fillId))),AT(b,_,N,c,u,d),c.cellDates&&U&&b.t=="n"&&Bo(et[_])&&(b.t="d",b.v=C0(b.v)),O.cm&&c.xlmeta){var Me=(c.xlmeta.Cell||[])[+O.cm-1];Me&&Me.type=="XLDAPR"&&(b.D=!0)}if(ge){var q=wr(O.r);f[q.r]||(f[q.r]=[]),f[q.r][q.c]=b}else f[O.r]=b}}}}V.length>0&&(f["!rows"]=V)}}();function FI(r,e,t,n){var i=[],s=[],a=wt(r["!ref"]),o="",l,f="",c=[],h=0,u=0,d=r["!rows"],p=Array.isArray(r),m={r:f},g,v=-1;for(u=a.s.c;u<=a.e.c;++u)c[u]=cr(u);for(h=a.s.r;h<=a.e.r;++h){for(s=[],f=kr(h),u=a.s.c;u<=a.e.c;++u){l=c[u]+f;var w=p?(r[h]||[])[u]:r[l];w!==void 0&&(o=RI(w,l,r,e))!=null&&s.push(o)}(s.length>0||d&&d[h])&&(m={r:f},d&&d[h]&&(g=d[h],g.hidden&&(m.hidden=1),v=-1,g.hpx?v=Fc(g.hpx):g.hpt&&(v=g.hpt),v>-1&&(m.ht=v,m.customHeight=1),g.level&&(m.outlineLevel=g.level)),i[i.length]=Fe("row",s.join(""),m))}if(d)for(;h<d.length;++h)d&&d[h]&&(m={r:h+1},g=d[h],g.hidden&&(m.hidden=1),v=-1,g.hpx?v=Fc(g.hpx):g.hpt&&(v=g.hpt),v>-1&&(m.ht=v,m.customHeight=1),g.level&&(m.outlineLevel=g.level),i[i.length]=Fe("row","",m));return i.join("")}function PT(r,e,t,n){var i=[Rr,Fe("worksheet",null,{xmlns:Zo[0],"xmlns:r":Xr.r})],s=t.SheetNames[r],a=0,o="",l=t.Sheets[s];l==null&&(l={});var f=l["!ref"]||"A1",c=wt(f);if(c.e.c>16383||c.e.r>1048575){if(e.WTF)throw new Error("Range "+f+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575),f=ht(c)}n||(n={}),l["!comments"]=[];var h=[];OI(l,t,r,e,i),i[i.length]=Fe("dimension",null,{ref:f}),i[i.length]=PI(l,e,r,t),e.sheetFormat&&(i[i.length]=Fe("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(i[i.length]=SI(l,l["!cols"])),i[a=i.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=FI(l,e),o.length>0&&(i[i.length]=o)),i.length>a+1&&(i[i.length]="</sheetData>",i[a]=i[a].replace("/>",">")),l["!protect"]&&(i[i.length]=yI(l["!protect"])),l["!autofilter"]!=null&&(i[i.length]=CI(l["!autofilter"],l,t,r)),l["!merges"]!=null&&l["!merges"].length>0&&(i[i.length]=mI(l["!merges"]));var u=-1,d,p=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(m){m[1].Target&&(d={ref:m[0]},m[1].Target.charAt(0)!="#"&&(p=Wt(n,-1,Ut(m[1].Target).replace(/#.*$/,""),yt.HLINK),d["r:id"]="rId"+p),(u=m[1].Target.indexOf("#"))>-1&&(d.location=Ut(m[1].Target.slice(u+1))),m[1].Tooltip&&(d.tooltip=Ut(m[1].Tooltip)),i[i.length]=Fe("hyperlink",null,d))}),i[i.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(i[i.length]=_I(l["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(i[i.length]=cn("ignoredErrors",Fe("ignoredError",null,{numberStoredAsText:1,sqref:f}))),h.length>0&&(p=Wt(n,-1,"../drawings/drawing"+(r+1)+".xml",yt.DRAW),i[i.length]=Fe("drawing",null,{"r:id":"rId"+p}),l["!drawing"]=h),l["!comments"].length>0&&(p=Wt(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",yt.VML),i[i.length]=Fe("legacyDrawing",null,{"r:id":"rId"+p}),l["!legacy"]=p),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function $I(r,e){var t={},n=r.l+e;t.r=r.read_shift(4),r.l+=4;var i=r.read_shift(2);r.l+=1;var s=r.read_shift(1);return r.l=n,s&7&&(t.level=s&7),s&16&&(t.hidden=!0),s&32&&(t.hpt=i/20),t}function NI(r,e,t){var n=Oe(145),i=(t["!rows"]||[])[r]||{};n.write_shift(4,r),n.write_shift(4,0);var s=320;i.hpx?s=Fc(i.hpx)*20:i.hpt&&(s=i.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var a=0;i.level&&(a|=i.level),i.hidden&&(a|=16),(i.hpx||i.hpt)&&(a|=32),n.write_shift(1,a),n.write_shift(1,0);var o=0,l=n.l;n.l+=4;for(var f={r,c:0},c=0;c<16;++c)if(!(e.s.c>c+1<<10||e.e.c<c<<10)){for(var h=-1,u=-1,d=c<<10;d<c+1<<10;++d){f.c=d;var p=Array.isArray(t)?(t[f.r]||[])[f.c]:t[it(f)];p&&(h<0&&(h=d),u=d)}h<0||(++o,n.write_shift(4,h),n.write_shift(4,u))}var m=n.l;return n.l=l,n.write_shift(4,o),n.l=m,n.length>n.l?n.slice(0,n.l):n}function DI(r,e,t,n){var i=NI(n,t,e);(i.length>17||(e["!rows"]||[])[n])&&we(r,0,i)}var MI=Vo,II=uf;function LI(){}function BI(r,e){var t={},n=r[r.l];return++r.l,t.above=!(n&64),t.left=!(n&128),r.l+=18,t.name=UF(r),t}function ZI(r,e,t){t==null&&(t=Oe(84+4*r.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),t.write_shift(1,n);for(var i=1;i<3;++i)t.write_shift(1,0);return Td({auto:1},t),t.write_shift(-4,-1),t.write_shift(-4,-1),TS(r,t),t.slice(0,t.l)}function WI(r){var e=Qi(r);return[e]}function UI(r,e,t){return t==null&&(t=Oe(8)),Wo(e,t)}function XI(r){var e=Uo(r);return[e]}function VI(r,e,t){return t==null&&(t=Oe(4)),Xo(e,t)}function qI(r){var e=Qi(r),t=r.read_shift(1);return[e,t,"b"]}function jI(r,e,t){return t==null&&(t=Oe(9)),Wo(e,t),t.write_shift(1,r.v?1:0),t}function zI(r){var e=Uo(r),t=r.read_shift(1);return[e,t,"b"]}function GI(r,e,t){return t==null&&(t=Oe(5)),Xo(e,t),t.write_shift(1,r.v?1:0),t}function HI(r){var e=Qi(r),t=r.read_shift(1);return[e,t,"e"]}function YI(r,e,t){return t==null&&(t=Oe(9)),Wo(e,t),t.write_shift(1,r.v),t}function KI(r){var e=Uo(r),t=r.read_shift(1);return[e,t,"e"]}function JI(r,e,t){return t==null&&(t=Oe(8)),Xo(e,t),t.write_shift(1,r.v),t.write_shift(2,0),t.write_shift(1,0),t}function eL(r){var e=Qi(r),t=r.read_shift(4);return[e,t,"s"]}function tL(r,e,t){return t==null&&(t=Oe(12)),Wo(e,t),t.write_shift(4,e.v),t}function rL(r){var e=Uo(r),t=r.read_shift(4);return[e,t,"s"]}function nL(r,e,t){return t==null&&(t=Oe(8)),Xo(e,t),t.write_shift(4,e.v),t}function iL(r){var e=Qi(r),t=yn(r);return[e,t,"n"]}function sL(r,e,t){return t==null&&(t=Oe(16)),Wo(e,t),Eo(r.v,t),t}function RT(r){var e=Uo(r),t=yn(r);return[e,t,"n"]}function aL(r,e,t){return t==null&&(t=Oe(12)),Xo(e,t),Eo(r.v,t),t}function oL(r){var e=Qi(r),t=FO(r);return[e,t,"n"]}function lL(r,e,t){return t==null&&(t=Oe(12)),Wo(e,t),CS(r.v,t),t}function fL(r){var e=Uo(r),t=FO(r);return[e,t,"n"]}function cL(r,e,t){return t==null&&(t=Oe(8)),Xo(e,t),CS(r.v,t),t}function hL(r){var e=Qi(r),t=PO(r);return[e,t,"is"]}function uL(r){var e=Qi(r),t=kn(r);return[e,t,"str"]}function dL(r,e,t){return t==null&&(t=Oe(12+4*r.v.length)),Wo(e,t),Kr(r.v,t),t.length>t.l?t.slice(0,t.l):t}function pL(r){var e=Uo(r),t=kn(r);return[e,t,"str"]}function mL(r,e,t){return t==null&&(t=Oe(8+4*r.v.length)),Xo(e,t),Kr(r.v,t),t.length>t.l?t.slice(0,t.l):t}function gL(r,e,t){var n=r.l+e,i=Qi(r);i.r=t["!row"];var s=r.read_shift(1),a=[i,s,"b"];if(t.cellFormula){r.l+=2;var o=R0(r,n-r.l,t);a[3]=gn(o,null,i,t.supbooks,t)}else r.l=n;return a}function OL(r,e,t){var n=r.l+e,i=Qi(r);i.r=t["!row"];var s=r.read_shift(1),a=[i,s,"e"];if(t.cellFormula){r.l+=2;var o=R0(r,n-r.l,t);a[3]=gn(o,null,i,t.supbooks,t)}else r.l=n;return a}function xL(r,e,t){var n=r.l+e,i=Qi(r);i.r=t["!row"];var s=yn(r),a=[i,s,"n"];if(t.cellFormula){r.l+=2;var o=R0(r,n-r.l,t);a[3]=gn(o,null,i,t.supbooks,t)}else r.l=n;return a}function vL(r,e,t){var n=r.l+e,i=Qi(r);i.r=t["!row"];var s=kn(r),a=[i,s,"str"];if(t.cellFormula){r.l+=2;var o=R0(r,n-r.l,t);a[3]=gn(o,null,i,t.supbooks,t)}else r.l=n;return a}var yL=Vo,wL=uf;function bL(r,e){return e==null&&(e=Oe(4)),e.write_shift(4,r),e}function _L(r,e){var t=r.l+e,n=Vo(r),i=RO(r),s=kn(r),a=kn(r),o=kn(r);r.l=t;var l={rfx:n,relId:i,loc:s,display:o};return a&&(l.Tooltip=a),l}function kL(r,e){var t=Oe(50+4*(r[1].Target.length+(r[1].Tooltip||"").length));uf({s:wr(r[0]),e:wr(r[0])},t),QO("rId"+e,t);var n=r[1].Target.indexOf("#"),i=n==-1?"":r[1].Target.slice(n+1);return Kr(i||"",t),Kr(r[1].Tooltip||"",t),Kr("",t),t.slice(0,t.l)}function SL(){}function TL(r,e,t){var n=r.l+e,i=AS(r),s=r.read_shift(1),a=[i];if(a[2]=s,t.cellFormula){var o=H8(r,n-r.l,t);a[1]=o}else r.l=n;return a}function CL(r,e,t){var n=r.l+e,i=Vo(r),s=[i];if(t.cellFormula){var a=K8(r,n-r.l,t);s[1]=a,r.l=n}else r.l=n;return s}function AL(r,e,t){t==null&&(t=Oe(18));var n=Q0(r,e);t.write_shift(-4,r),t.write_shift(-4,r),t.write_shift(4,(n.width||10)*256),t.write_shift(4,0);var i=0;return e.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),e.level&&(i|=e.level<<8),t.write_shift(2,i),t}var QT=["left","right","top","bottom","header","footer"];function EL(r){var e={};return QT.forEach(function(t){e[t]=yn(r)}),e}function PL(r,e){return e==null&&(e=Oe(6*8)),wo(r),QT.forEach(function(t){Eo(r[t],e)}),e}function RL(r){var e=r.read_shift(2);return r.l+=28,{RTL:e&32}}function QL(r,e,t){t==null&&(t=Oe(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),t.write_shift(2,n),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,100),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(4,0),t}function FL(r){var e=Oe(24);return e.write_shift(4,4),e.write_shift(4,1),uf(r,e),e}function $L(r,e){return e==null&&(e=Oe(16*4+2)),e.write_shift(2,r.password?LO(r.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(t){t[1]?e.write_shift(4,r[t[0]]!=null&&!r[t[0]]?1:0):e.write_shift(4,r[t[0]]!=null&&r[t[0]]?0:1)}),e}function NL(){}function DL(){}function ML(r,e,t,n,i,s,a){if(!r)return r;var o=e||{};n||(n={"!id":{}});var l=o.dense?[]:{},f,c={s:{r:2e6,c:2e6},e:{r:0,c:0}},h=!1,u=!1,d,p,m,g,v,w,x,S,y,b=[];o.biff=12,o["!row"]=0;var O=0,T=!1,k=[],Q={},A=o.supbooks||i.supbooks||[[]];if(A.sharedf=Q,A.arrayf=k,A.SheetNames=i.SheetNames||i.Sheets.map(function(ge){return ge.name}),!o.supbooks&&(o.supbooks=A,i.Names))for(var _=0;_<i.Names.length;++_)A[0][_+1]=i.Names[_];var N=[],U=[],z=!1;$c[16]={n:"BrtShortReal",f:RT};var K;if(ra(r,function(V,he,ae){if(!u)switch(ae){case 148:f=V;break;case 0:d=V,o.sheetRows&&o.sheetRows<=d.r&&(u=!0),S=kr(g=d.r),o["!row"]=d.r,(V.hidden||V.hpt||V.level!=null)&&(V.hpt&&(V.hpx=Il(V.hpt)),U[V.r]=V);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(p={t:V[2]},V[2]){case"n":p.v=V[1];break;case"s":x=dc[V[1]],p.v=x.t,p.r=x.r;break;case"b":p.v=!!V[1];break;case"e":p.v=V[1],o.cellText!==!1&&(p.w=na[p.v]);break;case"str":p.t="s",p.v=V[1];break;case"is":p.t="s",p.v=V[1].t;break}if((m=a.CellXf[V[0].iStyleRef])&&AT(p,m.numFmtId,null,o,s,a),v=V[0].c==-1?v+1:V[0].c,o.dense?(l[g]||(l[g]=[]),l[g][v]=p):l[cr(v)+S]=p,o.cellFormula){for(T=!1,O=0;O<k.length;++O){var E=k[O];d.r>=E[0].s.r&&d.r<=E[0].e.r&&v>=E[0].s.c&&v<=E[0].e.c&&(p.F=ht(E[0]),T=!0)}!T&&V.length>3&&(p.f=V[3])}if(c.s.r>d.r&&(c.s.r=d.r),c.s.c>v&&(c.s.c=v),c.e.r<d.r&&(c.e.r=d.r),c.e.c<v&&(c.e.c=v),o.cellDates&&m&&p.t=="n"&&Bo(et[m.numFmtId])){var L=_a(p.v);L&&(p.t="d",p.v=new Date(L.y,L.m-1,L.d,L.H,L.M,L.S,L.u))}K&&(K.type=="XLDAPR"&&(p.D=!0),K=void 0);break;case 1:case 12:if(!o.sheetStubs||h)break;p={t:"z",v:void 0},v=V[0].c==-1?v+1:V[0].c,o.dense?(l[g]||(l[g]=[]),l[g][v]=p):l[cr(v)+S]=p,c.s.r>d.r&&(c.s.r=d.r),c.s.c>v&&(c.s.c=v),c.e.r<d.r&&(c.e.r=d.r),c.e.c<v&&(c.e.c=v),K&&(K.type=="XLDAPR"&&(p.D=!0),K=void 0);break;case 176:b.push(V);break;case 49:K=((o.xlmeta||{}).Cell||[])[V-1];break;case 494:var I=n["!id"][V.relId];for(I?(V.Target=I.Target,V.loc&&(V.Target+="#"+V.loc),V.Rel=I):V.relId==""&&(V.Target="#"+V.loc),g=V.rfx.s.r;g<=V.rfx.e.r;++g)for(v=V.rfx.s.c;v<=V.rfx.e.c;++v)o.dense?(l[g]||(l[g]=[]),l[g][v]||(l[g][v]={t:"z",v:void 0}),l[g][v].l=V):(w=it({c:v,r:g}),l[w]||(l[w]={t:"z",v:void 0}),l[w].l=V);break;case 426:if(!o.cellFormula)break;k.push(V),y=o.dense?l[g][v]:l[cr(v)+S],y.f=gn(V[1],c,{r:d.r,c:v},A,o),y.F=ht(V[0]);break;case 427:if(!o.cellFormula)break;Q[it(V[0].s)]=V[1],y=o.dense?l[g][v]:l[cr(v)+S],y.f=gn(V[1],c,{r:d.r,c:v},A,o);break;case 60:if(!o.cellStyles)break;for(;V.e>=V.s;)N[V.e--]={width:V.w/256,hidden:!!(V.flags&1),level:V.level},z||(z=!0,BO(V.w/256)),$a(N[V.e+1]);break;case 161:l["!autofilter"]={ref:ht(V)};break;case 476:l["!margins"]=V;break;case 147:i.Sheets[t]||(i.Sheets[t]={}),V.name&&(i.Sheets[t].CodeName=V.name),(V.above||V.left)&&(l["!outline"]={above:V.above,left:V.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),V.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:h=!0;break;case 36:h=!1;break;case 37:h=!0;break;case 38:h=!1;break;default:if(!he.T){if(!h||o.WTF)throw new Error("Unexpected record 0x"+ae.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(c.s.r<2e6||f&&(f.e.r>0||f.e.c>0||f.s.r>0||f.s.c>0))&&(l["!ref"]=ht(f||c)),o.sheetRows&&l["!ref"]){var re=wt(l["!ref"]);o.sheetRows<=+re.e.r&&(re.e.r=o.sheetRows-1,re.e.r>c.e.r&&(re.e.r=c.e.r),re.e.r<re.s.r&&(re.s.r=re.e.r),re.e.c>c.e.c&&(re.e.c=c.e.c),re.e.c<re.s.c&&(re.s.c=re.e.c),l["!fullref"]=l["!ref"],l["!ref"]=ht(re))}return b.length>0&&(l["!merges"]=b),N.length>0&&(l["!cols"]=N),U.length>0&&(l["!rows"]=U),l}function IL(r,e,t,n,i,s,a){if(e.v===void 0)return!1;var o="";switch(e.t){case"b":o=e.v?"1":"0";break;case"d":e=Kt(e),e.z=e.z||et[14],e.v=Vr(hr(e.v)),e.t="n";break;case"n":case"e":o=""+e.v;break;default:o=e.v;break}var l={r:t,c:n};switch(l.s=ja(i.cellXfs,e,i),e.l&&s["!links"].push([it(l),e.l]),e.c&&s["!comments"].push([it(l),e.c]),e.t){case"s":case"str":return i.bookSST?(o=VO(i.Strings,e.v,i.revStrings),l.t="s",l.v=o,a?we(r,18,nL(e,l)):we(r,7,tL(e,l))):(l.t="str",a?we(r,17,mL(e,l)):we(r,6,dL(e,l))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?a?we(r,13,cL(e,l)):we(r,2,lL(e,l)):a?we(r,16,aL(e,l)):we(r,5,sL(e,l)),!0;case"b":return l.t="b",a?we(r,15,GI(e,l)):we(r,4,jI(e,l)),!0;case"e":return l.t="e",a?we(r,14,JI(e,l)):we(r,3,YI(e,l)),!0}return a?we(r,12,VI(e,l)):we(r,1,UI(e,l)),!0}function LL(r,e,t,n){var i=wt(e["!ref"]||"A1"),s,a="",o=[];we(r,145);var l=Array.isArray(e),f=i.e.r;e["!rows"]&&(f=Math.max(i.e.r,e["!rows"].length-1));for(var c=i.s.r;c<=f;++c){a=kr(c),DI(r,e,i,c);var h=!1;if(c<=i.e.r)for(var u=i.s.c;u<=i.e.c;++u){c===i.s.r&&(o[u]=cr(u)),s=o[u]+a;var d=l?(e[c]||[])[u]:e[s];if(!d){h=!1;continue}h=IL(r,d,c,u,n,e,h)}}we(r,146)}function BL(r,e){!e||!e["!merges"]||(we(r,177,bL(e["!merges"].length)),e["!merges"].forEach(function(t){we(r,176,wL(t))}),we(r,178))}function ZL(r,e){!e||!e["!cols"]||(we(r,390),e["!cols"].forEach(function(t,n){t&&we(r,60,AL(n,t))}),we(r,391))}function WL(r,e){!e||!e["!ref"]||(we(r,648),we(r,649,FL(wt(e["!ref"]))),we(r,650))}function UL(r,e,t){e["!links"].forEach(function(n){if(n[1].Target){var i=Wt(t,-1,n[1].Target.replace(/#.*$/,""),yt.HLINK);we(r,494,kL(n,i))}}),delete e["!links"]}function XL(r,e,t,n){if(e["!comments"].length>0){var i=Wt(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",yt.VML);we(r,551,QO("rId"+i)),e["!legacy"]=i}}function VL(r,e,t,n){if(e["!autofilter"]){var i=e["!autofilter"],s=typeof i.ref=="string"?i.ref:ht(i.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var a=t.Workbook.Names,o=Dn(s);o.s.r==o.e.r&&(o.e.r=Dn(e["!ref"]).e.r,s=ht(o));for(var l=0;l<a.length;++l){var f=a[l];if(f.Name=="_xlnm._FilterDatabase"&&f.Sheet==n){f.Ref="'"+t.SheetNames[n]+"'!"+s;break}}l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+t.SheetNames[n]+"'!"+s}),we(r,161,uf(wt(s))),we(r,162)}}function qL(r,e,t){we(r,133),we(r,137,QL(e,t)),we(r,138),we(r,134)}function jL(r,e){e["!protect"]&&we(r,535,$L(e["!protect"]))}function zL(r,e,t,n){var i=zn(),s=t.SheetNames[r],a=t.Sheets[s]||{},o=s;try{t&&t.Workbook&&(o=t.Workbook.Sheets[r].CodeName||o)}catch{}var l=wt(a["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(e.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],we(i,129),(t.vbaraw||a["!outline"])&&we(i,147,ZI(o,a["!outline"])),we(i,148,II(l)),qL(i,a,t.Workbook),ZL(i,a),LL(i,a,r,e),jL(i,a),VL(i,a,t,r),BL(i,a),UL(i,a,n),a["!margins"]&&we(i,476,PL(a["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&WL(i,a),XL(i,a,r,n),we(i,130),i.end()}function GL(r){var e=[],t=r.match(/^<c:numCache>/),n;(r.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var a=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);a&&(e[+a[1]]=t?+a[2]:a[2])});var i=Pt((r.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(r.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[e,i,n]}function HL(r,e,t,n,i,s){var a=s||{"!type":"chart"};if(!r)return s;var o=0,l=0,f="A",c={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(r.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(h){var u=GL(h);c.s.r=c.s.c=0,c.e.c=o,f=cr(o),u[0].forEach(function(d,p){a[f+kr(p)]={t:"n",v:d,z:u[1]},l=p}),c.e.r<l&&(c.e.r=l),++o}),o>0&&(a["!ref"]=ht(c)),a}function YL(r,e,t,n,i){if(!r)return r;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a,o=r.match(ET);return o&&qO(o[0],s,i,t),(a=r.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=a[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function KL(r,e){r.l+=10;var t=kn(r);return{name:t}}function JL(r,e,t,n,i){if(!r)return r;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a=!1;return ra(r,function(l,f,c){switch(c){case 550:s["!rel"]=l;break;case 651:i.Sheets[t]||(i.Sheets[t]={}),l.name&&(i.Sheets[t].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!(f.T>0)){if(!(f.T<0)){if(!a||e.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}},e),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var jO=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],eB=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],tB=[],rB=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Uy(r,e){for(var t=0;t!=r.length;++t)for(var n=r[t],i=0;i!=e.length;++i){var s=e[i];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=fr(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function Xy(r,e){for(var t=0;t!=e.length;++t){var n=e[t];if(r[n[0]]==null)r[n[0]]=n[1];else switch(n[2]){case"bool":typeof r[n[0]]=="string"&&(r[n[0]]=fr(r[n[0]]));break;case"int":typeof r[n[0]]=="string"&&(r[n[0]]=parseInt(r[n[0]],10));break}}}function FT(r){Xy(r.WBProps,jO),Xy(r.CalcPr,rB),Uy(r.WBView,eB),Uy(r.Sheets,tB),Sl.date1904=fr(r.WBProps.date1904)}function nB(r){return!r.Workbook||!r.Workbook.WBProps?"false":fr(r.Workbook.WBProps.date1904)?"true":"false"}var iB="][*?/\\".split("");function $T(r,e){if(r.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return iB.forEach(function(n){if(r.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}function sB(r,e,t){r.forEach(function(n,i){$T(n);for(var s=0;s<i;++s)if(n==r[s])throw new Error("Duplicate Sheet Name: "+n);if(t){var a=e[i]&&e[i].CodeName||n;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function NT(r){if(!r||!r.SheetNames||!r.Sheets)throw new Error("Invalid Workbook");if(!r.SheetNames.length)throw new Error("Workbook is empty");var e=r.Workbook&&r.Workbook.Sheets||[];sB(r.SheetNames,e,!!r.vbaraw);for(var t=0;t<r.SheetNames.length;++t)nI(r.Sheets[r.SheetNames[t]],r.SheetNames[t],t)}var aB=/<\w+:workbook/;function oB(r,e){if(!r)throw new Error("Could not find file");var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",s={},a=0;if(r.replace(An,function(l,f){var c=at(l);switch(Ps(c[0])){case"<?xml":break;case"<workbook":l.match(aB)&&(i="xmlns"+l.match(/<(\w+):/)[1]),t.xmlns=c[i];break;case"</workbook>":break;case"<fileVersion":delete c[0],t.AppVersion=c;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":jO.forEach(function(h){if(c[h[0]]!=null)switch(h[2]){case"bool":t.WBProps[h[0]]=fr(c[h[0]]);break;case"int":t.WBProps[h[0]]=parseInt(c[h[0]],10);break;default:t.WBProps[h[0]]=c[h[0]]}}),c.codeName&&(t.WBProps.CodeName=qt(c.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete c[0],t.WBView.push(c);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(c.state){case"hidden":c.Hidden=1;break;case"veryHidden":c.Hidden=2;break;default:c.Hidden=0}delete c.state,c.name=Pt(qt(c.name)),delete c[0],t.Sheets.push(c);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=qt(c.name),c.comment&&(s.Comment=c.comment),c.localSheetId&&(s.Sheet=+c.localSheetId),fr(c.hidden||"0")&&(s.Hidden=!0),a=f+l.length;break;case"</definedName>":s.Ref=Pt(qt(r.slice(a,f))),t.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete c[0],t.CalcPr=c;break;case"<calcPr/>":delete c[0],t.CalcPr=c;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+c[0]+" in workbook")}return l}),Zo.indexOf(t.xmlns)===-1)throw new Error("Unknown Namespace: "+t.xmlns);return FT(t),t}function DT(r){var e=[Rr];e[e.length]=Fe("workbook",null,{xmlns:Zo[0],"xmlns:r":Xr.r});var t=r.Workbook&&(r.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};r.Workbook&&r.Workbook.WBProps&&(jO.forEach(function(o){r.Workbook.WBProps[o[0]]!=null&&r.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=r.Workbook.WBProps[o[0]])}),r.Workbook.WBProps.CodeName&&(n.codeName=r.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=Fe("workbookPr",null,n);var i=r.Workbook&&r.Workbook.Sheets||[],s=0;if(i[0]&&i[0].Hidden){for(e[e.length]="<bookViews>",s=0;s!=r.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==r.SheetNames.length&&(s=0),e[e.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",s=0;s!=r.SheetNames.length;++s){var a={name:Ut(r.SheetNames[s].slice(0,31))};if(a.sheetId=""+(s+1),a["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}e[e.length]=Fe("sheet",null,a)}return e[e.length]="</sheets>",t&&(e[e.length]="<definedNames>",r.Workbook&&r.Workbook.Names&&r.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(e[e.length]=Fe("definedName",Ut(o.Ref),l))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function lB(r,e){var t={};return t.Hidden=r.read_shift(4),t.iTabID=r.read_shift(4),t.strRelID=Xm(r),t.name=kn(r),t}function fB(r,e){return e||(e=Oe(127)),e.write_shift(4,r.Hidden),e.write_shift(4,r.iTabID),QO(r.strRelID,e),Kr(r.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function cB(r,e){var t={},n=r.read_shift(4);t.defaultThemeVersion=r.read_shift(4);var i=e>8?kn(r):"";return i.length>0&&(t.CodeName=i),t.autoCompressPictures=!!(n&65536),t.backupFile=!!(n&64),t.checkCompatibility=!!(n&4096),t.date1904=!!(n&1),t.filterPrivacy=!!(n&8),t.hidePivotFieldList=!!(n&1024),t.promptedSolutions=!!(n&16),t.publishItems=!!(n&2048),t.refreshAllConnections=!!(n&262144),t.saveExternalLinkValues=!!(n&128),t.showBorderUnselectedTables=!!(n&4),t.showInkAnnotation=!!(n&32),t.showObjects=["all","placeholders","none"][n>>13&3],t.showPivotChartFilter=!!(n&32768),t.updateLinks=["userSet","never","always"][n>>8&3],t}function hB(r,e){e||(e=Oe(72));var t=0;return r&&r.filterPrivacy&&(t|=8),e.write_shift(4,t),e.write_shift(4,0),TS(r&&r.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function uB(r,e){var t={};return r.read_shift(4),t.ArchID=r.read_shift(4),r.l+=e-8,t}function dB(r,e,t){var n=r.l+e;r.l+=4,r.l+=1;var i=r.read_shift(4),s=XF(r),a=Y8(r,0,t),o=RO(r);r.l=n;var l={Name:s,Ptg:a};return i<268435455&&(l.Sheet=i),o&&(l.Comment=o),l}function pB(r,e){var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;e||(e={}),e.biff=12;var s=[],a=[[]];return a.SheetNames=[],a.XTI=[],$c[16]={n:"BrtFRTArchID$",f:uB},ra(r,function(l,f,c){switch(c){case 156:a.SheetNames.push(l.name),t.Sheets.push(l);break;case 153:t.WBProps=l;break;case 39:l.Sheet!=null&&(e.SID=l.Sheet),l.Ref=gn(l.Ptg,null,null,a,e),delete e.SID,delete l.Ptg,s.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:a[0].length?a.push([c,l]):a[0]=[c,l],a[a.length-1].XTI=[];break;case 362:a.length===0&&(a[0]=[],a[0].XTI=[]),a[a.length-1].XTI=a[a.length-1].XTI.concat(l),a.XTI=a.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(c),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(c),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!f.T){if(!i||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+c.toString(16))}}},e),FT(t),t.Names=s,t.supbooks=a,t}function mB(r,e){we(r,143);for(var t=0;t!=e.SheetNames.length;++t){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[t]&&e.Workbook.Sheets[t].Hidden||0,i={Hidden:n,iTabID:t+1,strRelID:"rId"+(t+1),name:e.SheetNames[t]};we(r,156,fB(i))}we(r,144)}function gB(r,e){e||(e=Oe(127));for(var t=0;t!=4;++t)e.write_shift(4,0);return Kr("SheetJS",e),Kr(_c.version,e),Kr(_c.version,e),Kr("7262",e),e.length>e.l?e.slice(0,e.l):e}function OB(r,e){e||(e=Oe(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,r),e.write_shift(4,r);var t=120;return e.write_shift(1,t),e.length>e.l?e.slice(0,e.l):e}function xB(r,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var t=e.Workbook.Sheets,n=0,i=-1,s=-1;n<t.length;++n)!t[n]||!t[n].Hidden&&i==-1?i=n:t[n].Hidden==1&&s==-1&&(s=n);s>i||(we(r,135),we(r,158,OB(i)),we(r,136))}}function vB(r,e){var t=zn();return we(t,131),we(t,128,gB()),we(t,153,hB(r.Workbook&&r.Workbook.WBProps||null)),xB(t,r),mB(t,r),we(t,132),t.end()}function yB(r,e,t){return e.slice(-4)===".bin"?pB(r,t):oB(r,t)}function wB(r,e,t,n,i,s,a,o){return e.slice(-4)===".bin"?ML(r,n,t,i,s,a,o):pI(r,n,t,i,s,a,o)}function bB(r,e,t,n,i,s,a,o){return e.slice(-4)===".bin"?JL(r,n,t,i,s):YL(r,n,t,i,s)}function _B(r,e,t,n,i,s,a,o){return e.slice(-4)===".bin"?T6():C6()}function kB(r,e,t,n,i,s,a,o){return e.slice(-4)===".bin"?k6():S6()}function SB(r,e,t,n){return e.slice(-4)===".bin"?wM(r,t,n):fM(r,t,n)}function TB(r,e,t){return mT(r,t)}function CB(r,e,t){return e.slice(-4)===".bin"?AD(r,t):SD(r,t)}function AB(r,e,t){return e.slice(-4)===".bin"?v6(r,t):c6(r,t)}function EB(r,e,t){return e.slice(-4)===".bin"?o6(r):s6(r)}function PB(r,e,t,n){return t.slice(-4)===".bin"?l6(r,e,t,n):void 0}function RB(r,e,t){return e.slice(-4)===".bin"?r6(r,e,t):i6(r,e,t)}function QB(r,e,t){return(e.slice(-4)===".bin"?vB:DT)(r)}function FB(r,e,t,n,i){return(e.slice(-4)===".bin"?zL:PT)(r,t,n,i)}function $B(r,e,t){return(e.slice(-4)===".bin"?RM:dT)(r,t)}function NB(r,e,t){return(e.slice(-4)===".bin"?RD:sT)(r,t)}function DB(r,e,t){return(e.slice(-4)===".bin"?y6:xT)(r)}function MB(r){return(r.slice(-4)===".bin"?n6:gT)()}var MT=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,IT=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Mi(r,e){var t=r.split(/\s+/),n=[];if(n[0]=t[0],t.length===1)return n;var i=r.match(MT),s,a,o,l;if(i)for(l=0;l!=i.length;++l)s=i[l].match(IT),(a=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(a+1),n[o]=s[2].slice(1,s[2].length-1));return n}function IB(r){var e=r.split(/\s+/),t={};if(e.length===1)return t;var n=r.match(MT),i,s,a,o;if(n)for(o=0;o!=n.length;++o)i=n[o].match(IT),(s=i[1].indexOf(":"))===-1?t[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?a="xmlns"+i[1].slice(6):a=i[1].slice(s+1),t[a]=i[2].slice(1,i[2].length-1));return t}var mc;function LB(r,e){var t=mc[r]||Pt(r);return t==="General"?Co(e):hi(t,e)}function BB(r,e,t,n){var i=n;switch((t[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=fr(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=hr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+t[0])}r[Pt(e)]=i}function ZB(r,e,t){if(r.t!=="z"){if(!t||t.cellText!==!1)try{r.t==="e"?r.w=r.w||na[r.v]:e==="General"?r.t==="n"?(r.v|0)===r.v?r.w=r.v.toString(10):r.w=Sc(r.v):r.w=Co(r.v):r.w=LB(e||"General",r.v)}catch(s){if(t.WTF)throw s}try{var n=mc[e]||e||"General";if(t.cellNF&&(r.z=n),t.cellDates&&r.t=="n"&&Bo(n)){var i=_a(r.v);i&&(r.t="d",r.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(s){if(t.WTF)throw s}}}function WB(r,e,t){if(t.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=tM[n.Pattern]||n.Pattern)}r[e.ID]=e}function UB(r,e,t,n,i,s,a,o,l,f){var c="General",h=n.StyleID,u={};f=f||{};var d=[],p=0;for(h===void 0&&o&&(h=o.StyleID),h===void 0&&a&&(h=a.StyleID);s[h]!==void 0&&(s[h].nf&&(c=s[h].nf),s[h].Interior&&d.push(s[h].Interior),!!s[h].Parent);)h=s[h].Parent;switch(t.Type){case"Boolean":n.t="b",n.v=fr(r);break;case"String":n.t="s",n.r=oy(Pt(r)),n.v=r.indexOf("<")>-1?Pt(e||r).replace(/<.*?>/g,""):n.r;break;case"DateTime":r.slice(-1)!="Z"&&(r+="Z"),n.v=(hr(r)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=Pt(r):n.v<60&&(n.v=n.v-1),(!c||c=="General")&&(c="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+r),n.t||(n.t="n");break;case"Error":n.t="e",n.v=RS[r],f.cellText!==!1&&(n.w=r);break;default:r==""&&e==""?n.t="z":(n.t="s",n.v=oy(e||r));break}if(ZB(n,c,f),f.cellFormula!==!1)if(n.Formula){var m=Pt(n.Formula);m.charCodeAt(0)==61&&(m=m.slice(1)),n.f=kl(m,i),delete n.Formula,n.ArrayRange=="RC"?n.F=kl("RC:RC",i):n.ArrayRange&&(n.F=kl(n.ArrayRange,i),l.push([wt(n.F),n.F]))}else for(p=0;p<l.length;++p)i.r>=l[p][0].s.r&&i.r<=l[p][0].e.r&&i.c>=l[p][0].s.c&&i.c<=l[p][0].e.c&&(n.F=l[p][1]);f.cellStyles&&(d.forEach(function(g){!u.patternType&&g.patternType&&(u.patternType=g.patternType)}),n.s=u),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function XB(r){r.t=r.v||"",r.t=r.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),r.v=r.w=r.ixfe=void 0}function yp(r,e){var t=e||{};ff();var n=ul(wO(r));(t.type=="binary"||t.type=="array"||t.type=="base64")&&(typeof St<"u"?n=St.utils.decode(65001,vd(n)):n=qt(n));var i=n.slice(0,1024).toLowerCase(),s=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var a=Kt(t);return a.type="string",Ml.to_workbook(n,a)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(ct){i.indexOf("<"+ct)>=0&&(s=!0)}),s)return T7(n,t);mc={"General Number":"General","General Date":et[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":et[15],"Short Date":et[14],"Long Time":et[19],"Medium Time":et[18],"Short Time":et[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:et[2],Standard:et[4],Percent:et[10],Scientific:et[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],f,c={},h=[],u=t.dense?[]:{},d="",p={},m={},g=Mi('<Data ss:Type="String">'),v=0,w=0,x=0,S={s:{r:2e6,c:2e6},e:{r:0,c:0}},y={},b={},O="",T=0,k=[],Q={},A={},_=0,N=[],U=[],z={},K=[],re,ge=!1,V=[],he=[],ae={},E=0,L=0,I={Sheets:[],WBProps:{date1904:!1}},Z={};Ac.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var ee="";o=Ac.exec(n);)switch(o[3]=(ee=o[3]).toLowerCase()){case"data":if(ee=="data"){if(o[1]==="/"){if((f=l.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?UB(n.slice(v,o.index),O,g,l[l.length-1][0]=="comment"?z:p,{c:w,r:x},y,K[w],m,V,t):(O="",g=Mi(o[0]),v=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(U.length>0&&(p.c=U),(!t.sheetRows||t.sheetRows>x)&&p.v!==void 0&&(t.dense?(u[x]||(u[x]=[]),u[x][w]=p):u[cr(w)+kr(x)]=p),p.HRef&&(p.l={Target:Pt(p.HRef)},p.HRefScreenTip&&(p.l.Tooltip=p.HRefScreenTip),delete p.HRef,delete p.HRefScreenTip),(p.MergeAcross||p.MergeDown)&&(E=w+(parseInt(p.MergeAcross,10)|0),L=x+(parseInt(p.MergeDown,10)|0),k.push({s:{c:w,r:x},e:{c:E,r:L}})),!t.sheetStubs)p.MergeAcross?w=E+1:++w;else if(p.MergeAcross||p.MergeDown){for(var ne=w;ne<=E;++ne)for(var de=x;de<=L;++de)(ne>w||de>x)&&(t.dense?(u[de]||(u[de]=[]),u[de][ne]={t:"z"}):u[cr(ne)+kr(de)]={t:"z"});w=E+1}else++w;else p=IB(o[0]),p.Index&&(w=+p.Index-1),w<S.s.c&&(S.s.c=w),w>S.e.c&&(S.e.c=w),o[0].slice(-2)==="/>"&&++w,U=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(x<S.s.r&&(S.s.r=x),x>S.e.r&&(S.e.r=x),o[0].slice(-2)==="/>"&&(m=Mi(o[0]),m.Index&&(x=+m.Index-1)),w=0,++x):(m=Mi(o[0]),m.Index&&(x=+m.Index-1),ae={},(m.AutoFitHeight=="0"||m.Height)&&(ae.hpx=parseInt(m.Height,10),ae.hpt=Fc(ae.hpx),he[x]=ae),m.Hidden=="1"&&(ae.hidden=!0,he[x]=ae));break;case"worksheet":if(o[1]==="/"){if((f=l.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"));h.push(d),S.s.r<=S.e.r&&S.s.c<=S.e.c&&(u["!ref"]=ht(S),t.sheetRows&&t.sheetRows<=S.e.r&&(u["!fullref"]=u["!ref"],S.e.r=t.sheetRows-1,u["!ref"]=ht(S))),k.length&&(u["!merges"]=k),K.length>0&&(u["!cols"]=K),he.length>0&&(u["!rows"]=he),c[d]=u}else S={s:{r:2e6,c:2e6},e:{r:0,c:0}},x=w=0,l.push([o[3],!1]),f=Mi(o[0]),d=Pt(f.Name),u=t.dense?[]:{},k=[],V=[],he=[],Z={name:d,Hidden:0},I.Sheets.push(Z);break;case"table":if(o[1]==="/"){if((f=l.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),K=[],ge=!1}break;case"style":o[1]==="/"?WB(y,b,t):b=Mi(o[0]);break;case"numberformat":b.nf=Pt(Mi(o[0]).Format||"General"),mc[b.nf]&&(b.nf=mc[b.nf]);for(var fe=0;fe!=392&&et[fe]!=b.nf;++fe);if(fe==392){for(fe=57;fe!=392;++fe)if(et[fe]==null){ys(b.nf,fe);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(re=Mi(o[0]),re.Hidden&&(re.hidden=!0,delete re.Hidden),re.Width&&(re.wpx=parseInt(re.Width,10)),!ge&&re.wpx>10){ge=!0,xn=hT;for(var pe=0;pe<K.length;++pe)K[pe]&&$a(K[pe])}ge&&$a(re),K[re.Index-1||K.length]=re;for(var Me=0;Me<+re.Span;++Me)K[K.length]=Kt(re);break;case"namedrange":if(o[1]==="/")break;I.Names||(I.Names=[]);var q=at(o[0]),He={Name:q.Name,Ref:kl(q.RefersTo.slice(1),{r:0,c:0})};I.Sheets.length>0&&(He.Sheet=I.Sheets.length-1),I.Names.push(He);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?O+=n.slice(T,o.index):T=o.index+o[0].length;break;case"interior":if(!t.cellStyles)break;b.Interior=Mi(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?m$(Q,ee,n.slice(_,o.index)):_=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((f=l.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((f=l.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"));XB(z),U.push(z)}else l.push([o[3],!1]),f=Mi(o[0]),z={a:f.Author};break;case"autofilter":if(o[1]==="/"){if((f=l.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var Ve=Mi(o[0]);u["!autofilter"]={ref:kl(Ve.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((f=l.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((f=l.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return Gy(n,t);var Te=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Te=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Te=!1}break;case"excelworkbook":switch(o[3]){case"date1904":I.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Te=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:Te=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(_,o.index)){case"SheetHidden":Z.Hidden=1;break;case"SheetVeryHidden":Z.Hidden=2;break}else _=o.index+o[0].length;break;case"header":u["!margins"]||wo(u["!margins"]={},"xlml"),isNaN(+at(o[0]).Margin)||(u["!margins"].header=+at(o[0]).Margin);break;case"footer":u["!margins"]||wo(u["!margins"]={},"xlml"),isNaN(+at(o[0]).Margin)||(u["!margins"].footer=+at(o[0]).Margin);break;case"pagemargins":var Ne=at(o[0]);u["!margins"]||wo(u["!margins"]={},"xlml"),isNaN(+Ne.Top)||(u["!margins"].top=+Ne.Top),isNaN(+Ne.Left)||(u["!margins"].left=+Ne.Left),isNaN(+Ne.Right)||(u["!margins"].right=+Ne.Right),isNaN(+Ne.Bottom)||(u["!margins"].bottom=+Ne.Bottom);break;case"displayrighttoleft":I.Views||(I.Views=[]),I.Views[0]||(I.Views[0]={}),I.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":u["!outline"]||(u["!outline"]={}),u["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":u["!outline"]||(u["!outline"]={}),u["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Te=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Te=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Te=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Te=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Te=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Te=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Te=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Te=!1}break;case"smarttags":break;default:Te=!1;break}if(Te||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?BB(A,ee,N,n.slice(_,o.index)):(N=o,_=o.index+o[0].length);break}if(t.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var ve={};return!t.bookSheets&&!t.bookProps&&(ve.Sheets=c),ve.SheetNames=h,ve.Workbook=I,ve.SSF=Kt(et),ve.Props=Q,ve.Custprops=A,ve}function Ym(r,e){switch(HO(e=e||{}),e.type||"base64"){case"base64":return yp(ci(r),e);case"binary":case"buffer":case"file":return yp(r,e);case"array":return yp(Va(r),e)}}function VB(r,e){var t=[];return r.Props&&t.push(g$(r.Props,e)),r.Custprops&&t.push(O$(r.Props,r.Custprops)),t.join("")}function qB(){return""}function jB(r,e){var t=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,i){var s=[];s.push(Fe("NumberFormat",null,{"ss:Format":Ut(et[n.numFmtId])}));var a={"ss:ID":"s"+(21+i)};t.push(Fe("Style",s.join(""),a))}),Fe("Styles",t.join(""))}function LT(r){return Fe("NamedRange",null,{"ss:Name":r.Name,"ss:RefersTo":"="+UO(r.Ref,{r:0,c:0})})}function zB(r){if(!((r||{}).Workbook||{}).Names)return"";for(var e=r.Workbook.Names,t=[],n=0;n<e.length;++n){var i=e[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||t.push(LT(i)))}return Fe("Names",t.join(""))}function GB(r,e,t,n){if(!r||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,s=[],a=0;a<i.length;++a){var o=i[a];o.Sheet==t&&(o.Name.match(/^_xlfn\./)||s.push(LT(o)))}return s.join("")}function HB(r,e,t,n){if(!r)return"";var i=[];if(r["!margins"]&&(i.push("<PageSetup>"),r["!margins"].header&&i.push(Fe("Header",null,{"x:Margin":r["!margins"].header})),r["!margins"].footer&&i.push(Fe("Footer",null,{"x:Margin":r["!margins"].footer})),i.push(Fe("PageMargins",null,{"x:Bottom":r["!margins"].bottom||"0.75","x:Left":r["!margins"].left||"0.7","x:Right":r["!margins"].right||"0.7","x:Top":r["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[t])if(n.Workbook.Sheets[t].Hidden)i.push(Fe("Visible",n.Workbook.Sheets[t].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<t&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==t&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),r["!protect"]&&(i.push(cn("ProtectContents","True")),r["!protect"].objects&&i.push(cn("ProtectObjects","True")),r["!protect"].scenarios&&i.push(cn("ProtectScenarios","True")),r["!protect"].selectLockedCells!=null&&!r["!protect"].selectLockedCells?i.push(cn("EnableSelection","NoSelection")):r["!protect"].selectUnlockedCells!=null&&!r["!protect"].selectUnlockedCells&&i.push(cn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){r["!protect"][a[0]]&&i.push("<"+a[1]+"/>")})),i.length==0?"":Fe("WorksheetOptions",i.join(""),{xmlns:Jn.x})}function YB(r){return r.map(function(e){var t=vF(e.t||""),n=Fe("ss:Data",t,{xmlns:"http://www.w3.org/TR/REC-html40"});return Fe("Comment",n,{"ss:Author":e.a})}).join("")}function KB(r,e,t,n,i,s,a){if(!r||r.v==null&&r.f==null)return"";var o={};if(r.f&&(o["ss:Formula"]="="+Ut(UO(r.f,a))),r.F&&r.F.slice(0,e.length)==e){var l=wr(r.F.slice(e.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==a.r?"":"["+(l.r-a.r)+"]")+"C"+(l.c==a.c?"":"["+(l.c-a.c)+"]")}if(r.l&&r.l.Target&&(o["ss:HRef"]=Ut(r.l.Target),r.l.Tooltip&&(o["x:HRefScreenTip"]=Ut(r.l.Tooltip))),t["!merges"])for(var f=t["!merges"],c=0;c!=f.length;++c)f[c].s.c!=a.c||f[c].s.r!=a.r||(f[c].e.c>f[c].s.c&&(o["ss:MergeAcross"]=f[c].e.c-f[c].s.c),f[c].e.r>f[c].s.r&&(o["ss:MergeDown"]=f[c].e.r-f[c].s.r));var h="",u="";switch(r.t){case"z":if(!n.sheetStubs)return"";break;case"n":h="Number",u=String(r.v);break;case"b":h="Boolean",u=r.v?"1":"0";break;case"e":h="Error",u=na[r.v];break;case"d":h="DateTime",u=new Date(r.v).toISOString(),r.z==null&&(r.z=r.z||et[14]);break;case"s":h="String",u=xF(r.v||"");break}var d=ja(n.cellXfs,r,n);o["ss:StyleID"]="s"+(21+d),o["ss:Index"]=a.c+1;var p=r.v!=null?u:"",m=r.t=="z"?"":'<Data ss:Type="'+h+'">'+p+"</Data>";return(r.c||[]).length>0&&(m+=YB(r.c)),Fe("Cell",m,o)}function JB(r,e){var t='<Row ss:Index="'+(r+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=Il(e.hpt)),e.hpx&&(t+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(t+=' ss:Hidden="1"')),t+">"}function e7(r,e,t,n){if(!r["!ref"])return"";var i=wt(r["!ref"]),s=r["!merges"]||[],a=0,o=[];r["!cols"]&&r["!cols"].forEach(function(g,v){$a(g);var w=!!g.width,x=Q0(v,g),S={"ss:Index":v+1};w&&(S["ss:Width"]=Rc(x.width)),g.hidden&&(S["ss:Hidden"]="1"),o.push(Fe("Column",null,S))});for(var l=Array.isArray(r),f=i.s.r;f<=i.e.r;++f){for(var c=[JB(f,(r["!rows"]||[])[f])],h=i.s.c;h<=i.e.c;++h){var u=!1;for(a=0;a!=s.length;++a)if(!(s[a].s.c>h)&&!(s[a].s.r>f)&&!(s[a].e.c<h)&&!(s[a].e.r<f)){(s[a].s.c!=h||s[a].s.r!=f)&&(u=!0);break}if(!u){var d={r:f,c:h},p=it(d),m=l?(r[f]||[])[h]:r[p];c.push(KB(m,p,r,e,t,n,d))}}c.push("</Row>"),c.length>2&&o.push(c.join(""))}return o.join("")}function t7(r,e,t){var n=[],i=t.SheetNames[r],s=t.Sheets[i],a=s?GB(s,e,r,t):"";return a.length>0&&n.push("<Names>"+a+"</Names>"),a=s?e7(s,e,r,t):"",a.length>0&&n.push("<Table>"+a+"</Table>"),n.push(HB(s,e,r,t)),n.join("")}function r7(r,e){e||(e={}),r.SSF||(r.SSF=Kt(et)),r.SSF&&(ff(),xh(r.SSF),e.revssf=T0(r.SSF),e.revssf[r.SSF[65535]]=0,e.ssf=r.SSF,e.cellXfs=[],ja(e.cellXfs,{},{revssf:{General:0}}));var t=[];t.push(VB(r,e)),t.push(qB()),t.push(""),t.push("");for(var n=0;n<r.SheetNames.length;++n)t.push(Fe("Worksheet",t7(n,e,r),{"ss:Name":Ut(r.SheetNames[n])}));return t[2]=jB(r,e),t[3]=zB(r),Rr+Fe("Workbook",t.join(""),{xmlns:Jn.ss,"xmlns:o":Jn.o,"xmlns:x":Jn.x,"xmlns:ss":Jn.ss,"xmlns:dt":Jn.dt,"xmlns:html":Jn.html})}function n7(r){var e={},t=r.content;if(t.l=28,e.AnsiUserType=t.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=GF(t),t.length-t.l<=4)return e;var n=t.read_shift(4);if(n==0||n>40||(t.l-=4,e.Reserved1=t.read_shift(0,"lpstr-ansi"),t.length-t.l<=4)||(n=t.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=HF(t),n=t.read_shift(4),n==0||n>40))return e;t.l-=4,e.Reserved2=t.read_shift(0,"lpwstr")}var i7=[60,1084,2066,2165,2175];function s7(r,e,t,n,i){var s=n,a=[],o=t.slice(t.l,t.l+s);if(i.enc&&i.enc.insitu&&o.length>0)switch(r){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(o)}a.push(o),t.l+=s;for(var l=Ws(t,t.l),f=Km[l],c=0;f!=null&&i7.indexOf(l)>-1;)s=Ws(t,t.l+2),c=t.l+4,l==2066?c+=4:(l==2165||l==2175)&&(c+=12),o=t.slice(c,t.l+4+s),a.push(o),t.l+=4+s,f=Km[l=Ws(t,t.l)];var h=Hr(a);rn(h,0);var u=0;h.lens=[];for(var d=0;d<a.length;++d)h.lens.push(u),u+=a[d].length;if(h.length<n)throw"XLS Record 0x"+r.toString(16)+" Truncated: "+h.length+" < "+n;return e.f(h,h.length,i)}function ss(r,e,t){if(r.t!=="z"&&r.XF){var n=0;try{n=r.z||r.XF.numFmtId||0,e.cellNF&&(r.z=et[n])}catch(s){if(e.WTF)throw s}if(!e||e.cellText!==!1)try{r.t==="e"?r.w=r.w||na[r.v]:n===0||n=="General"?r.t==="n"?(r.v|0)===r.v?r.w=r.v.toString(10):r.w=Sc(r.v):r.w=Co(r.v):r.w=hi(n,r.v,{date1904:!!t,dateNF:e&&e.dateNF})}catch(s){if(e.WTF)throw s}if(e.cellDates&&n&&r.t=="n"&&Bo(et[n]||String(n))){var i=_a(r.v);i&&(r.t="d",r.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function Yh(r,e,t){return{v:r,ixfe:e,t}}function a7(r,e){var t={opts:{}},n={},i=e.dense?[]:{},s={},a={},o=null,l=[],f="",c={},h,u="",d,p,m,g,v={},w=[],x,S,y=[],b=[],O={Sheets:[],WBProps:{date1904:!1},Views:[{}]},T={},k=function(Ke){return Ke<8?xo[Ke]:Ke<64&&b[Ke-8]||xo[Ke]},Q=function(Ke,zt,tr){var ur=zt.XF.data;if(!(!ur||!ur.patternType||!tr||!tr.cellStyles)){zt.s={},zt.s.patternType=ur.patternType;var di;(di=Pc(k(ur.icvFore)))&&(zt.s.fgColor={rgb:di}),(di=Pc(k(ur.icvBack)))&&(zt.s.bgColor={rgb:di})}},A=function(Ke,zt,tr){if(!(ae>1)&&!(tr.sheetRows&&Ke.r>=tr.sheetRows)){if(tr.cellStyles&&zt.XF&&zt.XF.data&&Q(Ke,zt,tr),delete zt.ixfe,delete zt.XF,h=Ke,u=it(Ke),(!a||!a.s||!a.e)&&(a={s:{r:0,c:0},e:{r:0,c:0}}),Ke.r<a.s.r&&(a.s.r=Ke.r),Ke.c<a.s.c&&(a.s.c=Ke.c),Ke.r+1>a.e.r&&(a.e.r=Ke.r+1),Ke.c+1>a.e.c&&(a.e.c=Ke.c+1),tr.cellFormula&&zt.f){for(var ur=0;ur<w.length;++ur)if(!(w[ur][0].s.c>Ke.c||w[ur][0].s.r>Ke.r)&&!(w[ur][0].e.c<Ke.c||w[ur][0].e.r<Ke.r)){zt.F=ht(w[ur][0]),(w[ur][0].s.c!=Ke.c||w[ur][0].s.r!=Ke.r)&&delete zt.f,zt.f&&(zt.f=""+gn(w[ur][1],a,Ke,V,_));break}}tr.dense?(i[Ke.r]||(i[Ke.r]=[]),i[Ke.r][Ke.c]=zt):i[u]=zt}},_={enc:!1,sbcch:0,snames:[],sharedf:v,arrayf:w,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(_.password=e.password);var N,U=[],z=[],K=[],re=[],ge=!1,V=[];V.SheetNames=_.snames,V.sharedf=_.sharedf,V.arrayf=_.arrayf,V.names=[],V.XTI=[];var he=0,ae=0,E=0,L=[],I=[],Z;_.codepage=1200,ki(1200);for(var ee=!1;r.l<r.length-1;){var ne=r.l,de=r.read_shift(2);if(de===0&&he===10)break;var fe=r.l===r.length?0:r.read_shift(2),pe=Km[de];if(pe&&pe.f){if(e.bookSheets&&he===133&&de!==133)break;if(he=de,pe.r===2||pe.r==12){var Me=r.read_shift(2);if(fe-=2,!_.enc&&Me!==de&&((Me&255)<<8|Me>>8)!==de)throw new Error("rt mismatch: "+Me+"!="+de);pe.r==12&&(r.l+=10,fe-=10)}var q={};if(de===10?q=pe.f(r,fe,_):q=s7(de,pe,r,fe,_),ae==0&&[9,521,1033,2057].indexOf(he)===-1)continue;switch(de){case 34:t.opts.Date1904=O.WBProps.date1904=q;break;case 134:t.opts.WriteProtect=!0;break;case 47:if(_.enc||(r.l=0),_.enc=q,!e.password)throw new Error("File is password-protected");if(q.valid==null)throw new Error("Encryption scheme unsupported");if(!q.valid)throw new Error("Password is incorrect");break;case 92:_.lastuser=q;break;case 66:var He=Number(q);switch(He){case 21010:He=1200;break;case 32768:He=1e4;break;case 32769:He=1252;break}ki(_.codepage=He),ee=!0;break;case 317:_.rrtabid=q;break;case 25:_.winlocked=q;break;case 439:t.opts.RefreshAll=q;break;case 12:t.opts.CalcCount=q;break;case 16:t.opts.CalcDelta=q;break;case 17:t.opts.CalcIter=q;break;case 13:t.opts.CalcMode=q;break;case 14:t.opts.CalcPrecision=q;break;case 95:t.opts.CalcSaveRecalc=q;break;case 15:_.CalcRefMode=q;break;case 2211:t.opts.FullCalc=q;break;case 129:q.fDialog&&(i["!type"]="dialog"),q.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),q.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:y.push(q);break;case 430:V.push([q]),V[V.length-1].XTI=[];break;case 35:case 547:V[V.length-1].push(q);break;case 24:case 536:Z={Name:q.Name,Ref:gn(q.rgce,a,null,V,_)},q.itab>0&&(Z.Sheet=q.itab-1),V.names.push(Z),V[0]||(V[0]=[],V[0].XTI=[]),V[V.length-1].push(q),q.Name=="_xlnm._FilterDatabase"&&q.itab>0&&q.rgce&&q.rgce[0]&&q.rgce[0][0]&&q.rgce[0][0][0]=="PtgArea3d"&&(I[q.itab-1]={ref:ht(q.rgce[0][0][1][2])});break;case 22:_.ExternCount=q;break;case 23:V.length==0&&(V[0]=[],V[0].XTI=[]),V[V.length-1].XTI=V[V.length-1].XTI.concat(q),V.XTI=V.XTI.concat(q);break;case 2196:if(_.biff<8)break;Z!=null&&(Z.Comment=q[1]);break;case 18:i["!protect"]=q;break;case 19:q!==0&&_.WTF&&console.error("Password verifier: "+q);break;case 133:s[q.pos]=q,_.snames.push(q.name);break;case 10:{if(--ae)break;if(a.e){if(a.e.r>0&&a.e.c>0){if(a.e.r--,a.e.c--,i["!ref"]=ht(a),e.sheetRows&&e.sheetRows<=a.e.r){var Ve=a.e.r;a.e.r=e.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=ht(a),a.e.r=Ve}a.e.r++,a.e.c++}U.length>0&&(i["!merges"]=U),z.length>0&&(i["!objects"]=z),K.length>0&&(i["!cols"]=K),re.length>0&&(i["!rows"]=re),O.Sheets.push(T)}f===""?c=i:n[f]=i,i=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(_.biff===8&&(_.biff={9:2,521:3,1033:4}[de]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[q.BIFFVer]||8),_.biffguess=q.BIFFVer==0,q.BIFFVer==0&&q.dt==4096&&(_.biff=5,ee=!0,ki(_.codepage=28591)),_.biff==8&&q.BIFFVer==0&&q.dt==16&&(_.biff=2),ae++)break;if(i=e.dense?[]:{},_.biff<8&&!ee&&(ee=!0,ki(_.codepage=e.codepage||1252)),_.biff<5||q.BIFFVer==0&&q.dt==4096){f===""&&(f="Sheet1"),a={s:{r:0,c:0},e:{r:0,c:0}};var Te={pos:r.l-fe,name:f};s[Te.pos]=Te,_.snames.push(f)}else f=(s[ne]||{name:""}).name;q.dt==32&&(i["!type"]="chart"),q.dt==64&&(i["!type"]="macro"),U=[],z=[],_.arrayf=w=[],K=[],re=[],ge=!1,T={Hidden:(s[ne]||{hs:0}).hs,name:f}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(e.dense?(i[q.r]||[])[q.c]:i[it({c:q.c,r:q.r})])&&++q.c,x={ixfe:q.ixfe,XF:y[q.ixfe]||{},v:q.val,t:"n"},E>0&&(x.z=L[x.ixfe>>8&63]),ss(x,e,t.opts.Date1904),A({c:q.c,r:q.r},x,e);break;case 5:case 517:x={ixfe:q.ixfe,XF:y[q.ixfe],v:q.val,t:q.t},E>0&&(x.z=L[x.ixfe>>8&63]),ss(x,e,t.opts.Date1904),A({c:q.c,r:q.r},x,e);break;case 638:x={ixfe:q.ixfe,XF:y[q.ixfe],v:q.rknum,t:"n"},E>0&&(x.z=L[x.ixfe>>8&63]),ss(x,e,t.opts.Date1904),A({c:q.c,r:q.r},x,e);break;case 189:for(var Ne=q.c;Ne<=q.C;++Ne){var ve=q.rkrec[Ne-q.c][0];x={ixfe:ve,XF:y[ve],v:q.rkrec[Ne-q.c][1],t:"n"},E>0&&(x.z=L[x.ixfe>>8&63]),ss(x,e,t.opts.Date1904),A({c:Ne,r:q.r},x,e)}break;case 6:case 518:case 1030:{if(q.val=="String"){o=q;break}if(x=Yh(q.val,q.cell.ixfe,q.tt),x.XF=y[x.ixfe],e.cellFormula){var ct=q.formula;if(ct&&ct[0]&&ct[0][0]&&ct[0][0][0]=="PtgExp"){var bt=ct[0][0][1][0],Bt=ct[0][0][1][1],er=it({r:bt,c:Bt});v[er]?x.f=""+gn(q.formula,a,q.cell,V,_):x.F=((e.dense?(i[bt]||[])[Bt]:i[er])||{}).F}else x.f=""+gn(q.formula,a,q.cell,V,_)}E>0&&(x.z=L[x.ixfe>>8&63]),ss(x,e,t.opts.Date1904),A(q.cell,x,e),o=q}break;case 7:case 519:if(o)o.val=q,x=Yh(q,o.cell.ixfe,"s"),x.XF=y[x.ixfe],e.cellFormula&&(x.f=""+gn(o.formula,a,o.cell,V,_)),E>0&&(x.z=L[x.ixfe>>8&63]),ss(x,e,t.opts.Date1904),A(o.cell,x,e),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{w.push(q);var Qe=it(q[0].s);if(d=e.dense?(i[q[0].s.r]||[])[q[0].s.c]:i[Qe],e.cellFormula&&d){if(!o||!Qe||!d)break;d.f=""+gn(q[1],a,q[0],V,_),d.F=ht(q[0])}}break;case 1212:{if(!e.cellFormula)break;if(u){if(!o)break;v[it(o.cell)]=q[0],d=e.dense?(i[o.cell.r]||[])[o.cell.c]:i[it(o.cell)],(d||{}).f=""+gn(q[0],a,h,V,_)}}break;case 253:x=Yh(l[q.isst].t,q.ixfe,"s"),l[q.isst].h&&(x.h=l[q.isst].h),x.XF=y[x.ixfe],E>0&&(x.z=L[x.ixfe>>8&63]),ss(x,e,t.opts.Date1904),A({c:q.c,r:q.r},x,e);break;case 513:e.sheetStubs&&(x={ixfe:q.ixfe,XF:y[q.ixfe],t:"z"},E>0&&(x.z=L[x.ixfe>>8&63]),ss(x,e,t.opts.Date1904),A({c:q.c,r:q.r},x,e));break;case 190:if(e.sheetStubs)for(var Xe=q.c;Xe<=q.C;++Xe){var De=q.ixfe[Xe-q.c];x={ixfe:De,XF:y[De],t:"z"},E>0&&(x.z=L[x.ixfe>>8&63]),ss(x,e,t.opts.Date1904),A({c:Xe,r:q.r},x,e)}break;case 214:case 516:case 4:x=Yh(q.val,q.ixfe,"s"),x.XF=y[x.ixfe],E>0&&(x.z=L[x.ixfe>>8&63]),ss(x,e,t.opts.Date1904),A({c:q.c,r:q.r},x,e);break;case 0:case 512:ae===1&&(a=q);break;case 252:l=q;break;case 1054:if(_.biff==4){L[E++]=q[1];for(var ke=0;ke<E+163&&et[ke]!=q[1];++ke);ke>=163&&ys(q[1],E+163)}else ys(q[1],q[0]);break;case 30:{L[E++]=q;for(var Ee=0;Ee<E+163&&et[Ee]!=q;++Ee);Ee>=163&&ys(q,E+163)}break;case 229:U=U.concat(q);break;case 93:z[q.cmo[0]]=_.lastobj=q;break;case 438:_.lastobj.TxO=q;break;case 127:_.lastobj.ImData=q;break;case 440:for(g=q[0].s.r;g<=q[0].e.r;++g)for(m=q[0].s.c;m<=q[0].e.c;++m)d=e.dense?(i[g]||[])[m]:i[it({c:m,r:g})],d&&(d.l=q[1]);break;case 2048:for(g=q[0].s.r;g<=q[0].e.r;++g)for(m=q[0].s.c;m<=q[0].e.c;++m)d=e.dense?(i[g]||[])[m]:i[it({c:m,r:g})],d&&d.l&&(d.l.Tooltip=q[1]);break;case 28:{if(_.biff<=5&&_.biff>=2)break;d=e.dense?(i[q[0].r]||[])[q[0].c]:i[it(q[0])];var Ft=z[q[2]];d||(e.dense?(i[q[0].r]||(i[q[0].r]=[]),d=i[q[0].r][q[0].c]={t:"z"}):d=i[it(q[0])]={t:"z"},a.e.r=Math.max(a.e.r,q[0].r),a.s.r=Math.min(a.s.r,q[0].r),a.e.c=Math.max(a.e.c,q[0].c),a.s.c=Math.min(a.s.c,q[0].c)),d.c||(d.c=[]),p={a:q[1],t:Ft.TxO.t},d.c.push(p)}break;case 2173:zM(y[q.ixfe],q.ext);break;case 125:{if(!_.cellStyles)break;for(;q.e>=q.s;)K[q.e--]={width:q.w/256,level:q.level||0,hidden:!!(q.flags&1)},ge||(ge=!0,BO(q.w/256)),$a(K[q.e+1])}break;case 520:{var xr={};q.level!=null&&(re[q.r]=xr,xr.level=q.level),q.hidden&&(re[q.r]=xr,xr.hidden=!0),q.hpt&&(re[q.r]=xr,xr.hpt=q.hpt,xr.hpx=Il(q.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||wo(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[de]]=q;break;case 161:i["!margins"]||wo(i["!margins"]={}),i["!margins"].header=q.header,i["!margins"].footer=q.footer;break;case 574:q.RTL&&(O.Views[0].RTL=!0);break;case 146:b=q;break;case 2198:N=q;break;case 140:S=q;break;case 442:f?T.CodeName=q||T.name:O.WBProps.CodeName=q||"ThisWorkbook";break}}else pe||console.error("Missing Info for XLS Record 0x"+de.toString(16)),r.l+=fe}return t.SheetNames=Tr(s).sort(function(Vt,Ke){return Number(Vt)-Number(Ke)}).map(function(Vt){return s[Vt].name}),e.bookSheets||(t.Sheets=n),!t.SheetNames.length&&c["!ref"]?(t.SheetNames.push("Sheet1"),t.Sheets&&(t.Sheets.Sheet1=c)):t.Preamble=c,t.Sheets&&I.forEach(function(Vt,Ke){t.Sheets[t.SheetNames[Ke]]["!autofilter"]=Vt}),t.Strings=l,t.SSF=Kt(et),_.enc&&(t.Encryption=_.enc),N&&(t.Themes=N),t.Metadata={},S!==void 0&&(t.Metadata.Country=S),V.names.length>0&&(O.Names=V.names),t.Workbook=O,t}var gc={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function o7(r,e,t){var n=Ye.find(r,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=Sy(n,Vm,gc.DSI);for(var s in i)e[s]=i[s]}catch(f){if(t.WTF)throw f}var a=Ye.find(r,"/!SummaryInformation");if(a&&a.size>0)try{var o=Sy(a,qm,gc.SI);for(var l in o)e[l]==null&&(e[l]=o[l])}catch(f){if(t.WTF)throw f}e.HeadingPairs&&e.TitlesOfParts&&(MS(e.HeadingPairs,e.TitlesOfParts,e,t),delete e.HeadingPairs,delete e.TitlesOfParts)}function l7(r,e){var t=[],n=[],i=[],s=0,a,o=ty(Vm,"n"),l=ty(qm,"n");if(r.Props)for(a=Tr(r.Props),s=0;s<a.length;++s)(Object.prototype.hasOwnProperty.call(o,a[s])?t:Object.prototype.hasOwnProperty.call(l,a[s])?n:i).push([a[s],r.Props[a[s]]]);if(r.Custprops)for(a=Tr(r.Custprops),s=0;s<a.length;++s)Object.prototype.hasOwnProperty.call(r.Props||{},a[s])||(Object.prototype.hasOwnProperty.call(o,a[s])?t:Object.prototype.hasOwnProperty.call(l,a[s])?n:i).push([a[s],r.Custprops[a[s]]]);var f=[];for(s=0;s<i.length;++s)XS.indexOf(i[s][0])>-1||DS.indexOf(i[s][0])>-1||i[s][1]!=null&&f.push(i[s]);n.length&&Ye.utils.cfb_add(e,"/SummaryInformation",Ty(n,gc.SI,l,qm)),(t.length||f.length)&&Ye.utils.cfb_add(e,"/DocumentSummaryInformation",Ty(t,gc.DSI,o,Vm,f.length?f:null,gc.UDI))}function zO(r,e){e||(e={}),HO(e),k0(),e.codepage&&_0(e.codepage);var t,n;if(r.FullPaths){if(Ye.find(r,"/encryption"))throw new Error("File is password-protected");t=Ye.find(r,"!CompObj"),n=Ye.find(r,"/Workbook")||Ye.find(r,"/Book")}else{switch(e.type){case"base64":r=ei(ci(r));break;case"binary":r=ei(r);break;case"buffer":break;case"array":Array.isArray(r)||(r=Array.prototype.slice.call(r));break}rn(r,0),n={content:r}}var i,s;if(t&&n7(t),e.bookProps&&!e.bookSheets)i={};else{var a=gt?"buffer":"array";if(n&&n.content)i=a7(n.content,e);else if((s=Ye.find(r,"PerfectOffice_MAIN"))&&s.content)i=yo.to_workbook(s.content,(e.type=a,e));else if((s=Ye.find(r,"NativeContent_MAIN"))&&s.content)i=yo.to_workbook(s.content,(e.type=a,e));else throw(s=Ye.find(r,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&r.FullPaths&&Ye.find(r,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=b6(r))}var o={};return r.FullPaths&&o7(r,o,e),i.Props=i.Custprops=o,e.bookFiles&&(i.cfb=r),i}function f7(r,e){var t=e,n=Ye.utils.cfb_new({root:"R"}),i="/Workbook";switch(t.bookType||"xls"){case"xls":t.bookType="biff8";case"xla":t.bookType||(t.bookType="xla");case"biff8":i="/Workbook",t.biff=8;break;case"biff5":i="/Book",t.biff=5;break;default:throw new Error("invalid type "+t.bookType+" for XLS CFB")}return Ye.utils.cfb_add(n,i,BT(r,t)),t.biff==8&&(r.Props||r.Custprops)&&l7(r,n),t.biff==8&&r.vbaraw&&_6(n,Ye.read(r.vbaraw,{type:typeof r.vbaraw=="string"?"binary":"buffer"})),n}var $c={0:{f:$I},1:{f:WI},2:{f:oL},3:{f:HI},4:{f:qI},5:{f:iL},6:{f:uL},7:{f:eL},8:{f:vL},9:{f:xL},10:{f:gL},11:{f:OL},12:{f:XI},13:{f:fL},14:{f:KI},15:{f:zI},16:{f:RT},17:{f:pL},18:{f:rL},19:{f:PO},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:dB},40:{},42:{},43:{f:uM},44:{f:cM},45:{f:mM},46:{f:OM},47:{f:gM},48:{},49:{f:MF},50:{},51:{f:YM},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:tT},62:{f:hL},63:{f:a6},64:{f:NL},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Sn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:RL},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:BI},148:{f:MI,p:16},151:{f:SL},152:{},153:{f:cB},154:{},155:{},156:{f:lB},157:{},158:{},159:{T:1,f:CD},160:{T:-1},161:{T:1,f:Vo},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:yL},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:GM},336:{T:-1},337:{f:e6,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Xm},357:{},358:{},359:{},360:{T:1},361:{},362:{f:eT},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:TL},427:{f:CL},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:EL},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:LI},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:_L},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Xm},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:O6},633:{T:1},634:{T:-1},635:{T:1,f:m6},636:{T:-1},637:{f:ZF},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:KL},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:DL},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Km={6:{f:xp},10:{f:pa},12:{f:Dr},13:{f:Dr},14:{f:Ar},15:{f:Ar},16:{f:yn},17:{f:Ar},18:{f:Ar},19:{f:Dr},20:{f:Qy},21:{f:Qy},23:{f:eT},24:{f:$y},25:{f:Ar},26:{},27:{},28:{f:DN},29:{},34:{f:Ar},35:{f:Fy},38:{f:yn},39:{f:yn},40:{f:yn},41:{f:yn},42:{f:Ar},43:{f:Ar},47:{f:zD},49:{f:fN},51:{f:Dr},60:{},61:{f:iN},64:{f:Ar},65:{f:lN},66:{f:Dr},77:{},80:{},81:{},82:{},85:{f:Dr},89:{},90:{},91:{},92:{f:j$},93:{f:LN},94:{},95:{f:Ar},96:{},97:{},99:{f:Ar},125:{f:tT},128:{f:kN},129:{f:G$},130:{f:Dr},131:{f:Ar},132:{f:Ar},133:{f:H$},134:{},140:{f:jN},141:{f:Dr},144:{},146:{f:HN},151:{},152:{},153:{},154:{},155:{},156:{f:Dr},157:{},158:{},160:{f:nD},161:{f:JN},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:yN},190:{f:wN},193:{f:pa},197:{},198:{},199:{},200:{},201:{},202:{f:Ar},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Dr},220:{},221:{f:Ar},222:{},224:{f:_N},225:{f:q$},226:{f:pa},227:{},229:{f:MN},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:K$},253:{f:hN},255:{f:eN},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:VS},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Ar},353:{f:pa},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:EN},431:{f:Ar},432:{},433:{},434:{},437:{},438:{f:WN},439:{f:Ar},440:{f:UN},441:{},442:{f:wh},443:{},444:{f:Dr},445:{},446:{},448:{f:pa},449:{f:nN,r:2},450:{f:pa},512:{f:Ey},513:{f:rD},515:{f:CN},516:{f:dN},517:{f:Ry},519:{f:iD},520:{f:tN},523:{},545:{f:Ny},549:{f:Ay},566:{},574:{f:aN},638:{f:vN},659:{},1048:{},1054:{f:mN},1084:{},1212:{f:FN},2048:{f:VN},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:zh},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:pa},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:YN,r:12},2173:{f:jM,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Ar,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:QN,r:12},2197:{},2198:{f:ZM,r:12},2199:{},2200:{},2201:{},2202:{f:$N,r:12},2203:{f:pa},2204:{},2205:{},2206:{},2207:{},2211:{f:rN},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Dr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:eD},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:GN},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Ey},1:{},2:{f:fD},3:{f:oD},4:{f:aD},5:{f:Ry},7:{f:hD},8:{},9:{f:zh},11:{},22:{f:Dr},30:{f:ON},31:{},32:{},33:{f:Ny},36:{},37:{f:Ay},50:{f:uD},62:{},52:{},67:{},68:{f:Dr},69:{},86:{},126:{},127:{f:sD},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:dD},223:{},234:{},354:{},421:{},518:{f:xp},521:{f:zh},536:{f:$y},547:{f:Fy},561:{},579:{},1030:{f:xp},1033:{f:zh},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function $e(r,e,t,n){var i=e;if(!isNaN(i)){var s=n||(t||[]).length||0,a=r.next(4);a.write_shift(2,i),a.write_shift(2,s),s>0&&CO(t)&&r.push(t)}}function c7(r,e,t,n){var i=(t||[]).length||0;if(i<=8224)return $e(r,e,t,i);var s=e;if(!isNaN(s)){for(var a=t.parts||[],o=0,l=0,f=0;f+(a[o]||8224)<=8224;)f+=a[o]||8224,o++;var c=r.next(4);for(c.write_shift(2,s),c.write_shift(2,f),r.push(t.slice(l,l+f)),l+=f;l<i;){for(c=r.next(4),c.write_shift(2,60),f=0;f+(a[o]||8224)<=8224;)f+=a[o]||8224,o++;c.write_shift(2,f),r.push(t.slice(l,l+f)),l+=f}}}function Sh(r,e,t){return r||(r=Oe(7)),r.write_shift(2,e),r.write_shift(2,t),r.write_shift(2,0),r.write_shift(1,0),r}function h7(r,e,t,n){var i=Oe(9);return Sh(i,r,e),qS(t,n||"b",i),i}function u7(r,e,t){var n=Oe(8+2*t.length);return Sh(n,r,e),n.write_shift(1,t.length),n.write_shift(t.length,t,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function d7(r,e,t,n){if(e.v!=null)switch(e.t){case"d":case"n":var i=e.t=="d"?Vr(hr(e.v)):e.v;i==(i|0)&&i>=0&&i<65536?$e(r,2,cD(t,n,i)):$e(r,3,lD(t,n,i));return;case"b":case"e":$e(r,5,h7(t,n,e.v,e.t));return;case"s":case"str":$e(r,4,u7(t,n,(e.v||"").slice(0,255)));return}$e(r,1,Sh(null,t,n))}function p7(r,e,t,n){var i=Array.isArray(e),s=wt(e["!ref"]||"A1"),a,o="",l=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),a=ht(s)}for(var f=s.s.r;f<=s.e.r;++f){o=kr(f);for(var c=s.s.c;c<=s.e.c;++c){f===s.s.r&&(l[c]=cr(c)),a=l[c]+o;var h=i?(e[f]||[])[c]:e[a];h&&d7(r,h,f,c)}}}function m7(r,e){for(var t=e||{},n=zn(),i=0,s=0;s<r.SheetNames.length;++s)r.SheetNames[s]==t.sheet&&(i=s);if(i==0&&t.sheet&&r.SheetNames[0]!=t.sheet)throw new Error("Sheet not found: "+t.sheet);return $e(n,t.biff==4?1033:t.biff==3?521:9,MO(r,16,t)),p7(n,r.Sheets[r.SheetNames[i]],i,t),$e(n,10),n.end()}function g7(r,e,t){$e(r,49,cN({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},t))}function O7(r,e,t){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&$e(r,1054,gN(i,e[i],t))})}function x7(r,e){var t=Oe(19);t.write_shift(4,2151),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,1),t.write_shift(4,0),$e(r,2151,t),t=Oe(39),t.write_shift(4,2152),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(2,1),t.write_shift(4,4),t.write_shift(2,0),YS(wt(e["!ref"]||"A1"),t),t.write_shift(4,4),$e(r,2152,t)}function v7(r,e){for(var t=0;t<16;++t)$e(r,224,Py({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){$e(r,224,Py(n,0,e))})}function y7(r,e){for(var t=0;t<e["!links"].length;++t){var n=e["!links"][t];$e(r,440,XN(n)),n[1].Tooltip&&$e(r,2048,qN(n))}delete e["!links"]}function w7(r,e){if(e){var t=0;e.forEach(function(n,i){++t<=256&&n&&$e(r,125,KN(Q0(i,n),i))})}}function b7(r,e,t,n,i){var s=16+ja(i.cellXfs,e,i);if(e.v==null&&!e.bf){$e(r,513,Ro(t,n,s));return}if(e.bf)$e(r,6,G8(e,t,n,i,s));else switch(e.t){case"d":case"n":var a=e.t=="d"?Vr(hr(e.v)):e.v;$e(r,515,AN(t,n,a,s));break;case"b":case"e":$e(r,517,TN(t,n,e.v,s,i,e.t));break;case"s":case"str":if(i.bookSST){var o=VO(i.Strings,e.v,i.revStrings);$e(r,253,uN(t,n,o,s))}else $e(r,516,pN(t,n,(e.v||"").slice(0,255),s,i));break;default:$e(r,513,Ro(t,n,s))}}function _7(r,e,t){var n=zn(),i=t.SheetNames[r],s=t.Sheets[i]||{},a=(t||{}).Workbook||{},o=(a.Sheets||[])[r]||{},l=Array.isArray(s),f=e.biff==8,c,h="",u=[],d=wt(s["!ref"]||"A1"),p=f?65536:16384;if(d.e.c>255||d.e.r>=p){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");d.e.c=Math.min(d.e.c,255),d.e.r=Math.min(d.e.c,p-1)}$e(n,2057,MO(t,16,e)),$e(n,13,yi(1)),$e(n,12,yi(100)),$e(n,15,Rn(!0)),$e(n,17,Rn(!1)),$e(n,16,Eo(.001)),$e(n,95,Rn(!0)),$e(n,42,Rn(!1)),$e(n,43,Rn(!1)),$e(n,130,yi(1)),$e(n,128,SN()),$e(n,131,Rn(!1)),$e(n,132,Rn(!1)),f&&w7(n,s["!cols"]),$e(n,512,xN(d,e)),f&&(s["!links"]=[]);for(var m=d.s.r;m<=d.e.r;++m){h=kr(m);for(var g=d.s.c;g<=d.e.c;++g){m===d.s.r&&(u[g]=cr(g)),c=u[g]+h;var v=l?(s[m]||[])[g]:s[c];v&&(b7(n,v,m,g,e),f&&v.l&&s["!links"].push([c,v.l]))}}var w=o.CodeName||o.name||i;return f&&$e(n,574,oN((a.Views||[])[0])),f&&(s["!merges"]||[]).length&&$e(n,229,IN(s["!merges"])),f&&y7(n,s),$e(n,442,jS(w)),f&&x7(n,s),$e(n,10),n.end()}function k7(r,e,t){var n=zn(),i=(r||{}).Workbook||{},s=i.Sheets||[],a=i.WBProps||{},o=t.biff==8,l=t.biff==5;if($e(n,2057,MO(r,5,t)),t.bookType=="xla"&&$e(n,135),$e(n,225,o?yi(1200):null),$e(n,193,T$(2)),l&&$e(n,191),l&&$e(n,192),$e(n,226),$e(n,92,z$("SheetJS",t)),$e(n,66,yi(o?1200:1252)),o&&$e(n,353,yi(0)),o&&$e(n,448),$e(n,317,tD(r.SheetNames.length)),o&&r.vbaraw&&$e(n,211),o&&r.vbaraw){var f=a.CodeName||"ThisWorkbook";$e(n,442,jS(f))}$e(n,156,yi(17)),$e(n,25,Rn(!1)),$e(n,18,Rn(!1)),$e(n,19,yi(0)),o&&$e(n,431,Rn(!1)),o&&$e(n,444,yi(0)),$e(n,61,sN()),$e(n,64,Rn(!1)),$e(n,141,yi(0)),$e(n,34,Rn(nB(r)=="true")),$e(n,14,Rn(!0)),o&&$e(n,439,Rn(!1)),$e(n,218,yi(0)),g7(n,r,t),O7(n,r.SSF,t),v7(n,t),o&&$e(n,352,Rn(!1));var c=n.end(),h=zn();o&&$e(h,140,zN()),o&&t.Strings&&c7(h,252,J$(t.Strings)),$e(h,10);var u=h.end(),d=zn(),p=0,m=0;for(m=0;m<r.SheetNames.length;++m)p+=(o?12:11)+(o?2:1)*r.SheetNames[m].length;var g=c.length+p+u.length;for(m=0;m<r.SheetNames.length;++m){var v=s[m]||{};$e(d,133,Y$({pos:g,hs:v.Hidden||0,dt:0,name:r.SheetNames[m]},t)),g+=e[m].length}var w=d.end();if(p!=w.length)throw new Error("BS8 "+p+" != "+w.length);var x=[];return c.length&&x.push(c),w.length&&x.push(w),u.length&&x.push(u),Hr(x)}function S7(r,e){var t=e||{},n=[];r&&!r.SSF&&(r.SSF=Kt(et)),r&&r.SSF&&(ff(),xh(r.SSF),t.revssf=T0(r.SSF),t.revssf[r.SSF[65535]]=0,t.ssf=r.SSF),t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,YO(t),t.cellXfs=[],ja(t.cellXfs,{},{revssf:{General:0}}),r.Props||(r.Props={});for(var i=0;i<r.SheetNames.length;++i)n[n.length]=_7(i,t,r);return n.unshift(k7(r,n,t)),Hr(n)}function BT(r,e){for(var t=0;t<=r.SheetNames.length;++t){var n=r.Sheets[r.SheetNames[t]];if(!(!n||!n["!ref"])){var i=Dn(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+r.SheetNames[t]+"' extends beyond column IV (255).  Data may be lost.")}}var s=e||{};switch(s.biff||2){case 8:case 5:return S7(r,e);case 4:case 3:case 2:return m7(r,e)}throw new Error("invalid type "+s.bookType+" for BIFF")}function Vy(r,e){var t=e,n=t.dense?[]:{};r=r.replace(/<!--.*?-->/g,"");var i=r.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var s=r.match(/<\/table/i),a=i.index,o=s&&s.index||r.length,l=cF(r.slice(a,o),/(:?<tr[^>]*>)/i,"<tr>"),f=-1,c=0,h=0,u=0,d={s:{r:1e7,c:1e7},e:{r:0,c:0}},p=[];for(a=0;a<l.length;++a){var m=l[a].trim(),g=m.slice(0,3).toLowerCase();if(g=="<tr"){if(++f,t.sheetRows&&t.sheetRows<=f){--f;break}c=0;continue}if(!(g!="<td"&&g!="<th")){var v=m.split(/<\/t[dh]>/i);for(o=0;o<v.length;++o){var w=v[o].trim();if(w.match(/<t[dh]/i)){for(var x=w,S=0;x.charAt(0)=="<"&&(S=x.indexOf(">"))>-1;)x=x.slice(S+1);for(var y=0;y<p.length;++y){var b=p[y];b.s.c==c&&b.s.r<f&&f<=b.e.r&&(c=b.e.c+1,y=-1)}var O=at(w.slice(0,w.indexOf(">")));u=O.colspan?+O.colspan:1,((h=+O.rowspan)>1||u>1)&&p.push({s:{r:f,c},e:{r:f+(h||1)-1,c:c+u-1}});var T=O.t||O["data-t"]||"";if(!x.length){c+=u;continue}if(x=pS(x),d.s.r>f&&(d.s.r=f),d.e.r<f&&(d.e.r=f),d.s.c>c&&(d.s.c=c),d.e.c<c&&(d.e.c=c),!x.length){c+=u;continue}var k={t:"s",v:x};t.raw||!x.trim().length||T=="s"||(x==="TRUE"?k={t:"b",v:!0}:x==="FALSE"?k={t:"b",v:!1}:isNaN(Vi(x))?isNaN(Dl(x).getDate())||(k={t:"d",v:hr(x)},t.cellDates||(k={t:"n",v:Vr(k.v)}),k.z=t.dateNF||et[14]):k={t:"n",v:Vi(x)}),t.dense?(n[f]||(n[f]=[]),n[f][c]=k):n[it({r:f,c})]=k,c+=u}}}}return n["!ref"]=ht(d),p.length&&(n["!merges"]=p),n}function ZT(r,e,t,n){for(var i=r["!merges"]||[],s=[],a=e.s.c;a<=e.e.c;++a){for(var o=0,l=0,f=0;f<i.length;++f)if(!(i[f].s.r>t||i[f].s.c>a)&&!(i[f].e.r<t||i[f].e.c<a)){if(i[f].s.r<t||i[f].s.c<a){o=-1;break}o=i[f].e.r-i[f].s.r+1,l=i[f].e.c-i[f].s.c+1;break}if(!(o<0)){var c=it({r:t,c:a}),h=n.dense?(r[t]||[])[a]:r[c],u=h&&h.v!=null&&(h.h||yO(h.w||(_s(h),h.w)||""))||"",d={};o>1&&(d.rowspan=o),l>1&&(d.colspan=l),n.editable?u='<span contenteditable="true">'+u+"</span>":h&&(d["data-t"]=h&&h.t||"z",h.v!=null&&(d["data-v"]=h.v),h.z!=null&&(d["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(u='<a href="'+h.l.Target+'">'+u+"</a>")),d.id=(n.id||"sjs")+"-"+c,s.push(Fe("td",u,d))}}var p="<tr>";return p+s.join("")+"</tr>"}var WT='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',UT="</body></html>";function T7(r,e){var t=r.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!t||t.length==0)throw new Error("Invalid HTML: could not find <table>");if(t.length==1)return qa(Vy(t[0],e),e);var n=rx();return t.forEach(function(i,s){nx(n,Vy(i,e),"Sheet"+(s+1))}),n}function XT(r,e,t){var n=[];return n.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function VT(r,e){var t=e||{},n=t.header!=null?t.header:WT,i=t.footer!=null?t.footer:UT,s=[n],a=Dn(r["!ref"]);t.dense=Array.isArray(r),s.push(XT(r,a,t));for(var o=a.s.r;o<=a.e.r;++o)s.push(ZT(r,a,o,t));return s.push("</table>"+i),s.join("")}function qT(r,e,t){var n=t||{},i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var a=typeof n.origin=="string"?wr(n.origin):n.origin;i=a.r,s=a.c}var o=e.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),f={s:{r:0,c:0},e:{r:i,c:s}};if(r["!ref"]){var c=Dn(r["!ref"]);f.s.r=Math.min(f.s.r,c.s.r),f.s.c=Math.min(f.s.c,c.s.c),f.e.r=Math.max(f.e.r,c.e.r),f.e.c=Math.max(f.e.c,c.e.c),i==-1&&(f.e.r=i=c.e.r+1)}var h=[],u=0,d=r["!rows"]||(r["!rows"]=[]),p=0,m=0,g=0,v=0,w=0,x=0;for(r["!cols"]||(r["!cols"]=[]);p<o.length&&m<l;++p){var S=o[p];if(qy(S)){if(n.display)continue;d[m]={hidden:!0}}var y=S.children;for(g=v=0;g<y.length;++g){var b=y[g];if(!(n.display&&qy(b))){var O=b.hasAttribute("data-v")?b.getAttribute("data-v"):b.hasAttribute("v")?b.getAttribute("v"):pS(b.innerHTML),T=b.getAttribute("data-z")||b.getAttribute("z");for(u=0;u<h.length;++u){var k=h[u];k.s.c==v+s&&k.s.r<m+i&&m+i<=k.e.r&&(v=k.e.c+1-s,u=-1)}x=+b.getAttribute("colspan")||1,((w=+b.getAttribute("rowspan")||1)>1||x>1)&&h.push({s:{r:m+i,c:v+s},e:{r:m+i+(w||1)-1,c:v+s+(x||1)-1}});var Q={t:"s",v:O},A=b.getAttribute("data-t")||b.getAttribute("t")||"";O!=null&&(O.length==0?Q.t=A||"z":n.raw||O.trim().length==0||A=="s"||(O==="TRUE"?Q={t:"b",v:!0}:O==="FALSE"?Q={t:"b",v:!1}:isNaN(Vi(O))?isNaN(Dl(O).getDate())||(Q={t:"d",v:hr(O)},n.cellDates||(Q={t:"n",v:Vr(Q.v)}),Q.z=n.dateNF||et[14]):Q={t:"n",v:Vi(O)})),Q.z===void 0&&T!=null&&(Q.z=T);var _="",N=b.getElementsByTagName("A");if(N&&N.length)for(var U=0;U<N.length&&!(N[U].hasAttribute("href")&&(_=N[U].getAttribute("href"),_.charAt(0)!="#"));++U);_&&_.charAt(0)!="#"&&(Q.l={Target:_}),n.dense?(r[m+i]||(r[m+i]=[]),r[m+i][v+s]=Q):r[it({c:v+s,r:m+i})]=Q,f.e.c<v+s&&(f.e.c=v+s),v+=x}}++m}return h.length&&(r["!merges"]=(r["!merges"]||[]).concat(h)),f.e.r=Math.max(f.e.r,m-1+i),r["!ref"]=ht(f),m>=l&&(r["!fullref"]=ht((f.e.r=o.length-p+m-1+i,f))),r}function jT(r,e){var t=e||{},n=t.dense?[]:{};return qT(n,r,e)}function C7(r,e){return qa(jT(r,e),e)}function qy(r){var e="",t=A7(r);return t&&(e=t(r).getPropertyValue("display")),e||(e=r.style&&r.style.display),e==="none"}function A7(r){return r.ownerDocument.defaultView&&typeof r.ownerDocument.defaultView.getComputedStyle=="function"?r.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function E7(r){var e=r.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),t=Pt(e.replace(/<[^>]*>/g,""));return[t]}var jy={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function zT(r,e){var t=e||{},n=wO(r),i=[],s,a,o={name:""},l="",f=0,c,h,u={},d=[],p=t.dense?[]:{},m,g,v={value:""},w="",x=0,S=[],y=-1,b=-1,O={s:{r:1e6,c:1e7},e:{r:0,c:0}},T=0,k={},Q=[],A={},_=0,N=0,U=[],z=1,K=1,re=[],ge={Names:[]},V={},he=["",""],ae=[],E={},L="",I=0,Z=!1,ee=!1,ne=0;for(Ac.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");m=Ac.exec(n);)switch(m[3]=m[3].replace(/_.*$/,"")){case"table":case"":m[1]==="/"?(O.e.c>=O.s.c&&O.e.r>=O.s.r?p["!ref"]=ht(O):p["!ref"]="A1:A1",t.sheetRows>0&&t.sheetRows<=O.e.r&&(p["!fullref"]=p["!ref"],O.e.r=t.sheetRows-1,p["!ref"]=ht(O)),Q.length&&(p["!merges"]=Q),U.length&&(p["!rows"]=U),c.name=c.||c.name,typeof JSON<"u"&&JSON.stringify(c),d.push(c.name),u[c.name]=p,ee=!1):m[0].charAt(m[0].length-2)!=="/"&&(c=at(m[0],!1),y=b=-1,O.s.r=O.s.c=1e7,O.e.r=O.e.c=0,p=t.dense?[]:{},Q=[],U=[],ee=!0);break;case"table-row-group":m[1]==="/"?--T:++T;break;case"table-row":case"":if(m[1]==="/"){y+=z,z=1;break}if(h=at(m[0],!1),h.?y=h.-1:y==-1&&(y=0),z=+h["number-rows-repeated"]||1,z<10)for(ne=0;ne<z;++ne)T>0&&(U[y+ne]={level:T});b=-1;break;case"covered-table-cell":m[1]!=="/"&&++b,t.sheetStubs&&(t.dense?(p[y]||(p[y]=[]),p[y][b]={t:"z"}):p[it({r:y,c:b})]={t:"z"}),w="",S=[];break;case"table-cell":case"":if(m[0].charAt(m[0].length-2)==="/")++b,v=at(m[0],!1),K=parseInt(v["number-columns-repeated"]||"1",10),g={t:"z",v:null},v.formula&&t.cellFormula!=!1&&(g.f=Wy(Pt(v.formula))),(v.||v["value-type"])=="string"&&(g.t="s",g.v=Pt(v["string-value"]||""),t.dense?(p[y]||(p[y]=[]),p[y][b]=g):p[it({r:y,c:b})]=g),b+=K-1;else if(m[1]!=="/"){++b,w="",x=0,S=[],K=1;var de=z?y+z-1:y;if(b>O.e.c&&(O.e.c=b),b<O.s.c&&(O.s.c=b),y<O.s.r&&(O.s.r=y),de>O.e.r&&(O.e.r=de),v=at(m[0],!1),ae=[],E={},g={t:v.||v["value-type"],v:null},t.cellFormula)if(v.formula&&(v.formula=Pt(v.formula)),v["number-matrix-columns-spanned"]&&v["number-matrix-rows-spanned"]&&(_=parseInt(v["number-matrix-rows-spanned"],10)||0,N=parseInt(v["number-matrix-columns-spanned"],10)||0,A={s:{r:y,c:b},e:{r:y+_-1,c:b+N-1}},g.F=ht(A),re.push([A,g.F])),v.formula)g.f=Wy(v.formula);else for(ne=0;ne<re.length;++ne)y>=re[ne][0].s.r&&y<=re[ne][0].e.r&&b>=re[ne][0].s.c&&b<=re[ne][0].e.c&&(g.F=re[ne][1]);switch((v["number-columns-spanned"]||v["number-rows-spanned"])&&(_=parseInt(v["number-rows-spanned"],10)||0,N=parseInt(v["number-columns-spanned"],10)||0,A={s:{r:y,c:b},e:{r:y+_-1,c:b+N-1}},Q.push(A)),v["number-columns-repeated"]&&(K=parseInt(v["number-columns-repeated"],10)),g.t){case"boolean":g.t="b",g.v=fr(v["boolean-value"]);break;case"float":g.t="n",g.v=parseFloat(v.value);break;case"percentage":g.t="n",g.v=parseFloat(v.value);break;case"currency":g.t="n",g.v=parseFloat(v.value);break;case"date":g.t="d",g.v=hr(v["date-value"]),t.cellDates||(g.t="n",g.v=Vr(g.v)),g.z="m/d/yy";break;case"time":g.t="n",g.v=oF(v["time-value"])/86400,t.cellDates&&(g.t="d",g.v=C0(g.v)),g.z="HH:MM:SS";break;case"number":g.t="n",g.v=parseFloat(v.);break;default:if(g.t==="string"||g.t==="text"||!g.t)g.t="s",v["string-value"]!=null&&(w=Pt(v["string-value"]),S=[]);else throw new Error("Unsupported value type "+g.t)}}else{if(Z=!1,g.t==="s"&&(g.v=w||"",S.length&&(g.R=S),Z=x==0),V.Target&&(g.l=V),ae.length>0&&(g.c=ae,ae=[]),w&&t.cellText!==!1&&(g.w=w),Z&&(g.t="z",delete g.v),(!Z||t.sheetStubs)&&!(t.sheetRows&&t.sheetRows<=y))for(var fe=0;fe<z;++fe){if(K=parseInt(v["number-columns-repeated"]||"1",10),t.dense)for(p[y+fe]||(p[y+fe]=[]),p[y+fe][b]=fe==0?g:Kt(g);--K>0;)p[y+fe][b+K]=Kt(g);else for(p[it({r:y+fe,c:b})]=g;--K>0;)p[it({r:y+fe,c:b+K})]=Kt(g);O.e.c<=b&&(O.e.c=b)}K=parseInt(v["number-columns-repeated"]||"1",10),b+=K-1,K=0,g={},w="",S=[]}V={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(m[1]==="/"){if((s=i.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&i.push([m[3],!0]);break;case"annotation":if(m[1]==="/"){if((s=i.pop())[0]!==m[3])throw"Bad state: "+s;E.t=w,S.length&&(E.R=S),E.a=L,ae.push(E)}else m[0].charAt(m[0].length-2)!=="/"&&i.push([m[3],!1]);L="",I=0,w="",x=0,S=[];break;case"creator":m[1]==="/"?L=n.slice(I,m.index):I=m.index+m[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(m[1]==="/"){if((s=i.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&i.push([m[3],!1]);w="",x=0,S=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(m[1]==="/"){if(k[o.name]=l,(s=i.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&(l="",o=at(m[0],!1),i.push([m[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":a=at(m[0],!1),l+=jy[m[3]][a.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":a=at(m[0],!1),l+=jy[m[3]][a.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(m[0].slice(-2)==="/>")break;if(m[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(f,m.index);break}else f=m.index+m[0].length;break;case"named-range":a=at(m[0],!1),he=vp(a["cell-range-address"]);var pe={Name:a.name,Ref:he[0]+"!"+he[1]};ee&&(pe.Sheet=d.length),ge.Names.push(pe);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(m[1]==="/"&&(!v||!v["string-value"])){var Me=E7(n.slice(x,m.index));w=(w.length>0?w+`
`:"")+Me[0]}else at(m[0],!1),x=m.index+m[0].length;break;case"s":break;case"database-range":if(m[1]==="/")break;try{he=vp(at(m[0])["target-range-address"]),u[he[0]]["!autofilter"]={ref:he[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(m[1]!=="/"){if(V=at(m[0],!1),!V.href)break;V.Target=Pt(V.href),delete V.href,V.Target.charAt(0)=="#"&&V.Target.indexOf(".")>-1?(he=vp(V.Target.slice(1)),V.Target="#"+he[0]+"!"+he[1]):V.Target.match(/^\.\.[\\\/]/)&&(V.Target=V.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(m[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(t.WTF)throw new Error(m)}}var q={Sheets:u,SheetNames:d,Workbook:ge};return t.bookSheets&&delete q.Sheets,q}function zy(r,e){e=e||{},vi(r,"META-INF/manifest.xml")&&o$(Nr(r,"META-INF/manifest.xml"),e);var t=ti(r,"content.xml");if(!t)throw new Error("Missing content.xml in ODS / UOF file");var n=zT(qt(t),e);return vi(r,"meta.xml")&&(n.Props=$S(Nr(r,"meta.xml"))),n}function Gy(r,e){return zT(r,e)}var P7=function(){var r=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+Cc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+r+"</office:document-styles>";return function(){return Rr+e}}(),Hy=function(){var r=function(s){return Ut(s).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,t=`          <table:covered-table-cell/>
`,n=function(s,a,o){var l=[];l.push('      <table:table table:name="'+Ut(a.SheetNames[o])+`" table:style-name="ta1">
`);var f=0,c=0,h=Dn(s["!ref"]||"A1"),u=s["!merges"]||[],d=0,p=Array.isArray(s);if(s["!cols"])for(c=0;c<=h.e.c;++c)l.push("        <table:table-column"+(s["!cols"][c]?' table:style-name="co'+s["!cols"][c].ods+'"':"")+`></table:table-column>
`);var m="",g=s["!rows"]||[];for(f=0;f<h.s.r;++f)m=g[f]?' table:style-name="ro'+g[f].ods+'"':"",l.push("        <table:table-row"+m+`></table:table-row>
`);for(;f<=h.e.r;++f){for(m=g[f]?' table:style-name="ro'+g[f].ods+'"':"",l.push("        <table:table-row"+m+`>
`),c=0;c<h.s.c;++c)l.push(e);for(;c<=h.e.c;++c){var v=!1,w={},x="";for(d=0;d!=u.length;++d)if(!(u[d].s.c>c)&&!(u[d].s.r>f)&&!(u[d].e.c<c)&&!(u[d].e.r<f)){(u[d].s.c!=c||u[d].s.r!=f)&&(v=!0),w["table:number-columns-spanned"]=u[d].e.c-u[d].s.c+1,w["table:number-rows-spanned"]=u[d].e.r-u[d].s.r+1;break}if(v){l.push(t);continue}var S=it({r:f,c}),y=p?(s[f]||[])[c]:s[S];if(y&&y.f&&(w["table:formula"]=Ut(tI(y.f)),y.F&&y.F.slice(0,S.length)==S)){var b=Dn(y.F);w["table:number-matrix-columns-spanned"]=b.e.c-b.s.c+1,w["table:number-matrix-rows-spanned"]=b.e.r-b.s.r+1}if(!y){l.push(e);continue}switch(y.t){case"b":x=y.v?"TRUE":"FALSE",w["office:value-type"]="boolean",w["office:boolean-value"]=y.v?"true":"false";break;case"n":x=y.w||String(y.v||0),w["office:value-type"]="float",w["office:value"]=y.v||0;break;case"s":case"str":x=y.v==null?"":y.v,w["office:value-type"]="string";break;case"d":x=y.w||hr(y.v).toISOString(),w["office:value-type"]="date",w["office:date-value"]=hr(y.v).toISOString(),w["table:style-name"]="ce1";break;default:l.push(e);continue}var O=r(x);if(y.l&&y.l.Target){var T=y.l.Target;T=T.charAt(0)=="#"?"#"+rI(T.slice(1)):T,T.charAt(0)!="#"&&!T.match(/^\w+:/)&&(T="../"+T),O=Fe("text:a",O,{"xlink:href":T.replace(/&/g,"&amp;")})}l.push("          "+Fe("table:table-cell",Fe("text:p",O,{}),w)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},i=function(s,a){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;a.SheetNames.map(function(f){return a.Sheets[f]}).forEach(function(f){if(f&&f["!cols"]){for(var c=0;c<f["!cols"].length;++c)if(f["!cols"][c]){var h=f["!cols"][c];if(h.width==null&&h.wpx==null&&h.wch==null)continue;$a(h),h.ods=o;var u=f["!cols"][c].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+u+`"/>
`),s.push(`  </style:style>
`),++o}}});var l=0;a.SheetNames.map(function(f){return a.Sheets[f]}).forEach(function(f){if(f&&f["!rows"]){for(var c=0;c<f["!rows"].length;++c)if(f["!rows"][c]){f["!rows"][c].ods=l;var h=f["!rows"][c].hpx+"px";s.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+h+`"/>
`),s.push(`  </style:style>
`),++l}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(a,o){var l=[Rr],f=Cc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),c=Cc({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+f+c+`>
`),l.push(FS().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+f+`>
`),i(l,a),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var h=0;h!=a.SheetNames.length;++h)l.push(n(a.Sheets[a.SheetNames[h]],a,h));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function GT(r,e){if(e.bookType=="fods")return Hy(r,e);var t=OO(),n="",i=[],s=[];return n="mimetype",dt(t,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",dt(t,n,Hy(r,e)),i.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",dt(t,n,P7(r,e)),i.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",dt(t,n,Rr+FS()),i.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",dt(t,n,c$(s)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",dt(t,n,l$(i)),t}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Qo(r){return new DataView(r.buffer,r.byteOffset,r.byteLength)}function Jm(r){return typeof TextDecoder<"u"?new TextDecoder().decode(r):qt(Va(r))}function R7(r){return typeof TextEncoder<"u"?new TextEncoder().encode(r):ei(gs(r))}function Q7(r,e){e:for(var t=0;t<=r.length-e.length;++t){for(var n=0;n<e.length;++n)if(r[t+n]!=e[n])continue e;return!0}return!1}function Da(r){var e=r.reduce(function(i,s){return i+s.length},0),t=new Uint8Array(e),n=0;return r.forEach(function(i){t.set(i,n),n+=i.length}),t}function Yy(r){return r-=r>>1&1431655765,r=(r&858993459)+(r>>2&858993459),(r+(r>>4)&252645135)*16843009>>>24}function F7(r,e){for(var t=(r[e+15]&127)<<7|r[e+14]>>1,n=r[e+14]&1,i=e+13;i>=e;--i)n=n*256+r[i];return(r[e+15]&128?-n:n)*Math.pow(10,t-6176)}function $7(r,e,t){var n=Math.floor(t==0?0:Math.LOG10E*Math.log(Math.abs(t)))+6176-20,i=t/Math.pow(10,n-6176);r[e+15]|=n>>7,r[e+14]|=(n&127)<<1;for(var s=0;i>=1;++s,i/=256)r[e+s]=i&255;r[e+15]|=t>=0?0:128}function Nc(r,e){var t=e?e[0]:0,n=r[t]&127;e:if(r[t++]>=128&&(n|=(r[t]&127)<<7,r[t++]<128||(n|=(r[t]&127)<<14,r[t++]<128)||(n|=(r[t]&127)<<21,r[t++]<128)||(n+=(r[t]&127)*Math.pow(2,28),++t,r[t++]<128)||(n+=(r[t]&127)*Math.pow(2,35),++t,r[t++]<128)||(n+=(r[t]&127)*Math.pow(2,42),++t,r[t++]<128)))break e;return e&&(e[0]=t),n}function Zt(r){var e=new Uint8Array(7);e[0]=r&127;var t=1;e:if(r>127){if(e[t-1]|=128,e[t]=r>>7&127,++t,r<=16383||(e[t-1]|=128,e[t]=r>>14&127,++t,r<=2097151)||(e[t-1]|=128,e[t]=r>>21&127,++t,r<=268435455)||(e[t-1]|=128,e[t]=r/256>>>21&127,++t,r<=34359738367)||(e[t-1]|=128,e[t]=r/65536>>>21&127,++t,r<=4398046511103))break e;e[t-1]|=128,e[t]=r/16777216>>>21&127,++t}return e.slice(0,t)}function Sr(r){var e=0,t=r[e]&127;e:if(r[e++]>=128){if(t|=(r[e]&127)<<7,r[e++]<128||(t|=(r[e]&127)<<14,r[e++]<128)||(t|=(r[e]&127)<<21,r[e++]<128))break e;t|=(r[e]&127)<<28}return t}function $t(r){for(var e=[],t=[0];t[0]<r.length;){var n=t[0],i=Nc(r,t),s=i&7;i=Math.floor(i/8);var a=0,o;if(i==0)break;switch(s){case 0:{for(var l=t[0];r[t[0]++]>=128;);o=r.slice(l,t[0])}break;case 5:a=4,o=r.slice(t[0],t[0]+a),t[0]+=a;break;case 1:a=8,o=r.slice(t[0],t[0]+a),t[0]+=a;break;case 2:a=Nc(r,t),o=r.slice(t[0],t[0]+a),t[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var f={data:o,type:s};e[i]==null?e[i]=[f]:e[i].push(f)}return e}function en(r){var e=[];return r.forEach(function(t,n){t.forEach(function(i){i.data&&(e.push(Zt(n*8+i.type)),i.type==2&&e.push(Zt(i.data.length)),e.push(i.data))})}),Da(e)}function GO(r,e){return(r==null?void 0:r.map(function(t){return e(t.data)}))||[]}function Oi(r){for(var e,t=[],n=[0];n[0]<r.length;){var i=Nc(r,n),s=$t(r.slice(n[0],n[0]+i));n[0]+=i;var a={id:Sr(s[1][0].data),messages:[]};s[2].forEach(function(o){var l=$t(o.data),f=Sr(l[3][0].data);a.messages.push({meta:l,data:r.slice(n[0],n[0]+f)}),n[0]+=f}),(e=s[3])!=null&&e[0]&&(a.merge=Sr(s[3][0].data)>>>0>0),t.push(a)}return t}function nl(r){var e=[];return r.forEach(function(t){var n=[];n[1]=[{data:Zt(t.id),type:0}],n[2]=[],t.merge!=null&&(n[3]=[{data:Zt(+!!t.merge),type:0}]);var i=[];t.messages.forEach(function(a){i.push(a.data),a.meta[3]=[{type:0,data:Zt(a.data.length)}],n[2].push({data:en(a.meta),type:2})});var s=en(n);e.push(Zt(s.length)),e.push(s),i.forEach(function(a){return e.push(a)})}),Da(e)}function N7(r,e){if(r!=0)throw new Error("Unexpected Snappy chunk type ".concat(r));for(var t=[0],n=Nc(e,t),i=[];t[0]<e.length;){var s=e[t[0]]&3;if(s==0){var a=e[t[0]++]>>2;if(a<60)++a;else{var o=a-59;a=e[t[0]],o>1&&(a|=e[t[0]+1]<<8),o>2&&(a|=e[t[0]+2]<<16),o>3&&(a|=e[t[0]+3]<<24),a>>>=0,a++,t[0]+=o}i.push(e.slice(t[0],t[0]+a)),t[0]+=a;continue}else{var l=0,f=0;if(s==1?(f=(e[t[0]]>>2&7)+4,l=(e[t[0]++]&224)<<3,l|=e[t[0]++]):(f=(e[t[0]++]>>2)+1,s==2?(l=e[t[0]]|e[t[0]+1]<<8,t[0]+=2):(l=(e[t[0]]|e[t[0]+1]<<8|e[t[0]+2]<<16|e[t[0]+3]<<24)>>>0,t[0]+=4)),i=[Da(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(f>=l)for(i.push(i[0].slice(-l)),f-=l;f>=i[i.length-1].length;)i.push(i[i.length-1]),f-=i[i.length-1].length;i.push(i[0].slice(-l,-l+f))}}var c=Da(i);if(c.length!=n)throw new Error("Unexpected length: ".concat(c.length," != ").concat(n));return c}function xi(r){for(var e=[],t=0;t<r.length;){var n=r[t++],i=r[t]|r[t+1]<<8|r[t+2]<<16;t+=3,e.push(N7(n,r.slice(t,t+i))),t+=i}if(t!==r.length)throw new Error("data is not a valid framed stream!");return Da(e)}function il(r){for(var e=[],t=0;t<r.length;){var n=Math.min(r.length-t,268435455),i=new Uint8Array(4);e.push(i);var s=Zt(n),a=s.length;e.push(s),n<=60?(a++,e.push(new Uint8Array([n-1<<2]))):n<=256?(a+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(a+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(a+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(a+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(r.slice(t,t+n)),a+=n,i[0]=0,i[1]=a&255,i[2]=a>>8&255,i[3]=a>>16&255,t+=n}return Da(e)}function D7(r,e,t,n){var i=Qo(r),s=i.getUint32(4,!0),a=(n>1?12:8)+Yy(s&(n>1?3470:398))*4,o=-1,l=-1,f=NaN,c=new Date(2001,0,1);s&512&&(o=i.getUint32(a,!0),a+=4),a+=Yy(s&(n>1?12288:4096))*4,s&16&&(l=i.getUint32(a,!0),a+=4),s&32&&(f=i.getFloat64(a,!0),a+=8),s&64&&(c.setTime(c.getTime()+i.getFloat64(a,!0)*1e3),a+=8);var h;switch(r[2]){case 0:break;case 2:h={t:"n",v:f};break;case 3:h={t:"s",v:e[l]};break;case 5:h={t:"d",v:c};break;case 6:h={t:"b",v:f>0};break;case 7:h={t:"n",v:f/86400};break;case 8:h={t:"e",v:0};break;case 9:if(o>-1)h={t:"s",v:t[o]};else if(l>-1)h={t:"s",v:e[l]};else if(!isNaN(f))h={t:"n",v:f};else throw new Error("Unsupported cell type ".concat(r.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(r.slice(0,4)))}return h}function M7(r,e,t){var n=Qo(r),i=n.getUint32(8,!0),s=12,a=-1,o=-1,l=NaN,f=NaN,c=new Date(2001,0,1);i&1&&(l=F7(r,s),s+=16),i&2&&(f=n.getFloat64(s,!0),s+=8),i&4&&(c.setTime(c.getTime()+n.getFloat64(s,!0)*1e3),s+=8),i&8&&(o=n.getUint32(s,!0),s+=4),i&16&&(a=n.getUint32(s,!0),s+=4);var h;switch(r[1]){case 0:break;case 2:h={t:"n",v:l};break;case 3:h={t:"s",v:e[o]};break;case 5:h={t:"d",v:c};break;case 6:h={t:"b",v:f>0};break;case 7:h={t:"n",v:f/86400};break;case 8:h={t:"e",v:0};break;case 9:if(a>-1)h={t:"s",v:t[a]};else throw new Error("Unsupported cell type ".concat(r[1]," : ").concat(i&31," : ").concat(r.slice(0,4)));break;case 10:h={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(r[1]," : ").concat(i&31," : ").concat(r.slice(0,4)))}return h}function wp(r,e){var t=new Uint8Array(32),n=Qo(t),i=12,s=0;switch(t[0]=5,r.t){case"n":t[1]=2,$7(t,i,r.v),s|=1,i+=16;break;case"b":t[1]=6,n.setFloat64(i,r.v?1:0,!0),s|=2,i+=8;break;case"s":if(e.indexOf(r.v)==-1)throw new Error("Value ".concat(r.v," missing from SST!"));t[1]=3,n.setUint32(i,e.indexOf(r.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+r.t}return n.setUint32(8,s,!0),t.slice(0,i)}function bp(r,e){var t=new Uint8Array(32),n=Qo(t),i=12,s=0;switch(t[0]=3,r.t){case"n":t[2]=2,n.setFloat64(i,r.v,!0),s|=32,i+=8;break;case"b":t[2]=6,n.setFloat64(i,r.v?1:0,!0),s|=32,i+=8;break;case"s":if(e.indexOf(r.v)==-1)throw new Error("Value ".concat(r.v," missing from SST!"));t[2]=3,n.setUint32(i,e.indexOf(r.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+r.t}return n.setUint32(4,s,!0),t.slice(0,i)}function I7(r,e,t){switch(r[0]){case 0:case 1:case 2:case 3:return D7(r,e,t,r[0]);case 5:return M7(r,e,t);default:throw new Error("Unsupported payload version ".concat(r[0]))}}function mn(r){var e=$t(r);return Nc(e[1][0].data)}function Ky(r,e){var t=$t(e.data),n=Sr(t[1][0].data),i=t[3],s=[];return(i||[]).forEach(function(a){var o=$t(a.data),l=Sr(o[1][0].data)>>>0;switch(n){case 1:s[l]=Jm(o[3][0].data);break;case 8:{var f=r[mn(o[9][0].data)][0],c=$t(f.data),h=r[mn(c[1][0].data)][0],u=Sr(h.meta[1][0].data);if(u!=2001)throw new Error("2000 unexpected reference to ".concat(u));var d=$t(h.data);s[l]=d[3].map(function(p){return Jm(p.data)}).join("")}break}}),s}function L7(r,e){var t,n,i,s,a,o,l,f,c,h,u,d,p,m,g=$t(r),v=Sr(g[1][0].data)>>>0,w=Sr(g[2][0].data)>>>0,x=((n=(t=g[8])==null?void 0:t[0])==null?void 0:n.data)&&Sr(g[8][0].data)>0||!1,S,y;if((s=(i=g[7])==null?void 0:i[0])!=null&&s.data&&e!=0)S=(o=(a=g[7])==null?void 0:a[0])==null?void 0:o.data,y=(f=(l=g[6])==null?void 0:l[0])==null?void 0:f.data;else if((h=(c=g[4])==null?void 0:c[0])!=null&&h.data&&e!=1)S=(d=(u=g[4])==null?void 0:u[0])==null?void 0:d.data,y=(m=(p=g[3])==null?void 0:p[0])==null?void 0:m.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var b=x?4:1,O=Qo(S),T=[],k=0;k<S.length/2;++k){var Q=O.getUint16(k*2,!0);Q<65535&&T.push([k,Q])}if(T.length!=w)throw"Expected ".concat(w," cells, found ").concat(T.length);var A=[];for(k=0;k<T.length-1;++k)A[T[k][0]]=y.subarray(T[k][1]*b,T[k+1][1]*b);return T.length>=1&&(A[T[T.length-1][0]]=y.subarray(T[T.length-1][1]*b)),{R:v,cells:A}}function B7(r,e){var t,n=$t(e.data),i=(t=n==null?void 0:n[7])!=null&&t[0]?Sr(n[7][0].data)>>>0>0?1:0:-1,s=GO(n[5],function(a){return L7(a,i)});return{nrows:Sr(n[4][0].data)>>>0,data:s.reduce(function(a,o){return a[o.R]||(a[o.R]=[]),o.cells.forEach(function(l,f){if(a[o.R][f])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(f));a[o.R][f]=l}),a},[])}}function Z7(r,e,t){var n,i=$t(e.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Sr(i[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(s.e.c=(Sr(i[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));t["!ref"]=ht(s);var a=$t(i[4][0].data),o=Ky(r,r[mn(a[4][0].data)][0]),l=(n=a[17])!=null&&n[0]?Ky(r,r[mn(a[17][0].data)][0]):[],f=$t(a[3][0].data),c=0;f[1].forEach(function(h){var u=$t(h.data),d=r[mn(u[2][0].data)][0],p=Sr(d.meta[1][0].data);if(p!=6002)throw new Error("6001 unexpected reference to ".concat(p));var m=B7(r,d);m.data.forEach(function(g,v){g.forEach(function(w,x){var S=it({r:c+v,c:x}),y=I7(w,o,l);y&&(t[S]=y)})}),c+=m.nrows})}function W7(r,e){var t=$t(e.data),n={"!ref":"A1"},i=r[mn(t[2][0].data)],s=Sr(i[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return Z7(r,i[0],n),n}function U7(r,e){var t,n=$t(e.data),i={name:(t=n[1])!=null&&t[0]?Jm(n[1][0].data):"",sheets:[]},s=GO(n[2],mn);return s.forEach(function(a){r[a].forEach(function(o){var l=Sr(o.meta[1][0].data);l==6e3&&i.sheets.push(W7(r,o))})}),i}function X7(r,e){var t=rx(),n=$t(e.data),i=GO(n[1],mn);if(i.forEach(function(s){r[s].forEach(function(a){var o=Sr(a.meta[1][0].data);if(o==2){var l=U7(r,a);l.sheets.forEach(function(f,c){nx(t,f,c==0?l.name:l.name+"_"+c,!0)})}})}),t.SheetNames.length==0)throw new Error("Empty NUMBERS file");return t}function _p(r){var e,t,n,i,s={},a=[];if(r.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),r.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var f;try{f=xi(l.content)}catch(h){return console.log("?? "+l.content.length+" "+(h.message||h))}var c;try{c=Oi(f)}catch(h){return console.log("## "+(h.message||h))}c.forEach(function(h){s[h.id]=h.messages,a.push(h.id)})}}),!a.length)throw new Error("File has no messages");var o=((i=(n=(t=(e=s==null?void 0:s[1])==null?void 0:e[0])==null?void 0:t.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&Sr(s[1][0].meta[1][0].data)==1&&s[1][0];if(o||a.forEach(function(l){s[l].forEach(function(f){var c=Sr(f.meta[1][0].data)>>>0;if(c==1)if(!o)o=f;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return X7(s,o)}function V7(r,e,t){var n,i,s,a;if(!((n=r[6])!=null&&n[0])||!((i=r[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var o=((a=(s=r[8])==null?void 0:s[0])==null?void 0:a.data)&&Sr(r[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,f=Qo(r[7][0].data),c=0,h=[],u=Qo(r[4][0].data),d=0,p=[],m=0;m<e.length;++m){if(e[m]==null){f.setUint16(m*2,65535,!0),u.setUint16(m*2,65535);continue}f.setUint16(m*2,c,!0),u.setUint16(m*2,d,!0);var g,v;switch(typeof e[m]){case"string":g=wp({t:"s",v:e[m]},t),v=bp({t:"s",v:e[m]},t);break;case"number":g=wp({t:"n",v:e[m]},t),v=bp({t:"n",v:e[m]},t);break;case"boolean":g=wp({t:"b",v:e[m]},t),v=bp({t:"b",v:e[m]},t);break;default:throw new Error("Unsupported value "+e[m])}h.push(g),c+=g.length,p.push(v),d+=v.length,++l}for(r[2][0].data=Zt(l);m<r[7][0].data.length/2;++m)f.setUint16(m*2,65535,!0),u.setUint16(m*2,65535,!0);return r[6][0].data=Da(h),r[3][0].data=Da(p),l}function q7(r,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var t=r.Sheets[r.SheetNames[0]];r.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Dn(t["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(ht(n)));var s=Qd(t,{range:n,header:1}),a=["~Sh33tJ5~"];s.forEach(function(L){return L.forEach(function(I){typeof I=="string"&&a.push(I)})});var o={},l=[],f=Ye.read(e.numbers,{type:"base64"});f.FileIndex.map(function(L,I){return[L,f.FullPaths[I]]}).forEach(function(L){var I=L[0],Z=L[1];if(I.type==2&&I.name.match(/\.iwa/)){var ee=I.content,ne=xi(ee),de=Oi(ne);de.forEach(function(fe){l.push(fe.id),o[fe.id]={deps:[],location:Z,type:Sr(fe.messages[0].meta[1][0].data)}})}}),l.sort(function(L,I){return L-I});var c=l.filter(function(L){return L>1}).map(function(L){return[L,Zt(L)]});f.FileIndex.map(function(L,I){return[L,f.FullPaths[I]]}).forEach(function(L){var I=L[0];if(L[1],!!I.name.match(/\.iwa/)){var Z=Oi(xi(I.content));Z.forEach(function(ee){ee.messages.forEach(function(ne){c.forEach(function(de){ee.messages.some(function(fe){return Sr(fe.meta[1][0].data)!=11006&&Q7(fe.data,de[1])})&&o[de[0]].deps.push(ee.id)})})})}});for(var h=Ye.find(f,o[1].location),u=Oi(xi(h.content)),d,p=0;p<u.length;++p){var m=u[p];m.id==1&&(d=m)}var g=mn($t(d.messages[0].data)[1][0].data);for(h=Ye.find(f,o[g].location),u=Oi(xi(h.content)),p=0;p<u.length;++p)m=u[p],m.id==g&&(d=m);for(g=mn($t(d.messages[0].data)[2][0].data),h=Ye.find(f,o[g].location),u=Oi(xi(h.content)),p=0;p<u.length;++p)m=u[p],m.id==g&&(d=m);for(g=mn($t(d.messages[0].data)[2][0].data),h=Ye.find(f,o[g].location),u=Oi(xi(h.content)),p=0;p<u.length;++p)m=u[p],m.id==g&&(d=m);var v=$t(d.messages[0].data);{v[6][0].data=Zt(n.e.r+1),v[7][0].data=Zt(n.e.c+1);var w=mn(v[46][0].data),x=Ye.find(f,o[w].location),S=Oi(xi(x.content));{for(var y=0;y<S.length&&S[y].id!=w;++y);if(S[y].id!=w)throw"Bad ColumnRowUIDMapArchive";var b=$t(S[y].messages[0].data);b[1]=[],b[2]=[],b[3]=[];for(var O=0;O<=n.e.c;++O){var T=[];T[1]=T[2]=[{type:0,data:Zt(O+420690)}],b[1].push({type:2,data:en(T)}),b[2].push({type:0,data:Zt(O)}),b[3].push({type:0,data:Zt(O)})}b[4]=[],b[5]=[],b[6]=[];for(var k=0;k<=n.e.r;++k)T=[],T[1]=T[2]=[{type:0,data:Zt(k+726270)}],b[4].push({type:2,data:en(T)}),b[5].push({type:0,data:Zt(k)}),b[6].push({type:0,data:Zt(k)});S[y].messages[0].data=en(b)}x.content=il(nl(S)),x.size=x.content.length,delete v[46];var Q=$t(v[4][0].data);{Q[7][0].data=Zt(n.e.r+1);var A=$t(Q[1][0].data),_=mn(A[2][0].data);x=Ye.find(f,o[_].location),S=Oi(xi(x.content));{if(S[0].id!=_)throw"Bad HeaderStorageBucket";var N=$t(S[0].messages[0].data);for(k=0;k<s.length;++k){var U=$t(N[2][0].data);U[1][0].data=Zt(k),U[4][0].data=Zt(s[k].length),N[2][k]={type:N[2][0].type,data:en(U)}}S[0].messages[0].data=en(N)}x.content=il(nl(S)),x.size=x.content.length;var z=mn(Q[2][0].data);x=Ye.find(f,o[z].location),S=Oi(xi(x.content));{if(S[0].id!=z)throw"Bad HeaderStorageBucket";for(N=$t(S[0].messages[0].data),O=0;O<=n.e.c;++O)U=$t(N[2][0].data),U[1][0].data=Zt(O),U[4][0].data=Zt(n.e.r+1),N[2][O]={type:N[2][0].type,data:en(U)};S[0].messages[0].data=en(N)}x.content=il(nl(S)),x.size=x.content.length;var K=mn(Q[4][0].data);(function(){for(var L=Ye.find(f,o[K].location),I=Oi(xi(L.content)),Z,ee=0;ee<I.length;++ee){var ne=I[ee];ne.id==K&&(Z=ne)}var de=$t(Z.messages[0].data);{de[3]=[];var fe=[];a.forEach(function(q,He){fe[1]=[{type:0,data:Zt(He)}],fe[2]=[{type:0,data:Zt(1)}],fe[3]=[{type:2,data:R7(q)}],de[3].push({type:2,data:en(fe)})})}Z.messages[0].data=en(de);var pe=nl(I),Me=il(pe);L.content=Me,L.size=L.content.length})();var re=$t(Q[3][0].data);{var ge=re[1][0];delete re[2];var V=$t(ge.data);{var he=mn(V[2][0].data);(function(){for(var L=Ye.find(f,o[he].location),I=Oi(xi(L.content)),Z,ee=0;ee<I.length;++ee){var ne=I[ee];ne.id==he&&(Z=ne)}var de=$t(Z.messages[0].data);{delete de[6],delete re[7];var fe=new Uint8Array(de[5][0].data);de[5]=[];for(var pe=0,Me=0;Me<=n.e.r;++Me){var q=$t(fe);pe+=V7(q,s[Me],a),q[1][0].data=Zt(Me),de[5].push({data:en(q),type:2})}de[1]=[{type:0,data:Zt(n.e.c+1)}],de[2]=[{type:0,data:Zt(n.e.r+1)}],de[3]=[{type:0,data:Zt(pe)}],de[4]=[{type:0,data:Zt(n.e.r+1)}]}Z.messages[0].data=en(de);var He=nl(I),Ve=il(He);L.content=Ve,L.size=L.content.length})()}ge.data=en(V)}Q[3][0].data=en(re)}v[4][0].data=en(Q)}d.messages[0].data=en(v);var ae=nl(u),E=il(ae);return h.content=E,h.size=h.content.length,f}function HT(r){return function(t){for(var n=0;n!=r.length;++n){var i=r[n];t[i[0]]===void 0&&(t[i[0]]=i[1]),i[2]==="n"&&(t[i[0]]=Number(t[i[0]]))}}}function HO(r){HT([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(r)}function YO(r){HT([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(r)}function j7(r){return yt.WS.indexOf(r)>-1?"sheet":r==yt.CS?"chart":r==yt.DS?"dialog":r==yt.MS?"macro":r&&r.length?r:"sheet"}function z7(r,e){if(!r)return 0;try{r=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,r["!id"][n.id].Target,j7(r["!id"][n.id].Type)]})}catch{return null}return!r||r.length===0?null:r}function G7(r,e,t,n,i,s,a,o,l,f,c,h){try{s[n]=uc(ti(r,t,!0),e);var u=Nr(r,e),d;switch(o){case"sheet":d=wB(u,e,i,l,s[n],f,c,h);break;case"chart":if(d=bB(u,e,i,l,s[n],f,c,h),!d||!d["!drawel"])break;var p=Wf(d["!drawel"].Target,e),m=Ec(p),g=f6(ti(r,p,!0),uc(ti(r,m,!0),p)),v=Wf(g,p),w=Ec(v);d=HL(ti(r,v,!0),v,l,uc(ti(r,w,!0),v),f,d);break;case"macro":d=_B(u,e,i,l,s[n],f,c,h);break;case"dialog":d=kB(u,e,i,l,s[n],f,c,h);break;default:throw new Error("Unrecognized sheet type "+o)}a[n]=d;var x=[];s&&s[n]&&Tr(s[n]).forEach(function(S){var y="";if(s[n][S].Type==yt.CMNT){y=Wf(s[n][S].Target,e);var b=AB(Nr(r,y,!0),y,l);if(!b||!b.length)return;My(d,b,!1)}s[n][S].Type==yt.TCMNT&&(y=Wf(s[n][S].Target,e),x=x.concat(h6(Nr(r,y,!0),l)))}),x&&x.length&&My(d,x,!0,l.people||[])}catch(S){if(l.WTF)throw S}}function mi(r){return r.charAt(0)=="/"?r.slice(1):r}function YT(r,e){if(ff(),e=e||{},HO(e),vi(r,"META-INF/manifest.xml")||vi(r,"objectdata.xml"))return zy(r,e);if(vi(r,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof _p<"u"){if(r.FileIndex)return _p(r);var t=Ye.utils.cfb_new();return iy(r).forEach(function(U){dt(t,U,uF(r,U))}),_p(t)}throw new Error("Unsupported NUMBERS file")}if(!vi(r,"[Content_Types].xml"))throw vi(r,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):vi(r,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=iy(r),i=s$(ti(r,"[Content_Types].xml")),s=!1,a,o;if(i.workbooks.length===0&&(o="xl/workbook.xml",Nr(r,o,!0)&&i.workbooks.push(o)),i.workbooks.length===0){if(o="xl/workbook.bin",!Nr(r,o,!0))throw new Error("Could not find workbook");i.workbooks.push(o),s=!0}i.workbooks[0].slice(-3)=="bin"&&(s=!0);var l={},f={};if(!e.bookSheets&&!e.bookProps){if(dc=[],i.sst)try{dc=CB(Nr(r,mi(i.sst)),i.sst,e)}catch(U){if(e.WTF)throw U}e.cellStyles&&i.themes.length&&(l=TB(ti(r,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],e)),i.style&&(f=SB(Nr(r,mi(i.style)),i.style,l,e))}i.links.map(function(U){try{var z=uc(ti(r,Ec(mi(U))),U);return PB(Nr(r,mi(U)),z,U,e)}catch{}});var c=yB(Nr(r,mi(i.workbooks[0])),i.workbooks[0],e),h={},u="";i.coreprops.length&&(u=Nr(r,mi(i.coreprops[0]),!0),u&&(h=$S(u)),i.extprops.length!==0&&(u=Nr(r,mi(i.extprops[0]),!0),u&&u$(u,h,e)));var d={};(!e.bookSheets||e.bookProps)&&i.custprops.length!==0&&(u=ti(r,mi(i.custprops[0]),!0),u&&(d=p$(u,e)));var p={};if((e.bookSheets||e.bookProps)&&(c.Sheets?a=c.Sheets.map(function(z){return z.name}):h.Worksheets&&h.SheetNames.length>0&&(a=h.SheetNames),e.bookProps&&(p.Props=h,p.Custprops=d),e.bookSheets&&typeof a<"u"&&(p.SheetNames=a),e.bookSheets?p.SheetNames:e.bookProps))return p;a={};var m={};e.bookDeps&&i.calcchain&&(m=EB(Nr(r,mi(i.calcchain)),i.calcchain));var g=0,v={},w,x;{var S=c.Sheets;h.Worksheets=S.length,h.SheetNames=[];for(var y=0;y!=S.length;++y)h.SheetNames[y]=S[y].name}var b=s?"bin":"xml",O=i.workbooks[0].lastIndexOf("/"),T=(i.workbooks[0].slice(0,O+1)+"_rels/"+i.workbooks[0].slice(O+1)+".rels").replace(/^\//,"");vi(r,T)||(T="xl/_rels/workbook."+b+".rels");var k=uc(ti(r,T,!0),T.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(e.xlmeta=RB(Nr(r,mi(i.metadata[0])),i.metadata[0],e)),(i.people||[]).length>=1&&(e.people=d6(Nr(r,mi(i.people[0])),e)),k&&(k=z7(k,c.Sheets));var Q=Nr(r,"xl/worksheets/sheet.xml",!0)?1:0;e:for(g=0;g!=h.Worksheets;++g){var A="sheet";if(k&&k[g]?(w="xl/"+k[g][1].replace(/[\/]?xl\//,""),vi(r,w)||(w=k[g][1]),vi(r,w)||(w=T.replace(/_rels\/.*$/,"")+k[g][1]),A=k[g][2]):(w="xl/worksheets/sheet"+(g+1-Q)+"."+b,w=w.replace(/sheet0\./,"sheet.")),x=w.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(g!=e.sheets)continue e;break;case"string":if(h.SheetNames[g].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var _=!1,N=0;N!=e.sheets.length;++N)typeof e.sheets[N]=="number"&&e.sheets[N]==g&&(_=1),typeof e.sheets[N]=="string"&&e.sheets[N].toLowerCase()==h.SheetNames[g].toLowerCase()&&(_=1);if(!_)continue e}}G7(r,w,x,h.SheetNames[g],g,v,a,A,e,c,l,f)}return p={Directory:i,Workbook:c,Props:h,Custprops:d,Deps:m,Sheets:a,SheetNames:h.SheetNames,Strings:dc,Styles:f,Themes:l,SSF:Kt(et)},e&&e.bookFiles&&(r.files?(p.keys=n,p.files=r.files):(p.keys=[],p.files={},r.FullPaths.forEach(function(U,z){U=U.replace(/^Root Entry[\/]/,""),p.keys.push(U),p.files[U]=r.FileIndex[z]}))),e&&e.bookVBA&&(i.vba.length>0?p.vbaraw=Nr(r,mi(i.vba[0]),!0):i.defaults&&i.defaults.bin===w6&&(p.vbaraw=Nr(r,"xl/vbaProject.bin",!0))),p}function H7(r,e){var t=e||{},n="Workbook",i=Ye.find(r,n);try{if(n="/!DataSpaces/Version",i=Ye.find(r,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(QD(i.content),n="/!DataSpaces/DataSpaceMap",i=Ye.find(r,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=$D(i.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=Ye.find(r,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=ND(i.content);if(a.length!=1||a[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=Ye.find(r,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);MD(i.content)}catch{}if(n="/EncryptionInfo",i=Ye.find(r,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=ID(i.content);if(n="/EncryptedPackage",i=Ye.find(r,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],i.content,t.password||"",t);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],i.content,t.password||"",t);throw new Error("File is password-protected")}function Y7(r,e){return e.bookType=="ods"?GT(r,e):e.bookType=="numbers"?q7(r,e):e.bookType=="xlsb"?K7(r,e):KT(r,e)}function K7(r,e){dl=1024,r&&!r.SSF&&(r.SSF=Kt(et)),r&&r.SSF&&(ff(),xh(r.SSF),e.revssf=T0(r.SSF),e.revssf[r.SSF[65535]]=0,e.ssf=r.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,pc?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var t=e.bookType=="xlsb"?"bin":"xml",n=vT.indexOf(e.bookType)>-1,i=NO();YO(e=e||{});var s=OO(),a="",o=0;if(e.cellXfs=[],ja(e.cellXfs,{},{revssf:{General:0}}),r.Props||(r.Props={}),a="docProps/core.xml",dt(s,a,NS(r.Props,e)),i.coreprops.push(a),Wt(e.rels,2,a,yt.CORE_PROPS),a="docProps/app.xml",!(r.Props&&r.Props.SheetNames))if(!r.Workbook||!r.Workbook.Sheets)r.Props.SheetNames=r.SheetNames;else{for(var l=[],f=0;f<r.SheetNames.length;++f)(r.Workbook.Sheets[f]||{}).Hidden!=2&&l.push(r.SheetNames[f]);r.Props.SheetNames=l}for(r.Props.Worksheets=r.Props.SheetNames.length,dt(s,a,IS(r.Props)),i.extprops.push(a),Wt(e.rels,3,a,yt.EXT_PROPS),r.Custprops!==r.Props&&Tr(r.Custprops||{}).length>0&&(a="docProps/custom.xml",dt(s,a,LS(r.Custprops)),i.custprops.push(a),Wt(e.rels,4,a,yt.CUST_PROPS)),o=1;o<=r.SheetNames.length;++o){var c={"!id":{}},h=r.Sheets[r.SheetNames[o-1]],u=(h||{})["!type"]||"sheet";switch(u){case"chart":default:a="xl/worksheets/sheet"+o+"."+t,dt(s,a,FB(o-1,a,e,r,c)),i.sheets.push(a),Wt(e.wbrels,-1,"worksheets/sheet"+o+"."+t,yt.WS[0])}if(h){var d=h["!comments"],p=!1,m="";d&&d.length>0&&(m="xl/comments"+o+"."+t,dt(s,m,DB(d,m)),i.comments.push(m),Wt(c,-1,"../comments"+o+"."+t,yt.CMNT),p=!0),h["!legacy"]&&p&&dt(s,"xl/drawings/vmlDrawing"+o+".vml",OT(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}c["!id"].rId1&&dt(s,Ec(a),_l(c))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+t,dt(s,a,NB(e.Strings,a,e)),i.strs.push(a),Wt(e.wbrels,-1,"sharedStrings."+t,yt.SST)),a="xl/workbook."+t,dt(s,a,QB(r,a)),i.workbooks.push(a),Wt(e.rels,1,a,yt.WB),a="xl/theme/theme1.xml",dt(s,a,ZO(r.Themes,e)),i.themes.push(a),Wt(e.wbrels,-1,"theme/theme1.xml",yt.THEME),a="xl/styles."+t,dt(s,a,$B(r,a,e)),i.styles.push(a),Wt(e.wbrels,-1,"styles."+t,yt.STY),r.vbaraw&&n&&(a="xl/vbaProject.bin",dt(s,a,r.vbaraw),i.vba.push(a),Wt(e.wbrels,-1,"vbaProject.bin",yt.VBA)),a="xl/metadata."+t,dt(s,a,MB(a)),i.metadata.push(a),Wt(e.wbrels,-1,"metadata."+t,yt.XLMETA),dt(s,"[Content_Types].xml",QS(i,e)),dt(s,"_rels/.rels",_l(e.rels)),dt(s,"xl/_rels/workbook."+t+".rels",_l(e.wbrels)),delete e.revssf,delete e.ssf,s}function KT(r,e){dl=1024,r&&!r.SSF&&(r.SSF=Kt(et)),r&&r.SSF&&(ff(),xh(r.SSF),e.revssf=T0(r.SSF),e.revssf[r.SSF[65535]]=0,e.ssf=r.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,pc?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var t="xml",n=vT.indexOf(e.bookType)>-1,i=NO();YO(e=e||{});var s=OO(),a="",o=0;if(e.cellXfs=[],ja(e.cellXfs,{},{revssf:{General:0}}),r.Props||(r.Props={}),a="docProps/core.xml",dt(s,a,NS(r.Props,e)),i.coreprops.push(a),Wt(e.rels,2,a,yt.CORE_PROPS),a="docProps/app.xml",!(r.Props&&r.Props.SheetNames))if(!r.Workbook||!r.Workbook.Sheets)r.Props.SheetNames=r.SheetNames;else{for(var l=[],f=0;f<r.SheetNames.length;++f)(r.Workbook.Sheets[f]||{}).Hidden!=2&&l.push(r.SheetNames[f]);r.Props.SheetNames=l}r.Props.Worksheets=r.Props.SheetNames.length,dt(s,a,IS(r.Props)),i.extprops.push(a),Wt(e.rels,3,a,yt.EXT_PROPS),r.Custprops!==r.Props&&Tr(r.Custprops||{}).length>0&&(a="docProps/custom.xml",dt(s,a,LS(r.Custprops)),i.custprops.push(a),Wt(e.rels,4,a,yt.CUST_PROPS));var c=["SheetJ5"];for(e.tcid=0,o=1;o<=r.SheetNames.length;++o){var h={"!id":{}},u=r.Sheets[r.SheetNames[o-1]],d=(u||{})["!type"]||"sheet";switch(d){case"chart":default:a="xl/worksheets/sheet"+o+"."+t,dt(s,a,PT(o-1,e,r,h)),i.sheets.push(a),Wt(e.wbrels,-1,"worksheets/sheet"+o+"."+t,yt.WS[0])}if(u){var p=u["!comments"],m=!1,g="";if(p&&p.length>0){var v=!1;p.forEach(function(w){w[1].forEach(function(x){x.T==!0&&(v=!0)})}),v&&(g="xl/threadedComments/threadedComment"+o+"."+t,dt(s,g,u6(p,c,e)),i.threadedcomments.push(g),Wt(h,-1,"../threadedComments/threadedComment"+o+"."+t,yt.TCMNT)),g="xl/comments"+o+"."+t,dt(s,g,xT(p)),i.comments.push(g),Wt(h,-1,"../comments"+o+"."+t,yt.CMNT),m=!0}u["!legacy"]&&m&&dt(s,"xl/drawings/vmlDrawing"+o+".vml",OT(o,u["!comments"])),delete u["!comments"],delete u["!legacy"]}h["!id"].rId1&&dt(s,Ec(a),_l(h))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+t,dt(s,a,sT(e.Strings,e)),i.strs.push(a),Wt(e.wbrels,-1,"sharedStrings."+t,yt.SST)),a="xl/workbook."+t,dt(s,a,DT(r)),i.workbooks.push(a),Wt(e.rels,1,a,yt.WB),a="xl/theme/theme1.xml",dt(s,a,ZO(r.Themes,e)),i.themes.push(a),Wt(e.wbrels,-1,"theme/theme1.xml",yt.THEME),a="xl/styles."+t,dt(s,a,dT(r,e)),i.styles.push(a),Wt(e.wbrels,-1,"styles."+t,yt.STY),r.vbaraw&&n&&(a="xl/vbaProject.bin",dt(s,a,r.vbaraw),i.vba.push(a),Wt(e.wbrels,-1,"vbaProject.bin",yt.VBA)),a="xl/metadata."+t,dt(s,a,gT()),i.metadata.push(a),Wt(e.wbrels,-1,"metadata."+t,yt.XLMETA),c.length>1&&(a="xl/persons/person.xml",dt(s,a,p6(c)),i.people.push(a),Wt(e.wbrels,-1,"persons/person.xml",yt.PEOPLE)),dt(s,"[Content_Types].xml",QS(i,e)),dt(s,"_rels/.rels",_l(e.rels)),dt(s,"xl/_rels/workbook."+t+".rels",_l(e.wbrels)),delete e.revssf,delete e.ssf,s}function KO(r,e){var t="";switch((e||{}).type||"base64"){case"buffer":return[r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7]];case"base64":t=ci(r.slice(0,12));break;case"binary":t=r;break;case"array":return[r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function J7(r,e){return Ye.find(r,"EncryptedPackage")?H7(r,e):zO(r,e)}function e9(r,e){var t,n=r,i=e||{};return i.type||(i.type=gt&&Buffer.isBuffer(r)?"buffer":"base64"),t=hS(n,i),YT(t,i)}function JT(r,e){var t=0;e:for(;t<r.length;)switch(r.charCodeAt(t)){case 10:case 13:case 32:++t;break;case 60:return Ym(r.slice(t),e);default:break e}return Ml.to_workbook(r,e)}function t9(r,e){var t="",n=KO(r,e);switch(e.type){case"base64":t=ci(r);break;case"binary":t=r;break;case"buffer":t=r.toString("binary");break;case"array":t=Ao(r);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(t=qt(t)),e.type="binary",JT(t,e)}function r9(r,e){var t=r;return e.type=="base64"&&(t=ci(t)),t=St.utils.decode(1200,t.slice(2),"str"),e.type="binary",JT(t,e)}function n9(r){return r.match(/[^\x00-\x7F]/)?gs(r):r}function kp(r,e,t,n){return n?(t.type="string",Ml.to_workbook(r,t)):Ml.to_workbook(e,t)}function Rd(r,e){k0();var t=e||{};if(typeof ArrayBuffer<"u"&&r instanceof ArrayBuffer)return Rd(new Uint8Array(r),(t=Kt(t),t.type="array",t));typeof Uint8Array<"u"&&r instanceof Uint8Array&&!t.type&&(t.type=typeof Deno<"u"?"buffer":"array");var n=r,i=[0,0,0,0],s=!1;if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),Sl={},t.dateNF&&(Sl.dateNF=t.dateNF),t.type||(t.type=gt&&Buffer.isBuffer(r)?"buffer":"base64"),t.type=="file"&&(t.type=gt?"buffer":"binary",n=iF(r),typeof Uint8Array<"u"&&!gt&&(t.type="array")),t.type=="string"&&(s=!0,t.type="binary",t.codepage=65001,n=n9(r)),t.type=="array"&&typeof Uint8Array<"u"&&r instanceof Uint8Array&&typeof ArrayBuffer<"u"){var a=new ArrayBuffer(3),o=new Uint8Array(a);if(o.foo="bar",!o.foo)return t=Kt(t),t.type="array",Rd(dO(n),t)}switch((i=KO(n,t))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return J7(Ye.read(n,t),t);break;case 9:if(i[1]<=8)return zO(n,t);break;case 60:return Ym(n,t);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return mD(n,t);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return nT.to_workbook(n,t);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?e9(n,t):kp(r,n,t,s);case 239:return i[3]===60?Ym(n,t):kp(r,n,t,s);case 255:if(i[1]===254)return r9(n,t);if(i[1]===0&&i[2]===2&&i[3]===0)return yo.to_workbook(n,t);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return yo.to_workbook(n,t);break;case 3:case 131:case 139:case 140:return Hm.to_workbook(n,t);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return cT.to_workbook(n,t);break;case 10:case 13:case 32:return t9(n,t);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return pD.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?Hm.to_workbook(n,t):kp(r,n,t,s)}function Jy(r,e){var t=e||{};return t.type="file",Rd(r,t)}function eC(r,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return vh(e.file,Ye.write(r,{type:gt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return Ye.write(r,e)}function i9(r,e){var t=Kt(e||{}),n=Y7(r,t);return tC(n,t)}function s9(r,e){var t=Kt(e||{}),n=KT(r,t);return tC(n,t)}function tC(r,e){var t={},n=gt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(t.compression="DEFLATE"),e.password)t.type=n;else switch(e.type){case"base64":t.type="base64";break;case"binary":t.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":t.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var i=r.FullPaths?Ye.write(r,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[t.type]||t.type,compression:!!e.compression}):r.generate(t);if(typeof Deno<"u"&&typeof i=="string"){if(e.type=="binary"||e.type=="base64")return i;i=new Uint8Array(Oh(i))}return e.password&&typeof encrypt_agile<"u"?eC(encrypt_agile(i,e.password),e):e.type==="file"?vh(e.file,i):e.type=="string"?qt(i):i}function a9(r,e){var t=e||{},n=f7(r,t);return eC(n,t)}function cs(r,e,t){t||(t="");var n=t+r;switch(e.type){case"base64":return kc(gs(n));case"binary":return gs(n);case"string":return r;case"file":return vh(e.file,n,"utf8");case"buffer":return gt?ta(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):cs(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function o9(r,e){switch(e.type){case"base64":return kc(r);case"binary":return r;case"string":return r;case"file":return vh(e.file,r,"binary");case"buffer":return gt?ta(r,"binary"):r.split("").map(function(t){return t.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function Kh(r,e){switch(e.type){case"string":case"base64":case"binary":for(var t="",n=0;n<r.length;++n)t+=String.fromCharCode(r[n]);return e.type=="base64"?kc(t):e.type=="string"?qt(t):t;case"file":return vh(e.file,r);case"buffer":return r;default:throw new Error("Unrecognized type "+e.type)}}function JO(r,e){k0(),NT(r);var t=Kt(e||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),t.type=="array"){t.type="binary";var n=JO(r,t);return t.type="array",Oh(n)}return s9(r,t)}function F0(r,e){k0(),NT(r);var t=Kt(e||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),t.type=="array"){t.type="binary";var n=F0(r,t);return t.type="array",Oh(n)}var i=0;if(t.sheet&&(typeof t.sheet=="number"?i=t.sheet:i=r.SheetNames.indexOf(t.sheet),!r.SheetNames[i]))throw new Error("Sheet not found: "+t.sheet+" : "+typeof t.sheet);switch(t.bookType||"xlsb"){case"xml":case"xlml":return cs(r7(r,t),t);case"slk":case"sylk":return cs(rT.from_sheet(r.Sheets[r.SheetNames[i]],t),t);case"htm":case"html":return cs(VT(r.Sheets[r.SheetNames[i]],t),t);case"txt":return o9(iC(r.Sheets[r.SheetNames[i]],t),t);case"csv":return cs(tx(r.Sheets[r.SheetNames[i]],t),t,"\uFEFF");case"dif":return cs(nT.from_sheet(r.Sheets[r.SheetNames[i]],t),t);case"dbf":return Kh(Hm.from_sheet(r.Sheets[r.SheetNames[i]],t),t);case"prn":return cs(Ml.from_sheet(r.Sheets[r.SheetNames[i]],t),t);case"rtf":return cs(cT.from_sheet(r.Sheets[r.SheetNames[i]],t),t);case"eth":return cs(iT.from_sheet(r.Sheets[r.SheetNames[i]],t),t);case"fods":return cs(GT(r,t),t);case"wk1":return Kh(yo.sheet_to_wk1(r.Sheets[r.SheetNames[i]],t),t);case"wk3":return Kh(yo.book_to_wk3(r,t),t);case"biff2":t.biff||(t.biff=2);case"biff3":t.biff||(t.biff=3);case"biff4":return t.biff||(t.biff=4),Kh(BT(r,t),t);case"biff5":t.biff||(t.biff=5);case"biff8":case"xla":case"xls":return t.biff||(t.biff=8),a9(r,t);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return i9(r,t);default:throw new Error("Unrecognized bookType |"+t.bookType+"|")}}function ex(r){if(!r.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},t=r.file.slice(r.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(r.bookType=t.slice(1)),r.bookType=e[r.bookType]||r.bookType}}function eg(r,e,t){var n=t||{};return n.type="file",n.file=e,ex(n),F0(r,n)}function l9(r,e,t){var n=t||{};return n.type="file",n.file=e,ex(n),JO(r,n)}function f9(r,e,t,n){var i=t||{};i.type="file",i.file=r,ex(i),i.type="buffer";var s=n;return s instanceof Function||(s=t),Sa.writeFile(r,F0(e,i),s)}function rC(r,e,t,n,i,s,a,o){var l=kr(t),f=o.defval,c=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),h=!0,u=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(u,"__rowNum__",{value:t,enumerable:!1})}catch{u.__rowNum__=t}else u.__rowNum__=t;if(!a||r[t])for(var d=e.s.c;d<=e.e.c;++d){var p=a?r[t][d]:r[n[d]+l];if(p===void 0||p.t===void 0){if(f===void 0)continue;s[d]!=null&&(u[s[d]]=f);continue}var m=p.v;switch(p.t){case"z":if(m==null)break;continue;case"e":m=m==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+p.t)}if(s[d]!=null){if(m==null)if(p.t=="e"&&m===null)u[s[d]]=null;else if(f!==void 0)u[s[d]]=f;else if(c&&m===null)u[s[d]]=null;else continue;else u[s[d]]=c&&(p.t!=="n"||p.t==="n"&&o.rawNumbers!==!1)?m:_s(p,m,o);m!=null&&(h=!1)}}return{row:u,isempty:h}}function Qd(r,e){if(r==null||r["!ref"]==null)return[];var t={t:"n",v:0},n=0,i=1,s=[],a=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},f=e||{},c=f.range!=null?f.range:r["!ref"];switch(f.header===1?n=1:f.header==="A"?n=2:Array.isArray(f.header)?n=3:f.header==null&&(n=0),typeof c){case"string":l=wt(c);break;case"number":l=wt(r["!ref"]),l.s.r=c;break;default:l=c}n>0&&(i=0);var h=kr(l.s.r),u=[],d=[],p=0,m=0,g=Array.isArray(r),v=l.s.r,w=0,x={};g&&!r[v]&&(r[v]=[]);var S=f.skipHidden&&r["!cols"]||[],y=f.skipHidden&&r["!rows"]||[];for(w=l.s.c;w<=l.e.c;++w)if(!(S[w]||{}).hidden)switch(u[w]=cr(w),t=g?r[v][w]:r[u[w]+h],n){case 1:s[w]=w-l.s.c;break;case 2:s[w]=u[w];break;case 3:s[w]=f.header[w-l.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),o=a=_s(t,null,f),m=x[a]||0,!m)x[a]=1;else{do o=a+"_"+m++;while(x[o]);x[a]=m,x[o]=1}s[w]=o}for(v=l.s.r+i;v<=l.e.r;++v)if(!(y[v]||{}).hidden){var b=rC(r,l,v,u,n,s,g,f);(b.isempty===!1||(n===1?f.blankrows!==!1:f.blankrows))&&(d[p++]=b.row)}return d.length=p,d}var ew=/"/g;function nC(r,e,t,n,i,s,a,o){for(var l=!0,f=[],c="",h=kr(t),u=e.s.c;u<=e.e.c;++u)if(n[u]){var d=o.dense?(r[t]||[])[u]:r[n[u]+h];if(d==null)c="";else if(d.v!=null){l=!1,c=""+(o.rawNumbers&&d.t=="n"?d.v:_s(d,null,o));for(var p=0,m=0;p!==c.length;++p)if((m=c.charCodeAt(p))===i||m===s||m===34||o.forceQuotes){c='"'+c.replace(ew,'""')+'"';break}c=="ID"&&(c='"ID"')}else d.f!=null&&!d.F?(l=!1,c="="+d.f,c.indexOf(",")>=0&&(c='"'+c.replace(ew,'""')+'"')):c="";f.push(c)}return o.blankrows===!1&&l?null:f.join(a)}function tx(r,e){var t=[],n=e??{};if(r==null||r["!ref"]==null)return"";var i=wt(r["!ref"]),s=n.FS!==void 0?n.FS:",",a=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),f=new RegExp((s=="|"?"\\|":s)+"+$"),c="",h=[];n.dense=Array.isArray(r);for(var u=n.skipHidden&&r["!cols"]||[],d=n.skipHidden&&r["!rows"]||[],p=i.s.c;p<=i.e.c;++p)(u[p]||{}).hidden||(h[p]=cr(p));for(var m=0,g=i.s.r;g<=i.e.r;++g)(d[g]||{}).hidden||(c=nC(r,i,g,h,a,l,s,n),c!=null&&(n.strip&&(c=c.replace(f,"")),(c||n.blankrows!==!1)&&t.push((m++?o:"")+c)));return delete n.dense,t.join("")}function iC(r,e){e||(e={}),e.FS="	",e.RS=`
`;var t=tx(r,e);if(typeof St>"u"||e.type=="string")return t;var n=St.utils.encode(1200,t,"str");return""+n}function c9(r){var e="",t,n="";if(r==null||r["!ref"]==null)return[];var i=wt(r["!ref"]),s="",a=[],o,l=[],f=Array.isArray(r);for(o=i.s.c;o<=i.e.c;++o)a[o]=cr(o);for(var c=i.s.r;c<=i.e.r;++c)for(s=kr(c),o=i.s.c;o<=i.e.c;++o)if(e=a[o]+s,t=f?(r[c]||[])[o]:r[e],n="",t!==void 0){if(t.F!=null){if(e=t.F,!t.f)continue;n=t.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(t.f!=null)n=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)n=""+t.v;else if(t.t=="b")n=t.v?"TRUE":"FALSE";else if(t.w!==void 0)n="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?n="'"+t.v:n=""+t.v}}l[l.length]=e+"="+n}return l}function sC(r,e,t){var n=t||{},i=+!n.skipHeader,s=r||{},a=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?wr(n.origin):n.origin;a=l.r,o=l.c}var f,c={s:{c:0,r:0},e:{c:o,r:a+e.length-1+i}};if(s["!ref"]){var h=wt(s["!ref"]);c.e.c=Math.max(c.e.c,h.e.c),c.e.r=Math.max(c.e.r,h.e.r),a==-1&&(a=h.e.r+1,c.e.r=a+e.length-1+i)}else a==-1&&(a=0,c.e.r=e.length-1+i);var u=n.header||[],d=0;e.forEach(function(m,g){Tr(m).forEach(function(v){(d=u.indexOf(v))==-1&&(u[d=u.length]=v);var w=m[v],x="z",S="",y=it({c:o+d,r:a+g+i});f=Dc(s,y),w&&typeof w=="object"&&!(w instanceof Date)?s[y]=w:(typeof w=="number"?x="n":typeof w=="boolean"?x="b":typeof w=="string"?x="s":w instanceof Date?(x="d",n.cellDates||(x="n",w=Vr(w)),S=n.dateNF||et[14]):w===null&&n.nullError&&(x="e",w=0),f?(f.t=x,f.v=w,delete f.w,delete f.R,S&&(f.z=S)):s[y]=f={t:x,v:w},S&&(f.z=S))})}),c.e.c=Math.max(c.e.c,o+u.length-1);var p=kr(a);if(i)for(d=0;d<u.length;++d)s[cr(d+o)+p]={t:"s",v:u[d]};return s["!ref"]=ht(c),s}function h9(r,e){return sC(null,r,e)}function Dc(r,e,t){if(typeof e=="string"){if(Array.isArray(r)){var n=wr(e);return r[n.r]||(r[n.r]=[]),r[n.r][n.c]||(r[n.r][n.c]={t:"z"})}return r[e]||(r[e]={t:"z"})}return typeof e!="number"?Dc(r,it(e)):Dc(r,it({r:e,c:t||0}))}function u9(r,e){if(typeof e=="number"){if(e>=0&&r.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var t=r.SheetNames.indexOf(e);if(t>-1)return t;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function rx(){return{SheetNames:[],Sheets:{}}}function nx(r,e,t,n){var i=1;if(!t)for(;i<=65535&&r.SheetNames.indexOf(t="Sheet"+i)!=-1;++i,t=void 0);if(!t||r.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&r.SheetNames.indexOf(t)>=0){var s=t.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var a=s&&s[1]||t;for(++i;i<=65535&&r.SheetNames.indexOf(t=a+i)!=-1;++i);}if($T(t),r.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return r.SheetNames.push(t),r.Sheets[t]=e,t}function d9(r,e,t){r.Workbook||(r.Workbook={}),r.Workbook.Sheets||(r.Workbook.Sheets=[]);var n=u9(r,e);switch(r.Workbook.Sheets[n]||(r.Workbook.Sheets[n]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}r.Workbook.Sheets[n].Hidden=t}function p9(r,e){return r.z=e,r}function aC(r,e,t){return e?(r.l={Target:e},t&&(r.l.Tooltip=t)):delete r.l,r}function m9(r,e,t){return aC(r,"#"+e,t)}function g9(r,e,t){r.c||(r.c=[]),r.c.push({t:e,a:t||"SheetJS"})}function O9(r,e,t,n){for(var i=typeof e!="string"?e:wt(e),s=typeof e=="string"?e:ht(e),a=i.s.r;a<=i.e.r;++a)for(var o=i.s.c;o<=i.e.c;++o){var l=Dc(r,a,o);l.t="n",l.F=s,delete l.v,a==i.s.r&&o==i.s.c&&(l.f=t,n&&(l.D=!0))}return r}var Du={encode_col:cr,encode_row:kr,encode_cell:it,encode_range:ht,decode_col:EO,decode_row:AO,split_cell:DF,decode_cell:wr,decode_range:Dn,format_cell:_s,sheet_add_aoa:SS,sheet_add_json:sC,sheet_add_dom:qT,aoa_to_sheet:hf,json_to_sheet:h9,table_to_sheet:jT,table_to_book:C7,sheet_to_csv:tx,sheet_to_txt:iC,sheet_to_json:Qd,sheet_to_html:VT,sheet_to_formulae:c9,sheet_to_row_object_array:Qd,sheet_get_cell:Dc,book_new:rx,book_append_sheet:nx,book_set_sheet_visibility:d9,cell_set_number_format:p9,cell_set_hyperlink:aC,cell_set_internal_link:m9,cell_add_comment:g9,sheet_set_array_formula:O9,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},$0;function x9(r){$0=r}function v9(r,e){var t=$0(),n=e??{};if(r==null||r["!ref"]==null)return t.push(null),t;var i=wt(r["!ref"]),s=n.FS!==void 0?n.FS:",",a=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),f=new RegExp((s=="|"?"\\|":s)+"+$"),c="",h=[];n.dense=Array.isArray(r);for(var u=n.skipHidden&&r["!cols"]||[],d=n.skipHidden&&r["!rows"]||[],p=i.s.c;p<=i.e.c;++p)(u[p]||{}).hidden||(h[p]=cr(p));var m=i.s.r,g=!1,v=0;return t._read=function(){if(!g)return g=!0,t.push("\uFEFF");for(;m<=i.e.r;)if(++m,!(d[m-1]||{}).hidden&&(c=nC(r,i,m-1,h,a,l,s,n),c!=null&&(n.strip&&(c=c.replace(f,"")),c||n.blankrows!==!1)))return t.push((v++?o:"")+c);return t.push(null)},t}function y9(r,e){var t=$0(),n=e||{},i=n.header!=null?n.header:WT,s=n.footer!=null?n.footer:UT;t.push(i);var a=Dn(r["!ref"]);n.dense=Array.isArray(r),t.push(XT(r,a,n));var o=a.s.r,l=!1;return t._read=function(){if(o>a.e.r)return l||(l=!0,t.push("</table>"+s)),t.push(null);for(;o<=a.e.r;){t.push(ZT(r,a,o,n)),++o;break}},t}function w9(r,e){var t=$0({objectMode:!0});if(r==null||r["!ref"]==null)return t.push(null),t;var n={t:"n",v:0},i=0,s=1,a=[],o=0,l="",f={s:{r:0,c:0},e:{r:0,c:0}},c=e||{},h=c.range!=null?c.range:r["!ref"];switch(c.header===1?i=1:c.header==="A"?i=2:Array.isArray(c.header)&&(i=3),typeof h){case"string":f=wt(h);break;case"number":f=wt(r["!ref"]),f.s.r=h;break;default:f=h}i>0&&(s=0);var u=kr(f.s.r),d=[],p=0,m=Array.isArray(r),g=f.s.r,v=0,w={};m&&!r[g]&&(r[g]=[]);var x=c.skipHidden&&r["!cols"]||[],S=c.skipHidden&&r["!rows"]||[];for(v=f.s.c;v<=f.e.c;++v)if(!(x[v]||{}).hidden)switch(d[v]=cr(v),n=m?r[g][v]:r[d[v]+u],i){case 1:a[v]=v-f.s.c;break;case 2:a[v]=d[v];break;case 3:a[v]=c.header[v-f.s.c];break;default:if(n==null&&(n={w:"__EMPTY",t:"s"}),l=o=_s(n,null,c),p=w[o]||0,!p)w[o]=1;else{do l=o+"_"+p++;while(w[l]);w[o]=p,w[l]=1}a[v]=l}return g=f.s.r+s,t._read=function(){for(;g<=f.e.r;)if(!(S[g-1]||{}).hidden){var y=rC(r,f,g,d,i,a,m,c);if(++g,y.isempty===!1||(i===1?c.blankrows!==!1:c.blankrows)){t.push(y.row);return}}return t.push(null)},t}var b9={to_json:w9,to_html:y9,to_csv:v9,set_readable:x9};const _9=_c.version,k9=Object.freeze(Object.defineProperty({__proto__:null,CFB:Ye,SSF:sS,parse_xlscfb:zO,parse_zip:YT,read:Rd,readFile:Jy,readFileSync:Jy,set_cptable:CQ,set_fs:rF,stream:b9,utils:Du,version:_9,write:F0,writeFile:eg,writeFileAsync:f9,writeFileSync:eg,writeFileXLSX:l9,writeXLSX:JO},Symbol.toStringTag,{value:"Module"}));function oC(r,e="txt"){let t="Report";return r&&r.length>0&&(t=r),`${t}_${st.local().toFormat("yyyy-MM-dd_HH-mm-ss")}.${e}`}function S9(r){let e='<table id="ted_001">';return e+="<thead>",e+="<tr>",Object.keys(r[0]).forEach(t=>{e+="<th>"+t+"</th>"}),e+="</tr>",e+="</thead>",e+="<tbody>",r.forEach(t=>{e+="<tr>",Object.values(t).forEach(n=>{e+="<td>"+n+"</td>"}),e+="</tr>"}),e+="</tbody>",e+="</table>",e=`<!DOCTYPE html>
    <html>
    <head>
    <style>
    #ted_001 {
      font-family: Arial, Helvetica, sans-serif;
      border-collapse: collapse;
      width: 100%;
    }
    
    #ted_001 td, #ted_001 th {
      border: 1px solid #ddd;
      padding: 8px;
    }
    
    #ted_001 tr:nth-child(even){background-color: #f2f2f2;}
    
    #ted_001 tr:hover {background-color: #ddd;}
    
    #ted_001 th {
      padding-top: 12px;
      padding-bottom: 12px;
      text-align: left;
      background-color: #04AA6D;
      color: white;
    }
    </style>
    </head>
    <body>
    ${e}
    </body>
</html>
    `,e}function lC(r,e,t=0){return r.map(n=>{let i={...n};return Object.keys(n).forEach(s=>{if(e[s]&&e[s].hidden)delete i[s];else if(e[s]&&e[s].decorator&&e[s].decorator.component&&e[s].decorator.component===JR){let a=st.fromISO(n[s]);a.isValid?i[s]=a.toFormat("yyyy-MM-dd HH:mm:ss"):i[s]=n[s]}else n[s]!==null&&typeof n[s]=="object"&&(i[s]=JSON.stringify(n[s]),t>0&&i[s].length>=t&&(i[s]=i[s].substring(0,t),console.warn(`El valor de la columna ${s} es muy largo para ser exportado, se ha limitado a ${t} caracteres`)))}),delete i.internal_hash_row,i})}const T9=(r,e,t)=>{try{let a=!1,o=lC(r,e,32767);if(console.log("FormatedData",o,k9),o&&o.length>0){var n=Du.json_to_sheet(o),i=Du.book_new();Du.book_append_sheet(i,n,"Report");let l="xlsx",f=oC(t,l);var s={bookType:l,bookSST:!1,type:"binary",FS:";"};eg(i,f,s)}}catch(a){console.error(a)}},C9=(r,e,t)=>{try{let n=lC(r,e),i=S9(n);const s=document.createElement("a");s.setAttribute("href","data:text/html;charset=utf-8,"+encodeURIComponent(i)),s.setAttribute("download",oC(t,"html")),s.style.display="none",document.body.appendChild(s),s.click(),document.body.removeChild(s)}catch(n){console.error(n)}};function fC(r){var e=8;function t(m,g){var v=(m&65535)+(g&65535),w=(m>>16)+(g>>16)+(v>>16);return w<<16|v&65535}function n(m,g){return m>>>g|m<<32-g}function i(m,g){return m>>>g}function s(m,g,v){return m&g^~m&v}function a(m,g,v){return m&g^m&v^g&v}function o(m){return n(m,2)^n(m,13)^n(m,22)}function l(m){return n(m,6)^n(m,11)^n(m,25)}function f(m){return n(m,7)^n(m,18)^i(m,3)}function c(m){return n(m,17)^n(m,19)^i(m,10)}function h(m,g){var v=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),w=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225),x=new Array(64),S,y,b,O,T,k,Q,A,_,N,U,z;m[g>>5]|=128<<24-g%32,m[(g+64>>9<<4)+15]=g;for(var _=0;_<m.length;_+=16){S=w[0],y=w[1],b=w[2],O=w[3],T=w[4],k=w[5],Q=w[6],A=w[7];for(var N=0;N<64;N++)N<16?x[N]=m[N+_]:x[N]=t(t(t(c(x[N-2]),x[N-7]),f(x[N-15])),x[N-16]),U=t(t(t(t(A,l(T)),s(T,k,Q)),v[N]),x[N]),z=t(o(S),a(S,y,b)),A=Q,Q=k,k=T,T=t(O,U),O=b,b=y,y=S,S=t(U,z);w[0]=t(S,w[0]),w[1]=t(y,w[1]),w[2]=t(b,w[2]),w[3]=t(O,w[3]),w[4]=t(T,w[4]),w[5]=t(k,w[5]),w[6]=t(Q,w[6]),w[7]=t(A,w[7])}return w}function u(m){for(var g=Array(),v=(1<<e)-1,w=0;w<m.length*e;w+=e)g[w>>5]|=(m.charCodeAt(w/e)&v)<<24-w%32;return g}function d(m){m=m.replace(/\r\n/g,`
`);for(var g="",v=0;v<m.length;v++){var w=m.charCodeAt(v);w<128?g+=String.fromCharCode(w):w>127&&w<2048?(g+=String.fromCharCode(w>>6|192),g+=String.fromCharCode(w&63|128)):(g+=String.fromCharCode(w>>12|224),g+=String.fromCharCode(w>>6&63|128),g+=String.fromCharCode(w&63|128))}return g}function p(m){for(var g="0123456789abcdef",v="",w=0;w<m.length*4;w++)v+=g.charAt(m[w>>2]>>(3-w%4)*8+4&15)+g.charAt(m[w>>2]>>(3-w%4)*8&15);return v}return r=d(r),p(h(u(r),r.length*e))}function A9(r){return new Promise((e,t)=>{const n=r.data,i=r.columns;let s=r.hash_last_data,a=!1,o=[];if(Mu(n)&&n.length>0)try{let l=JSON.stringify(n),f=fC(l&&l.length>0?l:"0");s!==f?(s=f,o=E9(n,i),a=!0):console.log("No changes on Data on Table widget"),e({data:o,hash_last_data:s,different_data:a})}catch(l){console.log(l),t(l)}})}function Mu(r){return r&&Array.isArray(r)}function E9(r,e){let t={};return r.map((i,s)=>{try{i.internal_hash_row=0;let o=fC(JSON.stringify(i));t[o]&&(console.error("Hay un registro duplicado en la tabla",i),o=o+"-"+s,t[o]=!0),t[o]=!0,i.internal_hash_row=o}catch(o){console.error(o,i)}let a={};for(let o in e)Object.hasOwn(i,o)&&(a[o]=i[o]);for(let o in i)a[o]||(a[o]=i[o]);return a}).filter(i=>i&&i.internal_hash_row)}function P9(r,e,t,n,i){try{let s=e();s&&s.length>0?C9(s,t(),n()):(i(2),alert("Select the rows to export."))}catch(s){console.error(s)}}function R9(r,e,t,n,i){try{let s=e();s&&s.length>0?T9(s,t(),n()):(i(2),alert("Select the rows to export."))}catch(s){console.error(s)}}function Q9(r,e,t,n,i){if(e()){let s=t().refresh_time+1;n[s]?t(t().refresh_time=s,!0):t(t().refresh_time=0,!0),H(i,Y(n[t().refresh_time]))}else console.warn("ChangeIntervalRefresh: requestData not setted.")}function F9(r,e,t,n){try{let i=e();i&&i.length>0?t()({rows:Ht(i)}):(alert("Select the rows to delete."),n(2))}catch(i){console.error(i)}}function $9(r,e,t,n){H(e,Y(r.target.dataset.column)),H(t,!C(t)),n()}function tw(r,e,t,n){C(e)&&C(e).length>0?t():(t(),H(n,0))}function N9(r,e,t,n,i){H(e,Y(r.target.checked)),C(e)?(H(t,Y([])),C(n).forEach(s=>{H(t,Y(C(t).concat(s.map(a=>a.internal_hash_row))))})):H(t,Y([])),i()}function D9(r,e){return H(e,!C(e)),!1}function rw(r,e,t,n){e()==1&&H(t,Y([]));let i=r.target.dataset.internal_hash_row;r.target.checked?C(t).push(i):H(t,Y(C(t).filter(s=>s!==i))),n()}var M9=J('<span class="icon has-text-info"><i class="fas fa-spinner fa-pulse"></i></span>'),I9=J('<span class="icon"><i class="fas fa-hourglass-half"></i></span>'),L9=J('<span class="icon has-text-danger"><i class="fas fa-exclamation-triangle"></i></span>'),B9=J('<button class="button is-small" title="Refresh time"><!> <span> </span></button>'),Z9=J('<div class="field has-addons"><p class="control"><input class="input size_search is-small svelte-1b7i42n" type="text" placeholder="Search"></p> <p class="control"><button aria-label="close" class="button is-small" title="Search"><span class="icon is-small"><i class="fas fa-search"></i></span></button></p></div>'),W9=J('<button aria-label="close" class="button is-small" title="Export to Excel"><span class="icon"><i></i></span></button>'),U9=J('<button aria-label="close" class="button is-small" title="Export to Html"><span class="icon"><i class="fa-solid fa-download"></i></span></button>'),X9=(r,e)=>{e(1)},V9=(r,e)=>{e(2)},q9=(r,e)=>{e(0)},j9=J('<div class="dropdown is-hoverable is-right" title="Selection type"><div class="dropdown-trigger"><button aria-label="close" class="button is-small" aria-haspopup="true" aria-controls="dropdown-menu"><span class="icon"><i class="far fa-list-alt"></i></span></button></div> <div class="dropdown-menu" role="menu"><div class="dropdown-content"><a class="dropdown-item is-size-7"><input class="check_margin svelte-1b7i42n" type="radio" name="selection_type" value="1"> <span class="icon"><i class="fas fa-check"></i></span> <span>Simple</span></a> <a class="dropdown-item is-size-7"><input class="check_margin svelte-1b7i42n" type="radio" name="selection_type" value="2"> <span class="icon"><i class="fas fa-check-double"></i></span> <span>Multiple</span></a> <hr class="dropdown-divider"> <a class="dropdown-item is-size-7"><input class="check_margin svelte-1b7i42n" type="radio" name="selection_type" value="0"> <span class="icon"><i class="fas fa-ban"></i></span> <span>None</span></a></div></div></div>'),z9=J('<button aria-label="close" class="button is-small" title="Delete row"><span class="icon"><i></i></span></button>'),G9=J('<button aria-label="close" class="button is-small" title="Edit row"><span class="icon"><i class="far fa-edit"></i></span></button>'),H9=(r,e)=>{e()&&e()()},Y9=J('<button aria-label="close" class="button is-small" title="New row"><span class="icon"><i class="far fa-file"></i></span></button>'),K9=J('<th class="has-text-centered has-text-white"><span>-</span></th>'),J9=J('<th class="has-text-centered has-text-white"><input type="checkbox"></th>'),eZ=J('<th class="has-text-centered has-text-white"><i class="fas fa-pen"></i></th>'),tZ=J('<i class="fas fa-caret-down"></i>'),rZ=J('<i class="fas fa-caret-up"></i>'),nZ=J('<th class="has-text-centered show_cursor_mouse has-text-white svelte-1b7i42n"> <!></th>'),iZ=J('<td class="has-text-centered"><input type="radio" name="single_select" class="show_cursor_mouse svelte-1b7i42n"></td>'),sZ=J('<td class="has-text-centered"><input class="show_cursor_mouse svelte-1b7i42n" type="checkbox"></td>'),aZ=J('<td class="has-text-centered show_cursor_mouse svelte-1b7i42n"><span class="icon is-small"><i class="fas fa-pen"></i></span></td>'),oZ=J("<tr><td> </td><!><!><!></tr>"),lZ=(r,e,t)=>{H(e,1),t()},fZ=(r,e,t)=>{C(e)>1&&H(e,C(e)-1),t()},cZ=(r,e)=>{e()},hZ=(r,e,t)=>{H(e,C(e)+1),t()},uZ=J('<button class="button is-small"> </button>'),dZ=(r,e,t)=>{H(e,C(e)+2),t()},pZ=J('<button class="button is-small"> </button>'),mZ=(r,e,t)=>{H(e,C(e)+3),t()},gZ=J('<button class="button is-small"> </button>'),OZ=(r,e,t)=>{H(e,C(e)+4),t()},xZ=J('<button class="button is-small"> </button>'),vZ=(r,e,t,n)=>{C(e)<C(t)&&(H(e,C(e)+1),n())},yZ=(r,e,t,n)=>{H(e,Y(C(t))),n()},wZ=J('<div class="level-item"><span> </span></div> <div class="level-item"><div class="buttons has-addons"><button aria-label="close" class="button is-small"><span class="icon"><i class="fas fa-angle-double-left"></i></span></button> <button aria-label="close" class="button is-small"><span class="icon"><i class="fas fa-angle-left"></i></span></button> <button class="button is-small is-info"> </button> <!> <!> <!> <!> <button aria-label="close" class="button is-small"><span class="icon"><i class="fas fa-angle-right"></i></span></button> <button aria-label="close" class="button is-small"><span class="icon"><i class="fas fa-angle-double-right"></i></span></button></div></div>',1),bZ=(r,e,t)=>{e(r.target.value),t()},_Z=J("<option> </option>"),kZ=J('<div class="table-container is-size-7"><table class="table is-bordered is-striped is-narrow is-hoverable is-fullwidth"><thead><tr class="has-background-link-dark"><th class="has-text-centered has-text-white resizable">#</th><!><!><!></tr></thead><tbody><!></tbody></table></div> <div class="table_pagination svelte-1b7i42n"><nav class="level"><div class="level-left"><!></div> <div class="level-right"><span class="level-item"><span class="label_rows_per_page svelte-1b7i42n">Rows per page</span> <div class="select is-small"><select name="rows_per_page"></select></div></span></div></nav></div>',1),SZ=J('<div class="has-text-centered has-text-link-dark"><i class="fa fa-table" aria-hidden="true"></i> There is no data to show</div>'),TZ=(r,e)=>{H(e,!1)},CZ=J('<div class="column"><label class="checkbox"><input type="checkbox"> </label></div>'),AZ=(r,e)=>{H(e,!1)},EZ=J('<!> <!> <div class="modal"><div class="modal-card"><header class="modal-card-head has-background-dark"><p class="modal-card-title has-text-white"><b><span>Columns</span></b></p> <button class="delete" aria-label="close"></button></header> <section class="modal-card-body"><div class="columns"></div></section> <footer class="modal-card-foot has-background-dark"><button class="button is-success is-small"><span>Accept</span></button> <button class="button is-small"><span>Cancel</span></button></footer></div></div>',1);function Th(r,e){Ot(e,!0);const t=Ce=>{var qe=Ae(),pt=ye(qe);{var ut=tt=>{var mt=B9();mt.__click=[Q9,ve,T,de,ee];var dr=R(mt);{var Zr=M=>{var X=M9();W(M,X)},F=M=>{var X=Ae(),G=ye(X);{var oe=ie=>{var le=I9();W(ie,le)},ue=ie=>{var le=L9();W(ie,le)};se(G,ie=>{C(ne)?ie(oe):ie(ue,!1)},!0)}W(M,X)};se(dr,M=>{C(E)?M(Zr):M(F,!1)})}var j=te(dr,2),D=R(j);P(j),P(mt),Re(()=>Ge(D,`${C(ee)??""}s`)),W(tt,mt)};se(pt,tt=>{T()&&T().url&&tt(ut)})}W(Ce,qe)},n=Ce=>{var qe=Z9(),pt=R(qe),ut=R(pt);Et(ut),ut.__change=[tw,ae,Ke,ee],P(pt);var tt=te(pt,2),mt=R(tt);mt.__click=[tw,ae,Ke,ee],P(tt),P(qe),Xt(ut,()=>C(ae),dr=>H(ae,dr)),W(Ce,qe)},i=Ce=>{var qe=Ae(),pt=ye(qe);{var ut=tt=>{var mt=W9();mt.__click=[R9,Xe,u,O,h];var dr=R(mt),Zr=R(dr);P(dr),P(mt),Re(()=>ft(Zr,oi(v()),"svelte-1b7i42n")),W(tt,mt)};se(pt,tt=>{g()&&tt(ut)})}W(Ce,qe)},s=Ce=>{var qe=Ae(),pt=ye(qe);{var ut=tt=>{var mt=U9();mt.__click=[P9,Xe,u,O,h],W(tt,mt)};se(pt,tt=>{g()&&tt(ut)})}W(Ce,qe)},a=Ce=>{var qe=Ae(),pt=ye(qe);{var ut=tt=>{var mt=j9(),dr=te(R(mt),2),Zr=R(dr),F=R(Zr),j=R(F);Et(j),j.__change=[X9,h],Lt(4),P(F);var D=te(F,2),M=R(D);Et(M),M.__change=[V9,h],Lt(4),P(D);var X=te(D,4),G=R(X);Et(G),G.__change=[q9,h],Lt(4),P(X),P(Zr),P(dr),P(mt),Re(()=>{ol(j,h()==1),ol(M,h()==2),ol(G,h()==0)}),W(tt,mt)};se(pt,tt=>{m()&&tt(ut)})}W(Ce,qe)},o=Ce=>{var qe=Ae(),pt=ye(qe);{var ut=tt=>{var mt=z9();mt.__click=[F9,Xe,z,h];var dr=R(mt),Zr=R(dr);P(dr),P(mt),Re(()=>ft(Zr,oi(w()),"svelte-1b7i42n")),W(tt,mt)};se(pt,tt=>{x()&&tt(ut)})}W(Ce,qe)},l=Ce=>{var qe=Ae(),pt=ye(qe);{var ut=tt=>{var mt=G9();mt.__click=[D9,L],W(tt,mt)};se(pt,tt=>{p()&&tt(ut)})}W(Ce,qe)},f=Ce=>{var qe=Ae(),pt=ye(qe);{var ut=tt=>{var mt=Y9();mt.__click=[H9,U],W(tt,mt)};se(pt,tt=>{d()&&tt(ut)})}W(Ce,qe)};let c=me(e,"RawDataTable",15),h=me(e,"SelectionType",15,0),u=me(e,"columns",27,()=>Y({})),d=me(e,"ShowNewButton",11,!1),p=me(e,"ShowEditButton",11,!1),m=me(e,"ShowSelectionButton",11,!0),g=me(e,"ShowExportButton",11,!0),v=me(e,"iconExport",11,"fa-solid fa-file-excel"),w=me(e,"iconDeleteRow",11,"fa-solid fa-trash"),x=me(e,"ShowDeleteButton",11,!1),S=me(e,"PageSize",27,()=>Y([25,50,100,200,300,500,1e3])),y=me(e,"PageSizeSelected",15,0),b=me(e,"relatedTablesForAutoRefresh",27,()=>Y([])),O=me(e,"fileNameExport",11,""),T=me(e,"requestData",15),k=me(e,"rowClassFunction",3,function(Ce){return""}),Q=me(e,"left_items",27,()=>Y([])),A=me(e,"right_items",27,()=>Y([])),_=me(e,"onclickrow",3,Ce=>{}),N=me(e,"oneditrow",3,Ce=>{console.trace("oneditrow no implemented.")}),U=me(e,"onnewrow",3,Ce=>{console.trace("onnewrow no implemented.")}),z=me(e,"ondeleterow",3,Ce=>{xr(Ce)}),K=me(e,"onselectrows",3,Ce=>{}),re=me(e,"onclickcell",3,Ce=>{});const ge=new es;let V=be(Y([])),he=be(Y([])),ae=be(void 0),E=be(!1),L=be(!1),I=be(void 0),Z=be(!1),ee=be(999),ne=be(!0),de=[10,20,30,45,60,120,240,480,960,1920,3840],fe=be(1),pe=be(0),Me=be(0),q=be(Y([])),He=be(!1),Ve=be(!0),Te=be(Y({})),Ne;Js(()=>{c()&&ct()});function ve(){return T()&&T().url&&T().url.length>0}function ct(){Vt()&&(clearTimeout(Ne),Ne=setTimeout(async()=>{try{let Ce=await A9({data:c(),columns:u(),hash_last_data:Ee});Ee=Ce.hash_last_data,Ce.different_data&&(c(Ce.data),er(),Ke())}catch(Ce){console.trace(Ce)}},500))}function bt(){K()({rows:Xe()})}It(()=>{H(ee,0),T()||T({url:void 0,refresh_time:4,params:void 0,method:"GET",headers:void 0,authorization:{basic:void 0,bearer:void 0}}),T(T().method=T().method||"GET",!0),T(T().refresh_time=Number(T().refresh_time)?Number(T().refresh_time):4,!0),yQ.subscribe(Ce=>{try{b().includes(Ce.table)&&De++}catch(qe){console.error(qe)}})});function Bt(Ce,qe){let pt=[];if(qe=parseInt(qe),Mu(Ce))for(let ut=0;ut<Ce.length;ut+=qe){let tt=Ce.slice(ut,ut+qe);pt.push(tt)}return pt}function er(){if(Vt()&&c().length>0){let Ce=15;H(Te,Y({})),Object.keys(c()[0]).forEach(qe=>{qe==="internal_hash_row"?C(Te)[qe]={label:qe.substring(0,Ce),hidden:!0}:u()[qe]?(C(Te)[qe]=u()[qe],C(Te)[qe].label||(C(Te)[qe].label=qe.substring(0,Ce))):C(Te)[qe]={label:qe.substring(0,Ce),hidden:!1}})}}function Qe(Ce){return C(he).includes(Ce)}function Xe(){let Ce=[];return Vt()&&(Ce=c().filter(qe=>C(he).includes(qe.internal_hash_row))),Ce}let De=0,ke=setInterval(async()=>{ve()&&(C(ee)==0||De>0?(await ur(),H(ee,Y(de[T().refresh_time])),De=0):l3(ee,-1))},1e3),Ee="";ea(()=>{clearInterval(ke),clearTimeout(Ne)});function Ft(Ce,qe="asc"){return function(ut,tt){if(!ut.hasOwnProperty(Ce)||!tt.hasOwnProperty(Ce))return 0;const mt=typeof ut[Ce]=="string"?ut[Ce].toUpperCase():ut[Ce],dr=typeof tt[Ce]=="string"?tt[Ce].toUpperCase():tt[Ce];let Zr=0;return mt>dr?Zr=1:mt<dr&&(Zr=-1),qe==="desc"?Zr*-1:Zr}}function xr(Ce){Ce.rows&&Ce.rows.length>0&&c(c().filter(qe=>Ce.rows.find(pt=>pt.key!=qe.key)))}function Vt(){return Mu(c())}function Ke(){let Ce;C(ae)&&C(ae).length>0&&Vt()?Ce=c().filter(qe=>Object.values(qe).filter(ut=>ut&&ut.toString().toUpperCase().includes(C(ae).toUpperCase())).length>0):Ce=c(),Ce&&(H(pe,Y(Ce.length)),zt(Ce))}function zt(Ce){C(I)&&(C(Ve)?Ce=Ce.sort(Ft(C(I))):Ce=Ce.sort(Ft(C(I),"desc"))),H(q,Y(Bt(Ce,S()[y()]))),H(Me,Y(C(q).length)),C(fe)>C(Me)&&H(fe,1),tr()}function tr(){let Ce=C(q)[C(fe)-1]??[];Ce&&H(V,Y(Ce.filter(qe=>qe&&qe.internal_hash_row)))}async function ur(){if(C(E))console.log("There is a petition in progress...");else if(ve())try{H(E,!0),T().authorization&&T().authorization.bearer?ge.setBearerAuthorization(T().authorization.bearer):T().authorization&&T().authorization.basic?ge.SetBasicAuthentication(T().authorization.basic.username,T().authorization.basic.password):ge.ClearAuthorizationHeader();let Ce=T()&&T().method?T().method.toUpperCase():"GET",qe=await ge[Ce]({url:T().url,data:T().params,headers:T().headers});if(qe&&qe.status==200){let pt=await qe.json();Mu(pt)?(c(pt),H(ne,!0)):(c([]),H(ne,!1))}else H(ne,!1);H(E,!1)}catch(Ce){console.error(Ce),H(E,!1),H(ne,!1)}else console.warn("Not url asigned"),H(ne,!1)}var di=EZ(),Ya=ye(di),xf=Pa(()=>[...A(),t,f,l,o,a,i,s,n]);Nl(Ya,{get left(){return Q()},get right(){return C(xf)}});var la=te(Ya,2);{var Ka=Ce=>{var qe=kZ(),pt=ye(qe),ut=R(pt),tt=R(ut),mt=R(tt),dr=te(R(mt));{var Zr=Je=>{var nt=K9();W(Je,nt)},F=Je=>{var nt=Ae(),Tt=ye(nt);{var ar=vt=>{var vr=J9(),Qr=R(vr);Qr.__click=[N9,He,he,q,Ke],P(vr),W(vt,vr)};se(Tt,vt=>{h()==2&&vt(ar)},!0)}W(Je,nt)};se(dr,Je=>{h()==1?Je(Zr):Je(F,!1)})}var j=te(dr);{var D=Je=>{var nt=eZ();W(Je,nt)};se(j,Je=>{C(L)&&Je(D)})}var M=te(j);{var X=Je=>{var nt=Ae(),Tt=ye(nt);Pr(Tt,17,()=>Object.keys(C(Te)),Lr,(ar,vt)=>{var vr=Ae(),Qr=ye(vr);{var is=Fr=>{var Ds=Ae(),Ho=ye(Ds);{var Yo=to=>{var $i=nZ();$i.__click=[$9,I,Ve,Ke];var Ko=R($i),Jo=te(Ko);{var dn=Dt=>{var In=Ae(),ha=ye(In);{var Ms=_t=>{var Gn=tZ();W(_t,Gn)},or=_t=>{var Gn=rZ();W(_t,Gn)};se(ha,_t=>{C(Ve)?_t(Ms):_t(or,!1)})}W(Dt,In)};se(Jo,Dt=>{C(I)==C(vt)&&Dt(dn)})}P($i),Re(()=>{Ra($i,"data-column",C(vt)),Ge(Ko,`${C(Te)[C(vt)].label??""} `)}),W(to,$i)};se(Ho,to=>{(!C(Te)[C(vt)].hidden||!C(Te)[C(vt)].hidden==null)&&to(Yo)})}W(Fr,Ds)};se(Qr,Fr=>{C(Te)[C(vt)]&&Fr(is)})}W(ar,vr)}),W(Je,nt)};se(M,Je=>{C(Te)&&Je(X)})}P(mt),P(tt);var G=te(tt),oe=R(G);{var ue=Je=>{var nt=Ae(),Tt=ye(nt);Pr(Tt,19,()=>C(V),ar=>ar.internal_hash_row,(ar,vt,vr)=>{var Qr=oZ();const is=Pa(()=>oi(k()(C(vt))));Qr.__click=()=>{_()&&_()({row:Ht(C(vt)),id:Ht(C(vr))})};var Fr=R(Qr),Ds=R(Fr,!0);P(Fr);var Ho=te(Fr);{var Yo=dn=>{var Dt=iZ(),In=R(Dt);Et(In),Re(()=>ol(In,Qe(C(vt).internal_hash_row))),In.__click=[rw,h,he,bt],P(Dt),Re(()=>Ra(In,"data-internal_hash_row",C(vt).internal_hash_row)),W(dn,Dt)},to=dn=>{var Dt=Ae(),In=ye(Dt);{var ha=Ms=>{var or=sZ(),_t=R(or);Et(_t),Re(()=>ol(_t,Qe(C(vt).internal_hash_row))),_t.__click=[rw,h,he,bt],P(or),Re(()=>Ra(_t,"data-internal_hash_row",C(vt).internal_hash_row)),W(Ms,or)};se(In,Ms=>{h()==2&&Ms(ha)},!0)}W(dn,Dt)};se(Ho,dn=>{h()==1?dn(Yo):dn(to,!1)})}var $i=te(Ho);{var Ko=dn=>{var Dt=aZ();Dt.__click=()=>{N()&&N()(Ht(C(V)[C(vr)]))},W(dn,Dt)};se($i,dn=>{C(L)&&dn(Ko)})}var Jo=te($i);Pr(Jo,17,()=>Object.keys(C(vt)),Lr,(dn,Dt)=>{var In=Ae(),ha=ye(In);{var Ms=or=>{var _t=Ae(),Gn=ye(_t);{var NP=K0=>{var fv=Ae(),DP=ye(fv);{var MP=el=>{var ua=Ae();const Dh=Pa(()=>C(Te)[C(Dt)].decorator.component);var LP=ye(ua);u3(LP,()=>C(Dh),(BP,ZP)=>{ZP(BP,gv({onclickcell:ro=>{re()&&re()({field:Ht(C(Dt)),data:Ht(C(vt))})}},()=>{var ro,cv;return(cv=(ro=C(Te)[C(Dt)])==null?void 0:ro.decorator)==null?void 0:cv.props},{get row(){return C(V)[C(vr)]},set row(ro){C(V)[C(vr)]=ro},get value(){return C(vt)[C(Dt)]},set value(ro){C(vt)[C(Dt)]=ro}}))}),W(el,ua)},IP=el=>{Zm(el,gv(()=>{var ua,Dh;return(Dh=(ua=C(Te)[C(Dt)])==null?void 0:ua.decorator)==null?void 0:Dh.props},{onclickcell:ua=>{re()&&re()({field:Ht(C(Dt)),data:Ht(C(vt))})},get value(){return C(vt)[C(Dt)]},set value(ua){C(vt)[C(Dt)]=ua}}))};se(DP,el=>{C(Te)[C(Dt)].decorator&&C(Te)[C(Dt)].decorator.component?el(MP):el(IP,!1)})}W(K0,fv)};se(Gn,K0=>{(!C(Te)[C(Dt)].hidden||C(Te)[C(Dt)].hidden==null)&&K0(NP)})}W(or,_t)};se(ha,or=>{C(Te)[C(Dt)]&&or(Ms)})}W(dn,In)}),P(Qr),Re(()=>{ft(Qr,C(is),"svelte-1b7i42n"),Ge(Ds,C(vr)+1+S()[y()]*(C(fe)-1))}),W(ar,Qr)}),W(Je,nt)};se(oe,Je=>{C(V)&&Je(ue)})}P(G),P(ut),P(pt);var ie=te(pt,2),le=R(ie),ce=R(le),_e=R(ce);{var Pe=Je=>{var nt=wZ(),Tt=ye(nt),ar=R(Tt),vt=R(ar);P(ar),P(Tt);var vr=te(Tt,2),Qr=R(vr),is=R(Qr);is.__click=[lZ,fe,tr];var Fr=te(is,2);Fr.__click=[fZ,fe,tr];var Ds=te(Fr,2);Ds.__click=[cZ,tr];var Ho=R(Ds,!0);P(Ds);var Yo=te(Ds,2);{var to=or=>{var _t=uZ();_t.__click=[hZ,fe,tr];var Gn=R(_t,!0);P(_t),Re(()=>Ge(Gn,C(fe)+1)),W(or,_t)};se(Yo,or=>{C(fe)+1<=C(Me)&&or(to)})}var $i=te(Yo,2);{var Ko=or=>{var _t=pZ();_t.__click=[dZ,fe,tr];var Gn=R(_t,!0);P(_t),Re(()=>Ge(Gn,C(fe)+2)),W(or,_t)};se($i,or=>{C(fe)+2<=C(Me)&&or(Ko)})}var Jo=te($i,2);{var dn=or=>{var _t=gZ();_t.__click=[mZ,fe,tr];var Gn=R(_t,!0);P(_t),Re(()=>Ge(Gn,C(fe)+3)),W(or,_t)};se(Jo,or=>{C(fe)+3<=C(Me)&&or(dn)})}var Dt=te(Jo,2);{var In=or=>{var _t=xZ();_t.__click=[OZ,fe,tr];var Gn=R(_t,!0);P(_t),Re(()=>Ge(Gn,C(fe)+4)),W(or,_t)};se(Dt,or=>{C(fe)+4<=C(Me)&&or(In)})}var ha=te(Dt,2);ha.__click=[vZ,fe,Me,tr];var Ms=te(ha,2);Ms.__click=[yZ,fe,Me,tr],P(Qr),P(vr),Re(()=>{Ge(vt,`Page ${C(fe)??""} of ${C(Me)??""} (Total ${C(pe)??""}
							rows)`),Ge(Ho,C(fe))}),W(Je,nt)};se(_e,Je=>{C(q)&&C(q).length>1&&Je(Pe)})}P(ce);var We=te(ce,2),Se=R(We),Ze=te(R(Se),2),rt=R(Ze);rt.__change=[bZ,y,Ke],Pr(rt,21,S,Lr,(Je,nt,Tt)=>{var ar=_Z();ar.value=(ar.__value=Tt)==null?"":Tt;var vt=R(ar,!0);P(ar),Re(()=>{y3(ar,C(nt)==S()[y()]),Ge(vt,C(nt))}),W(Je,ar)}),P(rt),P(Ze),P(Se),P(We),P(le),P(ie),W(Ce,qe)},Ja=Ce=>{var qe=SZ();W(Ce,qe)};se(la,Ce=>{C(V)?Ce(Ka):Ce(Ja,!1)})}var fa=te(la,2),jo=R(fa),eo=R(jo),ns=te(R(eo),2);ns.__click=[TZ,Z],P(eo);var ca=te(eo,2),zo=R(ca);Pr(zo,21,()=>Object.keys(u()),Lr,(Ce,qe)=>{var pt=CZ(),ut=R(pt),tt=te(R(ut));P(ut),P(pt),Re(()=>Ge(tt,` ${C(qe)??""}`)),W(Ce,pt)}),P(zo),P(ca);var Go=te(ca,2),vf=te(R(Go),2);return vf.__click=[AZ,Z],P(Go),P(jo),P(fa),Re(()=>N2(fa,"is-active",C(Z))),W(r,di),xt({GetSelectedRows:Xe})}Or(["click","change"]);Or(["click"]);function PZ(r,e,t,n,i,s){H(e,Y(r.target.value)),H(t,Y(n().filter(a=>a.name.toLowerCase().includes(C(e).toLowerCase())))),i(null),H(s,!0)}var RZ=J('<div><label class="label"> </label></div>'),QZ=J("<p> </p>"),FZ=(r,e,t)=>e(C(t)),$Z=J('<a href="#" class="dropdown-item ajust-item svelte-9nqlte"> </a>'),NZ=J('<div class="dropdown is-active"><div class="dropdown-menu" role="menu"><div class="dropdown-content svelte-9nqlte"></div></div></div>'),DZ=J('<div class="field is-horizontal"><!> <div class="field-body"><div class="field"><div class="control has-icons-left"><input type="text"> <span class="icon is-small is-left"><i></i></span></div> <!> <input type="hidden"> <!></div></div></div>');function cC(r,e){Ot(e,!0);let t=me(e,"options",27,()=>Y([{name:"Manzana",value:"1"},{name:"Durazno",value:"2"}])),n=me(e,"label",11,""),i=me(e,"selectedValue",15,null),s=me(e,"classLabel",11,"is-small"),a=me(e,"classInput",11,"is-small"),o=me(e,"placeholder",11,"Type to see options"),l=me(e,"classIcon",11,"fa-solid fa-keyboard"),f=me(e,"classOnSucess",11,"is-success"),c=me(e,"classOnError",11,"is-danger"),h=me(e,"onselect",3,()=>{}),u=be(Y(t())),d=be(!1),p=be("");function m(K){H(p,Y(K.name)),i(K.value),H(d,!1),h()(Ht(K))}function g(){C(p)?H(u,Y(t().filter(K=>K.name.toLowerCase().includes(C(p).toLowerCase())))):H(u,Y([]))}let v=Pa(()=>t().find(K=>K.value.includes(i())));It(()=>{var K;H(p,Y((K=t().find(re=>re.value===i()))==null?void 0:K.name))});var w=DZ(),x=R(w);{var S=K=>{var re=RZ(),ge=R(re),V=R(ge,!0);P(ge),P(re),Re(()=>{ft(re,`field-label ${s()??""} svelte-9nqlte`),Ge(V,n())}),W(K,re)};se(x,K=>{n()&&n().length>0&&K(S)})}var y=te(x,2),b=R(y),O=R(b),T=R(O);Et(T),T.__input=[PZ,p,u,t,i,d];var k=te(T,2),Q=R(k);P(k),P(O);var A=te(O,2);{var _=K=>{var re=QZ(),ge=R(re);P(re),Re(()=>{ft(re,`help ${c()??""} is-small svelte-9nqlte`),Ge(ge,`The selected value ${i()??""} is not valid.`)}),W(K,re)};se(A,K=>{C(v)||K(_)})}var N=te(A,2);Et(N);var U=te(N,2);{var z=K=>{var re=NZ(),ge=R(re),V=R(ge);Pr(V,21,()=>C(u),Lr,(he,ae)=>{var E=$Z();E.__click=[FZ,m,ae];var L=R(E,!0);P(E),Re(()=>Ge(L,C(ae).name)),W(he,E)}),P(V),P(ge),P(re),W(K,re)};se(U,K=>{C(d)&&C(u).length>0&&K(z)})}P(b),P(y),P(w),Re(()=>{ft(T,`input ${a()??""} ${(C(v)?f():c())??""} svelte-9nqlte`),Ra(T,"placeholder",o()),ft(Q,oi(l()),"svelte-9nqlte")}),c3("focus",T,g),Xt(T,()=>C(p),K=>H(p,K)),Xt(N,i),W(r,w),xt()}Or(["input","click"]);var MZ={value:()=>{}};function hC(){for(var r=0,e=arguments.length,t={},n;r<e;++r){if(!(n=arguments[r]+"")||n in t||/[\s.]/.test(n))throw new Error("illegal type: "+n);t[n]=[]}return new Iu(t)}function Iu(r){this._=r}function IZ(r,e){return r.trim().split(/^|\s+/).map(function(t){var n="",i=t.indexOf(".");if(i>=0&&(n=t.slice(i+1),t=t.slice(0,i)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}})}Iu.prototype=hC.prototype={constructor:Iu,on:function(r,e){var t=this._,n=IZ(r+"",t),i,s=-1,a=n.length;if(arguments.length<2){for(;++s<a;)if((i=(r=n[s]).type)&&(i=LZ(t[i],r.name)))return i;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++s<a;)if(i=(r=n[s]).type)t[i]=nw(t[i],r.name,e);else if(e==null)for(i in t)t[i]=nw(t[i],r.name,null);return this},copy:function(){var r={},e=this._;for(var t in e)r[t]=e[t].slice();return new Iu(r)},call:function(r,e){if((i=arguments.length-2)>0)for(var t=new Array(i),n=0,i,s;n<i;++n)t[n]=arguments[n+2];if(!this._.hasOwnProperty(r))throw new Error("unknown type: "+r);for(s=this._[r],n=0,i=s.length;n<i;++n)s[n].value.apply(e,t)},apply:function(r,e,t){if(!this._.hasOwnProperty(r))throw new Error("unknown type: "+r);for(var n=this._[r],i=0,s=n.length;i<s;++i)n[i].value.apply(e,t)}};function LZ(r,e){for(var t=0,n=r.length,i;t<n;++t)if((i=r[t]).name===e)return i.value}function nw(r,e,t){for(var n=0,i=r.length;n<i;++n)if(r[n].name===e){r[n]=MZ,r=r.slice(0,n).concat(r.slice(n+1));break}return t!=null&&r.push({name:e,value:t}),r}var tg="http://www.w3.org/1999/xhtml";const iw={svg:"http://www.w3.org/2000/svg",xhtml:tg,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function N0(r){var e=r+="",t=e.indexOf(":");return t>=0&&(e=r.slice(0,t))!=="xmlns"&&(r=r.slice(t+1)),iw.hasOwnProperty(e)?{space:iw[e],local:r}:r}function BZ(r){return function(){var e=this.ownerDocument,t=this.namespaceURI;return t===tg&&e.documentElement.namespaceURI===tg?e.createElement(r):e.createElementNS(t,r)}}function ZZ(r){return function(){return this.ownerDocument.createElementNS(r.space,r.local)}}function uC(r){var e=N0(r);return(e.local?ZZ:BZ)(e)}function WZ(){}function ix(r){return r==null?WZ:function(){return this.querySelector(r)}}function UZ(r){typeof r!="function"&&(r=ix(r));for(var e=this._groups,t=e.length,n=new Array(t),i=0;i<t;++i)for(var s=e[i],a=s.length,o=n[i]=new Array(a),l,f,c=0;c<a;++c)(l=s[c])&&(f=r.call(l,l.__data__,c,s))&&("__data__"in l&&(f.__data__=l.__data__),o[c]=f);return new Hi(n,this._parents)}function XZ(r){return r==null?[]:Array.isArray(r)?r:Array.from(r)}function VZ(){return[]}function dC(r){return r==null?VZ:function(){return this.querySelectorAll(r)}}function qZ(r){return function(){return XZ(r.apply(this,arguments))}}function jZ(r){typeof r=="function"?r=qZ(r):r=dC(r);for(var e=this._groups,t=e.length,n=[],i=[],s=0;s<t;++s)for(var a=e[s],o=a.length,l,f=0;f<o;++f)(l=a[f])&&(n.push(r.call(l,l.__data__,f,a)),i.push(l));return new Hi(n,i)}function pC(r){return function(){return this.matches(r)}}function mC(r){return function(e){return e.matches(r)}}var zZ=Array.prototype.find;function GZ(r){return function(){return zZ.call(this.children,r)}}function HZ(){return this.firstElementChild}function YZ(r){return this.select(r==null?HZ:GZ(typeof r=="function"?r:mC(r)))}var KZ=Array.prototype.filter;function JZ(){return Array.from(this.children)}function eW(r){return function(){return KZ.call(this.children,r)}}function tW(r){return this.selectAll(r==null?JZ:eW(typeof r=="function"?r:mC(r)))}function rW(r){typeof r!="function"&&(r=pC(r));for(var e=this._groups,t=e.length,n=new Array(t),i=0;i<t;++i)for(var s=e[i],a=s.length,o=n[i]=[],l,f=0;f<a;++f)(l=s[f])&&r.call(l,l.__data__,f,s)&&o.push(l);return new Hi(n,this._parents)}function gC(r){return new Array(r.length)}function nW(){return new Hi(this._enter||this._groups.map(gC),this._parents)}function Fd(r,e){this.ownerDocument=r.ownerDocument,this.namespaceURI=r.namespaceURI,this._next=null,this._parent=r,this.__data__=e}Fd.prototype={constructor:Fd,appendChild:function(r){return this._parent.insertBefore(r,this._next)},insertBefore:function(r,e){return this._parent.insertBefore(r,e)},querySelector:function(r){return this._parent.querySelector(r)},querySelectorAll:function(r){return this._parent.querySelectorAll(r)}};function iW(r){return function(){return r}}function sW(r,e,t,n,i,s){for(var a=0,o,l=e.length,f=s.length;a<f;++a)(o=e[a])?(o.__data__=s[a],n[a]=o):t[a]=new Fd(r,s[a]);for(;a<l;++a)(o=e[a])&&(i[a]=o)}function aW(r,e,t,n,i,s,a){var o,l,f=new Map,c=e.length,h=s.length,u=new Array(c),d;for(o=0;o<c;++o)(l=e[o])&&(u[o]=d=a.call(l,l.__data__,o,e)+"",f.has(d)?i[o]=l:f.set(d,l));for(o=0;o<h;++o)d=a.call(r,s[o],o,s)+"",(l=f.get(d))?(n[o]=l,l.__data__=s[o],f.delete(d)):t[o]=new Fd(r,s[o]);for(o=0;o<c;++o)(l=e[o])&&f.get(u[o])===l&&(i[o]=l)}function oW(r){return r.__data__}function lW(r,e){if(!arguments.length)return Array.from(this,oW);var t=e?aW:sW,n=this._parents,i=this._groups;typeof r!="function"&&(r=iW(r));for(var s=i.length,a=new Array(s),o=new Array(s),l=new Array(s),f=0;f<s;++f){var c=n[f],h=i[f],u=h.length,d=fW(r.call(c,c&&c.__data__,f,n)),p=d.length,m=o[f]=new Array(p),g=a[f]=new Array(p),v=l[f]=new Array(u);t(c,h,m,g,v,d,e);for(var w=0,x=0,S,y;w<p;++w)if(S=m[w]){for(w>=x&&(x=w+1);!(y=g[x])&&++x<p;);S._next=y||null}}return a=new Hi(a,n),a._enter=o,a._exit=l,a}function fW(r){return typeof r=="object"&&"length"in r?r:Array.from(r)}function cW(){return new Hi(this._exit||this._groups.map(gC),this._parents)}function hW(r,e,t){var n=this.enter(),i=this,s=this.exit();return typeof r=="function"?(n=r(n),n&&(n=n.selection())):n=n.append(r+""),e!=null&&(i=e(i),i&&(i=i.selection())),t==null?s.remove():t(s),n&&i?n.merge(i).order():i}function uW(r){for(var e=r.selection?r.selection():r,t=this._groups,n=e._groups,i=t.length,s=n.length,a=Math.min(i,s),o=new Array(i),l=0;l<a;++l)for(var f=t[l],c=n[l],h=f.length,u=o[l]=new Array(h),d,p=0;p<h;++p)(d=f[p]||c[p])&&(u[p]=d);for(;l<i;++l)o[l]=t[l];return new Hi(o,this._parents)}function dW(){for(var r=this._groups,e=-1,t=r.length;++e<t;)for(var n=r[e],i=n.length-1,s=n[i],a;--i>=0;)(a=n[i])&&(s&&a.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(a,s),s=a);return this}function pW(r){r||(r=mW);function e(h,u){return h&&u?r(h.__data__,u.__data__):!h-!u}for(var t=this._groups,n=t.length,i=new Array(n),s=0;s<n;++s){for(var a=t[s],o=a.length,l=i[s]=new Array(o),f,c=0;c<o;++c)(f=a[c])&&(l[c]=f);l.sort(e)}return new Hi(i,this._parents).order()}function mW(r,e){return r<e?-1:r>e?1:r>=e?0:NaN}function gW(){var r=arguments[0];return arguments[0]=this,r.apply(null,arguments),this}function OW(){return Array.from(this)}function xW(){for(var r=this._groups,e=0,t=r.length;e<t;++e)for(var n=r[e],i=0,s=n.length;i<s;++i){var a=n[i];if(a)return a}return null}function vW(){let r=0;for(const e of this)++r;return r}function yW(){return!this.node()}function wW(r){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var i=e[t],s=0,a=i.length,o;s<a;++s)(o=i[s])&&r.call(o,o.__data__,s,i);return this}function bW(r){return function(){this.removeAttribute(r)}}function _W(r){return function(){this.removeAttributeNS(r.space,r.local)}}function kW(r,e){return function(){this.setAttribute(r,e)}}function SW(r,e){return function(){this.setAttributeNS(r.space,r.local,e)}}function TW(r,e){return function(){var t=e.apply(this,arguments);t==null?this.removeAttribute(r):this.setAttribute(r,t)}}function CW(r,e){return function(){var t=e.apply(this,arguments);t==null?this.removeAttributeNS(r.space,r.local):this.setAttributeNS(r.space,r.local,t)}}function AW(r,e){var t=N0(r);if(arguments.length<2){var n=this.node();return t.local?n.getAttributeNS(t.space,t.local):n.getAttribute(t)}return this.each((e==null?t.local?_W:bW:typeof e=="function"?t.local?CW:TW:t.local?SW:kW)(t,e))}function OC(r){return r.ownerDocument&&r.ownerDocument.defaultView||r.document&&r||r.defaultView}function EW(r){return function(){this.style.removeProperty(r)}}function PW(r,e,t){return function(){this.style.setProperty(r,e,t)}}function RW(r,e,t){return function(){var n=e.apply(this,arguments);n==null?this.style.removeProperty(r):this.style.setProperty(r,n,t)}}function QW(r,e,t){return arguments.length>1?this.each((e==null?EW:typeof e=="function"?RW:PW)(r,e,t??"")):Ll(this.node(),r)}function Ll(r,e){return r.style.getPropertyValue(e)||OC(r).getComputedStyle(r,null).getPropertyValue(e)}function FW(r){return function(){delete this[r]}}function $W(r,e){return function(){this[r]=e}}function NW(r,e){return function(){var t=e.apply(this,arguments);t==null?delete this[r]:this[r]=t}}function DW(r,e){return arguments.length>1?this.each((e==null?FW:typeof e=="function"?NW:$W)(r,e)):this.node()[r]}function xC(r){return r.trim().split(/^|\s+/)}function sx(r){return r.classList||new vC(r)}function vC(r){this._node=r,this._names=xC(r.getAttribute("class")||"")}vC.prototype={add:function(r){var e=this._names.indexOf(r);e<0&&(this._names.push(r),this._node.setAttribute("class",this._names.join(" ")))},remove:function(r){var e=this._names.indexOf(r);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(r){return this._names.indexOf(r)>=0}};function yC(r,e){for(var t=sx(r),n=-1,i=e.length;++n<i;)t.add(e[n])}function wC(r,e){for(var t=sx(r),n=-1,i=e.length;++n<i;)t.remove(e[n])}function MW(r){return function(){yC(this,r)}}function IW(r){return function(){wC(this,r)}}function LW(r,e){return function(){(e.apply(this,arguments)?yC:wC)(this,r)}}function BW(r,e){var t=xC(r+"");if(arguments.length<2){for(var n=sx(this.node()),i=-1,s=t.length;++i<s;)if(!n.contains(t[i]))return!1;return!0}return this.each((typeof e=="function"?LW:e?MW:IW)(t,e))}function ZW(){this.textContent=""}function WW(r){return function(){this.textContent=r}}function UW(r){return function(){var e=r.apply(this,arguments);this.textContent=e??""}}function XW(r){return arguments.length?this.each(r==null?ZW:(typeof r=="function"?UW:WW)(r)):this.node().textContent}function VW(){this.innerHTML=""}function qW(r){return function(){this.innerHTML=r}}function jW(r){return function(){var e=r.apply(this,arguments);this.innerHTML=e??""}}function zW(r){return arguments.length?this.each(r==null?VW:(typeof r=="function"?jW:qW)(r)):this.node().innerHTML}function GW(){this.nextSibling&&this.parentNode.appendChild(this)}function HW(){return this.each(GW)}function YW(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function KW(){return this.each(YW)}function JW(r){var e=typeof r=="function"?r:uC(r);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function eU(){return null}function tU(r,e){var t=typeof r=="function"?r:uC(r),n=e==null?eU:typeof e=="function"?e:ix(e);return this.select(function(){return this.insertBefore(t.apply(this,arguments),n.apply(this,arguments)||null)})}function rU(){var r=this.parentNode;r&&r.removeChild(this)}function nU(){return this.each(rU)}function iU(){var r=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(r,this.nextSibling):r}function sU(){var r=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(r,this.nextSibling):r}function aU(r){return this.select(r?sU:iU)}function oU(r){return arguments.length?this.property("__data__",r):this.node().__data__}function lU(r){return function(e){r.call(this,e,this.__data__)}}function fU(r){return r.trim().split(/^|\s+/).map(function(e){var t="",n=e.indexOf(".");return n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),{type:e,name:t}})}function cU(r){return function(){var e=this.__on;if(e){for(var t=0,n=-1,i=e.length,s;t<i;++t)s=e[t],(!r.type||s.type===r.type)&&s.name===r.name?this.removeEventListener(s.type,s.listener,s.options):e[++n]=s;++n?e.length=n:delete this.__on}}}function hU(r,e,t){return function(){var n=this.__on,i,s=lU(e);if(n){for(var a=0,o=n.length;a<o;++a)if((i=n[a]).type===r.type&&i.name===r.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=s,i.options=t),i.value=e;return}}this.addEventListener(r.type,s,t),i={type:r.type,name:r.name,value:e,listener:s,options:t},n?n.push(i):this.__on=[i]}}function uU(r,e,t){var n=fU(r+""),i,s=n.length,a;if(arguments.length<2){var o=this.node().__on;if(o){for(var l=0,f=o.length,c;l<f;++l)for(i=0,c=o[l];i<s;++i)if((a=n[i]).type===c.type&&a.name===c.name)return c.value}return}for(o=e?hU:cU,i=0;i<s;++i)this.each(o(n[i],e,t));return this}function bC(r,e,t){var n=OC(r),i=n.CustomEvent;typeof i=="function"?i=new i(e,t):(i=n.document.createEvent("Event"),t?(i.initEvent(e,t.bubbles,t.cancelable),i.detail=t.detail):i.initEvent(e,!1,!1)),r.dispatchEvent(i)}function dU(r,e){return function(){return bC(this,r,e)}}function pU(r,e){return function(){return bC(this,r,e.apply(this,arguments))}}function mU(r,e){return this.each((typeof e=="function"?pU:dU)(r,e))}function*gU(){for(var r=this._groups,e=0,t=r.length;e<t;++e)for(var n=r[e],i=0,s=n.length,a;i<s;++i)(a=n[i])&&(yield a)}var OU=[null];function Hi(r,e){this._groups=r,this._parents=e}function Ch(){return new Hi([[document.documentElement]],OU)}function xU(){return this}Hi.prototype=Ch.prototype={constructor:Hi,select:UZ,selectAll:jZ,selectChild:YZ,selectChildren:tW,filter:rW,data:lW,enter:nW,exit:cW,join:hW,merge:uW,selection:xU,order:dW,sort:pW,call:gW,nodes:OW,node:xW,size:vW,empty:yW,each:wW,attr:AW,style:QW,property:DW,classed:BW,text:XW,html:zW,raise:HW,lower:KW,append:JW,insert:tU,remove:nU,clone:aU,datum:oU,on:uU,dispatch:mU,[Symbol.iterator]:gU};function ax(r,e,t){r.prototype=e.prototype=t,t.constructor=r}function _C(r,e){var t=Object.create(r.prototype);for(var n in e)t[n]=e[n];return t}function Ah(){}var Mc=.7,$d=1/Mc,Tl="\\s*([+-]?\\d+)\\s*",Ic="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",ws="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",vU=/^#([0-9a-f]{3,8})$/,yU=new RegExp(`^rgb\\(${Tl},${Tl},${Tl}\\)$`),wU=new RegExp(`^rgb\\(${ws},${ws},${ws}\\)$`),bU=new RegExp(`^rgba\\(${Tl},${Tl},${Tl},${Ic}\\)$`),_U=new RegExp(`^rgba\\(${ws},${ws},${ws},${Ic}\\)$`),kU=new RegExp(`^hsl\\(${Ic},${ws},${ws}\\)$`),SU=new RegExp(`^hsla\\(${Ic},${ws},${ws},${Ic}\\)$`),sw={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};ax(Ah,Lc,{copy(r){return Object.assign(new this.constructor,this,r)},displayable(){return this.rgb().displayable()},hex:aw,formatHex:aw,formatHex8:TU,formatHsl:CU,formatRgb:ow,toString:ow});function aw(){return this.rgb().formatHex()}function TU(){return this.rgb().formatHex8()}function CU(){return kC(this).formatHsl()}function ow(){return this.rgb().formatRgb()}function Lc(r){var e,t;return r=(r+"").trim().toLowerCase(),(e=vU.exec(r))?(t=e[1].length,e=parseInt(e[1],16),t===6?lw(e):t===3?new qn(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):t===8?Jh(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):t===4?Jh(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=yU.exec(r))?new qn(e[1],e[2],e[3],1):(e=wU.exec(r))?new qn(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=bU.exec(r))?Jh(e[1],e[2],e[3],e[4]):(e=_U.exec(r))?Jh(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=kU.exec(r))?hw(e[1],e[2]/100,e[3]/100,1):(e=SU.exec(r))?hw(e[1],e[2]/100,e[3]/100,e[4]):sw.hasOwnProperty(r)?lw(sw[r]):r==="transparent"?new qn(NaN,NaN,NaN,0):null}function lw(r){return new qn(r>>16&255,r>>8&255,r&255,1)}function Jh(r,e,t,n){return n<=0&&(r=e=t=NaN),new qn(r,e,t,n)}function AU(r){return r instanceof Ah||(r=Lc(r)),r?(r=r.rgb(),new qn(r.r,r.g,r.b,r.opacity)):new qn}function rg(r,e,t,n){return arguments.length===1?AU(r):new qn(r,e,t,n??1)}function qn(r,e,t,n){this.r=+r,this.g=+e,this.b=+t,this.opacity=+n}ax(qn,rg,_C(Ah,{brighter(r){return r=r==null?$d:Math.pow($d,r),new qn(this.r*r,this.g*r,this.b*r,this.opacity)},darker(r){return r=r==null?Mc:Math.pow(Mc,r),new qn(this.r*r,this.g*r,this.b*r,this.opacity)},rgb(){return this},clamp(){return new qn(bo(this.r),bo(this.g),bo(this.b),Nd(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:fw,formatHex:fw,formatHex8:EU,formatRgb:cw,toString:cw}));function fw(){return`#${po(this.r)}${po(this.g)}${po(this.b)}`}function EU(){return`#${po(this.r)}${po(this.g)}${po(this.b)}${po((isNaN(this.opacity)?1:this.opacity)*255)}`}function cw(){const r=Nd(this.opacity);return`${r===1?"rgb(":"rgba("}${bo(this.r)}, ${bo(this.g)}, ${bo(this.b)}${r===1?")":`, ${r})`}`}function Nd(r){return isNaN(r)?1:Math.max(0,Math.min(1,r))}function bo(r){return Math.max(0,Math.min(255,Math.round(r)||0))}function po(r){return r=bo(r),(r<16?"0":"")+r.toString(16)}function hw(r,e,t,n){return n<=0?r=e=t=NaN:t<=0||t>=1?r=e=NaN:e<=0&&(r=NaN),new Ii(r,e,t,n)}function kC(r){if(r instanceof Ii)return new Ii(r.h,r.s,r.l,r.opacity);if(r instanceof Ah||(r=Lc(r)),!r)return new Ii;if(r instanceof Ii)return r;r=r.rgb();var e=r.r/255,t=r.g/255,n=r.b/255,i=Math.min(e,t,n),s=Math.max(e,t,n),a=NaN,o=s-i,l=(s+i)/2;return o?(e===s?a=(t-n)/o+(t<n)*6:t===s?a=(n-e)/o+2:a=(e-t)/o+4,o/=l<.5?s+i:2-s-i,a*=60):o=l>0&&l<1?0:a,new Ii(a,o,l,r.opacity)}function PU(r,e,t,n){return arguments.length===1?kC(r):new Ii(r,e,t,n??1)}function Ii(r,e,t,n){this.h=+r,this.s=+e,this.l=+t,this.opacity=+n}ax(Ii,PU,_C(Ah,{brighter(r){return r=r==null?$d:Math.pow($d,r),new Ii(this.h,this.s,this.l*r,this.opacity)},darker(r){return r=r==null?Mc:Math.pow(Mc,r),new Ii(this.h,this.s,this.l*r,this.opacity)},rgb(){var r=this.h%360+(this.h<0)*360,e=isNaN(r)||isNaN(this.s)?0:this.s,t=this.l,n=t+(t<.5?t:1-t)*e,i=2*t-n;return new qn(Sp(r>=240?r-240:r+120,i,n),Sp(r,i,n),Sp(r<120?r+240:r-120,i,n),this.opacity)},clamp(){return new Ii(uw(this.h),eu(this.s),eu(this.l),Nd(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const r=Nd(this.opacity);return`${r===1?"hsl(":"hsla("}${uw(this.h)}, ${eu(this.s)*100}%, ${eu(this.l)*100}%${r===1?")":`, ${r})`}`}}));function uw(r){return r=(r||0)%360,r<0?r+360:r}function eu(r){return Math.max(0,Math.min(1,r||0))}function Sp(r,e,t){return(r<60?e+(t-e)*r/60:r<180?t:r<240?e+(t-e)*(240-r)/60:e)*255}const SC=r=>()=>r;function RU(r,e){return function(t){return r+t*e}}function QU(r,e,t){return r=Math.pow(r,t),e=Math.pow(e,t)-r,t=1/t,function(n){return Math.pow(r+n*e,t)}}function FU(r){return(r=+r)==1?TC:function(e,t){return t-e?QU(e,t,r):SC(isNaN(e)?t:e)}}function TC(r,e){var t=e-r;return t?RU(r,t):SC(isNaN(r)?e:r)}const dw=function r(e){var t=FU(e);function n(i,s){var a=t((i=rg(i)).r,(s=rg(s)).r),o=t(i.g,s.g),l=t(i.b,s.b),f=TC(i.opacity,s.opacity);return function(c){return i.r=a(c),i.g=o(c),i.b=l(c),i.opacity=f(c),i+""}}return n.gamma=r,n}(1);function Oa(r,e){return r=+r,e=+e,function(t){return r*(1-t)+e*t}}var ng=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Tp=new RegExp(ng.source,"g");function $U(r){return function(){return r}}function NU(r){return function(e){return r(e)+""}}function DU(r,e){var t=ng.lastIndex=Tp.lastIndex=0,n,i,s,a=-1,o=[],l=[];for(r=r+"",e=e+"";(n=ng.exec(r))&&(i=Tp.exec(e));)(s=i.index)>t&&(s=e.slice(t,s),o[a]?o[a]+=s:o[++a]=s),(n=n[0])===(i=i[0])?o[a]?o[a]+=i:o[++a]=i:(o[++a]=null,l.push({i:a,x:Oa(n,i)})),t=Tp.lastIndex;return t<e.length&&(s=e.slice(t),o[a]?o[a]+=s:o[++a]=s),o.length<2?l[0]?NU(l[0].x):$U(e):(e=l.length,function(f){for(var c=0,h;c<e;++c)o[(h=l[c]).i]=h.x(f);return o.join("")})}var pw=180/Math.PI,ig={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function CC(r,e,t,n,i,s){var a,o,l;return(a=Math.sqrt(r*r+e*e))&&(r/=a,e/=a),(l=r*t+e*n)&&(t-=r*l,n-=e*l),(o=Math.sqrt(t*t+n*n))&&(t/=o,n/=o,l/=o),r*n<e*t&&(r=-r,e=-e,l=-l,a=-a),{translateX:i,translateY:s,rotate:Math.atan2(e,r)*pw,skewX:Math.atan(l)*pw,scaleX:a,scaleY:o}}var tu;function MU(r){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(r+"");return e.isIdentity?ig:CC(e.a,e.b,e.c,e.d,e.e,e.f)}function IU(r){return r==null||(tu||(tu=document.createElementNS("http://www.w3.org/2000/svg","g")),tu.setAttribute("transform",r),!(r=tu.transform.baseVal.consolidate()))?ig:(r=r.matrix,CC(r.a,r.b,r.c,r.d,r.e,r.f))}function AC(r,e,t,n){function i(f){return f.length?f.pop()+" ":""}function s(f,c,h,u,d,p){if(f!==h||c!==u){var m=d.push("translate(",null,e,null,t);p.push({i:m-4,x:Oa(f,h)},{i:m-2,x:Oa(c,u)})}else(h||u)&&d.push("translate("+h+e+u+t)}function a(f,c,h,u){f!==c?(f-c>180?c+=360:c-f>180&&(f+=360),u.push({i:h.push(i(h)+"rotate(",null,n)-2,x:Oa(f,c)})):c&&h.push(i(h)+"rotate("+c+n)}function o(f,c,h,u){f!==c?u.push({i:h.push(i(h)+"skewX(",null,n)-2,x:Oa(f,c)}):c&&h.push(i(h)+"skewX("+c+n)}function l(f,c,h,u,d,p){if(f!==h||c!==u){var m=d.push(i(d)+"scale(",null,",",null,")");p.push({i:m-4,x:Oa(f,h)},{i:m-2,x:Oa(c,u)})}else(h!==1||u!==1)&&d.push(i(d)+"scale("+h+","+u+")")}return function(f,c){var h=[],u=[];return f=r(f),c=r(c),s(f.translateX,f.translateY,c.translateX,c.translateY,h,u),a(f.rotate,c.rotate,h,u),o(f.skewX,c.skewX,h,u),l(f.scaleX,f.scaleY,c.scaleX,c.scaleY,h,u),f=c=null,function(d){for(var p=-1,m=u.length,g;++p<m;)h[(g=u[p]).i]=g.x(d);return h.join("")}}}var LU=AC(MU,"px, ","px)","deg)"),BU=AC(IU,", ",")",")"),Bl=0,Uf=0,Sf=0,EC=1e3,Dd,Xf,Md=0,Fo=0,D0=0,Bc=typeof performance=="object"&&performance.now?performance:Date,PC=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(r){setTimeout(r,17)};function ox(){return Fo||(PC(ZU),Fo=Bc.now()+D0)}function ZU(){Fo=0}function Id(){this._call=this._time=this._next=null}Id.prototype=RC.prototype={constructor:Id,restart:function(r,e,t){if(typeof r!="function")throw new TypeError("callback is not a function");t=(t==null?ox():+t)+(e==null?0:+e),!this._next&&Xf!==this&&(Xf?Xf._next=this:Dd=this,Xf=this),this._call=r,this._time=t,sg()},stop:function(){this._call&&(this._call=null,this._time=1/0,sg())}};function RC(r,e,t){var n=new Id;return n.restart(r,e,t),n}function WU(){ox(),++Bl;for(var r=Dd,e;r;)(e=Fo-r._time)>=0&&r._call.call(void 0,e),r=r._next;--Bl}function mw(){Fo=(Md=Bc.now())+D0,Bl=Uf=0;try{WU()}finally{Bl=0,XU(),Fo=0}}function UU(){var r=Bc.now(),e=r-Md;e>EC&&(D0-=e,Md=r)}function XU(){for(var r,e=Dd,t,n=1/0;e;)e._call?(n>e._time&&(n=e._time),r=e,e=e._next):(t=e._next,e._next=null,e=r?r._next=t:Dd=t);Xf=r,sg(n)}function sg(r){if(!Bl){Uf&&(Uf=clearTimeout(Uf));var e=r-Fo;e>24?(r<1/0&&(Uf=setTimeout(mw,r-Bc.now()-D0)),Sf&&(Sf=clearInterval(Sf))):(Sf||(Md=Bc.now(),Sf=setInterval(UU,EC)),Bl=1,PC(mw))}}function gw(r,e,t){var n=new Id;return e=e==null?0:+e,n.restart(i=>{n.stop(),r(i+e)},e,t),n}var VU=hC("start","end","cancel","interrupt"),qU=[],QC=0,Ow=1,ag=2,Lu=3,xw=4,og=5,Bu=6;function M0(r,e,t,n,i,s){var a=r.__transition;if(!a)r.__transition={};else if(t in a)return;jU(r,t,{name:e,index:n,group:i,on:VU,tween:qU,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:QC})}function lx(r,e){var t=ts(r,e);if(t.state>QC)throw new Error("too late; already scheduled");return t}function Qs(r,e){var t=ts(r,e);if(t.state>Lu)throw new Error("too late; already running");return t}function ts(r,e){var t=r.__transition;if(!t||!(t=t[e]))throw new Error("transition not found");return t}function jU(r,e,t){var n=r.__transition,i;n[e]=t,t.timer=RC(s,0,t.time);function s(f){t.state=Ow,t.timer.restart(a,t.delay,t.time),t.delay<=f&&a(f-t.delay)}function a(f){var c,h,u,d;if(t.state!==Ow)return l();for(c in n)if(d=n[c],d.name===t.name){if(d.state===Lu)return gw(a);d.state===xw?(d.state=Bu,d.timer.stop(),d.on.call("interrupt",r,r.__data__,d.index,d.group),delete n[c]):+c<e&&(d.state=Bu,d.timer.stop(),d.on.call("cancel",r,r.__data__,d.index,d.group),delete n[c])}if(gw(function(){t.state===Lu&&(t.state=xw,t.timer.restart(o,t.delay,t.time),o(f))}),t.state=ag,t.on.call("start",r,r.__data__,t.index,t.group),t.state===ag){for(t.state=Lu,i=new Array(u=t.tween.length),c=0,h=-1;c<u;++c)(d=t.tween[c].value.call(r,r.__data__,t.index,t.group))&&(i[++h]=d);i.length=h+1}}function o(f){for(var c=f<t.duration?t.ease.call(null,f/t.duration):(t.timer.restart(l),t.state=og,1),h=-1,u=i.length;++h<u;)i[h].call(r,c);t.state===og&&(t.on.call("end",r,r.__data__,t.index,t.group),l())}function l(){t.state=Bu,t.timer.stop(),delete n[e];for(var f in n)return;delete r.__transition}}function zU(r,e){var t=r.__transition,n,i,s=!0,a;if(t){e=e==null?null:e+"";for(a in t){if((n=t[a]).name!==e){s=!1;continue}i=n.state>ag&&n.state<og,n.state=Bu,n.timer.stop(),n.on.call(i?"interrupt":"cancel",r,r.__data__,n.index,n.group),delete t[a]}s&&delete r.__transition}}function GU(r){return this.each(function(){zU(this,r)})}function HU(r,e){var t,n;return function(){var i=Qs(this,r),s=i.tween;if(s!==t){n=t=s;for(var a=0,o=n.length;a<o;++a)if(n[a].name===e){n=n.slice(),n.splice(a,1);break}}i.tween=n}}function YU(r,e,t){var n,i;if(typeof t!="function")throw new Error;return function(){var s=Qs(this,r),a=s.tween;if(a!==n){i=(n=a).slice();for(var o={name:e,value:t},l=0,f=i.length;l<f;++l)if(i[l].name===e){i[l]=o;break}l===f&&i.push(o)}s.tween=i}}function KU(r,e){var t=this._id;if(r+="",arguments.length<2){for(var n=ts(this.node(),t).tween,i=0,s=n.length,a;i<s;++i)if((a=n[i]).name===r)return a.value;return null}return this.each((e==null?HU:YU)(t,r,e))}function fx(r,e,t){var n=r._id;return r.each(function(){var i=Qs(this,n);(i.value||(i.value={}))[e]=t.apply(this,arguments)}),function(i){return ts(i,n).value[e]}}function FC(r,e){var t;return(typeof e=="number"?Oa:e instanceof Lc?dw:(t=Lc(e))?(e=t,dw):DU)(r,e)}function JU(r){return function(){this.removeAttribute(r)}}function eX(r){return function(){this.removeAttributeNS(r.space,r.local)}}function tX(r,e,t){var n,i=t+"",s;return function(){var a=this.getAttribute(r);return a===i?null:a===n?s:s=e(n=a,t)}}function rX(r,e,t){var n,i=t+"",s;return function(){var a=this.getAttributeNS(r.space,r.local);return a===i?null:a===n?s:s=e(n=a,t)}}function nX(r,e,t){var n,i,s;return function(){var a,o=t(this),l;return o==null?void this.removeAttribute(r):(a=this.getAttribute(r),l=o+"",a===l?null:a===n&&l===i?s:(i=l,s=e(n=a,o)))}}function iX(r,e,t){var n,i,s;return function(){var a,o=t(this),l;return o==null?void this.removeAttributeNS(r.space,r.local):(a=this.getAttributeNS(r.space,r.local),l=o+"",a===l?null:a===n&&l===i?s:(i=l,s=e(n=a,o)))}}function sX(r,e){var t=N0(r),n=t==="transform"?BU:FC;return this.attrTween(r,typeof e=="function"?(t.local?iX:nX)(t,n,fx(this,"attr."+r,e)):e==null?(t.local?eX:JU)(t):(t.local?rX:tX)(t,n,e))}function aX(r,e){return function(t){this.setAttribute(r,e.call(this,t))}}function oX(r,e){return function(t){this.setAttributeNS(r.space,r.local,e.call(this,t))}}function lX(r,e){var t,n;function i(){var s=e.apply(this,arguments);return s!==n&&(t=(n=s)&&oX(r,s)),t}return i._value=e,i}function fX(r,e){var t,n;function i(){var s=e.apply(this,arguments);return s!==n&&(t=(n=s)&&aX(r,s)),t}return i._value=e,i}function cX(r,e){var t="attr."+r;if(arguments.length<2)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;var n=N0(r);return this.tween(t,(n.local?lX:fX)(n,e))}function hX(r,e){return function(){lx(this,r).delay=+e.apply(this,arguments)}}function uX(r,e){return e=+e,function(){lx(this,r).delay=e}}function dX(r){var e=this._id;return arguments.length?this.each((typeof r=="function"?hX:uX)(e,r)):ts(this.node(),e).delay}function pX(r,e){return function(){Qs(this,r).duration=+e.apply(this,arguments)}}function mX(r,e){return e=+e,function(){Qs(this,r).duration=e}}function gX(r){var e=this._id;return arguments.length?this.each((typeof r=="function"?pX:mX)(e,r)):ts(this.node(),e).duration}function OX(r,e){if(typeof e!="function")throw new Error;return function(){Qs(this,r).ease=e}}function xX(r){var e=this._id;return arguments.length?this.each(OX(e,r)):ts(this.node(),e).ease}function vX(r,e){return function(){var t=e.apply(this,arguments);if(typeof t!="function")throw new Error;Qs(this,r).ease=t}}function yX(r){if(typeof r!="function")throw new Error;return this.each(vX(this._id,r))}function wX(r){typeof r!="function"&&(r=pC(r));for(var e=this._groups,t=e.length,n=new Array(t),i=0;i<t;++i)for(var s=e[i],a=s.length,o=n[i]=[],l,f=0;f<a;++f)(l=s[f])&&r.call(l,l.__data__,f,s)&&o.push(l);return new js(n,this._parents,this._name,this._id)}function bX(r){if(r._id!==this._id)throw new Error;for(var e=this._groups,t=r._groups,n=e.length,i=t.length,s=Math.min(n,i),a=new Array(n),o=0;o<s;++o)for(var l=e[o],f=t[o],c=l.length,h=a[o]=new Array(c),u,d=0;d<c;++d)(u=l[d]||f[d])&&(h[d]=u);for(;o<n;++o)a[o]=e[o];return new js(a,this._parents,this._name,this._id)}function _X(r){return(r+"").trim().split(/^|\s+/).every(function(e){var t=e.indexOf(".");return t>=0&&(e=e.slice(0,t)),!e||e==="start"})}function kX(r,e,t){var n,i,s=_X(e)?lx:Qs;return function(){var a=s(this,r),o=a.on;o!==n&&(i=(n=o).copy()).on(e,t),a.on=i}}function SX(r,e){var t=this._id;return arguments.length<2?ts(this.node(),t).on.on(r):this.each(kX(t,r,e))}function TX(r){return function(){var e=this.parentNode;for(var t in this.__transition)if(+t!==r)return;e&&e.removeChild(this)}}function CX(){return this.on("end.remove",TX(this._id))}function AX(r){var e=this._name,t=this._id;typeof r!="function"&&(r=ix(r));for(var n=this._groups,i=n.length,s=new Array(i),a=0;a<i;++a)for(var o=n[a],l=o.length,f=s[a]=new Array(l),c,h,u=0;u<l;++u)(c=o[u])&&(h=r.call(c,c.__data__,u,o))&&("__data__"in c&&(h.__data__=c.__data__),f[u]=h,M0(f[u],e,t,u,f,ts(c,t)));return new js(s,this._parents,e,t)}function EX(r){var e=this._name,t=this._id;typeof r!="function"&&(r=dC(r));for(var n=this._groups,i=n.length,s=[],a=[],o=0;o<i;++o)for(var l=n[o],f=l.length,c,h=0;h<f;++h)if(c=l[h]){for(var u=r.call(c,c.__data__,h,l),d,p=ts(c,t),m=0,g=u.length;m<g;++m)(d=u[m])&&M0(d,e,t,m,u,p);s.push(u),a.push(c)}return new js(s,a,e,t)}var PX=Ch.prototype.constructor;function RX(){return new PX(this._groups,this._parents)}function QX(r,e){var t,n,i;return function(){var s=Ll(this,r),a=(this.style.removeProperty(r),Ll(this,r));return s===a?null:s===t&&a===n?i:i=e(t=s,n=a)}}function $C(r){return function(){this.style.removeProperty(r)}}function FX(r,e,t){var n,i=t+"",s;return function(){var a=Ll(this,r);return a===i?null:a===n?s:s=e(n=a,t)}}function $X(r,e,t){var n,i,s;return function(){var a=Ll(this,r),o=t(this),l=o+"";return o==null&&(l=o=(this.style.removeProperty(r),Ll(this,r))),a===l?null:a===n&&l===i?s:(i=l,s=e(n=a,o))}}function NX(r,e){var t,n,i,s="style."+e,a="end."+s,o;return function(){var l=Qs(this,r),f=l.on,c=l.value[s]==null?o||(o=$C(e)):void 0;(f!==t||i!==c)&&(n=(t=f).copy()).on(a,i=c),l.on=n}}function DX(r,e,t){var n=(r+="")=="transform"?LU:FC;return e==null?this.styleTween(r,QX(r,n)).on("end.style."+r,$C(r)):typeof e=="function"?this.styleTween(r,$X(r,n,fx(this,"style."+r,e))).each(NX(this._id,r)):this.styleTween(r,FX(r,n,e),t).on("end.style."+r,null)}function MX(r,e,t){return function(n){this.style.setProperty(r,e.call(this,n),t)}}function IX(r,e,t){var n,i;function s(){var a=e.apply(this,arguments);return a!==i&&(n=(i=a)&&MX(r,a,t)),n}return s._value=e,s}function LX(r,e,t){var n="style."+(r+="");if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;return this.tween(n,IX(r,e,t??""))}function BX(r){return function(){this.textContent=r}}function ZX(r){return function(){var e=r(this);this.textContent=e??""}}function WX(r){return this.tween("text",typeof r=="function"?ZX(fx(this,"text",r)):BX(r==null?"":r+""))}function UX(r){return function(e){this.textContent=r.call(this,e)}}function XX(r){var e,t;function n(){var i=r.apply(this,arguments);return i!==t&&(e=(t=i)&&UX(i)),e}return n._value=r,n}function VX(r){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(r==null)return this.tween(e,null);if(typeof r!="function")throw new Error;return this.tween(e,XX(r))}function qX(){for(var r=this._name,e=this._id,t=NC(),n=this._groups,i=n.length,s=0;s<i;++s)for(var a=n[s],o=a.length,l,f=0;f<o;++f)if(l=a[f]){var c=ts(l,e);M0(l,r,t,f,a,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new js(n,this._parents,r,t)}function jX(){var r,e,t=this,n=t._id,i=t.size();return new Promise(function(s,a){var o={value:a},l={value:function(){--i===0&&s()}};t.each(function(){var f=Qs(this,n),c=f.on;c!==r&&(e=(r=c).copy(),e._.cancel.push(o),e._.interrupt.push(o),e._.end.push(l)),f.on=e}),i===0&&s()})}var zX=0;function js(r,e,t,n){this._groups=r,this._parents=e,this._name=t,this._id=n}function NC(){return++zX}var Is=Ch.prototype;js.prototype={constructor:js,select:AX,selectAll:EX,selectChild:Is.selectChild,selectChildren:Is.selectChildren,filter:wX,merge:bX,selection:RX,transition:qX,call:Is.call,nodes:Is.nodes,node:Is.node,size:Is.size,empty:Is.empty,each:Is.each,on:SX,attr:sX,attrTween:cX,style:DX,styleTween:LX,text:WX,textTween:VX,remove:CX,tween:KU,delay:dX,duration:gX,ease:xX,easeVarying:yX,end:jX,[Symbol.iterator]:Is[Symbol.iterator]};function GX(r){return((r*=2)<=1?r*r*r:(r-=2)*r*r+2)/2}var HX={time:null,delay:0,duration:250,ease:GX};function YX(r,e){for(var t;!(t=r.__transition)||!(t=t[e]);)if(!(r=r.parentNode))throw new Error(`transition ${e} not found`);return t}function KX(r){var e,t;r instanceof js?(e=r._id,r=r._name):(e=NC(),(t=HX).time=ox(),r=r==null?null:r+"");for(var n=this._groups,i=n.length,s=0;s<i;++s)for(var a=n[s],o=a.length,l,f=0;f<o;++f)(l=a[f])&&M0(l,r,e,f,a,t||YX(l,e));return new js(n,this._parents,r,e)}Ch.prototype.interrupt=GU;Ch.prototype.transition=KX;function Vf(r,e,t){this.k=r,this.x=e,this.y=t}Vf.prototype={constructor:Vf,scale:function(r){return r===1?this:new Vf(this.k*r,this.x,this.y)},translate:function(r,e){return r===0&e===0?this:new Vf(this.k,this.x+this.k*r,this.y+this.k*e)},apply:function(r){return[r[0]*this.k+this.x,r[1]*this.k+this.y]},applyX:function(r){return r*this.k+this.x},applyY:function(r){return r*this.k+this.y},invert:function(r){return[(r[0]-this.x)/this.k,(r[1]-this.y)/this.k]},invertX:function(r){return(r-this.x)/this.k},invertY:function(r){return(r-this.y)/this.k},rescaleX:function(r){return r.copy().domain(r.range().map(this.invertX,this).map(r.invert,r))},rescaleY:function(r){return r.copy().domain(r.range().map(this.invertY,this).map(r.invert,r))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};Vf.prototype;var JX=J('<span><i class="fa-solid fa-ban" aria-hidden="true"></i></span> <span> </span>',1),eV=J('<span><i aria-hidden="true"></i></span> <span> </span>',1),tV=J("<li><a><!></a></li>"),rV=J("<div><ul><!></ul></div> <!>",1);function Mn(r,e){Ot(e,!0);let t=me(e,"classSize",11,"is-small"),n=me(e,"tabs",27,()=>Y([{label:"Pictures",classIcon:"fas fa-picture",disabled:!0},{label:"Calcs",classIcon:"fas fa-picture"},{label:"Film",classIcon:"fas fa-film",disabled:!0}])),i=me(e,"active",15,0);var s=rV(),a=ye(s),o=R(a),l=R(o);{var f=u=>{var d=Ae(),p=ye(d);Pr(p,17,n,Lr,(m,g,v)=>{var w=tV(),x=R(w);x.__click=()=>{C(g).disabled||(i(v),e.onselect&&e.onselect({label:C(g).label,index:v}))};var S=R(x);{var y=O=>{var T=JX(),k=ye(T),Q=te(k,2),A=R(Q,!0);P(Q),Re(()=>{ft(k,`icon ${t()??""} svelte-5sjlmp`),Ge(A,C(g).label)}),W(O,T)},b=O=>{var T=Ae(),k=ye(T);{var Q=_=>{var N=eV(),U=ye(N),z=R(U);P(U);var K=te(U,2),re=R(K,!0);P(K),Re(()=>{ft(U,`icon ${t()??""} svelte-5sjlmp`),ft(z,oi(C(g).classIcon),"svelte-5sjlmp"),Ge(re,C(g).label)}),W(_,N)},A=_=>{var N=ms();Re(()=>Ge(N,C(g).label)),W(_,N)};se(k,_=>{C(g).classIcon&&C(g).classIcon.length>3?_(Q):_(A,!1)},!0)}W(O,T)};se(S,O=>{C(g).disabled?O(y):O(b,!1)})}P(x),P(w),Re(()=>ft(w,oi(i()==v?"is-active":""),"svelte-5sjlmp")),W(m,w)}),W(u,d)};se(l,u=>{n()&&u(f)})}P(o),P(a);var c=te(a,2);{var h=u=>{var d=Ae(),p=ye(d);Pr(p,17,n,Lr,(m,g,v)=>{var w=Ae(),x=ye(w);{var S=y=>{var b=Ae(),O=ye(b);{var T=k=>{var Q=Ae(),A=ye(Q);pd(A,()=>C(g).component??dd),W(k,Q)};se(O,k=>{C(g)&&C(g).component&&!C(g).disabled&&k(T)})}W(y,b)};se(x,y=>{i()==v&&y(S)})}W(m,w)}),W(u,d)};se(c,u=>{Array.isArray(n())&&u(h)})}Re(()=>ft(a,`tabs is-boxed ${t()??""} tabMargin svelte-5sjlmp`)),W(r,s),xt()}Or(["click"]);Or(["click"]);let lg=[],DC=[];(()=>{let r="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(e=>e?parseInt(e,36):1);for(let e=0,t=0;e<r.length;e++)(e%2?DC:lg).push(t=t+r[e])})();function nV(r){if(r<768)return!1;for(let e=0,t=lg.length;;){let n=e+t>>1;if(r<lg[n])t=n;else if(r>=DC[n])e=n+1;else return!0;if(e==t)return!1}}function vw(r){return r>=127462&&r<=127487}const yw=8205;function iV(r,e,t=!0,n=!0){return(t?MC:sV)(r,e,n)}function MC(r,e,t){if(e==r.length)return e;e&&IC(r.charCodeAt(e))&&LC(r.charCodeAt(e-1))&&e--;let n=Cp(r,e);for(e+=ww(n);e<r.length;){let i=Cp(r,e);if(n==yw||i==yw||t&&nV(i))e+=ww(i),n=i;else if(vw(i)){let s=0,a=e-2;for(;a>=0&&vw(Cp(r,a));)s++,a-=2;if(s%2==0)break;e+=2}else break}return e}function sV(r,e,t){for(;e>0;){let n=MC(r,e-2,t);if(n<e)return n;e--}return 0}function Cp(r,e){let t=r.charCodeAt(e);if(!LC(t)||e+1==r.length)return t;let n=r.charCodeAt(e+1);return IC(n)?(t-55296<<10)+(n-56320)+65536:t}function IC(r){return r>=56320&&r<57344}function LC(r){return r>=55296&&r<56320}function ww(r){return r<65536?1:2}let Nt=class BC{lineAt(e){if(e<0||e>this.length)throw new RangeError(`Invalid position ${e} in document of length ${this.length}`);return this.lineInner(e,!1,1,0)}line(e){if(e<1||e>this.lines)throw new RangeError(`Invalid line number ${e} in ${this.lines}-line document`);return this.lineInner(e,!0,1,0)}replace(e,t,n){[e,t]=Zl(this,e,t);let i=[];return this.decompose(0,e,i,2),n.length&&n.decompose(0,n.length,i,3),this.decompose(t,this.length,i,1),us.from(i,this.length-(t-e)+n.length)}append(e){return this.replace(this.length,this.length,e)}slice(e,t=this.length){[e,t]=Zl(this,e,t);let n=[];return this.decompose(e,t,n,0),us.from(n,t-e)}eq(e){if(e==this)return!0;if(e.length!=this.length||e.lines!=this.lines)return!1;let t=this.scanIdentical(e,1),n=this.length-this.scanIdentical(e,-1),i=new Oc(this),s=new Oc(e);for(let a=t,o=t;;){if(i.next(a),s.next(a),a=0,i.lineBreak!=s.lineBreak||i.done!=s.done||i.value!=s.value)return!1;if(o+=i.value.length,i.done||o>=n)return!0}}iter(e=1){return new Oc(this,e)}iterRange(e,t=this.length){return new ZC(this,e,t)}iterLines(e,t){let n;if(e==null)n=this.iter();else{t==null&&(t=this.lines+1);let i=this.line(e).from;n=this.iterRange(i,Math.max(i,t==this.lines+1?this.length:t<=1?0:this.line(t-1).to))}return new WC(n)}toString(){return this.sliceString(0)}toJSON(){let e=[];return this.flatten(e),e}constructor(){}static of(e){if(e.length==0)throw new RangeError("A document must have at least one line");return e.length==1&&!e[0]?BC.empty:e.length<=32?new Er(e):us.from(Er.split(e,[]))}};class Er extends Nt{constructor(e,t=aV(e)){super(),this.text=e,this.length=t}get lines(){return this.text.length}get children(){return null}lineInner(e,t,n,i){for(let s=0;;s++){let a=this.text[s],o=i+a.length;if((t?n:o)>=e)return new oV(i,o,n,a);i=o+1,n++}}decompose(e,t,n,i){let s=e<=0&&t>=this.length?this:new Er(bw(this.text,e,t),Math.min(t,this.length)-Math.max(0,e));if(i&1){let a=n.pop(),o=Zu(s.text,a.text.slice(),0,s.length);if(o.length<=32)n.push(new Er(o,a.length+s.length));else{let l=o.length>>1;n.push(new Er(o.slice(0,l)),new Er(o.slice(l)))}}else n.push(s)}replace(e,t,n){if(!(n instanceof Er))return super.replace(e,t,n);[e,t]=Zl(this,e,t);let i=Zu(this.text,Zu(n.text,bw(this.text,0,e)),t),s=this.length+n.length-(t-e);return i.length<=32?new Er(i,s):us.from(Er.split(i,[]),s)}sliceString(e,t=this.length,n=`
`){[e,t]=Zl(this,e,t);let i="";for(let s=0,a=0;s<=t&&a<this.text.length;a++){let o=this.text[a],l=s+o.length;s>e&&a&&(i+=n),e<l&&t>s&&(i+=o.slice(Math.max(0,e-s),t-s)),s=l+1}return i}flatten(e){for(let t of this.text)e.push(t)}scanIdentical(){return 0}static split(e,t){let n=[],i=-1;for(let s of e)n.push(s),i+=s.length+1,n.length==32&&(t.push(new Er(n,i)),n=[],i=-1);return i>-1&&t.push(new Er(n,i)),t}}class us extends Nt{constructor(e,t){super(),this.children=e,this.length=t,this.lines=0;for(let n of e)this.lines+=n.lines}lineInner(e,t,n,i){for(let s=0;;s++){let a=this.children[s],o=i+a.length,l=n+a.lines-1;if((t?l:o)>=e)return a.lineInner(e,t,n,i);i=o+1,n=l+1}}decompose(e,t,n,i){for(let s=0,a=0;a<=t&&s<this.children.length;s++){let o=this.children[s],l=a+o.length;if(e<=l&&t>=a){let f=i&((a<=e?1:0)|(l>=t?2:0));a>=e&&l<=t&&!f?n.push(o):o.decompose(e-a,t-a,n,f)}a=l+1}}replace(e,t,n){if([e,t]=Zl(this,e,t),n.lines<this.lines)for(let i=0,s=0;i<this.children.length;i++){let a=this.children[i],o=s+a.length;if(e>=s&&t<=o){let l=a.replace(e-s,t-s,n),f=this.lines-a.lines+l.lines;if(l.lines<f>>4&&l.lines>f>>6){let c=this.children.slice();return c[i]=l,new us(c,this.length-(t-e)+n.length)}return super.replace(s,o,l)}s=o+1}return super.replace(e,t,n)}sliceString(e,t=this.length,n=`
`){[e,t]=Zl(this,e,t);let i="";for(let s=0,a=0;s<this.children.length&&a<=t;s++){let o=this.children[s],l=a+o.length;a>e&&s&&(i+=n),e<l&&t>a&&(i+=o.sliceString(e-a,t-a,n)),a=l+1}return i}flatten(e){for(let t of this.children)t.flatten(e)}scanIdentical(e,t){if(!(e instanceof us))return 0;let n=0,[i,s,a,o]=t>0?[0,0,this.children.length,e.children.length]:[this.children.length-1,e.children.length-1,-1,-1];for(;;i+=t,s+=t){if(i==a||s==o)return n;let l=this.children[i],f=e.children[s];if(l!=f)return n+l.scanIdentical(f,t);n+=l.length+1}}static from(e,t=e.reduce((n,i)=>n+i.length+1,-1)){let n=0;for(let d of e)n+=d.lines;if(n<32){let d=[];for(let p of e)p.flatten(d);return new Er(d,t)}let i=Math.max(32,n>>5),s=i<<1,a=i>>1,o=[],l=0,f=-1,c=[];function h(d){let p;if(d.lines>s&&d instanceof us)for(let m of d.children)h(m);else d.lines>a&&(l>a||!l)?(u(),o.push(d)):d instanceof Er&&l&&(p=c[c.length-1])instanceof Er&&d.lines+p.lines<=32?(l+=d.lines,f+=d.length+1,c[c.length-1]=new Er(p.text.concat(d.text),p.length+1+d.length)):(l+d.lines>i&&u(),l+=d.lines,f+=d.length+1,c.push(d))}function u(){l!=0&&(o.push(c.length==1?c[0]:us.from(c,f)),f=-1,l=c.length=0)}for(let d of e)h(d);return u(),o.length==1?o[0]:new us(o,t)}}Nt.empty=new Er([""],0);function aV(r){let e=-1;for(let t of r)e+=t.length+1;return e}function Zu(r,e,t=0,n=1e9){for(let i=0,s=0,a=!0;s<r.length&&i<=n;s++){let o=r[s],l=i+o.length;l>=t&&(l>n&&(o=o.slice(0,n-i)),i<t&&(o=o.slice(t-i)),a?(e[e.length-1]+=o,a=!1):e.push(o)),i=l+1}return e}function bw(r,e,t){return Zu(r,[""],e,t)}class Oc{constructor(e,t=1){this.dir=t,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[e],this.offsets=[t>0?1:(e instanceof Er?e.text.length:e.children.length)<<1]}nextInner(e,t){for(this.done=this.lineBreak=!1;;){let n=this.nodes.length-1,i=this.nodes[n],s=this.offsets[n],a=s>>1,o=i instanceof Er?i.text.length:i.children.length;if(a==(t>0?o:0)){if(n==0)return this.done=!0,this.value="",this;t>0&&this.offsets[n-1]++,this.nodes.pop(),this.offsets.pop()}else if((s&1)==(t>0?0:1)){if(this.offsets[n]+=t,e==0)return this.lineBreak=!0,this.value=`
`,this;e--}else if(i instanceof Er){let l=i.text[a+(t<0?-1:0)];if(this.offsets[n]+=t,l.length>Math.max(0,e))return this.value=e==0?l:t>0?l.slice(e):l.slice(0,l.length-e),this;e-=l.length}else{let l=i.children[a+(t<0?-1:0)];e>l.length?(e-=l.length,this.offsets[n]+=t):(t<0&&this.offsets[n]--,this.nodes.push(l),this.offsets.push(t>0?1:(l instanceof Er?l.text.length:l.children.length)<<1))}}}next(e=0){return e<0&&(this.nextInner(-e,-this.dir),e=this.value.length),this.nextInner(e,this.dir)}}class ZC{constructor(e,t,n){this.value="",this.done=!1,this.cursor=new Oc(e,t>n?-1:1),this.pos=t>n?e.length:0,this.from=Math.min(t,n),this.to=Math.max(t,n)}nextInner(e,t){if(t<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;e+=Math.max(0,t<0?this.pos-this.to:this.from-this.pos);let n=t<0?this.pos-this.from:this.to-this.pos;e>n&&(e=n),n-=e;let{value:i}=this.cursor.next(e);return this.pos+=(i.length+e)*t,this.value=i.length<=n?i:t<0?i.slice(i.length-n):i.slice(0,n),this.done=!this.value,this}next(e=0){return e<0?e=Math.max(e,this.from-this.pos):e>0&&(e=Math.min(e,this.to-this.pos)),this.nextInner(e,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}}class WC{constructor(e){this.inner=e,this.afterBreak=!0,this.value="",this.done=!1}next(e=0){let{done:t,lineBreak:n,value:i}=this.inner.next(e);return t&&this.afterBreak?(this.value="",this.afterBreak=!1):t?(this.done=!0,this.value=""):n?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=i,this.afterBreak=!1),this}get lineBreak(){return!1}}typeof Symbol<"u"&&(Nt.prototype[Symbol.iterator]=function(){return this.iter()},Oc.prototype[Symbol.iterator]=ZC.prototype[Symbol.iterator]=WC.prototype[Symbol.iterator]=function(){return this});class oV{constructor(e,t,n,i){this.from=e,this.to=t,this.number=n,this.text=i}get length(){return this.to-this.from}}function Zl(r,e,t){return e=Math.max(0,Math.min(r.length,e)),[e,Math.max(e,Math.min(r.length,t))]}function un(r,e,t=!0,n=!0){return iV(r,e,t,n)}function lV(r){return r>=56320&&r<57344}function fV(r){return r>=55296&&r<56320}function Wn(r,e){let t=r.charCodeAt(e);if(!fV(t)||e+1==r.length)return t;let n=r.charCodeAt(e+1);return lV(n)?(t-55296<<10)+(n-56320)+65536:t}function cx(r){return r<=65535?String.fromCharCode(r):(r-=65536,String.fromCharCode((r>>10)+55296,(r&1023)+56320))}function ds(r){return r<65536?1:2}const fg=/\r\n?|\n/;var hn=function(r){return r[r.Simple=0]="Simple",r[r.TrackDel=1]="TrackDel",r[r.TrackBefore=2]="TrackBefore",r[r.TrackAfter=3]="TrackAfter",r}(hn||(hn={}));class bs{constructor(e){this.sections=e}get length(){let e=0;for(let t=0;t<this.sections.length;t+=2)e+=this.sections[t];return e}get newLength(){let e=0;for(let t=0;t<this.sections.length;t+=2){let n=this.sections[t+1];e+=n<0?this.sections[t]:n}return e}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(e){for(let t=0,n=0,i=0;t<this.sections.length;){let s=this.sections[t++],a=this.sections[t++];a<0?(e(n,i,s),i+=s):i+=a,n+=s}}iterChangedRanges(e,t=!1){cg(this,e,t)}get invertedDesc(){let e=[];for(let t=0;t<this.sections.length;){let n=this.sections[t++],i=this.sections[t++];i<0?e.push(n,i):e.push(i,n)}return new bs(e)}composeDesc(e){return this.empty?e:e.empty?this:UC(this,e)}mapDesc(e,t=!1){return e.empty?this:hg(this,e,t)}mapPos(e,t=-1,n=hn.Simple){let i=0,s=0;for(let a=0;a<this.sections.length;){let o=this.sections[a++],l=this.sections[a++],f=i+o;if(l<0){if(f>e)return s+(e-i);s+=o}else{if(n!=hn.Simple&&f>=e&&(n==hn.TrackDel&&i<e&&f>e||n==hn.TrackBefore&&i<e||n==hn.TrackAfter&&f>e))return null;if(f>e||f==e&&t<0&&!o)return e==i||t<0?s:s+l;s+=l}i=f}if(e>i)throw new RangeError(`Position ${e} is out of range for changeset of length ${i}`);return s}touchesRange(e,t=e){for(let n=0,i=0;n<this.sections.length&&i<=t;){let s=this.sections[n++],a=this.sections[n++],o=i+s;if(a>=0&&i<=t&&o>=e)return i<e&&o>t?"cover":!0;i=o}return!1}toString(){let e="";for(let t=0;t<this.sections.length;){let n=this.sections[t++],i=this.sections[t++];e+=(e?" ":"")+n+(i>=0?":"+i:"")}return e}toJSON(){return this.sections}static fromJSON(e){if(!Array.isArray(e)||e.length%2||e.some(t=>typeof t!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new bs(e)}static create(e){return new bs(e)}}class Ur extends bs{constructor(e,t){super(e),this.inserted=t}apply(e){if(this.length!=e.length)throw new RangeError("Applying change set to a document with the wrong length");return cg(this,(t,n,i,s,a)=>e=e.replace(i,i+(n-t),a),!1),e}mapDesc(e,t=!1){return hg(this,e,t,!0)}invert(e){let t=this.sections.slice(),n=[];for(let i=0,s=0;i<t.length;i+=2){let a=t[i],o=t[i+1];if(o>=0){t[i]=o,t[i+1]=a;let l=i>>1;for(;n.length<l;)n.push(Nt.empty);n.push(a?e.slice(s,s+a):Nt.empty)}s+=a}return new Ur(t,n)}compose(e){return this.empty?e:e.empty?this:UC(this,e,!0)}map(e,t=!1){return e.empty?this:hg(this,e,t,!0)}iterChanges(e,t=!1){cg(this,e,t)}get desc(){return bs.create(this.sections)}filter(e){let t=[],n=[],i=[],s=new Zc(this);e:for(let a=0,o=0;;){let l=a==e.length?1e9:e[a++];for(;o<l||o==l&&s.len==0;){if(s.done)break e;let c=Math.min(s.len,l-o);On(i,c,-1);let h=s.ins==-1?-1:s.off==0?s.ins:0;On(t,c,h),h>0&&Ta(n,t,s.text),s.forward(c),o+=c}let f=e[a++];for(;o<f;){if(s.done)break e;let c=Math.min(s.len,f-o);On(t,c,-1),On(i,c,s.ins==-1?-1:s.off==0?s.ins:0),s.forward(c),o+=c}}return{changes:new Ur(t,n),filtered:bs.create(i)}}toJSON(){let e=[];for(let t=0;t<this.sections.length;t+=2){let n=this.sections[t],i=this.sections[t+1];i<0?e.push(n):i==0?e.push([n]):e.push([n].concat(this.inserted[t>>1].toJSON()))}return e}static of(e,t,n){let i=[],s=[],a=0,o=null;function l(c=!1){if(!c&&!i.length)return;a<t&&On(i,t-a,-1);let h=new Ur(i,s);o=o?o.compose(h.map(o)):h,i=[],s=[],a=0}function f(c){if(Array.isArray(c))for(let h of c)f(h);else if(c instanceof Ur){if(c.length!=t)throw new RangeError(`Mismatched change set length (got ${c.length}, expected ${t})`);l(),o=o?o.compose(c.map(o)):c}else{let{from:h,to:u=h,insert:d}=c;if(h>u||h<0||u>t)throw new RangeError(`Invalid change range ${h} to ${u} (in doc of length ${t})`);let p=d?typeof d=="string"?Nt.of(d.split(n||fg)):d:Nt.empty,m=p.length;if(h==u&&m==0)return;h<a&&l(),h>a&&On(i,h-a,-1),On(i,u-h,m),Ta(s,i,p),a=u}}return f(e),l(!o),o}static empty(e){return new Ur(e?[e,-1]:[],[])}static fromJSON(e){if(!Array.isArray(e))throw new RangeError("Invalid JSON representation of ChangeSet");let t=[],n=[];for(let i=0;i<e.length;i++){let s=e[i];if(typeof s=="number")t.push(s,-1);else{if(!Array.isArray(s)||typeof s[0]!="number"||s.some((a,o)=>o&&typeof a!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(s.length==1)t.push(s[0],0);else{for(;n.length<i;)n.push(Nt.empty);n[i]=Nt.of(s.slice(1)),t.push(s[0],n[i].length)}}}return new Ur(t,n)}static createSet(e,t){return new Ur(e,t)}}function On(r,e,t,n=!1){if(e==0&&t<=0)return;let i=r.length-2;i>=0&&t<=0&&t==r[i+1]?r[i]+=e:i>=0&&e==0&&r[i]==0?r[i+1]+=t:n?(r[i]+=e,r[i+1]+=t):r.push(e,t)}function Ta(r,e,t){if(t.length==0)return;let n=e.length-2>>1;if(n<r.length)r[r.length-1]=r[r.length-1].append(t);else{for(;r.length<n;)r.push(Nt.empty);r.push(t)}}function cg(r,e,t){let n=r.inserted;for(let i=0,s=0,a=0;a<r.sections.length;){let o=r.sections[a++],l=r.sections[a++];if(l<0)i+=o,s+=o;else{let f=i,c=s,h=Nt.empty;for(;f+=o,c+=l,l&&n&&(h=h.append(n[a-2>>1])),!(t||a==r.sections.length||r.sections[a+1]<0);)o=r.sections[a++],l=r.sections[a++];e(i,f,s,c,h),i=f,s=c}}}function hg(r,e,t,n=!1){let i=[],s=n?[]:null,a=new Zc(r),o=new Zc(e);for(let l=-1;;){if(a.done&&o.len||o.done&&a.len)throw new Error("Mismatched change set lengths");if(a.ins==-1&&o.ins==-1){let f=Math.min(a.len,o.len);On(i,f,-1),a.forward(f),o.forward(f)}else if(o.ins>=0&&(a.ins<0||l==a.i||a.off==0&&(o.len<a.len||o.len==a.len&&!t))){let f=o.len;for(On(i,o.ins,-1);f;){let c=Math.min(a.len,f);a.ins>=0&&l<a.i&&a.len<=c&&(On(i,0,a.ins),s&&Ta(s,i,a.text),l=a.i),a.forward(c),f-=c}o.next()}else if(a.ins>=0){let f=0,c=a.len;for(;c;)if(o.ins==-1){let h=Math.min(c,o.len);f+=h,c-=h,o.forward(h)}else if(o.ins==0&&o.len<c)c-=o.len,o.next();else break;On(i,f,l<a.i?a.ins:0),s&&l<a.i&&Ta(s,i,a.text),l=a.i,a.forward(a.len-c)}else{if(a.done&&o.done)return s?Ur.createSet(i,s):bs.create(i);throw new Error("Mismatched change set lengths")}}}function UC(r,e,t=!1){let n=[],i=t?[]:null,s=new Zc(r),a=new Zc(e);for(let o=!1;;){if(s.done&&a.done)return i?Ur.createSet(n,i):bs.create(n);if(s.ins==0)On(n,s.len,0,o),s.next();else if(a.len==0&&!a.done)On(n,0,a.ins,o),i&&Ta(i,n,a.text),a.next();else{if(s.done||a.done)throw new Error("Mismatched change set lengths");{let l=Math.min(s.len2,a.len),f=n.length;if(s.ins==-1){let c=a.ins==-1?-1:a.off?0:a.ins;On(n,l,c,o),i&&c&&Ta(i,n,a.text)}else a.ins==-1?(On(n,s.off?0:s.len,l,o),i&&Ta(i,n,s.textBit(l))):(On(n,s.off?0:s.len,a.off?0:a.ins,o),i&&!a.off&&Ta(i,n,a.text));o=(s.ins>l||a.ins>=0&&a.len>l)&&(o||n.length>f),s.forward2(l),a.forward(l)}}}}class Zc{constructor(e){this.set=e,this.i=0,this.next()}next(){let{sections:e}=this.set;this.i<e.length?(this.len=e[this.i++],this.ins=e[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:e}=this.set,t=this.i-2>>1;return t>=e.length?Nt.empty:e[t]}textBit(e){let{inserted:t}=this.set,n=this.i-2>>1;return n>=t.length&&!e?Nt.empty:t[n].slice(this.off,e==null?void 0:this.off+e)}forward(e){e==this.len?this.next():(this.len-=e,this.off+=e)}forward2(e){this.ins==-1?this.forward(e):e==this.ins?this.next():(this.ins-=e,this.off+=e)}}class mo{constructor(e,t,n){this.from=e,this.to=t,this.flags=n}get anchor(){return this.flags&32?this.to:this.from}get head(){return this.flags&32?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&8?-1:this.flags&16?1:0}get bidiLevel(){let e=this.flags&7;return e==7?null:e}get goalColumn(){let e=this.flags>>6;return e==16777215?void 0:e}map(e,t=-1){let n,i;return this.empty?n=i=e.mapPos(this.from,t):(n=e.mapPos(this.from,1),i=e.mapPos(this.to,-1)),n==this.from&&i==this.to?this:new mo(n,i,this.flags)}extend(e,t=e){if(e<=this.anchor&&t>=this.anchor)return xe.range(e,t);let n=Math.abs(e-this.anchor)>Math.abs(t-this.anchor)?e:t;return xe.range(this.anchor,n)}eq(e,t=!1){return this.anchor==e.anchor&&this.head==e.head&&(!t||!this.empty||this.assoc==e.assoc)}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(e){if(!e||typeof e.anchor!="number"||typeof e.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return xe.range(e.anchor,e.head)}static create(e,t,n){return new mo(e,t,n)}}class xe{constructor(e,t){this.ranges=e,this.mainIndex=t}map(e,t=-1){return e.empty?this:xe.create(this.ranges.map(n=>n.map(e,t)),this.mainIndex)}eq(e,t=!1){if(this.ranges.length!=e.ranges.length||this.mainIndex!=e.mainIndex)return!1;for(let n=0;n<this.ranges.length;n++)if(!this.ranges[n].eq(e.ranges[n],t))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new xe([this.main],0)}addRange(e,t=!0){return xe.create([e].concat(this.ranges),t?0:this.mainIndex+1)}replaceRange(e,t=this.mainIndex){let n=this.ranges.slice();return n[t]=e,xe.create(n,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(e=>e.toJSON()),main:this.mainIndex}}static fromJSON(e){if(!e||!Array.isArray(e.ranges)||typeof e.main!="number"||e.main>=e.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new xe(e.ranges.map(t=>mo.fromJSON(t)),e.main)}static single(e,t=e){return new xe([xe.range(e,t)],0)}static create(e,t=0){if(e.length==0)throw new RangeError("A selection needs at least one range");for(let n=0,i=0;i<e.length;i++){let s=e[i];if(s.empty?s.from<=n:s.from<n)return xe.normalized(e.slice(),t);n=s.to}return new xe(e,t)}static cursor(e,t=0,n,i){return mo.create(e,e,(t==0?0:t<0?8:16)|(n==null?7:Math.min(6,n))|(i??16777215)<<6)}static range(e,t,n,i){let s=(n??16777215)<<6|(i==null?7:Math.min(6,i));return t<e?mo.create(t,e,48|s):mo.create(e,t,(t>e?8:0)|s)}static normalized(e,t=0){let n=e[t];e.sort((i,s)=>i.from-s.from),t=e.indexOf(n);for(let i=1;i<e.length;i++){let s=e[i],a=e[i-1];if(s.empty?s.from<=a.to:s.from<a.to){let o=a.from,l=Math.max(s.to,a.to);i<=t&&t--,e.splice(--i,2,s.anchor>s.head?xe.range(l,o):xe.range(o,l))}}return new xe(e,t)}}function XC(r,e){for(let t of r.ranges)if(t.to>e)throw new RangeError("Selection points outside of document")}let hx=0;class Le{constructor(e,t,n,i,s){this.combine=e,this.compareInput=t,this.compare=n,this.isStatic=i,this.id=hx++,this.default=e([]),this.extensions=typeof s=="function"?s(this):s}get reader(){return this}static define(e={}){return new Le(e.combine||(t=>t),e.compareInput||((t,n)=>t===n),e.compare||(e.combine?(t,n)=>t===n:ux),!!e.static,e.enables)}of(e){return new Wu([],this,0,e)}compute(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new Wu(e,this,1,t)}computeN(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new Wu(e,this,2,t)}from(e,t){return t||(t=n=>n),this.compute([e],n=>t(n.field(e)))}}function ux(r,e){return r==e||r.length==e.length&&r.every((t,n)=>t===e[n])}class Wu{constructor(e,t,n,i){this.dependencies=e,this.facet=t,this.type=n,this.value=i,this.id=hx++}dynamicSlot(e){var t;let n=this.value,i=this.facet.compareInput,s=this.id,a=e[s]>>1,o=this.type==2,l=!1,f=!1,c=[];for(let h of this.dependencies)h=="doc"?l=!0:h=="selection"?f=!0:((t=e[h.id])!==null&&t!==void 0?t:1)&1||c.push(e[h.id]);return{create(h){return h.values[a]=n(h),1},update(h,u){if(l&&u.docChanged||f&&(u.docChanged||u.selection)||ug(h,c)){let d=n(h);if(o?!_w(d,h.values[a],i):!i(d,h.values[a]))return h.values[a]=d,1}return 0},reconfigure:(h,u)=>{let d,p=u.config.address[s];if(p!=null){let m=Bd(u,p);if(this.dependencies.every(g=>g instanceof Le?u.facet(g)===h.facet(g):g instanceof Cr?u.field(g,!1)==h.field(g,!1):!0)||(o?_w(d=n(h),m,i):i(d=n(h),m)))return h.values[a]=m,0}else d=n(h);return h.values[a]=d,1}}}}function _w(r,e,t){if(r.length!=e.length)return!1;for(let n=0;n<r.length;n++)if(!t(r[n],e[n]))return!1;return!0}function ug(r,e){let t=!1;for(let n of e)xc(r,n)&1&&(t=!0);return t}function cV(r,e,t){let n=t.map(l=>r[l.id]),i=t.map(l=>l.type),s=n.filter(l=>!(l&1)),a=r[e.id]>>1;function o(l){let f=[];for(let c=0;c<n.length;c++){let h=Bd(l,n[c]);if(i[c]==2)for(let u of h)f.push(u);else f.push(h)}return e.combine(f)}return{create(l){for(let f of n)xc(l,f);return l.values[a]=o(l),1},update(l,f){if(!ug(l,s))return 0;let c=o(l);return e.compare(c,l.values[a])?0:(l.values[a]=c,1)},reconfigure(l,f){let c=ug(l,n),h=f.config.facets[e.id],u=f.facet(e);if(h&&!c&&ux(t,h))return l.values[a]=u,0;let d=o(l);return e.compare(d,u)?(l.values[a]=u,0):(l.values[a]=d,1)}}}const kw=Le.define({static:!0});class Cr{constructor(e,t,n,i,s){this.id=e,this.createF=t,this.updateF=n,this.compareF=i,this.spec=s,this.provides=void 0}static define(e){let t=new Cr(hx++,e.create,e.update,e.compare||((n,i)=>n===i),e);return e.provide&&(t.provides=e.provide(t)),t}create(e){let t=e.facet(kw).find(n=>n.field==this);return((t==null?void 0:t.create)||this.createF)(e)}slot(e){let t=e[this.id]>>1;return{create:n=>(n.values[t]=this.create(n),1),update:(n,i)=>{let s=n.values[t],a=this.updateF(s,i);return this.compareF(s,a)?0:(n.values[t]=a,1)},reconfigure:(n,i)=>i.config.address[this.id]!=null?(n.values[t]=i.field(this),0):(n.values[t]=this.create(n),1)}}init(e){return[this,kw.of({field:this,create:e})]}get extension(){return this}}const ho={lowest:4,low:3,default:2,high:1,highest:0};function Tf(r){return e=>new VC(e,r)}const za={highest:Tf(ho.highest),high:Tf(ho.high),default:Tf(ho.default),low:Tf(ho.low),lowest:Tf(ho.lowest)};class VC{constructor(e,t){this.inner=e,this.prec=t}}class I0{of(e){return new dg(this,e)}reconfigure(e){return I0.reconfigure.of({compartment:this,extension:e})}get(e){return e.config.compartments.get(this)}}class dg{constructor(e,t){this.compartment=e,this.inner=t}}class Ld{constructor(e,t,n,i,s,a){for(this.base=e,this.compartments=t,this.dynamicSlots=n,this.address=i,this.staticValues=s,this.facets=a,this.statusTemplate=[];this.statusTemplate.length<n.length;)this.statusTemplate.push(0)}staticFacet(e){let t=this.address[e.id];return t==null?e.default:this.staticValues[t>>1]}static resolve(e,t,n){let i=[],s=Object.create(null),a=new Map;for(let u of hV(e,t,a))u instanceof Cr?i.push(u):(s[u.facet.id]||(s[u.facet.id]=[])).push(u);let o=Object.create(null),l=[],f=[];for(let u of i)o[u.id]=f.length<<1,f.push(d=>u.slot(d));let c=n==null?void 0:n.config.facets;for(let u in s){let d=s[u],p=d[0].facet,m=c&&c[u]||[];if(d.every(g=>g.type==0))if(o[p.id]=l.length<<1|1,ux(m,d))l.push(n.facet(p));else{let g=p.combine(d.map(v=>v.value));l.push(n&&p.compare(g,n.facet(p))?n.facet(p):g)}else{for(let g of d)g.type==0?(o[g.id]=l.length<<1|1,l.push(g.value)):(o[g.id]=f.length<<1,f.push(v=>g.dynamicSlot(v)));o[p.id]=f.length<<1,f.push(g=>cV(g,p,d))}}let h=f.map(u=>u(o));return new Ld(e,a,h,o,l,s)}}function hV(r,e,t){let n=[[],[],[],[],[]],i=new Map;function s(a,o){let l=i.get(a);if(l!=null){if(l<=o)return;let f=n[l].indexOf(a);f>-1&&n[l].splice(f,1),a instanceof dg&&t.delete(a.compartment)}if(i.set(a,o),Array.isArray(a))for(let f of a)s(f,o);else if(a instanceof dg){if(t.has(a.compartment))throw new RangeError("Duplicate use of compartment in extensions");let f=e.get(a.compartment)||a.inner;t.set(a.compartment,f),s(f,o)}else if(a instanceof VC)s(a.inner,a.prec);else if(a instanceof Cr)n[o].push(a),a.provides&&s(a.provides,o);else if(a instanceof Wu)n[o].push(a),a.facet.extensions&&s(a.facet.extensions,ho.default);else{let f=a.extension;if(!f)throw new Error(`Unrecognized extension value in extension set (${a}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);s(f,o)}}return s(r,ho.default),n.reduce((a,o)=>a.concat(o))}function xc(r,e){if(e&1)return 2;let t=e>>1,n=r.status[t];if(n==4)throw new Error("Cyclic dependency between fields and/or facets");if(n&2)return n;r.status[t]=4;let i=r.computeSlot(r,r.config.dynamicSlots[t]);return r.status[t]=2|i}function Bd(r,e){return e&1?r.config.staticValues[e>>1]:r.values[e>>1]}const qC=Le.define(),pg=Le.define({combine:r=>r.some(e=>e),static:!0}),jC=Le.define({combine:r=>r.length?r[0]:void 0,static:!0}),zC=Le.define(),GC=Le.define(),HC=Le.define(),YC=Le.define({combine:r=>r.length?r[0]:!1});class Fs{constructor(e,t){this.type=e,this.value=t}static define(){return new uV}}class uV{of(e){return new Fs(this,e)}}class dV{constructor(e){this.map=e}of(e){return new ot(this,e)}}class ot{constructor(e,t){this.type=e,this.value=t}map(e){let t=this.type.map(this.value,e);return t===void 0?void 0:t==this.value?this:new ot(this.type,t)}is(e){return this.type==e}static define(e={}){return new dV(e.map||(t=>t))}static mapEffects(e,t){if(!e.length)return e;let n=[];for(let i of e){let s=i.map(t);s&&n.push(s)}return n}}ot.reconfigure=ot.define();ot.appendConfig=ot.define();class Br{constructor(e,t,n,i,s,a){this.startState=e,this.changes=t,this.selection=n,this.effects=i,this.annotations=s,this.scrollIntoView=a,this._doc=null,this._state=null,n&&XC(n,t.newLength),s.some(o=>o.type==Br.time)||(this.annotations=s.concat(Br.time.of(Date.now())))}static create(e,t,n,i,s,a){return new Br(e,t,n,i,s,a)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(e){for(let t of this.annotations)if(t.type==e)return t.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(e){let t=this.annotation(Br.userEvent);return!!(t&&(t==e||t.length>e.length&&t.slice(0,e.length)==e&&t[e.length]=="."))}}Br.time=Fs.define();Br.userEvent=Fs.define();Br.addToHistory=Fs.define();Br.remote=Fs.define();function pV(r,e){let t=[];for(let n=0,i=0;;){let s,a;if(n<r.length&&(i==e.length||e[i]>=r[n]))s=r[n++],a=r[n++];else if(i<e.length)s=e[i++],a=e[i++];else return t;!t.length||t[t.length-1]<s?t.push(s,a):t[t.length-1]<a&&(t[t.length-1]=a)}}function KC(r,e,t){var n;let i,s,a;return t?(i=e.changes,s=Ur.empty(e.changes.length),a=r.changes.compose(e.changes)):(i=e.changes.map(r.changes),s=r.changes.mapDesc(e.changes,!0),a=r.changes.compose(i)),{changes:a,selection:e.selection?e.selection.map(s):(n=r.selection)===null||n===void 0?void 0:n.map(i),effects:ot.mapEffects(r.effects,i).concat(ot.mapEffects(e.effects,s)),annotations:r.annotations.length?r.annotations.concat(e.annotations):e.annotations,scrollIntoView:r.scrollIntoView||e.scrollIntoView}}function mg(r,e,t){let n=e.selection,i=Cl(e.annotations);return e.userEvent&&(i=i.concat(Br.userEvent.of(e.userEvent))),{changes:e.changes instanceof Ur?e.changes:Ur.of(e.changes||[],t,r.facet(jC)),selection:n&&(n instanceof xe?n:xe.single(n.anchor,n.head)),effects:Cl(e.effects),annotations:i,scrollIntoView:!!e.scrollIntoView}}function JC(r,e,t){let n=mg(r,e.length?e[0]:{},r.doc.length);e.length&&e[0].filter===!1&&(t=!1);for(let s=1;s<e.length;s++){e[s].filter===!1&&(t=!1);let a=!!e[s].sequential;n=KC(n,mg(r,e[s],a?n.changes.newLength:r.doc.length),a)}let i=Br.create(r,n.changes,n.selection,n.effects,n.annotations,n.scrollIntoView);return gV(t?mV(i):i)}function mV(r){let e=r.startState,t=!0;for(let i of e.facet(zC)){let s=i(r);if(s===!1){t=!1;break}Array.isArray(s)&&(t=t===!0?s:pV(t,s))}if(t!==!0){let i,s;if(t===!1)s=r.changes.invertedDesc,i=Ur.empty(e.doc.length);else{let a=r.changes.filter(t);i=a.changes,s=a.filtered.mapDesc(a.changes).invertedDesc}r=Br.create(e,i,r.selection&&r.selection.map(s),ot.mapEffects(r.effects,s),r.annotations,r.scrollIntoView)}let n=e.facet(GC);for(let i=n.length-1;i>=0;i--){let s=n[i](r);s instanceof Br?r=s:Array.isArray(s)&&s.length==1&&s[0]instanceof Br?r=s[0]:r=JC(e,Cl(s),!1)}return r}function gV(r){let e=r.startState,t=e.facet(HC),n=r;for(let i=t.length-1;i>=0;i--){let s=t[i](r);s&&Object.keys(s).length&&(n=KC(n,mg(e,s,r.changes.newLength),!0))}return n==r?r:Br.create(e,r.changes,r.selection,n.effects,n.annotations,n.scrollIntoView)}const OV=[];function Cl(r){return r==null?OV:Array.isArray(r)?r:[r]}var pr=function(r){return r[r.Word=0]="Word",r[r.Space=1]="Space",r[r.Other=2]="Other",r}(pr||(pr={}));const xV=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let gg;try{gg=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function vV(r){if(gg)return gg.test(r);for(let e=0;e<r.length;e++){let t=r[e];if(/\w/.test(t)||t>""&&(t.toUpperCase()!=t.toLowerCase()||xV.test(t)))return!0}return!1}function yV(r){return e=>{if(!/\S/.test(e))return pr.Space;if(vV(e))return pr.Word;for(let t=0;t<r.length;t++)if(e.indexOf(r[t])>-1)return pr.Word;return pr.Other}}class lt{constructor(e,t,n,i,s,a){this.config=e,this.doc=t,this.selection=n,this.values=i,this.status=e.statusTemplate.slice(),this.computeSlot=s,a&&(a._state=this);for(let o=0;o<this.config.dynamicSlots.length;o++)xc(this,o<<1);this.computeSlot=null}field(e,t=!0){let n=this.config.address[e.id];if(n==null){if(t)throw new RangeError("Field is not present in this state");return}return xc(this,n),Bd(this,n)}update(...e){return JC(this,e,!0)}applyTransaction(e){let t=this.config,{base:n,compartments:i}=t;for(let o of e.effects)o.is(I0.reconfigure)?(t&&(i=new Map,t.compartments.forEach((l,f)=>i.set(f,l)),t=null),i.set(o.value.compartment,o.value.extension)):o.is(ot.reconfigure)?(t=null,n=o.value):o.is(ot.appendConfig)&&(t=null,n=Cl(n).concat(o.value));let s;t?s=e.startState.values.slice():(t=Ld.resolve(n,i,this),s=new lt(t,this.doc,this.selection,t.dynamicSlots.map(()=>null),(l,f)=>f.reconfigure(l,this),null).values);let a=e.startState.facet(pg)?e.newSelection:e.newSelection.asSingle();new lt(t,e.newDoc,a,s,(o,l)=>l.update(o,e),e)}replaceSelection(e){return typeof e=="string"&&(e=this.toText(e)),this.changeByRange(t=>({changes:{from:t.from,to:t.to,insert:e},range:xe.cursor(t.from+e.length)}))}changeByRange(e){let t=this.selection,n=e(t.ranges[0]),i=this.changes(n.changes),s=[n.range],a=Cl(n.effects);for(let o=1;o<t.ranges.length;o++){let l=e(t.ranges[o]),f=this.changes(l.changes),c=f.map(i);for(let u=0;u<o;u++)s[u]=s[u].map(c);let h=i.mapDesc(f,!0);s.push(l.range.map(h)),i=i.compose(c),a=ot.mapEffects(a,c).concat(ot.mapEffects(Cl(l.effects),h))}return{changes:i,selection:xe.create(s,t.mainIndex),effects:a}}changes(e=[]){return e instanceof Ur?e:Ur.of(e,this.doc.length,this.facet(lt.lineSeparator))}toText(e){return Nt.of(e.split(this.facet(lt.lineSeparator)||fg))}sliceDoc(e=0,t=this.doc.length){return this.doc.sliceString(e,t,this.lineBreak)}facet(e){let t=this.config.address[e.id];return t==null?e.default:(xc(this,t),Bd(this,t))}toJSON(e){let t={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(e)for(let n in e){let i=e[n];i instanceof Cr&&this.config.address[i.id]!=null&&(t[n]=i.spec.toJSON(this.field(e[n]),this))}return t}static fromJSON(e,t={},n){if(!e||typeof e.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let i=[];if(n){for(let s in n)if(Object.prototype.hasOwnProperty.call(e,s)){let a=n[s],o=e[s];i.push(a.init(l=>a.spec.fromJSON(o,l)))}}return lt.create({doc:e.doc,selection:xe.fromJSON(e.selection),extensions:t.extensions?i.concat([t.extensions]):i})}static create(e={}){let t=Ld.resolve(e.extensions||[],new Map),n=e.doc instanceof Nt?e.doc:Nt.of((e.doc||"").split(t.staticFacet(lt.lineSeparator)||fg)),i=e.selection?e.selection instanceof xe?e.selection:xe.single(e.selection.anchor,e.selection.head):xe.single(0);return XC(i,n.length),t.staticFacet(pg)||(i=i.asSingle()),new lt(t,n,i,t.dynamicSlots.map(()=>null),(s,a)=>a.create(s),null)}get tabSize(){return this.facet(lt.tabSize)}get lineBreak(){return this.facet(lt.lineSeparator)||`
`}get readOnly(){return this.facet(YC)}phrase(e,...t){for(let n of this.facet(lt.phrases))if(Object.prototype.hasOwnProperty.call(n,e)){e=n[e];break}return t.length&&(e=e.replace(/\$(\$|\d*)/g,(n,i)=>{if(i=="$")return"$";let s=+(i||1);return!s||s>t.length?n:t[s-1]})),e}languageDataAt(e,t,n=-1){let i=[];for(let s of this.facet(qC))for(let a of s(this,t,n))Object.prototype.hasOwnProperty.call(a,e)&&i.push(a[e]);return i}charCategorizer(e){return yV(this.languageDataAt("wordChars",e).join(""))}wordAt(e){let{text:t,from:n,length:i}=this.doc.lineAt(e),s=this.charCategorizer(e),a=e-n,o=e-n;for(;a>0;){let l=un(t,a,!1);if(s(t.slice(l,a))!=pr.Word)break;a=l}for(;o<i;){let l=un(t,o);if(s(t.slice(o,l))!=pr.Word)break;o=l}return a==o?null:xe.range(a+n,o+n)}}lt.allowMultipleSelections=pg;lt.tabSize=Le.define({combine:r=>r.length?r[0]:4});lt.lineSeparator=jC;lt.readOnly=YC;lt.phrases=Le.define({compare(r,e){let t=Object.keys(r),n=Object.keys(e);return t.length==n.length&&t.every(i=>r[i]==e[i])}});lt.languageData=qC;lt.changeFilter=zC;lt.transactionFilter=GC;lt.transactionExtender=HC;I0.reconfigure=ot.define();function $s(r,e,t={}){let n={};for(let i of r)for(let s of Object.keys(i)){let a=i[s],o=n[s];if(o===void 0)n[s]=a;else if(!(o===a||a===void 0))if(Object.hasOwnProperty.call(t,s))n[s]=t[s](o,a);else throw new Error("Config merge conflict for field "+s)}for(let i in e)n[i]===void 0&&(n[i]=e[i]);return n}class zs{eq(e){return this==e}range(e,t=e){return Og.create(e,t,this)}}zs.prototype.startSide=zs.prototype.endSide=0;zs.prototype.point=!1;zs.prototype.mapMode=hn.TrackDel;let Og=class eA{constructor(e,t,n){this.from=e,this.to=t,this.value=n}static create(e,t,n){return new eA(e,t,n)}};function xg(r,e){return r.from-e.from||r.value.startSide-e.value.startSide}class dx{constructor(e,t,n,i){this.from=e,this.to=t,this.value=n,this.maxPoint=i}get length(){return this.to[this.to.length-1]}findIndex(e,t,n,i=0){let s=n?this.to:this.from;for(let a=i,o=s.length;;){if(a==o)return a;let l=a+o>>1,f=s[l]-e||(n?this.value[l].endSide:this.value[l].startSide)-t;if(l==a)return f>=0?a:o;f>=0?o=l:a=l+1}}between(e,t,n,i){for(let s=this.findIndex(t,-1e9,!0),a=this.findIndex(n,1e9,!1,s);s<a;s++)if(i(this.from[s]+e,this.to[s]+e,this.value[s])===!1)return!1}map(e,t){let n=[],i=[],s=[],a=-1,o=-1;for(let l=0;l<this.value.length;l++){let f=this.value[l],c=this.from[l]+e,h=this.to[l]+e,u,d;if(c==h){let p=t.mapPos(c,f.startSide,f.mapMode);if(p==null||(u=d=p,f.startSide!=f.endSide&&(d=t.mapPos(c,f.endSide),d<u)))continue}else if(u=t.mapPos(c,f.startSide),d=t.mapPos(h,f.endSide),u>d||u==d&&f.startSide>0&&f.endSide<=0)continue;(d-u||f.endSide-f.startSide)<0||(a<0&&(a=u),f.point&&(o=Math.max(o,d-u)),n.push(f),i.push(u-a),s.push(d-a))}return{mapped:n.length?new dx(i,s,n,o):null,pos:a}}}class At{constructor(e,t,n,i){this.chunkPos=e,this.chunk=t,this.nextLayer=n,this.maxPoint=i}static create(e,t,n,i){return new At(e,t,n,i)}get length(){let e=this.chunk.length-1;return e<0?0:Math.max(this.chunkEnd(e),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let e=this.nextLayer.size;for(let t of this.chunk)e+=t.value.length;return e}chunkEnd(e){return this.chunkPos[e]+this.chunk[e].length}update(e){let{add:t=[],sort:n=!1,filterFrom:i=0,filterTo:s=this.length}=e,a=e.filter;if(t.length==0&&!a)return this;if(n&&(t=t.slice().sort(xg)),this.isEmpty)return t.length?At.of(t):this;let o=new tA(this,null,-1).goto(0),l=0,f=[],c=new Gs;for(;o.value||l<t.length;)if(l<t.length&&(o.from-t[l].from||o.startSide-t[l].value.startSide)>=0){let h=t[l++];c.addInner(h.from,h.to,h.value)||f.push(h)}else o.rangeIndex==1&&o.chunkIndex<this.chunk.length&&(l==t.length||this.chunkEnd(o.chunkIndex)<t[l].from)&&(!a||i>this.chunkEnd(o.chunkIndex)||s<this.chunkPos[o.chunkIndex])&&c.addChunk(this.chunkPos[o.chunkIndex],this.chunk[o.chunkIndex])?o.nextChunk():((!a||i>o.to||s<o.from||a(o.from,o.to,o.value))&&(c.addInner(o.from,o.to,o.value)||f.push(Og.create(o.from,o.to,o.value))),o.next());return c.finishInner(this.nextLayer.isEmpty&&!f.length?At.empty:this.nextLayer.update({add:f,filter:a,filterFrom:i,filterTo:s}))}map(e){if(e.empty||this.isEmpty)return this;let t=[],n=[],i=-1;for(let a=0;a<this.chunk.length;a++){let o=this.chunkPos[a],l=this.chunk[a],f=e.touchesRange(o,o+l.length);if(f===!1)i=Math.max(i,l.maxPoint),t.push(l),n.push(e.mapPos(o));else if(f===!0){let{mapped:c,pos:h}=l.map(o,e);c&&(i=Math.max(i,c.maxPoint),t.push(c),n.push(h))}}let s=this.nextLayer.map(e);return t.length==0?s:new At(n,t,s||At.empty,i)}between(e,t,n){if(!this.isEmpty){for(let i=0;i<this.chunk.length;i++){let s=this.chunkPos[i],a=this.chunk[i];if(t>=s&&e<=s+a.length&&a.between(s,e-s,t-s,n)===!1)return}this.nextLayer.between(e,t,n)}}iter(e=0){return Wc.from([this]).goto(e)}get isEmpty(){return this.nextLayer==this}static iter(e,t=0){return Wc.from(e).goto(t)}static compare(e,t,n,i,s=-1){let a=e.filter(h=>h.maxPoint>0||!h.isEmpty&&h.maxPoint>=s),o=t.filter(h=>h.maxPoint>0||!h.isEmpty&&h.maxPoint>=s),l=Sw(a,o,n),f=new Cf(a,l,s),c=new Cf(o,l,s);n.iterGaps((h,u,d)=>Tw(f,h,c,u,d,i)),n.empty&&n.length==0&&Tw(f,0,c,0,0,i)}static eq(e,t,n=0,i){i==null&&(i=999999999);let s=e.filter(c=>!c.isEmpty&&t.indexOf(c)<0),a=t.filter(c=>!c.isEmpty&&e.indexOf(c)<0);if(s.length!=a.length)return!1;if(!s.length)return!0;let o=Sw(s,a),l=new Cf(s,o,0).goto(n),f=new Cf(a,o,0).goto(n);for(;;){if(l.to!=f.to||!vg(l.active,f.active)||l.point&&(!f.point||!l.point.eq(f.point)))return!1;if(l.to>i)return!0;l.next(),f.next()}}static spans(e,t,n,i,s=-1){let a=new Cf(e,null,s).goto(t),o=t,l=a.openStart;for(;;){let f=Math.min(a.to,n);if(a.point){let c=a.activeForPoint(a.to),h=a.pointFrom<t?c.length+1:a.point.startSide<0?c.length:Math.min(c.length,l);i.point(o,f,a.point,c,h,a.pointRank),l=Math.min(a.openEnd(f),c.length)}else f>o&&(i.span(o,f,a.active,l),l=a.openEnd(f));if(a.to>n)return l+(a.point&&a.to>n?1:0);o=a.to,a.next()}}static of(e,t=!1){let n=new Gs;for(let i of e instanceof Og?[e]:t?wV(e):e)n.add(i.from,i.to,i.value);return n.finish()}static join(e){if(!e.length)return At.empty;let t=e[e.length-1];for(let n=e.length-2;n>=0;n--)for(let i=e[n];i!=At.empty;i=i.nextLayer)t=new At(i.chunkPos,i.chunk,t,Math.max(i.maxPoint,t.maxPoint));return t}}At.empty=new At([],[],null,-1);function wV(r){if(r.length>1)for(let e=r[0],t=1;t<r.length;t++){let n=r[t];if(xg(e,n)>0)return r.slice().sort(xg);e=n}return r}At.empty.nextLayer=At.empty;class Gs{finishChunk(e){this.chunks.push(new dx(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,e&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(e,t,n){this.addInner(e,t,n)||(this.nextLayer||(this.nextLayer=new Gs)).add(e,t,n)}addInner(e,t,n){let i=e-this.lastTo||n.startSide-this.last.endSide;if(i<=0&&(e-this.lastFrom||n.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return i<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=e),this.from.push(e-this.chunkStart),this.to.push(t-this.chunkStart),this.last=n,this.lastFrom=e,this.lastTo=t,this.value.push(n),n.point&&(this.maxPoint=Math.max(this.maxPoint,t-e)),!0)}addChunk(e,t){if((e-this.lastTo||t.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,t.maxPoint),this.chunks.push(t),this.chunkPos.push(e);let n=t.value.length-1;return this.last=t.value[n],this.lastFrom=t.from[n]+e,this.lastTo=t.to[n]+e,!0}finish(){return this.finishInner(At.empty)}finishInner(e){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return e;let t=At.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(e):e,this.setMaxPoint);return this.from=null,t}}function Sw(r,e,t){let n=new Map;for(let s of r)for(let a=0;a<s.chunk.length;a++)s.chunk[a].maxPoint<=0&&n.set(s.chunk[a],s.chunkPos[a]);let i=new Set;for(let s of e)for(let a=0;a<s.chunk.length;a++){let o=n.get(s.chunk[a]);o!=null&&(t?t.mapPos(o):o)==s.chunkPos[a]&&!(t!=null&&t.touchesRange(o,o+s.chunk[a].length))&&i.add(s.chunk[a])}return i}class tA{constructor(e,t,n,i=0){this.layer=e,this.skip=t,this.minPoint=n,this.rank=i}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(e,t=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(e,t,!1),this}gotoInner(e,t,n){for(;this.chunkIndex<this.layer.chunk.length;){let i=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(i)||this.layer.chunkEnd(this.chunkIndex)<e||i.maxPoint<this.minPoint))break;this.chunkIndex++,n=!1}if(this.chunkIndex<this.layer.chunk.length){let i=this.layer.chunk[this.chunkIndex].findIndex(e-this.layer.chunkPos[this.chunkIndex],t,!0);(!n||this.rangeIndex<i)&&this.setRangeIndex(i)}this.next()}forward(e,t){(this.to-e||this.endSide-t)<0&&this.gotoInner(e,t,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let e=this.layer.chunkPos[this.chunkIndex],t=this.layer.chunk[this.chunkIndex],n=e+t.from[this.rangeIndex];if(this.from=n,this.to=e+t.to[this.rangeIndex],this.value=t.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(e){if(e==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=e}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(e){return this.from-e.from||this.startSide-e.startSide||this.rank-e.rank||this.to-e.to||this.endSide-e.endSide}}class Wc{constructor(e){this.heap=e}static from(e,t=null,n=-1){let i=[];for(let s=0;s<e.length;s++)for(let a=e[s];!a.isEmpty;a=a.nextLayer)a.maxPoint>=n&&i.push(new tA(a,t,n,s));return i.length==1?i[0]:new Wc(i)}get startSide(){return this.value?this.value.startSide:0}goto(e,t=-1e9){for(let n of this.heap)n.goto(e,t);for(let n=this.heap.length>>1;n>=0;n--)Ap(this.heap,n);return this.next(),this}forward(e,t){for(let n of this.heap)n.forward(e,t);for(let n=this.heap.length>>1;n>=0;n--)Ap(this.heap,n);(this.to-e||this.value.endSide-t)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let e=this.heap[0];this.from=e.from,this.to=e.to,this.value=e.value,this.rank=e.rank,e.value&&e.next(),Ap(this.heap,0)}}}function Ap(r,e){for(let t=r[e];;){let n=(e<<1)+1;if(n>=r.length)break;let i=r[n];if(n+1<r.length&&i.compare(r[n+1])>=0&&(i=r[n+1],n++),t.compare(i)<0)break;r[n]=t,r[e]=i,e=n}}class Cf{constructor(e,t,n){this.minPoint=n,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=Wc.from(e,t,n)}goto(e,t=-1e9){return this.cursor.goto(e,t),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=e,this.endSide=t,this.openStart=-1,this.next(),this}forward(e,t){for(;this.minActive>-1&&(this.activeTo[this.minActive]-e||this.active[this.minActive].endSide-t)<0;)this.removeActive(this.minActive);this.cursor.forward(e,t)}removeActive(e){ru(this.active,e),ru(this.activeTo,e),ru(this.activeRank,e),this.minActive=Cw(this.active,this.activeTo)}addActive(e){let t=0,{value:n,to:i,rank:s}=this.cursor;for(;t<this.activeRank.length&&(s-this.activeRank[t]||i-this.activeTo[t])>0;)t++;nu(this.active,t,n),nu(this.activeTo,t,i),nu(this.activeRank,t,s),e&&nu(e,t,this.cursor.from),this.minActive=Cw(this.active,this.activeTo)}next(){let e=this.to,t=this.point;this.point=null;let n=this.openStart<0?[]:null;for(;;){let i=this.minActive;if(i>-1&&(this.activeTo[i]-this.cursor.from||this.active[i].endSide-this.cursor.startSide)<0){if(this.activeTo[i]>e){this.to=this.activeTo[i],this.endSide=this.active[i].endSide;break}this.removeActive(i),n&&ru(n,i)}else if(this.cursor.value)if(this.cursor.from>e){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let s=this.cursor.value;if(!s.point)this.addActive(n),this.cursor.next();else if(t&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=s,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=s.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(n){this.openStart=0;for(let i=n.length-1;i>=0&&n[i]<e;i--)this.openStart++}}activeForPoint(e){if(!this.active.length)return this.active;let t=[];for(let n=this.active.length-1;n>=0&&!(this.activeRank[n]<this.pointRank);n--)(this.activeTo[n]>e||this.activeTo[n]==e&&this.active[n].endSide>=this.point.endSide)&&t.push(this.active[n]);return t.reverse()}openEnd(e){let t=0;for(let n=this.activeTo.length-1;n>=0&&this.activeTo[n]>e;n--)t++;return t}}function Tw(r,e,t,n,i,s){r.goto(e),t.goto(n);let a=n+i,o=n,l=n-e;for(;;){let f=r.to+l-t.to,c=f||r.endSide-t.endSide,h=c<0?r.to+l:t.to,u=Math.min(h,a);if(r.point||t.point?r.point&&t.point&&(r.point==t.point||r.point.eq(t.point))&&vg(r.activeForPoint(r.to),t.activeForPoint(t.to))||s.comparePoint(o,u,r.point,t.point):u>o&&!vg(r.active,t.active)&&s.compareRange(o,u,r.active,t.active),h>a)break;(f||r.openEnd!=t.openEnd)&&s.boundChange&&s.boundChange(h),o=h,c<=0&&r.next(),c>=0&&t.next()}}function vg(r,e){if(r.length!=e.length)return!1;for(let t=0;t<r.length;t++)if(r[t]!=e[t]&&!r[t].eq(e[t]))return!1;return!0}function ru(r,e){for(let t=e,n=r.length-1;t<n;t++)r[t]=r[t+1];r.pop()}function nu(r,e,t){for(let n=r.length-1;n>=e;n--)r[n+1]=r[n];r[e]=t}function Cw(r,e){let t=-1,n=1e9;for(let i=0;i<e.length;i++)(e[i]-n||r[i].endSide-r[t].endSide)<0&&(t=i,n=e[i]);return t}function df(r,e,t=r.length){let n=0;for(let i=0;i<t&&i<r.length;)r.charCodeAt(i)==9?(n+=e-n%e,i++):(n++,i=un(r,i));return n}function yg(r,e,t,n){for(let i=0,s=0;;){if(s>=e)return i;if(i==r.length)break;s+=r.charCodeAt(i)==9?t-s%t:1,i=un(r,i)}return n===!0?-1:r.length}const wg="",Aw=typeof Symbol>"u"?"__"+wg:Symbol.for(wg),bg=typeof Symbol>"u"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),Ew=typeof globalThis<"u"?globalThis:typeof window<"u"?window:{};class Tn{constructor(e,t){this.rules=[];let{finish:n}=t||{};function i(a){return/^@/.test(a)?[a]:a.split(/,\s*/)}function s(a,o,l,f){let c=[],h=/^@(\w+)\b/.exec(a[0]),u=h&&h[1]=="keyframes";if(h&&o==null)return l.push(a[0]+";");for(let d in o){let p=o[d];if(/&/.test(d))s(d.split(/,\s*/).map(m=>a.map(g=>m.replace(/&/,g))).reduce((m,g)=>m.concat(g)),p,l);else if(p&&typeof p=="object"){if(!h)throw new RangeError("The value of a property ("+d+") should be a primitive value.");s(i(d),p,c,u)}else p!=null&&c.push(d.replace(/_.*/,"").replace(/[A-Z]/g,m=>"-"+m.toLowerCase())+": "+p+";")}(c.length||u)&&l.push((n&&!h&&!f?a.map(n):a).join(", ")+" {"+c.join(" ")+"}")}for(let a in e)s(i(a),e[a],this.rules)}getRules(){return this.rules.join(`
`)}static newName(){let e=Ew[Aw]||1;return Ew[Aw]=e+1,wg+e.toString(36)}static mount(e,t,n){let i=e[bg],s=n&&n.nonce;i?s&&i.setNonce(s):i=new bV(e,s),i.mount(Array.isArray(t)?t:[t],e)}}let Pw=new Map;class bV{constructor(e,t){let n=e.ownerDocument||e,i=n.defaultView;if(!e.head&&e.adoptedStyleSheets&&i.CSSStyleSheet){let s=Pw.get(n);if(s)return e[bg]=s;this.sheet=new i.CSSStyleSheet,Pw.set(n,this)}else this.styleTag=n.createElement("style"),t&&this.styleTag.setAttribute("nonce",t);this.modules=[],e[bg]=this}mount(e,t){let n=this.sheet,i=0,s=0;for(let a=0;a<e.length;a++){let o=e[a],l=this.modules.indexOf(o);if(l<s&&l>-1&&(this.modules.splice(l,1),s--,l=-1),l==-1){if(this.modules.splice(s++,0,o),n)for(let f=0;f<o.rules.length;f++)n.insertRule(o.rules[f],i++)}else{for(;s<l;)i+=this.modules[s++].rules.length;i+=o.rules.length,s++}}if(n)t.adoptedStyleSheets.indexOf(this.sheet)<0&&(t.adoptedStyleSheets=[this.sheet,...t.adoptedStyleSheets]);else{let a="";for(let l=0;l<this.modules.length;l++)a+=this.modules[l].getRules()+`
`;this.styleTag.textContent=a;let o=t.head||t;this.styleTag.parentNode!=o&&o.insertBefore(this.styleTag,o.firstChild)}}setNonce(e){this.styleTag&&this.styleTag.getAttribute("nonce")!=e&&this.styleTag.setAttribute("nonce",e)}}var Ma={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Uc={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},_V=typeof navigator<"u"&&/Mac/.test(navigator.platform),kV=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var nn=0;nn<10;nn++)Ma[48+nn]=Ma[96+nn]=String(nn);for(var nn=1;nn<=24;nn++)Ma[nn+111]="F"+nn;for(var nn=65;nn<=90;nn++)Ma[nn]=String.fromCharCode(nn+32),Uc[nn]=String.fromCharCode(nn);for(var Ep in Ma)Uc.hasOwnProperty(Ep)||(Uc[Ep]=Ma[Ep]);function SV(r){var e=_V&&r.metaKey&&r.shiftKey&&!r.ctrlKey&&!r.altKey||kV&&r.shiftKey&&r.key&&r.key.length==1||r.key=="Unidentified",t=!e&&r.key||(r.shiftKey?Uc:Ma)[r.keyCode]||r.key||"Unidentified";return t=="Esc"&&(t="Escape"),t=="Del"&&(t="Delete"),t=="Left"&&(t="ArrowLeft"),t=="Up"&&(t="ArrowUp"),t=="Right"&&(t="ArrowRight"),t=="Down"&&(t="ArrowDown"),t}function Xc(r){let e;return r.nodeType==11?e=r.getSelection?r:r.ownerDocument:e=r,e.getSelection()}function _g(r,e){return e?r==e||r.contains(e.nodeType!=1?e.parentNode:e):!1}function Uu(r,e){if(!e.anchorNode)return!1;try{return _g(r,e.anchorNode)}catch{return!1}}function Vc(r){return r.nodeType==3?No(r,0,r.nodeValue.length).getClientRects():r.nodeType==1?r.getClientRects():[]}function vc(r,e,t,n){return t?Rw(r,e,t,n,-1)||Rw(r,e,t,n,1):!1}function $o(r){for(var e=0;;e++)if(r=r.previousSibling,!r)return e}function Zd(r){return r.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(r.nodeName)}function Rw(r,e,t,n,i){for(;;){if(r==t&&e==n)return!0;if(e==(i<0?0:ks(r))){if(r.nodeName=="DIV")return!1;let s=r.parentNode;if(!s||s.nodeType!=1)return!1;e=$o(r)+(i<0?0:1),r=s}else if(r.nodeType==1){if(r=r.childNodes[e+(i<0?-1:0)],r.nodeType==1&&r.contentEditable=="false")return!1;e=i<0?ks(r):0}else return!1}}function ks(r){return r.nodeType==3?r.nodeValue.length:r.childNodes.length}function L0(r,e){let t=e?r.left:r.right;return{left:t,right:t,top:r.top,bottom:r.bottom}}function TV(r){let e=r.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:r.innerWidth,top:0,bottom:r.innerHeight}}function rA(r,e){let t=e.width/r.offsetWidth,n=e.height/r.offsetHeight;return(t>.995&&t<1.005||!isFinite(t)||Math.abs(e.width-r.offsetWidth)<1)&&(t=1),(n>.995&&n<1.005||!isFinite(n)||Math.abs(e.height-r.offsetHeight)<1)&&(n=1),{scaleX:t,scaleY:n}}function CV(r,e,t,n,i,s,a,o){let l=r.ownerDocument,f=l.defaultView||window;for(let c=r,h=!1;c&&!h;)if(c.nodeType==1){let u,d=c==l.body,p=1,m=1;if(d)u=TV(f);else{if(/^(fixed|sticky)$/.test(getComputedStyle(c).position)&&(h=!0),c.scrollHeight<=c.clientHeight&&c.scrollWidth<=c.clientWidth){c=c.assignedSlot||c.parentNode;continue}let w=c.getBoundingClientRect();({scaleX:p,scaleY:m}=rA(c,w)),u={left:w.left,right:w.left+c.clientWidth*p,top:w.top,bottom:w.top+c.clientHeight*m}}let g=0,v=0;if(i=="nearest")e.top<u.top?(v=-(u.top-e.top+a),t>0&&e.bottom>u.bottom+v&&(v=e.bottom-u.bottom+v+a)):e.bottom>u.bottom&&(v=e.bottom-u.bottom+a,t<0&&e.top-v<u.top&&(v=-(u.top+v-e.top+a)));else{let w=e.bottom-e.top,x=u.bottom-u.top;v=(i=="center"&&w<=x?e.top+w/2-x/2:i=="start"||i=="center"&&t<0?e.top-a:e.bottom-x+a)-u.top}if(n=="nearest"?e.left<u.left?(g=-(u.left-e.left+s),t>0&&e.right>u.right+g&&(g=e.right-u.right+g+s)):e.right>u.right&&(g=e.right-u.right+s,t<0&&e.left<u.left+g&&(g=-(u.left+g-e.left+s))):g=(n=="center"?e.left+(e.right-e.left)/2-(u.right-u.left)/2:n=="start"==o?e.left-s:e.right-(u.right-u.left)+s)-u.left,g||v)if(d)f.scrollBy(g,v);else{let w=0,x=0;if(v){let S=c.scrollTop;c.scrollTop+=v/m,x=(c.scrollTop-S)*m}if(g){let S=c.scrollLeft;c.scrollLeft+=g/p,w=(c.scrollLeft-S)*p}e={left:e.left-w,top:e.top-x,right:e.right-w,bottom:e.bottom-x},w&&Math.abs(w-g)<1&&(n="nearest"),x&&Math.abs(x-v)<1&&(i="nearest")}if(d)break;c=c.assignedSlot||c.parentNode}else if(c.nodeType==11)c=c.host;else break}function AV(r){let e=r.ownerDocument,t,n;for(let i=r.parentNode;i&&!(i==e.body||t&&n);)if(i.nodeType==1)!n&&i.scrollHeight>i.clientHeight&&(n=i),!t&&i.scrollWidth>i.clientWidth&&(t=i),i=i.assignedSlot||i.parentNode;else if(i.nodeType==11)i=i.host;else break;return{x:t,y:n}}class EV{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(e){return this.anchorNode==e.anchorNode&&this.anchorOffset==e.anchorOffset&&this.focusNode==e.focusNode&&this.focusOffset==e.focusOffset}setRange(e){let{anchorNode:t,focusNode:n}=e;this.set(t,Math.min(e.anchorOffset,t?ks(t):0),n,Math.min(e.focusOffset,n?ks(n):0))}set(e,t,n,i){this.anchorNode=e,this.anchorOffset=t,this.focusNode=n,this.focusOffset=i}}let sl=null;function nA(r){if(r.setActive)return r.setActive();if(sl)return r.focus(sl);let e=[];for(let t=r;t&&(e.push(t,t.scrollTop,t.scrollLeft),t!=t.ownerDocument);t=t.parentNode);if(r.focus(sl==null?{get preventScroll(){return sl={preventScroll:!0},!0}}:void 0),!sl){sl=!1;for(let t=0;t<e.length;){let n=e[t++],i=e[t++],s=e[t++];n.scrollTop!=i&&(n.scrollTop=i),n.scrollLeft!=s&&(n.scrollLeft=s)}}}let Qw;function No(r,e,t=e){let n=Qw||(Qw=document.createRange());return n.setEnd(r,t),n.setStart(r,e),n}function Al(r,e,t,n){let i={key:e,code:e,keyCode:t,which:t,cancelable:!0};n&&({altKey:i.altKey,ctrlKey:i.ctrlKey,shiftKey:i.shiftKey,metaKey:i.metaKey}=n);let s=new KeyboardEvent("keydown",i);s.synthetic=!0,r.dispatchEvent(s);let a=new KeyboardEvent("keyup",i);return a.synthetic=!0,r.dispatchEvent(a),s.defaultPrevented||a.defaultPrevented}function PV(r){for(;r;){if(r&&(r.nodeType==9||r.nodeType==11&&r.host))return r;r=r.assignedSlot||r.parentNode}return null}function iA(r){for(;r.attributes.length;)r.removeAttributeNode(r.attributes[0])}function RV(r,e){let t=e.focusNode,n=e.focusOffset;if(!t||e.anchorNode!=t||e.anchorOffset!=n)return!1;for(n=Math.min(n,ks(t));;)if(n){if(t.nodeType!=1)return!1;let i=t.childNodes[n-1];i.contentEditable=="false"?n--:(t=i,n=ks(t))}else{if(t==r)return!0;n=$o(t),t=t.parentNode}}function sA(r){return r.scrollTop>Math.max(1,r.scrollHeight-r.clientHeight-4)}function aA(r,e){for(let t=r,n=e;;){if(t.nodeType==3&&n>0)return{node:t,offset:n};if(t.nodeType==1&&n>0){if(t.contentEditable=="false")return null;t=t.childNodes[n-1],n=ks(t)}else if(t.parentNode&&!Zd(t))n=$o(t),t=t.parentNode;else return null}}function oA(r,e){for(let t=r,n=e;;){if(t.nodeType==3&&n<t.nodeValue.length)return{node:t,offset:n};if(t.nodeType==1&&n<t.childNodes.length){if(t.contentEditable=="false")return null;t=t.childNodes[n],n=0}else if(t.parentNode&&!Zd(t))n=$o(t)+1,t=t.parentNode;else return null}}class wn{constructor(e,t,n=!0){this.node=e,this.offset=t,this.precise=n}static before(e,t){return new wn(e.parentNode,$o(e),t)}static after(e,t){return new wn(e.parentNode,$o(e)+1,t)}}const px=[];class Yt{constructor(){this.parent=null,this.dom=null,this.flags=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(e){let t=this.posAtStart;for(let n of this.children){if(n==e)return t;t+=n.length+n.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(e){return this.posBefore(e)+e.length}sync(e,t){if(this.flags&2){let n=this.dom,i=null,s;for(let a of this.children){if(a.flags&7){if(!a.dom&&(s=i?i.nextSibling:n.firstChild)){let o=Yt.get(s);(!o||!o.parent&&o.canReuseDOM(a))&&a.reuseDOM(s)}a.sync(e,t),a.flags&=-8}if(s=i?i.nextSibling:n.firstChild,t&&!t.written&&t.node==n&&s!=a.dom&&(t.written=!0),a.dom.parentNode==n)for(;s&&s!=a.dom;)s=Fw(s);else n.insertBefore(a.dom,s);i=a.dom}for(s=i?i.nextSibling:n.firstChild,s&&t&&t.node==n&&(t.written=!0);s;)s=Fw(s)}else if(this.flags&1)for(let n of this.children)n.flags&7&&(n.sync(e,t),n.flags&=-8)}reuseDOM(e){}localPosFromDOM(e,t){let n;if(e==this.dom)n=this.dom.childNodes[t];else{let i=ks(e)==0?0:t==0?-1:1;for(;;){let s=e.parentNode;if(s==this.dom)break;i==0&&s.firstChild!=s.lastChild&&(e==s.firstChild?i=-1:i=1),e=s}i<0?n=e:n=e.nextSibling}if(n==this.dom.firstChild)return 0;for(;n&&!Yt.get(n);)n=n.nextSibling;if(!n)return this.length;for(let i=0,s=0;;i++){let a=this.children[i];if(a.dom==n)return s;s+=a.length+a.breakAfter}}domBoundsAround(e,t,n=0){let i=-1,s=-1,a=-1,o=-1;for(let l=0,f=n,c=n;l<this.children.length;l++){let h=this.children[l],u=f+h.length;if(f<e&&u>t)return h.domBoundsAround(e,t,f);if(u>=e&&i==-1&&(i=l,s=f),f>t&&h.dom.parentNode==this.dom){a=l,o=c;break}c=u,f=u+h.breakAfter}return{from:s,to:o<0?n+this.length:o,startDOM:(i?this.children[i-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:a<this.children.length&&a>=0?this.children[a].dom:null}}markDirty(e=!1){this.flags|=2,this.markParentsDirty(e)}markParentsDirty(e){for(let t=this.parent;t;t=t.parent){if(e&&(t.flags|=2),t.flags&1)return;t.flags|=1,e=!1}}setParent(e){this.parent!=e&&(this.parent=e,this.flags&7&&this.markParentsDirty(!0))}setDOM(e){this.dom!=e&&(this.dom&&(this.dom.cmView=null),this.dom=e,e.cmView=this)}get rootView(){for(let e=this;;){let t=e.parent;if(!t)return e;e=t}}replaceChildren(e,t,n=px){this.markDirty();for(let i=e;i<t;i++){let s=this.children[i];s.parent==this&&n.indexOf(s)<0&&s.destroy()}n.length<250?this.children.splice(e,t-e,...n):this.children=[].concat(this.children.slice(0,e),n,this.children.slice(t));for(let i=0;i<n.length;i++)n[i].setParent(this)}ignoreMutation(e){return!1}ignoreEvent(e){return!1}childCursor(e=this.length){return new lA(this.children,e,this.children.length)}childPos(e,t=1){return this.childCursor().findPos(e,t)}toString(){let e=this.constructor.name.replace("View","");return e+(this.children.length?"("+this.children.join()+")":this.length?"["+(e=="Text"?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(e){return e.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(e,t,n,i,s,a){return!1}become(e){return!1}canReuseDOM(e){return e.constructor==this.constructor&&!((this.flags|e.flags)&8)}getSide(){return 0}destroy(){for(let e of this.children)e.parent==this&&e.destroy();this.parent=null}}Yt.prototype.breakAfter=0;function Fw(r){let e=r.nextSibling;return r.parentNode.removeChild(r),e}class lA{constructor(e,t,n){this.children=e,this.pos=t,this.i=n,this.off=0}findPos(e,t=1){for(;;){if(e>this.pos||e==this.pos&&(t>0||this.i==0||this.children[this.i-1].breakAfter))return this.off=e-this.pos,this;let n=this.children[--this.i];this.pos-=n.length+n.breakAfter}}}function fA(r,e,t,n,i,s,a,o,l){let{children:f}=r,c=f.length?f[e]:null,h=s.length?s[s.length-1]:null,u=h?h.breakAfter:a;if(!(e==n&&c&&!a&&!u&&s.length<2&&c.merge(t,i,s.length?h:null,t==0,o,l))){if(n<f.length){let d=f[n];d&&(i<d.length||d.breakAfter&&(h!=null&&h.breakAfter))?(e==n&&(d=d.split(i),i=0),!u&&h&&d.merge(0,i,h,!0,0,l)?s[s.length-1]=d:((i||d.children.length&&!d.children[0].length)&&d.merge(0,i,null,!1,0,l),s.push(d))):d!=null&&d.breakAfter&&(h?h.breakAfter=1:a=1),n++}for(c&&(c.breakAfter=a,t>0&&(!a&&s.length&&c.merge(t,c.length,s[0],!1,o,0)?c.breakAfter=s.shift().breakAfter:(t<c.length||c.children.length&&c.children[c.children.length-1].length==0)&&c.merge(t,c.length,null,!1,o,0),e++));e<n&&s.length;)if(f[n-1].become(s[s.length-1]))n--,s.pop(),l=s.length?0:o;else if(f[e].become(s[0]))e++,s.shift(),o=s.length?0:l;else break;!s.length&&e&&n<f.length&&!f[e-1].breakAfter&&f[n].merge(0,0,f[e-1],!1,o,l)&&e--,(e<n||s.length)&&r.replaceChildren(e,n,s)}}function cA(r,e,t,n,i,s){let a=r.childCursor(),{i:o,off:l}=a.findPos(t,1),{i:f,off:c}=a.findPos(e,-1),h=e-t;for(let u of n)h+=u.length;r.length+=h,fA(r,f,c,o,l,n,0,i,s)}let Un=typeof navigator<"u"?navigator:{userAgent:"",vendor:"",platform:""},kg=typeof document<"u"?document:{documentElement:{style:{}}};const Sg=/Edge\/(\d+)/.exec(Un.userAgent),hA=/MSIE \d/.test(Un.userAgent),Tg=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Un.userAgent),B0=!!(hA||Tg||Sg),$w=!B0&&/gecko\/(\d+)/i.test(Un.userAgent),Pp=!B0&&/Chrome\/(\d+)/.exec(Un.userAgent),Nw="webkitFontSmoothing"in kg.documentElement.style,uA=!B0&&/Apple Computer/.test(Un.vendor),Dw=uA&&(/Mobile\/\w+/.test(Un.userAgent)||Un.maxTouchPoints>2);var je={mac:Dw||/Mac/.test(Un.platform),windows:/Win/.test(Un.platform),linux:/Linux|X11/.test(Un.platform),ie:B0,ie_version:hA?kg.documentMode||6:Tg?+Tg[1]:Sg?+Sg[1]:0,gecko:$w,gecko_version:$w?+(/Firefox\/(\d+)/.exec(Un.userAgent)||[0,0])[1]:0,chrome:!!Pp,chrome_version:Pp?+Pp[1]:0,ios:Dw,android:/Android\b/.test(Un.userAgent),webkit:Nw,safari:uA,webkit_version:Nw?+(/\bAppleWebKit\/(\d+)/.exec(Un.userAgent)||[0,0])[1]:0,tabSize:kg.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};const QV=256;class Yi extends Yt{constructor(e){super(),this.text=e}get length(){return this.text.length}createDOM(e){this.setDOM(e||document.createTextNode(this.text))}sync(e,t){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(t&&t.node==this.dom&&(t.written=!0),this.dom.nodeValue=this.text)}reuseDOM(e){e.nodeType==3&&this.createDOM(e)}merge(e,t,n){return this.flags&8||n&&(!(n instanceof Yi)||this.length-(t-e)+n.length>QV||n.flags&8)?!1:(this.text=this.text.slice(0,e)+(n?n.text:"")+this.text.slice(t),this.markDirty(),!0)}split(e){let t=new Yi(this.text.slice(e));return this.text=this.text.slice(0,e),this.markDirty(),t.flags|=this.flags&8,t}localPosFromDOM(e,t){return e==this.dom?t:t?this.text.length:0}domAtPos(e){return new wn(this.dom,e)}domBoundsAround(e,t,n){return{from:n,to:n+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(e,t){return FV(this.dom,e,t)}}class Hs extends Yt{constructor(e,t=[],n=0){super(),this.mark=e,this.children=t,this.length=n;for(let i of t)i.setParent(this)}setAttrs(e){if(iA(e),this.mark.class&&(e.className=this.mark.class),this.mark.attrs)for(let t in this.mark.attrs)e.setAttribute(t,this.mark.attrs[t]);return e}canReuseDOM(e){return super.canReuseDOM(e)&&!((this.flags|e.flags)&8)}reuseDOM(e){e.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(e),this.flags|=6)}sync(e,t){this.dom?this.flags&4&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(e,t)}merge(e,t,n,i,s,a){return n&&(!(n instanceof Hs&&n.mark.eq(this.mark))||e&&s<=0||t<this.length&&a<=0)?!1:(cA(this,e,t,n?n.children.slice():[],s-1,a-1),this.markDirty(),!0)}split(e){let t=[],n=0,i=-1,s=0;for(let o of this.children){let l=n+o.length;l>e&&t.push(n<e?o.split(e-n):o),i<0&&n>=e&&(i=s),n=l,s++}let a=this.length-e;return this.length=e,i>-1&&(this.children.length=i,this.markDirty()),new Hs(this.mark,t,a)}domAtPos(e){return dA(this,e)}coordsAt(e,t){return mA(this,e,t)}}function FV(r,e,t){let n=r.nodeValue.length;e>n&&(e=n);let i=e,s=e,a=0;e==0&&t<0||e==n&&t>=0?je.chrome||je.gecko||(e?(i--,a=1):s<n&&(s++,a=-1)):t<0?i--:s<n&&s++;let o=No(r,i,s).getClientRects();if(!o.length)return null;let l=o[(a?a<0:t>=0)?0:o.length-1];return je.safari&&!a&&l.width==0&&(l=Array.prototype.find.call(o,f=>f.width)||l),a?L0(l,a<0):l||null}class Ca extends Yt{static create(e,t,n){return new Ca(e,t,n)}constructor(e,t,n){super(),this.widget=e,this.length=t,this.side=n,this.prevWidget=null}split(e){let t=Ca.create(this.widget,this.length-e,this.side);return this.length-=e,t}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.widget.editable||(this.dom.contentEditable="false"))}getSide(){return this.side}merge(e,t,n,i,s,a){return n&&(!(n instanceof Ca)||!this.widget.compare(n.widget)||e>0&&s<=0||t<this.length&&a<=0)?!1:(this.length=e+(n?n.length:0)+(this.length-t),!0)}become(e){return e instanceof Ca&&e.side==this.side&&this.widget.constructor==e.widget.constructor?(this.widget.compare(e.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get overrideDOMText(){if(this.length==0)return Nt.empty;let e=this;for(;e.parent;)e=e.parent;let{view:t}=e,n=t&&t.state.doc,i=this.posAtStart;return n?n.slice(i,i+this.length):Nt.empty}domAtPos(e){return(this.length?e==0:this.side>0)?wn.before(this.dom):wn.after(this.dom,e==this.length)}domBoundsAround(){return null}coordsAt(e,t){let n=this.widget.coordsAt(this.dom,e,t);if(n)return n;let i=this.dom.getClientRects(),s=null;if(!i.length)return null;let a=this.side?this.side<0:e>0;for(let o=a?i.length-1:0;s=i[o],!(e>0?o==0:o==i.length-1||s.top<s.bottom);o+=a?-1:1);return L0(s,!a)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class Wl extends Yt{constructor(e){super(),this.side=e}get length(){return 0}merge(){return!1}become(e){return e instanceof Wl&&e.side==this.side}split(){return new Wl(this.side)}sync(){if(!this.dom){let e=document.createElement("img");e.className="cm-widgetBuffer",e.setAttribute("aria-hidden","true"),this.setDOM(e)}}getSide(){return this.side}domAtPos(e){return this.side>0?wn.before(this.dom):wn.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(e){return this.dom.getBoundingClientRect()}get overrideDOMText(){return Nt.empty}get isHidden(){return!0}}Yi.prototype.children=Ca.prototype.children=Wl.prototype.children=px;function dA(r,e){let t=r.dom,{children:n}=r,i=0;for(let s=0;i<n.length;i++){let a=n[i],o=s+a.length;if(!(o==s&&a.getSide()<=0)){if(e>s&&e<o&&a.dom.parentNode==t)return a.domAtPos(e-s);if(e<=s)break;s=o}}for(let s=i;s>0;s--){let a=n[s-1];if(a.dom.parentNode==t)return a.domAtPos(a.length)}for(let s=i;s<n.length;s++){let a=n[s];if(a.dom.parentNode==t)return a.domAtPos(0)}return new wn(t,0)}function pA(r,e,t){let n,{children:i}=r;t>0&&e instanceof Hs&&i.length&&(n=i[i.length-1])instanceof Hs&&n.mark.eq(e.mark)?pA(n,e.children[0],t-1):(i.push(e),e.setParent(r)),r.length+=e.length}function mA(r,e,t){let n=null,i=-1,s=null,a=-1;function o(f,c){for(let h=0,u=0;h<f.children.length&&u<=c;h++){let d=f.children[h],p=u+d.length;p>=c&&(d.children.length?o(d,c-u):(!s||s.isHidden&&t>0)&&(p>c||u==p&&d.getSide()>0)?(s=d,a=c-u):(u<c||u==p&&d.getSide()<0&&!d.isHidden)&&(n=d,i=c-u)),u=p}}o(r,e);let l=(t<0?n:s)||n||s;return l?l.coordsAt(Math.max(0,l==n?i:a),t):$V(r)}function $V(r){let e=r.dom.lastChild;if(!e)return r.dom.getBoundingClientRect();let t=Vc(e);return t[t.length-1]||null}function Cg(r,e){for(let t in r)t=="class"&&e.class?e.class+=" "+r.class:t=="style"&&e.style?e.style+=";"+r.style:e[t]=r[t];return e}const Mw=Object.create(null);function Wd(r,e,t){if(r==e)return!0;r||(r=Mw),e||(e=Mw);let n=Object.keys(r),i=Object.keys(e);if(n.length-(t&&n.indexOf(t)>-1?1:0)!=i.length-(t&&i.indexOf(t)>-1?1:0))return!1;for(let s of n)if(s!=t&&(i.indexOf(s)==-1||r[s]!==e[s]))return!1;return!0}function Ag(r,e,t){let n=!1;if(e)for(let i in e)t&&i in t||(n=!0,i=="style"?r.style.cssText="":r.removeAttribute(i));if(t)for(let i in t)e&&e[i]==t[i]||(n=!0,i=="style"?r.style.cssText=t[i]:r.setAttribute(i,t[i]));return n}function NV(r){let e=Object.create(null);for(let t=0;t<r.attributes.length;t++){let n=r.attributes[t];e[n.name]=n.value}return e}class ia{eq(e){return!1}updateDOM(e,t){return!1}compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(e){return!0}coordsAt(e,t,n){return null}get isHidden(){return!1}get editable(){return!1}destroy(e){}}var $n=function(r){return r[r.Text=0]="Text",r[r.WidgetBefore=1]="WidgetBefore",r[r.WidgetAfter=2]="WidgetAfter",r[r.WidgetRange=3]="WidgetRange",r}($n||($n={}));class ze extends zs{constructor(e,t,n,i){super(),this.startSide=e,this.endSide=t,this.widget=n,this.spec=i}get heightRelevant(){return!1}static mark(e){return new Eh(e)}static widget(e){let t=Math.max(-1e4,Math.min(1e4,e.side||0)),n=!!e.block;return t+=n&&!e.inlineOrder?t>0?3e8:-4e8:t>0?1e8:-1e8,new Ia(e,t,t,n,e.widget||null,!1)}static replace(e){let t=!!e.block,n,i;if(e.isBlockGap)n=-5e8,i=4e8;else{let{start:s,end:a}=gA(e,t);n=(s?t?-3e8:-1:5e8)-1,i=(a?t?2e8:1:-6e8)+1}return new Ia(e,n,i,t,e.widget||null,!0)}static line(e){return new Ph(e)}static set(e,t=!1){return At.of(e,t)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}}ze.none=At.empty;class Eh extends ze{constructor(e){let{start:t,end:n}=gA(e);super(t?-1:5e8,n?1:-6e8,null,e),this.tagName=e.tagName||"span",this.class=e.class||"",this.attrs=e.attributes||null}eq(e){var t,n;return this==e||e instanceof Eh&&this.tagName==e.tagName&&(this.class||((t=this.attrs)===null||t===void 0?void 0:t.class))==(e.class||((n=e.attrs)===null||n===void 0?void 0:n.class))&&Wd(this.attrs,e.attrs,"class")}range(e,t=e){if(e>=t)throw new RangeError("Mark decorations may not be empty");return super.range(e,t)}}Eh.prototype.point=!1;class Ph extends ze{constructor(e){super(-2e8,-2e8,null,e)}eq(e){return e instanceof Ph&&this.spec.class==e.spec.class&&Wd(this.spec.attributes,e.spec.attributes)}range(e,t=e){if(t!=e)throw new RangeError("Line decoration ranges must be zero-length");return super.range(e,t)}}Ph.prototype.mapMode=hn.TrackBefore;Ph.prototype.point=!0;class Ia extends ze{constructor(e,t,n,i,s,a){super(t,n,s,e),this.block=i,this.isReplace=a,this.mapMode=i?t<=0?hn.TrackBefore:hn.TrackAfter:hn.TrackDel}get type(){return this.startSide!=this.endSide?$n.WidgetRange:this.startSide<=0?$n.WidgetBefore:$n.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(e){return e instanceof Ia&&DV(this.widget,e.widget)&&this.block==e.block&&this.startSide==e.startSide&&this.endSide==e.endSide}range(e,t=e){if(this.isReplace&&(e>t||e==t&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&t!=e)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(e,t)}}Ia.prototype.point=!0;function gA(r,e=!1){let{inclusiveStart:t,inclusiveEnd:n}=r;return t==null&&(t=r.inclusive),n==null&&(n=r.inclusive),{start:t??e,end:n??e}}function DV(r,e){return r==e||!!(r&&e&&r.compare(e))}function Xu(r,e,t,n=0){let i=t.length-1;i>=0&&t[i]+n>=r?t[i]=Math.max(t[i],e):t.push(r,e)}class Mr extends Yt{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(e,t,n,i,s,a){if(n){if(!(n instanceof Mr))return!1;this.dom||n.transferDOM(this)}return i&&this.setDeco(n?n.attrs:null),cA(this,e,t,n?n.children.slice():[],s,a),!0}split(e){let t=new Mr;if(t.breakAfter=this.breakAfter,this.length==0)return t;let{i:n,off:i}=this.childPos(e);i&&(t.append(this.children[n].split(i),0),this.children[n].merge(i,this.children[n].length,null,!1,0,0),n++);for(let s=n;s<this.children.length;s++)t.append(this.children[s],0);for(;n>0&&this.children[n-1].length==0;)this.children[--n].destroy();return this.children.length=n,this.markDirty(),this.length=e,t}transferDOM(e){this.dom&&(this.markDirty(),e.setDOM(this.dom),e.prevAttrs=this.prevAttrs===void 0?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(e){Wd(this.attrs,e)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=e)}append(e,t){pA(this,e,t)}addLineDeco(e){let t=e.spec.attributes,n=e.spec.class;t&&(this.attrs=Cg(t,this.attrs||{})),n&&(this.attrs=Cg({class:n},this.attrs||{}))}domAtPos(e){return dA(this,e)}reuseDOM(e){e.nodeName=="DIV"&&(this.setDOM(e),this.flags|=6)}sync(e,t){var n;this.dom?this.flags&4&&(iA(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),this.prevAttrs!==void 0&&(Ag(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(e,t);let i=this.dom.lastChild;for(;i&&Yt.get(i)instanceof Hs;)i=i.lastChild;if(!i||!this.length||i.nodeName!="BR"&&((n=Yt.get(i))===null||n===void 0?void 0:n.isEditable)==!1&&(!je.ios||!this.children.some(s=>s instanceof Yi))){let s=document.createElement("BR");s.cmIgnore=!0,this.dom.appendChild(s)}}measureTextSize(){if(this.children.length==0||this.length>20)return null;let e=0,t;for(let n of this.children){if(!(n instanceof Yi)||/[^ -~]/.test(n.text))return null;let i=Vc(n.dom);if(i.length!=1)return null;e+=i[0].width,t=i[0].height}return e?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:e/this.length,textHeight:t}:null}coordsAt(e,t){let n=mA(this,e,t);if(!this.children.length&&n&&this.parent){let{heightOracle:i}=this.parent.view.viewState,s=n.bottom-n.top;if(Math.abs(s-i.lineHeight)<2&&i.textHeight<s){let a=(s-i.textHeight)/2;return{top:n.top+a,bottom:n.bottom-a,left:n.left,right:n.left}}}return n}become(e){return e instanceof Mr&&this.children.length==0&&e.children.length==0&&Wd(this.attrs,e.attrs)&&this.breakAfter==e.breakAfter}covers(){return!0}static find(e,t){for(let n=0,i=0;n<e.children.length;n++){let s=e.children[n],a=i+s.length;if(a>=t){if(s instanceof Mr)return s;if(a>t)break}i=a+s.breakAfter}return null}}class Vs extends Yt{constructor(e,t,n){super(),this.widget=e,this.length=t,this.deco=n,this.breakAfter=0,this.prevWidget=null}merge(e,t,n,i,s,a){return n&&(!(n instanceof Vs)||!this.widget.compare(n.widget)||e>0&&s<=0||t<this.length&&a<=0)?!1:(this.length=e+(n?n.length:0)+(this.length-t),!0)}domAtPos(e){return e==0?wn.before(this.dom):wn.after(this.dom,e==this.length)}split(e){let t=this.length-e;this.length=e;let n=new Vs(this.widget,t,this.deco);return n.breakAfter=this.breakAfter,n}get children(){return px}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.widget.editable||(this.dom.contentEditable="false"))}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):Nt.empty}domBoundsAround(){return null}become(e){return e instanceof Vs&&e.widget.constructor==this.widget.constructor?(e.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,this.deco=e.deco,this.breakAfter=e.breakAfter,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get isEditable(){return!1}get isWidget(){return!0}coordsAt(e,t){let n=this.widget.coordsAt(this.dom,e,t);return n||(this.widget instanceof Eg?null:L0(this.dom.getBoundingClientRect(),this.length?e==0:t<=0))}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}covers(e){let{startSide:t,endSide:n}=this.deco;return t==n?!1:e<0?t<0:n>0}}class Eg extends ia{constructor(e){super(),this.height=e}toDOM(){let e=document.createElement("div");return e.className="cm-gap",this.updateDOM(e),e}eq(e){return e.height==this.height}updateDOM(e){return e.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}}class yc{constructor(e,t,n,i){this.doc=e,this.pos=t,this.end=n,this.disallowBlockEffectsFor=i,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=e.iter(),this.skip=t}posCovered(){if(this.content.length==0)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let e=this.content[this.content.length-1];return!(e.breakAfter||e instanceof Vs&&e.deco.endSide<0)}getLine(){return this.curLine||(this.content.push(this.curLine=new Mr),this.atCursorPos=!0),this.curLine}flushBuffer(e=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(iu(new Wl(-1),e),e.length),this.pendingBuffer=0)}addBlockWidget(e){this.flushBuffer(),this.curLine=null,this.content.push(e)}finish(e){this.pendingBuffer&&e<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,!this.posCovered()&&!(e&&this.content.length&&this.content[this.content.length-1]instanceof Vs)&&this.getLine()}buildText(e,t,n){for(;e>0;){if(this.textOff==this.text.length){let{value:s,lineBreak:a,done:o}=this.cursor.next(this.skip);if(this.skip=0,o)throw new Error("Ran out of text content when drawing inline views");if(a){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,e--;continue}else this.text=s,this.textOff=0}let i=Math.min(this.text.length-this.textOff,e,512);this.flushBuffer(t.slice(t.length-n)),this.getLine().append(iu(new Yi(this.text.slice(this.textOff,this.textOff+i)),t),n),this.atCursorPos=!0,this.textOff+=i,e-=i,n=0}}span(e,t,n,i){this.buildText(t-e,n,i),this.pos=t,this.openStart<0&&(this.openStart=i)}point(e,t,n,i,s,a){if(this.disallowBlockEffectsFor[a]&&n instanceof Ia){if(n.block)throw new RangeError("Block decorations may not be specified via plugins");if(t>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let o=t-e;if(n instanceof Ia)if(n.block)n.startSide>0&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new Vs(n.widget||Ul.block,o,n));else{let l=Ca.create(n.widget||Ul.inline,o,o?0:n.startSide),f=this.atCursorPos&&!l.isEditable&&s<=i.length&&(e<t||n.startSide>0),c=!l.isEditable&&(e<t||s>i.length||n.startSide<=0),h=this.getLine();this.pendingBuffer==2&&!f&&!l.isEditable&&(this.pendingBuffer=0),this.flushBuffer(i),f&&(h.append(iu(new Wl(1),i),s),s=i.length+Math.max(0,s-i.length)),h.append(iu(l,i),s),this.atCursorPos=c,this.pendingBuffer=c?e<t||s>i.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=i.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(n);o&&(this.textOff+o<=this.text.length?this.textOff+=o:(this.skip+=o-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=t),this.openStart<0&&(this.openStart=s)}static build(e,t,n,i,s){let a=new yc(e,t,n,s);return a.openEnd=At.spans(i,t,n,a),a.openStart<0&&(a.openStart=a.openEnd),a.finish(a.openEnd),a}}function iu(r,e){for(let t of e)r=new Hs(t,[r],r.length);return r}class Ul extends ia{constructor(e){super(),this.tag=e}eq(e){return e.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(e){return e.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}Ul.inline=new Ul("span");Ul.block=new Ul("div");var Rt=function(r){return r[r.LTR=0]="LTR",r[r.RTL=1]="RTL",r}(Rt||(Rt={}));const Do=Rt.LTR,mx=Rt.RTL;function OA(r){let e=[];for(let t=0;t<r.length;t++)e.push(1<<+r[t]);return e}const MV=OA("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),IV=OA("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),Pg=Object.create(null),as=[];for(let r of["()","[]","{}"]){let e=r.charCodeAt(0),t=r.charCodeAt(1);Pg[e]=t,Pg[t]=-e}function xA(r){return r<=247?MV[r]:1424<=r&&r<=1524?2:1536<=r&&r<=1785?IV[r-1536]:1774<=r&&r<=2220?4:8192<=r&&r<=8204?256:64336<=r&&r<=65023?4:1}const LV=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class Aa{get dir(){return this.level%2?mx:Do}constructor(e,t,n){this.from=e,this.to=t,this.level=n}side(e,t){return this.dir==t==e?this.to:this.from}forward(e,t){return e==(this.dir==t)}static find(e,t,n,i){let s=-1;for(let a=0;a<e.length;a++){let o=e[a];if(o.from<=t&&o.to>=t){if(o.level==n)return a;(s<0||(i!=0?i<0?o.from<t:o.to>t:e[s].level>o.level))&&(s=a)}}if(s<0)throw new RangeError("Index out of range");return s}}function vA(r,e){if(r.length!=e.length)return!1;for(let t=0;t<r.length;t++){let n=r[t],i=e[t];if(n.from!=i.from||n.to!=i.to||n.direction!=i.direction||!vA(n.inner,i.inner))return!1}return!0}const Gt=[];function BV(r,e,t,n,i){for(let s=0;s<=n.length;s++){let a=s?n[s-1].to:e,o=s<n.length?n[s].from:t,l=s?256:i;for(let f=a,c=l,h=l;f<o;f++){let u=xA(r.charCodeAt(f));u==512?u=c:u==8&&h==4&&(u=16),Gt[f]=u==4?2:u,u&7&&(h=u),c=u}for(let f=a,c=l,h=l;f<o;f++){let u=Gt[f];if(u==128)f<o-1&&c==Gt[f+1]&&c&24?u=Gt[f]=c:Gt[f]=256;else if(u==64){let d=f+1;for(;d<o&&Gt[d]==64;)d++;let p=f&&c==8||d<t&&Gt[d]==8?h==1?1:8:256;for(let m=f;m<d;m++)Gt[m]=p;f=d-1}else u==8&&h==1&&(Gt[f]=1);c=u,u&7&&(h=u)}}}function ZV(r,e,t,n,i){let s=i==1?2:1;for(let a=0,o=0,l=0;a<=n.length;a++){let f=a?n[a-1].to:e,c=a<n.length?n[a].from:t;for(let h=f,u,d,p;h<c;h++)if(d=Pg[u=r.charCodeAt(h)])if(d<0){for(let m=o-3;m>=0;m-=3)if(as[m+1]==-d){let g=as[m+2],v=g&2?i:g&4?g&1?s:i:0;v&&(Gt[h]=Gt[as[m]]=v),o=m;break}}else{if(as.length==189)break;as[o++]=h,as[o++]=u,as[o++]=l}else if((p=Gt[h])==2||p==1){let m=p==i;l=m?0:1;for(let g=o-3;g>=0;g-=3){let v=as[g+2];if(v&2)break;if(m)as[g+2]|=2;else{if(v&4)break;as[g+2]|=4}}}}}function WV(r,e,t,n){for(let i=0,s=n;i<=t.length;i++){let a=i?t[i-1].to:r,o=i<t.length?t[i].from:e;for(let l=a;l<o;){let f=Gt[l];if(f==256){let c=l+1;for(;;)if(c==o){if(i==t.length)break;c=t[i++].to,o=i<t.length?t[i].from:e}else if(Gt[c]==256)c++;else break;let h=s==1,u=(c<e?Gt[c]:n)==1,d=h==u?h?1:2:n;for(let p=c,m=i,g=m?t[m-1].to:r;p>l;)p==g&&(p=t[--m].from,g=m?t[m-1].to:r),Gt[--p]=d;l=c}else s=f,l++}}}function Rg(r,e,t,n,i,s,a){let o=n%2?2:1;if(n%2==i%2)for(let l=e,f=0;l<t;){let c=!0,h=!1;if(f==s.length||l<s[f].from){let m=Gt[l];m!=o&&(c=!1,h=m==16)}let u=!c&&o==1?[]:null,d=c?n:n+1,p=l;e:for(;;)if(f<s.length&&p==s[f].from){if(h)break e;let m=s[f];if(!c)for(let g=m.to,v=f+1;;){if(g==t)break e;if(v<s.length&&s[v].from==g)g=s[v++].to;else{if(Gt[g]==o)break e;break}}if(f++,u)u.push(m);else{m.from>l&&a.push(new Aa(l,m.from,d));let g=m.direction==Do!=!(d%2);Qg(r,g?n+1:n,i,m.inner,m.from,m.to,a),l=m.to}p=m.to}else{if(p==t||(c?Gt[p]!=o:Gt[p]==o))break;p++}u?Rg(r,l,p,n+1,i,u,a):l<p&&a.push(new Aa(l,p,d)),l=p}else for(let l=t,f=s.length;l>e;){let c=!0,h=!1;if(!f||l>s[f-1].to){let m=Gt[l-1];m!=o&&(c=!1,h=m==16)}let u=!c&&o==1?[]:null,d=c?n:n+1,p=l;e:for(;;)if(f&&p==s[f-1].to){if(h)break e;let m=s[--f];if(!c)for(let g=m.from,v=f;;){if(g==e)break e;if(v&&s[v-1].to==g)g=s[--v].from;else{if(Gt[g-1]==o)break e;break}}if(u)u.push(m);else{m.to<l&&a.push(new Aa(m.to,l,d));let g=m.direction==Do!=!(d%2);Qg(r,g?n+1:n,i,m.inner,m.from,m.to,a),l=m.from}p=m.from}else{if(p==e||(c?Gt[p-1]!=o:Gt[p-1]==o))break;p--}u?Rg(r,p,l,n+1,i,u,a):p<l&&a.push(new Aa(p,l,d)),l=p}}function Qg(r,e,t,n,i,s,a){let o=e%2?2:1;BV(r,i,s,n,o),ZV(r,i,s,n,o),WV(i,s,n,o),Rg(r,i,s,e,t,n,a)}function UV(r,e,t){if(!r)return[new Aa(0,0,e==mx?1:0)];if(e==Do&&!t.length&&!LV.test(r))return yA(r.length);if(t.length)for(;r.length>Gt.length;)Gt[Gt.length]=256;let n=[],i=e==Do?0:1;return Qg(r,i,i,t,0,r.length,n),n}function yA(r){return[new Aa(0,r,0)]}let wA="";function XV(r,e,t,n,i){var s;let a=n.head-r.from,o=Aa.find(e,a,(s=n.bidiLevel)!==null&&s!==void 0?s:-1,n.assoc),l=e[o],f=l.side(i,t);if(a==f){let u=o+=i?1:-1;if(u<0||u>=e.length)return null;l=e[o=u],a=l.side(!i,t),f=l.side(i,t)}let c=un(r.text,a,l.forward(i,t));(c<l.from||c>l.to)&&(c=f),wA=r.text.slice(Math.min(a,c),Math.max(a,c));let h=o==(i?e.length-1:0)?null:e[o+(i?1:-1)];return h&&c==f&&h.level+(i?0:1)<l.level?xe.cursor(h.side(!i,t)+r.from,h.forward(i,t)?1:-1,h.level):xe.cursor(c+r.from,l.forward(i,t)?-1:1,l.level)}function VV(r,e,t){for(let n=e;n<t;n++){let i=xA(r.charCodeAt(n));if(i==1)return Do;if(i==2||i==4)return mx}return Do}const bA=Le.define(),_A=Le.define(),kA=Le.define(),SA=Le.define(),Fg=Le.define(),TA=Le.define(),CA=Le.define(),gx=Le.define(),Ox=Le.define(),AA=Le.define({combine:r=>r.some(e=>e)}),EA=Le.define({combine:r=>r.some(e=>e)}),PA=Le.define();class El{constructor(e,t="nearest",n="nearest",i=5,s=5,a=!1){this.range=e,this.y=t,this.x=n,this.yMargin=i,this.xMargin=s,this.isSnapshot=a}map(e){return e.empty?this:new El(this.range.map(e),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(e){return this.range.to<=e.doc.length?this:new El(xe.cursor(e.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}}const su=ot.define({map:(r,e)=>r.map(e)}),RA=ot.define();function Jr(r,e,t){let n=r.facet(SA);n.length?n[0](e):window.onerror?window.onerror(String(e),t,void 0,void 0,e):t?console.error(t+":",e):console.error(e)}const Bs=Le.define({combine:r=>r.length?r[0]:!0});let qV=0;const qf=Le.define();class gr{constructor(e,t,n,i,s){this.id=e,this.create=t,this.domEventHandlers=n,this.domEventObservers=i,this.extension=s(this)}static define(e,t){const{eventHandlers:n,eventObservers:i,provide:s,decorations:a}=t||{};return new gr(qV++,e,n,i,o=>{let l=[qf.of(o)];return a&&l.push(qc.of(f=>{let c=f.plugin(o);return c?a(c):ze.none})),s&&l.push(s(o)),l})}static fromClass(e,t){return gr.define(n=>new e(n),t)}}class Rp{constructor(e){this.spec=e,this.mustUpdate=null,this.value=null}update(e){if(this.value){if(this.mustUpdate){let t=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(t)}catch(n){if(Jr(t.state,n,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.create(e)}catch(t){Jr(e.state,t,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(e){var t;if(!((t=this.value)===null||t===void 0)&&t.destroy)try{this.value.destroy()}catch(n){Jr(e.state,n,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const QA=Le.define(),xx=Le.define(),qc=Le.define(),FA=Le.define(),vx=Le.define(),$A=Le.define();function Iw(r,e){let t=r.state.facet($A);if(!t.length)return t;let n=t.map(s=>s instanceof Function?s(r):s),i=[];return At.spans(n,e.from,e.to,{point(){},span(s,a,o,l){let f=s-e.from,c=a-e.from,h=i;for(let u=o.length-1;u>=0;u--,l--){let d=o[u].spec.bidiIsolate,p;if(d==null&&(d=VV(e.text,f,c)),l>0&&h.length&&(p=h[h.length-1]).to==f&&p.direction==d)p.to=c,h=p.inner;else{let m={from:f,to:c,direction:d,inner:[]};h.push(m),h=m.inner}}}}),i}const NA=Le.define();function yx(r){let e=0,t=0,n=0,i=0;for(let s of r.state.facet(NA)){let a=s(r);a&&(a.left!=null&&(e=Math.max(e,a.left)),a.right!=null&&(t=Math.max(t,a.right)),a.top!=null&&(n=Math.max(n,a.top)),a.bottom!=null&&(i=Math.max(i,a.bottom)))}return{left:e,right:t,top:n,bottom:i}}const jf=Le.define();class Ai{constructor(e,t,n,i){this.fromA=e,this.toA=t,this.fromB=n,this.toB=i}join(e){return new Ai(Math.min(this.fromA,e.fromA),Math.max(this.toA,e.toA),Math.min(this.fromB,e.fromB),Math.max(this.toB,e.toB))}addToSet(e){let t=e.length,n=this;for(;t>0;t--){let i=e[t-1];if(!(i.fromA>n.toA)){if(i.toA<n.fromA)break;n=n.join(i),e.splice(t-1,1)}}return e.splice(t,0,n),e}static extendWithRanges(e,t){if(t.length==0)return e;let n=[];for(let i=0,s=0,a=0,o=0;;i++){let l=i==e.length?null:e[i],f=a-o,c=l?l.fromB:1e9;for(;s<t.length&&t[s]<c;){let h=t[s],u=t[s+1],d=Math.max(o,h),p=Math.min(c,u);if(d<=p&&new Ai(d+f,p+f,d,p).addToSet(n),u>c)break;s+=2}if(!l)return n;new Ai(l.fromA,l.toA,l.fromB,l.toB).addToSet(n),a=l.toA,o=l.toB}}}class Ud{constructor(e,t,n){this.view=e,this.state=t,this.transactions=n,this.flags=0,this.startState=e.state,this.changes=Ur.empty(this.startState.doc.length);for(let s of n)this.changes=this.changes.compose(s.changes);let i=[];this.changes.iterChangedRanges((s,a,o,l)=>i.push(new Ai(s,a,o,l))),this.changedRanges=i}static create(e,t,n){return new Ud(e,t,n)}get viewportChanged(){return(this.flags&4)>0}get viewportMoved(){return(this.flags&8)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&18)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(e=>e.selection)}get empty(){return this.flags==0&&this.transactions.length==0}}class Lw extends Yt{get length(){return this.view.state.doc.length}constructor(e){super(),this.view=e,this.decorations=[],this.dynamicDecorationMap=[!1],this.domChanged=null,this.hasComposition=null,this.markedForComposition=new Set,this.editContextFormatting=ze.none,this.lastCompositionAfterCursor=!1,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(e.contentDOM),this.children=[new Mr],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new Ai(0,0,0,e.state.doc.length)],0,null)}update(e){var t;let n=e.changedRanges;this.minWidth>0&&n.length&&(n.every(({fromA:f,toA:c})=>c<this.minWidthFrom||f>this.minWidthTo)?(this.minWidthFrom=e.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=e.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.updateEditContextFormatting(e);let i=-1;this.view.inputState.composing>=0&&!this.view.observer.editContext&&(!((t=this.domChanged)===null||t===void 0)&&t.newSel?i=this.domChanged.newSel.head:!JV(e.changes,this.hasComposition)&&!e.selectionSet&&(i=e.state.selection.main.head));let s=i>-1?zV(this.view,e.changes,i):null;if(this.domChanged=null,this.hasComposition){this.markedForComposition.clear();let{from:f,to:c}=this.hasComposition;n=new Ai(f,c,e.changes.mapPos(f,-1),e.changes.mapPos(c,1)).addToSet(n.slice())}this.hasComposition=s?{from:s.range.fromB,to:s.range.toB}:null,(je.ie||je.chrome)&&!s&&e&&e.state.doc.lines!=e.startState.doc.lines&&(this.forceSelection=!0);let a=this.decorations,o=this.updateDeco(),l=YV(a,o,e.changes);return n=Ai.extendWithRanges(n,l),!(this.flags&7)&&n.length==0?!1:(this.updateInner(n,e.startState.doc.length,s),e.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(e,t,n){this.view.viewState.mustMeasureContent=!0,this.updateChildren(e,t,n);let{observer:i}=this.view;i.ignore(()=>{this.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let a=je.chrome||je.ios?{node:i.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,a),this.flags&=-8,a&&(a.written||i.selectionRange.focusNode!=a.node)&&(this.forceSelection=!0),this.dom.style.height=""}),this.markedForComposition.forEach(a=>a.flags&=-9);let s=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let a of this.children)a instanceof Vs&&a.widget instanceof Eg&&s.push(a.dom);i.updateGaps(s)}updateChildren(e,t,n){let i=n?n.range.addToSet(e.slice()):e,s=this.childCursor(t);for(let a=i.length-1;;a--){let o=a>=0?i[a]:null;if(!o)break;let{fromA:l,toA:f,fromB:c,toB:h}=o,u,d,p,m;if(n&&n.range.fromB<h&&n.range.toB>c){let S=yc.build(this.view.state.doc,c,n.range.fromB,this.decorations,this.dynamicDecorationMap),y=yc.build(this.view.state.doc,n.range.toB,h,this.decorations,this.dynamicDecorationMap);d=S.breakAtStart,p=S.openStart,m=y.openEnd;let b=this.compositionView(n);y.breakAtStart?b.breakAfter=1:y.content.length&&b.merge(b.length,b.length,y.content[0],!1,y.openStart,0)&&(b.breakAfter=y.content[0].breakAfter,y.content.shift()),S.content.length&&b.merge(0,0,S.content[S.content.length-1],!0,0,S.openEnd)&&S.content.pop(),u=S.content.concat(b).concat(y.content)}else({content:u,breakAtStart:d,openStart:p,openEnd:m}=yc.build(this.view.state.doc,c,h,this.decorations,this.dynamicDecorationMap));let{i:g,off:v}=s.findPos(f,1),{i:w,off:x}=s.findPos(l,-1);fA(this,w,x,g,v,u,d,p,m)}n&&this.fixCompositionDOM(n)}updateEditContextFormatting(e){this.editContextFormatting=this.editContextFormatting.map(e.changes);for(let t of e.transactions)for(let n of t.effects)n.is(RA)&&(this.editContextFormatting=n.value)}compositionView(e){let t=new Yi(e.text.nodeValue);t.flags|=8;for(let{deco:i}of e.marks)t=new Hs(i,[t],t.length);let n=new Mr;return n.append(t,0),n}fixCompositionDOM(e){let t=(s,a)=>{a.flags|=8|(a.children.some(l=>l.flags&7)?1:0),this.markedForComposition.add(a);let o=Yt.get(s);o&&o!=a&&(o.dom=null),a.setDOM(s)},n=this.childPos(e.range.fromB,1),i=this.children[n.i];t(e.line,i);for(let s=e.marks.length-1;s>=-1;s--)n=i.childPos(n.off,1),i=i.children[n.i],t(s>=0?e.marks[s].node:e.text,i)}updateSelection(e=!1,t=!1){(e||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange();let n=this.view.root.activeElement,i=n==this.dom,s=!i&&!(this.view.state.facet(Bs)||this.dom.tabIndex>-1)&&Uu(this.dom,this.view.observer.selectionRange)&&!(n&&this.dom.contains(n));if(!(i||t||s))return;let a=this.forceSelection;this.forceSelection=!1;let o=this.view.state.selection.main,l=this.moveToLine(this.domAtPos(o.anchor)),f=o.empty?l:this.moveToLine(this.domAtPos(o.head));if(je.gecko&&o.empty&&!this.hasComposition&&jV(l)){let h=document.createTextNode("");this.view.observer.ignore(()=>l.node.insertBefore(h,l.node.childNodes[l.offset]||null)),l=f=new wn(h,0),a=!0}let c=this.view.observer.selectionRange;(a||!c.focusNode||(!vc(l.node,l.offset,c.anchorNode,c.anchorOffset)||!vc(f.node,f.offset,c.focusNode,c.focusOffset))&&!this.suppressWidgetCursorChange(c,o))&&(this.view.observer.ignore(()=>{je.android&&je.chrome&&this.dom.contains(c.focusNode)&&KV(c.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let h=Xc(this.view.root);if(h)if(o.empty){if(je.gecko){let u=GV(l.node,l.offset);if(u&&u!=3){let d=(u==1?aA:oA)(l.node,l.offset);d&&(l=new wn(d.node,d.offset))}}h.collapse(l.node,l.offset),o.bidiLevel!=null&&h.caretBidiLevel!==void 0&&(h.caretBidiLevel=o.bidiLevel)}else if(h.extend){h.collapse(l.node,l.offset);try{h.extend(f.node,f.offset)}catch{}}else{let u=document.createRange();o.anchor>o.head&&([l,f]=[f,l]),u.setEnd(f.node,f.offset),u.setStart(l.node,l.offset),h.removeAllRanges(),h.addRange(u)}s&&this.view.root.activeElement==this.dom&&(this.dom.blur(),n&&n.focus())}),this.view.observer.setSelectionRange(l,f)),this.impreciseAnchor=l.precise?null:new wn(c.anchorNode,c.anchorOffset),this.impreciseHead=f.precise?null:new wn(c.focusNode,c.focusOffset)}suppressWidgetCursorChange(e,t){return this.hasComposition&&t.empty&&vc(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)&&this.posFromDOM(e.focusNode,e.focusOffset)==t.head}enforceCursorAssoc(){if(this.hasComposition)return;let{view:e}=this,t=e.state.selection.main,n=Xc(e.root),{anchorNode:i,anchorOffset:s}=e.observer.selectionRange;if(!n||!t.empty||!t.assoc||!n.modify)return;let a=Mr.find(this,t.head);if(!a)return;let o=a.posAtStart;if(t.head==o||t.head==o+a.length)return;let l=this.coordsAt(t.head,-1),f=this.coordsAt(t.head,1);if(!l||!f||l.bottom>f.top)return;let c=this.domAtPos(t.head+t.assoc);n.collapse(c.node,c.offset),n.modify("move",t.assoc<0?"forward":"backward","lineboundary"),e.observer.readSelectionRange();let h=e.observer.selectionRange;e.docView.posFromDOM(h.anchorNode,h.anchorOffset)!=t.from&&n.collapse(i,s)}moveToLine(e){let t=this.dom,n;if(e.node!=t)return e;for(let i=e.offset;!n&&i<t.childNodes.length;i++){let s=Yt.get(t.childNodes[i]);s instanceof Mr&&(n=s.domAtPos(0))}for(let i=e.offset-1;!n&&i>=0;i--){let s=Yt.get(t.childNodes[i]);s instanceof Mr&&(n=s.domAtPos(s.length))}return n?new wn(n.node,n.offset,!0):e}nearest(e){for(let t=e;t;){let n=Yt.get(t);if(n&&n.rootView==this)return n;t=t.parentNode}return null}posFromDOM(e,t){let n=this.nearest(e);if(!n)throw new RangeError("Trying to find position for a DOM position outside of the document");return n.localPosFromDOM(e,t)+n.posAtStart}domAtPos(e){let{i:t,off:n}=this.childCursor().findPos(e,-1);for(;t<this.children.length-1;){let i=this.children[t];if(n<i.length||i instanceof Mr)break;t++,n=0}return this.children[t].domAtPos(n)}coordsAt(e,t){let n=null,i=0;for(let s=this.length,a=this.children.length-1;a>=0;a--){let o=this.children[a],l=s-o.breakAfter,f=l-o.length;if(l<e)break;if(f<=e&&(f<e||o.covers(-1))&&(l>e||o.covers(1))&&(!n||o instanceof Mr&&!(n instanceof Mr&&t>=0)))n=o,i=f;else if(n&&f==e&&l==e&&o instanceof Vs&&Math.abs(t)<2){if(o.deco.startSide<0)break;a&&(n=null)}s=f}return n?n.coordsAt(e-i,t):null}coordsForChar(e){let{i:t,off:n}=this.childPos(e,1),i=this.children[t];if(!(i instanceof Mr))return null;for(;i.children.length;){let{i:o,off:l}=i.childPos(n,1);for(;;o++){if(o==i.children.length)return null;if((i=i.children[o]).length)break}n=l}if(!(i instanceof Yi))return null;let s=un(i.text,n);if(s==n)return null;let a=No(i.dom,n,s).getClientRects();for(let o=0;o<a.length;o++){let l=a[o];if(o==a.length-1||l.top<l.bottom&&l.left<l.right)return l}return null}measureVisibleLineHeights(e){let t=[],{from:n,to:i}=e,s=this.view.contentDOM.clientWidth,a=s>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,o=-1,l=this.view.textDirection==Rt.LTR;for(let f=0,c=0;c<this.children.length;c++){let h=this.children[c],u=f+h.length;if(u>i)break;if(f>=n){let d=h.dom.getBoundingClientRect();if(t.push(d.height),a){let p=h.dom.lastChild,m=p?Vc(p):[];if(m.length){let g=m[m.length-1],v=l?g.right-d.left:d.right-g.left;v>o&&(o=v,this.minWidth=s,this.minWidthFrom=f,this.minWidthTo=u)}}}f=u+h.breakAfter}return t}textDirectionAt(e){let{i:t}=this.childPos(e,1);return getComputedStyle(this.children[t].dom).direction=="rtl"?Rt.RTL:Rt.LTR}measureTextSize(){for(let s of this.children)if(s instanceof Mr){let a=s.measureTextSize();if(a)return a}let e=document.createElement("div"),t,n,i;return e.className="cm-line",e.style.width="99999px",e.style.position="absolute",e.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.dom.appendChild(e);let s=Vc(e.firstChild)[0];t=e.getBoundingClientRect().height,n=s?s.width/27:7,i=s?s.height:t,e.remove()}),{lineHeight:t,charWidth:n,textHeight:i}}childCursor(e=this.length){let t=this.children.length;return t&&(e-=this.children[--t].length),new lA(this.children,e,t)}computeBlockGapDeco(){let e=[],t=this.view.viewState;for(let n=0,i=0;;i++){let s=i==t.viewports.length?null:t.viewports[i],a=s?s.from-1:this.length;if(a>n){let o=(t.lineBlockAt(a).bottom-t.lineBlockAt(n).top)/this.view.scaleY;e.push(ze.replace({widget:new Eg(o),block:!0,inclusive:!0,isBlockGap:!0}).range(n,a))}if(!s)break;n=s.to+1}return ze.set(e)}updateDeco(){let e=1,t=this.view.state.facet(qc).map(s=>(this.dynamicDecorationMap[e++]=typeof s=="function")?s(this.view):s),n=!1,i=this.view.state.facet(FA).map((s,a)=>{let o=typeof s=="function";return o&&(n=!0),o?s(this.view):s});for(i.length&&(this.dynamicDecorationMap[e++]=n,t.push(At.join(i))),this.decorations=[this.editContextFormatting,...t,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco];e<this.decorations.length;)this.dynamicDecorationMap[e++]=!1;return this.decorations}scrollIntoView(e){if(e.isSnapshot){let f=this.view.viewState.lineBlockAt(e.range.head);this.view.scrollDOM.scrollTop=f.top-e.yMargin,this.view.scrollDOM.scrollLeft=e.xMargin;return}for(let f of this.view.state.facet(PA))try{if(f(this.view,e.range,e))return!0}catch(c){Jr(this.view.state,c,"scroll handler")}let{range:t}=e,n=this.coordsAt(t.head,t.empty?t.assoc:t.head>t.anchor?-1:1),i;if(!n)return;!t.empty&&(i=this.coordsAt(t.anchor,t.anchor>t.head?-1:1))&&(n={left:Math.min(n.left,i.left),top:Math.min(n.top,i.top),right:Math.max(n.right,i.right),bottom:Math.max(n.bottom,i.bottom)});let s=yx(this.view),a={left:n.left-s.left,top:n.top-s.top,right:n.right+s.right,bottom:n.bottom+s.bottom},{offsetWidth:o,offsetHeight:l}=this.view.scrollDOM;CV(this.view.scrollDOM,a,t.head<t.anchor?-1:1,e.x,e.y,Math.max(Math.min(e.xMargin,o),-o),Math.max(Math.min(e.yMargin,l),-l),this.view.textDirection==Rt.LTR)}}function jV(r){return r.node.nodeType==1&&r.node.firstChild&&(r.offset==0||r.node.childNodes[r.offset-1].contentEditable=="false")&&(r.offset==r.node.childNodes.length||r.node.childNodes[r.offset].contentEditable=="false")}function DA(r,e){let t=r.observer.selectionRange;if(!t.focusNode)return null;let n=aA(t.focusNode,t.focusOffset),i=oA(t.focusNode,t.focusOffset),s=n||i;if(i&&n&&i.node!=n.node){let o=Yt.get(i.node);if(!o||o instanceof Yi&&o.text!=i.node.nodeValue)s=i;else if(r.docView.lastCompositionAfterCursor){let l=Yt.get(n.node);!l||l instanceof Yi&&l.text!=n.node.nodeValue||(s=i)}}if(r.docView.lastCompositionAfterCursor=s!=n,!s)return null;let a=e-s.offset;return{from:a,to:a+s.node.nodeValue.length,node:s.node}}function zV(r,e,t){let n=DA(r,t);if(!n)return null;let{node:i,from:s,to:a}=n,o=i.nodeValue;if(/[\n\r]/.test(o)||r.state.doc.sliceString(n.from,n.to)!=o)return null;let l=e.invertedDesc,f=new Ai(l.mapPos(s),l.mapPos(a),s,a),c=[];for(let h=i.parentNode;;h=h.parentNode){let u=Yt.get(h);if(u instanceof Hs)c.push({node:h,deco:u.mark});else{if(u instanceof Mr||h.nodeName=="DIV"&&h.parentNode==r.contentDOM)return{range:f,text:i,marks:c,line:h};if(h!=r.contentDOM)c.push({node:h,deco:new Eh({inclusive:!0,attributes:NV(h),tagName:h.tagName.toLowerCase()})});else return null}}}function GV(r,e){return r.nodeType!=1?0:(e&&r.childNodes[e-1].contentEditable=="false"?1:0)|(e<r.childNodes.length&&r.childNodes[e].contentEditable=="false"?2:0)}let HV=class{constructor(){this.changes=[]}compareRange(e,t){Xu(e,t,this.changes)}comparePoint(e,t){Xu(e,t,this.changes)}boundChange(e){Xu(e,e,this.changes)}};function YV(r,e,t){let n=new HV;return At.compare(r,e,t,n),n.changes}function KV(r,e){for(let t=r;t&&t!=e;t=t.assignedSlot||t.parentNode)if(t.nodeType==1&&t.contentEditable=="false")return!0;return!1}function JV(r,e){let t=!1;return e&&r.iterChangedRanges((n,i)=>{n<e.to&&i>e.from&&(t=!0)}),t}function eq(r,e,t=1){let n=r.charCategorizer(e),i=r.doc.lineAt(e),s=e-i.from;if(i.length==0)return xe.cursor(e);s==0?t=1:s==i.length&&(t=-1);let a=s,o=s;t<0?a=un(i.text,s,!1):o=un(i.text,s);let l=n(i.text.slice(a,o));for(;a>0;){let f=un(i.text,a,!1);if(n(i.text.slice(f,a))!=l)break;a=f}for(;o<i.length;){let f=un(i.text,o);if(n(i.text.slice(o,f))!=l)break;o=f}return xe.range(a+i.from,o+i.from)}function tq(r,e){return e.left>r?e.left-r:Math.max(0,r-e.right)}function rq(r,e){return e.top>r?e.top-r:Math.max(0,r-e.bottom)}function Qp(r,e){return r.top<e.bottom-1&&r.bottom>e.top+1}function Bw(r,e){return e<r.top?{top:e,left:r.left,right:r.right,bottom:r.bottom}:r}function Zw(r,e){return e>r.bottom?{top:r.top,left:r.left,right:r.right,bottom:e}:r}function $g(r,e,t){let n,i,s,a,o=!1,l,f,c,h;for(let p=r.firstChild;p;p=p.nextSibling){let m=Vc(p);for(let g=0;g<m.length;g++){let v=m[g];i&&Qp(i,v)&&(v=Bw(Zw(v,i.bottom),i.top));let w=tq(e,v),x=rq(t,v);if(w==0&&x==0)return p.nodeType==3?Ww(p,e,t):$g(p,e,t);if(!n||a>x||a==x&&s>w){n=p,i=v,s=w,a=x;let S=x?t<v.top?-1:1:w?e<v.left?-1:1:0;o=!S||(S>0?g<m.length-1:g>0)}w==0?t>v.bottom&&(!c||c.bottom<v.bottom)?(l=p,c=v):t<v.top&&(!h||h.top>v.top)&&(f=p,h=v):c&&Qp(c,v)?c=Zw(c,v.bottom):h&&Qp(h,v)&&(h=Bw(h,v.top))}}if(c&&c.bottom>=t?(n=l,i=c):h&&h.top<=t&&(n=f,i=h),!n)return{node:r,offset:0};let u=Math.max(i.left,Math.min(i.right,e));if(n.nodeType==3)return Ww(n,u,t);if(o&&n.contentEditable!="false")return $g(n,u,t);let d=Array.prototype.indexOf.call(r.childNodes,n)+(e>=(i.left+i.right)/2?1:0);return{node:r,offset:d}}function Ww(r,e,t){let n=r.nodeValue.length,i=-1,s=1e9,a=0;for(let o=0;o<n;o++){let l=No(r,o,o+1).getClientRects();for(let f=0;f<l.length;f++){let c=l[f];if(c.top==c.bottom)continue;a||(a=e-c.left);let h=(c.top>t?c.top-t:t-c.bottom)-1;if(c.left-1<=e&&c.right+1>=e&&h<s){let u=e>=(c.left+c.right)/2,d=u;if((je.chrome||je.gecko)&&No(r,o).getBoundingClientRect().left==c.right&&(d=!u),h<=0)return{node:r,offset:o+(d?1:0)};i=o+(d?1:0),s=h}}}return{node:r,offset:i>-1?i:a>0?r.nodeValue.length:0}}function MA(r,e,t,n=-1){var i,s;let a=r.contentDOM.getBoundingClientRect(),o=a.top+r.viewState.paddingTop,l,{docHeight:f}=r.viewState,{x:c,y:h}=e,u=h-o;if(u<0)return 0;if(u>f)return r.state.doc.length;for(let S=r.viewState.heightOracle.textHeight/2,y=!1;l=r.elementAtHeight(u),l.type!=$n.Text;)for(;u=n>0?l.bottom+S:l.top-S,!(u>=0&&u<=f);){if(y)return t?null:0;y=!0,n=-n}h=o+u;let d=l.from;if(d<r.viewport.from)return r.viewport.from==0?0:t?null:Uw(r,a,l,c,h);if(d>r.viewport.to)return r.viewport.to==r.state.doc.length?r.state.doc.length:t?null:Uw(r,a,l,c,h);let p=r.dom.ownerDocument,m=r.root.elementFromPoint?r.root:p,g=m.elementFromPoint(c,h);g&&!r.contentDOM.contains(g)&&(g=null),g||(c=Math.max(a.left+1,Math.min(a.right-1,c)),g=m.elementFromPoint(c,h),g&&!r.contentDOM.contains(g)&&(g=null));let v,w=-1;if(g&&((i=r.docView.nearest(g))===null||i===void 0?void 0:i.isEditable)!=!1){if(p.caretPositionFromPoint){let S=p.caretPositionFromPoint(c,h);S&&({offsetNode:v,offset:w}=S)}else if(p.caretRangeFromPoint){let S=p.caretRangeFromPoint(c,h);S&&({startContainer:v,startOffset:w}=S,(!r.contentDOM.contains(v)||je.safari&&nq(v,w,c)||je.chrome&&iq(v,w,c))&&(v=void 0))}v&&(w=Math.min(ks(v),w))}if(!v||!r.docView.dom.contains(v)){let S=Mr.find(r.docView,d);if(!S)return u>l.top+l.height/2?l.to:l.from;({node:v,offset:w}=$g(S.dom,c,h))}let x=r.docView.nearest(v);if(!x)return null;if(x.isWidget&&((s=x.dom)===null||s===void 0?void 0:s.nodeType)==1){let S=x.dom.getBoundingClientRect();return e.y<S.top||e.y<=S.bottom&&e.x<=(S.left+S.right)/2?x.posAtStart:x.posAtEnd}else return x.localPosFromDOM(v,w)+x.posAtStart}function Uw(r,e,t,n,i){let s=Math.round((n-e.left)*r.defaultCharacterWidth);if(r.lineWrapping&&t.height>r.defaultLineHeight*1.5){let o=r.viewState.heightOracle.textHeight,l=Math.floor((i-t.top-(r.defaultLineHeight-o)*.5)/o);s+=l*r.viewState.heightOracle.lineLength}let a=r.state.sliceDoc(t.from,t.to);return t.from+yg(a,s,r.state.tabSize)}function nq(r,e,t){let n;if(r.nodeType!=3||e!=(n=r.nodeValue.length))return!1;for(let i=r.nextSibling;i;i=i.nextSibling)if(i.nodeType!=1||i.nodeName!="BR")return!1;return No(r,n-1,n).getBoundingClientRect().left>t}function iq(r,e,t){if(e!=0)return!1;for(let i=r;;){let s=i.parentNode;if(!s||s.nodeType!=1||s.firstChild!=i)return!1;if(s.classList.contains("cm-line"))break;i=s}let n=r.nodeType==1?r.getBoundingClientRect():No(r,0,Math.max(r.nodeValue.length,1)).getBoundingClientRect();return t-n.left>5}function Ng(r,e){let t=r.lineBlockAt(e);if(Array.isArray(t.type)){for(let n of t.type)if(n.to>e||n.to==e&&(n.to==t.to||n.type==$n.Text))return n}return t}function sq(r,e,t,n){let i=Ng(r,e.head),s=!n||i.type!=$n.Text||!(r.lineWrapping||i.widgetLineBreaks)?null:r.coordsAtPos(e.assoc<0&&e.head>i.from?e.head-1:e.head);if(s){let a=r.dom.getBoundingClientRect(),o=r.textDirectionAt(i.from),l=r.posAtCoords({x:t==(o==Rt.LTR)?a.right-1:a.left+1,y:(s.top+s.bottom)/2});if(l!=null)return xe.cursor(l,t?-1:1)}return xe.cursor(t?i.to:i.from,t?-1:1)}function Xw(r,e,t,n){let i=r.state.doc.lineAt(e.head),s=r.bidiSpans(i),a=r.textDirectionAt(i.from);for(let o=e,l=null;;){let f=XV(i,s,a,o,t),c=wA;if(!f){if(i.number==(t?r.state.doc.lines:1))return o;c=`
`,i=r.state.doc.line(i.number+(t?1:-1)),s=r.bidiSpans(i),f=r.visualLineSide(i,!t)}if(l){if(!l(c))return o}else{if(!n)return f;l=n(c)}o=f}}function aq(r,e,t){let n=r.state.charCategorizer(e),i=n(t);return s=>{let a=n(s);return i==pr.Space&&(i=a),i==a}}function oq(r,e,t,n){let i=e.head,s=t?1:-1;if(i==(t?r.state.doc.length:0))return xe.cursor(i,e.assoc);let a=e.goalColumn,o,l=r.contentDOM.getBoundingClientRect(),f=r.coordsAtPos(i,e.assoc||-1),c=r.documentTop;if(f)a==null&&(a=f.left-l.left),o=s<0?f.top:f.bottom;else{let d=r.viewState.lineBlockAt(i);a==null&&(a=Math.min(l.right-l.left,r.defaultCharacterWidth*(i-d.from))),o=(s<0?d.top:d.bottom)+c}let h=l.left+a,u=n??r.viewState.heightOracle.textHeight>>1;for(let d=0;;d+=10){let p=o+(u+d)*s,m=MA(r,{x:h,y:p},!1,s);if(p<l.top||p>l.bottom||(s<0?m<i:m>i)){let g=r.docView.coordsForChar(m),v=!g||p<g.top?-1:1;return xe.cursor(m,v,void 0,a)}}}function Vu(r,e,t){for(;;){let n=0;for(let i of r)i.between(e-1,e+1,(s,a,o)=>{if(e>s&&e<a){let l=n||t||(e-s<a-e?-1:1);e=l<0?s:a,n=l}});if(!n)return e}}function Fp(r,e,t){let n=Vu(r.state.facet(vx).map(i=>i(r)),t.from,e.head>t.from?-1:1);return n==t.from?t:xe.cursor(n,n<t.from?1:-1)}const zf="";class lq{constructor(e,t){this.points=e,this.text="",this.lineSeparator=t.facet(lt.lineSeparator)}append(e){this.text+=e}lineBreak(){this.text+=zf}readRange(e,t){if(!e)return this;let n=e.parentNode;for(let i=e;;){this.findPointBefore(n,i);let s=this.text.length;this.readNode(i);let a=i.nextSibling;if(a==t)break;let o=Yt.get(i),l=Yt.get(a);(o&&l?o.breakAfter:(o?o.breakAfter:Zd(i))||Zd(a)&&(i.nodeName!="BR"||i.cmIgnore)&&this.text.length>s)&&this.lineBreak(),i=a}return this.findPointBefore(n,t),this}readTextNode(e){let t=e.nodeValue;for(let n of this.points)n.node==e&&(n.pos=this.text.length+Math.min(n.offset,t.length));for(let n=0,i=this.lineSeparator?null:/\r\n?|\n/g;;){let s=-1,a=1,o;if(this.lineSeparator?(s=t.indexOf(this.lineSeparator,n),a=this.lineSeparator.length):(o=i.exec(t))&&(s=o.index,a=o[0].length),this.append(t.slice(n,s<0?t.length:s)),s<0)break;if(this.lineBreak(),a>1)for(let l of this.points)l.node==e&&l.pos>this.text.length&&(l.pos-=a-1);n=s+a}}readNode(e){if(e.cmIgnore)return;let t=Yt.get(e),n=t&&t.overrideDOMText;if(n!=null){this.findPointInside(e,n.length);for(let i=n.iter();!i.next().done;)i.lineBreak?this.lineBreak():this.append(i.value)}else e.nodeType==3?this.readTextNode(e):e.nodeName=="BR"?e.nextSibling&&this.lineBreak():e.nodeType==1&&this.readRange(e.firstChild,null)}findPointBefore(e,t){for(let n of this.points)n.node==e&&e.childNodes[n.offset]==t&&(n.pos=this.text.length)}findPointInside(e,t){for(let n of this.points)(e.nodeType==3?n.node==e:e.contains(n.node))&&(n.pos=this.text.length+(fq(e,n.node,n.offset)?t:0))}}function fq(r,e,t){for(;;){if(!e||t<ks(e))return!1;if(e==r)return!0;t=$o(e)+1,e=e.parentNode}}class Vw{constructor(e,t){this.node=e,this.offset=t,this.pos=-1}}class cq{constructor(e,t,n,i){this.typeOver=i,this.bounds=null,this.text="",this.domChanged=t>-1;let{impreciseHead:s,impreciseAnchor:a}=e.docView;if(e.state.readOnly&&t>-1)this.newSel=null;else if(t>-1&&(this.bounds=e.docView.domBoundsAround(t,n,0))){let o=s||a?[]:dq(e),l=new lq(o,e.state);l.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=l.text,this.newSel=pq(o,this.bounds.from)}else{let o=e.observer.selectionRange,l=s&&s.node==o.focusNode&&s.offset==o.focusOffset||!_g(e.contentDOM,o.focusNode)?e.state.selection.main.head:e.docView.posFromDOM(o.focusNode,o.focusOffset),f=a&&a.node==o.anchorNode&&a.offset==o.anchorOffset||!_g(e.contentDOM,o.anchorNode)?e.state.selection.main.anchor:e.docView.posFromDOM(o.anchorNode,o.anchorOffset),c=e.viewport;if((je.ios||je.chrome)&&e.state.selection.main.empty&&l!=f&&(c.from>0||c.to<e.state.doc.length)){let h=Math.min(l,f),u=Math.max(l,f),d=c.from-h,p=c.to-u;(d==0||d==1||h==0)&&(p==0||p==-1||u==e.state.doc.length)&&(l=0,f=e.state.doc.length)}this.newSel=xe.single(f,l)}}}function IA(r,e){let t,{newSel:n}=e,i=r.state.selection.main,s=r.inputState.lastKeyTime>Date.now()-100?r.inputState.lastKeyCode:-1;if(e.bounds){let{from:a,to:o}=e.bounds,l=i.from,f=null;(s===8||je.android&&e.text.length<o-a)&&(l=i.to,f="end");let c=uq(r.state.doc.sliceString(a,o,zf),e.text,l-a,f);c&&(je.chrome&&s==13&&c.toB==c.from+2&&e.text.slice(c.from,c.toB)==zf+zf&&c.toB--,t={from:a+c.from,to:a+c.toA,insert:Nt.of(e.text.slice(c.from,c.toB).split(zf))})}else n&&(!r.hasFocus&&r.state.facet(Bs)||n.main.eq(i))&&(n=null);if(!t&&!n)return!1;if(!t&&e.typeOver&&!i.empty&&n&&n.main.empty?t={from:i.from,to:i.to,insert:r.state.doc.slice(i.from,i.to)}:(je.mac||je.android)&&t&&t.from==t.to&&t.from==i.head-1&&/^\. ?$/.test(t.insert.toString())&&r.contentDOM.getAttribute("autocorrect")=="off"?(n&&t.insert.length==2&&(n=xe.single(n.main.anchor-1,n.main.head-1)),t={from:t.from,to:t.to,insert:Nt.of([t.insert.toString().replace("."," ")])}):t&&t.from>=i.from&&t.to<=i.to&&(t.from!=i.from||t.to!=i.to)&&i.to-i.from-(t.to-t.from)<=4?t={from:i.from,to:i.to,insert:r.state.doc.slice(i.from,t.from).append(t.insert).append(r.state.doc.slice(t.to,i.to))}:je.chrome&&t&&t.from==t.to&&t.from==i.head&&t.insert.toString()==`
 `&&r.lineWrapping&&(n&&(n=xe.single(n.main.anchor-1,n.main.head-1)),t={from:i.from,to:i.to,insert:Nt.of([" "])}),t)return wx(r,t,n,s);if(n&&!n.main.eq(i)){let a=!1,o="select";return r.inputState.lastSelectionTime>Date.now()-50&&(r.inputState.lastSelectionOrigin=="select"&&(a=!0),o=r.inputState.lastSelectionOrigin),r.dispatch({selection:n,scrollIntoView:a,userEvent:o}),!0}else return!1}function wx(r,e,t,n=-1){if(je.ios&&r.inputState.flushIOSKey(e))return!0;let i=r.state.selection.main;if(je.android&&(e.to==i.to&&(e.from==i.from||e.from==i.from-1&&r.state.sliceDoc(e.from,i.from)==" ")&&e.insert.length==1&&e.insert.lines==2&&Al(r.contentDOM,"Enter",13)||(e.from==i.from-1&&e.to==i.to&&e.insert.length==0||n==8&&e.insert.length<e.to-e.from&&e.to>i.head)&&Al(r.contentDOM,"Backspace",8)||e.from==i.from&&e.to==i.to+1&&e.insert.length==0&&Al(r.contentDOM,"Delete",46)))return!0;let s=e.insert.toString();r.inputState.composing>=0&&r.inputState.composing++;let a,o=()=>a||(a=hq(r,e,t));return r.state.facet(TA).some(l=>l(r,e.from,e.to,s,o))||r.dispatch(o()),!0}function hq(r,e,t){let n,i=r.state,s=i.selection.main;if(e.from>=s.from&&e.to<=s.to&&e.to-e.from>=(s.to-s.from)/3&&(!t||t.main.empty&&t.main.from==e.from+e.insert.length)&&r.inputState.composing<0){let o=s.from<e.from?i.sliceDoc(s.from,e.from):"",l=s.to>e.to?i.sliceDoc(e.to,s.to):"";n=i.replaceSelection(r.state.toText(o+e.insert.sliceString(0,void 0,r.state.lineBreak)+l))}else{let o=i.changes(e),l=t&&t.main.to<=o.newLength?t.main:void 0;if(i.selection.ranges.length>1&&r.inputState.composing>=0&&e.to<=s.to&&e.to>=s.to-10){let f=r.state.sliceDoc(e.from,e.to),c,h=t&&DA(r,t.main.head);if(h){let p=e.insert.length-(e.to-e.from);c={from:h.from,to:h.to-p}}else c=r.state.doc.lineAt(s.head);let u=s.to-e.to,d=s.to-s.from;n=i.changeByRange(p=>{if(p.from==s.from&&p.to==s.to)return{changes:o,range:l||p.map(o)};let m=p.to-u,g=m-f.length;if(p.to-p.from!=d||r.state.sliceDoc(g,m)!=f||p.to>=c.from&&p.from<=c.to)return{range:p};let v=i.changes({from:g,to:m,insert:e.insert}),w=p.to-s.to;return{changes:v,range:l?xe.range(Math.max(0,l.anchor+w),Math.max(0,l.head+w)):p.map(v)}})}else n={changes:o,selection:l&&i.selection.replaceRange(l)}}let a="input.type";return(r.composing||r.inputState.compositionPendingChange&&r.inputState.compositionEndedAt>Date.now()-50)&&(r.inputState.compositionPendingChange=!1,a+=".compose",r.inputState.compositionFirstChange&&(a+=".start",r.inputState.compositionFirstChange=!1)),i.update(n,{userEvent:a,scrollIntoView:!0})}function uq(r,e,t,n){let i=Math.min(r.length,e.length),s=0;for(;s<i&&r.charCodeAt(s)==e.charCodeAt(s);)s++;if(s==i&&r.length==e.length)return null;let a=r.length,o=e.length;for(;a>0&&o>0&&r.charCodeAt(a-1)==e.charCodeAt(o-1);)a--,o--;if(n=="end"){let l=Math.max(0,s-Math.min(a,o));t-=a+l-s}if(a<s&&r.length<e.length){let l=t<=s&&t>=a?s-t:0;s-=l,o=s+(o-a),a=s}else if(o<s){let l=t<=s&&t>=o?s-t:0;s-=l,a=s+(a-o),o=s}return{from:s,toA:a,toB:o}}function dq(r){let e=[];if(r.root.activeElement!=r.contentDOM)return e;let{anchorNode:t,anchorOffset:n,focusNode:i,focusOffset:s}=r.observer.selectionRange;return t&&(e.push(new Vw(t,n)),(i!=t||s!=n)&&e.push(new Vw(i,s))),e}function pq(r,e){if(r.length==0)return null;let t=r[0].pos,n=r.length==2?r[1].pos:t;return t>-1&&n>-1?xe.single(t+e,n+e):null}class mq{setSelectionOrigin(e){this.lastSelectionOrigin=e,this.lastSelectionTime=Date.now()}constructor(e){this.view=e,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.tabFocusMode=-1,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=e.hasFocus,je.safari&&e.contentDOM.addEventListener("input",()=>null),je.gecko&&Rq(e.contentDOM.ownerDocument)}handleEvent(e){!_q(this.view,e)||this.ignoreDuringComposition(e)||e.type=="keydown"&&this.keydown(e)||this.runHandlers(e.type,e)}runHandlers(e,t){let n=this.handlers[e];if(n){for(let i of n.observers)i(this.view,t);for(let i of n.handlers){if(t.defaultPrevented)break;if(i(this.view,t)){t.preventDefault();break}}}}ensureHandlers(e){let t=gq(e),n=this.handlers,i=this.view.contentDOM;for(let s in t)if(s!="scroll"){let a=!t[s].handlers.length,o=n[s];o&&a!=!o.handlers.length&&(i.removeEventListener(s,this.handleEvent),o=null),o||i.addEventListener(s,this.handleEvent,{passive:a})}for(let s in n)s!="scroll"&&!t[s]&&i.removeEventListener(s,this.handleEvent);this.handlers=t}keydown(e){if(this.lastKeyCode=e.keyCode,this.lastKeyTime=Date.now(),e.keyCode==9&&this.tabFocusMode>-1&&(!this.tabFocusMode||Date.now()<=this.tabFocusMode))return!0;if(this.tabFocusMode>0&&e.keyCode!=27&&BA.indexOf(e.keyCode)<0&&(this.tabFocusMode=-1),je.android&&je.chrome&&!e.synthetic&&(e.keyCode==13||e.keyCode==8))return this.view.observer.delayAndroidKey(e.key,e.keyCode),!0;let t;return je.ios&&!e.synthetic&&!e.altKey&&!e.metaKey&&((t=LA.find(n=>n.keyCode==e.keyCode))&&!e.ctrlKey||Oq.indexOf(e.key)>-1&&e.ctrlKey&&!e.shiftKey)?(this.pendingIOSKey=t||e,setTimeout(()=>this.flushIOSKey(),250),!0):(e.keyCode!=229&&this.view.observer.forceFlush(),!1)}flushIOSKey(e){let t=this.pendingIOSKey;return!t||t.key=="Enter"&&e&&e.from<e.to&&/^\S+$/.test(e.insert.toString())?!1:(this.pendingIOSKey=void 0,Al(this.view.contentDOM,t.key,t.keyCode,t instanceof KeyboardEvent?t:void 0))}ignoreDuringComposition(e){return/^key/.test(e.type)?this.composing>0?!0:je.safari&&!je.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100?(this.compositionPendingKey=!1,!0):!1:!1}startMouseSelection(e){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=e}update(e){this.view.observer.update(e),this.mouseSelection&&this.mouseSelection.update(e),this.draggedContent&&e.docChanged&&(this.draggedContent=this.draggedContent.map(e.changes)),e.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}function qw(r,e){return(t,n)=>{try{return e.call(r,n,t)}catch(i){Jr(t.state,i)}}}function gq(r){let e=Object.create(null);function t(n){return e[n]||(e[n]={observers:[],handlers:[]})}for(let n of r){let i=n.spec;if(i&&i.domEventHandlers)for(let s in i.domEventHandlers){let a=i.domEventHandlers[s];a&&t(s).handlers.push(qw(n.value,a))}if(i&&i.domEventObservers)for(let s in i.domEventObservers){let a=i.domEventObservers[s];a&&t(s).observers.push(qw(n.value,a))}}for(let n in Ki)t(n).handlers.push(Ki[n]);for(let n in Pi)t(n).observers.push(Pi[n]);return e}const LA=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],Oq="dthko",BA=[16,17,18,20,91,92,224,225],au=6;function ou(r){return Math.max(0,r)*.7+8}function xq(r,e){return Math.max(Math.abs(r.clientX-e.clientX),Math.abs(r.clientY-e.clientY))}class vq{constructor(e,t,n,i){this.view=e,this.startEvent=t,this.style=n,this.mustSelect=i,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=t,this.scrollParents=AV(e.contentDOM),this.atoms=e.state.facet(vx).map(a=>a(e));let s=e.contentDOM.ownerDocument;s.addEventListener("mousemove",this.move=this.move.bind(this)),s.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=t.shiftKey,this.multiple=e.state.facet(lt.allowMultipleSelections)&&yq(e,t),this.dragging=bq(e,t)&&UA(t)==1?null:!1}start(e){this.dragging===!1&&this.select(e)}move(e){if(e.buttons==0)return this.destroy();if(this.dragging||this.dragging==null&&xq(this.startEvent,e)<10)return;this.select(this.lastEvent=e);let t=0,n=0,i=0,s=0,a=this.view.win.innerWidth,o=this.view.win.innerHeight;this.scrollParents.x&&({left:i,right:a}=this.scrollParents.x.getBoundingClientRect()),this.scrollParents.y&&({top:s,bottom:o}=this.scrollParents.y.getBoundingClientRect());let l=yx(this.view);e.clientX-l.left<=i+au?t=-ou(i-e.clientX):e.clientX+l.right>=a-au&&(t=ou(e.clientX-a)),e.clientY-l.top<=s+au?n=-ou(s-e.clientY):e.clientY+l.bottom>=o-au&&(n=ou(e.clientY-o)),this.setScrollSpeed(t,n)}up(e){this.dragging==null&&this.select(this.lastEvent),this.dragging||e.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let e=this.view.contentDOM.ownerDocument;e.removeEventListener("mousemove",this.move),e.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(e,t){this.scrollSpeed={x:e,y:t},e||t?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){let{x:e,y:t}=this.scrollSpeed;e&&this.scrollParents.x&&(this.scrollParents.x.scrollLeft+=e,e=0),t&&this.scrollParents.y&&(this.scrollParents.y.scrollTop+=t,t=0),(e||t)&&this.view.win.scrollBy(e,t),this.dragging===!1&&this.select(this.lastEvent)}skipAtoms(e){let t=null;for(let n=0;n<e.ranges.length;n++){let i=e.ranges[n],s=null;if(i.empty){let a=Vu(this.atoms,i.from,0);a!=i.from&&(s=xe.cursor(a,-1))}else{let a=Vu(this.atoms,i.from,-1),o=Vu(this.atoms,i.to,1);(a!=i.from||o!=i.to)&&(s=xe.range(i.from==i.anchor?a:o,i.from==i.head?a:o))}s&&(t||(t=e.ranges.slice()),t[n]=s)}return t?xe.create(t,e.mainIndex):e}select(e){let{view:t}=this,n=this.skipAtoms(this.style.get(e,this.extend,this.multiple));(this.mustSelect||!n.eq(t.state.selection,this.dragging===!1))&&this.view.dispatch({selection:n,userEvent:"select.pointer"}),this.mustSelect=!1}update(e){e.transactions.some(t=>t.isUserEvent("input.type"))?this.destroy():this.style.update(e)&&setTimeout(()=>this.select(this.lastEvent),20)}}function yq(r,e){let t=r.state.facet(bA);return t.length?t[0](e):je.mac?e.metaKey:e.ctrlKey}function wq(r,e){let t=r.state.facet(_A);return t.length?t[0](e):je.mac?!e.altKey:!e.ctrlKey}function bq(r,e){let{main:t}=r.state.selection;if(t.empty)return!1;let n=Xc(r.root);if(!n||n.rangeCount==0)return!0;let i=n.getRangeAt(0).getClientRects();for(let s=0;s<i.length;s++){let a=i[s];if(a.left<=e.clientX&&a.right>=e.clientX&&a.top<=e.clientY&&a.bottom>=e.clientY)return!0}return!1}function _q(r,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let t=e.target,n;t!=r.contentDOM;t=t.parentNode)if(!t||t.nodeType==11||(n=Yt.get(t))&&n.ignoreEvent(e))return!1;return!0}const Ki=Object.create(null),Pi=Object.create(null),ZA=je.ie&&je.ie_version<15||je.ios&&je.webkit_version<604;function kq(r){let e=r.dom.parentNode;if(!e)return;let t=e.appendChild(document.createElement("textarea"));t.style.cssText="position: fixed; left: -10000px; top: 10px",t.focus(),setTimeout(()=>{r.focus(),t.remove(),WA(r,t.value)},50)}function Z0(r,e,t){for(let n of r.facet(e))t=n(t,r);return t}function WA(r,e){e=Z0(r.state,gx,e);let{state:t}=r,n,i=1,s=t.toText(e),a=s.lines==t.selection.ranges.length;if(Dg!=null&&t.selection.ranges.every(l=>l.empty)&&Dg==s.toString()){let l=-1;n=t.changeByRange(f=>{let c=t.doc.lineAt(f.from);if(c.from==l)return{range:f};l=c.from;let h=t.toText((a?s.line(i++).text:e)+t.lineBreak);return{changes:{from:c.from,insert:h},range:xe.cursor(f.from+h.length)}})}else a?n=t.changeByRange(l=>{let f=s.line(i++);return{changes:{from:l.from,to:l.to,insert:f.text},range:xe.cursor(l.from+f.length)}}):n=t.replaceSelection(s);r.dispatch(n,{userEvent:"input.paste",scrollIntoView:!0})}Pi.scroll=r=>{r.inputState.lastScrollTop=r.scrollDOM.scrollTop,r.inputState.lastScrollLeft=r.scrollDOM.scrollLeft};Ki.keydown=(r,e)=>(r.inputState.setSelectionOrigin("select"),e.keyCode==27&&r.inputState.tabFocusMode!=0&&(r.inputState.tabFocusMode=Date.now()+2e3),!1);Pi.touchstart=(r,e)=>{r.inputState.lastTouchTime=Date.now(),r.inputState.setSelectionOrigin("select.pointer")};Pi.touchmove=r=>{r.inputState.setSelectionOrigin("select.pointer")};Ki.mousedown=(r,e)=>{if(r.observer.flush(),r.inputState.lastTouchTime>Date.now()-2e3)return!1;let t=null;for(let n of r.state.facet(kA))if(t=n(r,e),t)break;if(!t&&e.button==0&&(t=Cq(r,e)),t){let n=!r.hasFocus;r.inputState.startMouseSelection(new vq(r,e,t,n)),n&&r.observer.ignore(()=>{nA(r.contentDOM);let s=r.root.activeElement;s&&!s.contains(r.contentDOM)&&s.blur()});let i=r.inputState.mouseSelection;if(i)return i.start(e),i.dragging===!1}return!1};function jw(r,e,t,n){if(n==1)return xe.cursor(e,t);if(n==2)return eq(r.state,e,t);{let i=Mr.find(r.docView,e),s=r.state.doc.lineAt(i?i.posAtEnd:e),a=i?i.posAtStart:s.from,o=i?i.posAtEnd:s.to;return o<r.state.doc.length&&o==s.to&&o++,xe.range(a,o)}}let zw=(r,e,t)=>e>=t.top&&e<=t.bottom&&r>=t.left&&r<=t.right;function Sq(r,e,t,n){let i=Mr.find(r.docView,e);if(!i)return 1;let s=e-i.posAtStart;if(s==0)return 1;if(s==i.length)return-1;let a=i.coordsAt(s,-1);if(a&&zw(t,n,a))return-1;let o=i.coordsAt(s,1);return o&&zw(t,n,o)?1:a&&a.bottom>=n?-1:1}function Gw(r,e){let t=r.posAtCoords({x:e.clientX,y:e.clientY},!1);return{pos:t,bias:Sq(r,t,e.clientX,e.clientY)}}const Tq=je.ie&&je.ie_version<=11;let Hw=null,Yw=0,Kw=0;function UA(r){if(!Tq)return r.detail;let e=Hw,t=Kw;return Hw=r,Kw=Date.now(),Yw=!e||t>Date.now()-400&&Math.abs(e.clientX-r.clientX)<2&&Math.abs(e.clientY-r.clientY)<2?(Yw+1)%3:1}function Cq(r,e){let t=Gw(r,e),n=UA(e),i=r.state.selection;return{update(s){s.docChanged&&(t.pos=s.changes.mapPos(t.pos),i=i.map(s.changes))},get(s,a,o){let l=Gw(r,s),f,c=jw(r,l.pos,l.bias,n);if(t.pos!=l.pos&&!a){let h=jw(r,t.pos,t.bias,n),u=Math.min(h.from,c.from),d=Math.max(h.to,c.to);c=u<c.from?xe.range(u,d):xe.range(d,u)}return a?i.replaceRange(i.main.extend(c.from,c.to)):o&&n==1&&i.ranges.length>1&&(f=Aq(i,l.pos))?f:o?i.addRange(c):xe.create([c])}}}function Aq(r,e){for(let t=0;t<r.ranges.length;t++){let{from:n,to:i}=r.ranges[t];if(n<=e&&i>=e)return xe.create(r.ranges.slice(0,t).concat(r.ranges.slice(t+1)),r.mainIndex==t?0:r.mainIndex-(r.mainIndex>t?1:0))}return null}Ki.dragstart=(r,e)=>{let{selection:{main:t}}=r.state;if(e.target.draggable){let i=r.docView.nearest(e.target);if(i&&i.isWidget){let s=i.posAtStart,a=s+i.length;(s>=t.to||a<=t.from)&&(t=xe.range(s,a))}}let{inputState:n}=r;return n.mouseSelection&&(n.mouseSelection.dragging=!0),n.draggedContent=t,e.dataTransfer&&(e.dataTransfer.setData("Text",Z0(r.state,Ox,r.state.sliceDoc(t.from,t.to))),e.dataTransfer.effectAllowed="copyMove"),!1};Ki.dragend=r=>(r.inputState.draggedContent=null,!1);function Jw(r,e,t,n){if(t=Z0(r.state,gx,t),!t)return;let i=r.posAtCoords({x:e.clientX,y:e.clientY},!1),{draggedContent:s}=r.inputState,a=n&&s&&wq(r,e)?{from:s.from,to:s.to}:null,o={from:i,insert:t},l=r.state.changes(a?[a,o]:o);r.focus(),r.dispatch({changes:l,selection:{anchor:l.mapPos(i,-1),head:l.mapPos(i,1)},userEvent:a?"move.drop":"input.drop"}),r.inputState.draggedContent=null}Ki.drop=(r,e)=>{if(!e.dataTransfer)return!1;if(r.state.readOnly)return!0;let t=e.dataTransfer.files;if(t&&t.length){let n=Array(t.length),i=0,s=()=>{++i==t.length&&Jw(r,e,n.filter(a=>a!=null).join(r.state.lineBreak),!1)};for(let a=0;a<t.length;a++){let o=new FileReader;o.onerror=s,o.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(o.result)||(n[a]=o.result),s()},o.readAsText(t[a])}return!0}else{let n=e.dataTransfer.getData("Text");if(n)return Jw(r,e,n,!0),!0}return!1};Ki.paste=(r,e)=>{if(r.state.readOnly)return!0;r.observer.flush();let t=ZA?null:e.clipboardData;return t?(WA(r,t.getData("text/plain")||t.getData("text/uri-list")),!0):(kq(r),!1)};function Eq(r,e){let t=r.dom.parentNode;if(!t)return;let n=t.appendChild(document.createElement("textarea"));n.style.cssText="position: fixed; left: -10000px; top: 10px",n.value=e,n.focus(),n.selectionEnd=e.length,n.selectionStart=0,setTimeout(()=>{n.remove(),r.focus()},50)}function Pq(r){let e=[],t=[],n=!1;for(let i of r.selection.ranges)i.empty||(e.push(r.sliceDoc(i.from,i.to)),t.push(i));if(!e.length){let i=-1;for(let{from:s}of r.selection.ranges){let a=r.doc.lineAt(s);a.number>i&&(e.push(a.text),t.push({from:a.from,to:Math.min(r.doc.length,a.to+1)})),i=a.number}n=!0}return{text:Z0(r,Ox,e.join(r.lineBreak)),ranges:t,linewise:n}}let Dg=null;Ki.copy=Ki.cut=(r,e)=>{let{text:t,ranges:n,linewise:i}=Pq(r.state);if(!t&&!i)return!1;Dg=i?t:null,e.type=="cut"&&!r.state.readOnly&&r.dispatch({changes:n,scrollIntoView:!0,userEvent:"delete.cut"});let s=ZA?null:e.clipboardData;return s?(s.clearData(),s.setData("text/plain",t),!0):(Eq(r,t),!1)};const XA=Fs.define();function VA(r,e){let t=[];for(let n of r.facet(CA)){let i=n(r,e);i&&t.push(i)}return t?r.update({effects:t,annotations:XA.of(!0)}):null}function qA(r){setTimeout(()=>{let e=r.hasFocus;if(e!=r.inputState.notifiedFocused){let t=VA(r.state,e);t?r.dispatch(t):r.update([])}},10)}Pi.focus=r=>{r.inputState.lastFocusTime=Date.now(),!r.scrollDOM.scrollTop&&(r.inputState.lastScrollTop||r.inputState.lastScrollLeft)&&(r.scrollDOM.scrollTop=r.inputState.lastScrollTop,r.scrollDOM.scrollLeft=r.inputState.lastScrollLeft),qA(r)};Pi.blur=r=>{r.observer.clearSelectionRange(),qA(r)};Pi.compositionstart=Pi.compositionupdate=r=>{r.observer.editContext||(r.inputState.compositionFirstChange==null&&(r.inputState.compositionFirstChange=!0),r.inputState.composing<0&&(r.inputState.composing=0))};Pi.compositionend=r=>{r.observer.editContext||(r.inputState.composing=-1,r.inputState.compositionEndedAt=Date.now(),r.inputState.compositionPendingKey=!0,r.inputState.compositionPendingChange=r.observer.pendingRecords().length>0,r.inputState.compositionFirstChange=null,je.chrome&&je.android?r.observer.flushSoon():r.inputState.compositionPendingChange?Promise.resolve().then(()=>r.observer.flush()):setTimeout(()=>{r.inputState.composing<0&&r.docView.hasComposition&&r.update([])},50))};Pi.contextmenu=r=>{r.inputState.lastContextMenu=Date.now()};Ki.beforeinput=(r,e)=>{var t,n;if(e.inputType=="insertReplacementText"&&r.observer.editContext){let s=(t=e.dataTransfer)===null||t===void 0?void 0:t.getData("text/plain"),a=e.getTargetRanges();if(s&&a.length){let o=a[0],l=r.posAtDOM(o.startContainer,o.startOffset),f=r.posAtDOM(o.endContainer,o.endOffset);return wx(r,{from:l,to:f,insert:r.state.toText(s)},null),!0}}let i;if(je.chrome&&je.android&&(i=LA.find(s=>s.inputType==e.inputType))&&(r.observer.delayAndroidKey(i.key,i.keyCode),i.key=="Backspace"||i.key=="Delete")){let s=((n=window.visualViewport)===null||n===void 0?void 0:n.height)||0;setTimeout(()=>{var a;(((a=window.visualViewport)===null||a===void 0?void 0:a.height)||0)>s+10&&r.hasFocus&&(r.contentDOM.blur(),r.focus())},100)}return je.ios&&e.inputType=="deleteContentForward"&&r.observer.flushSoon(),je.safari&&e.inputType=="insertText"&&r.inputState.composing>=0&&setTimeout(()=>Pi.compositionend(r,e),20),!1};const eb=new Set;function Rq(r){eb.has(r)||(eb.add(r),r.addEventListener("copy",()=>{}),r.addEventListener("cut",()=>{}))}const tb=["pre-wrap","normal","pre-line","break-spaces"];let Xl=!1;function rb(){Xl=!1}class Qq{constructor(e){this.lineWrapping=e,this.doc=Nt.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30}heightForGap(e,t){let n=this.doc.lineAt(t).number-this.doc.lineAt(e).number+1;return this.lineWrapping&&(n+=Math.max(0,Math.ceil((t-e-n*this.lineLength*.5)/this.lineLength))),this.lineHeight*n}heightForLine(e){return this.lineWrapping?(1+Math.max(0,Math.ceil((e-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(e){return this.doc=e,this}mustRefreshForWrapping(e){return tb.indexOf(e)>-1!=this.lineWrapping}mustRefreshForHeights(e){let t=!1;for(let n=0;n<e.length;n++){let i=e[n];i<0?n++:this.heightSamples[Math.floor(i*10)]||(t=!0,this.heightSamples[Math.floor(i*10)]=!0)}return t}refresh(e,t,n,i,s,a){let o=tb.indexOf(e)>-1,l=Math.round(t)!=Math.round(this.lineHeight)||this.lineWrapping!=o;if(this.lineWrapping=o,this.lineHeight=t,this.charWidth=n,this.textHeight=i,this.lineLength=s,l){this.heightSamples={};for(let f=0;f<a.length;f++){let c=a[f];c<0?f++:this.heightSamples[Math.floor(c*10)]=!0}}return l}}class Fq{constructor(e,t){this.from=e,this.heights=t,this.index=0}get more(){return this.index<this.heights.length}}class ps{constructor(e,t,n,i,s){this.from=e,this.length=t,this.top=n,this.height=i,this._content=s}get type(){return typeof this._content=="number"?$n.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof Ia?this._content.widget:null}get widgetLineBreaks(){return typeof this._content=="number"?this._content:0}join(e){let t=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(e._content)?e._content:[e]);return new ps(this.from,this.length+e.length,this.top,this.height+e.height,t)}}var lr=function(r){return r[r.ByPos=0]="ByPos",r[r.ByHeight=1]="ByHeight",r[r.ByPosNoHeight=2]="ByPosNoHeight",r}(lr||(lr={}));const qu=.001;class Nn{constructor(e,t,n=2){this.length=e,this.height=t,this.flags=n}get outdated(){return(this.flags&2)>0}set outdated(e){this.flags=(e?2:0)|this.flags&-3}setHeight(e){this.height!=e&&(Math.abs(this.height-e)>qu&&(Xl=!0),this.height=e)}replace(e,t,n){return Nn.of(n)}decomposeLeft(e,t){t.push(this)}decomposeRight(e,t){t.push(this)}applyChanges(e,t,n,i){let s=this,a=n.doc;for(let o=i.length-1;o>=0;o--){let{fromA:l,toA:f,fromB:c,toB:h}=i[o],u=s.lineAt(l,lr.ByPosNoHeight,n.setDoc(t),0,0),d=u.to>=f?u:s.lineAt(f,lr.ByPosNoHeight,n,0,0);for(h+=d.to-f,f=d.to;o>0&&u.from<=i[o-1].toA;)l=i[o-1].fromA,c=i[o-1].fromB,o--,l<u.from&&(u=s.lineAt(l,lr.ByPosNoHeight,n,0,0));c+=u.from-l,l=u.from;let p=bx.build(n.setDoc(a),e,c,h);s=Xd(s,s.replace(l,f,p))}return s.updateHeight(n,0)}static empty(){return new Kn(0,0)}static of(e){if(e.length==1)return e[0];let t=0,n=e.length,i=0,s=0;for(;;)if(t==n)if(i>s*2){let o=e[t-1];o.break?e.splice(--t,1,o.left,null,o.right):e.splice(--t,1,o.left,o.right),n+=1+o.break,i-=o.size}else if(s>i*2){let o=e[n];o.break?e.splice(n,1,o.left,null,o.right):e.splice(n,1,o.left,o.right),n+=2+o.break,s-=o.size}else break;else if(i<s){let o=e[t++];o&&(i+=o.size)}else{let o=e[--n];o&&(s+=o.size)}let a=0;return e[t-1]==null?(a=1,t--):e[t]==null&&(a=1,n++),new $q(Nn.of(e.slice(0,t)),a,Nn.of(e.slice(n)))}}function Xd(r,e){return r==e?r:(r.constructor!=e.constructor&&(Xl=!0),e)}Nn.prototype.size=1;class jA extends Nn{constructor(e,t,n){super(e,t),this.deco=n}blockAt(e,t,n,i){return new ps(i,this.length,n,this.height,this.deco||0)}lineAt(e,t,n,i,s){return this.blockAt(0,n,i,s)}forEachLine(e,t,n,i,s,a){e<=s+this.length&&t>=s&&a(this.blockAt(0,n,i,s))}updateHeight(e,t=0,n=!1,i){return i&&i.from<=t&&i.more&&this.setHeight(i.heights[i.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class Kn extends jA{constructor(e,t){super(e,t,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0}blockAt(e,t,n,i){return new ps(i,this.length,n,this.height,this.breaks)}replace(e,t,n){let i=n[0];return n.length==1&&(i instanceof Kn||i instanceof tn&&i.flags&4)&&Math.abs(this.length-i.length)<10?(i instanceof tn?i=new Kn(i.length,this.height):i.height=this.height,this.outdated||(i.outdated=!1),i):Nn.of(n)}updateHeight(e,t=0,n=!1,i){return i&&i.from<=t&&i.more?this.setHeight(i.heights[i.index++]):(n||this.outdated)&&this.setHeight(Math.max(this.widgetHeight,e.heightForLine(this.length-this.collapsed))+this.breaks*e.lineHeight),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class tn extends Nn{constructor(e){super(e,0)}heightMetrics(e,t){let n=e.doc.lineAt(t).number,i=e.doc.lineAt(t+this.length).number,s=i-n+1,a,o=0;if(e.lineWrapping){let l=Math.min(this.height,e.lineHeight*s);a=l/s,this.length>s+1&&(o=(this.height-l)/(this.length-s-1))}else a=this.height/s;return{firstLine:n,lastLine:i,perLine:a,perChar:o}}blockAt(e,t,n,i){let{firstLine:s,lastLine:a,perLine:o,perChar:l}=this.heightMetrics(t,i);if(t.lineWrapping){let f=i+(e<t.lineHeight?0:Math.round(Math.max(0,Math.min(1,(e-n)/this.height))*this.length)),c=t.doc.lineAt(f),h=o+c.length*l,u=Math.max(n,e-h/2);return new ps(c.from,c.length,u,h,0)}else{let f=Math.max(0,Math.min(a-s,Math.floor((e-n)/o))),{from:c,length:h}=t.doc.line(s+f);return new ps(c,h,n+o*f,o,0)}}lineAt(e,t,n,i,s){if(t==lr.ByHeight)return this.blockAt(e,n,i,s);if(t==lr.ByPosNoHeight){let{from:d,to:p}=n.doc.lineAt(e);return new ps(d,p-d,0,0,0)}let{firstLine:a,perLine:o,perChar:l}=this.heightMetrics(n,s),f=n.doc.lineAt(e),c=o+f.length*l,h=f.number-a,u=i+o*h+l*(f.from-s-h);return new ps(f.from,f.length,Math.max(i,Math.min(u,i+this.height-c)),c,0)}forEachLine(e,t,n,i,s,a){e=Math.max(e,s),t=Math.min(t,s+this.length);let{firstLine:o,perLine:l,perChar:f}=this.heightMetrics(n,s);for(let c=e,h=i;c<=t;){let u=n.doc.lineAt(c);if(c==e){let p=u.number-o;h+=l*p+f*(e-s-p)}let d=l+f*u.length;a(new ps(u.from,u.length,h,d,0)),h+=d,c=u.to+1}}replace(e,t,n){let i=this.length-t;if(i>0){let s=n[n.length-1];s instanceof tn?n[n.length-1]=new tn(s.length+i):n.push(null,new tn(i-1))}if(e>0){let s=n[0];s instanceof tn?n[0]=new tn(e+s.length):n.unshift(new tn(e-1),null)}return Nn.of(n)}decomposeLeft(e,t){t.push(new tn(e-1),null)}decomposeRight(e,t){t.push(null,new tn(this.length-e-1))}updateHeight(e,t=0,n=!1,i){let s=t+this.length;if(i&&i.from<=t+this.length&&i.more){let a=[],o=Math.max(t,i.from),l=-1;for(i.from>t&&a.push(new tn(i.from-t-1).updateHeight(e,t));o<=s&&i.more;){let c=e.doc.lineAt(o).length;a.length&&a.push(null);let h=i.heights[i.index++];l==-1?l=h:Math.abs(h-l)>=qu&&(l=-2);let u=new Kn(c,h);u.outdated=!1,a.push(u),o+=c+1}o<=s&&a.push(null,new tn(s-o).updateHeight(e,o));let f=Nn.of(a);return(l<0||Math.abs(f.height-this.height)>=qu||Math.abs(l-this.heightMetrics(e,t).perLine)>=qu)&&(Xl=!0),Xd(this,f)}else(n||this.outdated)&&(this.setHeight(e.heightForGap(t,t+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}}class $q extends Nn{constructor(e,t,n){super(e.length+t+n.length,e.height+n.height,t|(e.outdated||n.outdated?2:0)),this.left=e,this.right=n,this.size=e.size+n.size}get break(){return this.flags&1}blockAt(e,t,n,i){let s=n+this.left.height;return e<s?this.left.blockAt(e,t,n,i):this.right.blockAt(e,t,s,i+this.left.length+this.break)}lineAt(e,t,n,i,s){let a=i+this.left.height,o=s+this.left.length+this.break,l=t==lr.ByHeight?e<a:e<o,f=l?this.left.lineAt(e,t,n,i,s):this.right.lineAt(e,t,n,a,o);if(this.break||(l?f.to<o:f.from>o))return f;let c=t==lr.ByPosNoHeight?lr.ByPosNoHeight:lr.ByPos;return l?f.join(this.right.lineAt(o,c,n,a,o)):this.left.lineAt(o,c,n,i,s).join(f)}forEachLine(e,t,n,i,s,a){let o=i+this.left.height,l=s+this.left.length+this.break;if(this.break)e<l&&this.left.forEachLine(e,t,n,i,s,a),t>=l&&this.right.forEachLine(e,t,n,o,l,a);else{let f=this.lineAt(l,lr.ByPos,n,i,s);e<f.from&&this.left.forEachLine(e,f.from-1,n,i,s,a),f.to>=e&&f.from<=t&&a(f),t>f.to&&this.right.forEachLine(f.to+1,t,n,o,l,a)}}replace(e,t,n){let i=this.left.length+this.break;if(t<i)return this.balanced(this.left.replace(e,t,n),this.right);if(e>this.left.length)return this.balanced(this.left,this.right.replace(e-i,t-i,n));let s=[];e>0&&this.decomposeLeft(e,s);let a=s.length;for(let o of n)s.push(o);if(e>0&&nb(s,a-1),t<this.length){let o=s.length;this.decomposeRight(t,s),nb(s,o)}return Nn.of(s)}decomposeLeft(e,t){let n=this.left.length;if(e<=n)return this.left.decomposeLeft(e,t);t.push(this.left),this.break&&(n++,e>=n&&t.push(null)),e>n&&this.right.decomposeLeft(e-n,t)}decomposeRight(e,t){let n=this.left.length,i=n+this.break;if(e>=i)return this.right.decomposeRight(e-i,t);e<n&&this.left.decomposeRight(e,t),this.break&&e<i&&t.push(null),t.push(this.right)}balanced(e,t){return e.size>2*t.size||t.size>2*e.size?Nn.of(this.break?[e,null,t]:[e,t]):(this.left=Xd(this.left,e),this.right=Xd(this.right,t),this.setHeight(e.height+t.height),this.outdated=e.outdated||t.outdated,this.size=e.size+t.size,this.length=e.length+this.break+t.length,this)}updateHeight(e,t=0,n=!1,i){let{left:s,right:a}=this,o=t+s.length+this.break,l=null;return i&&i.from<=t+s.length&&i.more?l=s=s.updateHeight(e,t,n,i):s.updateHeight(e,t,n),i&&i.from<=o+a.length&&i.more?l=a=a.updateHeight(e,o,n,i):a.updateHeight(e,o,n),l?this.balanced(s,a):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function nb(r,e){let t,n;r[e]==null&&(t=r[e-1])instanceof tn&&(n=r[e+1])instanceof tn&&r.splice(e-1,3,new tn(t.length+1+n.length))}const Nq=5;class bx{constructor(e,t){this.pos=e,this.oracle=t,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=e}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(e,t){if(this.lineStart>-1){let n=Math.min(t,this.lineEnd),i=this.nodes[this.nodes.length-1];i instanceof Kn?i.length+=n-this.pos:(n>this.pos||!this.isCovered)&&this.nodes.push(new Kn(n-this.pos,-1)),this.writtenTo=n,t>n&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=t}point(e,t,n){if(e<t||n.heightRelevant){let i=n.widget?n.widget.estimatedHeight:0,s=n.widget?n.widget.lineBreaks:0;i<0&&(i=this.oracle.lineHeight);let a=t-e;n.block?this.addBlock(new jA(a,i,n)):(a||s||i>=Nq)&&this.addLineDeco(i,s,a)}else t>e&&this.span(e,t);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:e,to:t}=this.oracle.doc.lineAt(this.pos);this.lineStart=e,this.lineEnd=t,this.writtenTo<e&&((this.writtenTo<e-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,e-1)),this.nodes.push(null)),this.pos>e&&this.nodes.push(new Kn(this.pos-e,-1)),this.writtenTo=this.pos}blankContent(e,t){let n=new tn(t-e);return this.oracle.doc.lineAt(e).to==t&&(n.flags|=4),n}ensureLine(){this.enterLine();let e=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(e instanceof Kn)return e;let t=new Kn(0,-1);return this.nodes.push(t),t}addBlock(e){this.enterLine();let t=e.deco;t&&t.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(e),this.writtenTo=this.pos=this.pos+e.length,t&&t.endSide>0&&(this.covering=e)}addLineDeco(e,t,n){let i=this.ensureLine();i.length+=n,i.collapsed+=n,i.widgetHeight=Math.max(i.widgetHeight,e),i.breaks+=t,this.writtenTo=this.pos=this.pos+n}finish(e){let t=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(t instanceof Kn)&&!this.isCovered?this.nodes.push(new Kn(0,-1)):(this.writtenTo<this.pos||t==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let n=e;for(let i of this.nodes)i instanceof Kn&&i.updateHeight(this.oracle,n),n+=i?i.length:1;return this.nodes}static build(e,t,n,i){let s=new bx(n,e);return At.spans(t,n,i,s,0),s.finish(n)}}function Dq(r,e,t){let n=new Mq;return At.compare(r,e,t,n,0),n.changes}class Mq{constructor(){this.changes=[]}compareRange(){}comparePoint(e,t,n,i){(e<t||n&&n.heightRelevant||i&&i.heightRelevant)&&Xu(e,t,this.changes,5)}}function Iq(r,e){let t=r.getBoundingClientRect(),n=r.ownerDocument,i=n.defaultView||window,s=Math.max(0,t.left),a=Math.min(i.innerWidth,t.right),o=Math.max(0,t.top),l=Math.min(i.innerHeight,t.bottom);for(let f=r.parentNode;f&&f!=n.body;)if(f.nodeType==1){let c=f,h=window.getComputedStyle(c);if((c.scrollHeight>c.clientHeight||c.scrollWidth>c.clientWidth)&&h.overflow!="visible"){let u=c.getBoundingClientRect();s=Math.max(s,u.left),a=Math.min(a,u.right),o=Math.max(o,u.top),l=Math.min(f==r.parentNode?i.innerHeight:l,u.bottom)}f=h.position=="absolute"||h.position=="fixed"?c.offsetParent:c.parentNode}else if(f.nodeType==11)f=f.host;else break;return{left:s-t.left,right:Math.max(s,a)-t.left,top:o-(t.top+e),bottom:Math.max(o,l)-(t.top+e)}}function Lq(r){let e=r.getBoundingClientRect(),t=r.ownerDocument.defaultView||window;return e.left<t.innerWidth&&e.right>0&&e.top<t.innerHeight&&e.bottom>0}function Bq(r,e){let t=r.getBoundingClientRect();return{left:0,right:t.right-t.left,top:e,bottom:t.bottom-(t.top+e)}}class $p{constructor(e,t,n,i){this.from=e,this.to=t,this.size=n,this.displaySize=i}static same(e,t){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++){let i=e[n],s=t[n];if(i.from!=s.from||i.to!=s.to||i.size!=s.size)return!1}return!0}draw(e,t){return ze.replace({widget:new Zq(this.displaySize*(t?e.scaleY:e.scaleX),t)}).range(this.from,this.to)}}class Zq extends ia{constructor(e,t){super(),this.size=e,this.vertical=t}eq(e){return e.size==this.size&&e.vertical==this.vertical}toDOM(){let e=document.createElement("div");return this.vertical?e.style.height=this.size+"px":(e.style.width=this.size+"px",e.style.height="2px",e.style.display="inline-block"),e}get estimatedHeight(){return this.vertical?this.size:-1}}class ib{constructor(e){this.state=e,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!1,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=sb,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=Rt.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let t=e.facet(xx).some(n=>typeof n!="function"&&n.class=="cm-lineWrapping");this.heightOracle=new Qq(t),this.stateDeco=e.facet(qc).filter(n=>typeof n!="function"),this.heightMap=Nn.empty().applyChanges(this.stateDeco,Nt.empty,this.heightOracle.setDoc(e.doc),[new Ai(0,0,0,e.doc.length)]);for(let n=0;n<2&&(this.viewport=this.getViewport(0,null),!!this.updateForViewport());n++);this.updateViewportLines(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=ze.set(this.lineGaps.map(n=>n.draw(this,!1))),this.computeVisibleRanges()}updateForViewport(){let e=[this.viewport],{main:t}=this.state.selection;for(let n=0;n<=1;n++){let i=n?t.head:t.anchor;if(!e.some(({from:s,to:a})=>i>=s&&i<=a)){let{from:s,to:a}=this.lineBlockAt(i);e.push(new lu(s,a))}}return this.viewports=e.sort((n,i)=>n.from-i.from),this.updateScaler()}updateScaler(){let e=this.scaler;return this.scaler=this.heightMap.height<=7e6?sb:new _x(this.heightOracle,this.heightMap,this.viewports),e.eq(this.scaler)?0:2}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,e=>{this.viewportLines.push(Gf(e,this.scaler))})}update(e,t=null){this.state=e.state;let n=this.stateDeco;this.stateDeco=this.state.facet(qc).filter(c=>typeof c!="function");let i=e.changedRanges,s=Ai.extendWithRanges(i,Dq(n,this.stateDeco,e?e.changes:Ur.empty(this.state.doc.length))),a=this.heightMap.height,o=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);rb(),this.heightMap=this.heightMap.applyChanges(this.stateDeco,e.startState.doc,this.heightOracle.setDoc(this.state.doc),s),(this.heightMap.height!=a||Xl)&&(e.flags|=2),o?(this.scrollAnchorPos=e.changes.mapPos(o.from,-1),this.scrollAnchorHeight=o.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=this.heightMap.height);let l=s.length?this.mapViewport(this.viewport,e.changes):this.viewport;(t&&(t.range.head<l.from||t.range.head>l.to)||!this.viewportIsAppropriate(l))&&(l=this.getViewport(0,t));let f=l.from!=this.viewport.from||l.to!=this.viewport.to;this.viewport=l,e.flags|=this.updateForViewport(),(f||!e.changes.empty||e.flags&2)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,e.changes))),e.flags|=this.computeVisibleRanges(e.changes),t&&(this.scrollTarget=t),!this.mustEnforceCursorAssoc&&e.selectionSet&&e.view.lineWrapping&&e.state.selection.main.empty&&e.state.selection.main.assoc&&!e.state.facet(EA)&&(this.mustEnforceCursorAssoc=!0)}measure(e){let t=e.contentDOM,n=window.getComputedStyle(t),i=this.heightOracle,s=n.whiteSpace;this.defaultTextDirection=n.direction=="rtl"?Rt.RTL:Rt.LTR;let a=this.heightOracle.mustRefreshForWrapping(s),o=t.getBoundingClientRect(),l=a||this.mustMeasureContent||this.contentDOMHeight!=o.height;this.contentDOMHeight=o.height,this.mustMeasureContent=!1;let f=0,c=0;if(o.width&&o.height){let{scaleX:S,scaleY:y}=rA(t,o);(S>.005&&Math.abs(this.scaleX-S)>.005||y>.005&&Math.abs(this.scaleY-y)>.005)&&(this.scaleX=S,this.scaleY=y,f|=16,a=l=!0)}let h=(parseInt(n.paddingTop)||0)*this.scaleY,u=(parseInt(n.paddingBottom)||0)*this.scaleY;(this.paddingTop!=h||this.paddingBottom!=u)&&(this.paddingTop=h,this.paddingBottom=u,f|=18),this.editorWidth!=e.scrollDOM.clientWidth&&(i.lineWrapping&&(l=!0),this.editorWidth=e.scrollDOM.clientWidth,f|=16);let d=e.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=d&&(this.scrollAnchorHeight=-1,this.scrollTop=d),this.scrolledToBottom=sA(e.scrollDOM);let p=(this.printing?Bq:Iq)(t,this.paddingTop),m=p.top-this.pixelViewport.top,g=p.bottom-this.pixelViewport.bottom;this.pixelViewport=p;let v=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(v!=this.inView&&(this.inView=v,v&&(l=!0)),!this.inView&&!this.scrollTarget&&!Lq(e.dom))return 0;let w=o.width;if((this.contentDOMWidth!=w||this.editorHeight!=e.scrollDOM.clientHeight)&&(this.contentDOMWidth=o.width,this.editorHeight=e.scrollDOM.clientHeight,f|=16),l){let S=e.docView.measureVisibleLineHeights(this.viewport);if(i.mustRefreshForHeights(S)&&(a=!0),a||i.lineWrapping&&Math.abs(w-this.contentDOMWidth)>i.charWidth){let{lineHeight:y,charWidth:b,textHeight:O}=e.docView.measureTextSize();a=y>0&&i.refresh(s,y,b,O,w/b,S),a&&(e.docView.minWidth=0,f|=16)}m>0&&g>0?c=Math.max(m,g):m<0&&g<0&&(c=Math.min(m,g)),rb();for(let y of this.viewports){let b=y.from==this.viewport.from?S:e.docView.measureVisibleLineHeights(y);this.heightMap=(a?Nn.empty().applyChanges(this.stateDeco,Nt.empty,this.heightOracle,[new Ai(0,0,0,e.state.doc.length)]):this.heightMap).updateHeight(i,0,a,new Fq(y.from,b))}Xl&&(f|=2)}let x=!this.viewportIsAppropriate(this.viewport,c)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return x&&(f&2&&(f|=this.updateScaler()),this.viewport=this.getViewport(c,this.scrollTarget),f|=this.updateForViewport()),(f&2||x)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(a?[]:this.lineGaps,e)),f|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,e.docView.enforceCursorAssoc()),f}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(e,t){let n=.5-Math.max(-.5,Math.min(.5,e/1e3/2)),i=this.heightMap,s=this.heightOracle,{visibleTop:a,visibleBottom:o}=this,l=new lu(i.lineAt(a-n*1e3,lr.ByHeight,s,0,0).from,i.lineAt(o+(1-n)*1e3,lr.ByHeight,s,0,0).to);if(t){let{head:f}=t.range;if(f<l.from||f>l.to){let c=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),h=i.lineAt(f,lr.ByPos,s,0,0),u;t.y=="center"?u=(h.top+h.bottom)/2-c/2:t.y=="start"||t.y=="nearest"&&f<l.from?u=h.top:u=h.bottom-c,l=new lu(i.lineAt(u-1e3/2,lr.ByHeight,s,0,0).from,i.lineAt(u+c+1e3/2,lr.ByHeight,s,0,0).to)}}return l}mapViewport(e,t){let n=t.mapPos(e.from,-1),i=t.mapPos(e.to,1);return new lu(this.heightMap.lineAt(n,lr.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(i,lr.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:e,to:t},n=0){if(!this.inView)return!0;let{top:i}=this.heightMap.lineAt(e,lr.ByPos,this.heightOracle,0,0),{bottom:s}=this.heightMap.lineAt(t,lr.ByPos,this.heightOracle,0,0),{visibleTop:a,visibleBottom:o}=this;return(e==0||i<=a-Math.max(10,Math.min(-n,250)))&&(t==this.state.doc.length||s>=o+Math.max(10,Math.min(n,250)))&&i>a-2*1e3&&s<o+2*1e3}mapLineGaps(e,t){if(!e.length||t.empty)return e;let n=[];for(let i of e)t.touchesRange(i.from,i.to)||n.push(new $p(t.mapPos(i.from),t.mapPos(i.to),i.size,i.displaySize));return n}ensureLineGaps(e,t){let n=this.heightOracle.lineWrapping,i=n?1e4:2e3,s=i>>1,a=i<<1;if(this.defaultTextDirection!=Rt.LTR&&!n)return[];let o=[],l=(c,h,u,d)=>{if(h-c<s)return;let p=this.state.selection.main,m=[p.from];p.empty||m.push(p.to);for(let v of m)if(v>c&&v<h){l(c,v-10,u,d),l(v+10,h,u,d);return}let g=Uq(e,v=>v.from>=u.from&&v.to<=u.to&&Math.abs(v.from-c)<s&&Math.abs(v.to-h)<s&&!m.some(w=>v.from<w&&v.to>w));if(!g){if(h<u.to&&t&&n&&t.visibleRanges.some(x=>x.from<=h&&x.to>=h)){let x=t.moveToLineBoundary(xe.cursor(h),!1,!0).head;x>c&&(h=x)}let v=this.gapSize(u,c,h,d),w=n||v<2e6?v:2e6;g=new $p(c,h,v,w)}o.push(g)},f=c=>{if(c.length<a||c.type!=$n.Text)return;let h=Wq(c.from,c.to,this.stateDeco);if(h.total<a)return;let u=this.scrollTarget?this.scrollTarget.range.head:null,d,p;if(n){let m=i/this.heightOracle.lineLength*this.heightOracle.lineHeight,g,v;if(u!=null){let w=cu(h,u),x=((this.visibleBottom-this.visibleTop)/2+m)/c.height;g=w-x,v=w+x}else g=(this.visibleTop-c.top-m)/c.height,v=(this.visibleBottom-c.top+m)/c.height;d=fu(h,g),p=fu(h,v)}else{let m=h.total*this.heightOracle.charWidth,g=i*this.heightOracle.charWidth,v=0;if(m>2e6)for(let b of e)b.from>=c.from&&b.from<c.to&&b.size!=b.displaySize&&b.from*this.heightOracle.charWidth+v<this.pixelViewport.left&&(v=b.size-b.displaySize);let w=this.pixelViewport.left+v,x=this.pixelViewport.right+v,S,y;if(u!=null){let b=cu(h,u),O=((x-w)/2+g)/m;S=b-O,y=b+O}else S=(w-g)/m,y=(x+g)/m;d=fu(h,S),p=fu(h,y)}d>c.from&&l(c.from,d,c,h),p<c.to&&l(p,c.to,c,h)};for(let c of this.viewportLines)Array.isArray(c.type)?c.type.forEach(f):f(c);return o}gapSize(e,t,n,i){let s=cu(i,n)-cu(i,t);return this.heightOracle.lineWrapping?e.height*s:i.total*this.heightOracle.charWidth*s}updateLineGaps(e){$p.same(e,this.lineGaps)||(this.lineGaps=e,this.lineGapDeco=ze.set(e.map(t=>t.draw(this,this.heightOracle.lineWrapping))))}computeVisibleRanges(e){let t=this.stateDeco;this.lineGaps.length&&(t=t.concat(this.lineGapDeco));let n=[];At.spans(t,this.viewport.from,this.viewport.to,{span(s,a){n.push({from:s,to:a})},point(){}},20);let i=0;if(n.length!=this.visibleRanges.length)i=12;else for(let s=0;s<n.length&&!(i&8);s++){let a=this.visibleRanges[s],o=n[s];(a.from!=o.from||a.to!=o.to)&&(i|=4,e&&e.mapPos(a.from,-1)==o.from&&e.mapPos(a.to,1)==o.to||(i|=8))}return this.visibleRanges=n,i}lineBlockAt(e){return e>=this.viewport.from&&e<=this.viewport.to&&this.viewportLines.find(t=>t.from<=e&&t.to>=e)||Gf(this.heightMap.lineAt(e,lr.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(e){return e>=this.viewportLines[0].top&&e<=this.viewportLines[this.viewportLines.length-1].bottom&&this.viewportLines.find(t=>t.top<=e&&t.bottom>=e)||Gf(this.heightMap.lineAt(this.scaler.fromDOM(e),lr.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(e){let t=this.lineBlockAtHeight(e+8);return t.from>=this.viewport.from||this.viewportLines[0].top-e>200?t:this.viewportLines[0]}elementAtHeight(e){return Gf(this.heightMap.blockAt(this.scaler.fromDOM(e),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class lu{constructor(e,t){this.from=e,this.to=t}}function Wq(r,e,t){let n=[],i=r,s=0;return At.spans(t,r,e,{span(){},point(a,o){a>i&&(n.push({from:i,to:a}),s+=a-i),i=o}},20),i<e&&(n.push({from:i,to:e}),s+=e-i),{total:s,ranges:n}}function fu({total:r,ranges:e},t){if(t<=0)return e[0].from;if(t>=1)return e[e.length-1].to;let n=Math.floor(r*t);for(let i=0;;i++){let{from:s,to:a}=e[i],o=a-s;if(n<=o)return s+n;n-=o}}function cu(r,e){let t=0;for(let{from:n,to:i}of r.ranges){if(e<=i){t+=e-n;break}t+=i-n}return t/r.total}function Uq(r,e){for(let t of r)if(e(t))return t}const sb={toDOM(r){return r},fromDOM(r){return r},scale:1,eq(r){return r==this}};class _x{constructor(e,t,n){let i=0,s=0,a=0;this.viewports=n.map(({from:o,to:l})=>{let f=t.lineAt(o,lr.ByPos,e,0,0).top,c=t.lineAt(l,lr.ByPos,e,0,0).bottom;return i+=c-f,{from:o,to:l,top:f,bottom:c,domTop:0,domBottom:0}}),this.scale=(7e6-i)/(t.height-i);for(let o of this.viewports)o.domTop=a+(o.top-s)*this.scale,a=o.domBottom=o.domTop+(o.bottom-o.top),s=o.bottom}toDOM(e){for(let t=0,n=0,i=0;;t++){let s=t<this.viewports.length?this.viewports[t]:null;if(!s||e<s.top)return i+(e-n)*this.scale;if(e<=s.bottom)return s.domTop+(e-s.top);n=s.bottom,i=s.domBottom}}fromDOM(e){for(let t=0,n=0,i=0;;t++){let s=t<this.viewports.length?this.viewports[t]:null;if(!s||e<s.domTop)return n+(e-i)/this.scale;if(e<=s.domBottom)return s.top+(e-s.domTop);n=s.bottom,i=s.domBottom}}eq(e){return e instanceof _x?this.scale==e.scale&&this.viewports.length==e.viewports.length&&this.viewports.every((t,n)=>t.from==e.viewports[n].from&&t.to==e.viewports[n].to):!1}}function Gf(r,e){if(e.scale==1)return r;let t=e.toDOM(r.top),n=e.toDOM(r.bottom);return new ps(r.from,r.length,t,n-t,Array.isArray(r._content)?r._content.map(i=>Gf(i,e)):r._content)}const hu=Le.define({combine:r=>r.join(" ")}),Mg=Le.define({combine:r=>r.indexOf(!0)>-1}),Ig=Tn.newName(),zA=Tn.newName(),GA=Tn.newName(),HA={"&light":"."+zA,"&dark":"."+GA};function Lg(r,e,t){return new Tn(e,{finish(n){return/&/.test(n)?n.replace(/&\w*/,i=>{if(i=="&")return r;if(!t||!t[i])throw new RangeError(`Unsupported selector: ${i}`);return t[i]}):r+" "+n}})}const Xq=Lg("."+Ig,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0,overflowAnchor:"none"},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#ddd"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",insetInlineStart:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0,zIndex:300},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top"},".cm-highlightSpace":{backgroundImage:"radial-gradient(circle at 50% 55%, #aaa 20%, transparent 5%)",backgroundPosition:"center"},".cm-highlightTab":{backgroundImage:`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>')`,backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},HA),Vq={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},Np=je.ie&&je.ie_version<=11;class qq{constructor(e){this.view=e,this.active=!1,this.editContext=null,this.selectionRange=new EV,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.printQuery=null,this.parentCheck=-1,this.dom=e.contentDOM,this.observer=new MutationObserver(t=>{for(let n of t)this.queue.push(n);(je.ie&&je.ie_version<=11||je.ios&&e.composing)&&t.some(n=>n.type=="childList"&&n.removedNodes.length||n.type=="characterData"&&n.oldValue.length>n.target.nodeValue.length)?this.flushSoon():this.flush()}),window.EditContext&&e.constructor.EDIT_CONTEXT!==!1&&!(je.chrome&&je.chrome_version<126)&&(this.editContext=new zq(e),e.state.facet(Bs)&&(e.contentDOM.editContext=this.editContext.editContext)),Np&&(this.onCharData=t=>{this.queue.push({target:t.target,type:"characterData",oldValue:t.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),window.matchMedia&&(this.printQuery=window.matchMedia("print")),typeof ResizeObserver=="function"&&(this.resizeScroll=new ResizeObserver(()=>{var t;((t=this.view.docView)===null||t===void 0?void 0:t.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(e.scrollDOM)),this.addWindowListeners(this.win=e.win),this.start(),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(t=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),t.length>0&&t[t.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(t=>{t.length>0&&t[t.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(e){this.view.inputState.runHandlers("scroll",e),this.intersecting&&this.view.measure()}onScroll(e){this.intersecting&&this.flush(!1),this.editContext&&this.view.requestMeasure(this.editContext.measureReq),this.onScrollChanged(e)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(e){(e.type=="change"||!e.type)&&!e.matches||(this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500))}updateGaps(e){if(this.gapIntersection&&(e.length!=this.gaps.length||this.gaps.some((t,n)=>t!=e[n]))){this.gapIntersection.disconnect();for(let t of e)this.gapIntersection.observe(t);this.gaps=e}}onSelectionChange(e){let t=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:n}=this,i=this.selectionRange;if(n.state.facet(Bs)?n.root.activeElement!=this.dom:!Uu(this.dom,i))return;let s=i.anchorNode&&n.docView.nearest(i.anchorNode);if(s&&s.ignoreEvent(e)){t||(this.selectionChanged=!1);return}(je.ie&&je.ie_version<=11||je.android&&je.chrome)&&!n.state.selection.main.empty&&i.focusNode&&vc(i.focusNode,i.focusOffset,i.anchorNode,i.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:e}=this,t=Xc(e.root);if(!t)return!1;let n=je.safari&&e.root.nodeType==11&&e.root.activeElement==this.dom&&jq(this.view,t)||t;if(!n||this.selectionRange.eq(n))return!1;let i=Uu(this.dom,n);return i&&!this.selectionChanged&&e.inputState.lastFocusTime>Date.now()-200&&e.inputState.lastTouchTime<Date.now()-300&&RV(this.dom,n)?(this.view.inputState.lastFocusTime=0,e.docView.updateSelection(),!1):(this.selectionRange.setRange(n),i&&(this.selectionChanged=!0),!0)}setSelectionRange(e,t){this.selectionRange.set(e.node,e.offset,t.node,t.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let e=0,t=null;for(let n=this.dom;n;)if(n.nodeType==1)!t&&e<this.scrollTargets.length&&this.scrollTargets[e]==n?e++:t||(t=this.scrollTargets.slice(0,e)),t&&t.push(n),n=n.assignedSlot||n.parentNode;else if(n.nodeType==11)n=n.host;else break;if(e<this.scrollTargets.length&&!t&&(t=this.scrollTargets.slice(0,e)),t){for(let n of this.scrollTargets)n.removeEventListener("scroll",this.onScroll);for(let n of this.scrollTargets=t)n.addEventListener("scroll",this.onScroll)}}ignore(e){if(!this.active)return e();try{return this.stop(),e()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,Vq),Np&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),Np&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(e,t){var n;if(!this.delayedAndroidKey){let i=()=>{let s=this.delayedAndroidKey;s&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=s.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&s.force&&Al(this.dom,s.key,s.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(i)}(!this.delayedAndroidKey||e=="Enter")&&(this.delayedAndroidKey={key:e,keyCode:t,force:this.lastChange<Date.now()-50||!!(!((n=this.delayedAndroidKey)===null||n===void 0)&&n.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}processRecords(){let e=this.pendingRecords();e.length&&(this.queue=[]);let t=-1,n=-1,i=!1;for(let s of e){let a=this.readMutation(s);a&&(a.typeOver&&(i=!0),t==-1?{from:t,to:n}=a:(t=Math.min(a.from,t),n=Math.max(a.to,n)))}return{from:t,to:n,typeOver:i}}readChange(){let{from:e,to:t,typeOver:n}=this.processRecords(),i=this.selectionChanged&&Uu(this.dom,this.selectionRange);if(e<0&&!i)return null;e>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let s=new cq(this.view,e,t,n);return this.view.docView.domChanged={newSel:s.newSel?s.newSel.main:null},s}flush(e=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;e&&this.readSelectionRange();let t=this.readChange();if(!t)return this.view.requestMeasure(),!1;let n=this.view.state,i=IA(this.view,t);return this.view.state==n&&(t.domChanged||t.newSel&&!t.newSel.main.eq(this.view.state.selection.main))&&this.view.update([]),i}readMutation(e){let t=this.view.docView.nearest(e.target);if(!t||t.ignoreMutation(e))return null;if(t.markDirty(e.type=="attributes"),e.type=="attributes"&&(t.flags|=4),e.type=="childList"){let n=ab(t,e.previousSibling||e.target.previousSibling,-1),i=ab(t,e.nextSibling||e.target.nextSibling,1);return{from:n?t.posAfter(n):t.posAtStart,to:i?t.posBefore(i):t.posAtEnd,typeOver:!1}}else return e.type=="characterData"?{from:t.posAtStart,to:t.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}:null}setWindow(e){e!=this.win&&(this.removeWindowListeners(this.win),this.win=e,this.addWindowListeners(this.win))}addWindowListeners(e){e.addEventListener("resize",this.onResize),this.printQuery?this.printQuery.addEventListener?this.printQuery.addEventListener("change",this.onPrint):this.printQuery.addListener(this.onPrint):e.addEventListener("beforeprint",this.onPrint),e.addEventListener("scroll",this.onScroll),e.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(e){e.removeEventListener("scroll",this.onScroll),e.removeEventListener("resize",this.onResize),this.printQuery?this.printQuery.removeEventListener?this.printQuery.removeEventListener("change",this.onPrint):this.printQuery.removeListener(this.onPrint):e.removeEventListener("beforeprint",this.onPrint),e.document.removeEventListener("selectionchange",this.onSelectionChange)}update(e){this.editContext&&(this.editContext.update(e),e.startState.facet(Bs)!=e.state.facet(Bs)&&(e.view.contentDOM.editContext=e.state.facet(Bs)?this.editContext.editContext:null))}destroy(){var e,t,n;this.stop(),(e=this.intersection)===null||e===void 0||e.disconnect(),(t=this.gapIntersection)===null||t===void 0||t.disconnect(),(n=this.resizeScroll)===null||n===void 0||n.disconnect();for(let i of this.scrollTargets)i.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey),this.editContext&&(this.view.contentDOM.editContext=null,this.editContext.destroy())}}function ab(r,e,t){for(;e;){let n=Yt.get(e);if(n&&n.parent==r)return n;let i=e.parentNode;e=i!=r.dom?i:t>0?e.nextSibling:e.previousSibling}return null}function ob(r,e){let t=e.startContainer,n=e.startOffset,i=e.endContainer,s=e.endOffset,a=r.docView.domAtPos(r.state.selection.main.anchor);return vc(a.node,a.offset,i,s)&&([t,n,i,s]=[i,s,t,n]),{anchorNode:t,anchorOffset:n,focusNode:i,focusOffset:s}}function jq(r,e){if(e.getComposedRanges){let i=e.getComposedRanges(r.root)[0];if(i)return ob(r,i)}let t=null;function n(i){i.preventDefault(),i.stopImmediatePropagation(),t=i.getTargetRanges()[0]}return r.contentDOM.addEventListener("beforeinput",n,!0),r.dom.ownerDocument.execCommand("indent"),r.contentDOM.removeEventListener("beforeinput",n,!0),t?ob(r,t):null}class zq{constructor(e){this.from=0,this.to=0,this.pendingContextChange=null,this.handlers=Object.create(null),this.composing=null,this.resetRange(e.state);let t=this.editContext=new window.EditContext({text:e.state.doc.sliceString(this.from,this.to),selectionStart:this.toContextPos(Math.max(this.from,Math.min(this.to,e.state.selection.main.anchor))),selectionEnd:this.toContextPos(e.state.selection.main.head)});this.handlers.textupdate=n=>{let i=e.state.selection.main,{anchor:s,head:a}=i,o=this.toEditorPos(n.updateRangeStart),l=this.toEditorPos(n.updateRangeEnd);e.inputState.composing>=0&&!this.composing&&(this.composing={contextBase:n.updateRangeStart,editorBase:o,drifted:!1});let f={from:o,to:l,insert:Nt.of(n.text.split(`
`))};if(f.from==this.from&&s<this.from?f.from=s:f.to==this.to&&s>this.to&&(f.to=s),f.from==f.to&&!f.insert.length){let c=xe.single(this.toEditorPos(n.selectionStart),this.toEditorPos(n.selectionEnd));c.main.eq(i)||e.dispatch({selection:c,userEvent:"select"});return}if((je.mac||je.android)&&f.from==a-1&&/^\. ?$/.test(n.text)&&e.contentDOM.getAttribute("autocorrect")=="off"&&(f={from:o,to:l,insert:Nt.of([n.text.replace("."," ")])}),this.pendingContextChange=f,!e.state.readOnly){let c=this.to-this.from+(f.to-f.from+f.insert.length);wx(e,f,xe.single(this.toEditorPos(n.selectionStart,c),this.toEditorPos(n.selectionEnd,c)))}this.pendingContextChange&&(this.revertPending(e.state),this.setSelection(e.state))},this.handlers.characterboundsupdate=n=>{let i=[],s=null;for(let a=this.toEditorPos(n.rangeStart),o=this.toEditorPos(n.rangeEnd);a<o;a++){let l=e.coordsForChar(a);s=l&&new DOMRect(l.left,l.top,l.right-l.left,l.bottom-l.top)||s||new DOMRect,i.push(s)}t.updateCharacterBounds(n.rangeStart,i)},this.handlers.textformatupdate=n=>{let i=[];for(let s of n.getTextFormats()){let a=s.underlineStyle,o=s.underlineThickness;if(a!="None"&&o!="None"){let l=this.toEditorPos(s.rangeStart),f=this.toEditorPos(s.rangeEnd);if(l<f){let c=`text-decoration: underline ${a=="Dashed"?"dashed ":a=="Squiggle"?"wavy ":""}${o=="Thin"?1:2}px`;i.push(ze.mark({attributes:{style:c}}).range(l,f))}}}e.dispatch({effects:RA.of(ze.set(i))})},this.handlers.compositionstart=()=>{e.inputState.composing<0&&(e.inputState.composing=0,e.inputState.compositionFirstChange=!0)},this.handlers.compositionend=()=>{if(e.inputState.composing=-1,e.inputState.compositionFirstChange=null,this.composing){let{drifted:n}=this.composing;this.composing=null,n&&this.reset(e.state)}};for(let n in this.handlers)t.addEventListener(n,this.handlers[n]);this.measureReq={read:n=>{this.editContext.updateControlBounds(n.contentDOM.getBoundingClientRect());let i=Xc(n.root);i&&i.rangeCount&&this.editContext.updateSelectionBounds(i.getRangeAt(0).getBoundingClientRect())}}}applyEdits(e){let t=0,n=!1,i=this.pendingContextChange;return e.changes.iterChanges((s,a,o,l,f)=>{if(n)return;let c=f.length-(a-s);if(i&&a>=i.to)if(i.from==s&&i.to==a&&i.insert.eq(f)){i=this.pendingContextChange=null,t+=c,this.to+=c;return}else i=null,this.revertPending(e.state);if(s+=t,a+=t,a<=this.from)this.from+=c,this.to+=c;else if(s<this.to){if(s<this.from||a>this.to||this.to-this.from+f.length>3e4){n=!0;return}this.editContext.updateText(this.toContextPos(s),this.toContextPos(a),f.toString()),this.to+=c}t+=c}),i&&!n&&this.revertPending(e.state),!n}update(e){let t=this.pendingContextChange;this.composing&&(this.composing.drifted||e.transactions.some(n=>!n.isUserEvent("input.type")&&n.changes.touchesRange(this.from,this.to)))?(this.composing.drifted=!0,this.composing.editorBase=e.changes.mapPos(this.composing.editorBase)):!this.applyEdits(e)||!this.rangeIsValid(e.state)?(this.pendingContextChange=null,this.reset(e.state)):(e.docChanged||e.selectionSet||t)&&this.setSelection(e.state),(e.geometryChanged||e.docChanged||e.selectionSet)&&e.view.requestMeasure(this.measureReq)}resetRange(e){let{head:t}=e.selection.main;this.from=Math.max(0,t-1e4),this.to=Math.min(e.doc.length,t+1e4)}reset(e){this.resetRange(e),this.editContext.updateText(0,this.editContext.text.length,e.doc.sliceString(this.from,this.to)),this.setSelection(e)}revertPending(e){let t=this.pendingContextChange;this.pendingContextChange=null,this.editContext.updateText(this.toContextPos(t.from),this.toContextPos(t.from+t.insert.length),e.doc.sliceString(t.from,t.to))}setSelection(e){let{main:t}=e.selection,n=this.toContextPos(Math.max(this.from,Math.min(this.to,t.anchor))),i=this.toContextPos(t.head);(this.editContext.selectionStart!=n||this.editContext.selectionEnd!=i)&&this.editContext.updateSelection(n,i)}rangeIsValid(e){let{head:t}=e.selection.main;return!(this.from>0&&t-this.from<500||this.to<e.doc.length&&this.to-t<500||this.to-this.from>1e4*3)}toEditorPos(e,t=this.to-this.from){e=Math.min(e,t);let n=this.composing;return n&&n.drifted?n.editorBase+(e-n.contextBase):e+this.from}toContextPos(e){let t=this.composing;return t&&t.drifted?t.contextBase+(e-t.editorBase):e-this.from}destroy(){for(let e in this.handlers)this.editContext.removeEventListener(e,this.handlers[e])}}class Be{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return this.inputState.composing>0}get compositionStarted(){return this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(e={}){var t;this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),e.parent&&e.parent.appendChild(this.dom);let{dispatch:n}=e;this.dispatchTransactions=e.dispatchTransactions||n&&(i=>i.forEach(s=>n(s,this)))||(i=>this.update(i)),this.dispatch=this.dispatch.bind(this),this._root=e.root||PV(e.parent)||document,this.viewState=new ib(e.state||lt.create(e)),e.scrollTo&&e.scrollTo.is(su)&&(this.viewState.scrollTarget=e.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(qf).map(i=>new Rp(i));for(let i of this.plugins)i.update(this);this.observer=new qq(this),this.inputState=new mq(this),this.inputState.ensureHandlers(this.plugins),this.docView=new Lw(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),!((t=document.fonts)===null||t===void 0)&&t.ready&&document.fonts.ready.then(()=>this.requestMeasure())}dispatch(...e){let t=e.length==1&&e[0]instanceof Br?e:e.length==1&&Array.isArray(e[0])?e[0]:[this.state.update(...e)];this.dispatchTransactions(t,this)}update(e){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let t=!1,n=!1,i,s=this.state;for(let u of e){if(u.startState!=s)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");s=u.state}if(this.destroyed){this.viewState.state=s;return}let a=this.hasFocus,o=0,l=null;e.some(u=>u.annotation(XA))?(this.inputState.notifiedFocused=a,o=1):a!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=a,l=VA(s,a),l||(o=1));let f=this.observer.delayedAndroidKey,c=null;if(f?(this.observer.clearDelayedAndroidKey(),c=this.observer.readChange(),(c&&!this.state.doc.eq(s.doc)||!this.state.selection.eq(s.selection))&&(c=null)):this.observer.clear(),s.facet(lt.phrases)!=this.state.facet(lt.phrases))return this.setState(s);i=Ud.create(this,s,e),i.flags|=o;let h=this.viewState.scrollTarget;try{this.updateState=2;for(let u of e){if(h&&(h=h.map(u.changes)),u.scrollIntoView){let{main:d}=u.state.selection;h=new El(d.empty?d:xe.cursor(d.head,d.head>d.anchor?-1:1))}for(let d of u.effects)d.is(su)&&(h=d.value.clip(this.state))}this.viewState.update(i,h),this.bidiCache=Vd.update(this.bidiCache,i.changes),i.empty||(this.updatePlugins(i),this.inputState.update(i)),t=this.docView.update(i),this.state.facet(jf)!=this.styleModules&&this.mountStyles(),n=this.updateAttrs(),this.showAnnouncements(e),this.docView.updateSelection(t,e.some(u=>u.isUserEvent("select.pointer")))}finally{this.updateState=0}if(i.startState.facet(hu)!=i.state.facet(hu)&&(this.viewState.mustMeasureContent=!0),(t||n||h||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),t&&this.docViewUpdate(),!i.empty)for(let u of this.state.facet(Fg))try{u(i)}catch(d){Jr(this.state,d,"update listener")}(l||c)&&Promise.resolve().then(()=>{l&&this.state==l.startState&&this.dispatch(l),c&&!IA(this,c)&&f.force&&Al(this.contentDOM,f.key,f.keyCode)})}setState(e){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=e;return}this.updateState=2;let t=this.hasFocus;try{for(let n of this.plugins)n.destroy(this);this.viewState=new ib(e),this.plugins=e.facet(qf).map(n=>new Rp(n)),this.pluginMap.clear();for(let n of this.plugins)n.update(this);this.docView.destroy(),this.docView=new Lw(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}t&&this.focus(),this.requestMeasure()}updatePlugins(e){let t=e.startState.facet(qf),n=e.state.facet(qf);if(t!=n){let i=[];for(let s of n){let a=t.indexOf(s);if(a<0)i.push(new Rp(s));else{let o=this.plugins[a];o.mustUpdate=e,i.push(o)}}for(let s of this.plugins)s.mustUpdate!=e&&s.destroy(this);this.plugins=i,this.pluginMap.clear()}else for(let i of this.plugins)i.mustUpdate=e;for(let i=0;i<this.plugins.length;i++)this.plugins[i].update(this);t!=n&&this.inputState.ensureHandlers(this.plugins)}docViewUpdate(){for(let e of this.plugins){let t=e.value;if(t&&t.docViewUpdate)try{t.docViewUpdate(this)}catch(n){Jr(this.state,n,"doc view update listener")}}}measure(e=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey){this.measureScheduled=-1,this.requestMeasure();return}this.measureScheduled=0,e&&this.observer.forceFlush();let t=null,n=this.scrollDOM,i=n.scrollTop*this.scaleY,{scrollAnchorPos:s,scrollAnchorHeight:a}=this.viewState;Math.abs(i-this.viewState.scrollTop)>1&&(a=-1),this.viewState.scrollAnchorHeight=-1;try{for(let o=0;;o++){if(a<0)if(sA(n))s=-1,a=this.viewState.heightMap.height;else{let d=this.viewState.scrollAnchorAt(i);s=d.from,a=d.top}this.updateState=1;let l=this.viewState.measure(this);if(!l&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(o>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let f=[];l&4||([this.measureRequests,f]=[f,this.measureRequests]);let c=f.map(d=>{try{return d.read(this)}catch(p){return Jr(this.state,p),lb}}),h=Ud.create(this,this.state,[]),u=!1;h.flags|=l,t?t.flags|=l:t=h,this.updateState=2,h.empty||(this.updatePlugins(h),this.inputState.update(h),this.updateAttrs(),u=this.docView.update(h),u&&this.docViewUpdate());for(let d=0;d<f.length;d++)if(c[d]!=lb)try{let p=f[d];p.write&&p.write(c[d],this)}catch(p){Jr(this.state,p)}if(u&&this.docView.updateSelection(!0),!h.viewportChanged&&this.measureRequests.length==0){if(this.viewState.editorHeight)if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,a=-1;continue}else{let p=(s<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(s).top)-a;if(p>1||p<-1){i=i+p,n.scrollTop=i/this.scaleY,a=-1;continue}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(t&&!t.empty)for(let o of this.state.facet(Fg))o(t)}get themeClasses(){return Ig+" "+(this.state.facet(Mg)?GA:zA)+" "+this.state.facet(hu)}updateAttrs(){let e=fb(this,QA,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),t={spellcheck:"false",autocorrect:"off",autocapitalize:"off",writingsuggestions:"false",translate:"no",contenteditable:this.state.facet(Bs)?"true":"false",class:"cm-content",style:`${je.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(t["aria-readonly"]="true"),fb(this,xx,t);let n=this.observer.ignore(()=>{let i=Ag(this.contentDOM,this.contentAttrs,t),s=Ag(this.dom,this.editorAttrs,e);return i||s});return this.editorAttrs=e,this.contentAttrs=t,n}showAnnouncements(e){let t=!0;for(let n of e)for(let i of n.effects)if(i.is(Be.announce)){t&&(this.announceDOM.textContent=""),t=!1;let s=this.announceDOM.appendChild(document.createElement("div"));s.textContent=i.value}}mountStyles(){this.styleModules=this.state.facet(jf);let e=this.state.facet(Be.cspNonce);Tn.mount(this.root,this.styleModules.concat(Xq).reverse(),e?{nonce:e}:void 0)}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(e){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),e){if(this.measureRequests.indexOf(e)>-1)return;if(e.key!=null){for(let t=0;t<this.measureRequests.length;t++)if(this.measureRequests[t].key===e.key){this.measureRequests[t]=e;return}}this.measureRequests.push(e)}}plugin(e){let t=this.pluginMap.get(e);return(t===void 0||t&&t.spec!=e)&&this.pluginMap.set(e,t=this.plugins.find(n=>n.spec==e)||null),t&&t.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(e){return this.readMeasured(),this.viewState.elementAtHeight(e)}lineBlockAtHeight(e){return this.readMeasured(),this.viewState.lineBlockAtHeight(e)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(e){return this.viewState.lineBlockAt(e)}get contentHeight(){return this.viewState.contentHeight}moveByChar(e,t,n){return Fp(this,e,Xw(this,e,t,n))}moveByGroup(e,t){return Fp(this,e,Xw(this,e,t,n=>aq(this,e.head,n)))}visualLineSide(e,t){let n=this.bidiSpans(e),i=this.textDirectionAt(e.from),s=n[t?n.length-1:0];return xe.cursor(s.side(t,i)+e.from,s.forward(!t,i)?1:-1)}moveToLineBoundary(e,t,n=!0){return sq(this,e,t,n)}moveVertically(e,t,n){return Fp(this,e,oq(this,e,t,n))}domAtPos(e){return this.docView.domAtPos(e)}posAtDOM(e,t=0){return this.docView.posFromDOM(e,t)}posAtCoords(e,t=!0){return this.readMeasured(),MA(this,e,t)}coordsAtPos(e,t=1){this.readMeasured();let n=this.docView.coordsAt(e,t);if(!n||n.left==n.right)return n;let i=this.state.doc.lineAt(e),s=this.bidiSpans(i),a=s[Aa.find(s,e-i.from,-1,t)];return L0(n,a.dir==Rt.LTR==t>0)}coordsForChar(e){return this.readMeasured(),this.docView.coordsForChar(e)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(e){return!this.state.facet(AA)||e<this.viewport.from||e>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(e))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(e){if(e.length>Gq)return yA(e.length);let t=this.textDirectionAt(e.from),n;for(let s of this.bidiCache)if(s.from==e.from&&s.dir==t&&(s.fresh||vA(s.isolates,n=Iw(this,e))))return s.order;n||(n=Iw(this,e));let i=UV(e.text,t,n);return this.bidiCache.push(new Vd(e.from,e.to,t,n,!0,i)),i}get hasFocus(){var e;return(this.dom.ownerDocument.hasFocus()||je.safari&&((e=this.inputState)===null||e===void 0?void 0:e.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{nA(this.contentDOM),this.docView.updateSelection()})}setRoot(e){this._root!=e&&(this._root=e,this.observer.setWindow((e.nodeType==9?e:e.ownerDocument).defaultView||window),this.mountStyles())}destroy(){this.root.activeElement==this.contentDOM&&this.contentDOM.blur();for(let e of this.plugins)e.destroy(this);this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(e,t={}){return su.of(new El(typeof e=="number"?xe.cursor(e):e,t.y,t.x,t.yMargin,t.xMargin))}scrollSnapshot(){let{scrollTop:e,scrollLeft:t}=this.scrollDOM,n=this.viewState.scrollAnchorAt(e);return su.of(new El(xe.cursor(n.from),"start","start",n.top-e,t,!0))}setTabFocusMode(e){e==null?this.inputState.tabFocusMode=this.inputState.tabFocusMode<0?0:-1:typeof e=="boolean"?this.inputState.tabFocusMode=e?0:-1:this.inputState.tabFocusMode!=0&&(this.inputState.tabFocusMode=Date.now()+e)}static domEventHandlers(e){return gr.define(()=>({}),{eventHandlers:e})}static domEventObservers(e){return gr.define(()=>({}),{eventObservers:e})}static theme(e,t){let n=Tn.newName(),i=[hu.of(n),jf.of(Lg(`.${n}`,e))];return t&&t.dark&&i.push(Mg.of(!0)),i}static baseTheme(e){return za.lowest(jf.of(Lg("."+Ig,e,HA)))}static findFromDOM(e){var t;let n=e.querySelector(".cm-content"),i=n&&Yt.get(n)||Yt.get(e);return((t=i==null?void 0:i.rootView)===null||t===void 0?void 0:t.view)||null}}Be.styleModule=jf;Be.inputHandler=TA;Be.clipboardInputFilter=gx;Be.clipboardOutputFilter=Ox;Be.scrollHandler=PA;Be.focusChangeEffect=CA;Be.perLineTextDirection=AA;Be.exceptionSink=SA;Be.updateListener=Fg;Be.editable=Bs;Be.mouseSelectionStyle=kA;Be.dragMovesSelection=_A;Be.clickAddsSelectionRange=bA;Be.decorations=qc;Be.outerDecorations=FA;Be.atomicRanges=vx;Be.bidiIsolatedRanges=$A;Be.scrollMargins=NA;Be.darkTheme=Mg;Be.cspNonce=Le.define({combine:r=>r.length?r[0]:""});Be.contentAttributes=xx;Be.editorAttributes=QA;Be.lineWrapping=Be.contentAttributes.of({class:"cm-lineWrapping"});Be.announce=ot.define();const Gq=4096,lb={};class Vd{constructor(e,t,n,i,s,a){this.from=e,this.to=t,this.dir=n,this.isolates=i,this.fresh=s,this.order=a}static update(e,t){if(t.empty&&!e.some(s=>s.fresh))return e;let n=[],i=e.length?e[e.length-1].dir:Rt.LTR;for(let s=Math.max(0,e.length-10);s<e.length;s++){let a=e[s];a.dir==i&&!t.touchesRange(a.from,a.to)&&n.push(new Vd(t.mapPos(a.from,1),t.mapPos(a.to,-1),a.dir,a.isolates,!1,a.order))}return n}}function fb(r,e,t){for(let n=r.state.facet(e),i=n.length-1;i>=0;i--){let s=n[i],a=typeof s=="function"?s(r):s;a&&Cg(a,t)}return t}const Hq=je.mac?"mac":je.windows?"win":je.linux?"linux":"key";function Yq(r,e){const t=r.split(/-(?!$)/);let n=t[t.length-1];n=="Space"&&(n=" ");let i,s,a,o;for(let l=0;l<t.length-1;++l){const f=t[l];if(/^(cmd|meta|m)$/i.test(f))o=!0;else if(/^a(lt)?$/i.test(f))i=!0;else if(/^(c|ctrl|control)$/i.test(f))s=!0;else if(/^s(hift)?$/i.test(f))a=!0;else if(/^mod$/i.test(f))e=="mac"?o=!0:s=!0;else throw new Error("Unrecognized modifier name: "+f)}return i&&(n="Alt-"+n),s&&(n="Ctrl-"+n),o&&(n="Meta-"+n),a&&(n="Shift-"+n),n}function uu(r,e,t){return e.altKey&&(r="Alt-"+r),e.ctrlKey&&(r="Ctrl-"+r),e.metaKey&&(r="Meta-"+r),t!==!1&&e.shiftKey&&(r="Shift-"+r),r}const Kq=za.default(Be.domEventHandlers({keydown(r,e){return KA(YA(e.state),r,e,"editor")}})),W0=Le.define({enables:Kq}),cb=new WeakMap;function YA(r){let e=r.facet(W0),t=cb.get(e);return t||cb.set(e,t=tj(e.reduce((n,i)=>n.concat(i),[]))),t}function Jq(r,e,t){return KA(YA(r.state),e,r,t)}let wa=null;const ej=4e3;function tj(r,e=Hq){let t=Object.create(null),n=Object.create(null),i=(a,o)=>{let l=n[a];if(l==null)n[a]=o;else if(l!=o)throw new Error("Key binding "+a+" is used both as a regular binding and as a multi-stroke prefix")},s=(a,o,l,f,c)=>{var h,u;let d=t[a]||(t[a]=Object.create(null)),p=o.split(/ (?!$)/).map(v=>Yq(v,e));for(let v=1;v<p.length;v++){let w=p.slice(0,v).join(" ");i(w,!0),d[w]||(d[w]={preventDefault:!0,stopPropagation:!1,run:[x=>{let S=wa={view:x,prefix:w,scope:a};return setTimeout(()=>{wa==S&&(wa=null)},ej),!0}]})}let m=p.join(" ");i(m,!1);let g=d[m]||(d[m]={preventDefault:!1,stopPropagation:!1,run:((u=(h=d._any)===null||h===void 0?void 0:h.run)===null||u===void 0?void 0:u.slice())||[]});l&&g.run.push(l),f&&(g.preventDefault=!0),c&&(g.stopPropagation=!0)};for(let a of r){let o=a.scope?a.scope.split(" "):["editor"];if(a.any)for(let f of o){let c=t[f]||(t[f]=Object.create(null));c._any||(c._any={preventDefault:!1,stopPropagation:!1,run:[]});let{any:h}=a;for(let u in c)c[u].run.push(d=>h(d,Bg))}let l=a[e]||a.key;if(l)for(let f of o)s(f,l,a.run,a.preventDefault,a.stopPropagation),a.shift&&s(f,"Shift-"+l,a.shift,a.preventDefault,a.stopPropagation)}return t}let Bg=null;function KA(r,e,t,n){Bg=e;let i=SV(e),s=Wn(i,0),a=ds(s)==i.length&&i!=" ",o="",l=!1,f=!1,c=!1;wa&&wa.view==t&&wa.scope==n&&(o=wa.prefix+" ",BA.indexOf(e.keyCode)<0&&(f=!0,wa=null));let h=new Set,u=g=>{if(g){for(let v of g.run)if(!h.has(v)&&(h.add(v),v(t)))return g.stopPropagation&&(c=!0),!0;g.preventDefault&&(g.stopPropagation&&(c=!0),f=!0)}return!1},d=r[n],p,m;return d&&(u(d[o+uu(i,e,!a)])?l=!0:a&&(e.altKey||e.metaKey||e.ctrlKey)&&!(je.windows&&e.ctrlKey&&e.altKey)&&(p=Ma[e.keyCode])&&p!=i?(u(d[o+uu(p,e,!0)])||e.shiftKey&&(m=Uc[e.keyCode])!=i&&m!=p&&u(d[o+uu(m,e,!1)]))&&(l=!0):a&&e.shiftKey&&u(d[o+uu(i,e,!0)])&&(l=!0),!l&&u(d._any)&&(l=!0)),f&&(l=!0),l&&c&&e.stopPropagation(),Bg=null,l}class Rh{constructor(e,t,n,i,s){this.className=e,this.left=t,this.top=n,this.width=i,this.height=s}draw(){let e=document.createElement("div");return e.className=this.className,this.adjust(e),e}update(e,t){return t.className!=this.className?!1:(this.adjust(e),!0)}adjust(e){e.style.left=this.left+"px",e.style.top=this.top+"px",this.width!=null&&(e.style.width=this.width+"px"),e.style.height=this.height+"px"}eq(e){return this.left==e.left&&this.top==e.top&&this.width==e.width&&this.height==e.height&&this.className==e.className}static forRange(e,t,n){if(n.empty){let i=e.coordsAtPos(n.head,n.assoc||1);if(!i)return[];let s=JA(e);return[new Rh(t,i.left-s.left,i.top-s.top,null,i.bottom-i.top)]}else return rj(e,t,n)}}function JA(r){let e=r.scrollDOM.getBoundingClientRect();return{left:(r.textDirection==Rt.LTR?e.left:e.right-r.scrollDOM.clientWidth*r.scaleX)-r.scrollDOM.scrollLeft*r.scaleX,top:e.top-r.scrollDOM.scrollTop*r.scaleY}}function hb(r,e,t,n){let i=r.coordsAtPos(e,t*2);if(!i)return n;let s=r.dom.getBoundingClientRect(),a=(i.top+i.bottom)/2,o=r.posAtCoords({x:s.left+1,y:a}),l=r.posAtCoords({x:s.right-1,y:a});return o==null||l==null?n:{from:Math.max(n.from,Math.min(o,l)),to:Math.min(n.to,Math.max(o,l))}}function rj(r,e,t){if(t.to<=r.viewport.from||t.from>=r.viewport.to)return[];let n=Math.max(t.from,r.viewport.from),i=Math.min(t.to,r.viewport.to),s=r.textDirection==Rt.LTR,a=r.contentDOM,o=a.getBoundingClientRect(),l=JA(r),f=a.querySelector(".cm-line"),c=f&&window.getComputedStyle(f),h=o.left+(c?parseInt(c.paddingLeft)+Math.min(0,parseInt(c.textIndent)):0),u=o.right-(c?parseInt(c.paddingRight):0),d=Ng(r,n),p=Ng(r,i),m=d.type==$n.Text?d:null,g=p.type==$n.Text?p:null;if(m&&(r.lineWrapping||d.widgetLineBreaks)&&(m=hb(r,n,1,m)),g&&(r.lineWrapping||p.widgetLineBreaks)&&(g=hb(r,i,-1,g)),m&&g&&m.from==g.from&&m.to==g.to)return w(x(t.from,t.to,m));{let y=m?x(t.from,null,m):S(d,!1),b=g?x(null,t.to,g):S(p,!0),O=[];return(m||d).to<(g||p).from-(m&&g?1:0)||d.widgetLineBreaks>1&&y.bottom+r.defaultLineHeight/2<b.top?O.push(v(h,y.bottom,u,b.top)):y.bottom<b.top&&r.elementAtHeight((y.bottom+b.top)/2).type==$n.Text&&(y.bottom=b.top=(y.bottom+b.top)/2),w(y).concat(O).concat(w(b))}function v(y,b,O,T){return new Rh(e,y-l.left,b-l.top,O-y,T-b)}function w({top:y,bottom:b,horizontal:O}){let T=[];for(let k=0;k<O.length;k+=2)T.push(v(O[k],y,O[k+1],b));return T}function x(y,b,O){let T=1e9,k=-1e9,Q=[];function A(U,z,K,re,ge){let V=r.coordsAtPos(U,U==O.to?-2:2),he=r.coordsAtPos(K,K==O.from?2:-2);!V||!he||(T=Math.min(V.top,he.top,T),k=Math.max(V.bottom,he.bottom,k),ge==Rt.LTR?Q.push(s&&z?h:V.left,s&&re?u:he.right):Q.push(!s&&re?h:he.left,!s&&z?u:V.right))}let _=y??O.from,N=b??O.to;for(let U of r.visibleRanges)if(U.to>_&&U.from<N)for(let z=Math.max(U.from,_),K=Math.min(U.to,N);;){let re=r.state.doc.lineAt(z);for(let ge of r.bidiSpans(re)){let V=ge.from+re.from,he=ge.to+re.from;if(V>=K)break;he>z&&A(Math.max(V,z),y==null&&V<=_,Math.min(he,K),b==null&&he>=N,ge.dir)}if(z=re.to+1,z>=K)break}return Q.length==0&&A(_,y==null,N,b==null,r.textDirection),{top:T,bottom:k,horizontal:Q}}function S(y,b){let O=o.top+(b?y.top:y.bottom);return{top:O,bottom:O,horizontal:[]}}}function nj(r,e){return r.constructor==e.constructor&&r.eq(e)}class ij{constructor(e,t){this.view=e,this.layer=t,this.drawn=[],this.scaleX=1,this.scaleY=1,this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=e.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),t.above&&this.dom.classList.add("cm-layer-above"),t.class&&this.dom.classList.add(t.class),this.scale(),this.dom.setAttribute("aria-hidden","true"),this.setOrder(e.state),e.requestMeasure(this.measureReq),t.mount&&t.mount(this.dom,e)}update(e){e.startState.facet(ju)!=e.state.facet(ju)&&this.setOrder(e.state),(this.layer.update(e,this.dom)||e.geometryChanged)&&(this.scale(),e.view.requestMeasure(this.measureReq))}docViewUpdate(e){this.layer.updateOnDocViewUpdate!==!1&&e.requestMeasure(this.measureReq)}setOrder(e){let t=0,n=e.facet(ju);for(;t<n.length&&n[t]!=this.layer;)t++;this.dom.style.zIndex=String((this.layer.above?150:-1)-t)}measure(){return this.layer.markers(this.view)}scale(){let{scaleX:e,scaleY:t}=this.view;(e!=this.scaleX||t!=this.scaleY)&&(this.scaleX=e,this.scaleY=t,this.dom.style.transform=`scale(${1/e}, ${1/t})`)}draw(e){if(e.length!=this.drawn.length||e.some((t,n)=>!nj(t,this.drawn[n]))){let t=this.dom.firstChild,n=0;for(let i of e)i.update&&t&&i.constructor&&this.drawn[n].constructor&&i.update(t,this.drawn[n])?(t=t.nextSibling,n++):this.dom.insertBefore(i.draw(),t);for(;t;){let i=t.nextSibling;t.remove(),t=i}this.drawn=e}}destroy(){this.layer.destroy&&this.layer.destroy(this.dom,this.view),this.dom.remove()}}const ju=Le.define();function e4(r){return[gr.define(e=>new ij(e,r)),ju.of(r)]}const t4=!(je.ios&&je.webkit&&je.webkit_version<534),jc=Le.define({combine(r){return $s(r,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(e,t)=>Math.min(e,t),drawRangeCursor:(e,t)=>e||t})}});function sj(r={}){return[jc.of(r),aj,oj,lj,EA.of(!0)]}function r4(r){return r.startState.facet(jc)!=r.state.facet(jc)}const aj=e4({above:!0,markers(r){let{state:e}=r,t=e.facet(jc),n=[];for(let i of e.selection.ranges){let s=i==e.selection.main;if(i.empty?!s||t4:t.drawRangeCursor){let a=s?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",o=i.empty?i:xe.cursor(i.head,i.head>i.anchor?-1:1);for(let l of Rh.forRange(r,a,o))n.push(l)}}return n},update(r,e){r.transactions.some(n=>n.selection)&&(e.style.animationName=e.style.animationName=="cm-blink"?"cm-blink2":"cm-blink");let t=r4(r);return t&&ub(r.state,e),r.docChanged||r.selectionSet||t},mount(r,e){ub(e.state,r)},class:"cm-cursorLayer"});function ub(r,e){e.style.animationDuration=r.facet(jc).cursorBlinkRate+"ms"}const oj=e4({above:!1,markers(r){return r.state.selection.ranges.map(e=>e.empty?[]:Rh.forRange(r,"cm-selectionBackground",e)).reduce((e,t)=>e.concat(t))},update(r,e){return r.docChanged||r.selectionSet||r.viewportChanged||r4(r)},class:"cm-selectionLayer"}),Zg={".cm-line":{"& ::selection, &::selection":{backgroundColor:"transparent !important"}},".cm-content":{"& :focus":{caretColor:"initial !important","&::selection, & ::selection":{backgroundColor:"Highlight !important"}}}};t4&&(Zg[".cm-line"].caretColor=Zg[".cm-content"].caretColor="transparent !important");const lj=za.highest(Be.theme(Zg)),n4=ot.define({map(r,e){return r==null?null:e.mapPos(r)}}),Hf=Cr.define({create(){return null},update(r,e){return r!=null&&(r=e.changes.mapPos(r)),e.effects.reduce((t,n)=>n.is(n4)?n.value:t,r)}}),fj=gr.fromClass(class{constructor(r){this.view=r,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(r){var e;let t=r.state.field(Hf);t==null?this.cursor!=null&&((e=this.cursor)===null||e===void 0||e.remove(),this.cursor=null):(this.cursor||(this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor"),(r.startState.field(Hf)!=t||r.docChanged||r.geometryChanged)&&this.view.requestMeasure(this.measureReq))}readPos(){let{view:r}=this,e=r.state.field(Hf),t=e!=null&&r.coordsAtPos(e);if(!t)return null;let n=r.scrollDOM.getBoundingClientRect();return{left:t.left-n.left+r.scrollDOM.scrollLeft*r.scaleX,top:t.top-n.top+r.scrollDOM.scrollTop*r.scaleY,height:t.bottom-t.top}}drawCursor(r){if(this.cursor){let{scaleX:e,scaleY:t}=this.view;r?(this.cursor.style.left=r.left/e+"px",this.cursor.style.top=r.top/t+"px",this.cursor.style.height=r.height/t+"px"):this.cursor.style.left="-100000px"}}destroy(){this.cursor&&this.cursor.remove()}setDropPos(r){this.view.state.field(Hf)!=r&&this.view.dispatch({effects:n4.of(r)})}},{eventObservers:{dragover(r){this.setDropPos(this.view.posAtCoords({x:r.clientX,y:r.clientY}))},dragleave(r){(r.target==this.view.contentDOM||!this.view.contentDOM.contains(r.relatedTarget))&&this.setDropPos(null)},dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}});function cj(){return[Hf,fj]}function db(r,e,t,n,i){e.lastIndex=0;for(let s=r.iterRange(t,n),a=t,o;!s.next().done;a+=s.value.length)if(!s.lineBreak)for(;o=e.exec(s.value);)i(a+o.index,o)}function hj(r,e){let t=r.visibleRanges;if(t.length==1&&t[0].from==r.viewport.from&&t[0].to==r.viewport.to)return t;let n=[];for(let{from:i,to:s}of t)i=Math.max(r.state.doc.lineAt(i).from,i-e),s=Math.min(r.state.doc.lineAt(s).to,s+e),n.length&&n[n.length-1].to>=i?n[n.length-1].to=s:n.push({from:i,to:s});return n}class uj{constructor(e){const{regexp:t,decoration:n,decorate:i,boundary:s,maxLength:a=1e3}=e;if(!t.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");if(this.regexp=t,i)this.addMatch=(o,l,f,c)=>i(c,f,f+o[0].length,o,l);else if(typeof n=="function")this.addMatch=(o,l,f,c)=>{let h=n(o,l,f);h&&c(f,f+o[0].length,h)};else if(n)this.addMatch=(o,l,f,c)=>c(f,f+o[0].length,n);else throw new RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.boundary=s,this.maxLength=a}createDeco(e){let t=new Gs,n=t.add.bind(t);for(let{from:i,to:s}of hj(e,this.maxLength))db(e.state.doc,this.regexp,i,s,(a,o)=>this.addMatch(o,e,a,n));return t.finish()}updateDeco(e,t){let n=1e9,i=-1;return e.docChanged&&e.changes.iterChanges((s,a,o,l)=>{l>=e.view.viewport.from&&o<=e.view.viewport.to&&(n=Math.min(o,n),i=Math.max(l,i))}),e.viewportMoved||i-n>1e3?this.createDeco(e.view):i>-1?this.updateRange(e.view,t.map(e.changes),n,i):t}updateRange(e,t,n,i){for(let s of e.visibleRanges){let a=Math.max(s.from,n),o=Math.min(s.to,i);if(o>a){let l=e.state.doc.lineAt(a),f=l.to<o?e.state.doc.lineAt(o):l,c=Math.max(s.from,l.from),h=Math.min(s.to,f.to);if(this.boundary){for(;a>l.from;a--)if(this.boundary.test(l.text[a-1-l.from])){c=a;break}for(;o<f.to;o++)if(this.boundary.test(f.text[o-f.from])){h=o;break}}let u=[],d,p=(m,g,v)=>u.push(v.range(m,g));if(l==f)for(this.regexp.lastIndex=c-l.from;(d=this.regexp.exec(l.text))&&d.index<h-l.from;)this.addMatch(d,e,d.index+l.from,p);else db(e.state.doc,this.regexp,c,h,(m,g)=>this.addMatch(g,e,m,p));t=t.update({filterFrom:c,filterTo:h,filter:(m,g)=>m<c||g>h,add:u})}}return t}}const Wg=/x/.unicode!=null?"gu":"g",dj=new RegExp(`[\0-\b
--\u2028\u2029\uFEFF-]`,Wg),pj={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"};let Dp=null;function mj(){var r;if(Dp==null&&typeof document<"u"&&document.body){let e=document.body.style;Dp=((r=e.tabSize)!==null&&r!==void 0?r:e.MozTabSize)!=null}return Dp||!1}const zu=Le.define({combine(r){let e=$s(r,{render:null,specialChars:dj,addSpecialChars:null});return(e.replaceTabs=!mj())&&(e.specialChars=new RegExp("	|"+e.specialChars.source,Wg)),e.addSpecialChars&&(e.specialChars=new RegExp(e.specialChars.source+"|"+e.addSpecialChars.source,Wg)),e}});function gj(r={}){return[zu.of(r),Oj()]}let pb=null;function Oj(){return pb||(pb=gr.fromClass(class{constructor(r){this.view=r,this.decorations=ze.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(r.state.facet(zu)),this.decorations=this.decorator.createDeco(r)}makeDecorator(r){return new uj({regexp:r.specialChars,decoration:(e,t,n)=>{let{doc:i}=t.state,s=Wn(e[0],0);if(s==9){let a=i.lineAt(n),o=t.state.tabSize,l=df(a.text,o,n-a.from);return ze.replace({widget:new wj((o-l%o)*this.view.defaultCharacterWidth/this.view.scaleX)})}return this.decorationCache[s]||(this.decorationCache[s]=ze.replace({widget:new yj(r,s)}))},boundary:r.replaceTabs?void 0:/[^]/})}update(r){let e=r.state.facet(zu);r.startState.facet(zu)!=e?(this.decorator=this.makeDecorator(e),this.decorations=this.decorator.createDeco(r.view)):this.decorations=this.decorator.updateDeco(r,this.decorations)}},{decorations:r=>r.decorations}))}const xj="";function vj(r){return r>=32?xj:r==10?"":String.fromCharCode(9216+r)}class yj extends ia{constructor(e,t){super(),this.options=e,this.code=t}eq(e){return e.code==this.code}toDOM(e){let t=vj(this.code),n=e.state.phrase("Control character")+" "+(pj[this.code]||"0x"+this.code.toString(16)),i=this.options.render&&this.options.render(this.code,n,t);if(i)return i;let s=document.createElement("span");return s.textContent=t,s.title=n,s.setAttribute("aria-label",n),s.className="cm-specialChar",s}ignoreEvent(){return!1}}class wj extends ia{constructor(e){super(),this.width=e}eq(e){return e.width==this.width}toDOM(){let e=document.createElement("span");return e.textContent="	",e.className="cm-tab",e.style.width=this.width+"px",e}ignoreEvent(){return!1}}function bj(){return kj}const _j=ze.line({class:"cm-activeLine"}),kj=gr.fromClass(class{constructor(r){this.decorations=this.getDeco(r)}update(r){(r.docChanged||r.selectionSet)&&(this.decorations=this.getDeco(r.view))}getDeco(r){let e=-1,t=[];for(let n of r.state.selection.ranges){let i=r.lineBlockAt(n.head);i.from>e&&(t.push(_j.range(i.from)),e=i.from)}return ze.set(t)}},{decorations:r=>r.decorations}),Ug=2e3;function Sj(r,e,t){let n=Math.min(e.line,t.line),i=Math.max(e.line,t.line),s=[];if(e.off>Ug||t.off>Ug||e.col<0||t.col<0){let a=Math.min(e.off,t.off),o=Math.max(e.off,t.off);for(let l=n;l<=i;l++){let f=r.doc.line(l);f.length<=o&&s.push(xe.range(f.from+a,f.to+o))}}else{let a=Math.min(e.col,t.col),o=Math.max(e.col,t.col);for(let l=n;l<=i;l++){let f=r.doc.line(l),c=yg(f.text,a,r.tabSize,!0);if(c<0)s.push(xe.cursor(f.to));else{let h=yg(f.text,o,r.tabSize);s.push(xe.range(f.from+c,f.from+h))}}}return s}function Tj(r,e){let t=r.coordsAtPos(r.viewport.from);return t?Math.round(Math.abs((t.left-e)/r.defaultCharacterWidth)):-1}function mb(r,e){let t=r.posAtCoords({x:e.clientX,y:e.clientY},!1),n=r.state.doc.lineAt(t),i=t-n.from,s=i>Ug?-1:i==n.length?Tj(r,e.clientX):df(n.text,r.state.tabSize,t-n.from);return{line:n.number,col:s,off:i}}function Cj(r,e){let t=mb(r,e),n=r.state.selection;return t?{update(i){if(i.docChanged){let s=i.changes.mapPos(i.startState.doc.line(t.line).from),a=i.state.doc.lineAt(s);t={line:a.number,col:t.col,off:Math.min(t.off,a.length)},n=n.map(i.changes)}},get(i,s,a){let o=mb(r,i);if(!o)return n;let l=Sj(r.state,t,o);return l.length?a?xe.create(l.concat(n.ranges)):xe.create(l):n}}:null}function Aj(r){let e=t=>t.altKey&&t.button==0;return Be.mouseSelectionStyle.of((t,n)=>e(n)?Cj(t,n):null)}const Ej={Alt:[18,r=>!!r.altKey],Control:[17,r=>!!r.ctrlKey],Shift:[16,r=>!!r.shiftKey],Meta:[91,r=>!!r.metaKey]},Pj={style:"cursor: crosshair"};function Rj(r={}){let[e,t]=Ej[r.key||"Alt"],n=gr.fromClass(class{constructor(i){this.view=i,this.isDown=!1}set(i){this.isDown!=i&&(this.isDown=i,this.view.update([]))}},{eventObservers:{keydown(i){this.set(i.keyCode==e||t(i))},keyup(i){(i.keyCode==e||!t(i))&&this.set(!1)},mousemove(i){this.set(t(i))}}});return[n,Be.contentAttributes.of(i=>{var s;return!((s=i.plugin(n))===null||s===void 0)&&s.isDown?Pj:null})]}const Af="-10000px";class i4{constructor(e,t,n,i){this.facet=t,this.createTooltipView=n,this.removeTooltipView=i,this.input=e.state.facet(t),this.tooltips=this.input.filter(a=>a);let s=null;this.tooltipViews=this.tooltips.map(a=>s=n(a,s))}update(e,t){var n;let i=e.state.facet(this.facet),s=i.filter(l=>l);if(i===this.input){for(let l of this.tooltipViews)l.update&&l.update(e);return!1}let a=[],o=t?[]:null;for(let l=0;l<s.length;l++){let f=s[l],c=-1;if(f){for(let h=0;h<this.tooltips.length;h++){let u=this.tooltips[h];u&&u.create==f.create&&(c=h)}if(c<0)a[l]=this.createTooltipView(f,l?a[l-1]:null),o&&(o[l]=!!f.above);else{let h=a[l]=this.tooltipViews[c];o&&(o[l]=t[c]),h.update&&h.update(e)}}}for(let l of this.tooltipViews)a.indexOf(l)<0&&(this.removeTooltipView(l),(n=l.destroy)===null||n===void 0||n.call(l));return t&&(o.forEach((l,f)=>t[f]=l),t.length=o.length),this.input=i,this.tooltips=s,this.tooltipViews=a,!0}}function Qj(r){let{win:e}=r;return{top:0,left:0,bottom:e.innerHeight,right:e.innerWidth}}const Mp=Le.define({combine:r=>{var e,t,n;return{position:je.ios?"absolute":((e=r.find(i=>i.position))===null||e===void 0?void 0:e.position)||"fixed",parent:((t=r.find(i=>i.parent))===null||t===void 0?void 0:t.parent)||null,tooltipSpace:((n=r.find(i=>i.tooltipSpace))===null||n===void 0?void 0:n.tooltipSpace)||Qj}}}),gb=new WeakMap,kx=gr.fromClass(class{constructor(r){this.view=r,this.above=[],this.inView=!0,this.madeAbsolute=!1,this.lastTransaction=0,this.measureTimeout=-1;let e=r.state.facet(Mp);this.position=e.position,this.parent=e.parent,this.classes=r.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.resizeObserver=typeof ResizeObserver=="function"?new ResizeObserver(()=>this.measureSoon()):null,this.manager=new i4(r,Sx,(t,n)=>this.createTooltip(t,n),t=>{this.resizeObserver&&this.resizeObserver.unobserve(t.dom),t.dom.remove()}),this.above=this.manager.tooltips.map(t=>!!t.above),this.intersectionObserver=typeof IntersectionObserver=="function"?new IntersectionObserver(t=>{Date.now()>this.lastTransaction-50&&t.length>0&&t[t.length-1].intersectionRatio<1&&this.measureSoon()},{threshold:[1]}):null,this.observeIntersection(),r.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let r of this.manager.tooltipViews)this.intersectionObserver.observe(r.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1,this.maybeMeasure()},50))}update(r){r.transactions.length&&(this.lastTransaction=Date.now());let e=this.manager.update(r,this.above);e&&this.observeIntersection();let t=e||r.geometryChanged,n=r.state.facet(Mp);if(n.position!=this.position&&!this.madeAbsolute){this.position=n.position;for(let i of this.manager.tooltipViews)i.dom.style.position=this.position;t=!0}if(n.parent!=this.parent){this.parent&&this.container.remove(),this.parent=n.parent,this.createContainer();for(let i of this.manager.tooltipViews)this.container.appendChild(i.dom);t=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);t&&this.maybeMeasure()}createTooltip(r,e){let t=r.create(this.view),n=e?e.dom:null;if(t.dom.classList.add("cm-tooltip"),r.arrow&&!t.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let i=document.createElement("div");i.className="cm-tooltip-arrow",t.dom.appendChild(i)}return t.dom.style.position=this.position,t.dom.style.top=Af,t.dom.style.left="0px",this.container.insertBefore(t.dom,n),t.mount&&t.mount(this.view),this.resizeObserver&&this.resizeObserver.observe(t.dom),t}destroy(){var r,e,t;this.view.win.removeEventListener("resize",this.measureSoon);for(let n of this.manager.tooltipViews)n.dom.remove(),(r=n.destroy)===null||r===void 0||r.call(n);this.parent&&this.container.remove(),(e=this.resizeObserver)===null||e===void 0||e.disconnect(),(t=this.intersectionObserver)===null||t===void 0||t.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let r=1,e=1,t=!1;if(this.position=="fixed"&&this.manager.tooltipViews.length){let{dom:s}=this.manager.tooltipViews[0];if(je.gecko)t=s.offsetParent!=this.container.ownerDocument.body;else if(s.style.top==Af&&s.style.left=="0px"){let a=s.getBoundingClientRect();t=Math.abs(a.top+1e4)>1||Math.abs(a.left)>1}}if(t||this.position=="absolute")if(this.parent){let s=this.parent.getBoundingClientRect();s.width&&s.height&&(r=s.width/this.parent.offsetWidth,e=s.height/this.parent.offsetHeight)}else({scaleX:r,scaleY:e}=this.view.viewState);let n=this.view.scrollDOM.getBoundingClientRect(),i=yx(this.view);return{visible:{left:n.left+i.left,top:n.top+i.top,right:n.right-i.right,bottom:n.bottom-i.bottom},parent:this.parent?this.container.getBoundingClientRect():this.view.dom.getBoundingClientRect(),pos:this.manager.tooltips.map((s,a)=>{let o=this.manager.tooltipViews[a];return o.getCoords?o.getCoords(s.pos):this.view.coordsAtPos(s.pos)}),size:this.manager.tooltipViews.map(({dom:s})=>s.getBoundingClientRect()),space:this.view.state.facet(Mp).tooltipSpace(this.view),scaleX:r,scaleY:e,makeAbsolute:t}}writeMeasure(r){var e;if(r.makeAbsolute){this.madeAbsolute=!0,this.position="absolute";for(let o of this.manager.tooltipViews)o.dom.style.position="absolute"}let{visible:t,space:n,scaleX:i,scaleY:s}=r,a=[];for(let o=0;o<this.manager.tooltips.length;o++){let l=this.manager.tooltips[o],f=this.manager.tooltipViews[o],{dom:c}=f,h=r.pos[o],u=r.size[o];if(!h||l.clip!==!1&&(h.bottom<=Math.max(t.top,n.top)||h.top>=Math.min(t.bottom,n.bottom)||h.right<Math.max(t.left,n.left)-.1||h.left>Math.min(t.right,n.right)+.1)){c.style.top=Af;continue}let d=l.arrow?f.dom.querySelector(".cm-tooltip-arrow"):null,p=d?7:0,m=u.right-u.left,g=(e=gb.get(f))!==null&&e!==void 0?e:u.bottom-u.top,v=f.offset||$j,w=this.view.textDirection==Rt.LTR,x=u.width>n.right-n.left?w?n.left:n.right-u.width:w?Math.max(n.left,Math.min(h.left-(d?14:0)+v.x,n.right-m)):Math.min(Math.max(n.left,h.left-m+(d?14:0)-v.x),n.right-m),S=this.above[o];!l.strictSide&&(S?h.top-g-p-v.y<n.top:h.bottom+g+p+v.y>n.bottom)&&S==n.bottom-h.bottom>h.top-n.top&&(S=this.above[o]=!S);let y=(S?h.top-n.top:n.bottom-h.bottom)-p;if(y<g&&f.resize!==!1){if(y<this.view.defaultLineHeight){c.style.top=Af;continue}gb.set(f,g),c.style.height=(g=y)/s+"px"}else c.style.height&&(c.style.height="");let b=S?h.top-g-p-v.y:h.bottom+p+v.y,O=x+m;if(f.overlap!==!0)for(let T of a)T.left<O&&T.right>x&&T.top<b+g&&T.bottom>b&&(b=S?T.top-g-2-p:T.bottom+p+2);if(this.position=="absolute"?(c.style.top=(b-r.parent.top)/s+"px",Ob(c,(x-r.parent.left)/i)):(c.style.top=b/s+"px",Ob(c,x/i)),d){let T=h.left+(w?v.x:-v.x)-(x+14-7);d.style.left=T/i+"px"}f.overlap!==!0&&a.push({left:x,top:b,right:O,bottom:b+g}),c.classList.toggle("cm-tooltip-above",S),c.classList.toggle("cm-tooltip-below",!S),f.positioned&&f.positioned(r.space)}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let r of this.manager.tooltipViews)r.dom.style.top=Af}},{eventObservers:{scroll(){this.maybeMeasure()}}});function Ob(r,e){let t=parseInt(r.style.left,10);(isNaN(t)||Math.abs(e-t)>1)&&(r.style.left=e+"px")}const Fj=Be.baseTheme({".cm-tooltip":{zIndex:500,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"7px",width:`${7*2}px`,position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent"},".cm-tooltip-above &":{bottom:"-7px","&:before":{borderTop:"7px solid #bbb"},"&:after":{borderTop:"7px solid #f5f5f5",bottom:"1px"}},".cm-tooltip-below &":{top:"-7px","&:before":{borderBottom:"7px solid #bbb"},"&:after":{borderBottom:"7px solid #f5f5f5",top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),$j={x:0,y:0},Sx=Le.define({enables:[kx,Fj]}),qd=Le.define({combine:r=>r.reduce((e,t)=>e.concat(t),[])});class U0{static create(e){return new U0(e)}constructor(e){this.view=e,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new i4(e,qd,(t,n)=>this.createHostedView(t,n),t=>t.dom.remove())}createHostedView(e,t){let n=e.create(this.view);return n.dom.classList.add("cm-tooltip-section"),this.dom.insertBefore(n.dom,t?t.dom.nextSibling:this.dom.firstChild),this.mounted&&n.mount&&n.mount(this.view),n}mount(e){for(let t of this.manager.tooltipViews)t.mount&&t.mount(e);this.mounted=!0}positioned(e){for(let t of this.manager.tooltipViews)t.positioned&&t.positioned(e)}update(e){this.manager.update(e)}destroy(){var e;for(let t of this.manager.tooltipViews)(e=t.destroy)===null||e===void 0||e.call(t)}passProp(e){let t;for(let n of this.manager.tooltipViews){let i=n[e];if(i!==void 0){if(t===void 0)t=i;else if(t!==i)return}}return t}get offset(){return this.passProp("offset")}get getCoords(){return this.passProp("getCoords")}get overlap(){return this.passProp("overlap")}get resize(){return this.passProp("resize")}}const Nj=Sx.compute([qd],r=>{let e=r.facet(qd);return e.length===0?null:{pos:Math.min(...e.map(t=>t.pos)),end:Math.max(...e.map(t=>{var n;return(n=t.end)!==null&&n!==void 0?n:t.pos})),create:U0.create,above:e[0].above,arrow:e.some(t=>t.arrow)}});class Dj{constructor(e,t,n,i,s){this.view=e,this.source=t,this.field=n,this.setHover=i,this.hoverTime=s,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:e.dom,time:0},this.checkHover=this.checkHover.bind(this),e.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),e.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout(()=>this.startHover(),20))}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=-1,this.active.length)return;let e=Date.now()-this.lastMove.time;e<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-e):this.startHover()}startHover(){clearTimeout(this.restartTimeout);let{view:e,lastMove:t}=this,n=e.docView.nearest(t.target);if(!n)return;let i,s=1;if(n instanceof Ca)i=n.posAtStart;else{if(i=e.posAtCoords(t),i==null)return;let o=e.coordsAtPos(i);if(!o||t.y<o.top||t.y>o.bottom||t.x<o.left-e.defaultCharacterWidth||t.x>o.right+e.defaultCharacterWidth)return;let l=e.bidiSpans(e.state.doc.lineAt(i)).find(c=>c.from<=i&&c.to>=i),f=l&&l.dir==Rt.RTL?-1:1;s=t.x<o.left?-f:f}let a=this.source(e,i,s);if(a!=null&&a.then){let o=this.pending={pos:i};a.then(l=>{this.pending==o&&(this.pending=null,l&&!(Array.isArray(l)&&!l.length)&&e.dispatch({effects:this.setHover.of(Array.isArray(l)?l:[l])}))},l=>Jr(e.state,l,"hover tooltip"))}else a&&!(Array.isArray(a)&&!a.length)&&e.dispatch({effects:this.setHover.of(Array.isArray(a)?a:[a])})}get tooltip(){let e=this.view.plugin(kx),t=e?e.manager.tooltips.findIndex(n=>n.create==U0.create):-1;return t>-1?e.manager.tooltipViews[t]:null}mousemove(e){var t,n;this.lastMove={x:e.clientX,y:e.clientY,target:e.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime));let{active:i,tooltip:s}=this;if(i.length&&s&&!Mj(s.dom,e)||this.pending){let{pos:a}=i[0]||this.pending,o=(n=(t=i[0])===null||t===void 0?void 0:t.end)!==null&&n!==void 0?n:a;(a==o?this.view.posAtCoords(this.lastMove)!=a:!Ij(this.view,a,o,e.clientX,e.clientY))&&(this.view.dispatch({effects:this.setHover.of([])}),this.pending=null)}}mouseleave(e){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1;let{active:t}=this;if(t.length){let{tooltip:n}=this;n&&n.dom.contains(e.relatedTarget)?this.watchTooltipLeave(n.dom):this.view.dispatch({effects:this.setHover.of([])})}}watchTooltipLeave(e){let t=n=>{e.removeEventListener("mouseleave",t),this.active.length&&!this.view.dom.contains(n.relatedTarget)&&this.view.dispatch({effects:this.setHover.of([])})};e.addEventListener("mouseleave",t)}destroy(){clearTimeout(this.hoverTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}}const du=4;function Mj(r,e){let{left:t,right:n,top:i,bottom:s}=r.getBoundingClientRect(),a;if(a=r.querySelector(".cm-tooltip-arrow")){let o=a.getBoundingClientRect();i=Math.min(o.top,i),s=Math.max(o.bottom,s)}return e.clientX>=t-du&&e.clientX<=n+du&&e.clientY>=i-du&&e.clientY<=s+du}function Ij(r,e,t,n,i,s){let a=r.scrollDOM.getBoundingClientRect(),o=r.documentTop+r.documentPadding.top+r.contentHeight;if(a.left>n||a.right<n||a.top>i||Math.min(a.bottom,o)<i)return!1;let l=r.posAtCoords({x:n,y:i},!1);return l>=e&&l<=t}function Lj(r,e={}){let t=ot.define(),n=Cr.define({create(){return[]},update(i,s){if(i.length&&(e.hideOnChange&&(s.docChanged||s.selection)?i=[]:e.hideOn&&(i=i.filter(a=>!e.hideOn(s,a))),s.docChanged)){let a=[];for(let o of i){let l=s.changes.mapPos(o.pos,-1,hn.TrackDel);if(l!=null){let f=Object.assign(Object.create(null),o);f.pos=l,f.end!=null&&(f.end=s.changes.mapPos(f.end)),a.push(f)}}i=a}for(let a of s.effects)a.is(t)&&(i=a.value),a.is(Bj)&&(i=[]);return i},provide:i=>qd.from(i)});return{active:n,extension:[n,gr.define(i=>new Dj(i,r,n,t,e.hoverTime||300)),Nj]}}function s4(r,e){let t=r.plugin(kx);if(!t)return null;let n=t.manager.tooltips.indexOf(e);return n<0?null:t.manager.tooltipViews[n]}const Bj=ot.define(),xb=Le.define({combine(r){let e,t;for(let n of r)e=e||n.topContainer,t=t||n.bottomContainer;return{topContainer:e,bottomContainer:t}}});function zc(r,e){let t=r.plugin(a4),n=t?t.specs.indexOf(e):-1;return n>-1?t.panels[n]:null}const a4=gr.fromClass(class{constructor(r){this.input=r.state.facet(Gc),this.specs=this.input.filter(t=>t),this.panels=this.specs.map(t=>t(r));let e=r.state.facet(xb);this.top=new pu(r,!0,e.topContainer),this.bottom=new pu(r,!1,e.bottomContainer),this.top.sync(this.panels.filter(t=>t.top)),this.bottom.sync(this.panels.filter(t=>!t.top));for(let t of this.panels)t.dom.classList.add("cm-panel"),t.mount&&t.mount()}update(r){let e=r.state.facet(xb);this.top.container!=e.topContainer&&(this.top.sync([]),this.top=new pu(r.view,!0,e.topContainer)),this.bottom.container!=e.bottomContainer&&(this.bottom.sync([]),this.bottom=new pu(r.view,!1,e.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let t=r.state.facet(Gc);if(t!=this.input){let n=t.filter(l=>l),i=[],s=[],a=[],o=[];for(let l of n){let f=this.specs.indexOf(l),c;f<0?(c=l(r.view),o.push(c)):(c=this.panels[f],c.update&&c.update(r)),i.push(c),(c.top?s:a).push(c)}this.specs=n,this.panels=i,this.top.sync(s),this.bottom.sync(a);for(let l of o)l.dom.classList.add("cm-panel"),l.mount&&l.mount()}else for(let n of this.panels)n.update&&n.update(r)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:r=>Be.scrollMargins.of(e=>{let t=e.plugin(r);return t&&{top:t.top.scrollMargin(),bottom:t.bottom.scrollMargin()}})});class pu{constructor(e,t,n){this.view=e,this.top=t,this.container=n,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(e){for(let t of this.panels)t.destroy&&e.indexOf(t)<0&&t.destroy();this.panels=e,this.syncDOM()}syncDOM(){if(this.panels.length==0){this.dom&&(this.dom.remove(),this.dom=void 0);return}if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let t=this.container||this.view.dom;t.insertBefore(this.dom,this.top?t.firstChild:null)}let e=this.dom.firstChild;for(let t of this.panels)if(t.dom.parentNode==this.dom){for(;e!=t.dom;)e=vb(e);e=e.nextSibling}else this.dom.insertBefore(t.dom,e);for(;e;)e=vb(e)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(!(!this.container||this.classes==this.view.themeClasses)){for(let e of this.classes.split(" "))e&&this.container.classList.remove(e);for(let e of(this.classes=this.view.themeClasses).split(" "))e&&this.container.classList.add(e)}}}function vb(r){let e=r.nextSibling;return r.remove(),e}const Gc=Le.define({enables:a4});class Ys extends zs{compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}eq(e){return!1}destroy(e){}}Ys.prototype.elementClass="";Ys.prototype.toDOM=void 0;Ys.prototype.mapMode=hn.TrackBefore;Ys.prototype.startSide=Ys.prototype.endSide=-1;Ys.prototype.point=!0;const Gu=Le.define(),Zj=Le.define(),Wj={class:"",renderEmptyElements:!1,elementStyle:"",markers:()=>At.empty,lineMarker:()=>null,widgetMarker:()=>null,lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{}},wc=Le.define();function Uj(r){return[o4(),wc.of(Object.assign(Object.assign({},Wj),r))]}const yb=Le.define({combine:r=>r.some(e=>e)});function o4(r){return[Xj]}const Xj=gr.fromClass(class{constructor(r){this.view=r,this.prevViewport=r.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.gutters=r.state.facet(wc).map(e=>new bb(r,e));for(let e of this.gutters)this.dom.appendChild(e.dom);this.fixed=!r.state.facet(yb),this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),r.scrollDOM.insertBefore(this.dom,r.contentDOM)}update(r){if(this.updateGutters(r)){let e=this.prevViewport,t=r.view.viewport,n=Math.min(e.to,t.to)-Math.max(e.from,t.from);this.syncGutters(n<(t.to-t.from)*.8)}r.geometryChanged&&(this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px"),this.view.state.facet(yb)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":""),this.prevViewport=r.view.viewport}syncGutters(r){let e=this.dom.nextSibling;r&&this.dom.remove();let t=At.iter(this.view.state.facet(Gu),this.view.viewport.from),n=[],i=this.gutters.map(s=>new Vj(s,this.view.viewport,-this.view.documentPadding.top));for(let s of this.view.viewportLineBlocks)if(n.length&&(n=[]),Array.isArray(s.type)){let a=!0;for(let o of s.type)if(o.type==$n.Text&&a){Xg(t,n,o.from);for(let l of i)l.line(this.view,o,n);a=!1}else if(o.widget)for(let l of i)l.widget(this.view,o)}else if(s.type==$n.Text){Xg(t,n,s.from);for(let a of i)a.line(this.view,s,n)}else if(s.widget)for(let a of i)a.widget(this.view,s);for(let s of i)s.finish();r&&this.view.scrollDOM.insertBefore(this.dom,e)}updateGutters(r){let e=r.startState.facet(wc),t=r.state.facet(wc),n=r.docChanged||r.heightChanged||r.viewportChanged||!At.eq(r.startState.facet(Gu),r.state.facet(Gu),r.view.viewport.from,r.view.viewport.to);if(e==t)for(let i of this.gutters)i.update(r)&&(n=!0);else{n=!0;let i=[];for(let s of t){let a=e.indexOf(s);a<0?i.push(new bb(this.view,s)):(this.gutters[a].update(r),i.push(this.gutters[a]))}for(let s of this.gutters)s.dom.remove(),i.indexOf(s)<0&&s.destroy();for(let s of i)this.dom.appendChild(s.dom);this.gutters=i}return n}destroy(){for(let r of this.gutters)r.destroy();this.dom.remove()}},{provide:r=>Be.scrollMargins.of(e=>{let t=e.plugin(r);return!t||t.gutters.length==0||!t.fixed?null:e.textDirection==Rt.LTR?{left:t.dom.offsetWidth*e.scaleX}:{right:t.dom.offsetWidth*e.scaleX}})});function wb(r){return Array.isArray(r)?r:[r]}function Xg(r,e,t){for(;r.value&&r.from<=t;)r.from==t&&e.push(r.value),r.next()}class Vj{constructor(e,t,n){this.gutter=e,this.height=n,this.i=0,this.cursor=At.iter(e.markers,t.from)}addElement(e,t,n){let{gutter:i}=this,s=(t.top-this.height)/e.scaleY,a=t.height/e.scaleY;if(this.i==i.elements.length){let o=new l4(e,a,s,n);i.elements.push(o),i.dom.appendChild(o.dom)}else i.elements[this.i].update(e,a,s,n);this.height=t.bottom,this.i++}line(e,t,n){let i=[];Xg(this.cursor,i,t.from),n.length&&(i=i.concat(n));let s=this.gutter.config.lineMarker(e,t,i);s&&i.unshift(s);let a=this.gutter;i.length==0&&!a.config.renderEmptyElements||this.addElement(e,t,i)}widget(e,t){let n=this.gutter.config.widgetMarker(e,t.widget,t),i=n?[n]:null;for(let s of e.state.facet(Zj)){let a=s(e,t.widget,t);a&&(i||(i=[])).push(a)}i&&this.addElement(e,t,i)}finish(){let e=this.gutter;for(;e.elements.length>this.i;){let t=e.elements.pop();e.dom.removeChild(t.dom),t.destroy()}}}class bb{constructor(e,t){this.view=e,this.config=t,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let n in t.domEventHandlers)this.dom.addEventListener(n,i=>{let s=i.target,a;if(s!=this.dom&&this.dom.contains(s)){for(;s.parentNode!=this.dom;)s=s.parentNode;let l=s.getBoundingClientRect();a=(l.top+l.bottom)/2}else a=i.clientY;let o=e.lineBlockAtHeight(a-e.documentTop);t.domEventHandlers[n](e,o,i)&&i.preventDefault()});this.markers=wb(t.markers(e)),t.initialSpacer&&(this.spacer=new l4(e,0,0,[t.initialSpacer(e)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(e){let t=this.markers;if(this.markers=wb(this.config.markers(e.view)),this.spacer&&this.config.updateSpacer){let i=this.config.updateSpacer(this.spacer.markers[0],e);i!=this.spacer.markers[0]&&this.spacer.update(e.view,0,0,[i])}let n=e.view.viewport;return!At.eq(this.markers,t,n.from,n.to)||(this.config.lineMarkerChange?this.config.lineMarkerChange(e):!1)}destroy(){for(let e of this.elements)e.destroy()}}class l4{constructor(e,t,n,i){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(e,t,n,i)}update(e,t,n,i){this.height!=t&&(this.height=t,this.dom.style.height=t+"px"),this.above!=n&&(this.dom.style.marginTop=(this.above=n)?n+"px":""),qj(this.markers,i)||this.setMarkers(e,i)}setMarkers(e,t){let n="cm-gutterElement",i=this.dom.firstChild;for(let s=0,a=0;;){let o=a,l=s<t.length?t[s++]:null,f=!1;if(l){let c=l.elementClass;c&&(n+=" "+c);for(let h=a;h<this.markers.length;h++)if(this.markers[h].compare(l)){o=h,f=!0;break}}else o=this.markers.length;for(;a<o;){let c=this.markers[a++];if(c.toDOM){c.destroy(i);let h=i.nextSibling;i.remove(),i=h}}if(!l)break;l.toDOM&&(f?i=i.nextSibling:this.dom.insertBefore(l.toDOM(e),i)),f&&a++}this.dom.className=n,this.markers=t}destroy(){this.setMarkers(null,[])}}function qj(r,e){if(r.length!=e.length)return!1;for(let t=0;t<r.length;t++)if(!r[t].compare(e[t]))return!1;return!0}const jj=Le.define(),zj=Le.define(),pl=Le.define({combine(r){return $s(r,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(e,t){let n=Object.assign({},e);for(let i in t){let s=n[i],a=t[i];n[i]=s?(o,l,f)=>s(o,l,f)||a(o,l,f):a}return n}})}});class Ip extends Ys{constructor(e){super(),this.number=e}eq(e){return this.number==e.number}toDOM(){return document.createTextNode(this.number)}}function Lp(r,e){return r.state.facet(pl).formatNumber(e,r.state)}const Gj=wc.compute([pl],r=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers(e){return e.state.facet(jj)},lineMarker(e,t,n){return n.some(i=>i.toDOM)?null:new Ip(Lp(e,e.state.doc.lineAt(t.from).number))},widgetMarker:(e,t,n)=>{for(let i of e.state.facet(zj)){let s=i(e,t,n);if(s)return s}return null},lineMarkerChange:e=>e.startState.facet(pl)!=e.state.facet(pl),initialSpacer(e){return new Ip(Lp(e,_b(e.state.doc.lines)))},updateSpacer(e,t){let n=Lp(t.view,_b(t.view.state.doc.lines));return n==e.number?e:new Ip(n)},domEventHandlers:r.facet(pl).domEventHandlers}));function Hj(r={}){return[pl.of(r),o4(),Gj]}function _b(r){let e=9;for(;e<r;)e=e*10+9;return e}const Yj=new class extends Ys{constructor(){super(...arguments),this.elementClass="cm-activeLineGutter"}},Kj=Gu.compute(["selection"],r=>{let e=[],t=-1;for(let n of r.selection.ranges){let i=r.doc.lineAt(n.head).from;i>t&&(t=i,e.push(Yj.range(i)))}return At.of(e)});function Jj(){return Kj}const ez=1024;let tz=0,Bp=class{constructor(e,t){this.from=e,this.to=t}},Qt=class{constructor(e={}){this.id=tz++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof e!="function"&&(e=Ss.match(e)),t=>{let n=e(t);return n===void 0?null:[this,n]}}};Qt.closedBy=new Qt({deserialize:r=>r.split(" ")});Qt.openedBy=new Qt({deserialize:r=>r.split(" ")});Qt.group=new Qt({deserialize:r=>r.split(" ")});Qt.isolate=new Qt({deserialize:r=>{if(r&&r!="rtl"&&r!="ltr"&&r!="auto")throw new RangeError("Invalid value for isolate: "+r);return r||"auto"}});Qt.contextHash=new Qt({perNode:!0});Qt.lookAhead=new Qt({perNode:!0});Qt.mounted=new Qt({perNode:!0});let jd=class{constructor(e,t,n){this.tree=e,this.overlay=t,this.parser=n}static get(e){return e&&e.props&&e.props[Qt.mounted.id]}};const rz=Object.create(null);let Ss=class f4{constructor(e,t,n,i=0){this.name=e,this.props=t,this.id=n,this.flags=i}static define(e){let t=e.props&&e.props.length?Object.create(null):rz,n=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(e.name==null?8:0),i=new f4(e.name||"",t,e.id,n);if(e.props){for(let s of e.props)if(Array.isArray(s)||(s=s(i)),s){if(s[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");t[s[0].id]=s[1]}}return i}prop(e){return this.props[e.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(e){if(typeof e=="string"){if(this.name==e)return!0;let t=this.prop(Qt.group);return t?t.indexOf(e)>-1:!1}return this.id==e}static match(e){let t=Object.create(null);for(let n in e)for(let i of n.split(" "))t[i]=e[n];return n=>{for(let i=n.prop(Qt.group),s=-1;s<(i?i.length:0);s++){let a=t[s<0?n.name:i[s]];if(a)return a}}}};Ss.none=new Ss("",Object.create(null),0,8);const mu=new WeakMap,kb=new WeakMap;var sn;(function(r){r[r.ExcludeBuffers=1]="ExcludeBuffers",r[r.IncludeAnonymous=2]="IncludeAnonymous",r[r.IgnoreMounts=4]="IgnoreMounts",r[r.IgnoreOverlays=8]="IgnoreOverlays"})(sn||(sn={}));let ri=class Vg{constructor(e,t,n,i,s){if(this.type=e,this.children=t,this.positions=n,this.length=i,this.props=null,s&&s.length){this.props=Object.create(null);for(let[a,o]of s)this.props[typeof a=="number"?a:a.id]=o}}toString(){let e=jd.get(this);if(e&&!e.overlay)return e.tree.toString();let t="";for(let n of this.children){let i=n.toString();i&&(t&&(t+=","),t+=i)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(t.length?"("+t+")":""):t}cursor(e=0){return new zg(this.topNode,e)}cursorAt(e,t=0,n=0){let i=mu.get(this)||this.topNode,s=new zg(i);return s.moveTo(e,t),mu.set(this,s._tree),s}get topNode(){return new La(this,0,0,null)}resolve(e,t=0){let n=Hc(mu.get(this)||this.topNode,e,t,!1);return mu.set(this,n),n}resolveInner(e,t=0){let n=Hc(kb.get(this)||this.topNode,e,t,!0);return kb.set(this,n),n}resolveStack(e,t=0){return az(this,e,t)}iterate(e){let{enter:t,leave:n,from:i=0,to:s=this.length}=e,a=e.mode||0,o=(a&sn.IncludeAnonymous)>0;for(let l=this.cursor(a|sn.IncludeAnonymous);;){let f=!1;if(l.from<=s&&l.to>=i&&(!o&&l.type.isAnonymous||t(l)!==!1)){if(l.firstChild())continue;f=!0}for(;f&&n&&(o||!l.type.isAnonymous)&&n(l),!l.nextSibling();){if(!l.parent())return;f=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let t in this.props)e.push([+t,this.props[t]]);return e}balance(e={}){return this.children.length<=8?this:Cx(Ss.none,this.children,this.positions,0,this.children.length,0,this.length,(t,n,i)=>new Vg(this.type,t,n,i,this.propValues),e.makeTree||((t,n,i)=>new Vg(Ss.none,t,n,i)))}static build(e){return oz(e)}};ri.empty=new ri(Ss.none,[],[],0);let nz=class c4{constructor(e,t){this.buffer=e,this.index=t}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new c4(this.buffer,this.index)}},Vl=class h4{constructor(e,t,n){this.buffer=e,this.length=t,this.set=n}get type(){return Ss.none}toString(){let e=[];for(let t=0;t<this.buffer.length;)e.push(this.childString(t)),t=this.buffer[t+3];return e.join(",")}childString(e){let t=this.buffer[e],n=this.buffer[e+3],i=this.set.types[t],s=i.name;if(/\W/.test(s)&&!i.isError&&(s=JSON.stringify(s)),e+=4,n==e)return s;let a=[];for(;e<n;)a.push(this.childString(e)),e=this.buffer[e+3];return s+"("+a.join(",")+")"}findChild(e,t,n,i,s){let{buffer:a}=this,o=-1;for(let l=e;l!=t&&!(u4(s,i,a[l+1],a[l+2])&&(o=l,n>0));l=a[l+3]);return o}slice(e,t,n){let i=this.buffer,s=new Uint16Array(t-e),a=0;for(let o=e,l=0;o<t;){s[l++]=i[o++],s[l++]=i[o++]-n;let f=s[l++]=i[o++]-n;s[l++]=i[o++]-e,a=Math.max(a,f)}return new h4(s,a,this.set)}};function u4(r,e,t,n){switch(r){case-2:return t<e;case-1:return n>=e&&t<e;case 0:return t<e&&n>e;case 1:return t<=e&&n>e;case 2:return n>e;case 4:return!0}}function Hc(r,e,t,n){for(var i;r.from==r.to||(t<1?r.from>=e:r.from>e)||(t>-1?r.to<=e:r.to<e);){let a=!n&&r instanceof La&&r.index<0?null:r.parent;if(!a)return r;r=a}let s=n?0:sn.IgnoreOverlays;if(n)for(let a=r,o=a.parent;o;a=o,o=a.parent)a instanceof La&&a.index<0&&((i=o.enter(e,t,s))===null||i===void 0?void 0:i.from)!=a.from&&(r=o);for(;;){let a=r.enter(e,t,s);if(!a)return r;r=a}}let d4=class{cursor(e=0){return new zg(this,e)}getChild(e,t=null,n=null){let i=Sb(this,e,t,n);return i.length?i[0]:null}getChildren(e,t=null,n=null){return Sb(this,e,t,n)}resolve(e,t=0){return Hc(this,e,t,!1)}resolveInner(e,t=0){return Hc(this,e,t,!0)}matchContext(e){return qg(this.parent,e)}enterUnfinishedNodesBefore(e){let t=this.childBefore(e),n=this;for(;t;){let i=t.lastChild;if(!i||i.to!=t.to)break;i.type.isError&&i.from==i.to?(n=t,t=i.prevSibling):t=i}return n}get node(){return this}get next(){return this.parent}},La=class Hu extends d4{constructor(e,t,n,i){super(),this._tree=e,this.from=t,this.index=n,this._parent=i}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,t,n,i,s=0){for(let a=this;;){for(let{children:o,positions:l}=a._tree,f=t>0?o.length:-1;e!=f;e+=t){let c=o[e],h=l[e]+a.from;if(u4(i,n,h,h+c.length)){if(c instanceof Vl){if(s&sn.ExcludeBuffers)continue;let u=c.findChild(0,c.buffer.length,t,n-h,i);if(u>-1)return new jg(new iz(a,c,e,h),null,u)}else if(s&sn.IncludeAnonymous||!c.type.isAnonymous||Tx(c)){let u;if(!(s&sn.IgnoreMounts)&&(u=jd.get(c))&&!u.overlay)return new Hu(u.tree,h,e,a);let d=new Hu(c,h,e,a);return s&sn.IncludeAnonymous||!d.type.isAnonymous?d:d.nextChild(t<0?c.children.length-1:0,t,n,i)}}}if(s&sn.IncludeAnonymous||!a.type.isAnonymous||(a.index>=0?e=a.index+t:e=t<0?-1:a._parent._tree.children.length,a=a._parent,!a))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}enter(e,t,n=0){let i;if(!(n&sn.IgnoreOverlays)&&(i=jd.get(this._tree))&&i.overlay){let s=e-this.from;for(let{from:a,to:o}of i.overlay)if((t>0?a<=s:a<s)&&(t<0?o>=s:o>s))return new Hu(i.tree,i.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,t,n)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}};function Sb(r,e,t,n){let i=r.cursor(),s=[];if(!i.firstChild())return s;if(t!=null){for(let a=!1;!a;)if(a=i.type.is(t),!i.nextSibling())return s}for(;;){if(n!=null&&i.type.is(n))return s;if(i.type.is(e)&&s.push(i.node),!i.nextSibling())return n==null?s:[]}}function qg(r,e,t=e.length-1){for(let n=r;t>=0;n=n.parent){if(!n)return!1;if(!n.type.isAnonymous){if(e[t]&&e[t]!=n.name)return!1;t--}}return!0}let iz=class{constructor(e,t,n,i){this.parent=e,this.buffer=t,this.index=n,this.start=i}},jg=class Yf extends d4{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(e,t,n){super(),this.context=e,this._parent=t,this.index=n,this.type=e.buffer.set.types[e.buffer.buffer[n]]}child(e,t,n){let{buffer:i}=this.context,s=i.findChild(this.index+4,i.buffer[this.index+3],e,t-this.context.start,n);return s<0?null:new Yf(this.context,this,s)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}enter(e,t,n=0){if(n&sn.ExcludeBuffers)return null;let{buffer:i}=this.context,s=i.findChild(this.index+4,i.buffer[this.index+3],t>0?1:-1,e-this.context.start,t);return s<0?null:new Yf(this.context,this,s)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,t=e.buffer[this.index+3];return t<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new Yf(this.context,this._parent,t):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,t=this._parent?this._parent.index+4:0;return this.index==t?this.externalSibling(-1):new Yf(this.context,this._parent,e.findChild(t,this.index,-1,0,4))}get tree(){return null}toTree(){let e=[],t=[],{buffer:n}=this.context,i=this.index+4,s=n.buffer[this.index+3];if(s>i){let a=n.buffer[this.index+1];e.push(n.slice(i,s,a)),t.push(0)}return new ri(this.type,e,t,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}};function p4(r){if(!r.length)return null;let e=0,t=r[0];for(let s=1;s<r.length;s++){let a=r[s];(a.from>t.from||a.to<t.to)&&(t=a,e=s)}let n=t instanceof La&&t.index<0?null:t.parent,i=r.slice();return n?i[e]=n:i.splice(e,1),new sz(i,t)}let sz=class{constructor(e,t){this.heads=e,this.node=t}get next(){return p4(this.heads)}};function az(r,e,t){let n=r.resolveInner(e,t),i=null;for(let s=n instanceof La?n:n.context.parent;s;s=s.parent)if(s.index<0){let a=s.parent;(i||(i=[n])).push(a.resolve(e,t)),s=a}else{let a=jd.get(s.tree);if(a&&a.overlay&&a.overlay[0].from<=e&&a.overlay[a.overlay.length-1].to>=e){let o=new La(a.tree,a.overlay[0].from+s.from,-1,s);(i||(i=[n])).push(Hc(o,e,t,!1))}}return i?p4(i):n}let zg=class{get name(){return this.type.name}constructor(e,t=0){if(this.mode=t,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,e instanceof La)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let n=e._parent;n;n=n._parent)this.stack.unshift(n.index);this.bufferNode=e,this.yieldBuf(e.index)}}yieldNode(e){return e?(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0):!1}yieldBuf(e,t){this.index=e;let{start:n,buffer:i}=this.buffer;return this.type=t||i.set.types[i.buffer[e]],this.from=n+i.buffer[e+1],this.to=n+i.buffer[e+2],!0}yield(e){return e?e instanceof La?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,t,n){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,t,n,this.mode));let{buffer:i}=this.buffer,s=i.findChild(this.index+4,i.buffer[this.index+3],e,t-this.buffer.start,n);return s<0?!1:(this.stack.push(this.index),this.yieldBuf(s))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,t,n=this.mode){return this.buffer?n&sn.ExcludeBuffers?!1:this.enterChild(1,e,t):this.yield(this._tree.enter(e,t,n))}parent(){if(!this.buffer)return this.yieldNode(this.mode&sn.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&sn.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode)):!1;let{buffer:t}=this.buffer,n=this.stack.length-1;if(e<0){let i=n<0?0:this.stack[n]+4;if(this.index!=i)return this.yieldBuf(t.findChild(i,this.index,-1,0,4))}else{let i=t.buffer[this.index+3];if(i<(n<0?t.buffer.length:t.buffer[this.stack[n]+3]))return this.yieldBuf(i)}return n<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let t,n,{buffer:i}=this;if(i){if(e>0){if(this.index<i.buffer.buffer.length)return!1}else for(let s=0;s<this.index;s++)if(i.buffer.buffer[s+3]<this.index)return!1;({index:t,parent:n}=i)}else({index:t,_parent:n}=this._tree);for(;n;{index:t,_parent:n}=n)if(t>-1)for(let s=t+e,a=e<0?-1:n._tree.children.length;s!=a;s+=e){let o=n._tree.children[s];if(this.mode&sn.IncludeAnonymous||o instanceof Vl||!o.type.isAnonymous||Tx(o))return!1}return!0}move(e,t){if(t&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,t=0){for(;(this.from==this.to||(t<1?this.from>=e:this.from>e)||(t>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,t););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,t=null,n=0;if(e&&e.context==this.buffer)e:for(let i=this.index,s=this.stack.length;s>=0;){for(let a=e;a;a=a._parent)if(a.index==i){if(i==this.index)return a;t=a,n=s+1;break e}i=this.stack[--s]}for(let i=n;i<this.stack.length;i++)t=new jg(this.buffer,t,this.stack[i]);return this.bufferNode=new jg(this.buffer,t,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,t){for(let n=0;;){let i=!1;if(this.type.isAnonymous||e(this)!==!1){if(this.firstChild()){n++;continue}this.type.isAnonymous||(i=!0)}for(;;){if(i&&t&&t(this),i=this.type.isAnonymous,!n)return;if(this.nextSibling())break;this.parent(),n--,i=!0}}}matchContext(e){if(!this.buffer)return qg(this.node.parent,e);let{buffer:t}=this.buffer,{types:n}=t.set;for(let i=e.length-1,s=this.stack.length-1;i>=0;s--){if(s<0)return qg(this._tree,e,i);let a=n[t.buffer[this.stack[s]]];if(!a.isAnonymous){if(e[i]&&e[i]!=a.name)return!1;i--}}return!0}};function Tx(r){return r.children.some(e=>e instanceof Vl||!e.type.isAnonymous||Tx(e))}function oz(r){var e;let{buffer:t,nodeSet:n,maxBufferLength:i=ez,reused:s=[],minRepeatType:a=n.types.length}=r,o=Array.isArray(t)?new nz(t,t.length):t,l=n.types,f=0,c=0;function h(y,b,O,T,k,Q){let{id:A,start:_,end:N,size:U}=o,z=c,K=f;for(;U<0;)if(o.next(),U==-1){let ae=s[A];O.push(ae),T.push(_-y);return}else if(U==-3){f=A;return}else if(U==-4){c=A;return}else throw new RangeError(`Unrecognized record size: ${U}`);let re=l[A],ge,V,he=_-y;if(N-_<=i&&(V=g(o.pos-b,k))){let ae=new Uint16Array(V.size-V.skip),E=o.pos-V.size,L=ae.length;for(;o.pos>E;)L=v(V.start,ae,L);ge=new Vl(ae,N-V.start,n),he=V.start-y}else{let ae=o.pos-U;o.next();let E=[],L=[],I=A>=a?A:-1,Z=0,ee=N;for(;o.pos>ae;)I>=0&&o.id==I&&o.size>=0?(o.end<=ee-i&&(p(E,L,_,Z,o.end,ee,I,z,K),Z=E.length,ee=o.end),o.next()):Q>2500?u(_,ae,E,L):h(_,ae,E,L,I,Q+1);if(I>=0&&Z>0&&Z<E.length&&p(E,L,_,Z,_,ee,I,z,K),E.reverse(),L.reverse(),I>-1&&Z>0){let ne=d(re,K);ge=Cx(re,E,L,0,E.length,0,N-_,ne,ne)}else ge=m(re,E,L,N-_,z-N,K)}O.push(ge),T.push(he)}function u(y,b,O,T){let k=[],Q=0,A=-1;for(;o.pos>b;){let{id:_,start:N,end:U,size:z}=o;if(z>4)o.next();else{if(A>-1&&N<A)break;A<0&&(A=U-i),k.push(_,N,U),Q++,o.next()}}if(Q){let _=new Uint16Array(Q*4),N=k[k.length-2];for(let U=k.length-3,z=0;U>=0;U-=3)_[z++]=k[U],_[z++]=k[U+1]-N,_[z++]=k[U+2]-N,_[z++]=z;O.push(new Vl(_,k[2]-N,n)),T.push(N-y)}}function d(y,b){return(O,T,k)=>{let Q=0,A=O.length-1,_,N;if(A>=0&&(_=O[A])instanceof ri){if(!A&&_.type==y&&_.length==k)return _;(N=_.prop(Qt.lookAhead))&&(Q=T[A]+_.length+N)}return m(y,O,T,k,Q,b)}}function p(y,b,O,T,k,Q,A,_,N){let U=[],z=[];for(;y.length>T;)U.push(y.pop()),z.push(b.pop()+O-k);y.push(m(n.types[A],U,z,Q-k,_-Q,N)),b.push(k-O)}function m(y,b,O,T,k,Q,A){if(Q){let _=[Qt.contextHash,Q];A=A?[_].concat(A):[_]}if(k>25){let _=[Qt.lookAhead,k];A=A?[_].concat(A):[_]}return new ri(y,b,O,T,A)}function g(y,b){let O=o.fork(),T=0,k=0,Q=0,A=O.end-i,_={size:0,start:0,skip:0};e:for(let N=O.pos-y;O.pos>N;){let U=O.size;if(O.id==b&&U>=0){_.size=T,_.start=k,_.skip=Q,Q+=4,T+=4,O.next();continue}let z=O.pos-U;if(U<0||z<N||O.start<A)break;let K=O.id>=a?4:0,re=O.start;for(O.next();O.pos>z;){if(O.size<0)if(O.size==-3)K+=4;else break e;else O.id>=a&&(K+=4);O.next()}k=re,T+=U,Q+=K}return(b<0||T==y)&&(_.size=T,_.start=k,_.skip=Q),_.size>4?_:void 0}function v(y,b,O){let{id:T,start:k,end:Q,size:A}=o;if(o.next(),A>=0&&T<a){let _=O;if(A>4){let N=o.pos-(A-4);for(;o.pos>N;)O=v(y,b,O)}b[--O]=_,b[--O]=Q-y,b[--O]=k-y,b[--O]=T}else A==-3?f=T:A==-4&&(c=T);return O}let w=[],x=[];for(;o.pos>0;)h(r.start||0,r.bufferStart||0,w,x,-1,0);let S=(e=r.length)!==null&&e!==void 0?e:w.length?x[0]+w[0].length:0;return new ri(l[r.topID],w.reverse(),x.reverse(),S)}const Tb=new WeakMap;function Yu(r,e){if(!r.isAnonymous||e instanceof Vl||e.type!=r)return 1;let t=Tb.get(e);if(t==null){t=1;for(let n of e.children){if(n.type!=r||!(n instanceof ri)){t=1;break}t+=Yu(r,n)}Tb.set(e,t)}return t}function Cx(r,e,t,n,i,s,a,o,l){let f=0;for(let p=n;p<i;p++)f+=Yu(r,e[p]);let c=Math.ceil(f*1.5/8),h=[],u=[];function d(p,m,g,v,w){for(let x=g;x<v;){let S=x,y=m[x],b=Yu(r,p[x]);for(x++;x<v;x++){let O=Yu(r,p[x]);if(b+O>=c)break;b+=O}if(x==S+1){if(b>c){let O=p[S];d(O.children,O.positions,0,O.children.length,m[S]+w);continue}h.push(p[S])}else{let O=m[x-1]+p[x-1].length-y;h.push(Cx(r,p,m,S,x,y,O,null,l))}u.push(y+w-s)}}return d(e,t,n,i,0),(o||l)(h,u,a)}let Ku=class Gg{constructor(e,t,n,i,s=!1,a=!1){this.from=e,this.to=t,this.tree=n,this.offset=i,this.open=(s?1:0)|(a?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(e,t=[],n=!1){let i=[new Gg(0,e.length,e,0,!1,n)];for(let s of t)s.to>e.length&&i.push(s);return i}static applyChanges(e,t,n=128){if(!t.length)return e;let i=[],s=1,a=e.length?e[0]:null;for(let o=0,l=0,f=0;;o++){let c=o<t.length?t[o]:null,h=c?c.fromA:1e9;if(h-l>=n)for(;a&&a.from<h;){let u=a;if(l>=u.from||h<=u.to||f){let d=Math.max(u.from,l)-f,p=Math.min(u.to,h)-f;u=d>=p?null:new Gg(d,p,u.tree,u.offset+f,o>0,!!c)}if(u&&i.push(u),a.to>h)break;a=s<e.length?e[s++]:null}if(!c)break;l=c.toA,f=c.toA-c.toB}return i}},lz=class{startParse(e,t,n){return typeof e=="string"&&(e=new fz(e)),n=n?n.length?n.map(i=>new Bp(i.from,i.to)):[new Bp(0,0)]:[new Bp(0,e.length)],this.createParse(e,t||[],n)}parse(e,t,n){let i=this.startParse(e,t,n);for(;;){let s=i.advance();if(s)return s}}},fz=class{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,t){return this.string.slice(e,t)}};new Qt({perNode:!0});let cz=0,qr=class{constructor(e={}){this.id=cz++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof e!="function"&&(e=Hg.match(e)),t=>{let n=e(t);return n===void 0?null:[this,n]}}};qr.closedBy=new qr({deserialize:r=>r.split(" ")});qr.openedBy=new qr({deserialize:r=>r.split(" ")});qr.group=new qr({deserialize:r=>r.split(" ")});qr.isolate=new qr({deserialize:r=>{if(r&&r!="rtl"&&r!="ltr"&&r!="auto")throw new RangeError("Invalid value for isolate: "+r);return r||"auto"}});qr.contextHash=new qr({perNode:!0});qr.lookAhead=new qr({perNode:!0});qr.mounted=new qr({perNode:!0});const hz=Object.create(null);let Hg=class m4{constructor(e,t,n,i=0){this.name=e,this.props=t,this.id=n,this.flags=i}static define(e){let t=e.props&&e.props.length?Object.create(null):hz,n=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(e.name==null?8:0),i=new m4(e.name||"",t,e.id,n);if(e.props){for(let s of e.props)if(Array.isArray(s)||(s=s(i)),s){if(s[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");t[s[0].id]=s[1]}}return i}prop(e){return this.props[e.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(e){if(typeof e=="string"){if(this.name==e)return!0;let t=this.prop(qr.group);return t?t.indexOf(e)>-1:!1}return this.id==e}static match(e){let t=Object.create(null);for(let n in e)for(let i of n.split(" "))t[i]=e[n];return n=>{for(let i=n.prop(qr.group),s=-1;s<(i?i.length:0);s++){let a=t[s<0?n.name:i[s]];if(a)return a}}}};Hg.none=new Hg("",Object.create(null),0,8);var Cb;(function(r){r[r.ExcludeBuffers=1]="ExcludeBuffers",r[r.IncludeAnonymous=2]="IncludeAnonymous",r[r.IgnoreMounts=4]="IgnoreMounts",r[r.IgnoreOverlays=8]="IgnoreOverlays"})(Cb||(Cb={}));new qr({perNode:!0});let uz=0;class bi{constructor(e,t,n,i){this.name=e,this.set=t,this.base=n,this.modified=i,this.id=uz++}toString(){let{name:e}=this;for(let t of this.modified)t.name&&(e=`${t.name}(${e})`);return e}static define(e,t){let n=typeof e=="string"?e:"?";if(e instanceof bi&&(t=e),t!=null&&t.base)throw new Error("Can not derive from a modified tag");let i=new bi(n,[],null,[]);if(i.set.push(i),t)for(let s of t.set)i.set.push(s);return i}static defineModifier(e){let t=new zd(e);return n=>n.modified.indexOf(t)>-1?n:zd.get(n.base||n,n.modified.concat(t).sort((i,s)=>i.id-s.id))}}let dz=0;class zd{constructor(e){this.name=e,this.instances=[],this.id=dz++}static get(e,t){if(!t.length)return e;let n=t[0].instances.find(o=>o.base==e&&pz(t,o.modified));if(n)return n;let i=[],s=new bi(e.name,i,e,t);for(let o of t)o.instances.push(s);let a=mz(t);for(let o of e.set)if(!o.modified.length)for(let l of a)i.push(zd.get(o,l));return s}}function pz(r,e){return r.length==e.length&&r.every((t,n)=>t==e[n])}function mz(r){let e=[[]];for(let t=0;t<r.length;t++)for(let n=0,i=e.length;n<i;n++)e.push(e[n].concat(r[t]));return e.sort((t,n)=>n.length-t.length)}function sa(r){let e=Object.create(null);for(let t in r){let n=r[t];Array.isArray(n)||(n=[n]);for(let i of t.split(" "))if(i){let s=[],a=2,o=i;for(let h=0;;){if(o=="..."&&h>0&&h+3==i.length){a=1;break}let u=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(o);if(!u)throw new RangeError("Invalid path: "+i);if(s.push(u[0]=="*"?"":u[0][0]=='"'?JSON.parse(u[0]):u[0]),h+=u[0].length,h==i.length)break;let d=i[h++];if(h==i.length&&d=="!"){a=0;break}if(d!="/")throw new RangeError("Invalid path: "+i);o=i.slice(h)}let l=s.length-1,f=s[l];if(!f)throw new RangeError("Invalid path: "+i);let c=new Gd(n,a,l>0?s.slice(0,l):null);e[f]=c.sort(e[f])}}return g4.add(e)}const g4=new qr;class Gd{constructor(e,t,n,i){this.tags=e,this.mode=t,this.context=n,this.next=i}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(e){return!e||e.depth<this.depth?(this.next=e,this):(e.next=this.sort(e.next),e)}get depth(){return this.context?this.context.length:0}}Gd.empty=new Gd([],2,null);function pf(r,e){let t=Object.create(null);for(let s of r)if(!Array.isArray(s.tag))t[s.tag.id]=s.class;else for(let a of s.tag)t[a.id]=s.class;let{scope:n,all:i=null}=e||{};return{style:s=>{let a=i;for(let o of s)for(let l of o.set){let f=t[l.id];if(f){a=a?a+" "+f:f;break}}return a},scope:n}}function gz(r,e){let t=null;for(let n of r){let i=n.style(e);i&&(t=t?t+" "+i:i)}return t}function Oz(r,e,t,n=0,i=r.length){let s=new xz(n,Array.isArray(e)?e:[e],t);s.highlightRange(r.cursor(),n,i,"",s.highlighters),s.flush(i)}class xz{constructor(e,t,n){this.at=e,this.highlighters=t,this.span=n,this.class=""}startSpan(e,t){t!=this.class&&(this.flush(e),e>this.at&&(this.at=e),this.class=t)}flush(e){e>this.at&&this.class&&this.span(this.at,e,this.class)}highlightRange(e,t,n,i,s){let{type:a,from:o,to:l}=e;if(o>=n||l<=t)return;a.isTop&&(s=this.highlighters.filter(d=>!d.scope||d.scope(a)));let f=i,c=vz(e)||Gd.empty,h=gz(s,c.tags);if(h&&(f&&(f+=" "),f+=h,c.mode==1&&(i+=(i?" ":"")+h)),this.startSpan(Math.max(t,o),f),c.opaque)return;let u=e.tree&&e.tree.prop(qr.mounted);if(u&&u.overlay){let d=e.node.enter(u.overlay[0].from+o,1),p=this.highlighters.filter(g=>!g.scope||g.scope(u.tree.type)),m=e.firstChild();for(let g=0,v=o;;g++){let w=g<u.overlay.length?u.overlay[g]:null,x=w?w.from+o:l,S=Math.max(t,v),y=Math.min(n,x);if(S<y&&m)for(;e.from<y&&(this.highlightRange(e,S,y,i,s),this.startSpan(Math.min(y,e.to),f),!(e.to>=x||!e.nextSibling())););if(!w||x>n)break;v=w.to+o,v>t&&(this.highlightRange(d.cursor(),Math.max(t,w.from+o),Math.min(n,v),"",p),this.startSpan(Math.min(n,v),f))}m&&e.parent()}else if(e.firstChild()){u&&(i="");do if(!(e.to<=t)){if(e.from>=n)break;this.highlightRange(e,t,n,i,s),this.startSpan(Math.min(n,e.to),f)}while(e.nextSibling());e.parent()}}}function vz(r){let e=r.type.prop(g4);for(;e&&e.context&&!r.matchContext(e.context);)e=e.next;return e||null}const Ie=bi.define,gu=Ie(),xa=Ie(),Ab=Ie(xa),Eb=Ie(xa),va=Ie(),Ou=Ie(va),Zp=Ie(va),hs=Ie(),so=Ie(hs),os=Ie(),ls=Ie(),Yg=Ie(),Ef=Ie(Yg),xu=Ie(),B={comment:gu,lineComment:Ie(gu),blockComment:Ie(gu),docComment:Ie(gu),name:xa,variableName:Ie(xa),typeName:Ab,tagName:Ie(Ab),propertyName:Eb,attributeName:Ie(Eb),className:Ie(xa),labelName:Ie(xa),namespace:Ie(xa),macroName:Ie(xa),literal:va,string:Ou,docString:Ie(Ou),character:Ie(Ou),attributeValue:Ie(Ou),number:Zp,integer:Ie(Zp),float:Ie(Zp),bool:Ie(va),regexp:Ie(va),escape:Ie(va),color:Ie(va),url:Ie(va),keyword:os,self:Ie(os),null:Ie(os),atom:Ie(os),unit:Ie(os),modifier:Ie(os),operatorKeyword:Ie(os),controlKeyword:Ie(os),definitionKeyword:Ie(os),moduleKeyword:Ie(os),operator:ls,derefOperator:Ie(ls),arithmeticOperator:Ie(ls),logicOperator:Ie(ls),bitwiseOperator:Ie(ls),compareOperator:Ie(ls),updateOperator:Ie(ls),definitionOperator:Ie(ls),typeOperator:Ie(ls),controlOperator:Ie(ls),punctuation:Yg,separator:Ie(Yg),bracket:Ef,angleBracket:Ie(Ef),squareBracket:Ie(Ef),paren:Ie(Ef),brace:Ie(Ef),content:hs,heading:so,heading1:Ie(so),heading2:Ie(so),heading3:Ie(so),heading4:Ie(so),heading5:Ie(so),heading6:Ie(so),contentSeparator:Ie(hs),list:Ie(hs),quote:Ie(hs),emphasis:Ie(hs),strong:Ie(hs),link:Ie(hs),monospace:Ie(hs),strikethrough:Ie(hs),inserted:Ie(),deleted:Ie(),changed:Ie(),invalid:Ie(),meta:xu,documentMeta:Ie(xu),annotation:Ie(xu),processingInstruction:Ie(xu),definition:bi.defineModifier("definition"),constant:bi.defineModifier("constant"),function:bi.defineModifier("function"),standard:bi.defineModifier("standard"),local:bi.defineModifier("local"),special:bi.defineModifier("special")};for(let r in B){let e=B[r];e instanceof bi&&(e.name=r)}pf([{tag:B.link,class:"tok-link"},{tag:B.heading,class:"tok-heading"},{tag:B.emphasis,class:"tok-emphasis"},{tag:B.strong,class:"tok-strong"},{tag:B.keyword,class:"tok-keyword"},{tag:B.atom,class:"tok-atom"},{tag:B.bool,class:"tok-bool"},{tag:B.url,class:"tok-url"},{tag:B.labelName,class:"tok-labelName"},{tag:B.inserted,class:"tok-inserted"},{tag:B.deleted,class:"tok-deleted"},{tag:B.literal,class:"tok-literal"},{tag:B.string,class:"tok-string"},{tag:B.number,class:"tok-number"},{tag:[B.regexp,B.escape,B.special(B.string)],class:"tok-string2"},{tag:B.variableName,class:"tok-variableName"},{tag:B.local(B.variableName),class:"tok-variableName tok-local"},{tag:B.definition(B.variableName),class:"tok-variableName tok-definition"},{tag:B.special(B.variableName),class:"tok-variableName2"},{tag:B.definition(B.propertyName),class:"tok-propertyName tok-definition"},{tag:B.typeName,class:"tok-typeName"},{tag:B.namespace,class:"tok-namespace"},{tag:B.className,class:"tok-className"},{tag:B.macroName,class:"tok-macroName"},{tag:B.propertyName,class:"tok-propertyName"},{tag:B.operator,class:"tok-operator"},{tag:B.comment,class:"tok-comment"},{tag:B.meta,class:"tok-meta"},{tag:B.invalid,class:"tok-invalid"},{tag:B.punctuation,class:"tok-punctuation"}]);var Wp;const Kf=new Qt,yz=new Qt;let Os=class{constructor(e,t,n=[],i=""){this.data=e,this.name=i,lt.prototype.hasOwnProperty("tree")||Object.defineProperty(lt.prototype,"tree",{get(){return Cn(this)}}),this.parser=t,this.extension=[Ba.of(this),lt.languageData.of((s,a,o)=>{let l=Pb(s,a,o),f=l.type.prop(Kf);if(!f)return[];let c=s.facet(f),h=l.type.prop(yz);if(h){let u=l.resolve(a-l.from,o);for(let d of h)if(d.test(u,s)){let p=s.facet(d.facet);return d.type=="replace"?p:p.concat(c)}}return c})].concat(n)}isActiveAt(e,t,n=-1){return Pb(e,t,n).type.prop(Kf)==this.data}findRegions(e){let t=e.facet(Ba);if((t==null?void 0:t.data)==this.data)return[{from:0,to:e.doc.length}];if(!t||!t.allowsNesting)return[];let n=[],i=(s,a)=>{if(s.prop(Kf)==this.data){n.push({from:a,to:a+s.length});return}let o=s.prop(Qt.mounted);if(o){if(o.tree.prop(Kf)==this.data){if(o.overlay)for(let l of o.overlay)n.push({from:l.from+a,to:l.to+a});else n.push({from:a,to:a+s.length});return}else if(o.overlay){let l=n.length;if(i(o.tree,o.overlay[0].from+a),n.length>l)return}}for(let l=0;l<s.children.length;l++){let f=s.children[l];f instanceof ri&&i(f,s.positions[l]+a)}};return i(Cn(e),0),n}get allowsNesting(){return!0}};Os.setState=ot.define();function Pb(r,e,t){let n=r.facet(Ba),i=Cn(r).topNode;if(!n||n.allowsNesting)for(let s=i;s;s=s.enter(e,t,sn.ExcludeBuffers))s.type.isTop&&(i=s);return i}function Cn(r){let e=r.field(Os.state,!1);return e?e.tree:ri.empty}let wz=class{constructor(e){this.doc=e,this.cursorPos=0,this.string="",this.cursor=e.iter()}get length(){return this.doc.length}syncTo(e){return this.string=this.cursor.next(e-this.cursorPos).value,this.cursorPos=e+this.string.length,this.cursorPos-this.string.length}chunk(e){return this.syncTo(e),this.string}get lineChunks(){return!0}read(e,t){let n=this.cursorPos-this.string.length;return e<n||t>=this.cursorPos?this.doc.sliceString(e,t):this.string.slice(e-n,t-n)}},Pf=null,bz=class Kg{constructor(e,t,n=[],i,s,a,o,l){this.parser=e,this.state=t,this.fragments=n,this.tree=i,this.treeLen=s,this.viewport=a,this.skipped=o,this.scheduleOn=l,this.parse=null,this.tempSkipped=[]}static create(e,t,n){return new Kg(e,t,[],ri.empty,0,n,[],null)}startParse(){return this.parser.startParse(new wz(this.state.doc),this.fragments)}work(e,t){return t!=null&&t>=this.state.doc.length&&(t=void 0),this.tree!=ri.empty&&this.isDone(t??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var n;if(typeof e=="number"){let i=Date.now()+e;e=()=>Date.now()>i}for(this.parse||(this.parse=this.startParse()),t!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>t)&&t<this.state.doc.length&&this.parse.stopAt(t);;){let i=this.parse.advance();if(i)if(this.fragments=this.withoutTempSkipped(Ku.addTree(i,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(n=this.parse.stoppedAt)!==null&&n!==void 0?n:this.state.doc.length,this.tree=i,this.parse=null,this.treeLen<(t??this.state.doc.length))this.parse=this.startParse();else return!0;if(e())return!1}})}takeTree(){let e,t;this.parse&&(e=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>e)&&this.parse.stopAt(e),this.withContext(()=>{for(;!(t=this.parse.advance()););}),this.treeLen=e,this.tree=t,this.fragments=this.withoutTempSkipped(Ku.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(e){let t=Pf;Pf=this;try{return e()}finally{Pf=t}}withoutTempSkipped(e){for(let t;t=this.tempSkipped.pop();)e=Rb(e,t.from,t.to);return e}changes(e,t){let{fragments:n,tree:i,treeLen:s,viewport:a,skipped:o}=this;if(this.takeTree(),!e.empty){let l=[];if(e.iterChangedRanges((f,c,h,u)=>l.push({fromA:f,toA:c,fromB:h,toB:u})),n=Ku.applyChanges(n,l),i=ri.empty,s=0,a={from:e.mapPos(a.from,-1),to:e.mapPos(a.to,1)},this.skipped.length){o=[];for(let f of this.skipped){let c=e.mapPos(f.from,1),h=e.mapPos(f.to,-1);c<h&&o.push({from:c,to:h})}}}return new Kg(this.parser,t,n,i,s,a,o,this.scheduleOn)}updateViewport(e){if(this.viewport.from==e.from&&this.viewport.to==e.to)return!1;this.viewport=e;let t=this.skipped.length;for(let n=0;n<this.skipped.length;n++){let{from:i,to:s}=this.skipped[n];i<e.to&&s>e.from&&(this.fragments=Rb(this.fragments,i,s),this.skipped.splice(n--,1))}return this.skipped.length>=t?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(e,t){this.skipped.push({from:e,to:t})}static getSkippingParser(e){return new class extends lz{createParse(t,n,i){let s=i[0].from,a=i[i.length-1].to;return{parsedPos:s,advance(){let l=Pf;if(l){for(let f of i)l.tempSkipped.push(f);e&&(l.scheduleOn=l.scheduleOn?Promise.all([l.scheduleOn,e]):e)}return this.parsedPos=a,new ri(Ss.none,[],[],a-s)},stoppedAt:null,stopAt(){}}}}}isDone(e){e=Math.min(e,this.state.doc.length);let t=this.fragments;return this.treeLen>=e&&t.length&&t[0].from==0&&t[0].to>=e}static get(){return Pf}};function Rb(r,e,t){return Ku.applyChanges(r,[{fromA:e,toA:t,fromB:e,toB:t}])}let Jg=class e1{constructor(e){this.context=e,this.tree=e.tree}apply(e){if(!e.docChanged&&this.tree==this.context.tree)return this;let t=this.context.changes(e.changes,e.state),n=this.context.treeLen==e.startState.doc.length?void 0:Math.max(e.changes.mapPos(this.context.treeLen),t.viewport.to);return t.work(20,n)||t.takeTree(),new e1(t)}static init(e){let t=Math.min(3e3,e.doc.length),n=bz.create(e.facet(Ba).parser,e,{from:0,to:t});return n.work(20,t)||n.takeTree(),new e1(n)}};Os.state=Cr.define({create:Jg.init,update(r,e){for(let t of e.effects)if(t.is(Os.setState))return t.value;return e.startState.facet(Ba)!=e.state.facet(Ba)?Jg.init(e.state):r.apply(e)}});let O4=r=>{let e=setTimeout(()=>r(),500);return()=>clearTimeout(e)};typeof requestIdleCallback<"u"&&(O4=r=>{let e=-1,t=setTimeout(()=>{e=requestIdleCallback(r,{timeout:400})},100);return()=>e<0?clearTimeout(t):cancelIdleCallback(e)});const Up=typeof navigator<"u"&&(!((Wp=navigator.scheduling)===null||Wp===void 0)&&Wp.isInputPending)?()=>navigator.scheduling.isInputPending():null,_z=gr.fromClass(class{constructor(e){this.view=e,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(e){let t=this.view.state.field(Os.state).context;(t.updateViewport(e.view.viewport)||this.view.viewport.to>t.treeLen)&&this.scheduleWork(),(e.docChanged||e.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(t)}scheduleWork(){if(this.working)return;let{state:e}=this.view,t=e.field(Os.state);(t.tree!=t.context.tree||!t.context.isDone(e.doc.length))&&(this.working=O4(this.work))}work(e){this.working=null;let t=Date.now();if(this.chunkEnd<t&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=t+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:n,viewport:{to:i}}=this.view,s=n.field(Os.state);if(s.tree==s.context.tree&&s.context.isDone(i+1e5))return;let a=Date.now()+Math.min(this.chunkBudget,100,e&&!Up?Math.max(25,e.timeRemaining()-5):1e9),o=s.context.treeLen<i&&n.doc.length>i+1e3,l=s.context.work(()=>Up&&Up()||Date.now()>a,i+(o?0:1e5));this.chunkBudget-=Date.now()-t,(l||this.chunkBudget<=0)&&(s.context.takeTree(),this.view.dispatch({effects:Os.setState.of(new Jg(s.context))})),this.chunkBudget>0&&!(l&&!o)&&this.scheduleWork(),this.checkAsyncSchedule(s.context)}checkAsyncSchedule(e){e.scheduleOn&&(this.workScheduled++,e.scheduleOn.then(()=>this.scheduleWork()).catch(t=>Jr(this.view.state,t)).then(()=>this.workScheduled--),e.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),Ba=Le.define({combine(r){return r.length?r[0]:null},enables:r=>[Os.state,_z,Be.contentAttributes.compute([r],e=>{let t=e.facet(r);return t&&t.name?{"data-language":t.name}:{}})]}),kz=Le.define(),Ax=Le.define({combine:r=>{if(!r.length)return"  ";let e=r[0];if(!e||/\S/.test(e)||Array.from(e).some(t=>t!=e[0]))throw new Error("Invalid indent unit: "+JSON.stringify(r[0]));return e}});function Hd(r){let e=r.facet(Ax);return e.charCodeAt(0)==9?r.tabSize*e.length:e.length}function Yc(r,e){let t="",n=r.tabSize,i=r.facet(Ax)[0];if(i=="	"){for(;e>=n;)t+="	",e-=n;i=" "}for(let s=0;s<e;s++)t+=i;return t}function Ex(r,e){r instanceof lt&&(r=new X0(r));for(let n of r.state.facet(kz)){let i=n(r,e);if(i!==void 0)return i}let t=Cn(r.state);return t.length>=e?Tz(r,t,e):null}class X0{constructor(e,t={}){this.state=e,this.options=t,this.unit=Hd(e)}lineAt(e,t=1){let n=this.state.doc.lineAt(e),{simulateBreak:i,simulateDoubleBreak:s}=this.options;return i!=null&&i>=n.from&&i<=n.to?s&&i==e?{text:"",from:e}:(t<0?i<e:i<=e)?{text:n.text.slice(i-n.from),from:i}:{text:n.text.slice(0,i-n.from),from:n.from}:n}textAfterPos(e,t=1){if(this.options.simulateDoubleBreak&&e==this.options.simulateBreak)return"";let{text:n,from:i}=this.lineAt(e,t);return n.slice(e-i,Math.min(n.length,e+100-i))}column(e,t=1){let{text:n,from:i}=this.lineAt(e,t),s=this.countColumn(n,e-i),a=this.options.overrideIndentation?this.options.overrideIndentation(i):-1;return a>-1&&(s+=a-this.countColumn(n,n.search(/\S|$/))),s}countColumn(e,t=e.length){return df(e,this.state.tabSize,t)}lineIndent(e,t=1){let{text:n,from:i}=this.lineAt(e,t),s=this.options.overrideIndentation;if(s){let a=s(i);if(a>-1)return a}return this.countColumn(n,n.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const Sz=new Qt;function Tz(r,e,t){let n=e.resolveStack(t),i=e.resolveInner(t,-1).resolve(t,0).enterUnfinishedNodesBefore(t);if(i!=n.node){let s=[];for(let a=i;a&&!(a.from==n.node.from&&a.type==n.node.type);a=a.parent)s.push(a);for(let a=s.length-1;a>=0;a--)n={node:s[a],next:n}}return x4(n,r,t)}function x4(r,e,t){for(let n=r;n;n=n.next){let i=Az(n.node);if(i)return i(Px.create(e,t,n))}return 0}function Cz(r){return r.pos==r.options.simulateBreak&&r.options.simulateDoubleBreak}function Az(r){let e=r.type.prop(Sz);if(e)return e;let t=r.firstChild,n;if(t&&(n=t.type.prop(Qt.closedBy))){let i=r.lastChild,s=i&&n.indexOf(i.name)>-1;return a=>Qz(a,!0,1,void 0,s&&!Cz(a)?i.from:void 0)}return r.parent==null?Ez:null}function Ez(){return 0}class Px extends X0{constructor(e,t,n){super(e.state,e.options),this.base=e,this.pos=t,this.context=n}get node(){return this.context.node}static create(e,t,n){return new Px(e,t,n)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(e){let t=this.state.doc.lineAt(e.from);for(;;){let n=e.resolve(t.from);for(;n.parent&&n.parent.from==n.from;)n=n.parent;if(Pz(n,e))break;t=this.state.doc.lineAt(n.from)}return this.lineIndent(t.from)}continue(){return x4(this.context.next,this.base,this.pos)}}function Pz(r,e){for(let t=e;t;t=t.parent)if(r==t)return!0;return!1}function Rz(r){let e=r.node,t=e.childAfter(e.from),n=e.lastChild;if(!t)return null;let i=r.options.simulateBreak,s=r.state.doc.lineAt(t.from),a=i==null||i<=s.from?s.to:Math.min(s.to,i);for(let o=t.to;;){let l=e.childAfter(o);if(!l||l==n)return null;if(!l.type.isSkipped){if(l.from>=a)return null;let f=/^ */.exec(s.text.slice(t.to-s.from))[0].length;return{from:t.from,to:t.to+f}}o=l.to}}function Qz(r,e,t,n,i){let s=r.textAfter,a=s.match(/^\s*/)[0].length,o=i==r.pos+a,l=Rz(r);return l?o?r.column(l.from):r.column(l.to):r.baseIndent+(o?0:r.unit*t)}const Fz=200;function $z(){return lt.transactionFilter.of(r=>{if(!r.docChanged||!r.isUserEvent("input.type")&&!r.isUserEvent("input.complete"))return r;let e=r.startState.languageDataAt("indentOnInput",r.startState.selection.main.head);if(!e.length)return r;let t=r.newDoc,{head:n}=r.newSelection.main,i=t.lineAt(n);if(n>i.from+Fz)return r;let s=t.sliceString(i.from,n);if(!e.some(f=>f.test(s)))return r;let{state:a}=r,o=-1,l=[];for(let{head:f}of a.selection.ranges){let c=a.doc.lineAt(f);if(c.from==o)continue;o=c.from;let h=Ex(a,c.from);if(h==null)continue;let u=/^\s*/.exec(c.text)[0],d=Yc(a,h);u!=d&&l.push({from:c.from,to:c.from+u.length,insert:d})}return l.length?[r,{changes:l,sequential:!0}]:r})}const Nz=Le.define(),Dz=new Qt;function Mz(r,e,t){let n=Cn(r);if(n.length<t)return null;let i=n.resolveStack(t,1),s=null;for(let a=i;a;a=a.next){let o=a.node;if(o.to<=t||o.from>t)continue;if(s&&o.from<e)break;let l=o.type.prop(Dz);if(l&&(o.to<n.length-50||n.length==r.doc.length||!Iz(o))){let f=l(o,r);f&&f.from<=t&&f.from>=e&&f.to>t&&(s=f)}}return s}function Iz(r){let e=r.lastChild;return e&&e.to==r.to&&e.type.isError}function Yd(r,e,t){for(let n of r.facet(Nz)){let i=n(r,e,t);if(i)return i}return Mz(r,e,t)}function v4(r,e){let t=e.mapPos(r.from,1),n=e.mapPos(r.to,-1);return t>=n?void 0:{from:t,to:n}}const V0=ot.define({map:v4}),Qh=ot.define({map:v4});function y4(r){let e=[];for(let{head:t}of r.state.selection.ranges)e.some(n=>n.from<=t&&n.to>=t)||e.push(r.lineBlockAt(t));return e}const Mo=Cr.define({create(){return ze.none},update(r,e){r=r.map(e.changes);for(let t of e.effects)if(t.is(V0)&&!Lz(r,t.value.from,t.value.to)){let{preparePlaceholder:n}=e.state.facet(_4),i=n?ze.replace({widget:new qz(n(e.state,t.value))}):Qb;r=r.update({add:[i.range(t.value.from,t.value.to)]})}else t.is(Qh)&&(r=r.update({filter:(n,i)=>t.value.from!=n||t.value.to!=i,filterFrom:t.value.from,filterTo:t.value.to}));if(e.selection){let t=!1,{head:n}=e.selection.main;r.between(n,n,(i,s)=>{i<n&&s>n&&(t=!0)}),t&&(r=r.update({filterFrom:n,filterTo:n,filter:(i,s)=>s<=n||i>=n}))}return r},provide:r=>Be.decorations.from(r),toJSON(r,e){let t=[];return r.between(0,e.doc.length,(n,i)=>{t.push(n,i)}),t},fromJSON(r){if(!Array.isArray(r)||r.length%2)throw new RangeError("Invalid JSON for fold state");let e=[];for(let t=0;t<r.length;){let n=r[t++],i=r[t++];if(typeof n!="number"||typeof i!="number")throw new RangeError("Invalid JSON for fold state");e.push(Qb.range(n,i))}return ze.set(e,!0)}});function Kd(r,e,t){var n;let i=null;return(n=r.field(Mo,!1))===null||n===void 0||n.between(e,t,(s,a)=>{(!i||i.from>s)&&(i={from:s,to:a})}),i}function Lz(r,e,t){let n=!1;return r.between(e,e,(i,s)=>{i==e&&s==t&&(n=!0)}),n}function w4(r,e){return r.field(Mo,!1)?e:e.concat(ot.appendConfig.of(k4()))}const Bz=r=>{for(let e of y4(r)){let t=Yd(r.state,e.from,e.to);if(t)return r.dispatch({effects:w4(r.state,[V0.of(t),b4(r,t)])}),!0}return!1},Zz=r=>{if(!r.state.field(Mo,!1))return!1;let e=[];for(let t of y4(r)){let n=Kd(r.state,t.from,t.to);n&&e.push(Qh.of(n),b4(r,n,!1))}return e.length&&r.dispatch({effects:e}),e.length>0};function b4(r,e,t=!0){let n=r.state.doc.lineAt(e.from).number,i=r.state.doc.lineAt(e.to).number;return Be.announce.of(`${r.state.phrase(t?"Folded lines":"Unfolded lines")} ${n} ${r.state.phrase("to")} ${i}.`)}const Wz=r=>{let{state:e}=r,t=[];for(let n=0;n<e.doc.length;){let i=r.lineBlockAt(n),s=Yd(e,i.from,i.to);s&&t.push(V0.of(s)),n=(s?r.lineBlockAt(s.to):i).to+1}return t.length&&r.dispatch({effects:w4(r.state,t)}),!!t.length},Uz=r=>{let e=r.state.field(Mo,!1);if(!e||!e.size)return!1;let t=[];return e.between(0,r.state.doc.length,(n,i)=>{t.push(Qh.of({from:n,to:i}))}),r.dispatch({effects:t}),!0},Xz=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:Bz},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:Zz},{key:"Ctrl-Alt-[",run:Wz},{key:"Ctrl-Alt-]",run:Uz}],Vz={placeholderDOM:null,preparePlaceholder:null,placeholderText:""},_4=Le.define({combine(r){return $s(r,Vz)}});function k4(r){return[Mo,Gz]}function S4(r,e){let{state:t}=r,n=t.facet(_4),i=a=>{let o=r.lineBlockAt(r.posAtDOM(a.target)),l=Kd(r.state,o.from,o.to);l&&r.dispatch({effects:Qh.of(l)}),a.preventDefault()};if(n.placeholderDOM)return n.placeholderDOM(r,i,e);let s=document.createElement("span");return s.textContent=n.placeholderText,s.setAttribute("aria-label",t.phrase("folded code")),s.title=t.phrase("unfold"),s.className="cm-foldPlaceholder",s.onclick=i,s}const Qb=ze.replace({widget:new class extends ia{toDOM(r){return S4(r,null)}}});class qz extends ia{constructor(e){super(),this.value=e}eq(e){return this.value==e.value}toDOM(e){return S4(e,this.value)}}const jz={openText:"",closedText:"",markerDOM:null,domEventHandlers:{},foldingChanged:()=>!1};class Xp extends Ys{constructor(e,t){super(),this.config=e,this.open=t}eq(e){return this.config==e.config&&this.open==e.open}toDOM(e){if(this.config.markerDOM)return this.config.markerDOM(this.open);let t=document.createElement("span");return t.textContent=this.open?this.config.openText:this.config.closedText,t.title=e.state.phrase(this.open?"Fold line":"Unfold line"),t}}function zz(r={}){let e=Object.assign(Object.assign({},jz),r),t=new Xp(e,!0),n=new Xp(e,!1),i=gr.fromClass(class{constructor(a){this.from=a.viewport.from,this.markers=this.buildMarkers(a)}update(a){(a.docChanged||a.viewportChanged||a.startState.facet(Ba)!=a.state.facet(Ba)||a.startState.field(Mo,!1)!=a.state.field(Mo,!1)||Cn(a.startState)!=Cn(a.state)||e.foldingChanged(a))&&(this.markers=this.buildMarkers(a.view))}buildMarkers(a){let o=new Gs;for(let l of a.viewportLineBlocks){let f=Kd(a.state,l.from,l.to)?n:Yd(a.state,l.from,l.to)?t:null;f&&o.add(l.from,l.from,f)}return o.finish()}}),{domEventHandlers:s}=e;return[i,Uj({class:"cm-foldGutter",markers(a){var o;return((o=a.plugin(i))===null||o===void 0?void 0:o.markers)||At.empty},initialSpacer(){return new Xp(e,!1)},domEventHandlers:Object.assign(Object.assign({},s),{click:(a,o,l)=>{if(s.click&&s.click(a,o,l))return!0;let f=Kd(a.state,o.from,o.to);if(f)return a.dispatch({effects:Qh.of(f)}),!0;let c=Yd(a.state,o.from,o.to);return c?(a.dispatch({effects:V0.of(c)}),!0):!1}})}),k4()]}const Gz=Be.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});let T4=class C4{constructor(e,t){this.specs=e;let n;function i(o){let l=Tn.newName();return(n||(n=Object.create(null)))["."+l]=o,l}const s=typeof t.all=="string"?t.all:t.all?i(t.all):void 0,a=t.scope;this.scope=a instanceof Os?o=>o.prop(Kf)==a.data:a?o=>o==a:void 0,this.style=pf(e.map(o=>({tag:o.tag,class:o.class||i(Object.assign({},o,{tag:null}))})),{all:s}).style,this.module=n?new Tn(n):null,this.themeType=t.themeType}static define(e,t){return new C4(e,t||{})}};const t1=Le.define(),A4=Le.define({combine(r){return r.length?[r[0]]:null}});function Vp(r){let e=r.facet(t1);return e.length?e:r.facet(A4)}function Hz(r,e){let t=[Kz],n;return r instanceof T4&&(r.module&&t.push(Be.styleModule.of(r.module)),n=r.themeType),e!=null&&e.fallback?t.push(A4.of(r)):n?t.push(t1.computeN([Be.darkTheme],i=>i.facet(Be.darkTheme)==(n=="dark")?[r]:[])):t.push(t1.of(r)),t}class Yz{constructor(e){this.markCache=Object.create(null),this.tree=Cn(e.state),this.decorations=this.buildDeco(e,Vp(e.state)),this.decoratedTo=e.viewport.to}update(e){let t=Cn(e.state),n=Vp(e.state),i=n!=Vp(e.startState),{viewport:s}=e.view,a=e.changes.mapPos(this.decoratedTo,1);t.length<s.to&&!i&&t.type==this.tree.type&&a>=s.to?(this.decorations=this.decorations.map(e.changes),this.decoratedTo=a):(t!=this.tree||e.viewportChanged||i)&&(this.tree=t,this.decorations=this.buildDeco(e.view,n),this.decoratedTo=s.to)}buildDeco(e,t){if(!t||!this.tree.length)return ze.none;let n=new Gs;for(let{from:i,to:s}of e.visibleRanges)Oz(this.tree,t,(a,o,l)=>{n.add(a,o,this.markCache[l]||(this.markCache[l]=ze.mark({class:l})))},i,s);return n.finish()}}const Kz=za.high(gr.fromClass(Yz,{decorations:r=>r.decorations})),Jz=T4.define([{tag:B.meta,color:"#404740"},{tag:B.link,textDecoration:"underline"},{tag:B.heading,textDecoration:"underline",fontWeight:"bold"},{tag:B.emphasis,fontStyle:"italic"},{tag:B.strong,fontWeight:"bold"},{tag:B.strikethrough,textDecoration:"line-through"},{tag:B.keyword,color:"#708"},{tag:[B.atom,B.bool,B.url,B.contentSeparator,B.labelName],color:"#219"},{tag:[B.literal,B.inserted],color:"#164"},{tag:[B.string,B.deleted],color:"#a11"},{tag:[B.regexp,B.escape,B.special(B.string)],color:"#e40"},{tag:B.definition(B.variableName),color:"#00f"},{tag:B.local(B.variableName),color:"#30a"},{tag:[B.typeName,B.namespace],color:"#085"},{tag:B.className,color:"#167"},{tag:[B.special(B.variableName),B.macroName],color:"#256"},{tag:B.definition(B.propertyName),color:"#00c"},{tag:B.comment,color:"#940"},{tag:B.invalid,color:"#f00"}]),eG=Be.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),E4=1e4,P4="()[]{}",R4=Le.define({combine(r){return $s(r,{afterCursor:!0,brackets:P4,maxScanDistance:E4,renderMatch:nG})}}),tG=ze.mark({class:"cm-matchingBracket"}),rG=ze.mark({class:"cm-nonmatchingBracket"});function nG(r){let e=[],t=r.matched?tG:rG;return e.push(t.range(r.start.from,r.start.to)),r.end&&e.push(t.range(r.end.from,r.end.to)),e}const iG=Cr.define({create(){return ze.none},update(r,e){if(!e.docChanged&&!e.selection)return r;let t=[],n=e.state.facet(R4);for(let i of e.state.selection.ranges){if(!i.empty)continue;let s=xs(e.state,i.head,-1,n)||i.head>0&&xs(e.state,i.head-1,1,n)||n.afterCursor&&(xs(e.state,i.head,1,n)||i.head<e.state.doc.length&&xs(e.state,i.head+1,-1,n));s&&(t=t.concat(n.renderMatch(s,e.state)))}return ze.set(t,!0)},provide:r=>Be.decorations.from(r)}),sG=[iG,eG];function aG(r={}){return[R4.of(r),sG]}const oG=new Qt;function r1(r,e,t){let n=r.prop(e<0?Qt.openedBy:Qt.closedBy);if(n)return n;if(r.name.length==1){let i=t.indexOf(r.name);if(i>-1&&i%2==(e<0?1:0))return[t[i+e]]}return null}function n1(r){let e=r.type.prop(oG);return e?e(r.node):r}function xs(r,e,t,n={}){let i=n.maxScanDistance||E4,s=n.brackets||P4,a=Cn(r),o=a.resolveInner(e,t);for(let l=o;l;l=l.parent){let f=r1(l.type,t,s);if(f&&l.from<l.to){let c=n1(l);if(c&&(t>0?e>=c.from&&e<c.to:e>c.from&&e<=c.to))return lG(r,e,t,l,c,f,s)}}return fG(r,e,t,a,o.type,i,s)}function lG(r,e,t,n,i,s,a){let o=n.parent,l={from:i.from,to:i.to},f=0,c=o==null?void 0:o.cursor();if(c&&(t<0?c.childBefore(n.from):c.childAfter(n.to)))do if(t<0?c.to<=n.from:c.from>=n.to){if(f==0&&s.indexOf(c.type.name)>-1&&c.from<c.to){let h=n1(c);return{start:l,end:h?{from:h.from,to:h.to}:void 0,matched:!0}}else if(r1(c.type,t,a))f++;else if(r1(c.type,-t,a)){if(f==0){let h=n1(c);return{start:l,end:h&&h.from<h.to?{from:h.from,to:h.to}:void 0,matched:!1}}f--}}while(t<0?c.prevSibling():c.nextSibling());return{start:l,matched:!1}}function fG(r,e,t,n,i,s,a){let o=t<0?r.sliceDoc(e-1,e):r.sliceDoc(e,e+1),l=a.indexOf(o);if(l<0||l%2==0!=t>0)return null;let f={from:t<0?e-1:e,to:t>0?e+1:e},c=r.doc.iterRange(e,t>0?r.doc.length:0),h=0;for(let u=0;!c.next().done&&u<=s;){let d=c.value;t<0&&(u+=d.length);let p=e+u*t;for(let m=t>0?0:d.length-1,g=t>0?d.length:-1;m!=g;m+=t){let v=a.indexOf(d[m]);if(!(v<0||n.resolveInner(p+m,1).type!=i))if(v%2==0==t>0)h++;else{if(h==1)return{start:f,end:{from:p+m,to:p+m+1},matched:v>>1==l>>1};h--}}t>0&&(u+=d.length)}return c.done?{start:f,matched:!1}:null}const cG=Object.create(null),Fb=[Ss.none],$b=[],Nb=Object.create(null),hG=Object.create(null);for(let[r,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])hG[r]=uG(cG,e);function qp(r,e){$b.indexOf(r)>-1||($b.push(r),console.warn(e))}function uG(r,e){let t=[];for(let o of e.split(" ")){let l=[];for(let f of o.split(".")){let c=r[f]||B[f];c?typeof c=="function"?l.length?l=l.map(c):qp(f,`Modifier ${f} used at start of tag`):l.length?qp(f,`Tag ${f} used as modifier`):l=Array.isArray(c)?c:[c]:qp(f,`Unknown highlighting tag ${f}`)}for(let f of l)t.push(f)}if(!t.length)return 0;let n=e.replace(/ /g,"_"),i=n+" "+t.map(o=>o.id),s=Nb[i];if(s)return s.id;let a=Nb[i]=Ss.define({id:Fb.length,name:n,props:[sa({[n]:t})]});return Fb.push(a),a.id}Rt.RTL,Rt.LTR;const dG=r=>{let{state:e}=r,t=e.doc.lineAt(e.selection.main.from),n=Qx(r.state,t.from);return n.line?pG(r):n.block?gG(r):!1};function Rx(r,e){return({state:t,dispatch:n})=>{if(t.readOnly)return!1;let i=r(e,t);return i?(n(t.update(i)),!0):!1}}const pG=Rx(vG,0),mG=Rx(Q4,0),gG=Rx((r,e)=>Q4(r,e,xG(e)),0);function Qx(r,e){let t=r.languageDataAt("commentTokens",e);return t.length?t[0]:{}}const Rf=50;function OG(r,{open:e,close:t},n,i){let s=r.sliceDoc(n-Rf,n),a=r.sliceDoc(i,i+Rf),o=/\s*$/.exec(s)[0].length,l=/^\s*/.exec(a)[0].length,f=s.length-o;if(s.slice(f-e.length,f)==e&&a.slice(l,l+t.length)==t)return{open:{pos:n-o,margin:o&&1},close:{pos:i+l,margin:l&&1}};let c,h;i-n<=2*Rf?c=h=r.sliceDoc(n,i):(c=r.sliceDoc(n,n+Rf),h=r.sliceDoc(i-Rf,i));let u=/^\s*/.exec(c)[0].length,d=/\s*$/.exec(h)[0].length,p=h.length-d-t.length;return c.slice(u,u+e.length)==e&&h.slice(p,p+t.length)==t?{open:{pos:n+u+e.length,margin:/\s/.test(c.charAt(u+e.length))?1:0},close:{pos:i-d-t.length,margin:/\s/.test(h.charAt(p-1))?1:0}}:null}function xG(r){let e=[];for(let t of r.selection.ranges){let n=r.doc.lineAt(t.from),i=t.to<=n.to?n:r.doc.lineAt(t.to);i.from>n.from&&i.from==t.to&&(i=t.to==n.to+1?n:r.doc.lineAt(t.to-1));let s=e.length-1;s>=0&&e[s].to>n.from?e[s].to=i.to:e.push({from:n.from+/^\s*/.exec(n.text)[0].length,to:i.to})}return e}function Q4(r,e,t=e.selection.ranges){let n=t.map(s=>Qx(e,s.from).block);if(!n.every(s=>s))return null;let i=t.map((s,a)=>OG(e,n[a],s.from,s.to));if(r!=2&&!i.every(s=>s))return{changes:e.changes(t.map((s,a)=>i[a]?[]:[{from:s.from,insert:n[a].open+" "},{from:s.to,insert:" "+n[a].close}]))};if(r!=1&&i.some(s=>s)){let s=[];for(let a=0,o;a<i.length;a++)if(o=i[a]){let l=n[a],{open:f,close:c}=o;s.push({from:f.pos-l.open.length,to:f.pos+f.margin},{from:c.pos-c.margin,to:c.pos+l.close.length})}return{changes:s}}return null}function vG(r,e,t=e.selection.ranges){let n=[],i=-1;for(let{from:s,to:a}of t){let o=n.length,l=1e9,f=Qx(e,s).line;if(f){for(let c=s;c<=a;){let h=e.doc.lineAt(c);if(h.from>i&&(s==a||a>h.from)){i=h.from;let u=/^\s*/.exec(h.text)[0].length,d=u==h.length,p=h.text.slice(u,u+f.length)==f?u:-1;u<h.text.length&&u<l&&(l=u),n.push({line:h,comment:p,token:f,indent:u,empty:d,single:!1})}c=h.to+1}if(l<1e9)for(let c=o;c<n.length;c++)n[c].indent<n[c].line.text.length&&(n[c].indent=l);n.length==o+1&&(n[o].single=!0)}}if(r!=2&&n.some(s=>s.comment<0&&(!s.empty||s.single))){let s=[];for(let{line:o,token:l,indent:f,empty:c,single:h}of n)(h||!c)&&s.push({from:o.from+f,insert:l+" "});let a=e.changes(s);return{changes:a,selection:e.selection.map(a,1)}}else if(r!=1&&n.some(s=>s.comment>=0)){let s=[];for(let{line:a,comment:o,token:l}of n)if(o>=0){let f=a.from+o,c=f+l.length;a.text[c-a.from]==" "&&c++,s.push({from:f,to:c})}return{changes:s}}return null}const i1=Fs.define(),yG=Fs.define(),wG=Le.define(),F4=Le.define({combine(r){return $s(r,{minDepth:100,newGroupDelay:500,joinToEvent:(e,t)=>t},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(e,t)=>(n,i)=>e(n,i)||t(n,i)})}}),$4=Cr.define({create(){return vs.empty},update(r,e){let t=e.state.facet(F4),n=e.annotation(i1);if(n){let l=jn.fromTransaction(e,n.selection),f=n.side,c=f==0?r.undone:r.done;return l?c=Jd(c,c.length,t.minDepth,l):c=M4(c,e.startState.selection),new vs(f==0?n.rest:c,f==0?c:n.rest)}let i=e.annotation(yG);if((i=="full"||i=="before")&&(r=r.isolate()),e.annotation(Br.addToHistory)===!1)return e.changes.empty?r:r.addMapping(e.changes.desc);let s=jn.fromTransaction(e),a=e.annotation(Br.time),o=e.annotation(Br.userEvent);return s?r=r.addChanges(s,a,o,t,e):e.selection&&(r=r.addSelection(e.startState.selection,a,o,t.newGroupDelay)),(i=="full"||i=="after")&&(r=r.isolate()),r},toJSON(r){return{done:r.done.map(e=>e.toJSON()),undone:r.undone.map(e=>e.toJSON())}},fromJSON(r){return new vs(r.done.map(jn.fromJSON),r.undone.map(jn.fromJSON))}});function bG(r={}){return[$4,F4.of(r),Be.domEventHandlers({beforeinput(e,t){let n=e.inputType=="historyUndo"?N4:e.inputType=="historyRedo"?s1:null;return n?(e.preventDefault(),n(t)):!1}})]}function q0(r,e){return function({state:t,dispatch:n}){if(!e&&t.readOnly)return!1;let i=t.field($4,!1);if(!i)return!1;let s=i.pop(r,t,e);return s?(n(s),!0):!1}}const N4=q0(0,!1),s1=q0(1,!1),_G=q0(0,!0),kG=q0(1,!0);class jn{constructor(e,t,n,i,s){this.changes=e,this.effects=t,this.mapped=n,this.startSelection=i,this.selectionsAfter=s}setSelAfter(e){return new jn(this.changes,this.effects,this.mapped,this.startSelection,e)}toJSON(){var e,t,n;return{changes:(e=this.changes)===null||e===void 0?void 0:e.toJSON(),mapped:(t=this.mapped)===null||t===void 0?void 0:t.toJSON(),startSelection:(n=this.startSelection)===null||n===void 0?void 0:n.toJSON(),selectionsAfter:this.selectionsAfter.map(i=>i.toJSON())}}static fromJSON(e){return new jn(e.changes&&Ur.fromJSON(e.changes),[],e.mapped&&bs.fromJSON(e.mapped),e.startSelection&&xe.fromJSON(e.startSelection),e.selectionsAfter.map(xe.fromJSON))}static fromTransaction(e,t){let n=Si;for(let i of e.startState.facet(wG)){let s=i(e);s.length&&(n=n.concat(s))}return!n.length&&e.changes.empty?null:new jn(e.changes.invert(e.startState.doc),n,void 0,t||e.startState.selection,Si)}static selection(e){return new jn(void 0,Si,void 0,void 0,e)}}function Jd(r,e,t,n){let i=e+1>t+20?e-t-1:0,s=r.slice(i,e);return s.push(n),s}function SG(r,e){let t=[],n=!1;return r.iterChangedRanges((i,s)=>t.push(i,s)),e.iterChangedRanges((i,s,a,o)=>{for(let l=0;l<t.length;){let f=t[l++],c=t[l++];o>=f&&a<=c&&(n=!0)}}),n}function TG(r,e){return r.ranges.length==e.ranges.length&&r.ranges.filter((t,n)=>t.empty!=e.ranges[n].empty).length===0}function D4(r,e){return r.length?e.length?r.concat(e):r:e}const Si=[],CG=200;function M4(r,e){if(r.length){let t=r[r.length-1],n=t.selectionsAfter.slice(Math.max(0,t.selectionsAfter.length-CG));return n.length&&n[n.length-1].eq(e)?r:(n.push(e),Jd(r,r.length-1,1e9,t.setSelAfter(n)))}else return[jn.selection([e])]}function AG(r){let e=r[r.length-1],t=r.slice();return t[r.length-1]=e.setSelAfter(e.selectionsAfter.slice(0,e.selectionsAfter.length-1)),t}function jp(r,e){if(!r.length)return r;let t=r.length,n=Si;for(;t;){let i=EG(r[t-1],e,n);if(i.changes&&!i.changes.empty||i.effects.length){let s=r.slice(0,t);return s[t-1]=i,s}else e=i.mapped,t--,n=i.selectionsAfter}return n.length?[jn.selection(n)]:Si}function EG(r,e,t){let n=D4(r.selectionsAfter.length?r.selectionsAfter.map(o=>o.map(e)):Si,t);if(!r.changes)return jn.selection(n);let i=r.changes.map(e),s=e.mapDesc(r.changes,!0),a=r.mapped?r.mapped.composeDesc(s):s;return new jn(i,ot.mapEffects(r.effects,e),a,r.startSelection.map(s),n)}const PG=/^(input\.type|delete)($|\.)/;class vs{constructor(e,t,n=0,i=void 0){this.done=e,this.undone=t,this.prevTime=n,this.prevUserEvent=i}isolate(){return this.prevTime?new vs(this.done,this.undone):this}addChanges(e,t,n,i,s){let a=this.done,o=a[a.length-1];return o&&o.changes&&!o.changes.empty&&e.changes&&(!n||PG.test(n))&&(!o.selectionsAfter.length&&t-this.prevTime<i.newGroupDelay&&i.joinToEvent(s,SG(o.changes,e.changes))||n=="input.type.compose")?a=Jd(a,a.length-1,i.minDepth,new jn(e.changes.compose(o.changes),D4(ot.mapEffects(e.effects,o.changes),o.effects),o.mapped,o.startSelection,Si)):a=Jd(a,a.length,i.minDepth,e),new vs(a,Si,t,n)}addSelection(e,t,n,i){let s=this.done.length?this.done[this.done.length-1].selectionsAfter:Si;return s.length>0&&t-this.prevTime<i&&n==this.prevUserEvent&&n&&/^select($|\.)/.test(n)&&TG(s[s.length-1],e)?this:new vs(M4(this.done,e),this.undone,t,n)}addMapping(e){return new vs(jp(this.done,e),jp(this.undone,e),this.prevTime,this.prevUserEvent)}pop(e,t,n){let i=e==0?this.done:this.undone;if(i.length==0)return null;let s=i[i.length-1],a=s.selectionsAfter[0]||t.selection;if(n&&s.selectionsAfter.length)return t.update({selection:s.selectionsAfter[s.selectionsAfter.length-1],annotations:i1.of({side:e,rest:AG(i),selection:a}),userEvent:e==0?"select.undo":"select.redo",scrollIntoView:!0});if(s.changes){let o=i.length==1?Si:i.slice(0,i.length-1);return s.mapped&&(o=jp(o,s.mapped)),t.update({changes:s.changes,selection:s.startSelection,effects:s.effects,annotations:i1.of({side:e,rest:o,selection:a}),filter:!1,userEvent:e==0?"undo":"redo",scrollIntoView:!0})}else return null}}vs.empty=new vs(Si,Si);const RG=[{key:"Mod-z",run:N4,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:s1,preventDefault:!0},{linux:"Ctrl-Shift-z",run:s1,preventDefault:!0},{key:"Mod-u",run:_G,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:kG,preventDefault:!0}];function mf(r,e){return xe.create(r.ranges.map(e),r.mainIndex)}function Ns(r,e){return r.update({selection:e,scrollIntoView:!0,userEvent:"select"})}function rs({state:r,dispatch:e},t){let n=mf(r.selection,t);return n.eq(r.selection,!0)?!1:(e(Ns(r,n)),!0)}function j0(r,e){return xe.cursor(e?r.to:r.from)}function I4(r,e){return rs(r,t=>t.empty?r.moveByChar(t,e):j0(t,e))}function En(r){return r.textDirectionAt(r.state.selection.main.head)==Rt.LTR}const L4=r=>I4(r,!En(r)),B4=r=>I4(r,En(r));function Z4(r,e){return rs(r,t=>t.empty?r.moveByGroup(t,e):j0(t,e))}const QG=r=>Z4(r,!En(r)),FG=r=>Z4(r,En(r));function $G(r,e,t){if(e.type.prop(t))return!0;let n=e.to-e.from;return n&&(n>2||/[^\s,.;:]/.test(r.sliceDoc(e.from,e.to)))||e.firstChild}function z0(r,e,t){let n=Cn(r).resolveInner(e.head),i=t?Qt.closedBy:Qt.openedBy;for(let l=e.head;;){let f=t?n.childAfter(l):n.childBefore(l);if(!f)break;$G(r,f,i)?n=f:l=t?f.to:f.from}let s=n.type.prop(i),a,o;return s&&(a=t?xs(r,n.from,1):xs(r,n.to,-1))&&a.matched?o=t?a.end.to:a.end.from:o=t?n.to:n.from,xe.cursor(o,t?-1:1)}const NG=r=>rs(r,e=>z0(r.state,e,!En(r))),DG=r=>rs(r,e=>z0(r.state,e,En(r)));function W4(r,e){return rs(r,t=>{if(!t.empty)return j0(t,e);let n=r.moveVertically(t,e);return n.head!=t.head?n:r.moveToLineBoundary(t,e)})}const U4=r=>W4(r,!1),X4=r=>W4(r,!0);function V4(r){let e=r.scrollDOM.clientHeight<r.scrollDOM.scrollHeight-2,t=0,n=0,i;if(e){for(let s of r.state.facet(Be.scrollMargins)){let a=s(r);a!=null&&a.top&&(t=Math.max(a==null?void 0:a.top,t)),a!=null&&a.bottom&&(n=Math.max(a==null?void 0:a.bottom,n))}i=r.scrollDOM.clientHeight-t-n}else i=(r.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:t,marginBottom:n,selfScroll:e,height:Math.max(r.defaultLineHeight,i-5)}}function q4(r,e){let t=V4(r),{state:n}=r,i=mf(n.selection,a=>a.empty?r.moveVertically(a,e,t.height):j0(a,e));if(i.eq(n.selection))return!1;let s;if(t.selfScroll){let a=r.coordsAtPos(n.selection.main.head),o=r.scrollDOM.getBoundingClientRect(),l=o.top+t.marginTop,f=o.bottom-t.marginBottom;a&&a.top>l&&a.bottom<f&&(s=Be.scrollIntoView(i.main.head,{y:"start",yMargin:a.top-l}))}return r.dispatch(Ns(n,i),{effects:s}),!0}const Db=r=>q4(r,!1),a1=r=>q4(r,!0);function Ga(r,e,t){let n=r.lineBlockAt(e.head),i=r.moveToLineBoundary(e,t);if(i.head==e.head&&i.head!=(t?n.to:n.from)&&(i=r.moveToLineBoundary(e,t,!1)),!t&&i.head==n.from&&n.length){let s=/^\s*/.exec(r.state.sliceDoc(n.from,Math.min(n.from+100,n.to)))[0].length;s&&e.head!=n.from+s&&(i=xe.cursor(n.from+s))}return i}const MG=r=>rs(r,e=>Ga(r,e,!0)),IG=r=>rs(r,e=>Ga(r,e,!1)),LG=r=>rs(r,e=>Ga(r,e,!En(r))),BG=r=>rs(r,e=>Ga(r,e,En(r))),ZG=r=>rs(r,e=>xe.cursor(r.lineBlockAt(e.head).from,1)),WG=r=>rs(r,e=>xe.cursor(r.lineBlockAt(e.head).to,-1));function UG(r,e,t){let n=!1,i=mf(r.selection,s=>{let a=xs(r,s.head,-1)||xs(r,s.head,1)||s.head>0&&xs(r,s.head-1,1)||s.head<r.doc.length&&xs(r,s.head+1,-1);if(!a||!a.end)return s;n=!0;let o=a.start.from==s.head?a.end.to:a.end.from;return xe.cursor(o)});return n?(e(Ns(r,i)),!0):!1}const XG=({state:r,dispatch:e})=>UG(r,e);function Fi(r,e){let t=mf(r.state.selection,n=>{let i=e(n);return xe.range(n.anchor,i.head,i.goalColumn,i.bidiLevel||void 0)});return t.eq(r.state.selection)?!1:(r.dispatch(Ns(r.state,t)),!0)}function j4(r,e){return Fi(r,t=>r.moveByChar(t,e))}const z4=r=>j4(r,!En(r)),G4=r=>j4(r,En(r));function H4(r,e){return Fi(r,t=>r.moveByGroup(t,e))}const VG=r=>H4(r,!En(r)),qG=r=>H4(r,En(r)),jG=r=>Fi(r,e=>z0(r.state,e,!En(r))),zG=r=>Fi(r,e=>z0(r.state,e,En(r)));function Y4(r,e){return Fi(r,t=>r.moveVertically(t,e))}const K4=r=>Y4(r,!1),J4=r=>Y4(r,!0);function eE(r,e){return Fi(r,t=>r.moveVertically(t,e,V4(r).height))}const Mb=r=>eE(r,!1),Ib=r=>eE(r,!0),GG=r=>Fi(r,e=>Ga(r,e,!0)),HG=r=>Fi(r,e=>Ga(r,e,!1)),YG=r=>Fi(r,e=>Ga(r,e,!En(r))),KG=r=>Fi(r,e=>Ga(r,e,En(r))),JG=r=>Fi(r,e=>xe.cursor(r.lineBlockAt(e.head).from)),eH=r=>Fi(r,e=>xe.cursor(r.lineBlockAt(e.head).to)),Lb=({state:r,dispatch:e})=>(e(Ns(r,{anchor:0})),!0),Bb=({state:r,dispatch:e})=>(e(Ns(r,{anchor:r.doc.length})),!0),Zb=({state:r,dispatch:e})=>(e(Ns(r,{anchor:r.selection.main.anchor,head:0})),!0),Wb=({state:r,dispatch:e})=>(e(Ns(r,{anchor:r.selection.main.anchor,head:r.doc.length})),!0),tH=({state:r,dispatch:e})=>(e(r.update({selection:{anchor:0,head:r.doc.length},userEvent:"select"})),!0),rH=({state:r,dispatch:e})=>{let t=G0(r).map(({from:n,to:i})=>xe.range(n,Math.min(i+1,r.doc.length)));return e(r.update({selection:xe.create(t),userEvent:"select"})),!0},nH=({state:r,dispatch:e})=>{let t=mf(r.selection,n=>{let i=Cn(r),s=i.resolveStack(n.from,1);if(n.empty){let a=i.resolveStack(n.from,-1);a.node.from>=s.node.from&&a.node.to<=s.node.to&&(s=a)}for(let a=s;a;a=a.next){let{node:o}=a;if((o.from<n.from&&o.to>=n.to||o.to>n.to&&o.from<=n.from)&&a.next)return xe.range(o.to,o.from)}return n});return t.eq(r.selection)?!1:(e(Ns(r,t)),!0)},iH=({state:r,dispatch:e})=>{let t=r.selection,n=null;return t.ranges.length>1?n=xe.create([t.main]):t.main.empty||(n=xe.create([xe.cursor(t.main.head)])),n?(e(Ns(r,n)),!0):!1};function Fh(r,e){if(r.state.readOnly)return!1;let t="delete.selection",{state:n}=r,i=n.changeByRange(s=>{let{from:a,to:o}=s;if(a==o){let l=e(s);l<a?(t="delete.backward",l=vu(r,l,!1)):l>a&&(t="delete.forward",l=vu(r,l,!0)),a=Math.min(a,l),o=Math.max(o,l)}else a=vu(r,a,!1),o=vu(r,o,!0);return a==o?{range:s}:{changes:{from:a,to:o},range:xe.cursor(a,a<s.head?-1:1)}});return i.changes.empty?!1:(r.dispatch(n.update(i,{scrollIntoView:!0,userEvent:t,effects:t=="delete.selection"?Be.announce.of(n.phrase("Selection deleted")):void 0})),!0)}function vu(r,e,t){if(r instanceof Be)for(let n of r.state.facet(Be.atomicRanges).map(i=>i(r)))n.between(e,e,(i,s)=>{i<e&&s>e&&(e=t?s:i)});return e}const tE=(r,e,t)=>Fh(r,n=>{let i=n.from,{state:s}=r,a=s.doc.lineAt(i),o,l;if(t&&!e&&i>a.from&&i<a.from+200&&!/[^ \t]/.test(o=a.text.slice(0,i-a.from))){if(o[o.length-1]=="	")return i-1;let f=df(o,s.tabSize),c=f%Hd(s)||Hd(s);for(let h=0;h<c&&o[o.length-1-h]==" ";h++)i--;l=i}else l=un(a.text,i-a.from,e,e)+a.from,l==i&&a.number!=(e?s.doc.lines:1)?l+=e?1:-1:!e&&/[\ufe00-\ufe0f]/.test(a.text.slice(l-a.from,i-a.from))&&(l=un(a.text,l-a.from,!1,!1)+a.from);return l}),o1=r=>tE(r,!1,!0),rE=r=>tE(r,!0,!1),nE=(r,e)=>Fh(r,t=>{let n=t.head,{state:i}=r,s=i.doc.lineAt(n),a=i.charCategorizer(n);for(let o=null;;){if(n==(e?s.to:s.from)){n==t.head&&s.number!=(e?i.doc.lines:1)&&(n+=e?1:-1);break}let l=un(s.text,n-s.from,e)+s.from,f=s.text.slice(Math.min(n,l)-s.from,Math.max(n,l)-s.from),c=a(f);if(o!=null&&c!=o)break;(f!=" "||n!=t.head)&&(o=c),n=l}return n}),iE=r=>nE(r,!1),sH=r=>nE(r,!0),aH=r=>Fh(r,e=>{let t=r.lineBlockAt(e.head).to;return e.head<t?t:Math.min(r.state.doc.length,e.head+1)}),oH=r=>Fh(r,e=>{let t=r.moveToLineBoundary(e,!1).head;return e.head>t?t:Math.max(0,e.head-1)}),lH=r=>Fh(r,e=>{let t=r.moveToLineBoundary(e,!0).head;return e.head<t?t:Math.min(r.state.doc.length,e.head+1)}),fH=({state:r,dispatch:e})=>{if(r.readOnly)return!1;let t=r.changeByRange(n=>({changes:{from:n.from,to:n.to,insert:Nt.of(["",""])},range:xe.cursor(n.from)}));return e(r.update(t,{scrollIntoView:!0,userEvent:"input"})),!0},cH=({state:r,dispatch:e})=>{if(r.readOnly)return!1;let t=r.changeByRange(n=>{if(!n.empty||n.from==0||n.from==r.doc.length)return{range:n};let i=n.from,s=r.doc.lineAt(i),a=i==s.from?i-1:un(s.text,i-s.from,!1)+s.from,o=i==s.to?i+1:un(s.text,i-s.from,!0)+s.from;return{changes:{from:a,to:o,insert:r.doc.slice(i,o).append(r.doc.slice(a,i))},range:xe.cursor(o)}});return t.changes.empty?!1:(e(r.update(t,{scrollIntoView:!0,userEvent:"move.character"})),!0)};function G0(r){let e=[],t=-1;for(let n of r.selection.ranges){let i=r.doc.lineAt(n.from),s=r.doc.lineAt(n.to);if(!n.empty&&n.to==s.from&&(s=r.doc.lineAt(n.to-1)),t>=i.number){let a=e[e.length-1];a.to=s.to,a.ranges.push(n)}else e.push({from:i.from,to:s.to,ranges:[n]});t=s.number+1}return e}function sE(r,e,t){if(r.readOnly)return!1;let n=[],i=[];for(let s of G0(r)){if(t?s.to==r.doc.length:s.from==0)continue;let a=r.doc.lineAt(t?s.to+1:s.from-1),o=a.length+1;if(t){n.push({from:s.to,to:a.to},{from:s.from,insert:a.text+r.lineBreak});for(let l of s.ranges)i.push(xe.range(Math.min(r.doc.length,l.anchor+o),Math.min(r.doc.length,l.head+o)))}else{n.push({from:a.from,to:s.from},{from:s.to,insert:r.lineBreak+a.text});for(let l of s.ranges)i.push(xe.range(l.anchor-o,l.head-o))}}return n.length?(e(r.update({changes:n,scrollIntoView:!0,selection:xe.create(i,r.selection.mainIndex),userEvent:"move.line"})),!0):!1}const hH=({state:r,dispatch:e})=>sE(r,e,!1),uH=({state:r,dispatch:e})=>sE(r,e,!0);function aE(r,e,t){if(r.readOnly)return!1;let n=[];for(let i of G0(r))t?n.push({from:i.from,insert:r.doc.slice(i.from,i.to)+r.lineBreak}):n.push({from:i.to,insert:r.lineBreak+r.doc.slice(i.from,i.to)});return e(r.update({changes:n,scrollIntoView:!0,userEvent:"input.copyline"})),!0}const dH=({state:r,dispatch:e})=>aE(r,e,!1),pH=({state:r,dispatch:e})=>aE(r,e,!0),mH=r=>{if(r.state.readOnly)return!1;let{state:e}=r,t=e.changes(G0(e).map(({from:i,to:s})=>(i>0?i--:s<e.doc.length&&s++,{from:i,to:s}))),n=mf(e.selection,i=>{let s;if(r.lineWrapping){let a=r.lineBlockAt(i.head),o=r.coordsAtPos(i.head,i.assoc||1);o&&(s=a.bottom+r.documentTop-o.bottom+r.defaultLineHeight/2)}return r.moveVertically(i,!0,s)}).map(t);return r.dispatch({changes:t,selection:n,scrollIntoView:!0,userEvent:"delete.line"}),!0};function gH(r,e){if(/\(\)|\[\]|\{\}/.test(r.sliceDoc(e-1,e+1)))return{from:e,to:e};let t=Cn(r).resolveInner(e),n=t.childBefore(e),i=t.childAfter(e),s;return n&&i&&n.to<=e&&i.from>=e&&(s=n.type.prop(Qt.closedBy))&&s.indexOf(i.name)>-1&&r.doc.lineAt(n.to).from==r.doc.lineAt(i.from).from&&!/\S/.test(r.sliceDoc(n.to,i.from))?{from:n.to,to:i.from}:null}const Ub=oE(!1),OH=oE(!0);function oE(r){return({state:e,dispatch:t})=>{if(e.readOnly)return!1;let n=e.changeByRange(i=>{let{from:s,to:a}=i,o=e.doc.lineAt(s),l=!r&&s==a&&gH(e,s);r&&(s=a=(a<=o.to?o:e.doc.lineAt(a)).to);let f=new X0(e,{simulateBreak:s,simulateDoubleBreak:!!l}),c=Ex(f,s);for(c==null&&(c=df(/^\s*/.exec(e.doc.lineAt(s).text)[0],e.tabSize));a<o.to&&/\s/.test(o.text[a-o.from]);)a++;l?{from:s,to:a}=l:s>o.from&&s<o.from+100&&!/\S/.test(o.text.slice(0,s))&&(s=o.from);let h=["",Yc(e,c)];return l&&h.push(Yc(e,f.lineIndent(o.from,-1))),{changes:{from:s,to:a,insert:Nt.of(h)},range:xe.cursor(s+1+h[1].length)}});return t(e.update(n,{scrollIntoView:!0,userEvent:"input"})),!0}}function Fx(r,e){let t=-1;return r.changeByRange(n=>{let i=[];for(let a=n.from;a<=n.to;){let o=r.doc.lineAt(a);o.number>t&&(n.empty||n.to>o.from)&&(e(o,i,n),t=o.number),a=o.to+1}let s=r.changes(i);return{changes:i,range:xe.range(s.mapPos(n.anchor,1),s.mapPos(n.head,1))}})}const xH=({state:r,dispatch:e})=>{if(r.readOnly)return!1;let t=Object.create(null),n=new X0(r,{overrideIndentation:s=>{let a=t[s];return a??-1}}),i=Fx(r,(s,a,o)=>{let l=Ex(n,s.from);if(l==null)return;/\S/.test(s.text)||(l=0);let f=/^\s*/.exec(s.text)[0],c=Yc(r,l);(f!=c||o.from<s.from+f.length)&&(t[s.from]=l,a.push({from:s.from,to:s.from+f.length,insert:c}))});return i.changes.empty||e(r.update(i,{userEvent:"indent"})),!0},vH=({state:r,dispatch:e})=>r.readOnly?!1:(e(r.update(Fx(r,(t,n)=>{n.push({from:t.from,insert:r.facet(Ax)})}),{userEvent:"input.indent"})),!0),yH=({state:r,dispatch:e})=>r.readOnly?!1:(e(r.update(Fx(r,(t,n)=>{let i=/^\s*/.exec(t.text)[0];if(!i)return;let s=df(i,r.tabSize),a=0,o=Yc(r,Math.max(0,s-Hd(r)));for(;a<i.length&&a<o.length&&i.charCodeAt(a)==o.charCodeAt(a);)a++;n.push({from:t.from+a,to:t.from+i.length,insert:o.slice(a)})}),{userEvent:"delete.dedent"})),!0),wH=r=>(r.setTabFocusMode(),!0),bH=[{key:"Ctrl-b",run:L4,shift:z4,preventDefault:!0},{key:"Ctrl-f",run:B4,shift:G4},{key:"Ctrl-p",run:U4,shift:K4},{key:"Ctrl-n",run:X4,shift:J4},{key:"Ctrl-a",run:ZG,shift:JG},{key:"Ctrl-e",run:WG,shift:eH},{key:"Ctrl-d",run:rE},{key:"Ctrl-h",run:o1},{key:"Ctrl-k",run:aH},{key:"Ctrl-Alt-h",run:iE},{key:"Ctrl-o",run:fH},{key:"Ctrl-t",run:cH},{key:"Ctrl-v",run:a1}],_H=[{key:"ArrowLeft",run:L4,shift:z4,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:QG,shift:VG,preventDefault:!0},{mac:"Cmd-ArrowLeft",run:LG,shift:YG,preventDefault:!0},{key:"ArrowRight",run:B4,shift:G4,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:FG,shift:qG,preventDefault:!0},{mac:"Cmd-ArrowRight",run:BG,shift:KG,preventDefault:!0},{key:"ArrowUp",run:U4,shift:K4,preventDefault:!0},{mac:"Cmd-ArrowUp",run:Lb,shift:Zb},{mac:"Ctrl-ArrowUp",run:Db,shift:Mb},{key:"ArrowDown",run:X4,shift:J4,preventDefault:!0},{mac:"Cmd-ArrowDown",run:Bb,shift:Wb},{mac:"Ctrl-ArrowDown",run:a1,shift:Ib},{key:"PageUp",run:Db,shift:Mb},{key:"PageDown",run:a1,shift:Ib},{key:"Home",run:IG,shift:HG,preventDefault:!0},{key:"Mod-Home",run:Lb,shift:Zb},{key:"End",run:MG,shift:GG,preventDefault:!0},{key:"Mod-End",run:Bb,shift:Wb},{key:"Enter",run:Ub,shift:Ub},{key:"Mod-a",run:tH},{key:"Backspace",run:o1,shift:o1},{key:"Delete",run:rE},{key:"Mod-Backspace",mac:"Alt-Backspace",run:iE},{key:"Mod-Delete",mac:"Alt-Delete",run:sH},{mac:"Mod-Backspace",run:oH},{mac:"Mod-Delete",run:lH}].concat(bH.map(r=>({mac:r.key,run:r.run,shift:r.shift}))),kH=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:NG,shift:jG},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:DG,shift:zG},{key:"Alt-ArrowUp",run:hH},{key:"Shift-Alt-ArrowUp",run:dH},{key:"Alt-ArrowDown",run:uH},{key:"Shift-Alt-ArrowDown",run:pH},{key:"Escape",run:iH},{key:"Mod-Enter",run:OH},{key:"Alt-l",mac:"Ctrl-l",run:rH},{key:"Mod-i",run:nH,preventDefault:!0},{key:"Mod-[",run:yH},{key:"Mod-]",run:vH},{key:"Mod-Alt-\\",run:xH},{key:"Shift-Mod-k",run:mH},{key:"Shift-Mod-\\",run:XG},{key:"Mod-/",run:dG},{key:"Alt-A",run:mG},{key:"Ctrl-m",mac:"Shift-Alt-m",run:wH}].concat(_H);function rr(){var r=arguments[0];typeof r=="string"&&(r=document.createElement(r));var e=1,t=arguments[1];if(t&&typeof t=="object"&&t.nodeType==null&&!Array.isArray(t)){for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var i=t[n];typeof i=="string"?r.setAttribute(n,i):i!=null&&(r[n]=i)}e++}for(;e<arguments.length;e++)lE(r,arguments[e]);return r}function lE(r,e){if(typeof e=="string")r.appendChild(document.createTextNode(e));else if(e!=null)if(e.nodeType!=null)r.appendChild(e);else if(Array.isArray(e))for(var t=0;t<e.length;t++)lE(r,e[t]);else throw new RangeError("Unsupported child node: "+e)}const Xb=typeof String.prototype.normalize=="function"?r=>r.normalize("NFKD"):r=>r;class ql{constructor(e,t,n=0,i=e.length,s,a){this.test=a,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=e.iterRange(n,i),this.bufferStart=n,this.normalize=s?o=>s(Xb(o)):Xb,this.query=this.normalize(t)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return Wn(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let e=this.peek();if(e<0)return this.done=!0,this;let t=cx(e),n=this.bufferStart+this.bufferPos;this.bufferPos+=ds(e);let i=this.normalize(t);if(i.length)for(let s=0,a=n;;s++){let o=i.charCodeAt(s),l=this.match(o,a,this.bufferPos+this.bufferStart);if(s==i.length-1){if(l)return this.value=l,this;break}a==n&&s<t.length&&t.charCodeAt(s)==o&&a++}}}match(e,t,n){let i=null;for(let s=0;s<this.matches.length;s+=2){let a=this.matches[s],o=!1;this.query.charCodeAt(a)==e&&(a==this.query.length-1?i={from:this.matches[s+1],to:n}:(this.matches[s]++,o=!0)),o||(this.matches.splice(s,2),s-=2)}return this.query.charCodeAt(0)==e&&(this.query.length==1?i={from:t,to:n}:this.matches.push(1,t)),i&&this.test&&!this.test(i.from,i.to,this.buffer,this.bufferStart)&&(i=null),i}}typeof Symbol<"u"&&(ql.prototype[Symbol.iterator]=function(){return this});const fE={from:-1,to:-1,match:/.*/.exec("")},$x="gm"+(/x/.unicode==null?"":"u");class cE{constructor(e,t,n,i=0,s=e.length){if(this.text=e,this.to=s,this.curLine="",this.done=!1,this.value=fE,/\\[sWDnr]|\n|\r|\[\^/.test(t))return new hE(e,t,n,i,s);this.re=new RegExp(t,$x+(n!=null&&n.ignoreCase?"i":"")),this.test=n==null?void 0:n.test,this.iter=e.iter();let a=e.lineAt(i);this.curLineStart=a.from,this.matchPos=e0(e,i),this.getLine(this.curLineStart)}getLine(e){this.iter.next(e),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let e=this.matchPos-this.curLineStart;;){this.re.lastIndex=e;let t=this.matchPos<=this.to&&this.re.exec(this.curLine);if(t){let n=this.curLineStart+t.index,i=n+t[0].length;if(this.matchPos=e0(this.text,i+(n==i?1:0)),n==this.curLineStart+this.curLine.length&&this.nextLine(),(n<i||n>this.value.to)&&(!this.test||this.test(n,i,t)))return this.value={from:n,to:i,match:t},this;e=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to)this.nextLine(),e=0;else return this.done=!0,this}}}const zp=new WeakMap;class Pl{constructor(e,t){this.from=e,this.text=t}get to(){return this.from+this.text.length}static get(e,t,n){let i=zp.get(e);if(!i||i.from>=n||i.to<=t){let o=new Pl(t,e.sliceString(t,n));return zp.set(e,o),o}if(i.from==t&&i.to==n)return i;let{text:s,from:a}=i;return a>t&&(s=e.sliceString(t,a)+s,a=t),i.to<n&&(s+=e.sliceString(i.to,n)),zp.set(e,new Pl(a,s)),new Pl(t,s.slice(t-a,n-a))}}class hE{constructor(e,t,n,i,s){this.text=e,this.to=s,this.done=!1,this.value=fE,this.matchPos=e0(e,i),this.re=new RegExp(t,$x+(n!=null&&n.ignoreCase?"i":"")),this.test=n==null?void 0:n.test,this.flat=Pl.get(e,i,this.chunkEnd(i+5e3))}chunkEnd(e){return e>=this.to?this.to:this.text.lineAt(e).to}next(){for(;;){let e=this.re.lastIndex=this.matchPos-this.flat.from,t=this.re.exec(this.flat.text);if(t&&!t[0]&&t.index==e&&(this.re.lastIndex=e+1,t=this.re.exec(this.flat.text)),t){let n=this.flat.from+t.index,i=n+t[0].length;if((this.flat.to>=this.to||t.index+t[0].length<=this.flat.text.length-10)&&(!this.test||this.test(n,i,t)))return this.value={from:n,to:i,match:t},this.matchPos=e0(this.text,i+(n==i?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=Pl.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2))}}}typeof Symbol<"u"&&(cE.prototype[Symbol.iterator]=hE.prototype[Symbol.iterator]=function(){return this});function SH(r){try{return new RegExp(r,$x),!0}catch{return!1}}function e0(r,e){if(e>=r.length)return e;let t=r.lineAt(e),n;for(;e<t.to&&(n=t.text.charCodeAt(e-t.from))>=56320&&n<57344;)e++;return e}function l1(r){let e=String(r.state.doc.lineAt(r.state.selection.main.head).number),t=rr("input",{class:"cm-textfield",name:"line",value:e}),n=rr("form",{class:"cm-gotoLine",onkeydown:s=>{s.keyCode==27?(s.preventDefault(),r.dispatch({effects:t0.of(!1)}),r.focus()):s.keyCode==13&&(s.preventDefault(),i())},onsubmit:s=>{s.preventDefault(),i()}},rr("label",r.state.phrase("Go to line"),": ",t)," ",rr("button",{class:"cm-button",type:"submit"},r.state.phrase("go")));function i(){let s=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(t.value);if(!s)return;let{state:a}=r,o=a.doc.lineAt(a.selection.main.head),[,l,f,c,h]=s,u=c?+c.slice(1):0,d=f?+f:o.number;if(f&&h){let g=d/100;l&&(g=g*(l=="-"?-1:1)+o.number/a.doc.lines),d=Math.round(a.doc.lines*g)}else f&&l&&(d=d*(l=="-"?-1:1)+o.number);let p=a.doc.line(Math.max(1,Math.min(a.doc.lines,d))),m=xe.cursor(p.from+Math.max(0,Math.min(u,p.length)));r.dispatch({effects:[t0.of(!1),Be.scrollIntoView(m.from,{y:"center"})],selection:m}),r.focus()}return{dom:n}}const t0=ot.define(),Vb=Cr.define({create(){return!0},update(r,e){for(let t of e.effects)t.is(t0)&&(r=t.value);return r},provide:r=>Gc.from(r,e=>e?l1:null)}),TH=r=>{let e=zc(r,l1);if(!e){let t=[t0.of(!0)];r.state.field(Vb,!1)==null&&t.push(ot.appendConfig.of([Vb,CH])),r.dispatch({effects:t}),e=zc(r,l1)}return e&&e.dom.querySelector("input").select(),!0},CH=Be.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px","& label":{fontSize:"80%"}}}),AH={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},EH=Le.define({combine(r){return $s(r,AH,{highlightWordAroundCursor:(e,t)=>e||t,minSelectionLength:Math.min,maxMatches:Math.min})}});function PH(r){return[NH,$H]}const RH=ze.mark({class:"cm-selectionMatch"}),QH=ze.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function qb(r,e,t,n){return(t==0||r(e.sliceDoc(t-1,t))!=pr.Word)&&(n==e.doc.length||r(e.sliceDoc(n,n+1))!=pr.Word)}function FH(r,e,t,n){return r(e.sliceDoc(t,t+1))==pr.Word&&r(e.sliceDoc(n-1,n))==pr.Word}const $H=gr.fromClass(class{constructor(r){this.decorations=this.getDeco(r)}update(r){(r.selectionSet||r.docChanged||r.viewportChanged)&&(this.decorations=this.getDeco(r.view))}getDeco(r){let e=r.state.facet(EH),{state:t}=r,n=t.selection;if(n.ranges.length>1)return ze.none;let i=n.main,s,a=null;if(i.empty){if(!e.highlightWordAroundCursor)return ze.none;let l=t.wordAt(i.head);if(!l)return ze.none;a=t.charCategorizer(i.head),s=t.sliceDoc(l.from,l.to)}else{let l=i.to-i.from;if(l<e.minSelectionLength||l>200)return ze.none;if(e.wholeWords){if(s=t.sliceDoc(i.from,i.to),a=t.charCategorizer(i.head),!(qb(a,t,i.from,i.to)&&FH(a,t,i.from,i.to)))return ze.none}else if(s=t.sliceDoc(i.from,i.to),!s)return ze.none}let o=[];for(let l of r.visibleRanges){let f=new ql(t.doc,s,l.from,l.to);for(;!f.next().done;){let{from:c,to:h}=f.value;if((!a||qb(a,t,c,h))&&(i.empty&&c<=i.from&&h>=i.to?o.push(QH.range(c,h)):(c>=i.to||h<=i.from)&&o.push(RH.range(c,h)),o.length>e.maxMatches))return ze.none}}return ze.set(o)}},{decorations:r=>r.decorations}),NH=Be.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}}),DH=({state:r,dispatch:e})=>{let{selection:t}=r,n=xe.create(t.ranges.map(i=>r.wordAt(i.head)||xe.cursor(i.head)),t.mainIndex);return n.eq(t)?!1:(e(r.update({selection:n})),!0)};function MH(r,e){let{main:t,ranges:n}=r.selection,i=r.wordAt(t.head),s=i&&i.from==t.from&&i.to==t.to;for(let a=!1,o=new ql(r.doc,e,n[n.length-1].to);;)if(o.next(),o.done){if(a)return null;o=new ql(r.doc,e,0,Math.max(0,n[n.length-1].from-1)),a=!0}else{if(a&&n.some(l=>l.from==o.value.from))continue;if(s){let l=r.wordAt(o.value.from);if(!l||l.from!=o.value.from||l.to!=o.value.to)continue}return o.value}}const IH=({state:r,dispatch:e})=>{let{ranges:t}=r.selection;if(t.some(s=>s.from===s.to))return DH({state:r,dispatch:e});let n=r.sliceDoc(t[0].from,t[0].to);if(r.selection.ranges.some(s=>r.sliceDoc(s.from,s.to)!=n))return!1;let i=MH(r,n);return i?(e(r.update({selection:r.selection.addRange(xe.range(i.from,i.to),!1),effects:Be.scrollIntoView(i.to)})),!0):!1},gf=Le.define({combine(r){return $s(r,{top:!1,caseSensitive:!1,literal:!1,regexp:!1,wholeWord:!1,createPanel:e=>new HH(e),scrollToMatch:e=>Be.scrollIntoView(e)})}});class uE{constructor(e){this.search=e.search,this.caseSensitive=!!e.caseSensitive,this.literal=!!e.literal,this.regexp=!!e.regexp,this.replace=e.replace||"",this.valid=!!this.search&&(!this.regexp||SH(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!e.wholeWord}unquote(e){return this.literal?e:e.replace(/\\([nrt\\])/g,(t,n)=>n=="n"?`
`:n=="r"?"\r":n=="t"?"	":"\\")}eq(e){return this.search==e.search&&this.replace==e.replace&&this.caseSensitive==e.caseSensitive&&this.regexp==e.regexp&&this.wholeWord==e.wholeWord}create(){return this.regexp?new WH(this):new BH(this)}getCursor(e,t=0,n){let i=e.doc?e:lt.create({doc:e});return n==null&&(n=i.doc.length),this.regexp?cl(this,i,t,n):fl(this,i,t,n)}}class dE{constructor(e){this.spec=e}}function fl(r,e,t,n){return new ql(e.doc,r.unquoted,t,n,r.caseSensitive?void 0:i=>i.toLowerCase(),r.wholeWord?LH(e.doc,e.charCategorizer(e.selection.main.head)):void 0)}function LH(r,e){return(t,n,i,s)=>((s>t||s+i.length<n)&&(s=Math.max(0,t-2),i=r.sliceString(s,Math.min(r.length,n+2))),(e(r0(i,t-s))!=pr.Word||e(n0(i,t-s))!=pr.Word)&&(e(n0(i,n-s))!=pr.Word||e(r0(i,n-s))!=pr.Word))}class BH extends dE{constructor(e){super(e)}nextMatch(e,t,n){let i=fl(this.spec,e,n,e.doc.length).nextOverlapping();if(i.done){let s=Math.min(e.doc.length,t+this.spec.unquoted.length);i=fl(this.spec,e,0,s).nextOverlapping()}return i.done||i.value.from==t&&i.value.to==n?null:i.value}prevMatchInRange(e,t,n){for(let i=n;;){let s=Math.max(t,i-1e4-this.spec.unquoted.length),a=fl(this.spec,e,s,i),o=null;for(;!a.nextOverlapping().done;)o=a.value;if(o)return o;if(s==t)return null;i-=1e4}}prevMatch(e,t,n){let i=this.prevMatchInRange(e,0,t);return i||(i=this.prevMatchInRange(e,Math.max(0,n-this.spec.unquoted.length),e.doc.length)),i&&(i.from!=t||i.to!=n)?i:null}getReplacement(e){return this.spec.unquote(this.spec.replace)}matchAll(e,t){let n=fl(this.spec,e,0,e.doc.length),i=[];for(;!n.next().done;){if(i.length>=t)return null;i.push(n.value)}return i}highlight(e,t,n,i){let s=fl(this.spec,e,Math.max(0,t-this.spec.unquoted.length),Math.min(n+this.spec.unquoted.length,e.doc.length));for(;!s.next().done;)i(s.value.from,s.value.to)}}function cl(r,e,t,n){return new cE(e.doc,r.search,{ignoreCase:!r.caseSensitive,test:r.wholeWord?ZH(e.charCategorizer(e.selection.main.head)):void 0},t,n)}function r0(r,e){return r.slice(un(r,e,!1),e)}function n0(r,e){return r.slice(e,un(r,e))}function ZH(r){return(e,t,n)=>!n[0].length||(r(r0(n.input,n.index))!=pr.Word||r(n0(n.input,n.index))!=pr.Word)&&(r(n0(n.input,n.index+n[0].length))!=pr.Word||r(r0(n.input,n.index+n[0].length))!=pr.Word)}class WH extends dE{nextMatch(e,t,n){let i=cl(this.spec,e,n,e.doc.length).next();return i.done&&(i=cl(this.spec,e,0,t).next()),i.done?null:i.value}prevMatchInRange(e,t,n){for(let i=1;;i++){let s=Math.max(t,n-i*1e4),a=cl(this.spec,e,s,n),o=null;for(;!a.next().done;)o=a.value;if(o&&(s==t||o.from>s+10))return o;if(s==t)return null}}prevMatch(e,t,n){return this.prevMatchInRange(e,0,t)||this.prevMatchInRange(e,n,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace).replace(/\$([$&\d+])/g,(t,n)=>n=="$"?"$":n=="&"?e.match[0]:n!="0"&&+n<e.match.length?e.match[n]:t)}matchAll(e,t){let n=cl(this.spec,e,0,e.doc.length),i=[];for(;!n.next().done;){if(i.length>=t)return null;i.push(n.value)}return i}highlight(e,t,n,i){let s=cl(this.spec,e,Math.max(0,t-250),Math.min(n+250,e.doc.length));for(;!s.next().done;)i(s.value.from,s.value.to)}}const Kc=ot.define(),Nx=ot.define(),Qa=Cr.define({create(r){return new Gp(f1(r).create(),null)},update(r,e){for(let t of e.effects)t.is(Kc)?r=new Gp(t.value.create(),r.panel):t.is(Nx)&&(r=new Gp(r.query,t.value?Dx:null));return r},provide:r=>Gc.from(r,e=>e.panel)});class Gp{constructor(e,t){this.query=e,this.panel=t}}const UH=ze.mark({class:"cm-searchMatch"}),XH=ze.mark({class:"cm-searchMatch cm-searchMatch-selected"}),VH=gr.fromClass(class{constructor(r){this.view=r,this.decorations=this.highlight(r.state.field(Qa))}update(r){let e=r.state.field(Qa);(e!=r.startState.field(Qa)||r.docChanged||r.selectionSet||r.viewportChanged)&&(this.decorations=this.highlight(e))}highlight({query:r,panel:e}){if(!e||!r.spec.valid)return ze.none;let{view:t}=this,n=new Gs;for(let i=0,s=t.visibleRanges,a=s.length;i<a;i++){let{from:o,to:l}=s[i];for(;i<a-1&&l>s[i+1].from-2*250;)l=s[++i].to;r.highlight(t.state,o,l,(f,c)=>{let h=t.state.selection.ranges.some(u=>u.from==f&&u.to==c);n.add(f,c,h?XH:UH)})}return n.finish()}},{decorations:r=>r.decorations});function $h(r){return e=>{let t=e.state.field(Qa,!1);return t&&t.query.spec.valid?r(e,t):gE(e)}}const i0=$h((r,{query:e})=>{let{to:t}=r.state.selection.main,n=e.nextMatch(r.state,t,t);if(!n)return!1;let i=xe.single(n.from,n.to),s=r.state.facet(gf);return r.dispatch({selection:i,effects:[Mx(r,n),s.scrollToMatch(i.main,r)],userEvent:"select.search"}),mE(r),!0}),s0=$h((r,{query:e})=>{let{state:t}=r,{from:n}=t.selection.main,i=e.prevMatch(t,n,n);if(!i)return!1;let s=xe.single(i.from,i.to),a=r.state.facet(gf);return r.dispatch({selection:s,effects:[Mx(r,i),a.scrollToMatch(s.main,r)],userEvent:"select.search"}),mE(r),!0}),qH=$h((r,{query:e})=>{let t=e.matchAll(r.state,1e3);return!t||!t.length?!1:(r.dispatch({selection:xe.create(t.map(n=>xe.range(n.from,n.to))),userEvent:"select.search.matches"}),!0)}),jH=({state:r,dispatch:e})=>{let t=r.selection;if(t.ranges.length>1||t.main.empty)return!1;let{from:n,to:i}=t.main,s=[],a=0;for(let o=new ql(r.doc,r.sliceDoc(n,i));!o.next().done;){if(s.length>1e3)return!1;o.value.from==n&&(a=s.length),s.push(xe.range(o.value.from,o.value.to))}return e(r.update({selection:xe.create(s,a),userEvent:"select.search.matches"})),!0},jb=$h((r,{query:e})=>{let{state:t}=r,{from:n,to:i}=t.selection.main;if(t.readOnly)return!1;let s=e.nextMatch(t,n,n);if(!s)return!1;let a=s,o=[],l,f,c=[];if(a.from==n&&a.to==i&&(f=t.toText(e.getReplacement(a)),o.push({from:a.from,to:a.to,insert:f}),a=e.nextMatch(t,a.from,a.to),c.push(Be.announce.of(t.phrase("replaced match on line $",t.doc.lineAt(n).number)+"."))),a){let h=o.length==0||o[0].from>=s.to?0:s.to-s.from-f.length;l=xe.single(a.from-h,a.to-h),c.push(Mx(r,a)),c.push(t.facet(gf).scrollToMatch(l.main,r))}return r.dispatch({changes:o,selection:l,effects:c,userEvent:"input.replace"}),!0}),zH=$h((r,{query:e})=>{if(r.state.readOnly)return!1;let t=e.matchAll(r.state,1e9).map(i=>{let{from:s,to:a}=i;return{from:s,to:a,insert:e.getReplacement(i)}});if(!t.length)return!1;let n=r.state.phrase("replaced $ matches",t.length)+".";return r.dispatch({changes:t,effects:Be.announce.of(n),userEvent:"input.replace.all"}),!0});function Dx(r){return r.state.facet(gf).createPanel(r)}function f1(r,e){var t,n,i,s,a;let o=r.selection.main,l=o.empty||o.to>o.from+100?"":r.sliceDoc(o.from,o.to);if(e&&!l)return e;let f=r.facet(gf);return new uE({search:((t=e==null?void 0:e.literal)!==null&&t!==void 0?t:f.literal)?l:l.replace(/\n/g,"\\n"),caseSensitive:(n=e==null?void 0:e.caseSensitive)!==null&&n!==void 0?n:f.caseSensitive,literal:(i=e==null?void 0:e.literal)!==null&&i!==void 0?i:f.literal,regexp:(s=e==null?void 0:e.regexp)!==null&&s!==void 0?s:f.regexp,wholeWord:(a=e==null?void 0:e.wholeWord)!==null&&a!==void 0?a:f.wholeWord})}function pE(r){let e=zc(r,Dx);return e&&e.dom.querySelector("[main-field]")}function mE(r){let e=pE(r);e&&e==r.root.activeElement&&e.select()}const gE=r=>{let e=r.state.field(Qa,!1);if(e&&e.panel){let t=pE(r);if(t&&t!=r.root.activeElement){let n=f1(r.state,e.query.spec);n.valid&&r.dispatch({effects:Kc.of(n)}),t.focus(),t.select()}}else r.dispatch({effects:[Nx.of(!0),e?Kc.of(f1(r.state,e.query.spec)):ot.appendConfig.of(KH)]});return!0},OE=r=>{let e=r.state.field(Qa,!1);if(!e||!e.panel)return!1;let t=zc(r,Dx);return t&&t.dom.contains(r.root.activeElement)&&r.focus(),r.dispatch({effects:Nx.of(!1)}),!0},GH=[{key:"Mod-f",run:gE,scope:"editor search-panel"},{key:"F3",run:i0,shift:s0,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:i0,shift:s0,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:OE,scope:"editor search-panel"},{key:"Mod-Shift-l",run:jH},{key:"Mod-Alt-g",run:TH},{key:"Mod-d",run:IH,preventDefault:!0}];class HH{constructor(e){this.view=e;let t=this.query=e.state.field(Qa).query.spec;this.commit=this.commit.bind(this),this.searchField=rr("input",{value:t.search,placeholder:Hn(e,"Find"),"aria-label":Hn(e,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=rr("input",{value:t.replace,placeholder:Hn(e,"Replace"),"aria-label":Hn(e,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=rr("input",{type:"checkbox",name:"case",form:"",checked:t.caseSensitive,onchange:this.commit}),this.reField=rr("input",{type:"checkbox",name:"re",form:"",checked:t.regexp,onchange:this.commit}),this.wordField=rr("input",{type:"checkbox",name:"word",form:"",checked:t.wholeWord,onchange:this.commit});function n(i,s,a){return rr("button",{class:"cm-button",name:i,onclick:s,type:"button"},a)}this.dom=rr("div",{onkeydown:i=>this.keydown(i),class:"cm-search"},[this.searchField,n("next",()=>i0(e),[Hn(e,"next")]),n("prev",()=>s0(e),[Hn(e,"previous")]),n("select",()=>qH(e),[Hn(e,"all")]),rr("label",null,[this.caseField,Hn(e,"match case")]),rr("label",null,[this.reField,Hn(e,"regexp")]),rr("label",null,[this.wordField,Hn(e,"by word")]),...e.state.readOnly?[]:[rr("br"),this.replaceField,n("replace",()=>jb(e),[Hn(e,"replace")]),n("replaceAll",()=>zH(e),[Hn(e,"replace all")])],rr("button",{name:"close",onclick:()=>OE(e),"aria-label":Hn(e,"close"),type:"button"},[""])])}commit(){let e=new uE({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});e.eq(this.query)||(this.query=e,this.view.dispatch({effects:Kc.of(e)}))}keydown(e){Jq(this.view,e,"search-panel")?e.preventDefault():e.keyCode==13&&e.target==this.searchField?(e.preventDefault(),(e.shiftKey?s0:i0)(this.view)):e.keyCode==13&&e.target==this.replaceField&&(e.preventDefault(),jb(this.view))}update(e){for(let t of e.transactions)for(let n of t.effects)n.is(Kc)&&!n.value.eq(this.query)&&this.setQuery(n.value)}setQuery(e){this.query=e,this.searchField.value=e.search,this.replaceField.value=e.replace,this.caseField.checked=e.caseSensitive,this.reField.checked=e.regexp,this.wordField.checked=e.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(gf).top}}function Hn(r,e){return r.state.phrase(e)}const yu=30,wu=/[\s\.,:;?!]/;function Mx(r,{from:e,to:t}){let n=r.state.doc.lineAt(e),i=r.state.doc.lineAt(t).to,s=Math.max(n.from,e-yu),a=Math.min(i,t+yu),o=r.state.sliceDoc(s,a);if(s!=n.from){for(let l=0;l<yu;l++)if(!wu.test(o[l+1])&&wu.test(o[l])){o=o.slice(l);break}}if(a!=i){for(let l=o.length-1;l>o.length-yu;l--)if(!wu.test(o[l-1])&&wu.test(o[l])){o=o.slice(0,l);break}}return Be.announce.of(`${r.state.phrase("current match")}. ${o} ${r.state.phrase("on line")} ${n.number}.`)}const YH=Be.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),KH=[Qa,za.low(VH),YH];class xE{constructor(e,t,n,i){this.state=e,this.pos=t,this.explicit=n,this.view=i,this.abortListeners=[],this.abortOnDocChange=!1}tokenBefore(e){let t=Cn(this.state).resolveInner(this.pos,-1);for(;t&&e.indexOf(t.name)<0;)t=t.parent;return t?{from:t.from,to:this.pos,text:this.state.sliceDoc(t.from,this.pos),type:t.type}:null}matchBefore(e){let t=this.state.doc.lineAt(this.pos),n=Math.max(t.from,this.pos-250),i=t.text.slice(n-t.from,this.pos-t.from),s=i.search(vE(e,!1));return s<0?null:{from:n+s,to:this.pos,text:i.slice(s)}}get aborted(){return this.abortListeners==null}addEventListener(e,t,n){e=="abort"&&this.abortListeners&&(this.abortListeners.push(t),n&&n.onDocChange&&(this.abortOnDocChange=!0))}}function zb(r){let e=Object.keys(r).join(""),t=/\w/.test(e);return t&&(e=e.replace(/\w/g,"")),`[${t?"\\w":""}${e.replace(/[^\w\s]/g,"\\$&")}]`}function JH(r){let e=Object.create(null),t=Object.create(null);for(let{label:i}of r){e[i[0]]=!0;for(let s=1;s<i.length;s++)t[i[s]]=!0}let n=zb(e)+zb(t)+"*$";return[new RegExp("^"+n),new RegExp(n)]}function eY(r){let e=r.map(i=>typeof i=="string"?{label:i}:i),[t,n]=e.every(i=>/^\w+$/.test(i.label))?[/\w*$/,/\w+$/]:JH(e);return i=>{let s=i.matchBefore(n);return s||i.explicit?{from:s?s.from:i.pos,options:e,validFor:t}:null}}class Gb{constructor(e,t,n,i){this.completion=e,this.source=t,this.match=n,this.score=i}}function _o(r){return r.selection.main.from}function vE(r,e){var t;let{source:n}=r,i=e&&n[0]!="^",s=n[n.length-1]!="$";return!i&&!s?r:new RegExp(`${i?"^":""}(?:${n})${s?"$":""}`,(t=r.flags)!==null&&t!==void 0?t:r.ignoreCase?"i":"")}const yE=Fs.define();function tY(r,e,t,n){let{main:i}=r.selection,s=t-i.from,a=n-i.from;return Object.assign(Object.assign({},r.changeByRange(o=>{if(o!=i&&t!=n&&r.sliceDoc(o.from+s,o.from+a)!=r.sliceDoc(t,n))return{range:o};let l=r.toText(e);return{changes:{from:o.from+s,to:n==i.from?o.to:o.from+a,insert:l},range:xe.cursor(o.from+s+l.length)}})),{scrollIntoView:!0,userEvent:"input.complete"})}const Hb=new WeakMap;function rY(r){if(!Array.isArray(r))return r;let e=Hb.get(r);return e||Hb.set(r,e=eY(r)),e}const a0=ot.define(),Jc=ot.define();class nY{constructor(e){this.pattern=e,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[],this.score=0,this.matched=[];for(let t=0;t<e.length;){let n=Wn(e,t),i=ds(n);this.chars.push(n);let s=e.slice(t,t+i),a=s.toUpperCase();this.folded.push(Wn(a==s?s.toLowerCase():a,0)),t+=i}this.astral=e.length!=this.chars.length}ret(e,t){return this.score=e,this.matched=t,this}match(e){if(this.pattern.length==0)return this.ret(-100,[]);if(e.length<this.pattern.length)return null;let{chars:t,folded:n,any:i,precise:s,byWord:a}=this;if(t.length==1){let w=Wn(e,0),x=ds(w),S=x==e.length?0:-100;if(w!=t[0])if(w==n[0])S+=-200;else return null;return this.ret(S,[0,x])}let o=e.indexOf(this.pattern);if(o==0)return this.ret(e.length==this.pattern.length?0:-100,[0,this.pattern.length]);let l=t.length,f=0;if(o<0){for(let w=0,x=Math.min(e.length,200);w<x&&f<l;){let S=Wn(e,w);(S==t[f]||S==n[f])&&(i[f++]=w),w+=ds(S)}if(f<l)return null}let c=0,h=0,u=!1,d=0,p=-1,m=-1,g=/[a-z]/.test(e),v=!0;for(let w=0,x=Math.min(e.length,200),S=0;w<x&&h<l;){let y=Wn(e,w);o<0&&(c<l&&y==t[c]&&(s[c++]=w),d<l&&(y==t[d]||y==n[d]?(d==0&&(p=w),m=w+1,d++):d=0));let b,O=y<255?y>=48&&y<=57||y>=97&&y<=122?2:y>=65&&y<=90?1:0:(b=cx(y))!=b.toLowerCase()?1:b!=b.toUpperCase()?2:0;(!w||O==1&&g||S==0&&O!=0)&&(t[h]==y||n[h]==y&&(u=!0)?a[h++]=w:a.length&&(v=!1)),S=O,w+=ds(y)}return h==l&&a[0]==0&&v?this.result(-100+(u?-200:0),a,e):d==l&&p==0?this.ret(-200-e.length+(m==e.length?0:-100),[0,m]):o>-1?this.ret(-700-e.length,[o,o+this.pattern.length]):d==l?this.ret(-900-e.length,[p,m]):h==l?this.result(-100+(u?-200:0)+-700+(v?0:-1100),a,e):t.length==2?null:this.result((i[0]?-700:0)+-200+-1100,i,e)}result(e,t,n){let i=[],s=0;for(let a of t){let o=a+(this.astral?ds(Wn(n,a)):1);s&&i[s-1]==a?i[s-1]=o:(i[s++]=a,i[s++]=o)}return this.ret(e-n.length,i)}}class iY{constructor(e){this.pattern=e,this.matched=[],this.score=0,this.folded=e.toLowerCase()}match(e){if(e.length<this.pattern.length)return null;let t=e.slice(0,this.pattern.length),n=t==this.pattern?0:t.toLowerCase()==this.folded?-200:null;return n==null?null:(this.matched=[0,t.length],this.score=n+(e.length==this.pattern.length?0:-100),this)}}const Yr=Le.define({combine(r){return $s(r,{activateOnTyping:!0,activateOnCompletion:()=>!1,activateOnTypingDelay:100,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:sY,filterStrict:!1,compareCompletions:(e,t)=>e.label.localeCompare(t.label),interactionDelay:75,updateSyncTime:100},{defaultKeymap:(e,t)=>e&&t,closeOnBlur:(e,t)=>e&&t,icons:(e,t)=>e&&t,tooltipClass:(e,t)=>n=>Yb(e(n),t(n)),optionClass:(e,t)=>n=>Yb(e(n),t(n)),addToOptions:(e,t)=>e.concat(t),filterStrict:(e,t)=>e||t})}});function Yb(r,e){return r?e?r+" "+e:r:e}function sY(r,e,t,n,i,s){let a=r.textDirection==Rt.RTL,o=a,l=!1,f="top",c,h,u=e.left-i.left,d=i.right-e.right,p=n.right-n.left,m=n.bottom-n.top;if(o&&u<Math.min(p,d)?o=!1:!o&&d<Math.min(p,u)&&(o=!0),p<=(o?u:d))c=Math.max(i.top,Math.min(t.top,i.bottom-m))-e.top,h=Math.min(400,o?u:d);else{l=!0,h=Math.min(400,(a?e.right:i.right-e.left)-30);let w=i.bottom-e.bottom;w>=m||w>e.top?c=t.bottom-e.top:(f="bottom",c=e.bottom-t.top)}let g=(e.bottom-e.top)/s.offsetHeight,v=(e.right-e.left)/s.offsetWidth;return{style:`${f}: ${c/g}px; max-width: ${h/v}px`,class:"cm-completionInfo-"+(l?a?"left-narrow":"right-narrow":o?"left":"right")}}function aY(r){let e=r.addToOptions.slice();return r.icons&&e.push({render(t){let n=document.createElement("div");return n.classList.add("cm-completionIcon"),t.type&&n.classList.add(...t.type.split(/\s+/g).map(i=>"cm-completionIcon-"+i)),n.setAttribute("aria-hidden","true"),n},position:20}),e.push({render(t,n,i,s){let a=document.createElement("span");a.className="cm-completionLabel";let o=t.displayLabel||t.label,l=0;for(let f=0;f<s.length;){let c=s[f++],h=s[f++];c>l&&a.appendChild(document.createTextNode(o.slice(l,c)));let u=a.appendChild(document.createElement("span"));u.appendChild(document.createTextNode(o.slice(c,h))),u.className="cm-completionMatchedText",l=h}return l<o.length&&a.appendChild(document.createTextNode(o.slice(l))),a},position:50},{render(t){if(!t.detail)return null;let n=document.createElement("span");return n.className="cm-completionDetail",n.textContent=t.detail,n},position:80}),e.sort((t,n)=>t.position-n.position).map(t=>t.render)}function Hp(r,e,t){if(r<=t)return{from:0,to:r};if(e<0&&(e=0),e<=r>>1){let i=Math.floor(e/t);return{from:i*t,to:(i+1)*t}}let n=Math.floor((r-e)/t);return{from:r-(n+1)*t,to:r-n*t}}class oY{constructor(e,t,n){this.view=e,this.stateField=t,this.applyCompletion=n,this.info=null,this.infoDestroy=null,this.placeInfoReq={read:()=>this.measureInfo(),write:l=>this.placeInfo(l),key:this},this.space=null,this.currentClass="";let i=e.state.field(t),{options:s,selected:a}=i.open,o=e.state.facet(Yr);this.optionContent=aY(o),this.optionClass=o.optionClass,this.tooltipClass=o.tooltipClass,this.range=Hp(s.length,a,o.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(e.state),this.dom.addEventListener("mousedown",l=>{let{options:f}=e.state.field(t).open;for(let c=l.target,h;c&&c!=this.dom;c=c.parentNode)if(c.nodeName=="LI"&&(h=/-(\d+)$/.exec(c.id))&&+h[1]<f.length){this.applyCompletion(e,f[+h[1]]),l.preventDefault();return}}),this.dom.addEventListener("focusout",l=>{let f=e.state.field(this.stateField,!1);f&&f.tooltip&&e.state.facet(Yr).closeOnBlur&&l.relatedTarget!=e.contentDOM&&e.dispatch({effects:Jc.of(null)})}),this.showOptions(s,i.id)}mount(){this.updateSel()}showOptions(e,t){this.list&&this.list.remove(),this.list=this.dom.appendChild(this.createListBox(e,t,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)})}update(e){var t;let n=e.state.field(this.stateField),i=e.startState.field(this.stateField);if(this.updateTooltipClass(e.state),n!=i){let{options:s,selected:a,disabled:o}=n.open;(!i.open||i.open.options!=s)&&(this.range=Hp(s.length,a,e.state.facet(Yr).maxRenderedOptions),this.showOptions(s,n.id)),this.updateSel(),o!=((t=i.open)===null||t===void 0?void 0:t.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!o)}}updateTooltipClass(e){let t=this.tooltipClass(e);if(t!=this.currentClass){for(let n of this.currentClass.split(" "))n&&this.dom.classList.remove(n);for(let n of t.split(" "))n&&this.dom.classList.add(n);this.currentClass=t}}positioned(e){this.space=e,this.info&&this.view.requestMeasure(this.placeInfoReq)}updateSel(){let e=this.view.state.field(this.stateField),t=e.open;if((t.selected>-1&&t.selected<this.range.from||t.selected>=this.range.to)&&(this.range=Hp(t.options.length,t.selected,this.view.state.facet(Yr).maxRenderedOptions),this.showOptions(t.options,e.id)),this.updateSelectedOption(t.selected)){this.destroyInfo();let{completion:n}=t.options[t.selected],{info:i}=n;if(!i)return;let s=typeof i=="string"?document.createTextNode(i):i(n);if(!s)return;"then"in s?s.then(a=>{a&&this.view.state.field(this.stateField,!1)==e&&this.addInfoPane(a,n)}).catch(a=>Jr(this.view.state,a,"completion info")):this.addInfoPane(s,n)}}addInfoPane(e,t){this.destroyInfo();let n=this.info=document.createElement("div");if(n.className="cm-tooltip cm-completionInfo",e.nodeType!=null)n.appendChild(e),this.infoDestroy=null;else{let{dom:i,destroy:s}=e;n.appendChild(i),this.infoDestroy=s||null}this.dom.appendChild(n),this.view.requestMeasure(this.placeInfoReq)}updateSelectedOption(e){let t=null;for(let n=this.list.firstChild,i=this.range.from;n;n=n.nextSibling,i++)n.nodeName!="LI"||!n.id?i--:i==e?n.hasAttribute("aria-selected")||(n.setAttribute("aria-selected","true"),t=n):n.hasAttribute("aria-selected")&&n.removeAttribute("aria-selected");return t&&fY(this.list,t),t}measureInfo(){let e=this.dom.querySelector("[aria-selected]");if(!e||!this.info)return null;let t=this.dom.getBoundingClientRect(),n=this.info.getBoundingClientRect(),i=e.getBoundingClientRect(),s=this.space;if(!s){let a=this.dom.ownerDocument.defaultView||window;s={left:0,top:0,right:a.innerWidth,bottom:a.innerHeight}}return i.top>Math.min(s.bottom,t.bottom)-10||i.bottom<Math.max(s.top,t.top)+10?null:this.view.state.facet(Yr).positionInfo(this.view,t,i,n,s,this.dom)}placeInfo(e){this.info&&(e?(e.style&&(this.info.style.cssText=e.style),this.info.className="cm-tooltip cm-completionInfo "+(e.class||"")):this.info.style.cssText="top: -1e6px")}createListBox(e,t,n){const i=document.createElement("ul");i.id=t,i.setAttribute("role","listbox"),i.setAttribute("aria-expanded","true"),i.setAttribute("aria-label",this.view.state.phrase("Completions"));let s=null;for(let a=n.from;a<n.to;a++){let{completion:o,match:l}=e[a],{section:f}=o;if(f){let u=typeof f=="string"?f:f.name;if(u!=s&&(a>n.from||n.from==0))if(s=u,typeof f!="string"&&f.header)i.appendChild(f.header(f));else{let d=i.appendChild(document.createElement("completion-section"));d.textContent=u}}const c=i.appendChild(document.createElement("li"));c.id=t+"-"+a,c.setAttribute("role","option");let h=this.optionClass(o);h&&(c.className=h);for(let u of this.optionContent){let d=u(o,this.view.state,this.view,l);d&&c.appendChild(d)}}return n.from&&i.classList.add("cm-completionListIncompleteTop"),n.to<e.length&&i.classList.add("cm-completionListIncompleteBottom"),i}destroyInfo(){this.info&&(this.infoDestroy&&this.infoDestroy(),this.info.remove(),this.info=null)}destroy(){this.destroyInfo()}}function lY(r,e){return t=>new oY(t,r,e)}function fY(r,e){let t=r.getBoundingClientRect(),n=e.getBoundingClientRect(),i=t.height/r.offsetHeight;n.top<t.top?r.scrollTop-=(t.top-n.top)/i:n.bottom>t.bottom&&(r.scrollTop+=(n.bottom-t.bottom)/i)}function Kb(r){return(r.boost||0)*100+(r.apply?10:0)+(r.info?5:0)+(r.type?1:0)}function cY(r,e){let t=[],n=null,i=f=>{t.push(f);let{section:c}=f.completion;if(c){n||(n=[]);let h=typeof c=="string"?c:c.name;n.some(u=>u.name==h)||n.push(typeof c=="string"?{name:h}:c)}},s=e.facet(Yr);for(let f of r)if(f.hasResult()){let c=f.result.getMatch;if(f.result.filter===!1)for(let h of f.result.options)i(new Gb(h,f.source,c?c(h):[],1e9-t.length));else{let h=e.sliceDoc(f.from,f.to),u,d=s.filterStrict?new iY(h):new nY(h);for(let p of f.result.options)if(u=d.match(p.label)){let m=p.displayLabel?c?c(p,u.matched):[]:u.matched;i(new Gb(p,f.source,m,u.score+(p.boost||0)))}}}if(n){let f=Object.create(null),c=0,h=(u,d)=>{var p,m;return((p=u.rank)!==null&&p!==void 0?p:1e9)-((m=d.rank)!==null&&m!==void 0?m:1e9)||(u.name<d.name?-1:1)};for(let u of n.sort(h))c-=1e5,f[u.name]=c;for(let u of t){let{section:d}=u.completion;d&&(u.score+=f[typeof d=="string"?d:d.name])}}let a=[],o=null,l=s.compareCompletions;for(let f of t.sort((c,h)=>h.score-c.score||l(c.completion,h.completion))){let c=f.completion;!o||o.label!=c.label||o.detail!=c.detail||o.type!=null&&c.type!=null&&o.type!=c.type||o.apply!=c.apply||o.boost!=c.boost?a.push(f):Kb(f.completion)>Kb(o)&&(a[a.length-1]=f),o=f.completion}return a}class ml{constructor(e,t,n,i,s,a){this.options=e,this.attrs=t,this.tooltip=n,this.timestamp=i,this.selected=s,this.disabled=a}setSelected(e,t){return e==this.selected||e>=this.options.length?this:new ml(this.options,Jb(t,e),this.tooltip,this.timestamp,e,this.disabled)}static build(e,t,n,i,s,a){if(i&&!a&&e.some(f=>f.isPending))return i.setDisabled();let o=cY(e,t);if(!o.length)return i&&e.some(f=>f.isPending)?i.setDisabled():null;let l=t.facet(Yr).selectOnOpen?0:-1;if(i&&i.selected!=l&&i.selected!=-1){let f=i.options[i.selected].completion;for(let c=0;c<o.length;c++)if(o[c].completion==f){l=c;break}}return new ml(o,Jb(n,l),{pos:e.reduce((f,c)=>c.hasResult()?Math.min(f,c.from):f,1e8),create:gY,above:s.aboveCursor},i?i.timestamp:Date.now(),l,!1)}map(e){return new ml(this.options,this.attrs,Object.assign(Object.assign({},this.tooltip),{pos:e.mapPos(this.tooltip.pos)}),this.timestamp,this.selected,this.disabled)}setDisabled(){return new ml(this.options,this.attrs,this.tooltip,this.timestamp,this.selected,!0)}}class o0{constructor(e,t,n){this.active=e,this.id=t,this.open=n}static start(){return new o0(pY,"cm-ac-"+Math.floor(Math.random()*2e6).toString(36),null)}update(e){let{state:t}=e,n=t.facet(Yr),s=(n.override||t.languageDataAt("autocomplete",_o(t)).map(rY)).map(l=>(this.active.find(c=>c.source==l)||new Ti(l,this.active.some(c=>c.state!=0)?1:0)).update(e,n));s.length==this.active.length&&s.every((l,f)=>l==this.active[f])&&(s=this.active);let a=this.open,o=e.effects.some(l=>l.is(Ix));a&&e.docChanged&&(a=a.map(e.changes)),e.selection||s.some(l=>l.hasResult()&&e.changes.touchesRange(l.from,l.to))||!hY(s,this.active)||o?a=ml.build(s,t,this.id,a,n,o):a&&a.disabled&&!s.some(l=>l.isPending)&&(a=null),!a&&s.every(l=>!l.isPending)&&s.some(l=>l.hasResult())&&(s=s.map(l=>l.hasResult()?new Ti(l.source,0):l));for(let l of e.effects)l.is(bE)&&(a=a&&a.setSelected(l.value,this.id));return s==this.active&&a==this.open?this:new o0(s,this.id,a)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:this.active.length?uY:dY}}function hY(r,e){if(r==e)return!0;for(let t=0,n=0;;){for(;t<r.length&&!r[t].hasResult();)t++;for(;n<e.length&&!e[n].hasResult();)n++;let i=t==r.length,s=n==e.length;if(i||s)return i==s;if(r[t++].result!=e[n++].result)return!1}}const uY={"aria-autocomplete":"list"},dY={};function Jb(r,e){let t={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":r};return e>-1&&(t["aria-activedescendant"]=r+"-"+e),t}const pY=[];function wE(r,e){if(r.isUserEvent("input.complete")){let n=r.annotation(yE);if(n&&e.activateOnCompletion(n))return 12}let t=r.isUserEvent("input.type");return t&&e.activateOnTyping?5:t?1:r.isUserEvent("delete.backward")?2:r.selection?8:r.docChanged?16:0}class Ti{constructor(e,t,n=!1){this.source=e,this.state=t,this.explicit=n}hasResult(){return!1}get isPending(){return this.state==1}update(e,t){let n=wE(e,t),i=this;(n&8||n&16&&this.touches(e))&&(i=new Ti(i.source,0)),n&4&&i.state==0&&(i=new Ti(this.source,1)),i=i.updateFor(e,n);for(let s of e.effects)if(s.is(a0))i=new Ti(i.source,1,s.value);else if(s.is(Jc))i=new Ti(i.source,0);else if(s.is(Ix))for(let a of s.value)a.source==i.source&&(i=a);return i}updateFor(e,t){return this.map(e.changes)}map(e){return this}touches(e){return e.changes.touchesRange(_o(e.state))}}class Rl extends Ti{constructor(e,t,n,i,s,a){super(e,3,t),this.limit=n,this.result=i,this.from=s,this.to=a}hasResult(){return!0}updateFor(e,t){var n;if(!(t&3))return this.map(e.changes);let i=this.result;i.map&&!e.changes.empty&&(i=i.map(i,e.changes));let s=e.changes.mapPos(this.from),a=e.changes.mapPos(this.to,1),o=_o(e.state);if(o>a||!i||t&2&&(_o(e.startState)==this.from||o<this.limit))return new Ti(this.source,t&4?1:0);let l=e.changes.mapPos(this.limit);return mY(i.validFor,e.state,s,a)?new Rl(this.source,this.explicit,l,i,s,a):i.update&&(i=i.update(i,s,a,new xE(e.state,o,!1)))?new Rl(this.source,this.explicit,l,i,i.from,(n=i.to)!==null&&n!==void 0?n:_o(e.state)):new Ti(this.source,1,this.explicit)}map(e){return e.empty?this:(this.result.map?this.result.map(this.result,e):this.result)?new Rl(this.source,this.explicit,e.mapPos(this.limit),this.result,e.mapPos(this.from),e.mapPos(this.to,1)):new Ti(this.source,0)}touches(e){return e.changes.touchesRange(this.from,this.to)}}function mY(r,e,t,n){if(!r)return!1;let i=e.sliceDoc(t,n);return typeof r=="function"?r(i,t,n,e):vE(r,!0).test(i)}const Ix=ot.define({map(r,e){return r.map(t=>t.map(e))}}),bE=ot.define(),Xn=Cr.define({create(){return o0.start()},update(r,e){return r.update(e)},provide:r=>[Sx.from(r,e=>e.tooltip),Be.contentAttributes.from(r,e=>e.attrs)]});function Lx(r,e){const t=e.completion.apply||e.completion.label;let n=r.state.field(Xn).active.find(i=>i.source==e.source);return n instanceof Rl?(typeof t=="string"?r.dispatch(Object.assign(Object.assign({},tY(r.state,t,n.from,n.to)),{annotations:yE.of(e.completion)})):t(r,e.completion,n.from,n.to),!0):!1}const gY=lY(Xn,Lx);function bu(r,e="option"){return t=>{let n=t.state.field(Xn,!1);if(!n||!n.open||n.open.disabled||Date.now()-n.open.timestamp<t.state.facet(Yr).interactionDelay)return!1;let i=1,s;e=="page"&&(s=s4(t,n.open.tooltip))&&(i=Math.max(2,Math.floor(s.dom.offsetHeight/s.dom.querySelector("li").offsetHeight)-1));let{length:a}=n.open.options,o=n.open.selected>-1?n.open.selected+i*(r?1:-1):r?0:a-1;return o<0?o=e=="page"?0:a-1:o>=a&&(o=e=="page"?a-1:0),t.dispatch({effects:bE.of(o)}),!0}}const OY=r=>{let e=r.state.field(Xn,!1);return r.state.readOnly||!e||!e.open||e.open.selected<0||e.open.disabled||Date.now()-e.open.timestamp<r.state.facet(Yr).interactionDelay?!1:Lx(r,e.open.options[e.open.selected])},e_=r=>r.state.field(Xn,!1)?(r.dispatch({effects:a0.of(!0)}),!0):!1,xY=r=>{let e=r.state.field(Xn,!1);return!e||!e.active.some(t=>t.state!=0)?!1:(r.dispatch({effects:Jc.of(null)}),!0)};class vY{constructor(e,t){this.active=e,this.context=t,this.time=Date.now(),this.updates=[],this.done=void 0}}const yY=50,wY=1e3,bY=gr.fromClass(class{constructor(r){this.view=r,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.pendingStart=!1,this.composing=0;for(let e of r.state.field(Xn).active)e.isPending&&this.startQuery(e)}update(r){let e=r.state.field(Xn),t=r.state.facet(Yr);if(!r.selectionSet&&!r.docChanged&&r.startState.field(Xn)==e)return;let n=r.transactions.some(s=>{let a=wE(s,t);return a&8||(s.selection||s.docChanged)&&!(a&3)});for(let s=0;s<this.running.length;s++){let a=this.running[s];if(n||a.context.abortOnDocChange&&r.docChanged||a.updates.length+r.transactions.length>yY&&Date.now()-a.time>wY){for(let o of a.context.abortListeners)try{o()}catch(l){Jr(this.view.state,l)}a.context.abortListeners=null,this.running.splice(s--,1)}else a.updates.push(...r.transactions)}this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),r.transactions.some(s=>s.effects.some(a=>a.is(a0)))&&(this.pendingStart=!0);let i=this.pendingStart?50:t.activateOnTypingDelay;if(this.debounceUpdate=e.active.some(s=>s.isPending&&!this.running.some(a=>a.active.source==s.source))?setTimeout(()=>this.startUpdate(),i):-1,this.composing!=0)for(let s of r.transactions)s.isUserEvent("input.type")?this.composing=2:this.composing==2&&s.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1,this.pendingStart=!1;let{state:r}=this.view,e=r.field(Xn);for(let t of e.active)t.isPending&&!this.running.some(n=>n.active.source==t.source)&&this.startQuery(t);this.running.length&&e.open&&e.open.disabled&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(Yr).updateSyncTime))}startQuery(r){let{state:e}=this.view,t=_o(e),n=new xE(e,t,r.explicit,this.view),i=new vY(r,n);this.running.push(i),Promise.resolve(r.source(n)).then(s=>{i.context.aborted||(i.done=s||null,this.scheduleAccept())},s=>{this.view.dispatch({effects:Jc.of(null)}),Jr(this.view.state,s)})}scheduleAccept(){this.running.every(r=>r.done!==void 0)?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(Yr).updateSyncTime))}accept(){var r;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let e=[],t=this.view.state.facet(Yr),n=this.view.state.field(Xn);for(let i=0;i<this.running.length;i++){let s=this.running[i];if(s.done===void 0)continue;if(this.running.splice(i--,1),s.done){let o=_o(s.updates.length?s.updates[0].startState:this.view.state),l=Math.min(o,s.done.from+(s.active.explicit?0:1)),f=new Rl(s.active.source,s.active.explicit,l,s.done,s.done.from,(r=s.done.to)!==null&&r!==void 0?r:o);for(let c of s.updates)f=f.update(c,t);if(f.hasResult()){e.push(f);continue}}let a=n.active.find(o=>o.source==s.active.source);if(a&&a.isPending)if(s.done==null){let o=new Ti(s.active.source,0);for(let l of s.updates)o=o.update(l,t);o.isPending||e.push(o)}else this.startQuery(a)}(e.length||n.open&&n.open.disabled)&&this.view.dispatch({effects:Ix.of(e)})}},{eventHandlers:{blur(r){let e=this.view.state.field(Xn,!1);if(e&&e.tooltip&&this.view.state.facet(Yr).closeOnBlur){let t=e.open&&s4(this.view,e.open.tooltip);(!t||!t.dom.contains(r.relatedTarget))&&setTimeout(()=>this.view.dispatch({effects:Jc.of(null)}),10)}},compositionstart(){this.composing=1},compositionend(){this.composing==3&&setTimeout(()=>this.view.dispatch({effects:a0.of(!1)}),20),this.composing=0}}}),_Y=typeof navigator=="object"&&/Win/.test(navigator.platform),kY=za.highest(Be.domEventHandlers({keydown(r,e){let t=e.state.field(Xn,!1);if(!t||!t.open||t.open.disabled||t.open.selected<0||r.key.length>1||r.ctrlKey&&!(_Y&&r.altKey)||r.metaKey)return!1;let n=t.open.options[t.open.selected],i=t.active.find(a=>a.source==n.source),s=n.completion.commitCharacters||i.result.commitCharacters;return s&&s.indexOf(r.key)>-1&&Lx(e,n),!1}})),SY=Be.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'""',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"400px",boxSizing:"border-box",whiteSpace:"pre-line"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:"30px"},".cm-completionInfo.cm-completionInfo-right-narrow":{left:"30px"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"''"}},".cm-completionIcon-class":{"&:after":{content:"''"}},".cm-completionIcon-interface":{"&:after":{content:"''"}},".cm-completionIcon-variable":{"&:after":{content:"''"}},".cm-completionIcon-constant":{"&:after":{content:"''"}},".cm-completionIcon-type":{"&:after":{content:"''"}},".cm-completionIcon-enum":{"&:after":{content:"''"}},".cm-completionIcon-property":{"&:after":{content:"''"}},".cm-completionIcon-keyword":{"&:after":{content:"''"}},".cm-completionIcon-namespace":{"&:after":{content:"''"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}}),eh={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},go=ot.define({map(r,e){let t=e.mapPos(r,-1,hn.TrackAfter);return t??void 0}}),Bx=new class extends zs{};Bx.startSide=1;Bx.endSide=-1;const _E=Cr.define({create(){return At.empty},update(r,e){if(r=r.map(e.changes),e.selection){let t=e.state.doc.lineAt(e.selection.main.head);r=r.update({filter:n=>n>=t.from&&n<=t.to})}for(let t of e.effects)t.is(go)&&(r=r.update({add:[Bx.range(t.value,t.value+1)]}));return r}});function TY(){return[AY,_E]}const Yp="()[]{}<>";function kE(r){for(let e=0;e<Yp.length;e+=2)if(Yp.charCodeAt(e)==r)return Yp.charAt(e+1);return cx(r<128?r:r+1)}function SE(r,e){return r.languageDataAt("closeBrackets",e)[0]||eh}const CY=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),AY=Be.inputHandler.of((r,e,t,n)=>{if((CY?r.composing:r.compositionStarted)||r.state.readOnly)return!1;let i=r.state.selection.main;if(n.length>2||n.length==2&&ds(Wn(n,0))==1||e!=i.from||t!=i.to)return!1;let s=RY(r.state,n);return s?(r.dispatch(s),!0):!1}),EY=({state:r,dispatch:e})=>{if(r.readOnly)return!1;let n=SE(r,r.selection.main.head).brackets||eh.brackets,i=null,s=r.changeByRange(a=>{if(a.empty){let o=QY(r.doc,a.head);for(let l of n)if(l==o&&H0(r.doc,a.head)==kE(Wn(l,0)))return{changes:{from:a.head-l.length,to:a.head+l.length},range:xe.cursor(a.head-l.length)}}return{range:i=a}});return i||e(r.update(s,{scrollIntoView:!0,userEvent:"delete.backward"})),!i},PY=[{key:"Backspace",run:EY}];function RY(r,e){let t=SE(r,r.selection.main.head),n=t.brackets||eh.brackets;for(let i of n){let s=kE(Wn(i,0));if(e==i)return s==i?NY(r,i,n.indexOf(i+i+i)>-1,t):FY(r,i,s,t.before||eh.before);if(e==s&&TE(r,r.selection.main.from))return $Y(r,i,s)}return null}function TE(r,e){let t=!1;return r.field(_E).between(0,r.doc.length,n=>{n==e&&(t=!0)}),t}function H0(r,e){let t=r.sliceString(e,e+2);return t.slice(0,ds(Wn(t,0)))}function QY(r,e){let t=r.sliceString(e-2,e);return ds(Wn(t,0))==t.length?t:t.slice(1)}function FY(r,e,t,n){let i=null,s=r.changeByRange(a=>{if(!a.empty)return{changes:[{insert:e,from:a.from},{insert:t,from:a.to}],effects:go.of(a.to+e.length),range:xe.range(a.anchor+e.length,a.head+e.length)};let o=H0(r.doc,a.head);return!o||/\s/.test(o)||n.indexOf(o)>-1?{changes:{insert:e+t,from:a.head},effects:go.of(a.head+e.length),range:xe.cursor(a.head+e.length)}:{range:i=a}});return i?null:r.update(s,{scrollIntoView:!0,userEvent:"input.type"})}function $Y(r,e,t){let n=null,i=r.changeByRange(s=>s.empty&&H0(r.doc,s.head)==t?{changes:{from:s.head,to:s.head+t.length,insert:t},range:xe.cursor(s.head+t.length)}:n={range:s});return n?null:r.update(i,{scrollIntoView:!0,userEvent:"input.type"})}function NY(r,e,t,n){let i=n.stringPrefixes||eh.stringPrefixes,s=null,a=r.changeByRange(o=>{if(!o.empty)return{changes:[{insert:e,from:o.from},{insert:e,from:o.to}],effects:go.of(o.to+e.length),range:xe.range(o.anchor+e.length,o.head+e.length)};let l=o.head,f=H0(r.doc,l),c;if(f==e){if(t_(r,l))return{changes:{insert:e+e,from:l},effects:go.of(l+e.length),range:xe.cursor(l+e.length)};if(TE(r,l)){let u=t&&r.sliceDoc(l,l+e.length*3)==e+e+e?e+e+e:e;return{changes:{from:l,to:l+u.length,insert:u},range:xe.cursor(l+u.length)}}}else{if(t&&r.sliceDoc(l-2*e.length,l)==e+e&&(c=r_(r,l-2*e.length,i))>-1&&t_(r,c))return{changes:{insert:e+e+e+e,from:l},effects:go.of(l+e.length),range:xe.cursor(l+e.length)};if(r.charCategorizer(l)(f)!=pr.Word&&r_(r,l,i)>-1&&!DY(r,l,e,i))return{changes:{insert:e+e,from:l},effects:go.of(l+e.length),range:xe.cursor(l+e.length)}}return{range:s=o}});return s?null:r.update(a,{scrollIntoView:!0,userEvent:"input.type"})}function t_(r,e){let t=Cn(r).resolveInner(e+1);return t.parent&&t.from==e}function DY(r,e,t,n){let i=Cn(r).resolveInner(e,-1),s=n.reduce((a,o)=>Math.max(a,o.length),0);for(let a=0;a<5;a++){let o=r.sliceDoc(i.from,Math.min(i.to,i.from+t.length+s)),l=o.indexOf(t);if(!l||l>-1&&n.indexOf(o.slice(0,l))>-1){let c=i.firstChild;for(;c&&c.from==i.from&&c.to-c.from>t.length+l;){if(r.sliceDoc(c.to-t.length,c.to)==t)return!1;c=c.firstChild}return!0}let f=i.to==e&&i.parent;if(!f)break;i=f}return!1}function r_(r,e,t){let n=r.charCategorizer(e);if(n(r.sliceDoc(e-1,e))!=pr.Word)return e;for(let i of t){let s=e-i.length;if(r.sliceDoc(s,e)==i&&n(r.sliceDoc(s-1,s))!=pr.Word)return s}return-1}function MY(r={}){return[kY,Xn,Yr.of(r),bY,IY,SY]}const CE=[{key:"Ctrl-Space",run:e_},{mac:"Alt-`",run:e_},{key:"Escape",run:xY},{key:"ArrowDown",run:bu(!0)},{key:"ArrowUp",run:bu(!1)},{key:"PageDown",run:bu(!0,"page")},{key:"PageUp",run:bu(!1,"page")},{key:"Enter",run:OY}],IY=za.highest(W0.computeN([Yr],r=>r.facet(Yr).defaultKeymap?[CE]:[]));class n_{constructor(e,t,n){this.from=e,this.to=t,this.diagnostic=n}}class uo{constructor(e,t,n){this.diagnostics=e,this.panel=t,this.selected=n}static init(e,t,n){let i=e,s=n.facet(th).markerFilter;s&&(i=s(i,n));let a=e.slice().sort((h,u)=>h.from-u.from||h.to-u.to),o=new Gs,l=[],f=0;for(let h=0;;){let u=h==a.length?null:a[h];if(!u&&!l.length)break;let d,p;for(l.length?(d=f,p=l.reduce((g,v)=>Math.min(g,v.to),u&&u.from>d?u.from:1e8)):(d=u.from,p=u.to,l.push(u),h++);h<a.length;){let g=a[h];if(g.from==d&&(g.to>g.from||g.to==d))l.push(g),h++,p=Math.min(g.to,p);else{p=Math.min(g.from,p);break}}let m=YY(l);if(l.some(g=>g.from==g.to||g.from==g.to-1&&n.doc.lineAt(g.from).to==g.from))o.add(d,d,ze.widget({widget:new jY(m),diagnostics:l.slice()}));else{let g=l.reduce((v,w)=>w.markClass?v+" "+w.markClass:v,"");o.add(d,p,ze.mark({class:"cm-lintRange cm-lintRange-"+m+g,diagnostics:l.slice(),inclusiveEnd:l.some(v=>v.to>p)}))}f=p;for(let g=0;g<l.length;g++)l[g].to<=f&&l.splice(g--,1)}let c=o.finish();return new uo(c,t,jl(c))}}function jl(r,e=null,t=0){let n=null;return r.between(t,1e9,(i,s,{spec:a})=>{if(!(e&&a.diagnostics.indexOf(e)<0))if(!n)n=new n_(i,s,e||a.diagnostics[0]);else{if(a.diagnostics.indexOf(n.diagnostic)<0)return!1;n=new n_(n.from,s,n.diagnostic)}}),n}function LY(r,e){let t=e.pos,n=e.end||t,i=r.state.facet(th).hideOn(r,t,n);if(i!=null)return i;let s=r.startState.doc.lineAt(e.pos);return!!(r.effects.some(a=>a.is(AE))||r.changes.touchesRange(s.from,Math.max(s.to,n)))}function BY(r,e){return r.field(ni,!1)?e:e.concat(ot.appendConfig.of(KY))}const AE=ot.define(),Zx=ot.define(),EE=ot.define(),ni=Cr.define({create(){return new uo(ze.none,null,null)},update(r,e){if(e.docChanged&&r.diagnostics.size){let t=r.diagnostics.map(e.changes),n=null,i=r.panel;if(r.selected){let s=e.changes.mapPos(r.selected.from,1);n=jl(t,r.selected.diagnostic,s)||jl(t,null,s)}!t.size&&i&&e.state.facet(th).autoPanel&&(i=null),r=new uo(t,i,n)}for(let t of e.effects)if(t.is(AE)){let n=e.state.facet(th).autoPanel?t.value.length?rh.open:null:r.panel;r=uo.init(t.value,n,e.state)}else t.is(Zx)?r=new uo(r.diagnostics,t.value?rh.open:null,r.selected):t.is(EE)&&(r=new uo(r.diagnostics,r.panel,t.value));return r},provide:r=>[Gc.from(r,e=>e.panel),Be.decorations.from(r,e=>e.diagnostics)]}),ZY=ze.mark({class:"cm-lintRange cm-lintRange-active"});function WY(r,e,t){let{diagnostics:n}=r.state.field(ni),i,s=-1,a=-1;n.between(e-(t<0?1:0),e+(t>0?1:0),(l,f,{spec:c})=>{if(e>=l&&e<=f&&(l==f||(e>l||t>0)&&(e<f||t<0)))return i=c.diagnostics,s=l,a=f,!1});let o=r.state.facet(th).tooltipFilter;return i&&o&&(i=o(i,r.state)),i?{pos:s,end:a,above:r.state.doc.lineAt(s).to<a,create(){return{dom:UY(r,i)}}}:null}function UY(r,e){return rr("ul",{class:"cm-tooltip-lint"},e.map(t=>RE(r,t,!1)))}const XY=r=>{let e=r.state.field(ni,!1);(!e||!e.panel)&&r.dispatch({effects:BY(r.state,[Zx.of(!0)])});let t=zc(r,rh.open);return t&&t.dom.querySelector(".cm-panel-lint ul").focus(),!0},i_=r=>{let e=r.state.field(ni,!1);return!e||!e.panel?!1:(r.dispatch({effects:Zx.of(!1)}),!0)},VY=r=>{let e=r.state.field(ni,!1);if(!e)return!1;let t=r.state.selection.main,n=e.diagnostics.iter(t.to+1);return!n.value&&(n=e.diagnostics.iter(0),!n.value||n.from==t.from&&n.to==t.to)?!1:(r.dispatch({selection:{anchor:n.from,head:n.to},scrollIntoView:!0}),!0)},qY=[{key:"Mod-Shift-m",run:XY,preventDefault:!0},{key:"F8",run:VY}],th=Le.define({combine(r){return Object.assign({sources:r.map(e=>e.source).filter(e=>e!=null)},$s(r.map(e=>e.config),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null,hideOn:()=>null},{needsRefresh:(e,t)=>e?t?n=>e(n)||t(n):e:t}))}});function PE(r){let e=[];if(r)e:for(let{name:t}of r){for(let n=0;n<t.length;n++){let i=t[n];if(/[a-zA-Z]/.test(i)&&!e.some(s=>s.toLowerCase()==i.toLowerCase())){e.push(i);continue e}}e.push("")}return e}function RE(r,e,t){var n;let i=t?PE(e.actions):[];return rr("li",{class:"cm-diagnostic cm-diagnostic-"+e.severity},rr("span",{class:"cm-diagnosticText"},e.renderMessage?e.renderMessage(r):e.message),(n=e.actions)===null||n===void 0?void 0:n.map((s,a)=>{let o=!1,l=u=>{if(u.preventDefault(),o)return;o=!0;let d=jl(r.state.field(ni).diagnostics,e);d&&s.apply(r,d.from,d.to)},{name:f}=s,c=i[a]?f.indexOf(i[a]):-1,h=c<0?f:[f.slice(0,c),rr("u",f.slice(c,c+1)),f.slice(c+1)];return rr("button",{type:"button",class:"cm-diagnosticAction",onclick:l,onmousedown:l,"aria-label":` Action: ${f}${c<0?"":` (access key "${i[a]})"`}.`},h)}),e.source&&rr("div",{class:"cm-diagnosticSource"},e.source))}class jY extends ia{constructor(e){super(),this.sev=e}eq(e){return e.sev==this.sev}toDOM(){return rr("span",{class:"cm-lintPoint cm-lintPoint-"+this.sev})}}class s_{constructor(e,t){this.diagnostic=t,this.id="item_"+Math.floor(Math.random()*4294967295).toString(16),this.dom=RE(e,t,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class rh{constructor(e){this.view=e,this.items=[];let t=i=>{if(i.keyCode==27)i_(this.view),this.view.focus();else if(i.keyCode==38||i.keyCode==33)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(i.keyCode==40||i.keyCode==34)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(i.keyCode==36)this.moveSelection(0);else if(i.keyCode==35)this.moveSelection(this.items.length-1);else if(i.keyCode==13)this.view.focus();else if(i.keyCode>=65&&i.keyCode<=90&&this.selectedIndex>=0){let{diagnostic:s}=this.items[this.selectedIndex],a=PE(s.actions);for(let o=0;o<a.length;o++)if(a[o].toUpperCase().charCodeAt(0)==i.keyCode){let l=jl(this.view.state.field(ni).diagnostics,s);l&&s.actions[o].apply(e,l.from,l.to)}}else return;i.preventDefault()},n=i=>{for(let s=0;s<this.items.length;s++)this.items[s].dom.contains(i.target)&&this.moveSelection(s)};this.list=rr("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:t,onclick:n}),this.dom=rr("div",{class:"cm-panel-lint"},this.list,rr("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>i_(this.view)},"")),this.update()}get selectedIndex(){let e=this.view.state.field(ni).selected;if(!e)return-1;for(let t=0;t<this.items.length;t++)if(this.items[t].diagnostic==e.diagnostic)return t;return-1}update(){let{diagnostics:e,selected:t}=this.view.state.field(ni),n=0,i=!1,s=null,a=new Set;for(e.between(0,this.view.state.doc.length,(o,l,{spec:f})=>{for(let c of f.diagnostics){if(a.has(c))continue;a.add(c);let h=-1,u;for(let d=n;d<this.items.length;d++)if(this.items[d].diagnostic==c){h=d;break}h<0?(u=new s_(this.view,c),this.items.splice(n,0,u),i=!0):(u=this.items[h],h>n&&(this.items.splice(n,h-n),i=!0)),t&&u.diagnostic==t.diagnostic?u.dom.hasAttribute("aria-selected")||(u.dom.setAttribute("aria-selected","true"),s=u):u.dom.hasAttribute("aria-selected")&&u.dom.removeAttribute("aria-selected"),n++}});n<this.items.length&&!(this.items.length==1&&this.items[0].diagnostic.from<0);)i=!0,this.items.pop();this.items.length==0&&(this.items.push(new s_(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),i=!0),s?(this.list.setAttribute("aria-activedescendant",s.id),this.view.requestMeasure({key:this,read:()=>({sel:s.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:o,panel:l})=>{let f=l.height/this.list.offsetHeight;o.top<l.top?this.list.scrollTop-=(l.top-o.top)/f:o.bottom>l.bottom&&(this.list.scrollTop+=(o.bottom-l.bottom)/f)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),i&&this.sync()}sync(){let e=this.list.firstChild;function t(){let n=e;e=n.nextSibling,n.remove()}for(let n of this.items)if(n.dom.parentNode==this.list){for(;e!=n.dom;)t();e=n.dom.nextSibling}else this.list.insertBefore(n.dom,e);for(;e;)t()}moveSelection(e){if(this.selectedIndex<0)return;let t=this.view.state.field(ni),n=jl(t.diagnostics,this.items[e].diagnostic);n&&this.view.dispatch({selection:{anchor:n.from,head:n.to},scrollIntoView:!0,effects:EE.of(n)})}static open(e){return new rh(e)}}function zY(r,e='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${e}>${encodeURIComponent(r)}</svg>')`}function _u(r){return zY(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${r}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}const GY=Be.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnostic-hint":{borderLeft:"5px solid #66d"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:_u("#d11")},".cm-lintRange-warning":{backgroundImage:_u("orange")},".cm-lintRange-info":{backgroundImage:_u("#999")},".cm-lintRange-hint":{backgroundImage:_u("#66d")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-lintPoint-hint":{"&:after":{borderBottomColor:"#66d"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}});function HY(r){return r=="error"?4:r=="warning"?3:r=="info"?2:1}function YY(r){let e="hint",t=1;for(let n of r){let i=HY(n.severity);i>t&&(t=i,e=n.severity)}return e}const KY=[ni,Be.decorations.compute([ni],r=>{let{selected:e,panel:t}=r.field(ni);return!e||!t||e.from==e.to?ze.none:ze.set([ZY.range(e.from,e.to)])}),Lj(WY,{hideOn:LY}),GY],JY=[Hj(),Jj(),gj(),bG(),zz(),sj(),cj(),lt.allowMultipleSelections.of(!0),$z(),Hz(Jz,{fallback:!0}),aG(),TY(),MY(),Aj(),Rj(),bj(),PH(),W0.of([...PY,...kH,...GH,...RG,...Xz,...CE,...qY])],QE=1024;let eK=0,Kp=class{constructor(e,t){this.from=e,this.to=t}},mr=class{constructor(e={}){this.id=eK++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof e!="function"&&(e=Ks.match(e)),t=>{let n=e(t);return n===void 0?null:[this,n]}}};mr.closedBy=new mr({deserialize:r=>r.split(" ")});mr.openedBy=new mr({deserialize:r=>r.split(" ")});mr.group=new mr({deserialize:r=>r.split(" ")});mr.isolate=new mr({deserialize:r=>{if(r&&r!="rtl"&&r!="ltr"&&r!="auto")throw new RangeError("Invalid value for isolate: "+r);return r||"auto"}});mr.contextHash=new mr({perNode:!0});mr.lookAhead=new mr({perNode:!0});mr.mounted=new mr({perNode:!0});let l0=class{constructor(e,t,n){this.tree=e,this.overlay=t,this.parser=n}static get(e){return e&&e.props&&e.props[mr.mounted.id]}};const tK=Object.create(null);let Ks=class FE{constructor(e,t,n,i=0){this.name=e,this.props=t,this.id=n,this.flags=i}static define(e){let t=e.props&&e.props.length?Object.create(null):tK,n=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(e.name==null?8:0),i=new FE(e.name||"",t,e.id,n);if(e.props){for(let s of e.props)if(Array.isArray(s)||(s=s(i)),s){if(s[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");t[s[0].id]=s[1]}}return i}prop(e){return this.props[e.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(e){if(typeof e=="string"){if(this.name==e)return!0;let t=this.prop(mr.group);return t?t.indexOf(e)>-1:!1}return this.id==e}static match(e){let t=Object.create(null);for(let n in e)for(let i of n.split(" "))t[i]=e[n];return n=>{for(let i=n.prop(mr.group),s=-1;s<(i?i.length:0);s++){let a=t[s<0?n.name:i[s]];if(a)return a}}}};Ks.none=new Ks("",Object.create(null),0,8);class Wx{constructor(e){this.types=e;for(let t=0;t<e.length;t++)if(e[t].id!=t)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...e){let t=[];for(let n of this.types){let i=null;for(let s of e){let a=s(n);a&&(i||(i=Object.assign({},n.props)),i[a[0].id]=a[1])}t.push(i?new Ks(n.name,i,n.id,n.flags):n)}return new Wx(t)}}const ku=new WeakMap,a_=new WeakMap;var an;(function(r){r[r.ExcludeBuffers=1]="ExcludeBuffers",r[r.IncludeAnonymous=2]="IncludeAnonymous",r[r.IgnoreMounts=4]="IgnoreMounts",r[r.IgnoreOverlays=8]="IgnoreOverlays"})(an||(an={}));let ji=class c1{constructor(e,t,n,i,s){if(this.type=e,this.children=t,this.positions=n,this.length=i,this.props=null,s&&s.length){this.props=Object.create(null);for(let[a,o]of s)this.props[typeof a=="number"?a:a.id]=o}}toString(){let e=l0.get(this);if(e&&!e.overlay)return e.tree.toString();let t="";for(let n of this.children){let i=n.toString();i&&(t&&(t+=","),t+=i)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(t.length?"("+t+")":""):t}cursor(e=0){return new d1(this.topNode,e)}cursorAt(e,t=0,n=0){let i=ku.get(this)||this.topNode,s=new d1(i);return s.moveTo(e,t),ku.set(this,s._tree),s}get topNode(){return new Za(this,0,0,null)}resolve(e,t=0){let n=nh(ku.get(this)||this.topNode,e,t,!1);return ku.set(this,n),n}resolveInner(e,t=0){let n=nh(a_.get(this)||this.topNode,e,t,!0);return a_.set(this,n),n}resolveStack(e,t=0){return sK(this,e,t)}iterate(e){let{enter:t,leave:n,from:i=0,to:s=this.length}=e,a=e.mode||0,o=(a&an.IncludeAnonymous)>0;for(let l=this.cursor(a|an.IncludeAnonymous);;){let f=!1;if(l.from<=s&&l.to>=i&&(!o&&l.type.isAnonymous||t(l)!==!1)){if(l.firstChild())continue;f=!0}for(;f&&n&&(o||!l.type.isAnonymous)&&n(l),!l.nextSibling();){if(!l.parent())return;f=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let t in this.props)e.push([+t,this.props[t]]);return e}balance(e={}){return this.children.length<=8?this:Xx(Ks.none,this.children,this.positions,0,this.children.length,0,this.length,(t,n,i)=>new c1(this.type,t,n,i,this.propValues),e.makeTree||((t,n,i)=>new c1(Ks.none,t,n,i)))}static build(e){return aK(e)}};ji.empty=new ji(Ks.none,[],[],0);let rK=class $E{constructor(e,t){this.buffer=e,this.index=t}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new $E(this.buffer,this.index)}},zl=class NE{constructor(e,t,n){this.buffer=e,this.length=t,this.set=n}get type(){return Ks.none}toString(){let e=[];for(let t=0;t<this.buffer.length;)e.push(this.childString(t)),t=this.buffer[t+3];return e.join(",")}childString(e){let t=this.buffer[e],n=this.buffer[e+3],i=this.set.types[t],s=i.name;if(/\W/.test(s)&&!i.isError&&(s=JSON.stringify(s)),e+=4,n==e)return s;let a=[];for(;e<n;)a.push(this.childString(e)),e=this.buffer[e+3];return s+"("+a.join(",")+")"}findChild(e,t,n,i,s){let{buffer:a}=this,o=-1;for(let l=e;l!=t&&!(DE(s,i,a[l+1],a[l+2])&&(o=l,n>0));l=a[l+3]);return o}slice(e,t,n){let i=this.buffer,s=new Uint16Array(t-e),a=0;for(let o=e,l=0;o<t;){s[l++]=i[o++],s[l++]=i[o++]-n;let f=s[l++]=i[o++]-n;s[l++]=i[o++]-e,a=Math.max(a,f)}return new NE(s,a,this.set)}};function DE(r,e,t,n){switch(r){case-2:return t<e;case-1:return n>=e&&t<e;case 0:return t<e&&n>e;case 1:return t<=e&&n>e;case 2:return n>e;case 4:return!0}}function nh(r,e,t,n){for(var i;r.from==r.to||(t<1?r.from>=e:r.from>e)||(t>-1?r.to<=e:r.to<e);){let a=!n&&r instanceof Za&&r.index<0?null:r.parent;if(!a)return r;r=a}let s=n?0:an.IgnoreOverlays;if(n)for(let a=r,o=a.parent;o;a=o,o=a.parent)a instanceof Za&&a.index<0&&((i=o.enter(e,t,s))===null||i===void 0?void 0:i.from)!=a.from&&(r=o);for(;;){let a=r.enter(e,t,s);if(!a)return r;r=a}}let ME=class{cursor(e=0){return new d1(this,e)}getChild(e,t=null,n=null){let i=o_(this,e,t,n);return i.length?i[0]:null}getChildren(e,t=null,n=null){return o_(this,e,t,n)}resolve(e,t=0){return nh(this,e,t,!1)}resolveInner(e,t=0){return nh(this,e,t,!0)}matchContext(e){return h1(this.parent,e)}enterUnfinishedNodesBefore(e){let t=this.childBefore(e),n=this;for(;t;){let i=t.lastChild;if(!i||i.to!=t.to)break;i.type.isError&&i.from==i.to?(n=t,t=i.prevSibling):t=i}return n}get node(){return this}get next(){return this.parent}},Za=class Ju extends ME{constructor(e,t,n,i){super(),this._tree=e,this.from=t,this.index=n,this._parent=i}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,t,n,i,s=0){for(let a=this;;){for(let{children:o,positions:l}=a._tree,f=t>0?o.length:-1;e!=f;e+=t){let c=o[e],h=l[e]+a.from;if(DE(i,n,h,h+c.length)){if(c instanceof zl){if(s&an.ExcludeBuffers)continue;let u=c.findChild(0,c.buffer.length,t,n-h,i);if(u>-1)return new u1(new nK(a,c,e,h),null,u)}else if(s&an.IncludeAnonymous||!c.type.isAnonymous||Ux(c)){let u;if(!(s&an.IgnoreMounts)&&(u=l0.get(c))&&!u.overlay)return new Ju(u.tree,h,e,a);let d=new Ju(c,h,e,a);return s&an.IncludeAnonymous||!d.type.isAnonymous?d:d.nextChild(t<0?c.children.length-1:0,t,n,i)}}}if(s&an.IncludeAnonymous||!a.type.isAnonymous||(a.index>=0?e=a.index+t:e=t<0?-1:a._parent._tree.children.length,a=a._parent,!a))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}enter(e,t,n=0){let i;if(!(n&an.IgnoreOverlays)&&(i=l0.get(this._tree))&&i.overlay){let s=e-this.from;for(let{from:a,to:o}of i.overlay)if((t>0?a<=s:a<s)&&(t<0?o>=s:o>s))return new Ju(i.tree,i.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,t,n)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}};function o_(r,e,t,n){let i=r.cursor(),s=[];if(!i.firstChild())return s;if(t!=null){for(let a=!1;!a;)if(a=i.type.is(t),!i.nextSibling())return s}for(;;){if(n!=null&&i.type.is(n))return s;if(i.type.is(e)&&s.push(i.node),!i.nextSibling())return n==null?s:[]}}function h1(r,e,t=e.length-1){for(let n=r;t>=0;n=n.parent){if(!n)return!1;if(!n.type.isAnonymous){if(e[t]&&e[t]!=n.name)return!1;t--}}return!0}let nK=class{constructor(e,t,n,i){this.parent=e,this.buffer=t,this.index=n,this.start=i}},u1=class Jf extends ME{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(e,t,n){super(),this.context=e,this._parent=t,this.index=n,this.type=e.buffer.set.types[e.buffer.buffer[n]]}child(e,t,n){let{buffer:i}=this.context,s=i.findChild(this.index+4,i.buffer[this.index+3],e,t-this.context.start,n);return s<0?null:new Jf(this.context,this,s)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}enter(e,t,n=0){if(n&an.ExcludeBuffers)return null;let{buffer:i}=this.context,s=i.findChild(this.index+4,i.buffer[this.index+3],t>0?1:-1,e-this.context.start,t);return s<0?null:new Jf(this.context,this,s)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,t=e.buffer[this.index+3];return t<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new Jf(this.context,this._parent,t):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,t=this._parent?this._parent.index+4:0;return this.index==t?this.externalSibling(-1):new Jf(this.context,this._parent,e.findChild(t,this.index,-1,0,4))}get tree(){return null}toTree(){let e=[],t=[],{buffer:n}=this.context,i=this.index+4,s=n.buffer[this.index+3];if(s>i){let a=n.buffer[this.index+1];e.push(n.slice(i,s,a)),t.push(0)}return new ji(this.type,e,t,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}};function IE(r){if(!r.length)return null;let e=0,t=r[0];for(let s=1;s<r.length;s++){let a=r[s];(a.from>t.from||a.to<t.to)&&(t=a,e=s)}let n=t instanceof Za&&t.index<0?null:t.parent,i=r.slice();return n?i[e]=n:i.splice(e,1),new iK(i,t)}let iK=class{constructor(e,t){this.heads=e,this.node=t}get next(){return IE(this.heads)}};function sK(r,e,t){let n=r.resolveInner(e,t),i=null;for(let s=n instanceof Za?n:n.context.parent;s;s=s.parent)if(s.index<0){let a=s.parent;(i||(i=[n])).push(a.resolve(e,t)),s=a}else{let a=l0.get(s.tree);if(a&&a.overlay&&a.overlay[0].from<=e&&a.overlay[a.overlay.length-1].to>=e){let o=new Za(a.tree,a.overlay[0].from+s.from,-1,s);(i||(i=[n])).push(nh(o,e,t,!1))}}return i?IE(i):n}let d1=class{get name(){return this.type.name}constructor(e,t=0){if(this.mode=t,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,e instanceof Za)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let n=e._parent;n;n=n._parent)this.stack.unshift(n.index);this.bufferNode=e,this.yieldBuf(e.index)}}yieldNode(e){return e?(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0):!1}yieldBuf(e,t){this.index=e;let{start:n,buffer:i}=this.buffer;return this.type=t||i.set.types[i.buffer[e]],this.from=n+i.buffer[e+1],this.to=n+i.buffer[e+2],!0}yield(e){return e?e instanceof Za?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,t,n){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,t,n,this.mode));let{buffer:i}=this.buffer,s=i.findChild(this.index+4,i.buffer[this.index+3],e,t-this.buffer.start,n);return s<0?!1:(this.stack.push(this.index),this.yieldBuf(s))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,t,n=this.mode){return this.buffer?n&an.ExcludeBuffers?!1:this.enterChild(1,e,t):this.yield(this._tree.enter(e,t,n))}parent(){if(!this.buffer)return this.yieldNode(this.mode&an.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&an.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode)):!1;let{buffer:t}=this.buffer,n=this.stack.length-1;if(e<0){let i=n<0?0:this.stack[n]+4;if(this.index!=i)return this.yieldBuf(t.findChild(i,this.index,-1,0,4))}else{let i=t.buffer[this.index+3];if(i<(n<0?t.buffer.length:t.buffer[this.stack[n]+3]))return this.yieldBuf(i)}return n<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let t,n,{buffer:i}=this;if(i){if(e>0){if(this.index<i.buffer.buffer.length)return!1}else for(let s=0;s<this.index;s++)if(i.buffer.buffer[s+3]<this.index)return!1;({index:t,parent:n}=i)}else({index:t,_parent:n}=this._tree);for(;n;{index:t,_parent:n}=n)if(t>-1)for(let s=t+e,a=e<0?-1:n._tree.children.length;s!=a;s+=e){let o=n._tree.children[s];if(this.mode&an.IncludeAnonymous||o instanceof zl||!o.type.isAnonymous||Ux(o))return!1}return!0}move(e,t){if(t&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,t=0){for(;(this.from==this.to||(t<1?this.from>=e:this.from>e)||(t>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,t););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,t=null,n=0;if(e&&e.context==this.buffer)e:for(let i=this.index,s=this.stack.length;s>=0;){for(let a=e;a;a=a._parent)if(a.index==i){if(i==this.index)return a;t=a,n=s+1;break e}i=this.stack[--s]}for(let i=n;i<this.stack.length;i++)t=new u1(this.buffer,t,this.stack[i]);return this.bufferNode=new u1(this.buffer,t,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,t){for(let n=0;;){let i=!1;if(this.type.isAnonymous||e(this)!==!1){if(this.firstChild()){n++;continue}this.type.isAnonymous||(i=!0)}for(;;){if(i&&t&&t(this),i=this.type.isAnonymous,!n)return;if(this.nextSibling())break;this.parent(),n--,i=!0}}}matchContext(e){if(!this.buffer)return h1(this.node.parent,e);let{buffer:t}=this.buffer,{types:n}=t.set;for(let i=e.length-1,s=this.stack.length-1;i>=0;s--){if(s<0)return h1(this._tree,e,i);let a=n[t.buffer[this.stack[s]]];if(!a.isAnonymous){if(e[i]&&e[i]!=a.name)return!1;i--}}return!0}};function Ux(r){return r.children.some(e=>e instanceof zl||!e.type.isAnonymous||Ux(e))}function aK(r){var e;let{buffer:t,nodeSet:n,maxBufferLength:i=QE,reused:s=[],minRepeatType:a=n.types.length}=r,o=Array.isArray(t)?new rK(t,t.length):t,l=n.types,f=0,c=0;function h(y,b,O,T,k,Q){let{id:A,start:_,end:N,size:U}=o,z=c,K=f;for(;U<0;)if(o.next(),U==-1){let ae=s[A];O.push(ae),T.push(_-y);return}else if(U==-3){f=A;return}else if(U==-4){c=A;return}else throw new RangeError(`Unrecognized record size: ${U}`);let re=l[A],ge,V,he=_-y;if(N-_<=i&&(V=g(o.pos-b,k))){let ae=new Uint16Array(V.size-V.skip),E=o.pos-V.size,L=ae.length;for(;o.pos>E;)L=v(V.start,ae,L);ge=new zl(ae,N-V.start,n),he=V.start-y}else{let ae=o.pos-U;o.next();let E=[],L=[],I=A>=a?A:-1,Z=0,ee=N;for(;o.pos>ae;)I>=0&&o.id==I&&o.size>=0?(o.end<=ee-i&&(p(E,L,_,Z,o.end,ee,I,z,K),Z=E.length,ee=o.end),o.next()):Q>2500?u(_,ae,E,L):h(_,ae,E,L,I,Q+1);if(I>=0&&Z>0&&Z<E.length&&p(E,L,_,Z,_,ee,I,z,K),E.reverse(),L.reverse(),I>-1&&Z>0){let ne=d(re,K);ge=Xx(re,E,L,0,E.length,0,N-_,ne,ne)}else ge=m(re,E,L,N-_,z-N,K)}O.push(ge),T.push(he)}function u(y,b,O,T){let k=[],Q=0,A=-1;for(;o.pos>b;){let{id:_,start:N,end:U,size:z}=o;if(z>4)o.next();else{if(A>-1&&N<A)break;A<0&&(A=U-i),k.push(_,N,U),Q++,o.next()}}if(Q){let _=new Uint16Array(Q*4),N=k[k.length-2];for(let U=k.length-3,z=0;U>=0;U-=3)_[z++]=k[U],_[z++]=k[U+1]-N,_[z++]=k[U+2]-N,_[z++]=z;O.push(new zl(_,k[2]-N,n)),T.push(N-y)}}function d(y,b){return(O,T,k)=>{let Q=0,A=O.length-1,_,N;if(A>=0&&(_=O[A])instanceof ji){if(!A&&_.type==y&&_.length==k)return _;(N=_.prop(mr.lookAhead))&&(Q=T[A]+_.length+N)}return m(y,O,T,k,Q,b)}}function p(y,b,O,T,k,Q,A,_,N){let U=[],z=[];for(;y.length>T;)U.push(y.pop()),z.push(b.pop()+O-k);y.push(m(n.types[A],U,z,Q-k,_-Q,N)),b.push(k-O)}function m(y,b,O,T,k,Q,A){if(Q){let _=[mr.contextHash,Q];A=A?[_].concat(A):[_]}if(k>25){let _=[mr.lookAhead,k];A=A?[_].concat(A):[_]}return new ji(y,b,O,T,A)}function g(y,b){let O=o.fork(),T=0,k=0,Q=0,A=O.end-i,_={size:0,start:0,skip:0};e:for(let N=O.pos-y;O.pos>N;){let U=O.size;if(O.id==b&&U>=0){_.size=T,_.start=k,_.skip=Q,Q+=4,T+=4,O.next();continue}let z=O.pos-U;if(U<0||z<N||O.start<A)break;let K=O.id>=a?4:0,re=O.start;for(O.next();O.pos>z;){if(O.size<0)if(O.size==-3)K+=4;else break e;else O.id>=a&&(K+=4);O.next()}k=re,T+=U,Q+=K}return(b<0||T==y)&&(_.size=T,_.start=k,_.skip=Q),_.size>4?_:void 0}function v(y,b,O){let{id:T,start:k,end:Q,size:A}=o;if(o.next(),A>=0&&T<a){let _=O;if(A>4){let N=o.pos-(A-4);for(;o.pos>N;)O=v(y,b,O)}b[--O]=_,b[--O]=Q-y,b[--O]=k-y,b[--O]=T}else A==-3?f=T:A==-4&&(c=T);return O}let w=[],x=[];for(;o.pos>0;)h(r.start||0,r.bufferStart||0,w,x,-1,0);let S=(e=r.length)!==null&&e!==void 0?e:w.length?x[0]+w[0].length:0;return new ji(l[r.topID],w.reverse(),x.reverse(),S)}const l_=new WeakMap;function ed(r,e){if(!r.isAnonymous||e instanceof zl||e.type!=r)return 1;let t=l_.get(e);if(t==null){t=1;for(let n of e.children){if(n.type!=r||!(n instanceof ji)){t=1;break}t+=ed(r,n)}l_.set(e,t)}return t}function Xx(r,e,t,n,i,s,a,o,l){let f=0;for(let p=n;p<i;p++)f+=ed(r,e[p]);let c=Math.ceil(f*1.5/8),h=[],u=[];function d(p,m,g,v,w){for(let x=g;x<v;){let S=x,y=m[x],b=ed(r,p[x]);for(x++;x<v;x++){let O=ed(r,p[x]);if(b+O>=c)break;b+=O}if(x==S+1){if(b>c){let O=p[S];d(O.children,O.positions,0,O.children.length,m[S]+w);continue}h.push(p[S])}else{let O=m[x-1]+p[x-1].length-y;h.push(Xx(r,p,m,S,x,y,O,null,l))}u.push(y+w-s)}}return d(e,t,n,i,0),(o||l)(h,u,a)}let oK=class{startParse(e,t,n){return typeof e=="string"&&(e=new lK(e)),n=n?n.length?n.map(i=>new Kp(i.from,i.to)):[new Kp(0,0)]:[new Kp(0,e.length)],this.createParse(e,t||[],n)}parse(e,t,n){let i=this.startParse(e,t,n);for(;;){let s=i.advance();if(s)return s}}},lK=class{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,t){return this.string.slice(e,t)}};new mr({perNode:!0});var f_={};class f0{constructor(e,t,n,i,s,a,o,l,f,c=0,h){this.p=e,this.stack=t,this.state=n,this.reducePos=i,this.pos=s,this.score=a,this.buffer=o,this.bufferBase=l,this.curContext=f,this.lookAhead=c,this.parent=h}toString(){return`[${this.stack.filter((e,t)=>t%3==0).concat(this.state)}]@${this.pos}${this.score?"!"+this.score:""}`}static start(e,t,n=0){let i=e.parser.context;return new f0(e,[],t,n,n,0,[],0,i?new c_(i,i.start):null,0,null)}get context(){return this.curContext?this.curContext.context:null}pushState(e,t){this.stack.push(this.state,t,this.bufferBase+this.buffer.length),this.state=e}reduce(e){var t;let n=e>>19,i=e&65535,{parser:s}=this.p,a=this.reducePos<this.pos-25;a&&this.setLookAhead(this.pos);let o=s.dynamicPrecedence(i);if(o&&(this.score+=o),n==0){this.pushState(s.getGoto(this.state,i,!0),this.reducePos),i<s.minRepeatTerm&&this.storeNode(i,this.reducePos,this.reducePos,a?8:4,!0),this.reduceContext(i,this.reducePos);return}let l=this.stack.length-(n-1)*3-(e&262144?6:0),f=l?this.stack[l-2]:this.p.ranges[0].from,c=this.reducePos-f;c>=2e3&&!(!((t=this.p.parser.nodeSet.types[i])===null||t===void 0)&&t.isAnonymous)&&(f==this.p.lastBigReductionStart?(this.p.bigReductionCount++,this.p.lastBigReductionSize=c):this.p.lastBigReductionSize<c&&(this.p.bigReductionCount=1,this.p.lastBigReductionStart=f,this.p.lastBigReductionSize=c));let h=l?this.stack[l-1]:0,u=this.bufferBase+this.buffer.length-h;if(i<s.minRepeatTerm||e&131072){let d=s.stateFlag(this.state,1)?this.pos:this.reducePos;this.storeNode(i,f,d,u+4,!0)}if(e&262144)this.state=this.stack[l];else{let d=this.stack[l-3];this.state=s.getGoto(d,i,!0)}for(;this.stack.length>l;)this.stack.pop();this.reduceContext(i,f)}storeNode(e,t,n,i=4,s=!1){if(e==0&&(!this.stack.length||this.stack[this.stack.length-1]<this.buffer.length+this.bufferBase)){let a=this,o=this.buffer.length;if(o==0&&a.parent&&(o=a.bufferBase-a.parent.bufferBase,a=a.parent),o>0&&a.buffer[o-4]==0&&a.buffer[o-1]>-1){if(t==n)return;if(a.buffer[o-2]>=t){a.buffer[o-2]=n;return}}}if(!s||this.pos==n)this.buffer.push(e,t,n,i);else{let a=this.buffer.length;if(a>0&&this.buffer[a-4]!=0){let o=!1;for(let l=a;l>0&&this.buffer[l-2]>n;l-=4)if(this.buffer[l-1]>=0){o=!0;break}if(o)for(;a>0&&this.buffer[a-2]>n;)this.buffer[a]=this.buffer[a-4],this.buffer[a+1]=this.buffer[a-3],this.buffer[a+2]=this.buffer[a-2],this.buffer[a+3]=this.buffer[a-1],a-=4,i>4&&(i-=4)}this.buffer[a]=e,this.buffer[a+1]=t,this.buffer[a+2]=n,this.buffer[a+3]=i}}shift(e,t,n,i){if(e&131072)this.pushState(e&65535,this.pos);else if(e&262144)this.pos=i,this.shiftContext(t,n),t<=this.p.parser.maxNode&&this.buffer.push(t,n,i,4);else{let s=e,{parser:a}=this.p;(i>this.pos||t<=a.maxNode)&&(this.pos=i,a.stateFlag(s,1)||(this.reducePos=i)),this.pushState(s,n),this.shiftContext(t,n),t<=a.maxNode&&this.buffer.push(t,n,i,4)}}apply(e,t,n,i){e&65536?this.reduce(e):this.shift(e,t,n,i)}useNode(e,t){let n=this.p.reused.length-1;(n<0||this.p.reused[n]!=e)&&(this.p.reused.push(e),n++);let i=this.pos;this.reducePos=this.pos=i+e.length,this.pushState(t,i),this.buffer.push(n,i,this.reducePos,-1),this.curContext&&this.updateContext(this.curContext.tracker.reuse(this.curContext.context,e,this,this.p.stream.reset(this.pos-e.length)))}split(){let e=this,t=e.buffer.length;for(;t>0&&e.buffer[t-2]>e.reducePos;)t-=4;let n=e.buffer.slice(t),i=e.bufferBase+t;for(;e&&i==e.bufferBase;)e=e.parent;return new f0(this.p,this.stack.slice(),this.state,this.reducePos,this.pos,this.score,n,i,this.curContext,this.lookAhead,e)}recoverByDelete(e,t){let n=e<=this.p.parser.maxNode;n&&this.storeNode(e,this.pos,t,4),this.storeNode(0,this.pos,t,n?8:4),this.pos=this.reducePos=t,this.score-=190}canShift(e){for(let t=new fK(this);;){let n=this.p.parser.stateSlot(t.state,4)||this.p.parser.hasAction(t.state,e);if(n==0)return!1;if(!(n&65536))return!0;t.reduce(n)}}recoverByInsert(e){if(this.stack.length>=300)return[];let t=this.p.parser.nextStates(this.state);if(t.length>8||this.stack.length>=120){let i=[];for(let s=0,a;s<t.length;s+=2)(a=t[s+1])!=this.state&&this.p.parser.hasAction(a,e)&&i.push(t[s],a);if(this.stack.length<120)for(let s=0;i.length<8&&s<t.length;s+=2){let a=t[s+1];i.some((o,l)=>l&1&&o==a)||i.push(t[s],a)}t=i}let n=[];for(let i=0;i<t.length&&n.length<4;i+=2){let s=t[i+1];if(s==this.state)continue;let a=this.split();a.pushState(s,this.pos),a.storeNode(0,a.pos,a.pos,4,!0),a.shiftContext(t[i],this.pos),a.reducePos=this.pos,a.score-=200,n.push(a)}return n}forceReduce(){let{parser:e}=this.p,t=e.stateSlot(this.state,5);if(!(t&65536))return!1;if(!e.validAction(this.state,t)){let n=t>>19,i=t&65535,s=this.stack.length-n*3;if(s<0||e.getGoto(this.stack[s],i,!1)<0){let a=this.findForcedReduction();if(a==null)return!1;t=a}this.storeNode(0,this.pos,this.pos,4,!0),this.score-=100}return this.reducePos=this.pos,this.reduce(t),!0}findForcedReduction(){let{parser:e}=this.p,t=[],n=(i,s)=>{if(!t.includes(i))return t.push(i),e.allActions(i,a=>{if(!(a&393216))if(a&65536){let o=(a>>19)-s;if(o>1){let l=a&65535,f=this.stack.length-o*3;if(f>=0&&e.getGoto(this.stack[f],l,!1)>=0)return o<<19|65536|l}}else{let o=n(a,s+1);if(o!=null)return o}})};return n(this.state,0)}forceAll(){for(;!this.p.parser.stateFlag(this.state,2);)if(!this.forceReduce()){this.storeNode(0,this.pos,this.pos,4,!0);break}return this}get deadEnd(){if(this.stack.length!=3)return!1;let{parser:e}=this.p;return e.data[e.stateSlot(this.state,1)]==65535&&!e.stateSlot(this.state,4)}restart(){this.storeNode(0,this.pos,this.pos,4,!0),this.state=this.stack[0],this.stack.length=0}sameState(e){if(this.state!=e.state||this.stack.length!=e.stack.length)return!1;for(let t=0;t<this.stack.length;t+=3)if(this.stack[t]!=e.stack[t])return!1;return!0}get parser(){return this.p.parser}dialectEnabled(e){return this.p.parser.dialect.flags[e]}shiftContext(e,t){this.curContext&&this.updateContext(this.curContext.tracker.shift(this.curContext.context,e,this,this.p.stream.reset(t)))}reduceContext(e,t){this.curContext&&this.updateContext(this.curContext.tracker.reduce(this.curContext.context,e,this,this.p.stream.reset(t)))}emitContext(){let e=this.buffer.length-1;(e<0||this.buffer[e]!=-3)&&this.buffer.push(this.curContext.hash,this.pos,this.pos,-3)}emitLookAhead(){let e=this.buffer.length-1;(e<0||this.buffer[e]!=-4)&&this.buffer.push(this.lookAhead,this.pos,this.pos,-4)}updateContext(e){if(e!=this.curContext.context){let t=new c_(this.curContext.tracker,e);t.hash!=this.curContext.hash&&this.emitContext(),this.curContext=t}}setLookAhead(e){e>this.lookAhead&&(this.emitLookAhead(),this.lookAhead=e)}close(){this.curContext&&this.curContext.tracker.strict&&this.emitContext(),this.lookAhead>0&&this.emitLookAhead()}}class c_{constructor(e,t){this.tracker=e,this.context=t,this.hash=e.strict?e.hash(t):0}}class fK{constructor(e){this.start=e,this.state=e.state,this.stack=e.stack,this.base=this.stack.length}reduce(e){let t=e&65535,n=e>>19;n==0?(this.stack==this.start.stack&&(this.stack=this.stack.slice()),this.stack.push(this.state,0,0),this.base+=3):this.base-=(n-1)*3;let i=this.start.p.parser.getGoto(this.stack[this.base-3],t,!0);this.state=i}}class c0{constructor(e,t,n){this.stack=e,this.pos=t,this.index=n,this.buffer=e.buffer,this.index==0&&this.maybeNext()}static create(e,t=e.bufferBase+e.buffer.length){return new c0(e,t,t-e.bufferBase)}maybeNext(){let e=this.stack.parent;e!=null&&(this.index=this.stack.bufferBase-e.bufferBase,this.stack=e,this.buffer=e.buffer)}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}next(){this.index-=4,this.pos-=4,this.index==0&&this.maybeNext()}fork(){return new c0(this.stack,this.pos,this.index)}}function ec(r,e=Uint16Array){if(typeof r!="string")return r;let t=null;for(let n=0,i=0;n<r.length;){let s=0;for(;;){let a=r.charCodeAt(n++),o=!1;if(a==126){s=65535;break}a>=92&&a--,a>=34&&a--;let l=a-32;if(l>=46&&(l-=46,o=!0),s+=l,o)break;s*=46}t?t[i++]=s:t=new e(s)}return t}class td{constructor(){this.start=-1,this.value=-1,this.end=-1,this.extended=-1,this.lookAhead=0,this.mask=0,this.context=0}}const h_=new td;class cK{constructor(e,t){this.input=e,this.ranges=t,this.chunk="",this.chunkOff=0,this.chunk2="",this.chunk2Pos=0,this.next=-1,this.token=h_,this.rangeIndex=0,this.pos=this.chunkPos=t[0].from,this.range=t[0],this.end=t[t.length-1].to,this.readNext()}resolveOffset(e,t){let n=this.range,i=this.rangeIndex,s=this.pos+e;for(;s<n.from;){if(!i)return null;let a=this.ranges[--i];s-=n.from-a.to,n=a}for(;t<0?s>n.to:s>=n.to;){if(i==this.ranges.length-1)return null;let a=this.ranges[++i];s+=a.from-n.to,n=a}return s}clipPos(e){if(e>=this.range.from&&e<this.range.to)return e;for(let t of this.ranges)if(t.to>e)return Math.max(e,t.from);return this.end}peek(e){let t=this.chunkOff+e,n,i;if(t>=0&&t<this.chunk.length)n=this.pos+e,i=this.chunk.charCodeAt(t);else{let s=this.resolveOffset(e,1);if(s==null)return-1;if(n=s,n>=this.chunk2Pos&&n<this.chunk2Pos+this.chunk2.length)i=this.chunk2.charCodeAt(n-this.chunk2Pos);else{let a=this.rangeIndex,o=this.range;for(;o.to<=n;)o=this.ranges[++a];this.chunk2=this.input.chunk(this.chunk2Pos=n),n+this.chunk2.length>o.to&&(this.chunk2=this.chunk2.slice(0,o.to-n)),i=this.chunk2.charCodeAt(0)}}return n>=this.token.lookAhead&&(this.token.lookAhead=n+1),i}acceptToken(e,t=0){let n=t?this.resolveOffset(t,-1):this.pos;if(n==null||n<this.token.start)throw new RangeError("Token end out of bounds");this.token.value=e,this.token.end=n}acceptTokenTo(e,t){this.token.value=e,this.token.end=t}getChunk(){if(this.pos>=this.chunk2Pos&&this.pos<this.chunk2Pos+this.chunk2.length){let{chunk:e,chunkPos:t}=this;this.chunk=this.chunk2,this.chunkPos=this.chunk2Pos,this.chunk2=e,this.chunk2Pos=t,this.chunkOff=this.pos-this.chunkPos}else{this.chunk2=this.chunk,this.chunk2Pos=this.chunkPos;let e=this.input.chunk(this.pos),t=this.pos+e.length;this.chunk=t>this.range.to?e.slice(0,this.range.to-this.pos):e,this.chunkPos=this.pos,this.chunkOff=0}}readNext(){return this.chunkOff>=this.chunk.length&&(this.getChunk(),this.chunkOff==this.chunk.length)?this.next=-1:this.next=this.chunk.charCodeAt(this.chunkOff)}advance(e=1){for(this.chunkOff+=e;this.pos+e>=this.range.to;){if(this.rangeIndex==this.ranges.length-1)return this.setDone();e-=this.range.to-this.pos,this.range=this.ranges[++this.rangeIndex],this.pos=this.range.from}return this.pos+=e,this.pos>=this.token.lookAhead&&(this.token.lookAhead=this.pos+1),this.readNext()}setDone(){return this.pos=this.chunkPos=this.end,this.range=this.ranges[this.rangeIndex=this.ranges.length-1],this.chunk="",this.next=-1}reset(e,t){if(t?(this.token=t,t.start=e,t.lookAhead=e+1,t.value=t.extended=-1):this.token=h_,this.pos!=e){if(this.pos=e,e==this.end)return this.setDone(),this;for(;e<this.range.from;)this.range=this.ranges[--this.rangeIndex];for(;e>=this.range.to;)this.range=this.ranges[++this.rangeIndex];e>=this.chunkPos&&e<this.chunkPos+this.chunk.length?this.chunkOff=e-this.chunkPos:(this.chunk="",this.chunkOff=0),this.readNext()}return this}read(e,t){if(e>=this.chunkPos&&t<=this.chunkPos+this.chunk.length)return this.chunk.slice(e-this.chunkPos,t-this.chunkPos);if(e>=this.chunk2Pos&&t<=this.chunk2Pos+this.chunk2.length)return this.chunk2.slice(e-this.chunk2Pos,t-this.chunk2Pos);if(e>=this.range.from&&t<=this.range.to)return this.input.read(e,t);let n="";for(let i of this.ranges){if(i.from>=t)break;i.to>e&&(n+=this.input.read(Math.max(i.from,e),Math.min(i.to,t)))}return n}}class Ql{constructor(e,t){this.data=e,this.id=t}token(e,t){let{parser:n}=t.p;LE(this.data,e,t,this.id,n.data,n.tokenPrecTable)}}Ql.prototype.contextual=Ql.prototype.fallback=Ql.prototype.extend=!1;class p1{constructor(e,t,n){this.precTable=t,this.elseToken=n,this.data=typeof e=="string"?ec(e):e}token(e,t){let n=e.pos,i=0;for(;;){let s=e.next<0,a=e.resolveOffset(1,1);if(LE(this.data,e,t,0,this.data,this.precTable),e.token.value>-1)break;if(this.elseToken==null)return;if(s||i++,a==null)break;e.reset(a,e.token)}i&&(e.reset(n,e.token),e.acceptToken(this.elseToken,i))}}p1.prototype.contextual=Ql.prototype.fallback=Ql.prototype.extend=!1;class Ha{constructor(e,t={}){this.token=e,this.contextual=!!t.contextual,this.fallback=!!t.fallback,this.extend=!!t.extend}}function LE(r,e,t,n,i,s){let a=0,o=1<<n,{dialect:l}=t.p.parser;e:for(;o&r[a];){let f=r[a+1];for(let d=a+3;d<f;d+=2)if((r[d+1]&o)>0){let p=r[d];if(l.allows(p)&&(e.token.value==-1||e.token.value==p||hK(p,e.token.value,i,s))){e.acceptToken(p);break}}let c=e.next,h=0,u=r[a+2];if(e.next<0&&u>h&&r[f+u*3-3]==65535){a=r[f+u*3-1];continue e}for(;h<u;){let d=h+u>>1,p=f+d+(d<<1),m=r[p],g=r[p+1]||65536;if(c<m)u=d;else if(c>=g)h=d+1;else{a=r[p+2],e.advance();continue e}}break}}function u_(r,e,t){for(let n=e,i;(i=r[n])!=65535;n++)if(i==t)return n-e;return-1}function hK(r,e,t,n){let i=u_(t,n,e);return i<0||u_(t,n,r)<i}const Yn=typeof process<"u"&&f_&&/\bparse\b/.test(f_.LOG);let Jp=null;function d_(r,e,t){let n=r.cursor(an.IncludeAnonymous);for(n.moveTo(e);;)if(!(t<0?n.childBefore(e):n.childAfter(e)))for(;;){if((t<0?n.to<e:n.from>e)&&!n.type.isError)return t<0?Math.max(0,Math.min(n.to-1,e-25)):Math.min(r.length,Math.max(n.from+1,e+25));if(t<0?n.prevSibling():n.nextSibling())break;if(!n.parent())return t<0?0:r.length}}class uK{constructor(e,t){this.fragments=e,this.nodeSet=t,this.i=0,this.fragment=null,this.safeFrom=-1,this.safeTo=-1,this.trees=[],this.start=[],this.index=[],this.nextFragment()}nextFragment(){let e=this.fragment=this.i==this.fragments.length?null:this.fragments[this.i++];if(e){for(this.safeFrom=e.openStart?d_(e.tree,e.from+e.offset,1)-e.offset:e.from,this.safeTo=e.openEnd?d_(e.tree,e.to+e.offset,-1)-e.offset:e.to;this.trees.length;)this.trees.pop(),this.start.pop(),this.index.pop();this.trees.push(e.tree),this.start.push(-e.offset),this.index.push(0),this.nextStart=this.safeFrom}else this.nextStart=1e9}nodeAt(e){if(e<this.nextStart)return null;for(;this.fragment&&this.safeTo<=e;)this.nextFragment();if(!this.fragment)return null;for(;;){let t=this.trees.length-1;if(t<0)return this.nextFragment(),null;let n=this.trees[t],i=this.index[t];if(i==n.children.length){this.trees.pop(),this.start.pop(),this.index.pop();continue}let s=n.children[i],a=this.start[t]+n.positions[i];if(a>e)return this.nextStart=a,null;if(s instanceof ji){if(a==e){if(a<this.safeFrom)return null;let o=a+s.length;if(o<=this.safeTo){let l=s.prop(mr.lookAhead);if(!l||o+l<this.fragment.to)return s}}this.index[t]++,a+s.length>=Math.max(this.safeFrom,e)&&(this.trees.push(s),this.start.push(a),this.index.push(0))}else this.index[t]++,this.nextStart=a+s.length}}}class dK{constructor(e,t){this.stream=t,this.tokens=[],this.mainToken=null,this.actions=[],this.tokens=e.tokenizers.map(n=>new td)}getActions(e){let t=0,n=null,{parser:i}=e.p,{tokenizers:s}=i,a=i.stateSlot(e.state,3),o=e.curContext?e.curContext.hash:0,l=0;for(let f=0;f<s.length;f++){if(!(1<<f&a))continue;let c=s[f],h=this.tokens[f];if(!(n&&!c.fallback)&&((c.contextual||h.start!=e.pos||h.mask!=a||h.context!=o)&&(this.updateCachedToken(h,c,e),h.mask=a,h.context=o),h.lookAhead>h.end+25&&(l=Math.max(h.lookAhead,l)),h.value!=0)){let u=t;if(h.extended>-1&&(t=this.addActions(e,h.extended,h.end,t)),t=this.addActions(e,h.value,h.end,t),!c.extend&&(n=h,t>u))break}}for(;this.actions.length>t;)this.actions.pop();return l&&e.setLookAhead(l),!n&&e.pos==this.stream.end&&(n=new td,n.value=e.p.parser.eofTerm,n.start=n.end=e.pos,t=this.addActions(e,n.value,n.end,t)),this.mainToken=n,this.actions}getMainToken(e){if(this.mainToken)return this.mainToken;let t=new td,{pos:n,p:i}=e;return t.start=n,t.end=Math.min(n+1,i.stream.end),t.value=n==i.stream.end?i.parser.eofTerm:0,t}updateCachedToken(e,t,n){let i=this.stream.clipPos(n.pos);if(t.token(this.stream.reset(i,e),n),e.value>-1){let{parser:s}=n.p;for(let a=0;a<s.specialized.length;a++)if(s.specialized[a]==e.value){let o=s.specializers[a](this.stream.read(e.start,e.end),n);if(o>=0&&n.p.parser.dialect.allows(o>>1)){o&1?e.extended=o>>1:e.value=o>>1;break}}}else e.value=0,e.end=this.stream.clipPos(i+1)}putAction(e,t,n,i){for(let s=0;s<i;s+=3)if(this.actions[s]==e)return i;return this.actions[i++]=e,this.actions[i++]=t,this.actions[i++]=n,i}addActions(e,t,n,i){let{state:s}=e,{parser:a}=e.p,{data:o}=a;for(let l=0;l<2;l++)for(let f=a.stateSlot(s,l?2:1);;f+=3){if(o[f]==65535)if(o[f+1]==1)f=Ls(o,f+2);else{i==0&&o[f+1]==2&&(i=this.putAction(Ls(o,f+2),t,n,i));break}o[f]==t&&(i=this.putAction(Ls(o,f+1),t,n,i))}return i}}class pK{constructor(e,t,n,i){this.parser=e,this.input=t,this.ranges=i,this.recovering=0,this.nextStackID=9812,this.minStackPos=0,this.reused=[],this.stoppedAt=null,this.lastBigReductionStart=-1,this.lastBigReductionSize=0,this.bigReductionCount=0,this.stream=new cK(t,i),this.tokens=new dK(e,this.stream),this.topTerm=e.top[1];let{from:s}=i[0];this.stacks=[f0.start(this,e.top[0],s)],this.fragments=n.length&&this.stream.end-s>e.bufferLength*4?new uK(n,e.nodeSet):null}get parsedPos(){return this.minStackPos}advance(){let e=this.stacks,t=this.minStackPos,n=this.stacks=[],i,s;if(this.bigReductionCount>300&&e.length==1){let[a]=e;for(;a.forceReduce()&&a.stack.length&&a.stack[a.stack.length-2]>=this.lastBigReductionStart;);this.bigReductionCount=this.lastBigReductionSize=0}for(let a=0;a<e.length;a++){let o=e[a];for(;;){if(this.tokens.mainToken=null,o.pos>t)n.push(o);else{if(this.advanceStack(o,n,e))continue;{i||(i=[],s=[]),i.push(o);let l=this.tokens.getMainToken(o);s.push(l.value,l.end)}}break}}if(!n.length){let a=i&&gK(i);if(a)return Yn&&console.log("Finish with "+this.stackID(a)),this.stackToTree(a);if(this.parser.strict)throw Yn&&i&&console.log("Stuck with token "+(this.tokens.mainToken?this.parser.getName(this.tokens.mainToken.value):"none")),new SyntaxError("No parse at "+t);this.recovering||(this.recovering=5)}if(this.recovering&&i){let a=this.stoppedAt!=null&&i[0].pos>this.stoppedAt?i[0]:this.runRecovery(i,s,n);if(a)return Yn&&console.log("Force-finish "+this.stackID(a)),this.stackToTree(a.forceAll())}if(this.recovering){let a=this.recovering==1?1:this.recovering*3;if(n.length>a)for(n.sort((o,l)=>l.score-o.score);n.length>a;)n.pop();n.some(o=>o.reducePos>t)&&this.recovering--}else if(n.length>1){e:for(let a=0;a<n.length-1;a++){let o=n[a];for(let l=a+1;l<n.length;l++){let f=n[l];if(o.sameState(f)||o.buffer.length>500&&f.buffer.length>500)if((o.score-f.score||o.buffer.length-f.buffer.length)>0)n.splice(l--,1);else{n.splice(a--,1);continue e}}}n.length>12&&n.splice(12,n.length-12)}this.minStackPos=n[0].pos;for(let a=1;a<n.length;a++)n[a].pos<this.minStackPos&&(this.minStackPos=n[a].pos);return null}stopAt(e){if(this.stoppedAt!=null&&this.stoppedAt<e)throw new RangeError("Can't move stoppedAt forward");this.stoppedAt=e}advanceStack(e,t,n){let i=e.pos,{parser:s}=this,a=Yn?this.stackID(e)+" -> ":"";if(this.stoppedAt!=null&&i>this.stoppedAt)return e.forceReduce()?e:null;if(this.fragments){let f=e.curContext&&e.curContext.tracker.strict,c=f?e.curContext.hash:0;for(let h=this.fragments.nodeAt(i);h;){let u=this.parser.nodeSet.types[h.type.id]==h.type?s.getGoto(e.state,h.type.id):-1;if(u>-1&&h.length&&(!f||(h.prop(mr.contextHash)||0)==c))return e.useNode(h,u),Yn&&console.log(a+this.stackID(e)+` (via reuse of ${s.getName(h.type.id)})`),!0;if(!(h instanceof ji)||h.children.length==0||h.positions[0]>0)break;let d=h.children[0];if(d instanceof ji&&h.positions[0]==0)h=d;else break}}let o=s.stateSlot(e.state,4);if(o>0)return e.reduce(o),Yn&&console.log(a+this.stackID(e)+` (via always-reduce ${s.getName(o&65535)})`),!0;if(e.stack.length>=8400)for(;e.stack.length>6e3&&e.forceReduce(););let l=this.tokens.getActions(e);for(let f=0;f<l.length;){let c=l[f++],h=l[f++],u=l[f++],d=f==l.length||!n,p=d?e:e.split(),m=this.tokens.mainToken;if(p.apply(c,h,m?m.start:p.pos,u),Yn&&console.log(a+this.stackID(p)+` (via ${c&65536?`reduce of ${s.getName(c&65535)}`:"shift"} for ${s.getName(h)} @ ${i}${p==e?"":", split"})`),d)return!0;p.pos>i?t.push(p):n.push(p)}return!1}advanceFully(e,t){let n=e.pos;for(;;){if(!this.advanceStack(e,null,null))return!1;if(e.pos>n)return p_(e,t),!0}}runRecovery(e,t,n){let i=null,s=!1;for(let a=0;a<e.length;a++){let o=e[a],l=t[a<<1],f=t[(a<<1)+1],c=Yn?this.stackID(o)+" -> ":"";if(o.deadEnd&&(s||(s=!0,o.restart(),Yn&&console.log(c+this.stackID(o)+" (restarted)"),this.advanceFully(o,n))))continue;let h=o.split(),u=c;for(let d=0;h.forceReduce()&&d<10&&(Yn&&console.log(u+this.stackID(h)+" (via force-reduce)"),!this.advanceFully(h,n));d++)Yn&&(u=this.stackID(h)+" -> ");for(let d of o.recoverByInsert(l))Yn&&console.log(c+this.stackID(d)+" (via recover-insert)"),this.advanceFully(d,n);this.stream.end>o.pos?(f==o.pos&&(f++,l=0),o.recoverByDelete(l,f),Yn&&console.log(c+this.stackID(o)+` (via recover-delete ${this.parser.getName(l)})`),p_(o,n)):(!i||i.score<o.score)&&(i=o)}return i}stackToTree(e){return e.close(),ji.build({buffer:c0.create(e),nodeSet:this.parser.nodeSet,topID:this.topTerm,maxBufferLength:this.parser.bufferLength,reused:this.reused,start:this.ranges[0].from,length:e.pos-this.ranges[0].from,minRepeatType:this.parser.minRepeatTerm})}stackID(e){let t=(Jp||(Jp=new WeakMap)).get(e);return t||Jp.set(e,t=String.fromCodePoint(this.nextStackID++)),t+e}}function p_(r,e){for(let t=0;t<e.length;t++){let n=e[t];if(n.pos==r.pos&&n.sameState(r)){e[t].score<r.score&&(e[t]=r);return}}e.push(r)}class mK{constructor(e,t,n){this.source=e,this.flags=t,this.disabled=n}allows(e){return!this.disabled||this.disabled[e]==0}}const em=r=>r;class BE{constructor(e){this.start=e.start,this.shift=e.shift||em,this.reduce=e.reduce||em,this.reuse=e.reuse||em,this.hash=e.hash||(()=>0),this.strict=e.strict!==!1}}class Io extends oK{constructor(e){if(super(),this.wrappers=[],e.version!=14)throw new RangeError(`Parser version (${e.version}) doesn't match runtime version (14)`);let t=e.nodeNames.split(" ");this.minRepeatTerm=t.length;for(let o=0;o<e.repeatNodeCount;o++)t.push("");let n=Object.keys(e.topRules).map(o=>e.topRules[o][1]),i=[];for(let o=0;o<t.length;o++)i.push([]);function s(o,l,f){i[o].push([l,l.deserialize(String(f))])}if(e.nodeProps)for(let o of e.nodeProps){let l=o[0];typeof l=="string"&&(l=mr[l]);for(let f=1;f<o.length;){let c=o[f++];if(c>=0)s(c,l,o[f++]);else{let h=o[f+-c];for(let u=-c;u>0;u--)s(o[f++],l,h);f++}}}this.nodeSet=new Wx(t.map((o,l)=>Ks.define({name:l>=this.minRepeatTerm?void 0:o,id:l,props:i[l],top:n.indexOf(l)>-1,error:l==0,skipped:e.skippedNodes&&e.skippedNodes.indexOf(l)>-1}))),e.propSources&&(this.nodeSet=this.nodeSet.extend(...e.propSources)),this.strict=!1,this.bufferLength=QE;let a=ec(e.tokenData);this.context=e.context,this.specializerSpecs=e.specialized||[],this.specialized=new Uint16Array(this.specializerSpecs.length);for(let o=0;o<this.specializerSpecs.length;o++)this.specialized[o]=this.specializerSpecs[o].term;this.specializers=this.specializerSpecs.map(m_),this.states=ec(e.states,Uint32Array),this.data=ec(e.stateData),this.goto=ec(e.goto),this.maxTerm=e.maxTerm,this.tokenizers=e.tokenizers.map(o=>typeof o=="number"?new Ql(a,o):o),this.topRules=e.topRules,this.dialects=e.dialects||{},this.dynamicPrecedences=e.dynamicPrecedences||null,this.tokenPrecTable=e.tokenPrec,this.termNames=e.termNames||null,this.maxNode=this.nodeSet.types.length-1,this.dialect=this.parseDialect(),this.top=this.topRules[Object.keys(this.topRules)[0]]}createParse(e,t,n){let i=new pK(this,e,t,n);for(let s of this.wrappers)i=s(i,e,t,n);return i}getGoto(e,t,n=!1){let i=this.goto;if(t>=i[0])return-1;for(let s=i[t+1];;){let a=i[s++],o=a&1,l=i[s++];if(o&&n)return l;for(let f=s+(a>>1);s<f;s++)if(i[s]==e)return l;if(o)return-1}}hasAction(e,t){let n=this.data;for(let i=0;i<2;i++)for(let s=this.stateSlot(e,i?2:1),a;;s+=3){if((a=n[s])==65535)if(n[s+1]==1)a=n[s=Ls(n,s+2)];else{if(n[s+1]==2)return Ls(n,s+2);break}if(a==t||a==0)return Ls(n,s+1)}return 0}stateSlot(e,t){return this.states[e*6+t]}stateFlag(e,t){return(this.stateSlot(e,0)&t)>0}validAction(e,t){return!!this.allActions(e,n=>n==t?!0:null)}allActions(e,t){let n=this.stateSlot(e,4),i=n?t(n):void 0;for(let s=this.stateSlot(e,1);i==null;s+=3){if(this.data[s]==65535)if(this.data[s+1]==1)s=Ls(this.data,s+2);else break;i=t(Ls(this.data,s+1))}return i}nextStates(e){let t=[];for(let n=this.stateSlot(e,1);;n+=3){if(this.data[n]==65535)if(this.data[n+1]==1)n=Ls(this.data,n+2);else break;if(!(this.data[n+2]&1)){let i=this.data[n+1];t.some((s,a)=>a&1&&s==i)||t.push(this.data[n],i)}}return t}configure(e){let t=Object.assign(Object.create(Io.prototype),this);if(e.props&&(t.nodeSet=this.nodeSet.extend(...e.props)),e.top){let n=this.topRules[e.top];if(!n)throw new RangeError(`Invalid top rule name ${e.top}`);t.top=n}return e.tokenizers&&(t.tokenizers=this.tokenizers.map(n=>{let i=e.tokenizers.find(s=>s.from==n);return i?i.to:n})),e.specializers&&(t.specializers=this.specializers.slice(),t.specializerSpecs=this.specializerSpecs.map((n,i)=>{let s=e.specializers.find(o=>o.from==n.external);if(!s)return n;let a=Object.assign(Object.assign({},n),{external:s.to});return t.specializers[i]=m_(a),a})),e.contextTracker&&(t.context=e.contextTracker),e.dialect&&(t.dialect=this.parseDialect(e.dialect)),e.strict!=null&&(t.strict=e.strict),e.wrap&&(t.wrappers=t.wrappers.concat(e.wrap)),e.bufferLength!=null&&(t.bufferLength=e.bufferLength),t}hasWrappers(){return this.wrappers.length>0}getName(e){return this.termNames?this.termNames[e]:String(e<=this.maxNode&&this.nodeSet.types[e].name||e)}get eofTerm(){return this.maxNode+1}get topNode(){return this.nodeSet.types[this.top[1]]}dynamicPrecedence(e){let t=this.dynamicPrecedences;return t==null?0:t[e]||0}parseDialect(e){let t=Object.keys(this.dialects),n=t.map(()=>!1);if(e)for(let s of e.split(" ")){let a=t.indexOf(s);a>=0&&(n[a]=!0)}let i=null;for(let s=0;s<t.length;s++)if(!n[s])for(let a=this.dialects[t[s]],o;(o=this.data[a++])!=65535;)(i||(i=new Uint8Array(this.maxTerm+1)))[o]=1;return new mK(e,n,i)}static deserialize(e){return new Io(e)}}function Ls(r,e){return r[e]|r[e+1]<<16}function gK(r){let e=null;for(let t of r){let n=t.p.stoppedAt;(t.pos==t.p.stream.end||n!=null&&t.pos>n)&&t.p.parser.stateFlag(t.state,2)&&(!e||e.score<t.score)&&(e=t)}return e}function m_(r){if(r.external){let e=r.extend?1:0;return(t,n)=>r.external(t,n)<<1|e}return r.get}const OK=314,xK=315,g_=1,vK=2,yK=3,wK=4,bK=316,_K=318,kK=319,SK=5,TK=6,CK=0,m1=[9,10,11,12,13,32,133,160,5760,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8232,8233,8239,8287,12288],ZE=125,AK=59,g1=47,EK=42,PK=43,RK=45,QK=60,FK=44,$K=63,NK=46,DK=91,MK=new BE({start:!1,shift(r,e){return e==SK||e==TK||e==_K?r:e==kK},strict:!1}),IK=new Ha((r,e)=>{let{next:t}=r;(t==ZE||t==-1||e.context)&&r.acceptToken(bK)},{contextual:!0,fallback:!0}),LK=new Ha((r,e)=>{let{next:t}=r,n;m1.indexOf(t)>-1||t==g1&&((n=r.peek(1))==g1||n==EK)||t!=ZE&&t!=AK&&t!=-1&&!e.context&&r.acceptToken(OK)},{contextual:!0}),BK=new Ha((r,e)=>{r.next==DK&&!e.context&&r.acceptToken(xK)},{contextual:!0}),ZK=new Ha((r,e)=>{let{next:t}=r;if(t==PK||t==RK){if(r.advance(),t==r.next){r.advance();let n=!e.context&&e.canShift(g_);r.acceptToken(n?g_:vK)}}else t==$K&&r.peek(1)==NK&&(r.advance(),r.advance(),(r.next<48||r.next>57)&&r.acceptToken(yK))},{contextual:!0});function tm(r,e){return r>=65&&r<=90||r>=97&&r<=122||r==95||r>=192||!e&&r>=48&&r<=57}const WK=new Ha((r,e)=>{if(r.next!=QK||!e.dialectEnabled(CK)||(r.advance(),r.next==g1))return;let t=0;for(;m1.indexOf(r.next)>-1;)r.advance(),t++;if(tm(r.next,!0)){for(r.advance(),t++;tm(r.next,!1);)r.advance(),t++;for(;m1.indexOf(r.next)>-1;)r.advance(),t++;if(r.next==FK)return;for(let n=0;;n++){if(n==7){if(!tm(r.next,!0))return;break}if(r.next!="extends".charCodeAt(n))break;r.advance(),t++}}r.acceptToken(wK,-t)}),UK=sa({"get set async static":B.modifier,"for while do if else switch try catch finally return throw break continue default case":B.controlKeyword,"in of await yield void typeof delete instanceof":B.operatorKeyword,"let var const using function class extends":B.definitionKeyword,"import export from":B.moduleKeyword,"with debugger as new":B.keyword,TemplateString:B.special(B.string),super:B.atom,BooleanLiteral:B.bool,this:B.self,null:B.null,Star:B.modifier,VariableName:B.variableName,"CallExpression/VariableName TaggedTemplateExpression/VariableName":B.function(B.variableName),VariableDefinition:B.definition(B.variableName),Label:B.labelName,PropertyName:B.propertyName,PrivatePropertyName:B.special(B.propertyName),"CallExpression/MemberExpression/PropertyName":B.function(B.propertyName),"FunctionDeclaration/VariableDefinition":B.function(B.definition(B.variableName)),"ClassDeclaration/VariableDefinition":B.definition(B.className),"NewExpression/VariableName":B.className,PropertyDefinition:B.definition(B.propertyName),PrivatePropertyDefinition:B.definition(B.special(B.propertyName)),UpdateOp:B.updateOperator,"LineComment Hashbang":B.lineComment,BlockComment:B.blockComment,Number:B.number,String:B.string,Escape:B.escape,ArithOp:B.arithmeticOperator,LogicOp:B.logicOperator,BitOp:B.bitwiseOperator,CompareOp:B.compareOperator,RegExp:B.regexp,Equals:B.definitionOperator,Arrow:B.function(B.punctuation),": Spread":B.punctuation,"( )":B.paren,"[ ]":B.squareBracket,"{ }":B.brace,"InterpolationStart InterpolationEnd":B.special(B.brace),".":B.derefOperator,", ;":B.separator,"@":B.meta,TypeName:B.typeName,TypeDefinition:B.definition(B.typeName),"type enum interface implements namespace module declare":B.definitionKeyword,"abstract global Privacy readonly override":B.modifier,"is keyof unique infer asserts":B.operatorKeyword,JSXAttributeValue:B.attributeValue,JSXText:B.content,"JSXStartTag JSXStartCloseTag JSXSelfCloseEndTag JSXEndTag":B.angleBracket,"JSXIdentifier JSXNameSpacedName":B.tagName,"JSXAttribute/JSXIdentifier JSXAttribute/JSXNameSpacedName":B.attributeName,"JSXBuiltin/JSXIdentifier":B.standard(B.tagName)}),XK={__proto__:null,export:20,as:25,from:33,default:36,async:41,function:42,const:52,extends:56,this:60,true:68,false:68,null:80,void:84,typeof:88,super:104,new:138,delete:150,yield:159,await:163,class:168,public:231,private:231,protected:231,readonly:233,instanceof:252,satisfies:255,in:256,import:290,keyof:347,unique:351,infer:357,asserts:393,is:395,abstract:415,implements:417,type:419,let:422,var:424,using:427,interface:433,enum:437,namespace:443,module:445,declare:449,global:453,for:472,of:481,while:484,with:488,do:492,if:496,else:498,switch:502,case:508,try:514,catch:518,finally:522,return:526,throw:530,break:534,continue:538,debugger:542},VK={__proto__:null,async:125,get:127,set:129,declare:191,public:193,private:193,protected:193,static:195,abstract:197,override:199,readonly:205,accessor:207,new:399},qK={__proto__:null,"<":189},jK=Io.deserialize({version:14,states:"$EOQ%TQlOOO%[QlOOO'_QpOOP(lO`OOO*zQ!0MxO'#CiO+RO#tO'#CjO+aO&jO'#CjO+oO#@ItO'#D_O.QQlO'#DeO.bQlO'#DpO%[QlO'#DxO0fQlO'#EQOOQ!0Lf'#EY'#EYO1PQ`O'#EVOOQO'#En'#EnOOQO'#Ij'#IjO1XQ`O'#GrO1dQ`O'#EmO1iQ`O'#EmO3hQ!0MxO'#JpO6[Q!0MxO'#JqO6uQ`O'#F[O6zQ,UO'#FsOOQ!0Lf'#Fe'#FeO7VO7dO'#FeO7eQMhO'#F{O9UQ`O'#FzOOQ!0Lf'#Jq'#JqOOQ!0Lb'#Jp'#JpO9ZQ`O'#GvOOQ['#K]'#K]O9fQ`O'#IWO9kQ!0LrO'#IXOOQ['#J^'#J^OOQ['#I]'#I]Q`QlOOQ`QlOOO9sQ!L^O'#DtO9zQlO'#D|O:RQlO'#EOO9aQ`O'#GrO:YQMhO'#CoO:hQ`O'#ElO:sQ`O'#EwO:xQMhO'#FdO;gQ`O'#GrOOQO'#K^'#K^O;lQ`O'#K^O;zQ`O'#GzO;zQ`O'#G{O;zQ`O'#G}O9aQ`O'#HQO<qQ`O'#HTO>YQ`O'#CeO>jQ`O'#HaO>rQ`O'#HgO>rQ`O'#HiO`QlO'#HkO>rQ`O'#HmO>rQ`O'#HpO>wQ`O'#HvO>|Q!0LsO'#H|O%[QlO'#IOO?XQ!0LsO'#IQO?dQ!0LsO'#ISO9kQ!0LrO'#IUO?oQ!0MxO'#CiO@qQpO'#DjQOQ`OOO%[QlO'#EOOAXQ`O'#ERO:YQMhO'#ElOAdQ`O'#ElOAoQ!bO'#FdOOQ['#Cg'#CgOOQ!0Lb'#Do'#DoOOQ!0Lb'#Jt'#JtO%[QlO'#JtOOQO'#Jw'#JwOOQO'#If'#IfOBoQpO'#EeOOQ!0Lb'#Ed'#EdOOQ!0Lb'#J{'#J{OCkQ!0MSO'#EeOCuQpO'#EUOOQO'#Jv'#JvODZQpO'#JwOEhQpO'#EUOCuQpO'#EePEuO&2DjO'#CbPOOO)CD{)CD{OOOO'#I^'#I^OFQO#tO,59UOOQ!0Lh,59U,59UOOOO'#I_'#I_OF`O&jO,59UOFnQ!L^O'#DaOOOO'#Ia'#IaOFuO#@ItO,59yOOQ!0Lf,59y,59yOGTQlO'#IbOGhQ`O'#JrOIgQ!fO'#JrO+}QlO'#JrOInQ`O,5:POJUQ`O'#EnOJcQ`O'#KROJnQ`O'#KQOJnQ`O'#KQOJvQ`O,5;[OJ{Q`O'#KPOOQ!0Ln,5:[,5:[OKSQlO,5:[OMQQ!0MxO,5:dOMqQ`O,5:lON[Q!0LrO'#KOONcQ`O'#J}O9ZQ`O'#J}ONwQ`O'#J}O! PQ`O,5;ZO! UQ`O'#J}O!#ZQ!fO'#JqOOQ!0Lh'#Ci'#CiO%[QlO'#EQO!#yQ!fO,5:qOOQS'#Jx'#JxOOQO-E<h-E<hO9aQ`O,5=^O!$aQ`O,5=^O!$fQlO,5;XO!&iQMhO'#EiO!(SQ`O,5;XO!(XQlO'#DwO!(cQpO,5;bO!(kQpO,5;bO%[QlO,5;bOOQ['#FS'#FSOOQ['#FU'#FUO%[QlO,5;cO%[QlO,5;cO%[QlO,5;cO%[QlO,5;cO%[QlO,5;cO%[QlO,5;cO%[QlO,5;cO%[QlO,5;cO%[QlO,5;cO%[QlO,5;cOOQ['#FY'#FYO!(yQlO,5;sOOQ!0Lf,5;x,5;xOOQ!0Lf,5;y,5;yOOQ!0Lf,5;{,5;{O%[QlO'#InO!*|Q!0LrO,5<hO%[QlO,5;cO!&iQMhO,5;cO!+kQMhO,5;cO!-]QMhO'#E[O%[QlO,5;vOOQ!0Lf,5;z,5;zO!-dQ,UO'#FiO!.aQ,UO'#KVO!-{Q,UO'#KVO!.hQ,UO'#KVOOQO'#KV'#KVO!.|Q,UO,5<ROOOW,5<_,5<_O!/_QlO'#FuOOOW'#Im'#ImO7VO7dO,5<PO!/fQ,UO'#FwOOQ!0Lf,5<P,5<PO!0VQ$IUO'#CwOOQ!0Lh'#C{'#C{O!0jO#@ItO'#DPO!1WQMjO,5<dO!1_Q`O,5<gO!2zQ(CWO'#GWO!3XQ`O'#GXO!3^Q`O'#GXO!4|Q(CWO'#G]O!6RQpO'#GaOOQO'#Gm'#GmO!+rQMhO'#GlOOQO'#Go'#GoO!+rQMhO'#GnO!6tQ$IUO'#JjOOQ!0Lh'#Jj'#JjO!7OQ`O'#JiO!7^Q`O'#JhO!7fQ`O'#CuOOQ!0Lh'#Cy'#CyO!7qQ`O'#C{OOQ!0Lh'#DT'#DTOOQ!0Lh'#DV'#DVO1SQ`O'#DXO!+rQMhO'#GOO!+rQMhO'#GQO!7vQ`O'#GSO!7{Q`O'#GTO!3^Q`O'#GZO!+rQMhO'#G`O;zQ`O'#JiO!8QQ`O'#EoO!8oQ`O,5<fOOQ!0Lb'#Cr'#CrO!8wQ`O'#EpO!9qQpO'#EqOOQ!0Lb'#KP'#KPO!9xQ!0LrO'#K_O9kQ!0LrO,5=bO`QlO,5>rOOQ['#Jf'#JfOOQ[,5>s,5>sOOQ[-E<Z-E<ZO!;wQ!0MxO,5:`O!9lQpO,5:^O!>bQ!0MxO,5:hO%[QlO,5:hO!@xQ!0MxO,5:jOOQO,5@x,5@xO!AiQMhO,5=^O!AwQ!0LrO'#JgO9UQ`O'#JgO!BYQ!0LrO,59ZO!BeQpO,59ZO!BmQMhO,59ZO:YQMhO,59ZO!BxQ`O,5;XO!CQQ`O'#H`O!CfQ`O'#KbO%[QlO,5;|O!9lQpO,5<OO!CnQ`O,5=yO!CsQ`O,5=yO!CxQ`O,5=yO9kQ!0LrO,5=yO;zQ`O,5=iOOQO'#Cw'#CwO!DWQpO,5=fO!D`QMhO,5=gO!DkQ`O,5=iO!DpQ!bO,5=lO!DxQ`O'#K^O>wQ`O'#HVO9aQ`O'#HXO!D}Q`O'#HXO:YQMhO'#HZO!ESQ`O'#HZOOQ[,5=o,5=oO!EXQ`O'#H[O!EjQ`O'#CoO!EoQ`O,59PO!EyQ`O,59PO!HOQlO,59POOQ[,59P,59PO!H`Q!0LrO,59PO%[QlO,59PO!JkQlO'#HcOOQ['#Hd'#HdOOQ['#He'#HeO`QlO,5={O!KRQ`O,5={O`QlO,5>RO`QlO,5>TO!KWQ`O,5>VO`QlO,5>XO!K]Q`O,5>[O!KbQlO,5>bOOQ[,5>h,5>hO%[QlO,5>hO9kQ!0LrO,5>jOOQ[,5>l,5>lO# lQ`O,5>lOOQ[,5>n,5>nO# lQ`O,5>nOOQ[,5>p,5>pO#!YQpO'#D]O%[QlO'#JtO#!{QpO'#JtO##VQpO'#DkO##hQpO'#DkO#%yQlO'#DkO#&QQ`O'#JsO#&YQ`O,5:UO#&_Q`O'#ErO#&mQ`O'#KSO#&uQ`O,5;]O#&zQpO'#DkO#'XQpO'#ETOOQ!0Lf,5:m,5:mO%[QlO,5:mO#'`Q`O,5:mO>wQ`O,5;WO!BeQpO,5;WO!BmQMhO,5;WO:YQMhO,5;WO#'hQ`O,5@`O#'mQ07dO,5:qOOQO-E<d-E<dO#(sQ!0MSO,5;POCuQpO,5:pO#(}QpO,5:pOCuQpO,5;PO!BYQ!0LrO,5:pOOQ!0Lb'#Eh'#EhOOQO,5;P,5;PO%[QlO,5;PO#)[Q!0LrO,5;PO#)gQ!0LrO,5;PO!BeQpO,5:pOOQO,5;V,5;VO#)uQ!0LrO,5;PPOOO'#I['#I[P#*ZO&2DjO,58|POOO,58|,58|OOOO-E<[-E<[OOQ!0Lh1G.p1G.pOOOO-E<]-E<]OOOO,59{,59{O#*fQ!bO,59{OOOO-E<_-E<_OOQ!0Lf1G/e1G/eO#*kQ!fO,5>|O+}QlO,5>|OOQO,5?S,5?SO#*uQlO'#IbOOQO-E<`-E<`O#+SQ`O,5@^O#+[Q!fO,5@^O#+cQ`O,5@lOOQ!0Lf1G/k1G/kO%[QlO,5@mO#+kQ`O'#IhOOQO-E<f-E<fO#+cQ`O,5@lOOQ!0Lb1G0v1G0vOOQ!0Ln1G/v1G/vOOQ!0Ln1G0W1G0WO%[QlO,5@jO#,PQ!0LrO,5@jO#,bQ!0LrO,5@jO#,iQ`O,5@iO9ZQ`O,5@iO#,qQ`O,5@iO#-PQ`O'#IkO#,iQ`O,5@iOOQ!0Lb1G0u1G0uO!(cQpO,5:sO!(nQpO,5:sOOQS,5:u,5:uO#-qQdO,5:uO#-yQMhO1G2xO9aQ`O1G2xOOQ!0Lf1G0s1G0sO#.XQ!0MxO1G0sO#/^Q!0MvO,5;TOOQ!0Lh'#GV'#GVO#/zQ!0MzO'#JjO!$fQlO1G0sO#2VQ!fO'#JuO%[QlO'#JuO#2aQ`O,5:cOOQ!0Lh'#D]'#D]OOQ!0Lf1G0|1G0|O%[QlO1G0|OOQ!0Lf1G1e1G1eO#2fQ`O1G0|O#4zQ!0MxO1G0}O#5RQ!0MxO1G0}O#7iQ!0MxO1G0}O#7pQ!0MxO1G0}O#:WQ!0MxO1G0}O#<nQ!0MxO1G0}O#<uQ!0MxO1G0}O#<|Q!0MxO1G0}O#?dQ!0MxO1G0}O#?kQ!0MxO1G0}O#AxQ?MtO'#CiO#CsQ?MtO1G1_O#CzQ?MtO'#JqO#D_Q!0MxO,5?YOOQ!0Lb-E<l-E<lO#FlQ!0MxO1G0}O#GiQ!0MzO1G0}OOQ!0Lf1G0}1G0}O#HlQMjO'#JzO#HvQ`O,5:vO#H{Q!0MxO1G1bO#IoQ,UO,5<VO#IwQ,UO,5<WO#JPQ,UO'#FnO#JhQ`O'#FmOOQO'#KW'#KWOOQO'#Il'#IlO#JmQ,UO1G1mOOQ!0Lf1G1m1G1mOOOW1G1x1G1xO#KOQ?MtO'#JpO#KYQ`O,5<aO!(yQlO,5<aOOOW-E<k-E<kOOQ!0Lf1G1k1G1kO#K_QpO'#KVOOQ!0Lf,5<c,5<cO#KgQpO,5<cO#KlQMhO'#DROOOO'#I`'#I`O#KsO#@ItO,59kOOQ!0Lh,59k,59kO%[QlO1G2OO!7{Q`O'#IpO#LOQ`O,5<yOOQ!0Lh,5<v,5<vO!+rQMhO'#IsO#LlQMjO,5=WO!+rQMhO'#IuO#M_QMjO,5=YO!&iQMhO,5=[OOQO1G2R1G2RO#MiQ!dO'#CrO#M|Q(CWO'#EpO$ RQpO'#GaO$ iQ!dO,5<rO$ pQ`O'#KYO9ZQ`O'#KYO$!OQ`O,5<tO!+rQMhO,5<sO$!TQ`O'#GYO$!fQ`O,5<sO$!kQ!dO'#GVO$!xQ!dO'#KZO$#SQ`O'#KZO!&iQMhO'#KZO$#XQ`O,5<wO$#^QlO'#JtO$#hQpO'#GbO##hQpO'#GbO$#yQ`O'#GfO!3^Q`O'#GjO$$OQ!0LrO'#IrO$$ZQpO,5<{OOQ!0Lp,5<{,5<{O$$bQpO'#GbO$$oQpO'#GcO$%QQpO'#GcO$%VQMjO,5=WO$%gQMjO,5=YOOQ!0Lh,5=],5=]O!+rQMhO,5@TO!+rQMhO,5@TO$%wQ`O'#IwO$&VQ`O,5@SO$&_Q`O,59aOOQ!0Lh,59g,59gO$'UQ$IYO,59sOOQ!0Lh'#Jn'#JnO$'wQMjO,5<jO$(jQMjO,5<lO@iQ`O,5<nOOQ!0Lh,5<o,5<oO$(tQ`O,5<uO$(yQMjO,5<zO$)ZQ`O,5@TO$)iQ`O'#J}O!$fQlO1G2QO$)nQ`O1G2QO9ZQ`O'#KQO9ZQ`O'#ErO%[QlO'#ErO9ZQ`O'#IyO$)sQ!0LrO,5@yOOQ[1G2|1G2|OOQ[1G4^1G4^OOQ!0Lf1G/z1G/zOOQ!0Lf1G/x1G/xO$+uQ!0MxO1G0SOOQ[1G2x1G2xO!&iQMhO1G2xO%[QlO1G2xO#-|Q`O1G2xO$-yQMhO'#EiOOQ!0Lb,5@R,5@RO$.WQ!0LrO,5@ROOQ[1G.u1G.uO!BYQ!0LrO1G.uO!BeQpO1G.uO!BmQMhO1G.uO$.iQ`O1G0sO$.nQ`O'#CiO$.yQ`O'#KcO$/RQ`O,5=zO$/WQ`O'#KcO$/]Q`O'#KcO$/kQ`O'#JPO$/yQ`O,5@|O$0RQ!fO1G1hOOQ!0Lf1G1j1G1jO9aQ`O1G3eO@iQ`O1G3eO$0YQ`O1G3eO$0_Q`O1G3eOOQ[1G3e1G3eO!DkQ`O1G3TO!&iQMhO1G3QO$0dQ`O1G3QOOQ[1G3R1G3RO!&iQMhO1G3RO$0iQ`O1G3RO$0qQpO'#HPOOQ[1G3T1G3TO!5|QpO'#I{O!DpQ!bO1G3WOOQ[1G3W1G3WOOQ[,5=q,5=qO$0yQMhO,5=sO9aQ`O,5=sO$#yQ`O,5=uO9UQ`O,5=uO!BeQpO,5=uO!BmQMhO,5=uO:YQMhO,5=uO$1XQ`O'#KaO$1dQ`O,5=vOOQ[1G.k1G.kO$1iQ!0LrO1G.kO@iQ`O1G.kO$1tQ`O1G.kO9kQ!0LrO1G.kO$3|Q!fO,5AOO$4ZQ`O,5AOO9ZQ`O,5AOO$4fQlO,5=}O$4mQ`O,5=}OOQ[1G3g1G3gO`QlO1G3gOOQ[1G3m1G3mOOQ[1G3o1G3oO>rQ`O1G3qO$4rQlO1G3sO$8vQlO'#HrOOQ[1G3v1G3vO$9TQ`O'#HxO>wQ`O'#HzOOQ[1G3|1G3|O$9]QlO1G3|O9kQ!0LrO1G4SOOQ[1G4U1G4UOOQ!0Lb'#G^'#G^O9kQ!0LrO1G4WO9kQ!0LrO1G4YO$=dQ`O,5@`O!(yQlO,5;^O9ZQ`O,5;^O>wQ`O,5:VO!(yQlO,5:VO!BeQpO,5:VO$=iQ?MtO,5:VOOQO,5;^,5;^O$=sQpO'#IcO$>ZQ`O,5@_OOQ!0Lf1G/p1G/pO$>cQpO'#IiO$>mQ`O,5@nOOQ!0Lb1G0w1G0wO##hQpO,5:VOOQO'#Ie'#IeO$>uQpO,5:oOOQ!0Ln,5:o,5:oO#'cQ`O1G0XOOQ!0Lf1G0X1G0XO%[QlO1G0XOOQ!0Lf1G0r1G0rO>wQ`O1G0rO!BeQpO1G0rO!BmQMhO1G0rOOQ!0Lb1G5z1G5zO!BYQ!0LrO1G0[OOQO1G0k1G0kO%[QlO1G0kO$>|Q!0LrO1G0kO$?XQ!0LrO1G0kO!BeQpO1G0[OCuQpO1G0[O$?gQ!0LrO1G0kOOQO1G0[1G0[O$?{Q!0MxO1G0kPOOO-E<Y-E<YPOOO1G.h1G.hOOOO1G/g1G/gO$@VQ!bO,5<hO$@_Q!fO1G4hOOQO1G4n1G4nO%[QlO,5>|O$@iQ`O1G5xO$@qQ`O1G6WO$@yQ!fO1G6XO9ZQ`O,5?SO$ATQ!0MxO1G6UO%[QlO1G6UO$AeQ!0LrO1G6UO$AvQ`O1G6TO$AvQ`O1G6TO9ZQ`O1G6TO$BOQ`O,5?VO9ZQ`O,5?VOOQO,5?V,5?VO$BdQ`O,5?VO$)iQ`O,5?VOOQO-E<i-E<iOOQS1G0_1G0_OOQS1G0a1G0aO#-tQ`O1G0aOOQ[7+(d7+(dO!&iQMhO7+(dO%[QlO7+(dO$BrQ`O7+(dO$B}QMhO7+(dO$C]Q!0MzO,5=WO$EhQ!0MzO,5=YO$GsQ!0MzO,5=WO$JUQ!0MzO,5=YO$LgQ!0MzO,59sO$NlQ!0MzO,5<jO%!wQ!0MzO,5<lO%%SQ!0MzO,5<zOOQ!0Lf7+&_7+&_O%'eQ!0MxO7+&_O%(XQlO'#IdO%(fQ`O,5@aO%(nQ!fO,5@aOOQ!0Lf1G/}1G/}O%(xQ`O7+&hOOQ!0Lf7+&h7+&hO%(}Q?MtO,5:dO%[QlO7+&yO%)XQ?MtO,5:`O%)fQ?MtO,5:hO%)pQ?MtO,5:jO%)zQMhO'#IgO%*UQ`O,5@fOOQ!0Lh1G0b1G0bOOQO1G1q1G1qOOQO1G1r1G1rO%*^Q!jO,5<YO!(yQlO,5<XOOQO-E<j-E<jOOQ!0Lf7+'X7+'XOOOW7+'d7+'dOOOW1G1{1G1{O%*iQ`O1G1{OOQ!0Lf1G1}1G1}OOOO,59m,59mO%*nQ!dO,59mOOOO-E<^-E<^OOQ!0Lh1G/V1G/VO%*uQ!0MxO7+'jOOQ!0Lh,5?[,5?[O%+iQMhO1G2eP%+pQ`O'#IpPOQ!0Lh-E<n-E<nO%,^QMjO,5?_OOQ!0Lh-E<q-E<qO%-PQMjO,5?aOOQ!0Lh-E<s-E<sO%-ZQ!dO1G2vO%-bQ!dO'#CrO%-xQMhO'#KQO$#^QlO'#JtOOQ!0Lh1G2^1G2^O%.PQ`O'#IoO%.eQ`O,5@tO%.eQ`O,5@tO%.mQ`O,5@tO%.xQ`O,5@tOOQO1G2`1G2`O%/WQMjO1G2_O!+rQMhO1G2_O%/hQ(CWO'#IqO%/uQ`O,5@uO!&iQMhO,5@uO%/}Q!dO,5@uOOQ!0Lh1G2c1G2cO%2_Q!fO'#CiO%2iQ`O,5=OOOQ!0Lb,5<|,5<|O%2qQpO,5<|OOQ!0Lb,5<},5<}OCfQ`O,5<|O%2|QpO,5<|OOQ!0Lb,5=Q,5=QO$)iQ`O,5=UOOQO,5?^,5?^OOQO-E<p-E<pOOQ!0Lp1G2g1G2gO##hQpO,5<|O$#^QlO,5=OO%3[Q`O,5<}O%3gQpO,5<}O!+rQMhO'#IsO%4aQMjO1G2rO!+rQMhO'#IuO%5SQMjO1G2tO%5^QMjO1G5oO%5hQMjO1G5oOOQO,5?c,5?cOOQO-E<u-E<uOOQO1G.{1G.{O!9lQpO,59uO%[QlO,59uOOQ!0Lh,5<i,5<iO%5uQ`O1G2YO!+rQMhO1G2aO!+rQMhO1G5oO!+rQMhO1G5oO%5zQ!0MxO7+'lOOQ!0Lf7+'l7+'lO!$fQlO7+'lO%6nQ`O,5;^OOQ!0Lb,5?e,5?eOOQ!0Lb-E<w-E<wO%6sQ!dO'#K[O#'cQ`O7+(dO4UQ!fO7+(dO$BuQ`O7+(dO%6}Q!0MvO'#CiO%7nQ!0LrO,5=RO%8PQ!0MvO,5=RO%8dQ`O,5=ROOQ!0Lb1G5m1G5mOOQ[7+$a7+$aO!BYQ!0LrO7+$aO!BeQpO7+$aO!$fQlO7+&_O%8lQ`O'#JOO%9TQ`O,5@}OOQO1G3f1G3fO9aQ`O,5@}O%9TQ`O,5@}O%9]Q`O,5@}OOQO,5?k,5?kOOQO-E<}-E<}OOQ!0Lf7+'S7+'SO%9bQ`O7+)PO9kQ!0LrO7+)PO9aQ`O7+)PO@iQ`O7+)POOQ[7+(o7+(oO%9gQ!0MvO7+(lO!&iQMhO7+(lO!DfQ`O7+(mOOQ[7+(m7+(mO!&iQMhO7+(mO%9qQ`O'#K`O%9|Q`O,5=kOOQO,5?g,5?gOOQO-E<y-E<yOOQ[7+(r7+(rO%;`QpO'#HYOOQ[1G3_1G3_O!&iQMhO1G3_O%[QlO1G3_O%;gQ`O1G3_O%;rQMhO1G3_O9kQ!0LrO1G3aO$#yQ`O1G3aO9UQ`O1G3aO!BeQpO1G3aO!BmQMhO1G3aO%<QQ`O'#I}O%<fQ`O,5@{O%<nQpO,5@{OOQ!0Lb1G3b1G3bOOQ[7+$V7+$VO@iQ`O7+$VO9kQ!0LrO7+$VO%<yQ`O7+$VO%[QlO1G6jO%[QlO1G6kO%=OQ!0LrO1G6jO%=YQlO1G3iO%=aQ`O1G3iO%=fQlO1G3iOOQ[7+)R7+)RO9kQ!0LrO7+)]O`QlO7+)_OOQ['#Kf'#KfOOQ['#JQ'#JQO%=mQlO,5>^OOQ[,5>^,5>^O%[QlO'#HsO%=zQ`O'#HuOOQ[,5>d,5>dO9ZQ`O,5>dOOQ[,5>f,5>fOOQ[7+)h7+)hOOQ[7+)n7+)nOOQ[7+)r7+)rOOQ[7+)t7+)tO%>PQpO1G5zO%>kQ?MtO1G0xO%>uQ`O1G0xOOQO1G/q1G/qO%?QQ?MtO1G/qO>wQ`O1G/qO!(yQlO'#DkOOQO,5>},5>}OOQO-E<a-E<aOOQO,5?T,5?TOOQO-E<g-E<gO!BeQpO1G/qOOQO-E<c-E<cOOQ!0Ln1G0Z1G0ZOOQ!0Lf7+%s7+%sO#'cQ`O7+%sOOQ!0Lf7+&^7+&^O>wQ`O7+&^O!BeQpO7+&^OOQO7+%v7+%vO$?{Q!0MxO7+&VOOQO7+&V7+&VO%[QlO7+&VO%?[Q!0LrO7+&VO!BYQ!0LrO7+%vO!BeQpO7+%vO%?gQ!0LrO7+&VO%?uQ!0MxO7++pO%[QlO7++pO%@VQ`O7++oO%@VQ`O7++oOOQO1G4q1G4qO9ZQ`O1G4qO%@_Q`O1G4qOOQS7+%{7+%{O#'cQ`O<<LOO4UQ!fO<<LOO%@mQ`O<<LOOOQ[<<LO<<LOO!&iQMhO<<LOO%[QlO<<LOO%@uQ`O<<LOO%AQQ!0MzO,5?_O%C]Q!0MzO,5?aO%EhQ!0MzO1G2_O%GyQ!0MzO1G2rO%JUQ!0MzO1G2tO%LaQ!fO,5?OO%[QlO,5?OOOQO-E<b-E<bO%LkQ`O1G5{OOQ!0Lf<<JS<<JSO%LsQ?MtO1G0sO%NzQ?MtO1G0}O& RQ?MtO1G0}O&#SQ?MtO1G0}O&#ZQ?MtO1G0}O&%[Q?MtO1G0}O&']Q?MtO1G0}O&'dQ?MtO1G0}O&'kQ?MtO1G0}O&)lQ?MtO1G0}O&)sQ?MtO1G0}O&)zQ!0MxO<<JeO&+rQ?MtO1G0}O&,oQ?MvO1G0}O&-rQ?MvO'#JjO&/xQ?MtO1G1bO&0VQ?MtO1G0SO&0aQMjO,5?ROOQO-E<e-E<eO!(yQlO'#FpOOQO'#KX'#KXOOQO1G1t1G1tO&0kQ`O1G1sO&0pQ?MtO,5?YOOOW7+'g7+'gOOOO1G/X1G/XO&0zQ!dO1G4vOOQ!0Lh7+(P7+(PP!&iQMhO,5?[O!+rQMhO7+(bO&1RQ`O,5?ZO9ZQ`O,5?ZOOQO-E<m-E<mO&1aQ`O1G6`O&1aQ`O1G6`O&1iQ`O1G6`O&1tQMjO7+'yO&2UQ!dO,5?]O&2`Q`O,5?]O!&iQMhO,5?]OOQO-E<o-E<oO&2eQ!dO1G6aO&2oQ`O1G6aO&2wQ`O1G2jO!&iQMhO1G2jOOQ!0Lb1G2h1G2hOOQ!0Lb1G2i1G2iO%2qQpO1G2hO!BeQpO1G2hOCfQ`O1G2hOOQ!0Lb1G2p1G2pO&2|QpO1G2hO&3[Q`O1G2jO$)iQ`O1G2iOCfQ`O1G2iO$#^QlO1G2jO&3dQ`O1G2iO&4WQMjO,5?_OOQ!0Lh-E<r-E<rO&4yQMjO,5?aOOQ!0Lh-E<t-E<tO!+rQMhO7++ZOOQ!0Lh1G/a1G/aO&5TQ`O1G/aOOQ!0Lh7+'t7+'tO&5YQMjO7+'{O&5jQMjO7++ZO&5tQMjO7++ZO&6RQ!0MxO<<KWOOQ!0Lf<<KW<<KWO&6uQ`O1G0xO!&iQMhO'#IxO&6zQ`O,5@vO&8|Q!fO<<LOO!&iQMhO1G2mO&9TQ!0LrO1G2mOOQ[<<G{<<G{O!BYQ!0LrO<<G{O&9fQ!0MxO<<IyOOQ!0Lf<<Iy<<IyOOQO,5?j,5?jO&:YQ`O,5?jO&:_Q`O,5?jOOQO-E<|-E<|O&:mQ`O1G6iO&:mQ`O1G6iO9aQ`O1G6iO@iQ`O<<LkOOQ[<<Lk<<LkO&:uQ`O<<LkO9kQ!0LrO<<LkOOQ[<<LW<<LWO%9gQ!0MvO<<LWOOQ[<<LX<<LXO!DfQ`O<<LXO&:zQpO'#IzO&;VQ`O,5@zO!(yQlO,5@zOOQ[1G3V1G3VOOQO'#I|'#I|O9kQ!0LrO'#I|O&;_QpO,5=tOOQ[,5=t,5=tO&;fQpO'#EeO&;mQpO'#GdO&;rQ`O7+(yO&;wQ`O7+(yOOQ[7+(y7+(yO!&iQMhO7+(yO%[QlO7+(yO&<PQ`O7+(yOOQ[7+({7+({O9kQ!0LrO7+({O$#yQ`O7+({O9UQ`O7+({O!BeQpO7+({O&<[Q`O,5?iOOQO-E<{-E<{OOQO'#H]'#H]O&<gQ`O1G6gO9kQ!0LrO<<GqOOQ[<<Gq<<GqO@iQ`O<<GqO&<oQ`O7+,UO&<tQ`O7+,VO%[QlO7+,UO%[QlO7+,VOOQ[7+)T7+)TO&<yQ`O7+)TO&=OQlO7+)TO&=VQ`O7+)TOOQ[<<Lw<<LwOOQ[<<Ly<<LyOOQ[-E=O-E=OOOQ[1G3x1G3xO&=[Q`O,5>_OOQ[,5>a,5>aO&=aQ`O1G4OO9ZQ`O7+&dO!(yQlO7+&dOOQO7+%]7+%]O&=fQ?MtO1G6XO>wQ`O7+%]OOQ!0Lf<<I_<<I_OOQ!0Lf<<Ix<<IxO>wQ`O<<IxOOQO<<Iq<<IqO$?{Q!0MxO<<IqO%[QlO<<IqOOQO<<Ib<<IbO!BYQ!0LrO<<IbO&=pQ!0LrO<<IqO&={Q!0MxO<= [O&>]Q`O<= ZOOQO7+*]7+*]O9ZQ`O7+*]OOQ[ANAjANAjO&>eQ!fOANAjO!&iQMhOANAjO#'cQ`OANAjO4UQ!fOANAjO&>lQ`OANAjO%[QlOANAjO&>tQ!0MzO7+'yO&AVQ!0MzO,5?_O&CbQ!0MzO,5?aO&EmQ!0MzO7+'{O&HOQ!fO1G4jO&HYQ?MtO7+&_O&J^Q?MvO,5=WO&LeQ?MvO,5=YO&LuQ?MvO,5=WO&MVQ?MvO,5=YO&MgQ?MvO,59sO' mQ?MvO,5<jO'#pQ?MvO,5<lO'&UQ?MvO,5<zO''zQ?MtO7+'jO'(XQ?MtO7+'lO'(fQ`O,5<[OOQO7+'_7+'_OOQ!0Lh7+*b7+*bO'(kQMjO<<K|OOQO1G4u1G4uO'(rQ`O1G4uO'(}Q`O1G4uO')]Q`O7++zO')]Q`O7++zO!&iQMhO1G4wO')eQ!dO1G4wO')oQ`O7++{O')wQ`O7+(UO'*SQ!dO7+(UOOQ!0Lb7+(S7+(SOOQ!0Lb7+(T7+(TO!BeQpO7+(SOCfQ`O7+(SO'*^Q`O7+(UO!&iQMhO7+(UO$)iQ`O7+(TO'*cQ`O7+(UOCfQ`O7+(TO'*kQMjO<<NuOOQ!0Lh7+${7+${O!+rQMhO<<NuO'*uQ!dO,5?dOOQO-E<v-E<vO'+PQ!0MvO7+(XO!&iQMhO7+(XOOQ[AN=gAN=gO9aQ`O1G5UOOQO1G5U1G5UO'+aQ`O1G5UO'+fQ`O7+,TO'+fQ`O7+,TO9kQ!0LrOANBVO@iQ`OANBVOOQ[ANBVANBVOOQ[ANArANArOOQ[ANAsANAsO'+nQ`O,5?fOOQO-E<x-E<xO'+yQ?MtO1G6fOOQO,5?h,5?hOOQO-E<z-E<zOOQ[1G3`1G3`O',TQ`O,5=OOOQ[<<Le<<LeO!&iQMhO<<LeO&;rQ`O<<LeO',YQ`O<<LeO%[QlO<<LeOOQ[<<Lg<<LgO9kQ!0LrO<<LgO$#yQ`O<<LgO9UQ`O<<LgO',bQpO1G5TO',mQ`O7+,ROOQ[AN=]AN=]O9kQ!0LrOAN=]OOQ[<= p<= pOOQ[<= q<= qO',uQ`O<= pO',zQ`O<= qOOQ[<<Lo<<LoO'-PQ`O<<LoO'-UQlO<<LoOOQ[1G3y1G3yO>wQ`O7+)jO'-]Q`O<<JOO'-hQ?MtO<<JOOOQO<<Hw<<HwOOQ!0LfAN?dAN?dOOQOAN?]AN?]O$?{Q!0MxOAN?]OOQOAN>|AN>|O%[QlOAN?]OOQO<<Mw<<MwOOQ[G27UG27UO!&iQMhOG27UO#'cQ`OG27UO'-rQ!fOG27UO4UQ!fOG27UO'-yQ`OG27UO'.RQ?MtO<<JeO'.`Q?MvO1G2_O'0UQ?MvO,5?_O'2XQ?MvO,5?aO'4[Q?MvO1G2rO'6_Q?MvO1G2tO'8bQ?MtO<<KWO'8oQ?MtO<<IyOOQO1G1v1G1vO!+rQMhOANAhOOQO7+*a7+*aO'8|Q`O7+*aO'9XQ`O<= fO'9aQ!dO7+*cOOQ!0Lb<<Kp<<KpO$)iQ`O<<KpOCfQ`O<<KpO'9kQ`O<<KpO!&iQMhO<<KpOOQ!0Lb<<Kn<<KnO!BeQpO<<KnO'9vQ!dO<<KpOOQ!0Lb<<Ko<<KoO':QQ`O<<KpO!&iQMhO<<KpO$)iQ`O<<KoO':VQMjOANDaO':aQ!0MvO<<KsOOQO7+*p7+*pO9aQ`O7+*pO':qQ`O<= oOOQ[G27qG27qO9kQ!0LrOG27qO!(yQlO1G5QO':yQ`O7+,QO';RQ`O1G2jO&;rQ`OANBPOOQ[ANBPANBPO!&iQMhOANBPO';WQ`OANBPOOQ[ANBRANBRO9kQ!0LrOANBRO$#yQ`OANBROOQO'#H^'#H^OOQO7+*o7+*oOOQ[G22wG22wOOQ[ANE[ANE[OOQ[ANE]ANE]OOQ[ANBZANBZO';`Q`OANBZOOQ[<<MU<<MUO!(yQlOAN?jOOQOG24wG24wO$?{Q!0MxOG24wO#'cQ`OLD,pOOQ[LD,pLD,pO!&iQMhOLD,pO';eQ!fOLD,pO';lQ?MvO7+'yO'=bQ?MvO,5?_O'?eQ?MvO,5?aO'AhQ?MvO7+'{O'C^QMjOG27SOOQO<<M{<<M{OOQ!0LbANA[ANA[O$)iQ`OANA[OCfQ`OANA[O'CnQ!dOANA[OOQ!0LbANAYANAYO'CuQ`OANA[O!&iQMhOANA[O'DQQ!dOANA[OOQ!0LbANAZANAZOOQO<<N[<<N[OOQ[LD-]LD-]O'D[Q?MtO7+*lOOQO'#Ge'#GeOOQ[G27kG27kO&;rQ`OG27kO!&iQMhOG27kOOQ[G27mG27mO9kQ!0LrOG27mOOQ[G27uG27uO'DfQ?MtOG25UOOQOLD*cLD*cOOQ[!$(![!$(![O#'cQ`O!$(![O!&iQMhO!$(![O'DpQ!0MzOG27SOOQ!0LbG26vG26vO$)iQ`OG26vO'GRQ`OG26vOCfQ`OG26vO'G^Q!dOG26vO!&iQMhOG26vOOQ[LD-VLD-VO&;rQ`OLD-VOOQ[LD-XLD-XOOQ[!)9Ev!)9EvO#'cQ`O!)9EvOOQ!0LbLD,bLD,bO$)iQ`OLD,bOCfQ`OLD,bO'GeQ`OLD,bO'GpQ!dOLD,bOOQ[!$(!q!$(!qOOQ[!.K;b!.K;bO'GwQ?MvOG27SOOQ!0Lb!$( |!$( |O$)iQ`O!$( |OCfQ`O!$( |O'ImQ`O!$( |OOQ!0Lb!)9Eh!)9EhO$)iQ`O!)9EhOCfQ`O!)9EhOOQ!0Lb!.K;S!.K;SO$)iQ`O!.K;SOOQ!0Lb!4/0n!4/0nO!(yQlO'#DxO1PQ`O'#EVO'IxQ!fO'#JpO'JPQ!L^O'#DtO'JWQlO'#D|O'J_Q!fO'#CiO'LuQ!fO'#CiO!(yQlO'#EOO'MVQlO,5;XO!(yQlO,5;cO!(yQlO,5;cO!(yQlO,5;cO!(yQlO,5;cO!(yQlO,5;cO!(yQlO,5;cO!(yQlO,5;cO!(yQlO,5;cO!(yQlO,5;cO!(yQlO,5;cO!(yQlO'#InO( YQ`O,5<hO!(yQlO,5;cO( bQMhO,5;cO(!{QMhO,5;cO!(yQlO,5;vO!&iQMhO'#GlO( bQMhO'#GlO!&iQMhO'#GnO( bQMhO'#GnO1SQ`O'#DXO1SQ`O'#DXO!&iQMhO'#GOO( bQMhO'#GOO!&iQMhO'#GQO( bQMhO'#GQO!&iQMhO'#G`O( bQMhO'#G`O!(yQlO,5:hO(#SQpO'#D]O(#^QpO'#JtO!(yQlO,5@mO'MVQlO1G0sO(#hQ?MtO'#CiO!(yQlO1G2OO!&iQMhO'#IsO( bQMhO'#IsO!&iQMhO'#IuO( bQMhO'#IuO(#rQ!dO'#CrO!&iQMhO,5<sO( bQMhO,5<sO'MVQlO1G2QO!(yQlO7+&yO!&iQMhO1G2_O( bQMhO1G2_O!&iQMhO'#IsO( bQMhO'#IsO!&iQMhO'#IuO( bQMhO'#IuO!&iQMhO1G2aO( bQMhO1G2aO'MVQlO7+'lO'MVQlO7+&_O!&iQMhOANAhO( bQMhOANAhO($VQ`O'#EmO($[Q`O'#EmO($dQ`O'#F[O($iQ`O'#EwO($nQ`O'#KRO($yQ`O'#KPO(%UQ`O,5;XO(%ZQMjO,5<dO(%bQ`O'#GXO(%gQ`O'#GXO(%lQ`O,5<fO(%tQ`O,5;XO(%|Q?MtO1G1_O(&TQ`O,5<sO(&YQ`O,5<sO(&_Q`O,5<uO(&dQ`O,5<uO(&iQ`O1G2QO(&nQ`O1G0sO(&sQMjO<<K|O(&zQMjO<<K|O7eQMhO'#F{O9UQ`O'#FzOAdQ`O'#ElO!(yQlO,5;sO!3^Q`O'#GXO!3^Q`O'#GXO!3^Q`O'#GZO!3^Q`O'#GZO!+rQMhO7+(bO!+rQMhO7+(bO%-ZQ!dO1G2vO%-ZQ!dO1G2vO!&iQMhO,5=[O!&iQMhO,5=[",stateData:"((P~O'zOS'{OSTOS'|RQ~OPYOQYOSfOY!VOaqOdzOeyOj!POnkOpYOqkOrkOxkOzYO|YO!QWO!UkO!VkO!]XO!guO!jZO!mYO!nYO!oYO!qvO!swO!vxO!z]O$V|O$miO%g}O%i!QO%k!OO%l!OO%m!OO%p!RO%r!SO%u!TO%v!TO%x!UO&U!WO&[!XO&^!YO&`!ZO&b![O&e!]O&k!^O&q!_O&s!`O&u!aO&w!bO&y!cO(RSO(TTO(WUO(_VO(m[O~OWtO~P`OPYOQYOSfOd!jOe!iOnkOpYOqkOrkOxkOzYO|YO!QWO!UkO!VkO!]!eO!guO!jZO!mYO!nYO!oYO!qvO!s!gO!v!hO$V!kO$miO(R!dO(TTO(WUO(_VO(m[O~Oa!wOq!nO!Q!oO!`!yO!a!vO!b!vO!z;wO#R!pO#S!pO#T!xO#U!pO#V!pO#Y!zO#Z!zO(S!lO(TTO(WUO(c!mO(m!sO~O'|!{O~OP]XR]X[]Xa]Xp]X!O]X!Q]X!Z]X!j]X!n]X#P]X#Q]X#^]X#ifX#l]X#m]X#n]X#o]X#p]X#q]X#r]X#s]X#t]X#u]X#w]X#y]X#z]X$P]X'x]X(_]X(p]X(w]X(x]X~O!e%QX~P(qO_!}O(T#PO(U!}O(V#PO~O_#QO(V#PO(W#PO(X#QO~Ov#SO!S#TO(`#TO(a#VO~OPYOQYOSfOd!jOe!iOnkOpYOqkOrkOxkOzYO|YO!QWO!UkO!VkO!]!eO!guO!jZO!mYO!nYO!oYO!qvO!s!gO!v!hO$V!kO$miO(R;{O(TTO(WUO(_VO(m[O~O!Y#ZO!Z#WO!W(fP!W(tP~P+}O![#cO~P`OPYOQYOSfOd!jOe!iOpYOqkOrkOxkOzYO|YO!QWO!UkO!VkO!]!eO!guO!jZO!mYO!nYO!oYO!qvO!s!gO!v!hO$V!kO$miO(TTO(WUO(_VO(m[O~On#mO!Y#iO!z]O#g#lO#h#iO(R;|O!i(qP~P.iO!j#oO(R#nO~O!v#sO!z]O%g#tO~O#i#uO~O!e#vO#i#uO~OP$[OR#zO[$cOp$aO!O#yO!Q#{O!Z$_O!j#xO!n$[O#P$RO#l$OO#m$PO#n$PO#o$PO#p$QO#q$RO#r$RO#s$bO#t$RO#u$SO#w$UO#y$WO#z$XO(_VO(p$YO(w#|O(x#}O~Oa(dX'x(dX'u(dX!i(dX!W(dX!](dX%h(dX!e(dX~P1qO#Q$dO#^$eO$P$eOP(eXR(eX[(eXp(eX!O(eX!Q(eX!Z(eX!j(eX!n(eX#P(eX#l(eX#m(eX#n(eX#o(eX#p(eX#q(eX#r(eX#s(eX#t(eX#u(eX#w(eX#y(eX#z(eX(_(eX(p(eX(w(eX(x(eX!](eX%h(eX~Oa(eX'x(eX'u(eX!W(eX!i(eXt(eX!e(eX~P4UO#^$eO~O$[$hO$^$gO$e$mO~OSfO!]$nO$h$oO$j$qO~Oh%VOj%cOn%WOp%XOq$tOr$tOx%YOz%ZO|%[O!Q${O!]$|O!g%aO!j$xO#h%bO$V%_O$s%]O$u%^O$x%`O(R$sO(TTO(WUO(_$uO(w$}O(x%POg([P~O!j%dO~O!Q%gO!]%hO(R%fO~O!e%lO~Oa%mO'x%mO~O!O%qO~P%[O(S!lO~P%[O%m%uO~P%[Oh%VO!j%dO(R%fO(S!lO~Oe%|O!j%dO(R%fO~O#t$RO~O!O&RO!]&OO!j&QO%i&UO(R%fO(S!lO(TTO(WUO`)UP~O!v#sO~O%r&WO!Q)QX!])QX(R)QX~O(R&XO~Oj!PO!s&^O%i!QO%k!OO%l!OO%m!OO%p!RO%r!SO%u!TO%v!TO~Od&cOe&bO!v&`O%g&aO%z&_O~P<POd&fOeyOj!PO!]&eO!s&^O!vxO!z]O%g}O%k!OO%l!OO%m!OO%p!RO%r!SO%u!TO%v!TO%x!UO~Ob&iO#^&lO%i&gO(S!lO~P=UO!j&mO!s&qO~O!j#oO~O!]XO~Oa%mO'v&yO'x%mO~Oa%mO'v&|O'x%mO~Oa%mO'v'OO'x%mO~O'u]X!W]Xt]X!i]X&Y]X!]]X%h]X!e]X~P(qO!`']O!a'UO!b'UO(S!lO(TTO(WUO~Oq'SO!Q'RO!Y'VO(c'QO![(gP![(vP~P@]Ol'`O!]'^O(R%fO~Oe'eO!j%dO(R%fO~O!O&RO!j&QO~Oq!nO!Q!oO!z;wO#R!pO#S!pO#U!pO#V!pO(S!lO(TTO(WUO(c!mO(m!sO~O!`'kO!a'jO!b'jO#T!pO#Y'lO#Z'lO~PAwOa%mOh%VO!e#vO!j%dO'x%mO(p'nO~O!n'rO#^'pO~PCVOq!nO!Q!oO(TTO(WUO(c!mO(m!sO~O!]XOq(kX!Q(kX!`(kX!a(kX!b(kX!z(kX#R(kX#S(kX#T(kX#U(kX#V(kX#Y(kX#Z(kX(S(kX(T(kX(W(kX(c(kX(m(kX~O!a'jO!b'jO(S!lO~PCuO'}'vO(O'vO(P'xO~O_!}O(T'zO(U!}O(V'zO~O_#QO(V'zO(W'zO(X#QO~Ot'|O~P%[Ov#SO!S#TO(`#TO(a(PO~O!Y(RO!W'UX!W'[X!Z'UX!Z'[X~P+}O!Z(TO!W(fX~OP$[OR#zO[$cOp$aO!O#yO!Q#{O!Z(TO!j#xO!n$[O#P$RO#l$OO#m$PO#n$PO#o$PO#p$QO#q$RO#r$RO#s$bO#t$RO#u$SO#w$UO#y$WO#z$XO(_VO(p$YO(w#|O(x#}O~O!W(fX~PGpO!W(YO~O!W(sX!Z(sX!e(sX!i(sX(p(sX~O#^(sX#i#bX![(sX~PIsO#^(ZO!W(uX!Z(uX~O!Z([O!W(tX~O!W(_O~O#^$eO~PIsO![(`O~P`OR#zO!O#yO!Q#{O!j#xO(_VOP!la[!lap!la!Z!la!n!la#P!la#l!la#m!la#n!la#o!la#p!la#q!la#r!la#s!la#t!la#u!la#w!la#y!la#z!la(p!la(w!la(x!la~Oa!la'x!la'u!la!W!la!i!lat!la!]!la%h!la!e!la~PKZO!i(aO~O!e#vO#^(bO(p'nO!Z(rXa(rX'x(rX~O!i(rX~PMvO!Q%gO!]%hO!z]O#g(gO#h(fO(R%fO~O!Z(hO!i(qX~O!i(jO~O!Q%gO!]%hO#h(fO(R%fO~OP(eXR(eX[(eXp(eX!O(eX!Q(eX!Z(eX!j(eX!n(eX#P(eX#l(eX#m(eX#n(eX#o(eX#p(eX#q(eX#r(eX#s(eX#t(eX#u(eX#w(eX#y(eX#z(eX(_(eX(p(eX(w(eX(x(eX~O!e#vO!i(eX~P! dOR(lO!O(kO!j#xO#Q$dO!z!ya!Q!ya~O!v!ya%g!ya!]!ya#g!ya#h!ya(R!ya~P!#eO!v(pO~OPYOQYOSfOd!jOe!iOnkOpYOqkOrkOxkOzYO|YO!QWO!UkO!VkO!]XO!guO!jZO!mYO!nYO!oYO!qvO!s!gO!v!hO$V!kO$miO(R!dO(TTO(WUO(_VO(m[O~Oh%VOn%WOp%XOq$tOr$tOx%YOz%ZO|<eO!Q${O!]$|O!g=vO!j$xO#h<kO$V%_O$s<gO$u<iO$x%`O(R(tO(TTO(WUO(_$uO(w$}O(x%PO~O#i(vO~O!Y(xO!i(iP~P%[O(c(zO(m[O~O!Q(|O!j#xO(c(zO(m[O~OP;vOQ;vOSfOd=rOe!iOnkOp;vOqkOrkOxkOz;vO|;vO!QWO!UkO!VkO!]!eO!g;yO!jZO!m;vO!n;vO!o;vO!q;zO!s;}O!v!hO$V!kO$m=pO(R)ZO(TTO(WUO(_VO(m[O~O!Z$_Oa$pa'x$pa'u$pa!i$pa!W$pa!]$pa%h$pa!e$pa~Oj)bO~P!&iOh%VOn%WOp%XOq$tOr$tOx%YOz%ZO|%[O!Q${O!]$|O!g%aO!j$xO#h%bO$V%_O$s%]O$u%^O$x%`O(R(tO(TTO(WUO(_$uO(w$}O(x%PO~Og(nP~P!+rO!O)gO!e)fO!]$]X$Y$]X$[$]X$^$]X$e$]X~O!e)fO!](yX$Y(yX$[(yX$^(yX$e(yX~O!O)gO~P!-{O!O)gO!](yX$Y(yX$[(yX$^(yX$e(yX~O!])iO$Y)mO$[)hO$^)hO$e)nO~O!Y)qO~P!(yO$[$hO$^$gO$e)uO~Ol$yX!O$yX#Q$yX'w$yX(w$yX(x$yX~OgkXg$yXlkX!ZkX#^kX~P!/qOv)wO(`)xO(a)zO~Ol*TO!O)|O'w)}O(w$}O(x%PO~Og){O~P!0uOg*UO~Oh%VOn%WOp%XOq$tOr$tOx%YOz%ZO|<eO!Q*WO!]*XO!g=vO!j$xO#h<kO$V%_O$s<gO$u<iO$x%`O(TTO(WUO(_$uO(w$}O(x%PO~O!Y*[O(R*VO!i(|P~P!1dO#i*^O~O!j*_O~Oh%VOn%WOp%XOq$tOr$tOx%YOz%ZO|<eO!Q${O!]$|O!g=vO!j$xO#h<kO$V%_O$s<gO$u<iO$x%`O(R*aO(TTO(WUO(_$uO(w$}O(x%PO~O!Y*dO!W(}P~P!3cOp*pOq!nO!Q*fO!`*nO!a*hO!b*hO!j*_O#Y*oO%_*jO(S!lO(TTO(WUO(c!mO~O![*mO~P!5WO#Q$dOl(^X!O(^X'w(^X(w(^X(x(^X!Z(^X#^(^X~Og(^X#}(^X~P!6YOl*uO#^*tOg(]X!Z(]X~O!Z*vOg([X~Oj%cO(R&XOg([P~Oq*yO~O!j+OO~O(R(tO~On+TO!Q%gO!Y#iO!]%hO!z]O#g#lO#h#iO(R%fO!i(qP~O!e#vO#i+UO~O!Q%gO!Y+WO!Z([O!]%hO(R%fO!W(tP~Oq'YO!Q+YO!Y+XO(TTO(WUO(c(zO~O![(vP~P!9]O!Z+ZOa)RX'x)RX~OP$[OR#zO[$cOp$aO!O#yO!Q#{O!j#xO!n$[O#P$RO#l$OO#m$PO#n$PO#o$PO#p$QO#q$RO#r$RO#s$bO#t$RO#u$SO#w$UO#y$WO#z$XO(_VO(p$YO(w#|O(x#}O~Oa!ha!Z!ha'x!ha'u!ha!W!ha!i!hat!ha!]!ha%h!ha!e!ha~P!:TOR#zO!O#yO!Q#{O!j#xO(_VOP!pa[!pap!pa!Z!pa!n!pa#P!pa#l!pa#m!pa#n!pa#o!pa#p!pa#q!pa#r!pa#s!pa#t!pa#u!pa#w!pa#y!pa#z!pa(p!pa(w!pa(x!pa~Oa!pa'x!pa'u!pa!W!pa!i!pat!pa!]!pa%h!pa!e!pa~P!<kOR#zO!O#yO!Q#{O!j#xO(_VOP!ra[!rap!ra!Z!ra!n!ra#P!ra#l!ra#m!ra#n!ra#o!ra#p!ra#q!ra#r!ra#s!ra#t!ra#u!ra#w!ra#y!ra#z!ra(p!ra(w!ra(x!ra~Oa!ra'x!ra'u!ra!W!ra!i!rat!ra!]!ra%h!ra!e!ra~P!?ROh%VOl+dO!]'^O%h+cO~O!e+fOa(ZX!](ZX'x(ZX!Z(ZX~Oa%mO!]XO'x%mO~Oh%VO!j%dO~Oh%VO!j%dO(R%fO~O!e#vO#i(vO~Ob+qO%i+rO(R+nO(TTO(WUO![)VP~O!Z+sO`)UX~O[+wO~O`+xO~O!]&OO(R%fO(S!lO`)UP~Oh%VO#^+}O~Oh%VOl,QO!]$|O~O!],SO~O!O,UO!]XO~O%m%uO~O!v,ZO~Oe,`O~Ob,aO(R#nO(TTO(WUO![)TP~Oe%|O~O%i!QO(R&XO~P=UO[,fO`,eO~OPYOQYOSfOdzOeyOnkOpYOqkOrkOxkOzYO|YO!QWO!UkO!VkO!guO!jZO!mYO!nYO!oYO!qvO!vxO!z]O$miO%g}O(TTO(WUO(_VO(m[O~O!]!eO!s!gO$V!kO(R!dO~P!FRO`,eOa%mO'x%mO~OPYOQYOSfOd!jOe!iOnkOpYOqkOrkOxkOzYO|YO!QWO!UkO!VkO!]!eO!guO!jZO!mYO!nYO!oYO!qvO!v!hO$V!kO$miO(R!dO(TTO(WUO(_VO(m[O~Oa,kOj!OO!swO%k!OO%l!OO%m!OO~P!HkO!j&mO~O&[,qO~O!],sO~O&m,uO&o,vOP&jaQ&jaS&jaY&jaa&jad&jae&jaj&jan&jap&jaq&jar&jax&jaz&ja|&ja!Q&ja!U&ja!V&ja!]&ja!g&ja!j&ja!m&ja!n&ja!o&ja!q&ja!s&ja!v&ja!z&ja$V&ja$m&ja%g&ja%i&ja%k&ja%l&ja%m&ja%p&ja%r&ja%u&ja%v&ja%x&ja&U&ja&[&ja&^&ja&`&ja&b&ja&e&ja&k&ja&q&ja&s&ja&u&ja&w&ja&y&ja'u&ja(R&ja(T&ja(W&ja(_&ja(m&ja![&ja&c&jab&ja&h&ja~O(R,{O~Oh!cX!Z!PX![!PX!e!PX!e!cX!j!cX#^!PX~O!Z!cX![!cX~P# qO!e-QO#^-POh(hX!Z#fX![#fX!e(hX!j(hX~O!Z(hX![(hX~P#!dOh%VO!e-SO!j%dO!Z!_X![!_X~Oq!nO!Q!oO(TTO(WUO(c!mO~OP;vOQ;vOSfOd=rOe!iOnkOp;vOqkOrkOxkOz;vO|;vO!QWO!UkO!VkO!]!eO!g;yO!jZO!m;vO!n;vO!o;vO!q;zO!s;}O!v!hO$V!kO$m=pO(TTO(WUO(_VO(m[O~O(R<rO~P##yO!Z-WO![(gX~O![-YO~O!e-QO#^-PO!Z#fX![#fX~O!Z-ZO![(vX~O![-]O~O!a-^O!b-^O(S!lO~P##hO![-aO~P'_Ol-dO!]'^O~O!W-iO~Oq!ya!`!ya!a!ya!b!ya#R!ya#S!ya#T!ya#U!ya#V!ya#Y!ya#Z!ya(S!ya(T!ya(W!ya(c!ya(m!ya~P!#eO!n-nO#^-lO~PCVO!a-pO!b-pO(S!lO~PCuOa%mO#^-lO'x%mO~Oa%mO!e#vO#^-lO'x%mO~Oa%mO!e#vO!n-nO#^-lO'x%mO(p'nO~O'}'vO(O'vO(P-uO~Ot-vO~O!W'Ua!Z'Ua~P!:TO!Y-zO!W'UX!Z'UX~P%[O!Z(TO!W(fa~O!W(fa~PGpO!Z([O!W(ta~O!Q%gO!Y.OO!]%hO(R%fO!W'[X!Z'[X~O#^.QO!Z(ra!i(raa(ra'x(ra~O!e#vO~P#,PO!Z(hO!i(qa~O!Q%gO!]%hO#h.UO(R%fO~On.ZO!Q%gO!Y.WO!]%hO!z]O#g.YO#h.WO(R%fO!Z'_X!i'_X~OR._O!j#xO~Oh%VOl.bO!]'^O%h.aO~Oa#ai!Z#ai'x#ai'u#ai!W#ai!i#ait#ai!]#ai%h#ai!e#ai~P!:TOl=|O!O)|O'w)}O(w$}O(x%PO~O#i#]aa#]a#^#]a'x#]a!Z#]a!i#]a!]#]a!W#]a~P#.{O#i(^XP(^XR(^X[(^Xa(^Xp(^X!Q(^X!j(^X!n(^X#P(^X#l(^X#m(^X#n(^X#o(^X#p(^X#q(^X#r(^X#s(^X#t(^X#u(^X#w(^X#y(^X#z(^X'x(^X(_(^X(p(^X!i(^X!W(^X'u(^Xt(^X!](^X%h(^X!e(^X~P!6YO!Z.oO!i(iX~P!:TO!i.rO~O!W.tO~OP$[OR#zO!O#yO!Q#{O!j#xO!n$[O(_VO[#kia#kip#ki!Z#ki#P#ki#m#ki#n#ki#o#ki#p#ki#q#ki#r#ki#s#ki#t#ki#u#ki#w#ki#y#ki#z#ki'x#ki(p#ki(w#ki(x#ki'u#ki!W#ki!i#kit#ki!]#ki%h#ki!e#ki~O#l#ki~P#2kO#l$OO~P#2kOP$[OR#zOp$aO!O#yO!Q#{O!j#xO!n$[O#l$OO#m$PO#n$PO#o$PO(_VO[#kia#ki!Z#ki#P#ki#q#ki#r#ki#s#ki#t#ki#u#ki#w#ki#y#ki#z#ki'x#ki(p#ki(w#ki(x#ki'u#ki!W#ki!i#kit#ki!]#ki%h#ki!e#ki~O#p#ki~P#5YO#p$QO~P#5YOP$[OR#zO[$cOp$aO!O#yO!Q#{O!j#xO!n$[O#P$RO#l$OO#m$PO#n$PO#o$PO#p$QO#q$RO#r$RO#s$bO#t$RO(_VOa#ki!Z#ki#w#ki#y#ki#z#ki'x#ki(p#ki(w#ki(x#ki'u#ki!W#ki!i#kit#ki!]#ki%h#ki!e#ki~O#u#ki~P#7wOP$[OR#zO[$cOp$aO!O#yO!Q#{O!j#xO!n$[O#P$RO#l$OO#m$PO#n$PO#o$PO#p$QO#q$RO#r$RO#s$bO#t$RO#u$SO(_VO(x#}Oa#ki!Z#ki#y#ki#z#ki'x#ki(p#ki(w#ki'u#ki!W#ki!i#kit#ki!]#ki%h#ki!e#ki~O#w$UO~P#:_O#w#ki~P#:_O#u$SO~P#7wOP$[OR#zO[$cOp$aO!O#yO!Q#{O!j#xO!n$[O#P$RO#l$OO#m$PO#n$PO#o$PO#p$QO#q$RO#r$RO#s$bO#t$RO#u$SO#w$UO(_VO(w#|O(x#}Oa#ki!Z#ki#z#ki'x#ki(p#ki'u#ki!W#ki!i#kit#ki!]#ki%h#ki!e#ki~O#y#ki~P#=TO#y$WO~P#=TOP]XR]X[]Xp]X!O]X!Q]X!j]X!n]X#P]X#Q]X#^]X#ifX#l]X#m]X#n]X#o]X#p]X#q]X#r]X#s]X#t]X#u]X#w]X#y]X#z]X$P]X(_]X(p]X(w]X(x]X!Z]X![]X~O#}]X~P#?rOP$[OR#zO[<_Op<]O!O#yO!Q#{O!j#xO!n$[O#P<SO#l<PO#m<QO#n<QO#o<QO#p<RO#q<SO#r<SO#s<^O#t<SO#u<TO#w<VO#y<XO#z<YO(_VO(p$YO(w#|O(x#}O~O#}.vO~P#BPO#Q$dO#^<`O$P<`O#}(eX![(eX~P! dOa'ba!Z'ba'x'ba'u'ba!i'ba!W'bat'ba!]'ba%h'ba!e'ba~P!:TO[#kia#kip#ki!Z#ki#P#ki#p#ki#q#ki#r#ki#s#ki#t#ki#u#ki#w#ki#y#ki#z#ki'x#ki(p#ki'u#ki!W#ki!i#kit#ki!]#ki%h#ki!e#ki~OP$[OR#zO!O#yO!Q#{O!j#xO!n$[O#l$OO#m$PO#n$PO#o$PO(_VO(w#ki(x#ki~P#EROl=|O!O)|O'w)}O(w$}O(x%POP#kiR#ki!Q#ki!j#ki!n#ki#l#ki#m#ki#n#ki#o#ki(_#ki~P#ERO!Z.zOg(nX~P!0uOg.|O~Oa$Oi!Z$Oi'x$Oi'u$Oi!W$Oi!i$Oit$Oi!]$Oi%h$Oi!e$Oi~P!:TO$[.}O$^.}O~O$[/OO$^/OO~O!e)fO#^/PO!]$bX$Y$bX$[$bX$^$bX$e$bX~O!Y/QO~O!])iO$Y/SO$[)hO$^)hO$e/TO~O!Z<ZO![(dX~P#BPO![/UO~O!e)fO$e(yX~O$e/WO~Ot/XO~P!&iOv)wO(`)xO(a/[O~O!Q/_O~O(w$}Ol%`a!O%`a'w%`a(x%`a!Z%`a#^%`a~Og%`a#}%`a~P#LTO(x%POl%ba!O%ba'w%ba(w%ba!Z%ba#^%ba~Og%ba#}%ba~P#LvO!ZfX!efX!ifX!i$yX(pfX~P!/qO!Y/hO!Z([O(R/gO!W(tP!W(}P~P!1dOp*pO!`*nO!a*hO!b*hO!j*_O#Y*oO%_*jO(S!lO(TTO(WUO~Oq<oO!Q/iO!Y+XO![*mO(c<nO![(vP~P#NaO!i/jO~P#.{O!Z/kO!e#vO(p'nO!i(|X~O!i/pO~O!Q%gO!Y*[O!]%hO(R%fO!i(|P~O#i/rO~O!W$yX!Z$yX!e%QX~P!/qO!Z/sO!W(}X~P#.{O!e/uO~O!W/wO~OnkO(R/xO~P.iOh%VOp/}O!e#vO!j%dO(p'nO~O!e+fO~Oa%mO!Z0RO'x%mO~O![0TO~P!5WO!a0UO!b0UO(S!lO~P##hOq!nO!Q0VO(TTO(WUO(c!mO~O#Y0XO~Og%`a!Z%`a#^%`a#}%`a~P!0uOg%ba!Z%ba#^%ba#}%ba~P!0uOj%cO(R&XOg'kX!Z'kX~O!Z*vOg([a~Og0bO~OR0cO!O0cO!Q0dO#Q$dOl{a'w{a(w{a(x{a!Z{a#^{a~Og{a#}{a~P$&dO!O)|O'w)}Ol$ra(w$ra(x$ra!Z$ra#^$ra~Og$ra#}$ra~P$'`O!O)|O'w)}Ol$ta(w$ta(x$ta!Z$ta#^$ta~Og$ta#}$ta~P$(RO#i0gO~Og%Sa!Z%Sa#^%Sa#}%Sa~P!0uOl0iO#^0hOg(]a!Z(]a~O!e#vO~O#i0lO~O!Z+ZOa)Ra'x)Ra~OR#zO!O#yO!Q#{O!j#xO(_VOP!pi[!pip!pi!Z!pi!n!pi#P!pi#l!pi#m!pi#n!pi#o!pi#p!pi#q!pi#r!pi#s!pi#t!pi#u!pi#w!pi#y!pi#z!pi(p!pi(w!pi(x!pi~Oa!pi'x!pi'u!pi!W!pi!i!pit!pi!]!pi%h!pi!e!pi~P$*OOh%VOp%XOq$tOr$tOx%YOz%ZO|<eO!Q${O!]$|O!g=vO!j$xO#h<kO$V%_O$s<gO$u<iO$x%`O(TTO(WUO(_$uO(w$}O(x%PO~On0vO%[0wO(R0tO~P$,fO!e+fOa(Za!](Za'x(Za!Z(Za~O#i0|O~O[]X!ZfX![fX~O!Z0}O![)VX~O![1PO~O[1QO~Ob1SO(R+nO(TTO(WUO~O!]&OO(R%fO`'sX!Z'sX~O!Z+sO`)Ua~O!i1VO~P!:TO[1YO~O`1ZO~O#^1^O~Ol1aO!]$|O~O(c(zO![)SP~Oh%VOl1jO!]1gO%h1iO~O[1tO!Z1rO![)TX~O![1uO~O`1wOa%mO'x%mO~O(R#nO(TTO(WUO~O#Q$dO#^$eO$P$eOP(eXR(eX[(eXp(eX!O(eX!Q(eX!Z(eX!j(eX!n(eX#P(eX#l(eX#m(eX#n(eX#o(eX#p(eX#q(eX#r(eX#s(eX#u(eX#w(eX#y(eX#z(eX(_(eX(p(eX(w(eX(x(eX~O#t1zO&Y1{Oa(eX~P$2PO#^$eO#t1zO&Y1{O~Oa1}O~P%[Oa2PO~O&c2SOP&aiQ&aiS&aiY&aia&aid&aie&aij&ain&aip&aiq&air&aix&aiz&ai|&ai!Q&ai!U&ai!V&ai!]&ai!g&ai!j&ai!m&ai!n&ai!o&ai!q&ai!s&ai!v&ai!z&ai$V&ai$m&ai%g&ai%i&ai%k&ai%l&ai%m&ai%p&ai%r&ai%u&ai%v&ai%x&ai&U&ai&[&ai&^&ai&`&ai&b&ai&e&ai&k&ai&q&ai&s&ai&u&ai&w&ai&y&ai'u&ai(R&ai(T&ai(W&ai(_&ai(m&ai![&aib&ai&h&ai~Ob2YO![2WO&h2XO~P`O!]XO!j2[O~O&o,vOP&jiQ&jiS&jiY&jia&jid&jie&jij&jin&jip&jiq&jir&jix&jiz&ji|&ji!Q&ji!U&ji!V&ji!]&ji!g&ji!j&ji!m&ji!n&ji!o&ji!q&ji!s&ji!v&ji!z&ji$V&ji$m&ji%g&ji%i&ji%k&ji%l&ji%m&ji%p&ji%r&ji%u&ji%v&ji%x&ji&U&ji&[&ji&^&ji&`&ji&b&ji&e&ji&k&ji&q&ji&s&ji&u&ji&w&ji&y&ji'u&ji(R&ji(T&ji(W&ji(_&ji(m&ji![&ji&c&jib&ji&h&ji~O!W2bO~O!Z!_a![!_a~P#BPOq!nO!Q!oO!Y2hO(c!mO!Z'VX!['VX~P@]O!Z-WO![(ga~O!Z']X![']X~P!9]O!Z-ZO![(va~O![2oO~P'_Oa%mO#^2xO'x%mO~Oa%mO!e#vO#^2xO'x%mO~Oa%mO!e#vO!n2|O#^2xO'x%mO(p'nO~Oa%mO'x%mO~P!:TO!Z$_Ot$pa~O!W'Ui!Z'Ui~P!:TO!Z(TO!W(fi~O!Z([O!W(ti~O!W(ui!Z(ui~P!:TO!Z(ri!i(ria(ri'x(ri~P!:TO#^3OO!Z(ri!i(ria(ri'x(ri~O!Z(hO!i(qi~O!Q%gO!]%hO!z]O#g3TO#h3SO(R%fO~O!Q%gO!]%hO#h3SO(R%fO~Ol3[O!]'^O%h3ZO~Oh%VOl3[O!]'^O%h3ZO~O#i%`aP%`aR%`a[%`aa%`ap%`a!Q%`a!j%`a!n%`a#P%`a#l%`a#m%`a#n%`a#o%`a#p%`a#q%`a#r%`a#s%`a#t%`a#u%`a#w%`a#y%`a#z%`a'x%`a(_%`a(p%`a!i%`a!W%`a'u%`at%`a!]%`a%h%`a!e%`a~P#LTO#i%baP%baR%ba[%baa%bap%ba!Q%ba!j%ba!n%ba#P%ba#l%ba#m%ba#n%ba#o%ba#p%ba#q%ba#r%ba#s%ba#t%ba#u%ba#w%ba#y%ba#z%ba'x%ba(_%ba(p%ba!i%ba!W%ba'u%bat%ba!]%ba%h%ba!e%ba~P#LvO#i%`aP%`aR%`a[%`aa%`ap%`a!Q%`a!Z%`a!j%`a!n%`a#P%`a#l%`a#m%`a#n%`a#o%`a#p%`a#q%`a#r%`a#s%`a#t%`a#u%`a#w%`a#y%`a#z%`a'x%`a(_%`a(p%`a!i%`a!W%`a'u%`a#^%`at%`a!]%`a%h%`a!e%`a~P#.{O#i%baP%baR%ba[%baa%bap%ba!Q%ba!Z%ba!j%ba!n%ba#P%ba#l%ba#m%ba#n%ba#o%ba#p%ba#q%ba#r%ba#s%ba#t%ba#u%ba#w%ba#y%ba#z%ba'x%ba(_%ba(p%ba!i%ba!W%ba'u%ba#^%bat%ba!]%ba%h%ba!e%ba~P#.{O#i{aP{a[{aa{ap{a!j{a!n{a#P{a#l{a#m{a#n{a#o{a#p{a#q{a#r{a#s{a#t{a#u{a#w{a#y{a#z{a'x{a(_{a(p{a!i{a!W{a'u{at{a!]{a%h{a!e{a~P$&dO#i$raP$raR$ra[$raa$rap$ra!Q$ra!j$ra!n$ra#P$ra#l$ra#m$ra#n$ra#o$ra#p$ra#q$ra#r$ra#s$ra#t$ra#u$ra#w$ra#y$ra#z$ra'x$ra(_$ra(p$ra!i$ra!W$ra'u$rat$ra!]$ra%h$ra!e$ra~P$'`O#i$taP$taR$ta[$taa$tap$ta!Q$ta!j$ta!n$ta#P$ta#l$ta#m$ta#n$ta#o$ta#p$ta#q$ta#r$ta#s$ta#t$ta#u$ta#w$ta#y$ta#z$ta'x$ta(_$ta(p$ta!i$ta!W$ta'u$tat$ta!]$ta%h$ta!e$ta~P$(RO#i%SaP%SaR%Sa[%Saa%Sap%Sa!Q%Sa!Z%Sa!j%Sa!n%Sa#P%Sa#l%Sa#m%Sa#n%Sa#o%Sa#p%Sa#q%Sa#r%Sa#s%Sa#t%Sa#u%Sa#w%Sa#y%Sa#z%Sa'x%Sa(_%Sa(p%Sa!i%Sa!W%Sa'u%Sa#^%Sat%Sa!]%Sa%h%Sa!e%Sa~P#.{Oa#aq!Z#aq'x#aq'u#aq!W#aq!i#aqt#aq!]#aq%h#aq!e#aq~P!:TO!Y3dO!Z'WX!i'WX~P%[O!Z.oO!i(ia~O!Z.oO!i(ia~P!:TO!W3gO~O#}!la![!la~PKZO#}!ha!Z!ha![!ha~P#BPO#}!pa![!pa~P!<kO#}!ra![!ra~P!?ROg'ZX!Z'ZX~P!+rO!Z.zOg(na~OSfO!]3{O$c3|O~O![4QO~Ot4RO~P#.{Oa$lq!Z$lq'x$lq'u$lq!W$lq!i$lqt$lq!]$lq%h$lq!e$lq~P!:TO!W4TO~P!&iO!Q4UO~O!O)|O'w)}O(x%POl'ga(w'ga!Z'ga#^'ga~Og'ga#}'ga~P%+uO!O)|O'w)}Ol'ia(w'ia(x'ia!Z'ia#^'ia~Og'ia#}'ia~P%,hO(p$YO~P#.{O!WfX!W$yX!ZfX!Z$yX!e%QX#^fX~P!/qO(R<xO~P!1dO!Q%gO!Y4XO!]%hO(R%fO!Z'cX!i'cX~O!Z/kO!i(|a~O!Z/kO!e#vO!i(|a~O!Z/kO!e#vO(p'nO!i(|a~Og${i!Z${i#^${i#}${i~P!0uO!Y4aO!W'eX!Z'eX~P!3cO!Z/sO!W(}a~O!Z/sO!W(}a~P#.{OP]XR]X[]Xp]X!O]X!Q]X!W]X!Z]X!j]X!n]X#P]X#Q]X#^]X#ifX#l]X#m]X#n]X#o]X#p]X#q]X#r]X#s]X#t]X#u]X#w]X#y]X#z]X$P]X(_]X(p]X(w]X(x]X~O!e%XX#t%XX~P%0XO!e#vO#t4fO~Oh%VO!e#vO!j%dO~Oh%VOp4kO!j%dO(p'nO~Op4pO!e#vO(p'nO~Oq!nO!Q4qO(TTO(WUO(c!mO~O(w$}Ol%`i!O%`i'w%`i(x%`i!Z%`i#^%`i~Og%`i#}%`i~P%3xO(x%POl%bi!O%bi'w%bi(w%bi!Z%bi#^%bi~Og%bi#}%bi~P%4kOg(]i!Z(]i~P!0uO#^4wOg(]i!Z(]i~P!0uO!i4zO~Oa$nq!Z$nq'x$nq'u$nq!W$nq!i$nqt$nq!]$nq%h$nq!e$nq~P!:TO!W5QO~O!Z5RO!])OX~P#.{Oa]Xa$yX!]]X!]$yX%]]X'x]X'x$yX!Z]X!Z$yX~P!/qO%]5UOa%Za!]%Za'x%Za!Z%Za~OlmX!OmX'wmX(wmX(xmX~P%7nOn5VO(R#nO~Ob5]O%i5^O(R+nO(TTO(WUO!Z'rX!['rX~O!Z0}O![)Va~O[5bO~O`5cO~Oa%mO'x%mO~P#.{O!Z5kO#^5mO![)SX~O![5nO~Op5tOq!nO!Q*fO!`!yO!a!vO!b!vO!z;wO#R!pO#S!pO#T!pO#U!pO#V!pO#Y5sO#Z!zO(S!lO(TTO(WUO(c!mO(m!sO~O![5rO~P%:ROl5yO!]1gO%h5xO~Oh%VOl5yO!]1gO%h5xO~Ob6QO(R#nO(TTO(WUO!Z'qX!['qX~O!Z1rO![)Ta~O(TTO(WUO(c6SO~O`6WO~O#t6ZO&Y6[O~PMvO!i6]O~P%[Oa6_O~Oa6_O~P%[Ob2YO![6dO&h2XO~P`O!e6fO~O!e6hOh(hi!Z(hi![(hi!e(hi!j(hip(hi(p(hi~O!Z#fi![#fi~P#BPO#^6iO!Z#fi![#fi~O!Z!_i![!_i~P#BPOa%mO#^6rO'x%mO~Oa%mO!e#vO#^6rO'x%mO~O!Z(rq!i(rqa(rq'x(rq~P!:TO!Z(hO!i(qq~O!Q%gO!]%hO#h6yO(R%fO~O!]'^O%h6|O~Ol7QO!]'^O%h6|O~O#i'gaP'gaR'ga['gaa'gap'ga!Q'ga!j'ga!n'ga#P'ga#l'ga#m'ga#n'ga#o'ga#p'ga#q'ga#r'ga#s'ga#t'ga#u'ga#w'ga#y'ga#z'ga'x'ga(_'ga(p'ga!i'ga!W'ga'u'gat'ga!]'ga%h'ga!e'ga~P%+uO#i'iaP'iaR'ia['iaa'iap'ia!Q'ia!j'ia!n'ia#P'ia#l'ia#m'ia#n'ia#o'ia#p'ia#q'ia#r'ia#s'ia#t'ia#u'ia#w'ia#y'ia#z'ia'x'ia(_'ia(p'ia!i'ia!W'ia'u'iat'ia!]'ia%h'ia!e'ia~P%,hO#i${iP${iR${i[${ia${ip${i!Q${i!Z${i!j${i!n${i#P${i#l${i#m${i#n${i#o${i#p${i#q${i#r${i#s${i#t${i#u${i#w${i#y${i#z${i'x${i(_${i(p${i!i${i!W${i'u${i#^${it${i!]${i%h${i!e${i~P#.{O#i%`iP%`iR%`i[%`ia%`ip%`i!Q%`i!j%`i!n%`i#P%`i#l%`i#m%`i#n%`i#o%`i#p%`i#q%`i#r%`i#s%`i#t%`i#u%`i#w%`i#y%`i#z%`i'x%`i(_%`i(p%`i!i%`i!W%`i'u%`it%`i!]%`i%h%`i!e%`i~P%3xO#i%biP%biR%bi[%bia%bip%bi!Q%bi!j%bi!n%bi#P%bi#l%bi#m%bi#n%bi#o%bi#p%bi#q%bi#r%bi#s%bi#t%bi#u%bi#w%bi#y%bi#z%bi'x%bi(_%bi(p%bi!i%bi!W%bi'u%bit%bi!]%bi%h%bi!e%bi~P%4kO!Z'Wa!i'Wa~P!:TO!Z.oO!i(ii~O#}#ai!Z#ai![#ai~P#BPOP$[OR#zO!O#yO!Q#{O!j#xO!n$[O(_VO[#kip#ki#P#ki#m#ki#n#ki#o#ki#p#ki#q#ki#r#ki#s#ki#t#ki#u#ki#w#ki#y#ki#z#ki#}#ki(p#ki(w#ki(x#ki!Z#ki![#ki~O#l#ki~P%MQO#l<PO~P%MQOP$[OR#zOp<]O!O#yO!Q#{O!j#xO!n$[O#l<PO#m<QO#n<QO#o<QO(_VO[#ki#P#ki#q#ki#r#ki#s#ki#t#ki#u#ki#w#ki#y#ki#z#ki#}#ki(p#ki(w#ki(x#ki!Z#ki![#ki~O#p#ki~P& YO#p<RO~P& YOP$[OR#zO[<_Op<]O!O#yO!Q#{O!j#xO!n$[O#P<SO#l<PO#m<QO#n<QO#o<QO#p<RO#q<SO#r<SO#s<^O#t<SO(_VO#w#ki#y#ki#z#ki#}#ki(p#ki(w#ki(x#ki!Z#ki![#ki~O#u#ki~P&#bOP$[OR#zO[<_Op<]O!O#yO!Q#{O!j#xO!n$[O#P<SO#l<PO#m<QO#n<QO#o<QO#p<RO#q<SO#r<SO#s<^O#t<SO#u<TO(_VO(x#}O#y#ki#z#ki#}#ki(p#ki(w#ki!Z#ki![#ki~O#w<VO~P&%cO#w#ki~P&%cO#u<TO~P&#bOP$[OR#zO[<_Op<]O!O#yO!Q#{O!j#xO!n$[O#P<SO#l<PO#m<QO#n<QO#o<QO#p<RO#q<SO#r<SO#s<^O#t<SO#u<TO#w<VO(_VO(w#|O(x#}O#z#ki#}#ki(p#ki!Z#ki![#ki~O#y#ki~P&'rO#y<XO~P&'rOa#{y!Z#{y'x#{y'u#{y!W#{y!i#{yt#{y!]#{y%h#{y!e#{y~P!:TO[#kip#ki#P#ki#p#ki#q#ki#r#ki#s#ki#t#ki#u#ki#w#ki#y#ki#z#ki#}#ki(p#ki!Z#ki![#ki~OP$[OR#zO!O#yO!Q#{O!j#xO!n$[O#l<PO#m<QO#n<QO#o<QO(_VO(w#ki(x#ki~P&*nOl=}O!O)|O'w)}O(w$}O(x%POP#kiR#ki!Q#ki!j#ki!n#ki#l#ki#m#ki#n#ki#o#ki(_#ki~P&*nO#Q$dOP(^XR(^X[(^Xl(^Xp(^X!O(^X!Q(^X!j(^X!n(^X#P(^X#l(^X#m(^X#n(^X#o(^X#p(^X#q(^X#r(^X#s(^X#t(^X#u(^X#w(^X#y(^X#z(^X#}(^X'w(^X(_(^X(p(^X(w(^X(x(^X!Z(^X![(^X~O#}$Oi!Z$Oi![$Oi~P#BPO#}!pi![!pi~P$*OOg'Za!Z'Za~P!0uO![7dO~O!Z'ba!['ba~P#BPO!W7eO~P#.{O!e#vO(p'nO!Z'ca!i'ca~O!Z/kO!i(|i~O!Z/kO!e#vO!i(|i~Og${q!Z${q#^${q#}${q~P!0uO!W'ea!Z'ea~P#.{O!e7lO~O!Z/sO!W(}i~P#.{O!Z/sO!W(}i~O!W7oO~Oh%VOp7tO!j%dO(p'nO~O!e#vO#t7vO~Op7yO!e#vO(p'nO~O!O)|O'w)}O(x%POl'ha(w'ha!Z'ha#^'ha~Og'ha#}'ha~P&3oO!O)|O'w)}Ol'ja(w'ja(x'ja!Z'ja#^'ja~Og'ja#}'ja~P&4bO!W7{O~Og$}q!Z$}q#^$}q#}$}q~P!0uOg(]q!Z(]q~P!0uO#^7|Og(]q!Z(]q~P!0uOa$ny!Z$ny'x$ny'u$ny!W$ny!i$nyt$ny!]$ny%h$ny!e$ny~P!:TO!e6hO~O!Z5RO!])Oa~O!]'^OP$SaR$Sa[$Sap$Sa!O$Sa!Q$Sa!Z$Sa!j$Sa!n$Sa#P$Sa#l$Sa#m$Sa#n$Sa#o$Sa#p$Sa#q$Sa#r$Sa#s$Sa#t$Sa#u$Sa#w$Sa#y$Sa#z$Sa(_$Sa(p$Sa(w$Sa(x$Sa~O%h6|O~P&7SO%]8QOa%Zi!]%Zi'x%Zi!Z%Zi~Oa#ay!Z#ay'x#ay'u#ay!W#ay!i#ayt#ay!]#ay%h#ay!e#ay~P!:TO[8SO~Ob8UO(R+nO(TTO(WUO~O!Z0}O![)Vi~O`8YO~O(c(zO!Z'nX!['nX~O!Z5kO![)Sa~O![8cO~P%:RO(m!sO~P$$oO#Y8dO~O!]1gO~O!]1gO%h8fO~Ol8iO!]1gO%h8fO~O[8nO!Z'qa!['qa~O!Z1rO![)Ti~O!i8rO~O!i8sO~O!i8vO~O!i8vO~P%[Oa8xO~O!e8yO~O!i8zO~O!Z(ui![(ui~P#BPOa%mO#^9SO'x%mO~O!Z(ry!i(rya(ry'x(ry~P!:TO!Z(hO!i(qy~O%h9VO~P&7SO!]'^O%h9VO~O#i${qP${qR${q[${qa${qp${q!Q${q!Z${q!j${q!n${q#P${q#l${q#m${q#n${q#o${q#p${q#q${q#r${q#s${q#t${q#u${q#w${q#y${q#z${q'x${q(_${q(p${q!i${q!W${q'u${q#^${qt${q!]${q%h${q!e${q~P#.{O#i'haP'haR'ha['haa'hap'ha!Q'ha!j'ha!n'ha#P'ha#l'ha#m'ha#n'ha#o'ha#p'ha#q'ha#r'ha#s'ha#t'ha#u'ha#w'ha#y'ha#z'ha'x'ha(_'ha(p'ha!i'ha!W'ha'u'hat'ha!]'ha%h'ha!e'ha~P&3oO#i'jaP'jaR'ja['jaa'jap'ja!Q'ja!j'ja!n'ja#P'ja#l'ja#m'ja#n'ja#o'ja#p'ja#q'ja#r'ja#s'ja#t'ja#u'ja#w'ja#y'ja#z'ja'x'ja(_'ja(p'ja!i'ja!W'ja'u'jat'ja!]'ja%h'ja!e'ja~P&4bO#i$}qP$}qR$}q[$}qa$}qp$}q!Q$}q!Z$}q!j$}q!n$}q#P$}q#l$}q#m$}q#n$}q#o$}q#p$}q#q$}q#r$}q#s$}q#t$}q#u$}q#w$}q#y$}q#z$}q'x$}q(_$}q(p$}q!i$}q!W$}q'u$}q#^$}qt$}q!]$}q%h$}q!e$}q~P#.{O!Z'Wi!i'Wi~P!:TO#}#aq!Z#aq![#aq~P#BPO(w$}OP%`aR%`a[%`ap%`a!Q%`a!j%`a!n%`a#P%`a#l%`a#m%`a#n%`a#o%`a#p%`a#q%`a#r%`a#s%`a#t%`a#u%`a#w%`a#y%`a#z%`a#}%`a(_%`a(p%`a!Z%`a![%`a~Ol%`a!O%`a'w%`a(x%`a~P&HgO(x%POP%baR%ba[%bap%ba!Q%ba!j%ba!n%ba#P%ba#l%ba#m%ba#n%ba#o%ba#p%ba#q%ba#r%ba#s%ba#t%ba#u%ba#w%ba#y%ba#z%ba#}%ba(_%ba(p%ba!Z%ba![%ba~Ol%ba!O%ba'w%ba(w%ba~P&JnOl=}O!O)|O'w)}O(x%PO~P&HgOl=}O!O)|O'w)}O(w$}O~P&JnOR0cO!O0cO!Q0dO#Q$dOP{a[{al{ap{a!j{a!n{a#P{a#l{a#m{a#n{a#o{a#p{a#q{a#r{a#s{a#t{a#u{a#w{a#y{a#z{a#}{a'w{a(_{a(p{a(w{a(x{a!Z{a![{a~O!O)|O'w)}OP$raR$ra[$ral$rap$ra!Q$ra!j$ra!n$ra#P$ra#l$ra#m$ra#n$ra#o$ra#p$ra#q$ra#r$ra#s$ra#t$ra#u$ra#w$ra#y$ra#z$ra#}$ra(_$ra(p$ra(w$ra(x$ra!Z$ra![$ra~O!O)|O'w)}OP$taR$ta[$tal$tap$ta!Q$ta!j$ta!n$ta#P$ta#l$ta#m$ta#n$ta#o$ta#p$ta#q$ta#r$ta#s$ta#t$ta#u$ta#w$ta#y$ta#z$ta#}$ta(_$ta(p$ta(w$ta(x$ta!Z$ta![$ta~Ol=}O!O)|O'w)}O(w$}O(x%PO~OP%SaR%Sa[%Sap%Sa!Q%Sa!j%Sa!n%Sa#P%Sa#l%Sa#m%Sa#n%Sa#o%Sa#p%Sa#q%Sa#r%Sa#s%Sa#t%Sa#u%Sa#w%Sa#y%Sa#z%Sa#}%Sa(_%Sa(p%Sa!Z%Sa![%Sa~P'%sO#}$lq!Z$lq![$lq~P#BPO#}$nq!Z$nq![$nq~P#BPO![9dO~O#}9eO~P!0uO!e#vO!Z'ci!i'ci~O!e#vO(p'nO!Z'ci!i'ci~O!Z/kO!i(|q~O!W'ei!Z'ei~P#.{O!Z/sO!W(}q~Op9lO!e#vO(p'nO~O[9nO!W9mO~P#.{O!W9mO~O!e#vO#t9tO~Og(]y!Z(]y~P!0uO!Z'la!]'la~P#.{Oa%Zq!]%Zq'x%Zq!Z%Zq~P#.{O[9yO~O!Z0}O![)Vq~O#^9}O!Z'na!['na~O!Z5kO![)Si~P#BPO!Q:PO~O!]1gO%h:SO~O(TTO(WUO(c:XO~O!Z1rO![)Tq~O!i:[O~O!i:]O~O!i:^O~O!i:^O~P%[O#^:aO!Z#fy![#fy~O!Z#fy![#fy~P#BPO%h:fO~P&7SO!]'^O%h:fO~O#}#{y!Z#{y![#{y~P#BPOP${iR${i[${ip${i!Q${i!j${i!n${i#P${i#l${i#m${i#n${i#o${i#p${i#q${i#r${i#s${i#t${i#u${i#w${i#y${i#z${i#}${i(_${i(p${i!Z${i![${i~P'%sO!O)|O'w)}O(x%POP'gaR'ga['gal'gap'ga!Q'ga!j'ga!n'ga#P'ga#l'ga#m'ga#n'ga#o'ga#p'ga#q'ga#r'ga#s'ga#t'ga#u'ga#w'ga#y'ga#z'ga#}'ga(_'ga(p'ga(w'ga!Z'ga!['ga~O!O)|O'w)}OP'iaR'ia['ial'iap'ia!Q'ia!j'ia!n'ia#P'ia#l'ia#m'ia#n'ia#o'ia#p'ia#q'ia#r'ia#s'ia#t'ia#u'ia#w'ia#y'ia#z'ia#}'ia(_'ia(p'ia(w'ia(x'ia!Z'ia!['ia~O(w$}OP%`iR%`i[%`il%`ip%`i!O%`i!Q%`i!j%`i!n%`i#P%`i#l%`i#m%`i#n%`i#o%`i#p%`i#q%`i#r%`i#s%`i#t%`i#u%`i#w%`i#y%`i#z%`i#}%`i'w%`i(_%`i(p%`i(x%`i!Z%`i![%`i~O(x%POP%biR%bi[%bil%bip%bi!O%bi!Q%bi!j%bi!n%bi#P%bi#l%bi#m%bi#n%bi#o%bi#p%bi#q%bi#r%bi#s%bi#t%bi#u%bi#w%bi#y%bi#z%bi#}%bi'w%bi(_%bi(p%bi(w%bi!Z%bi![%bi~O#}$ny!Z$ny![$ny~P#BPO#}#ay!Z#ay![#ay~P#BPO!e#vO!Z'cq!i'cq~O!Z/kO!i(|y~O!W'eq!Z'eq~P#.{Op:pO!e#vO(p'nO~O[:tO!W:sO~P#.{O!W:sO~Og(]!R!Z(]!R~P!0uOa%Zy!]%Zy'x%Zy!Z%Zy~P#.{O!Z0}O![)Vy~O!Z5kO![)Sq~O(R:zO~O!]1gO%h:}O~O!i;QO~O%h;VO~P&7SOP${qR${q[${qp${q!Q${q!j${q!n${q#P${q#l${q#m${q#n${q#o${q#p${q#q${q#r${q#s${q#t${q#u${q#w${q#y${q#z${q#}${q(_${q(p${q!Z${q![${q~P'%sO!O)|O'w)}O(x%POP'haR'ha['hal'hap'ha!Q'ha!j'ha!n'ha#P'ha#l'ha#m'ha#n'ha#o'ha#p'ha#q'ha#r'ha#s'ha#t'ha#u'ha#w'ha#y'ha#z'ha#}'ha(_'ha(p'ha(w'ha!Z'ha!['ha~O!O)|O'w)}OP'jaR'ja['jal'jap'ja!Q'ja!j'ja!n'ja#P'ja#l'ja#m'ja#n'ja#o'ja#p'ja#q'ja#r'ja#s'ja#t'ja#u'ja#w'ja#y'ja#z'ja#}'ja(_'ja(p'ja(w'ja(x'ja!Z'ja!['ja~OP$}qR$}q[$}qp$}q!Q$}q!j$}q!n$}q#P$}q#l$}q#m$}q#n$}q#o$}q#p$}q#q$}q#r$}q#s$}q#t$}q#u$}q#w$}q#y$}q#z$}q#}$}q(_$}q(p$}q!Z$}q![$}q~P'%sOg%d!Z!Z%d!Z#^%d!Z#}%d!Z~P!0uO!W;ZO~P#.{Op;[O!e#vO(p'nO~O[;^O!W;ZO~P#.{O!Z'nq!['nq~P#BPO!Z#f!Z![#f!Z~P#BPO#i%d!ZP%d!ZR%d!Z[%d!Za%d!Zp%d!Z!Q%d!Z!Z%d!Z!j%d!Z!n%d!Z#P%d!Z#l%d!Z#m%d!Z#n%d!Z#o%d!Z#p%d!Z#q%d!Z#r%d!Z#s%d!Z#t%d!Z#u%d!Z#w%d!Z#y%d!Z#z%d!Z'x%d!Z(_%d!Z(p%d!Z!i%d!Z!W%d!Z'u%d!Z#^%d!Zt%d!Z!]%d!Z%h%d!Z!e%d!Z~P#.{Op;fO!e#vO(p'nO~O!W;gO~P#.{Op;nO!e#vO(p'nO~O!W;oO~P#.{OP%d!ZR%d!Z[%d!Zp%d!Z!Q%d!Z!j%d!Z!n%d!Z#P%d!Z#l%d!Z#m%d!Z#n%d!Z#o%d!Z#p%d!Z#q%d!Z#r%d!Z#s%d!Z#t%d!Z#u%d!Z#w%d!Z#y%d!Z#z%d!Z#}%d!Z(_%d!Z(p%d!Z!Z%d!Z![%d!Z~P'%sOp;rO!e#vO(p'nO~Ot(dX~P1qO!O%qO~P!(yO(S!lO~P!(yO!WfX!ZfX#^fX~P%0XOP]XR]X[]Xp]X!O]X!Q]X!Z]X!ZfX!j]X!n]X#P]X#Q]X#^]X#^fX#ifX#l]X#m]X#n]X#o]X#p]X#q]X#r]X#s]X#t]X#u]X#w]X#y]X#z]X$P]X(_]X(p]X(w]X(x]X~O!efX!i]X!ifX(pfX~P'JlOP;vOQ;vOSfOd=rOe!iOnkOp;vOqkOrkOxkOz;vO|;vO!QWO!UkO!VkO!]XO!g;yO!jZO!m;vO!n;vO!o;vO!q;zO!s;}O!v!hO$V!kO$m=pO(R)ZO(TTO(WUO(_VO(m[O~O!Z<ZO![$pa~Oh%VOn%WOp%XOq$tOr$tOx%YOz%ZO|<fO!Q${O!]$|O!g=wO!j$xO#h<lO$V%_O$s<hO$u<jO$x%`O(R(tO(TTO(WUO(_$uO(w$}O(x%PO~Oj)bO~P( bOp!cX(p!cX~P# qOp(hX(p(hX~P#!dO![]X![fX~P'JlO!WfX!W$yX!ZfX!Z$yX#^fX~P!/qO#i<OO~O!e#vO#i<OO~O#^<`O~O#t<SO~O#^<pO!Z(uX![(uX~O#^<`O!Z(sX![(sX~O#i<qO~Og<sO~P!0uO#i<yO~O#i<zO~O!e#vO#i<{O~O!e#vO#i<qO~O#}<|O~P#BPO#i<}O~O#i=OO~O#i=TO~O#i=UO~O#i=VO~O#i=WO~O#}=XO~P!0uO#}=YO~P!0uO#Q#R#S#U#V#Y#g#h#s$m$s$u$x%[%]%g%h%i%p%r%u%v%x%z~'|T#m!V'z(S#nq#l#op!O'{$['{(R$^(c~",goto:"$8f)ZPPPPPP)[PP)_P)pP+Q/VPPPP6aPP6wPP<oP@cP@yP@yPPP@yPCRP@yP@yP@yPCVPC[PCyPHsPPPHwPPPPHwKzPPPLQLrPHwPHwPP! QHwPPPHwPHwP!#XHwP!&o!'t!'}P!(q!(u!(q!,SPPPPPPP!,s!'tPP!-T!.uP!2RHwHw!2W!5d!:Q!:Q!>PPPP!>XHwPPPPPPPPPP!AhP!BuPPHw!DWPHwPHwHwHwHwHwPHw!EjP!HtP!KzP!LO!LY!L^!L^P!HqP!Lb!LbP# hP# lHwPHw# r#$wCV@yP@yP@y@yP#&U@y@y#(h@y#+`@y#-l@y@y#.[#0p#0p#0u#1O#0p#1ZPP#0pP@y#1s@y#5r@y@y6aPPP#9wPPP#:b#:bP#:bP#:x#:bPP#;OP#:uP#:u#;c#:u#;}#<T#<W)_#<Z)_P#<b#<b#<bP)_P)_P)_P)_PP)_P#<h#<kP#<k)_P#<oP#<rP)_P)_P)_P)_P)_P)_)_PP#<x#=O#=Z#=a#=g#=m#=s#>R#>X#>c#>i#>s#>y#?Z#?a#@R#@e#@k#@q#AP#Af#CZ#Ci#Cp#E[#Ej#G[#Gj#Gp#Gv#G|#HW#H^#Hd#Hn#IQ#IWPPPPPPPPPPP#I^PPPPPPP#JR#MY#Nr#Ny$ RPPP$&mP$&v$)o$0Y$0]$0`$1_$1b$1i$1qP$1w$1zP$2h$2l$3d$4r$4w$5_PP$5d$5j$5n$5q$5u$5y$6u$7^$7u$7y$7|$8P$8V$8Y$8^$8bR!|RoqOXst!Z#d%l&p&r&s&u,n,s2S2VY!vQ'^-`1g5qQ%svQ%{yQ&S|Q&h!VS'U!e-WQ'd!iS'j!r!yU*h$|*X*lQ+l%|Q+y&UQ,_&bQ-^']Q-h'eQ-p'kQ0U*nQ1q,`R<m;z%SdOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%l%s&Q&i&l&p&r&s&u&y'R'`'p(R(T(Z(b(v(x(|){*f+U+Y,k,n,s-d-l-z.Q.o.v/i0V0d0l0|1j1z1{1}2P2S2V2X2x3O3d4q5y6Z6[6_6r8i8x9SS#q];w!r)]$Z$n'V)q-P-S/Q2h3{5m6i9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sU*{%[<e<fQ+q&OQ,a&eQ,h&mQ0r+dQ0u+fQ1S+rQ1y,fQ3W.bQ5V0wQ5]0}Q6Q1rQ7O3[Q8U5^R9Y7Q'QkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%l%s&Q&i&l&m&p&r&s&u&y'R'V'`'p(R(T(Z(b(v(x(|)q){*f+U+Y+d,k,n,s-P-S-d-l-z.Q.b.o.v/Q/i0V0d0l0|1j1z1{1}2P2S2V2X2h2x3O3[3d3{4q5m5y6Z6[6_6i6r7Q8i8x9S9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=s!S!nQ!r!v!y!z$|'U']'^'j'k'l*h*l*n*o-W-^-`-p0U0X1g5q5s%[$ti#v$b$c$d$x${%O%Q%]%^%b)w*P*R*T*W*^*d*t*u+c+f+},Q.a.z/_/h/r/s/u0Y0[0g0h0i1^1a1i3Z4U4V4a4f4w5R5U5x6|7l7v7|8Q8f9V9e9n9t:S:f:t:};V;^<^<_<a<b<c<d<g<h<i<j<k<l<t<u<v<w<y<z<}=O=P=Q=R=S=T=U=X=Y=p=x=y=|=}Q&V|Q'S!eS'Y%h-ZQ+q&OQ,a&eQ0f+OQ1S+rQ1X+xQ1x,eQ1y,fQ5]0}Q5f1ZQ6Q1rQ6T1tQ6U1wQ8U5^Q8X5cQ8q6WQ9|8YQ:Y8nR<o*XrnOXst!V!Z#d%l&g&p&r&s&u,n,s2S2VR,c&i&z^OPXYstuvwz!Z!`!g!j!o#S#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%l%s&Q&i&l&m&p&r&s&u&y'R'`'p(T(Z(b(v(x(|)q){*f+U+Y+d,k,n,s-P-S-d-l-z.Q.b.o.v/Q/i0V0d0l0|1j1z1{1}2P2S2V2X2h2x3O3[3d3{4q5m5y6Z6[6_6i6r7Q8i8x9S9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=r=s[#]WZ#W#Z'V(R!b%im#h#i#l$x%d%g([(f(g(h*W*[*_+W+X+Z,j-Q.O.U.V.W.Y/h/k2[3S3T4X6h6yQ%vxQ%zyS&P|&UQ&]!TQ'a!hQ'c!iQ(o#sS+k%{%|Q+o&OQ,Y&`Q,^&bS-g'd'eQ.d(pQ0{+lQ1R+rQ1T+sQ1W+wQ1l,ZS1p,_,`Q2t-hQ5[0}Q5`1QQ5e1YQ6P1qQ8T5^Q8W5bQ9x8SR:w9y!U$zi$d%O%Q%]%^%b*P*R*^*t*u.z/r0Y0[0g0h0i4V4w7|9e=p=x=y!^%xy!i!u%z%{%|'T'c'd'e'i's*g+k+l-T-g-h-o/{0O0{2m2t2{4i4j4m7s9pQ+e%vQ,O&YQ,R&ZQ,]&bQ.c(oQ1k,YU1o,^,_,`Q3].dQ5z1lS6O1p1qQ8m6P#f=t#v$b$c$x${)w*T*W*d+c+f+},Q.a/_/h/s/u1^1a1i3Z4U4a4f5R5U5x6|7l7v8Q8f9V9n9t:S:f:t:};V;^<a<c<g<i<k<t<v<y<}=P=R=T=X=|=}o=u<^<_<b<d<h<j<l<u<w<z=O=Q=S=U=YW%Ti%V*v=pS&Y!Q&gQ&Z!RQ&[!SQ+S%cR+|&W%]%Si#v$b$c$d$x${%O%Q%]%^%b)w*P*R*T*W*^*d*t*u+c+f+},Q.a.z/_/h/r/s/u0Y0[0g0h0i1^1a1i3Z4U4V4a4f4w5R5U5x6|7l7v7|8Q8f9V9e9n9t:S:f:t:};V;^<^<_<a<b<c<d<g<h<i<j<k<l<t<u<v<w<y<z<}=O=P=Q=R=S=T=U=X=Y=p=x=y=|=}T)x$u)yV*{%[<e<fW'Y!e%h*X-ZS({#y#zQ+`%qQ+v&RS.](k(lQ1b,SQ4x0cR8^5k'QkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%l%s&Q&i&l&m&p&r&s&u&y'R'V'`'p(R(T(Z(b(v(x(|)q){*f+U+Y+d,k,n,s-P-S-d-l-z.Q.b.o.v/Q/i0V0d0l0|1j1z1{1}2P2S2V2X2h2x3O3[3d3{4q5m5y6Z6[6_6i6r7Q8i8x9S9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=s$i$^c#Y#e%p%r%t(Q(W(r(w)P)Q)R)S)T)U)V)W)X)Y)[)^)`)e)o+a+u-U-s-x-}.P.n.q.u.w.x.y/]0j2c2f2v2}3c3h3i3j3k3l3m3n3o3p3q3r3s3t3w3x4P5O5Y6k6q6v7V7W7a7b8`8|9Q9[9b9c:c:y;R;x=gT#TV#U'RkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%l%s&Q&i&l&m&p&r&s&u&y'R'V'`'p(R(T(Z(b(v(x(|)q){*f+U+Y+d,k,n,s-P-S-d-l-z.Q.b.o.v/Q/i0V0d0l0|1j1z1{1}2P2S2V2X2h2x3O3[3d3{4q5m5y6Z6[6_6i6r7Q8i8x9S9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sQ'W!eR2i-W!W!nQ!e!r!v!y!z$|'U']'^'j'k'l*X*h*l*n*o-W-^-`-p0U0X1g5q5sR1d,UnqOXst!Z#d%l&p&r&s&u,n,s2S2VQ&w!^Q't!xS(q#u<OQ+i%yQ,W&]Q,X&_Q-e'bQ-r'mS.m(v<qS0k+U<{Q0y+jQ1f,VQ2Z,uQ2],vQ2e-RQ2r-fQ2u-jS5P0l=VQ5W0zS5Z0|=WQ6j2gQ6n2sQ6s2zQ8R5XQ8}6lQ9O6oQ9R6tR:`8z$d$]c#Y#e%r%t(Q(W(r(w)P)Q)R)S)T)U)V)W)X)Y)[)^)`)e)o+a+u-U-s-x-}.P.n.q.u.x.y/]0j2c2f2v2}3c3h3i3j3k3l3m3n3o3p3q3r3s3t3w3x4P5O5Y6k6q6v7V7W7a7b8`8|9Q9[9b9c:c:y;R;x=gS(m#p'gQ(}#zS+_%p.wS.^(l(nR3U._'QkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%l%s&Q&i&l&m&p&r&s&u&y'R'V'`'p(R(T(Z(b(v(x(|)q){*f+U+Y+d,k,n,s-P-S-d-l-z.Q.b.o.v/Q/i0V0d0l0|1j1z1{1}2P2S2V2X2h2x3O3[3d3{4q5m5y6Z6[6_6i6r7Q8i8x9S9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sS#q];wQ&r!XQ&s!YQ&u![Q&v!]R2R,qQ'_!hQ+b%vQ-c'aS.`(o+eQ2p-bW3Y.c.d0q0sQ6m2qW6z3V3X3]5TU9U6{6}7PU:e9W9X9ZS;T:d:gQ;b;UR;j;cU!wQ'^-`T5o1g5q!Q_OXZ`st!V!Z#d#h%d%l&g&i&p&r&s&u(h,n,s.V2S2V]!pQ!r'^-`1g5qT#q];w%^{OPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%l%s&Q&i&l&m&p&r&s&u&y'R'`'p(R(T(Z(b(v(x(|){*f+U+Y+d,k,n,s-d-l-z.Q.b.o.v/i0V0d0l0|1j1z1{1}2P2S2V2X2x3O3[3d4q5y6Z6[6_6r7Q8i8x9SS({#y#zS.](k(l!s=^$Z$n'V)q-P-S/Q2h3{5m6i9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sU$fd)],hS(n#p'gU*s%R(u3vU0e*z.i7]Q5T0rQ6{3WQ9X7OR:g9Ym!tQ!r!v!y!z'^'j'k'l-`-p1g5q5sQ'r!uS(d#g1|S-n'i'uQ/n*ZQ/{*gQ2|-qQ4]/oQ4i/}Q4j0OQ4o0WQ7h4WS7s4k4mS7w4p4rQ9g7iQ9k7oQ9p7tQ9u7yS:o9l9mS;Y:p:sS;e;Z;[S;m;f;gS;q;n;oR;t;rQ#wbQ'q!uS(c#g1|S(e#m+TQ+V%eQ+g%wQ+m%}U-m'i'r'uQ.R(dQ/m*ZQ/|*gQ0P*iQ0x+hQ1m,[S2y-n-qQ3R.ZS4[/n/oQ4e/yS4h/{0WQ4l0QQ5|1nQ6u2|Q7g4WQ7k4]U7r4i4o4rQ7u4nQ8k5}S9f7h7iQ9j7oQ9r7wQ9s7xQ:V8lQ:m9gS:n9k9mQ:v9uQ;P:WS;X:o:sS;d;Y;ZS;l;e;gS;p;m;oQ;s;qQ;u;tQ=a=[Q=l=eR=m=fV!wQ'^-`%^aOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%l%s&Q&i&l&m&p&r&s&u&y'R'`'p(R(T(Z(b(v(x(|){*f+U+Y+d,k,n,s-d-l-z.Q.b.o.v/i0V0d0l0|1j1z1{1}2P2S2V2X2x3O3[3d4q5y6Z6[6_6r7Q8i8x9SS#wz!j!r=Z$Z$n'V)q-P-S/Q2h3{5m6i9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sR=a=r%^bOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%l%s&Q&i&l&m&p&r&s&u&y'R'`'p(R(T(Z(b(v(x(|){*f+U+Y+d,k,n,s-d-l-z.Q.b.o.v/i0V0d0l0|1j1z1{1}2P2S2V2X2x3O3[3d4q5y6Z6[6_6r7Q8i8x9SQ%ej!^%wy!i!u%z%{%|'T'c'd'e'i's*g+k+l-T-g-h-o/{0O0{2m2t2{4i4j4m7s9pS%}z!jQ+h%xQ,[&bW1n,],^,_,`U5}1o1p1qS8l6O6PQ:W8m!r=[$Z$n'V)q-P-S/Q2h3{5m6i9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sQ=e=qR=f=r%QeOPXYstuvw!Z!`!g!o#S#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%l%s&Q&i&l&p&r&s&u&y'R'`'p(T(Z(b(v(x(|){*f+U+Y+d,k,n,s-d-l-z.Q.b.o.v/i0V0d0l0|1j1z1{1}2P2S2V2X2x3O3[3d4q5y6Z6[6_6r7Q8i8x9SY#bWZ#W#Z(R!b%im#h#i#l$x%d%g([(f(g(h*W*[*_+W+X+Z,j-Q.O.U.V.W.Y/h/k2[3S3T4X6h6yQ,i&m!p=]$Z$n)q-P-S/Q2h3{5m6i9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sR=`'VU'Z!e%h*XR2k-Z%SdOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%l%s&Q&i&l&p&r&s&u&y'R'`'p(R(T(Z(b(v(x(|){*f+U+Y,k,n,s-d-l-z.Q.o.v/i0V0d0l0|1j1z1{1}2P2S2V2X2x3O3d4q5y6Z6[6_6r8i8x9S!r)]$Z$n'V)q-P-S/Q2h3{5m6i9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sQ,h&mQ0r+dQ3W.bQ7O3[R9Y7Q!b$Tc#Y%p(Q(W(r(w)X)Y)^)e+u-s-x-}.P.n.q/]0j2v2}3c3s5O5Y6q6v7V9Q:c;x!P<U)[)o-U.w2c2f3h3q3r3w4P6k7W7a7b8`8|9[9b9c:y;R=g!f$Vc#Y%p(Q(W(r(w)U)V)X)Y)^)e+u-s-x-}.P.n.q/]0j2v2}3c3s5O5Y6q6v7V9Q:c;x!T<W)[)o-U.w2c2f3h3n3o3q3r3w4P6k7W7a7b8`8|9[9b9c:y;R=g!^$Zc#Y%p(Q(W(r(w)^)e+u-s-x-}.P.n.q/]0j2v2}3c3s5O5Y6q6v7V9Q:c;xQ4V/fz=s)[)o-U.w2c2f3h3w4P6k7W7a7b8`8|9[9b9c:y;R=gQ=x=zR=y={'QkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%l%s&Q&i&l&m&p&r&s&u&y'R'V'`'p(R(T(Z(b(v(x(|)q){*f+U+Y+d,k,n,s-P-S-d-l-z.Q.b.o.v/Q/i0V0d0l0|1j1z1{1}2P2S2V2X2h2x3O3[3d3{4q5m5y6Z6[6_6i6r7Q8i8x9S9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sS$oh$pR3|/P'XgOPWXYZhstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n$p%l%s&Q&i&l&m&p&r&s&u&y'R'V'`'p(R(T(Z(b(v(x(|)q){*f+U+Y+d,k,n,s-P-S-d-l-z.Q.b.o.v/P/Q/i0V0d0l0|1j1z1{1}2P2S2V2X2h2x3O3[3d3{4q5m5y6Z6[6_6i6r7Q8i8x9S9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sT$kf$qQ$ifS)h$l)lR)t$qT$jf$qT)j$l)l'XhOPWXYZhstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n$p%l%s&Q&i&l&m&p&r&s&u&y'R'V'`'p(R(T(Z(b(v(x(|)q){*f+U+Y+d,k,n,s-P-S-d-l-z.Q.b.o.v/P/Q/i0V0d0l0|1j1z1{1}2P2S2V2X2h2x3O3[3d3{4q5m5y6Z6[6_6i6r7Q8i8x9S9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sT$oh$pQ$rhR)s$p%^jOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%l%s&Q&i&l&m&p&r&s&u&y'R'`'p(R(T(Z(b(v(x(|){*f+U+Y+d,k,n,s-d-l-z.Q.b.o.v/i0V0d0l0|1j1z1{1}2P2S2V2X2x3O3[3d4q5y6Z6[6_6r7Q8i8x9S!s=q$Z$n'V)q-P-S/Q2h3{5m6i9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=s#glOPXZst!Z!`!o#S#d#o#{$n%l&i&l&m&p&r&s&u&y'R'`(|)q*f+Y+d,k,n,s-d.b/Q/i0V0d1j1z1{1}2P2S2V2X3[3{4q5y6Z6[6_7Q8i8x!U%Ri$d%O%Q%]%^%b*P*R*^*t*u.z/r0Y0[0g0h0i4V4w7|9e=p=x=y#f(u#v$b$c$x${)w*T*W*d+c+f+},Q.a/_/h/s/u1^1a1i3Z4U4a4f5R5U5x6|7l7v8Q8f9V9n9t:S:f:t:};V;^<a<c<g<i<k<t<v<y<}=P=R=T=X=|=}Q+P%`Q/^)|o3v<^<_<b<d<h<j<l<u<w<z=O=Q=S=U=Y!U$yi$d%O%Q%]%^%b*P*R*^*t*u.z/r0Y0[0g0h0i4V4w7|9e=p=x=yQ*`$zU*i$|*X*lQ+Q%aQ0Q*j#f=c#v$b$c$x${)w*T*W*d+c+f+},Q.a/_/h/s/u1^1a1i3Z4U4a4f5R5U5x6|7l7v8Q8f9V9n9t:S:f:t:};V;^<a<c<g<i<k<t<v<y<}=P=R=T=X=|=}n=d<^<_<b<d<h<j<l<u<w<z=O=Q=S=U=YQ=h=tQ=i=uQ=j=vR=k=w!U%Ri$d%O%Q%]%^%b*P*R*^*t*u.z/r0Y0[0g0h0i4V4w7|9e=p=x=y#f(u#v$b$c$x${)w*T*W*d+c+f+},Q.a/_/h/s/u1^1a1i3Z4U4a4f5R5U5x6|7l7v8Q8f9V9n9t:S:f:t:};V;^<a<c<g<i<k<t<v<y<}=P=R=T=X=|=}o3v<^<_<b<d<h<j<l<u<w<z=O=Q=S=U=YnoOXst!Z#d%l&p&r&s&u,n,s2S2VS*c${*WQ,|&|Q,}'OR4`/s%[%Si#v$b$c$d$x${%O%Q%]%^%b)w*P*R*T*W*^*d*t*u+c+f+},Q.a.z/_/h/r/s/u0Y0[0g0h0i1^1a1i3Z4U4V4a4f4w5R5U5x6|7l7v7|8Q8f9V9e9n9t:S:f:t:};V;^<^<_<a<b<c<d<g<h<i<j<k<l<t<u<v<w<y<z<}=O=P=Q=R=S=T=U=X=Y=p=x=y=|=}Q,P&ZQ1`,RQ5i1_R8]5jV*k$|*X*lU*k$|*X*lT5p1g5qS/y*f/iQ4n0VT7x4q:PQ+g%wQ0P*iQ0x+hQ1m,[Q5|1nQ8k5}Q:V8lR;P:W!U%Oi$d%O%Q%]%^%b*P*R*^*t*u.z/r0Y0[0g0h0i4V4w7|9e=p=x=yx*P$v)c*Q*r+R/q0^0_3y4^4{4|4}7f7z9v:l=b=n=oS0Y*q0Z#f<a#v$b$c$x${)w*T*W*d+c+f+},Q.a/_/h/s/u1^1a1i3Z4U4a4f5R5U5x6|7l7v8Q8f9V9n9t:S:f:t:};V;^<a<c<g<i<k<t<v<y<}=P=R=T=X=|=}n<b<^<_<b<d<h<j<l<u<w<z=O=Q=S=U=Y!d<t(s)a*Y*b.e.h.l/Y/f/v0p1]3`4S4_4c5h7R7U7m7p7}8P9i9q9w:q:u;W;];h=z={`<u3u7X7[7`9]:h:k;kS=P.g3aT=Q7Z9`!U%Qi$d%O%Q%]%^%b*P*R*^*t*u.z/r0Y0[0g0h0i4V4w7|9e=p=x=y|*R$v)c*S*q+R/b/q0^0_3y4^4s4{4|4}7f7z9v:l=b=n=oS0[*r0]#f<c#v$b$c$x${)w*T*W*d+c+f+},Q.a/_/h/s/u1^1a1i3Z4U4a4f5R5U5x6|7l7v8Q8f9V9n9t:S:f:t:};V;^<a<c<g<i<k<t<v<y<}=P=R=T=X=|=}n<d<^<_<b<d<h<j<l<u<w<z=O=Q=S=U=Y!h<v(s)a*Y*b.f.g.l/Y/f/v0p1]3^3`4S4_4c5h7R7S7U7m7p7}8P9i9q9w:q:u;W;];h=z={d<w3u7Y7Z7`9]9^:h:i:k;kS=R.h3bT=S7[9arnOXst!V!Z#d%l&g&p&r&s&u,n,s2S2VQ&d!UR,k&mrnOXst!V!Z#d%l&g&p&r&s&u,n,s2S2VR&d!UQ,T&[R1[+|snOXst!V!Z#d%l&g&p&r&s&u,n,s2S2VQ1h,YS5w1k1lU8e5u5v5zS:R8g8hS:{:Q:TQ;_:|R;i;`Q&k!VR,d&gR6T1tR:Y8nS&P|&UR1T+sQ&p!WR,n&qR,t&vT2T,s2VR,x&wQ,w&wR2^,xQ'w!{R-t'wSsOtQ#dXT%os#dQ#OTR'y#OQ#RUR'{#RQ)y$uR/Z)yQ#UVR(O#UQ#XWU(U#X(V-{Q(V#YR-{(WQ-X'WR2j-XQ.p(wS3e.p3fR3f.qQ-`'^R2n-`Y!rQ'^-`1g5qR'h!rQ.{)cR3z.{U#_W%g*WU(]#_(^-|Q(^#`R-|(XQ-['ZR2l-[t`OXst!V!Z#d%l&g&i&p&r&s&u,n,s2S2VS#hZ%dU#r`#h.VR.V(hQ(i#jQ.S(eW.[(i.S3P6wQ3P.TR6w3QQ)l$lR/R)lQ$phR)r$pQ$`cU)_$`-w<[Q-w;xR<[)oQ/l*ZW4Y/l4Z7j9hU4Z/m/n/oS7j4[4]R9h7k$e*O$v(s)a)c*Y*b*q*r*|*}+R.g.h.j.k.l/Y/b/d/f/q/v0^0_0p1]3^3_3`3u3y4S4^4_4c4s4u4{4|4}5h7R7S7T7U7Z7[7^7_7`7f7m7p7z7}8P9]9^9_9i9q9v9w:h:i:j:k:l:q:u;W;];h;k=b=n=o=z={Q/t*bU4b/t4d7nQ4d/vR7n4cS*l$|*XR0S*lx*Q$v)c*q*r+R/q0^0_3y4^4{4|4}7f7z9v:l=b=n=o!d.e(s)a*Y*b.g.h.l/Y/f/v0p1]3`4S4_4c5h7R7U7m7p7}8P9i9q9w:q:u;W;];h=z={U/c*Q.e7Xa7X3u7Z7[7`9]:h:k;kQ0Z*qQ3a.gU4t0Z3a9`R9`7Z|*S$v)c*q*r+R/b/q0^0_3y4^4s4{4|4}7f7z9v:l=b=n=o!h.f(s)a*Y*b.g.h.l/Y/f/v0p1]3^3`4S4_4c5h7R7S7U7m7p7}8P9i9q9w:q:u;W;];h=z={U/e*S.f7Ye7Y3u7Z7[7`9]9^:h:i:k;kQ0]*rQ3b.hU4v0]3b9aR9a7[Q*w%UR0a*wQ5S0pR8O5SQ+[%jR0o+[Q5l1bS8_5l:OR:O8`Q,V&]R1e,VQ5q1gR8b5qQ1s,aS6R1s8oR8o6TQ1O+oW5_1O5a8V9zQ5a1RQ8V5`R9z8WQ+t&PR1U+tQ2V,sR6c2VYrOXst#dQ&t!ZQ+^%lQ,m&pQ,o&rQ,p&sQ,r&uQ2Q,nS2T,s2VR6b2SQ%npQ&x!_Q&{!aQ&}!bQ'P!cQ'o!uQ+]%kQ+i%yQ+{&VQ,c&kQ,z&zW-k'i'q'r'uQ-r'mQ0R*kQ0y+jS1v,d,gQ2_,yQ2`,|Q2a,}Q2u-jW2w-m-n-q-sQ5W0zQ5d1XQ5g1]Q5{1mQ6V1xQ6a2RU6p2v2y2|Q6s2zQ8R5XQ8Z5fQ8[5hQ8a5pQ8j5|Q8p6US9P6q6uQ9R6tQ9{8XQ:U8kQ:Z8qQ:b9QQ:x9|Q;O:VQ;S:cR;a;PQ%yyQ'b!iQ'm!uU+j%z%{%|Q-R'TU-f'c'd'eS-j'i'sQ/z*gS0z+k+lQ2g-TS2s-g-hQ2z-oS4g/{0OQ5X0{Q6l2mQ6o2tQ6t2{U7q4i4j4mQ9o7sR:r9pS$wi=pR*x%VU%Ui%V=pR0`*vQ$viS(s#v+fS)a$b$cQ)c$dQ*Y$xS*b${*WQ*q%OQ*r%QQ*|%]Q*}%^Q+R%bQ.g<aQ.h<cQ.j<gQ.k<iQ.l<kQ/Y)wQ/b*PQ/d*RQ/f*TQ/q*^S/v*d/hQ0^*tQ0_*ul0p+c,Q.a1a1i3Z5x6|8f9V:S:f:};VQ1]+}Q3^<tQ3_<vQ3`<yS3u<^<_Q3y.zS4S/_4UQ4^/rQ4_/sQ4c/uQ4s0YQ4u0[Q4{0gQ4|0hQ4}0iQ5h1^Q7R<}Q7S=PQ7T=RQ7U=TQ7Z<bQ7[<dQ7^<hQ7_<jQ7`<lQ7f4VQ7m4aQ7p4fQ7z4wQ7}5RQ8P5UQ9]<zQ9^<uQ9_<wQ9i7lQ9q7vQ9v7|Q9w8QQ:h=OQ:i=QQ:j=SQ:k=UQ:l9eQ:q9nQ:u9tQ;W=XQ;]:tQ;h;^Q;k=YQ=b=pQ=n=xQ=o=yQ=z=|R={=}Q*z%[Q.i<eR7]<fnpOXst!Z#d%l&p&r&s&u,n,s2S2VQ!fPS#fZ#oQ&z!`W'f!o*f0V4qQ'}#SQ)O#{Q)p$nS,g&i&lQ,l&mQ,y&yS-O'R/iQ-b'`Q.s(|Q/V)qQ0m+YQ0s+dQ2O,kQ2q-dQ3X.bQ4O/QQ4y0dQ5v1jQ6X1zQ6Y1{Q6^1}Q6`2PQ6e2XQ7P3[Q7c3{Q8h5yQ8t6ZQ8u6[Q8w6_Q9Z7QQ:T8iR:_8x#[cOPXZst!Z!`!o#d#o#{%l&i&l&m&p&r&s&u&y'R'`(|*f+Y+d,k,n,s-d.b/i0V0d1j1z1{1}2P2S2V2X3[4q5y6Z6[6_7Q8i8xQ#YWQ#eYQ%puQ%rvS%tw!gS(Q#W(TQ(W#ZQ(r#uQ(w#xQ)P$OQ)Q$PQ)R$QQ)S$RQ)T$SQ)U$TQ)V$UQ)W$VQ)X$WQ)Y$XQ)[$ZQ)^$_Q)`$aQ)e$eW)o$n)q/Q3{Q+a%sQ+u&QS-U'V2hQ-s'pS-x(R-zQ-}(ZQ.P(bQ.n(vQ.q(xQ.u;vQ.w;yQ.x;zQ.y;}Q/]){Q0j+UQ2c-PQ2f-SQ2v-lQ2}.QQ3c.oQ3h<OQ3i<PQ3j<QQ3k<RQ3l<SQ3m<TQ3n<UQ3o<VQ3p<WQ3q<XQ3r<YQ3s.vQ3t<]Q3w<`Q3x<mQ4P<ZQ5O0lQ5Y0|Q6k<pQ6q2xQ6v3OQ7V3dQ7W<qQ7a<sQ7b<{Q8`5mQ8|6iQ9Q6rQ9[<|Q9b=VQ9c=WQ:c9SQ:y9}Q;R:aQ;x#SR=g=sR#[WR'X!el!tQ!r!v!y!z'^'j'k'l-`-p1g5q5sS'T!e-WU*g$|*X*lS-T'U']S0O*h*nQ0W*oQ2m-^Q4m0UR4r0XR(y#xQ!fQT-_'^-`]!qQ!r'^-`1g5qQ#p]R'g;wR)d$dY!uQ'^-`1g5qQ'i!rS's!v!yS'u!z5sS-o'j'kQ-q'lR2{-pT#kZ%dS#jZ%dS%jm,jU(e#h#i#lS.T(f(gQ.X(hQ0n+ZQ3Q.UU3R.V.W.YS6x3S3TR9T6yd#^W#W#Z%g(R([*W+W.O/hr#gZm#h#i#l%d(f(g(h+Z.U.V.W.Y3S3T6yS*Z$x*_Q/o*[Q1|,jQ2d-QQ4W/kQ6g2[Q7i4XQ8{6hT=_'V+XV#aW%g*WU#`W%g*WS(S#W([U(X#Z+W/hS-V'V+XT-y(R.OV'[!e%h*XQ$lfR)v$qT)k$l)lR3}/PT*]$x*_T*e${*WQ0q+cQ1_,QQ3V.aQ5j1aQ5u1iQ6}3ZQ8g5xQ9W6|Q:Q8fQ:d9VQ:|:SQ;U:fQ;`:}R;c;VnqOXst!Z#d%l&p&r&s&u,n,s2S2VQ&j!VR,c&gtmOXst!U!V!Z#d%l&g&p&r&s&u,n,s2S2VR,j&mT%km,jR1c,SR,b&eQ&T|R+z&UR+p&OT&n!W&qT&o!W&qT2U,s2V",nodeNames:" ArithOp ArithOp ?. JSXStartTag LineComment BlockComment Script Hashbang ExportDeclaration export Star as VariableName String Escape from ; default FunctionDeclaration async function VariableDefinition > < TypeParamList const TypeDefinition extends ThisType this LiteralType ArithOp Number BooleanLiteral TemplateType InterpolationEnd Interpolation InterpolationStart NullType null VoidType void TypeofType typeof MemberExpression . PropertyName [ TemplateString Escape Interpolation super RegExp ] ArrayExpression Spread , } { ObjectExpression Property async get set PropertyDefinition Block : NewTarget new NewExpression ) ( ArgList UnaryExpression delete LogicOp BitOp YieldExpression yield AwaitExpression await ParenthesizedExpression ClassExpression class ClassBody MethodDeclaration Decorator @ MemberExpression PrivatePropertyName CallExpression TypeArgList CompareOp < declare Privacy static abstract override PrivatePropertyDefinition PropertyDeclaration readonly accessor Optional TypeAnnotation Equals StaticBlock FunctionExpression ArrowFunction ParamList ParamList ArrayPattern ObjectPattern PatternProperty Privacy readonly Arrow MemberExpression BinaryExpression ArithOp ArithOp ArithOp ArithOp BitOp CompareOp instanceof satisfies in CompareOp BitOp BitOp BitOp LogicOp LogicOp ConditionalExpression LogicOp LogicOp AssignmentExpression UpdateOp PostfixExpression CallExpression InstantiationExpression TaggedTemplateExpression DynamicImport import ImportMeta JSXElement JSXSelfCloseEndTag JSXSelfClosingTag JSXIdentifier JSXBuiltin JSXIdentifier JSXNamespacedName JSXMemberExpression JSXSpreadAttribute JSXAttribute JSXAttributeValue JSXEscape JSXEndTag JSXOpenTag JSXFragmentTag JSXText JSXEscape JSXStartCloseTag JSXCloseTag PrefixCast < ArrowFunction TypeParamList SequenceExpression InstantiationExpression KeyofType keyof UniqueType unique ImportType InferredType infer TypeName ParenthesizedType FunctionSignature ParamList NewSignature IndexedType TupleType Label ArrayType ReadonlyType ObjectType MethodType PropertyType IndexSignature PropertyDefinition CallSignature TypePredicate asserts is NewSignature new UnionType LogicOp IntersectionType LogicOp ConditionalType ParameterizedType ClassDeclaration abstract implements type VariableDeclaration let var using TypeAliasDeclaration InterfaceDeclaration interface EnumDeclaration enum EnumBody NamespaceDeclaration namespace module AmbientDeclaration declare GlobalDeclaration global ClassDeclaration ClassBody AmbientFunctionDeclaration ExportGroup VariableName VariableName ImportDeclaration ImportGroup ForStatement for ForSpec ForInSpec ForOfSpec of WhileStatement while WithStatement with DoStatement do IfStatement if else SwitchStatement switch SwitchBody CaseLabel case DefaultLabel TryStatement try CatchClause catch FinallyClause finally ReturnStatement return ThrowStatement throw BreakStatement break ContinueStatement continue DebuggerStatement debugger LabeledStatement ExpressionStatement SingleExpression SingleClassItem",maxTerm:378,context:MK,nodeProps:[["isolate",-8,5,6,14,35,37,49,51,53,""],["group",-26,9,17,19,66,206,210,214,215,217,220,223,233,235,241,243,245,247,250,256,262,264,266,268,270,272,273,"Statement",-34,13,14,30,33,34,40,49,52,53,55,60,68,70,74,78,80,82,83,108,109,118,119,135,138,140,141,142,143,144,146,147,166,168,170,"Expression",-23,29,31,35,39,41,43,172,174,176,177,179,180,181,183,184,185,187,188,189,200,202,204,205,"Type",-3,86,101,107,"ClassItem"],["openedBy",23,"<",36,"InterpolationStart",54,"[",58,"{",71,"(",159,"JSXStartCloseTag"],["closedBy",-2,24,167,">",38,"InterpolationEnd",48,"]",59,"}",72,")",164,"JSXEndTag"]],propSources:[UK],skippedNodes:[0,5,6,276],repeatNodeCount:37,tokenData:"$Fq07[R!bOX%ZXY+gYZ-yZ[+g[]%Z]^.c^p%Zpq+gqr/mrs3cst:_tuEruvJSvwLkwx! Yxy!'iyz!(sz{!)}{|!,q|}!.O}!O!,q!O!P!/Y!P!Q!9j!Q!R#:O!R![#<_![!]#I_!]!^#Jk!^!_#Ku!_!`$![!`!a$$v!a!b$*T!b!c$,r!c!}Er!}#O$-|#O#P$/W#P#Q$4o#Q#R$5y#R#SEr#S#T$7W#T#o$8b#o#p$<r#p#q$=h#q#r$>x#r#s$@U#s$f%Z$f$g+g$g#BYEr#BY#BZ$A`#BZ$ISEr$IS$I_$A`$I_$I|Er$I|$I}$Dk$I}$JO$Dk$JO$JTEr$JT$JU$A`$JU$KVEr$KV$KW$A`$KW&FUEr&FU&FV$A`&FV;'SEr;'S;=`I|<%l?HTEr?HT?HU$A`?HUOEr(n%d_$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z&j&hT$h&jO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c&j&zP;=`<%l&c'|'U]$h&j(X!bOY&}YZ&cZw&}wx&cx!^&}!^!_'}!_#O&}#O#P&c#P#o&}#o#p'}#p;'S&};'S;=`(l<%lO&}!b(SU(X!bOY'}Zw'}x#O'}#P;'S'};'S;=`(f<%lO'}!b(iP;=`<%l'}'|(oP;=`<%l&}'[(y]$h&j(UpOY(rYZ&cZr(rrs&cs!^(r!^!_)r!_#O(r#O#P&c#P#o(r#o#p)r#p;'S(r;'S;=`*a<%lO(rp)wU(UpOY)rZr)rs#O)r#P;'S)r;'S;=`*Z<%lO)rp*^P;=`<%l)r'[*dP;=`<%l(r#S*nX(Up(X!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g#S+^P;=`<%l*g(n+dP;=`<%l%Z07[+rq$h&j(Up(X!b'z0/lOX%ZXY+gYZ&cZ[+g[p%Zpq+gqr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p$f%Z$f$g+g$g#BY%Z#BY#BZ+g#BZ$IS%Z$IS$I_+g$I_$JT%Z$JT$JU+g$JU$KV%Z$KV$KW+g$KW&FU%Z&FU&FV+g&FV;'S%Z;'S;=`+a<%l?HT%Z?HT?HU+g?HUO%Z07[.ST(V#S$h&j'{0/lO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c07[.n_$h&j(Up(X!b'{0/lOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z)3p/x`$h&j!n),Q(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`0z!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW1V`#u(Ch$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`2X!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW2d_#u(Ch$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'At3l_(T':f$h&j(X!bOY4kYZ5qZr4krs7nsw4kwx5qx!^4k!^!_8p!_#O4k#O#P5q#P#o4k#o#p8p#p;'S4k;'S;=`:X<%lO4k(^4r_$h&j(X!bOY4kYZ5qZr4krs7nsw4kwx5qx!^4k!^!_8p!_#O4k#O#P5q#P#o4k#o#p8p#p;'S4k;'S;=`:X<%lO4k&z5vX$h&jOr5qrs6cs!^5q!^!_6y!_#o5q#o#p6y#p;'S5q;'S;=`7h<%lO5q&z6jT$c`$h&jO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c`6|TOr6yrs7]s;'S6y;'S;=`7b<%lO6y`7bO$c``7eP;=`<%l6y&z7kP;=`<%l5q(^7w]$c`$h&j(X!bOY&}YZ&cZw&}wx&cx!^&}!^!_'}!_#O&}#O#P&c#P#o&}#o#p'}#p;'S&};'S;=`(l<%lO&}!r8uZ(X!bOY8pYZ6yZr8prs9hsw8pwx6yx#O8p#O#P6y#P;'S8p;'S;=`:R<%lO8p!r9oU$c`(X!bOY'}Zw'}x#O'}#P;'S'};'S;=`(f<%lO'}!r:UP;=`<%l8p(^:[P;=`<%l4k%9[:hh$h&j(Up(X!bOY%ZYZ&cZq%Zqr<Srs&}st%ZtuCruw%Zwx(rx!^%Z!^!_*g!_!c%Z!c!}Cr!}#O%Z#O#P&c#P#R%Z#R#SCr#S#T%Z#T#oCr#o#p*g#p$g%Z$g;'SCr;'S;=`El<%lOCr(r<__WS$h&j(Up(X!bOY<SYZ&cZr<Srs=^sw<Swx@nx!^<S!^!_Bm!_#O<S#O#P>`#P#o<S#o#pBm#p;'S<S;'S;=`Cl<%lO<S(Q=g]WS$h&j(X!bOY=^YZ&cZw=^wx>`x!^=^!^!_?q!_#O=^#O#P>`#P#o=^#o#p?q#p;'S=^;'S;=`@h<%lO=^&n>gXWS$h&jOY>`YZ&cZ!^>`!^!_?S!_#o>`#o#p?S#p;'S>`;'S;=`?k<%lO>`S?XSWSOY?SZ;'S?S;'S;=`?e<%lO?SS?hP;=`<%l?S&n?nP;=`<%l>`!f?xWWS(X!bOY?qZw?qwx?Sx#O?q#O#P?S#P;'S?q;'S;=`@b<%lO?q!f@eP;=`<%l?q(Q@kP;=`<%l=^'`@w]WS$h&j(UpOY@nYZ&cZr@nrs>`s!^@n!^!_Ap!_#O@n#O#P>`#P#o@n#o#pAp#p;'S@n;'S;=`Bg<%lO@ntAwWWS(UpOYApZrAprs?Ss#OAp#O#P?S#P;'SAp;'S;=`Ba<%lOAptBdP;=`<%lAp'`BjP;=`<%l@n#WBvYWS(Up(X!bOYBmZrBmrs?qswBmwxApx#OBm#O#P?S#P;'SBm;'S;=`Cf<%lOBm#WCiP;=`<%lBm(rCoP;=`<%l<S%9[C}i$h&j(m%1l(Up(X!bOY%ZYZ&cZr%Zrs&}st%ZtuCruw%Zwx(rx!Q%Z!Q![Cr![!^%Z!^!_*g!_!c%Z!c!}Cr!}#O%Z#O#P&c#P#R%Z#R#SCr#S#T%Z#T#oCr#o#p*g#p$g%Z$g;'SCr;'S;=`El<%lOCr%9[EoP;=`<%lCr07[FRk$h&j(Up(X!b$[#t(R,2j(c$I[OY%ZYZ&cZr%Zrs&}st%ZtuEruw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Er![!^%Z!^!_*g!_!c%Z!c!}Er!}#O%Z#O#P&c#P#R%Z#R#SEr#S#T%Z#T#oEr#o#p*g#p$g%Z$g;'SEr;'S;=`I|<%lOEr+dHRk$h&j(Up(X!b$[#tOY%ZYZ&cZr%Zrs&}st%ZtuGvuw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Gv![!^%Z!^!_*g!_!c%Z!c!}Gv!}#O%Z#O#P&c#P#R%Z#R#SGv#S#T%Z#T#oGv#o#p*g#p$g%Z$g;'SGv;'S;=`Iv<%lOGv+dIyP;=`<%lGv07[JPP;=`<%lEr(KWJ_`$h&j(Up(X!b#n(ChOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KWKl_$h&j$P(Ch(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z,#xLva(x+JY$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sv%ZvwM{wx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KWNW`$h&j#y(Ch(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'At! c_(W';W$h&j(UpOY!!bYZ!#hZr!!brs!#hsw!!bwx!$xx!^!!b!^!_!%z!_#O!!b#O#P!#h#P#o!!b#o#p!%z#p;'S!!b;'S;=`!'c<%lO!!b'l!!i_$h&j(UpOY!!bYZ!#hZr!!brs!#hsw!!bwx!$xx!^!!b!^!_!%z!_#O!!b#O#P!#h#P#o!!b#o#p!%z#p;'S!!b;'S;=`!'c<%lO!!b&z!#mX$h&jOw!#hwx6cx!^!#h!^!_!$Y!_#o!#h#o#p!$Y#p;'S!#h;'S;=`!$r<%lO!#h`!$]TOw!$Ywx7]x;'S!$Y;'S;=`!$l<%lO!$Y`!$oP;=`<%l!$Y&z!$uP;=`<%l!#h'l!%R]$c`$h&j(UpOY(rYZ&cZr(rrs&cs!^(r!^!_)r!_#O(r#O#P&c#P#o(r#o#p)r#p;'S(r;'S;=`*a<%lO(r!Q!&PZ(UpOY!%zYZ!$YZr!%zrs!$Ysw!%zwx!&rx#O!%z#O#P!$Y#P;'S!%z;'S;=`!']<%lO!%z!Q!&yU$c`(UpOY)rZr)rs#O)r#P;'S)r;'S;=`*Z<%lO)r!Q!'`P;=`<%l!%z'l!'fP;=`<%l!!b/5|!'t_!j/.^$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z#&U!)O_!i!Lf$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z-!n!*[b$h&j(Up(X!b(S%&f#o(ChOY%ZYZ&cZr%Zrs&}sw%Zwx(rxz%Zz{!+d{!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW!+o`$h&j(Up(X!b#l(ChOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z+;x!,|`$h&j(Up(X!bp+4YOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z,$U!.Z_!Z+Jf$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z07[!/ec$h&j(Up(X!b!O.2^OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!0p!P!Q%Z!Q![!3Y![!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z#%|!0ya$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!2O!P!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z#%|!2Z_!Y!L^$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad!3eg$h&j(Up(X!bq'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![!3Y![!^%Z!^!_*g!_!g%Z!g!h!4|!h#O%Z#O#P&c#P#R%Z#R#S!3Y#S#X%Z#X#Y!4|#Y#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad!5Vg$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx{%Z{|!6n|}%Z}!O!6n!O!Q%Z!Q![!8S![!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S!8S#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad!6wc$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![!8S![!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S!8S#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad!8_c$h&j(Up(X!bq'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![!8S![!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S!8S#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z07[!9uf$h&j(Up(X!b#m(ChOY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcxz!;Zz{#-}{!P!;Z!P!Q#/d!Q!^!;Z!^!_#(i!_!`#7S!`!a#8i!a!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;Z?O!;fb$h&j(Up(X!b!V7`OY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcx!P!;Z!P!Q#&`!Q!^!;Z!^!_#(i!_!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;Z>^!<w`$h&j(X!b!V7`OY!<nYZ&cZw!<nwx!=yx!P!<n!P!Q!Eq!Q!^!<n!^!_!Gr!_!}!<n!}#O!KS#O#P!Dy#P#o!<n#o#p!Gr#p;'S!<n;'S;=`!L]<%lO!<n<z!>Q^$h&j!V7`OY!=yYZ&cZ!P!=y!P!Q!>|!Q!^!=y!^!_!@c!_!}!=y!}#O!CW#O#P!Dy#P#o!=y#o#p!@c#p;'S!=y;'S;=`!Ek<%lO!=y<z!?Td$h&j!V7`O!^&c!_#W&c#W#X!>|#X#Z&c#Z#[!>|#[#]&c#]#^!>|#^#a&c#a#b!>|#b#g&c#g#h!>|#h#i&c#i#j!>|#j#k!>|#k#m&c#m#n!>|#n#o&c#p;'S&c;'S;=`&w<%lO&c7`!@hX!V7`OY!@cZ!P!@c!P!Q!AT!Q!}!@c!}#O!Ar#O#P!Bq#P;'S!@c;'S;=`!CQ<%lO!@c7`!AYW!V7`#W#X!AT#Z#[!AT#]#^!AT#a#b!AT#g#h!AT#i#j!AT#j#k!AT#m#n!AT7`!AuVOY!ArZ#O!Ar#O#P!B[#P#Q!@c#Q;'S!Ar;'S;=`!Bk<%lO!Ar7`!B_SOY!ArZ;'S!Ar;'S;=`!Bk<%lO!Ar7`!BnP;=`<%l!Ar7`!BtSOY!@cZ;'S!@c;'S;=`!CQ<%lO!@c7`!CTP;=`<%l!@c<z!C][$h&jOY!CWYZ&cZ!^!CW!^!_!Ar!_#O!CW#O#P!DR#P#Q!=y#Q#o!CW#o#p!Ar#p;'S!CW;'S;=`!Ds<%lO!CW<z!DWX$h&jOY!CWYZ&cZ!^!CW!^!_!Ar!_#o!CW#o#p!Ar#p;'S!CW;'S;=`!Ds<%lO!CW<z!DvP;=`<%l!CW<z!EOX$h&jOY!=yYZ&cZ!^!=y!^!_!@c!_#o!=y#o#p!@c#p;'S!=y;'S;=`!Ek<%lO!=y<z!EnP;=`<%l!=y>^!Ezl$h&j(X!b!V7`OY&}YZ&cZw&}wx&cx!^&}!^!_'}!_#O&}#O#P&c#P#W&}#W#X!Eq#X#Z&}#Z#[!Eq#[#]&}#]#^!Eq#^#a&}#a#b!Eq#b#g&}#g#h!Eq#h#i&}#i#j!Eq#j#k!Eq#k#m&}#m#n!Eq#n#o&}#o#p'}#p;'S&};'S;=`(l<%lO&}8r!GyZ(X!b!V7`OY!GrZw!Grwx!@cx!P!Gr!P!Q!Hl!Q!}!Gr!}#O!JU#O#P!Bq#P;'S!Gr;'S;=`!J|<%lO!Gr8r!Hse(X!b!V7`OY'}Zw'}x#O'}#P#W'}#W#X!Hl#X#Z'}#Z#[!Hl#[#]'}#]#^!Hl#^#a'}#a#b!Hl#b#g'}#g#h!Hl#h#i'}#i#j!Hl#j#k!Hl#k#m'}#m#n!Hl#n;'S'};'S;=`(f<%lO'}8r!JZX(X!bOY!JUZw!JUwx!Arx#O!JU#O#P!B[#P#Q!Gr#Q;'S!JU;'S;=`!Jv<%lO!JU8r!JyP;=`<%l!JU8r!KPP;=`<%l!Gr>^!KZ^$h&j(X!bOY!KSYZ&cZw!KSwx!CWx!^!KS!^!_!JU!_#O!KS#O#P!DR#P#Q!<n#Q#o!KS#o#p!JU#p;'S!KS;'S;=`!LV<%lO!KS>^!LYP;=`<%l!KS>^!L`P;=`<%l!<n=l!Ll`$h&j(Up!V7`OY!LcYZ&cZr!Lcrs!=ys!P!Lc!P!Q!Mn!Q!^!Lc!^!_# o!_!}!Lc!}#O#%P#O#P!Dy#P#o!Lc#o#p# o#p;'S!Lc;'S;=`#&Y<%lO!Lc=l!Mwl$h&j(Up!V7`OY(rYZ&cZr(rrs&cs!^(r!^!_)r!_#O(r#O#P&c#P#W(r#W#X!Mn#X#Z(r#Z#[!Mn#[#](r#]#^!Mn#^#a(r#a#b!Mn#b#g(r#g#h!Mn#h#i(r#i#j!Mn#j#k!Mn#k#m(r#m#n!Mn#n#o(r#o#p)r#p;'S(r;'S;=`*a<%lO(r8Q# vZ(Up!V7`OY# oZr# ors!@cs!P# o!P!Q#!i!Q!}# o!}#O#$R#O#P!Bq#P;'S# o;'S;=`#$y<%lO# o8Q#!pe(Up!V7`OY)rZr)rs#O)r#P#W)r#W#X#!i#X#Z)r#Z#[#!i#[#])r#]#^#!i#^#a)r#a#b#!i#b#g)r#g#h#!i#h#i)r#i#j#!i#j#k#!i#k#m)r#m#n#!i#n;'S)r;'S;=`*Z<%lO)r8Q#$WX(UpOY#$RZr#$Rrs!Ars#O#$R#O#P!B[#P#Q# o#Q;'S#$R;'S;=`#$s<%lO#$R8Q#$vP;=`<%l#$R8Q#$|P;=`<%l# o=l#%W^$h&j(UpOY#%PYZ&cZr#%Prs!CWs!^#%P!^!_#$R!_#O#%P#O#P!DR#P#Q!Lc#Q#o#%P#o#p#$R#p;'S#%P;'S;=`#&S<%lO#%P=l#&VP;=`<%l#%P=l#&]P;=`<%l!Lc?O#&kn$h&j(Up(X!b!V7`OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#W%Z#W#X#&`#X#Z%Z#Z#[#&`#[#]%Z#]#^#&`#^#a%Z#a#b#&`#b#g%Z#g#h#&`#h#i%Z#i#j#&`#j#k#&`#k#m%Z#m#n#&`#n#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z9d#(r](Up(X!b!V7`OY#(iZr#(irs!Grsw#(iwx# ox!P#(i!P!Q#)k!Q!}#(i!}#O#+`#O#P!Bq#P;'S#(i;'S;=`#,`<%lO#(i9d#)th(Up(X!b!V7`OY*gZr*grs'}sw*gwx)rx#O*g#P#W*g#W#X#)k#X#Z*g#Z#[#)k#[#]*g#]#^#)k#^#a*g#a#b#)k#b#g*g#g#h#)k#h#i*g#i#j#)k#j#k#)k#k#m*g#m#n#)k#n;'S*g;'S;=`+Z<%lO*g9d#+gZ(Up(X!bOY#+`Zr#+`rs!JUsw#+`wx#$Rx#O#+`#O#P!B[#P#Q#(i#Q;'S#+`;'S;=`#,Y<%lO#+`9d#,]P;=`<%l#+`9d#,cP;=`<%l#(i?O#,o`$h&j(Up(X!bOY#,fYZ&cZr#,frs!KSsw#,fwx#%Px!^#,f!^!_#+`!_#O#,f#O#P!DR#P#Q!;Z#Q#o#,f#o#p#+`#p;'S#,f;'S;=`#-q<%lO#,f?O#-tP;=`<%l#,f?O#-zP;=`<%l!;Z07[#.[b$h&j(Up(X!b'|0/l!V7`OY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcx!P!;Z!P!Q#&`!Q!^!;Z!^!_#(i!_!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;Z07[#/o_$h&j(Up(X!bT0/lOY#/dYZ&cZr#/drs#0nsw#/dwx#4Ox!^#/d!^!_#5}!_#O#/d#O#P#1p#P#o#/d#o#p#5}#p;'S#/d;'S;=`#6|<%lO#/d06j#0w]$h&j(X!bT0/lOY#0nYZ&cZw#0nwx#1px!^#0n!^!_#3R!_#O#0n#O#P#1p#P#o#0n#o#p#3R#p;'S#0n;'S;=`#3x<%lO#0n05W#1wX$h&jT0/lOY#1pYZ&cZ!^#1p!^!_#2d!_#o#1p#o#p#2d#p;'S#1p;'S;=`#2{<%lO#1p0/l#2iST0/lOY#2dZ;'S#2d;'S;=`#2u<%lO#2d0/l#2xP;=`<%l#2d05W#3OP;=`<%l#1p01O#3YW(X!bT0/lOY#3RZw#3Rwx#2dx#O#3R#O#P#2d#P;'S#3R;'S;=`#3r<%lO#3R01O#3uP;=`<%l#3R06j#3{P;=`<%l#0n05x#4X]$h&j(UpT0/lOY#4OYZ&cZr#4Ors#1ps!^#4O!^!_#5Q!_#O#4O#O#P#1p#P#o#4O#o#p#5Q#p;'S#4O;'S;=`#5w<%lO#4O00^#5XW(UpT0/lOY#5QZr#5Qrs#2ds#O#5Q#O#P#2d#P;'S#5Q;'S;=`#5q<%lO#5Q00^#5tP;=`<%l#5Q05x#5zP;=`<%l#4O01p#6WY(Up(X!bT0/lOY#5}Zr#5}rs#3Rsw#5}wx#5Qx#O#5}#O#P#2d#P;'S#5};'S;=`#6v<%lO#5}01p#6yP;=`<%l#5}07[#7PP;=`<%l#/d)3h#7ab$h&j$P(Ch(Up(X!b!V7`OY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcx!P!;Z!P!Q#&`!Q!^!;Z!^!_#(i!_!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;ZAt#8vb$Y#t$h&j(Up(X!b!V7`OY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcx!P!;Z!P!Q#&`!Q!^!;Z!^!_#(i!_!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;Z'Ad#:Zp$h&j(Up(X!bq'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!3Y!P!Q%Z!Q![#<_![!^%Z!^!_*g!_!g%Z!g!h!4|!h#O%Z#O#P&c#P#R%Z#R#S#<_#S#U%Z#U#V#?i#V#X%Z#X#Y!4|#Y#b%Z#b#c#>_#c#d#Bq#d#l%Z#l#m#Es#m#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#<jk$h&j(Up(X!bq'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!3Y!P!Q%Z!Q![#<_![!^%Z!^!_*g!_!g%Z!g!h!4|!h#O%Z#O#P&c#P#R%Z#R#S#<_#S#X%Z#X#Y!4|#Y#b%Z#b#c#>_#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#>j_$h&j(Up(X!bq'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#?rd$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!R#AQ!R!S#AQ!S!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#AQ#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#A]f$h&j(Up(X!bq'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!R#AQ!R!S#AQ!S!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#AQ#S#b%Z#b#c#>_#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#Bzc$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!Y#DV!Y!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#DV#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#Dbe$h&j(Up(X!bq'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!Y#DV!Y!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#DV#S#b%Z#b#c#>_#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#E|g$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![#Ge![!^%Z!^!_*g!_!c%Z!c!i#Ge!i#O%Z#O#P&c#P#R%Z#R#S#Ge#S#T%Z#T#Z#Ge#Z#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#Gpi$h&j(Up(X!bq'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![#Ge![!^%Z!^!_*g!_!c%Z!c!i#Ge!i#O%Z#O#P&c#P#R%Z#R#S#Ge#S#T%Z#T#Z#Ge#Z#b%Z#b#c#>_#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z*)x#Il_!e$b$h&j#})Lv(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z)[#Jv_al$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z04f#LS^h#)`#P-<U(Up(X!b$m7`OY*gZr*grs'}sw*gwx)rx!P*g!P!Q#MO!Q!^*g!^!_#Mt!_!`$ f!`#O*g#P;'S*g;'S;=`+Z<%lO*g(n#MXX$j&j(Up(X!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g(El#M}Z#p(Ch(Up(X!bOY*gZr*grs'}sw*gwx)rx!_*g!_!`#Np!`#O*g#P;'S*g;'S;=`+Z<%lO*g(El#NyX$P(Ch(Up(X!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g(El$ oX#q(Ch(Up(X!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g*)x$!ga#^*!Y$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`0z!`!a$#l!a#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(K[$#w_#i(Cl$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z*)x$%Vag!*r#q(Ch$e#|$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`$&[!`!a$'f!a#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$&g_#q(Ch$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$'qa#p(Ch$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`!a$(v!a#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$)R`#p(Ch$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(Kd$*`a(p(Ct$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!a%Z!a!b$+e!b#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$+p`$h&j#z(Ch(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#`$,}_!z$Ip$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z04f$.X_!Q0,v$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(n$/]Z$h&jO!^$0O!^!_$0f!_#i$0O#i#j$0k#j#l$0O#l#m$2^#m#o$0O#o#p$0f#p;'S$0O;'S;=`$4i<%lO$0O(n$0VT_#S$h&jO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c#S$0kO_#S(n$0p[$h&jO!Q&c!Q![$1f![!^&c!_!c&c!c!i$1f!i#T&c#T#Z$1f#Z#o&c#o#p$3|#p;'S&c;'S;=`&w<%lO&c(n$1kZ$h&jO!Q&c!Q![$2^![!^&c!_!c&c!c!i$2^!i#T&c#T#Z$2^#Z#o&c#p;'S&c;'S;=`&w<%lO&c(n$2cZ$h&jO!Q&c!Q![$3U![!^&c!_!c&c!c!i$3U!i#T&c#T#Z$3U#Z#o&c#p;'S&c;'S;=`&w<%lO&c(n$3ZZ$h&jO!Q&c!Q![$0O![!^&c!_!c&c!c!i$0O!i#T&c#T#Z$0O#Z#o&c#p;'S&c;'S;=`&w<%lO&c#S$4PR!Q![$4Y!c!i$4Y#T#Z$4Y#S$4]S!Q![$4Y!c!i$4Y#T#Z$4Y#q#r$0f(n$4lP;=`<%l$0O#1[$4z_!W#)l$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$6U`#w(Ch$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z+;p$7c_$h&j(Up(X!b(_+4QOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z07[$8qk$h&j(Up(X!b(R,2j$^#t(c$I[OY%ZYZ&cZr%Zrs&}st%Ztu$8buw%Zwx(rx}%Z}!O$:f!O!Q%Z!Q![$8b![!^%Z!^!_*g!_!c%Z!c!}$8b!}#O%Z#O#P&c#P#R%Z#R#S$8b#S#T%Z#T#o$8b#o#p*g#p$g%Z$g;'S$8b;'S;=`$<l<%lO$8b+d$:qk$h&j(Up(X!b$^#tOY%ZYZ&cZr%Zrs&}st%Ztu$:fuw%Zwx(rx}%Z}!O$:f!O!Q%Z!Q![$:f![!^%Z!^!_*g!_!c%Z!c!}$:f!}#O%Z#O#P&c#P#R%Z#R#S$:f#S#T%Z#T#o$:f#o#p*g#p$g%Z$g;'S$:f;'S;=`$<f<%lO$:f+d$<iP;=`<%l$:f07[$<oP;=`<%l$8b#Jf$<{X!]#Hb(Up(X!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g,#x$=sa(w+JY$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p#q$+e#q;'S%Z;'S;=`+a<%lO%Z)>v$?V_![(CdtBr$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z?O$@a_!o7`$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z07[$Aq|$h&j(Up(X!b'z0/l$[#t(R,2j(c$I[OX%ZXY+gYZ&cZ[+g[p%Zpq+gqr%Zrs&}st%ZtuEruw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Er![!^%Z!^!_*g!_!c%Z!c!}Er!}#O%Z#O#P&c#P#R%Z#R#SEr#S#T%Z#T#oEr#o#p*g#p$f%Z$f$g+g$g#BYEr#BY#BZ$A`#BZ$ISEr$IS$I_$A`$I_$JTEr$JT$JU$A`$JU$KVEr$KV$KW$A`$KW&FUEr&FU&FV$A`&FV;'SEr;'S;=`I|<%l?HTEr?HT?HU$A`?HUOEr07[$D|k$h&j(Up(X!b'{0/l$[#t(R,2j(c$I[OY%ZYZ&cZr%Zrs&}st%ZtuEruw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Er![!^%Z!^!_*g!_!c%Z!c!}Er!}#O%Z#O#P&c#P#R%Z#R#SEr#S#T%Z#T#oEr#o#p*g#p$g%Z$g;'SEr;'S;=`I|<%lOEr",tokenizers:[LK,BK,ZK,WK,2,3,4,5,6,7,8,9,10,11,12,13,14,IK,new p1("$S~RRtu[#O#Pg#S#T#|~_P#o#pb~gOv~~jVO#i!P#i#j!U#j#l!P#l#m!q#m;'S!P;'S;=`#v<%lO!P~!UO!S~~!XS!Q![!e!c!i!e#T#Z!e#o#p#Z~!hR!Q![!q!c!i!q#T#Z!q~!tR!Q![!}!c!i!}#T#Z!}~#QR!Q![!P!c!i!P#T#Z!P~#^R!Q![#g!c!i#g#T#Z#g~#jS!Q![#g!c!i#g#T#Z#g#q#r!P~#yP;=`<%l!P~$RO(a~~",141,338),new p1("j~RQYZXz{^~^O(O~~aP!P!Qd~iO(P~~",25,321)],topRules:{Script:[0,7],SingleExpression:[1,274],SingleClassItem:[2,275]},dialects:{jsx:0,ts:15091},dynamicPrecedences:{78:1,80:1,92:1,168:1,198:1},specialized:[{term:325,get:r=>XK[r]||-1},{term:341,get:r=>VK[r]||-1},{term:93,get:r=>qK[r]||-1}],tokenPrec:15116}),zK=1024;let GK=0,rm=class{constructor(e,t){this.from=e,this.to=t}},nr=class{constructor(e={}){this.id=GK++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof e!="function"&&(e=Ts.match(e)),t=>{let n=e(t);return n===void 0?null:[this,n]}}};nr.closedBy=new nr({deserialize:r=>r.split(" ")});nr.openedBy=new nr({deserialize:r=>r.split(" ")});nr.group=new nr({deserialize:r=>r.split(" ")});nr.isolate=new nr({deserialize:r=>{if(r&&r!="rtl"&&r!="ltr"&&r!="auto")throw new RangeError("Invalid value for isolate: "+r);return r||"auto"}});nr.contextHash=new nr({perNode:!0});nr.lookAhead=new nr({perNode:!0});nr.mounted=new nr({perNode:!0});let h0=class{constructor(e,t,n){this.tree=e,this.overlay=t,this.parser=n}static get(e){return e&&e.props&&e.props[nr.mounted.id]}};const HK=Object.create(null);let Ts=class WE{constructor(e,t,n,i=0){this.name=e,this.props=t,this.id=n,this.flags=i}static define(e){let t=e.props&&e.props.length?Object.create(null):HK,n=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(e.name==null?8:0),i=new WE(e.name||"",t,e.id,n);if(e.props){for(let s of e.props)if(Array.isArray(s)||(s=s(i)),s){if(s[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");t[s[0].id]=s[1]}}return i}prop(e){return this.props[e.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(e){if(typeof e=="string"){if(this.name==e)return!0;let t=this.prop(nr.group);return t?t.indexOf(e)>-1:!1}return this.id==e}static match(e){let t=Object.create(null);for(let n in e)for(let i of n.split(" "))t[i]=e[n];return n=>{for(let i=n.prop(nr.group),s=-1;s<(i?i.length:0);s++){let a=t[s<0?n.name:i[s]];if(a)return a}}}};Ts.none=new Ts("",Object.create(null),0,8);const Su=new WeakMap,O_=new WeakMap;var Gr;(function(r){r[r.ExcludeBuffers=1]="ExcludeBuffers",r[r.IncludeAnonymous=2]="IncludeAnonymous",r[r.IgnoreMounts=4]="IgnoreMounts",r[r.IgnoreOverlays=8]="IgnoreOverlays"})(Gr||(Gr={}));let ii=class O1{constructor(e,t,n,i,s){if(this.type=e,this.children=t,this.positions=n,this.length=i,this.props=null,s&&s.length){this.props=Object.create(null);for(let[a,o]of s)this.props[typeof a=="number"?a:a.id]=o}}toString(){let e=h0.get(this);if(e&&!e.overlay)return e.tree.toString();let t="";for(let n of this.children){let i=n.toString();i&&(t&&(t+=","),t+=i)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(t.length?"("+t+")":""):t}cursor(e=0){return new v1(this.topNode,e)}cursorAt(e,t=0,n=0){let i=Su.get(this)||this.topNode,s=new v1(i);return s.moveTo(e,t),Su.set(this,s._tree),s}get topNode(){return new Cs(this,0,0,null)}resolve(e,t=0){let n=ih(Su.get(this)||this.topNode,e,t,!1);return Su.set(this,n),n}resolveInner(e,t=0){let n=ih(O_.get(this)||this.topNode,e,t,!0);return O_.set(this,n),n}resolveStack(e,t=0){return eJ(this,e,t)}iterate(e){let{enter:t,leave:n,from:i=0,to:s=this.length}=e,a=e.mode||0,o=(a&Gr.IncludeAnonymous)>0;for(let l=this.cursor(a|Gr.IncludeAnonymous);;){let f=!1;if(l.from<=s&&l.to>=i&&(!o&&l.type.isAnonymous||t(l)!==!1)){if(l.firstChild())continue;f=!0}for(;f&&n&&(o||!l.type.isAnonymous)&&n(l),!l.nextSibling();){if(!l.parent())return;f=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let t in this.props)e.push([+t,this.props[t]]);return e}balance(e={}){return this.children.length<=8?this:qx(Ts.none,this.children,this.positions,0,this.children.length,0,this.length,(t,n,i)=>new O1(this.type,t,n,i,this.propValues),e.makeTree||((t,n,i)=>new O1(Ts.none,t,n,i)))}static build(e){return tJ(e)}};ii.empty=new ii(Ts.none,[],[],0);let YK=class UE{constructor(e,t){this.buffer=e,this.index=t}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new UE(this.buffer,this.index)}},Gl=class XE{constructor(e,t,n){this.buffer=e,this.length=t,this.set=n}get type(){return Ts.none}toString(){let e=[];for(let t=0;t<this.buffer.length;)e.push(this.childString(t)),t=this.buffer[t+3];return e.join(",")}childString(e){let t=this.buffer[e],n=this.buffer[e+3],i=this.set.types[t],s=i.name;if(/\W/.test(s)&&!i.isError&&(s=JSON.stringify(s)),e+=4,n==e)return s;let a=[];for(;e<n;)a.push(this.childString(e)),e=this.buffer[e+3];return s+"("+a.join(",")+")"}findChild(e,t,n,i,s){let{buffer:a}=this,o=-1;for(let l=e;l!=t&&!(VE(s,i,a[l+1],a[l+2])&&(o=l,n>0));l=a[l+3]);return o}slice(e,t,n){let i=this.buffer,s=new Uint16Array(t-e),a=0;for(let o=e,l=0;o<t;){s[l++]=i[o++],s[l++]=i[o++]-n;let f=s[l++]=i[o++]-n;s[l++]=i[o++]-e,a=Math.max(a,f)}return new XE(s,a,this.set)}};function VE(r,e,t,n){switch(r){case-2:return t<e;case-1:return n>=e&&t<e;case 0:return t<e&&n>e;case 1:return t<=e&&n>e;case 2:return n>e;case 4:return!0}}function ih(r,e,t,n){for(var i;r.from==r.to||(t<1?r.from>=e:r.from>e)||(t>-1?r.to<=e:r.to<e);){let a=!n&&r instanceof Cs&&r.index<0?null:r.parent;if(!a)return r;r=a}let s=n?0:Gr.IgnoreOverlays;if(n)for(let a=r,o=a.parent;o;a=o,o=a.parent)a instanceof Cs&&a.index<0&&((i=o.enter(e,t,s))===null||i===void 0?void 0:i.from)!=a.from&&(r=o);for(;;){let a=r.enter(e,t,s);if(!a)return r;r=a}}let qE=class{cursor(e=0){return new v1(this,e)}getChild(e,t=null,n=null){let i=x_(this,e,t,n);return i.length?i[0]:null}getChildren(e,t=null,n=null){return x_(this,e,t,n)}resolve(e,t=0){return ih(this,e,t,!1)}resolveInner(e,t=0){return ih(this,e,t,!0)}matchContext(e){return x1(this.parent,e)}enterUnfinishedNodesBefore(e){let t=this.childBefore(e),n=this;for(;t;){let i=t.lastChild;if(!i||i.to!=t.to)break;i.type.isError&&i.from==i.to?(n=t,t=i.prevSibling):t=i}return n}get node(){return this}get next(){return this.parent}},Cs=class rd extends qE{constructor(e,t,n,i){super(),this._tree=e,this.from=t,this.index=n,this._parent=i}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,t,n,i,s=0){for(let a=this;;){for(let{children:o,positions:l}=a._tree,f=t>0?o.length:-1;e!=f;e+=t){let c=o[e],h=l[e]+a.from;if(VE(i,n,h,h+c.length)){if(c instanceof Gl){if(s&Gr.ExcludeBuffers)continue;let u=c.findChild(0,c.buffer.length,t,n-h,i);if(u>-1)return new sh(new KK(a,c,e,h),null,u)}else if(s&Gr.IncludeAnonymous||!c.type.isAnonymous||Vx(c)){let u;if(!(s&Gr.IgnoreMounts)&&(u=h0.get(c))&&!u.overlay)return new rd(u.tree,h,e,a);let d=new rd(c,h,e,a);return s&Gr.IncludeAnonymous||!d.type.isAnonymous?d:d.nextChild(t<0?c.children.length-1:0,t,n,i)}}}if(s&Gr.IncludeAnonymous||!a.type.isAnonymous||(a.index>=0?e=a.index+t:e=t<0?-1:a._parent._tree.children.length,a=a._parent,!a))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}enter(e,t,n=0){let i;if(!(n&Gr.IgnoreOverlays)&&(i=h0.get(this._tree))&&i.overlay){let s=e-this.from;for(let{from:a,to:o}of i.overlay)if((t>0?a<=s:a<s)&&(t<0?o>=s:o>s))return new rd(i.tree,i.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,t,n)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}};function x_(r,e,t,n){let i=r.cursor(),s=[];if(!i.firstChild())return s;if(t!=null){for(let a=!1;!a;)if(a=i.type.is(t),!i.nextSibling())return s}for(;;){if(n!=null&&i.type.is(n))return s;if(i.type.is(e)&&s.push(i.node),!i.nextSibling())return n==null?s:[]}}function x1(r,e,t=e.length-1){for(let n=r;t>=0;n=n.parent){if(!n)return!1;if(!n.type.isAnonymous){if(e[t]&&e[t]!=n.name)return!1;t--}}return!0}let KK=class{constructor(e,t,n,i){this.parent=e,this.buffer=t,this.index=n,this.start=i}},sh=class tc extends qE{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(e,t,n){super(),this.context=e,this._parent=t,this.index=n,this.type=e.buffer.set.types[e.buffer.buffer[n]]}child(e,t,n){let{buffer:i}=this.context,s=i.findChild(this.index+4,i.buffer[this.index+3],e,t-this.context.start,n);return s<0?null:new tc(this.context,this,s)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}enter(e,t,n=0){if(n&Gr.ExcludeBuffers)return null;let{buffer:i}=this.context,s=i.findChild(this.index+4,i.buffer[this.index+3],t>0?1:-1,e-this.context.start,t);return s<0?null:new tc(this.context,this,s)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,t=e.buffer[this.index+3];return t<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new tc(this.context,this._parent,t):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,t=this._parent?this._parent.index+4:0;return this.index==t?this.externalSibling(-1):new tc(this.context,this._parent,e.findChild(t,this.index,-1,0,4))}get tree(){return null}toTree(){let e=[],t=[],{buffer:n}=this.context,i=this.index+4,s=n.buffer[this.index+3];if(s>i){let a=n.buffer[this.index+1];e.push(n.slice(i,s,a)),t.push(0)}return new ii(this.type,e,t,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}};function jE(r){if(!r.length)return null;let e=0,t=r[0];for(let s=1;s<r.length;s++){let a=r[s];(a.from>t.from||a.to<t.to)&&(t=a,e=s)}let n=t instanceof Cs&&t.index<0?null:t.parent,i=r.slice();return n?i[e]=n:i.splice(e,1),new JK(i,t)}let JK=class{constructor(e,t){this.heads=e,this.node=t}get next(){return jE(this.heads)}};function eJ(r,e,t){let n=r.resolveInner(e,t),i=null;for(let s=n instanceof Cs?n:n.context.parent;s;s=s.parent)if(s.index<0){let a=s.parent;(i||(i=[n])).push(a.resolve(e,t)),s=a}else{let a=h0.get(s.tree);if(a&&a.overlay&&a.overlay[0].from<=e&&a.overlay[a.overlay.length-1].to>=e){let o=new Cs(a.tree,a.overlay[0].from+s.from,-1,s);(i||(i=[n])).push(ih(o,e,t,!1))}}return i?jE(i):n}let v1=class{get name(){return this.type.name}constructor(e,t=0){if(this.mode=t,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,e instanceof Cs)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let n=e._parent;n;n=n._parent)this.stack.unshift(n.index);this.bufferNode=e,this.yieldBuf(e.index)}}yieldNode(e){return e?(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0):!1}yieldBuf(e,t){this.index=e;let{start:n,buffer:i}=this.buffer;return this.type=t||i.set.types[i.buffer[e]],this.from=n+i.buffer[e+1],this.to=n+i.buffer[e+2],!0}yield(e){return e?e instanceof Cs?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,t,n){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,t,n,this.mode));let{buffer:i}=this.buffer,s=i.findChild(this.index+4,i.buffer[this.index+3],e,t-this.buffer.start,n);return s<0?!1:(this.stack.push(this.index),this.yieldBuf(s))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,t,n=this.mode){return this.buffer?n&Gr.ExcludeBuffers?!1:this.enterChild(1,e,t):this.yield(this._tree.enter(e,t,n))}parent(){if(!this.buffer)return this.yieldNode(this.mode&Gr.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&Gr.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode)):!1;let{buffer:t}=this.buffer,n=this.stack.length-1;if(e<0){let i=n<0?0:this.stack[n]+4;if(this.index!=i)return this.yieldBuf(t.findChild(i,this.index,-1,0,4))}else{let i=t.buffer[this.index+3];if(i<(n<0?t.buffer.length:t.buffer[this.stack[n]+3]))return this.yieldBuf(i)}return n<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let t,n,{buffer:i}=this;if(i){if(e>0){if(this.index<i.buffer.buffer.length)return!1}else for(let s=0;s<this.index;s++)if(i.buffer.buffer[s+3]<this.index)return!1;({index:t,parent:n}=i)}else({index:t,_parent:n}=this._tree);for(;n;{index:t,_parent:n}=n)if(t>-1)for(let s=t+e,a=e<0?-1:n._tree.children.length;s!=a;s+=e){let o=n._tree.children[s];if(this.mode&Gr.IncludeAnonymous||o instanceof Gl||!o.type.isAnonymous||Vx(o))return!1}return!0}move(e,t){if(t&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,t=0){for(;(this.from==this.to||(t<1?this.from>=e:this.from>e)||(t>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,t););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,t=null,n=0;if(e&&e.context==this.buffer)e:for(let i=this.index,s=this.stack.length;s>=0;){for(let a=e;a;a=a._parent)if(a.index==i){if(i==this.index)return a;t=a,n=s+1;break e}i=this.stack[--s]}for(let i=n;i<this.stack.length;i++)t=new sh(this.buffer,t,this.stack[i]);return this.bufferNode=new sh(this.buffer,t,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,t){for(let n=0;;){let i=!1;if(this.type.isAnonymous||e(this)!==!1){if(this.firstChild()){n++;continue}this.type.isAnonymous||(i=!0)}for(;;){if(i&&t&&t(this),i=this.type.isAnonymous,!n)return;if(this.nextSibling())break;this.parent(),n--,i=!0}}}matchContext(e){if(!this.buffer)return x1(this.node.parent,e);let{buffer:t}=this.buffer,{types:n}=t.set;for(let i=e.length-1,s=this.stack.length-1;i>=0;s--){if(s<0)return x1(this._tree,e,i);let a=n[t.buffer[this.stack[s]]];if(!a.isAnonymous){if(e[i]&&e[i]!=a.name)return!1;i--}}return!0}};function Vx(r){return r.children.some(e=>e instanceof Gl||!e.type.isAnonymous||Vx(e))}function tJ(r){var e;let{buffer:t,nodeSet:n,maxBufferLength:i=zK,reused:s=[],minRepeatType:a=n.types.length}=r,o=Array.isArray(t)?new YK(t,t.length):t,l=n.types,f=0,c=0;function h(y,b,O,T,k,Q){let{id:A,start:_,end:N,size:U}=o,z=c,K=f;for(;U<0;)if(o.next(),U==-1){let ae=s[A];O.push(ae),T.push(_-y);return}else if(U==-3){f=A;return}else if(U==-4){c=A;return}else throw new RangeError(`Unrecognized record size: ${U}`);let re=l[A],ge,V,he=_-y;if(N-_<=i&&(V=g(o.pos-b,k))){let ae=new Uint16Array(V.size-V.skip),E=o.pos-V.size,L=ae.length;for(;o.pos>E;)L=v(V.start,ae,L);ge=new Gl(ae,N-V.start,n),he=V.start-y}else{let ae=o.pos-U;o.next();let E=[],L=[],I=A>=a?A:-1,Z=0,ee=N;for(;o.pos>ae;)I>=0&&o.id==I&&o.size>=0?(o.end<=ee-i&&(p(E,L,_,Z,o.end,ee,I,z,K),Z=E.length,ee=o.end),o.next()):Q>2500?u(_,ae,E,L):h(_,ae,E,L,I,Q+1);if(I>=0&&Z>0&&Z<E.length&&p(E,L,_,Z,_,ee,I,z,K),E.reverse(),L.reverse(),I>-1&&Z>0){let ne=d(re,K);ge=qx(re,E,L,0,E.length,0,N-_,ne,ne)}else ge=m(re,E,L,N-_,z-N,K)}O.push(ge),T.push(he)}function u(y,b,O,T){let k=[],Q=0,A=-1;for(;o.pos>b;){let{id:_,start:N,end:U,size:z}=o;if(z>4)o.next();else{if(A>-1&&N<A)break;A<0&&(A=U-i),k.push(_,N,U),Q++,o.next()}}if(Q){let _=new Uint16Array(Q*4),N=k[k.length-2];for(let U=k.length-3,z=0;U>=0;U-=3)_[z++]=k[U],_[z++]=k[U+1]-N,_[z++]=k[U+2]-N,_[z++]=z;O.push(new Gl(_,k[2]-N,n)),T.push(N-y)}}function d(y,b){return(O,T,k)=>{let Q=0,A=O.length-1,_,N;if(A>=0&&(_=O[A])instanceof ii){if(!A&&_.type==y&&_.length==k)return _;(N=_.prop(nr.lookAhead))&&(Q=T[A]+_.length+N)}return m(y,O,T,k,Q,b)}}function p(y,b,O,T,k,Q,A,_,N){let U=[],z=[];for(;y.length>T;)U.push(y.pop()),z.push(b.pop()+O-k);y.push(m(n.types[A],U,z,Q-k,_-Q,N)),b.push(k-O)}function m(y,b,O,T,k,Q,A){if(Q){let _=[nr.contextHash,Q];A=A?[_].concat(A):[_]}if(k>25){let _=[nr.lookAhead,k];A=A?[_].concat(A):[_]}return new ii(y,b,O,T,A)}function g(y,b){let O=o.fork(),T=0,k=0,Q=0,A=O.end-i,_={size:0,start:0,skip:0};e:for(let N=O.pos-y;O.pos>N;){let U=O.size;if(O.id==b&&U>=0){_.size=T,_.start=k,_.skip=Q,Q+=4,T+=4,O.next();continue}let z=O.pos-U;if(U<0||z<N||O.start<A)break;let K=O.id>=a?4:0,re=O.start;for(O.next();O.pos>z;){if(O.size<0)if(O.size==-3)K+=4;else break e;else O.id>=a&&(K+=4);O.next()}k=re,T+=U,Q+=K}return(b<0||T==y)&&(_.size=T,_.start=k,_.skip=Q),_.size>4?_:void 0}function v(y,b,O){let{id:T,start:k,end:Q,size:A}=o;if(o.next(),A>=0&&T<a){let _=O;if(A>4){let N=o.pos-(A-4);for(;o.pos>N;)O=v(y,b,O)}b[--O]=_,b[--O]=Q-y,b[--O]=k-y,b[--O]=T}else A==-3?f=T:A==-4&&(c=T);return O}let w=[],x=[];for(;o.pos>0;)h(r.start||0,r.bufferStart||0,w,x,-1,0);let S=(e=r.length)!==null&&e!==void 0?e:w.length?x[0]+w[0].length:0;return new ii(l[r.topID],w.reverse(),x.reverse(),S)}const v_=new WeakMap;function nd(r,e){if(!r.isAnonymous||e instanceof Gl||e.type!=r)return 1;let t=v_.get(e);if(t==null){t=1;for(let n of e.children){if(n.type!=r||!(n instanceof ii)){t=1;break}t+=nd(r,n)}v_.set(e,t)}return t}function qx(r,e,t,n,i,s,a,o,l){let f=0;for(let p=n;p<i;p++)f+=nd(r,e[p]);let c=Math.ceil(f*1.5/8),h=[],u=[];function d(p,m,g,v,w){for(let x=g;x<v;){let S=x,y=m[x],b=nd(r,p[x]);for(x++;x<v;x++){let O=nd(r,p[x]);if(b+O>=c)break;b+=O}if(x==S+1){if(b>c){let O=p[S];d(O.children,O.positions,0,O.children.length,m[S]+w);continue}h.push(p[S])}else{let O=m[x-1]+p[x-1].length-y;h.push(qx(r,p,m,S,x,y,O,null,l))}u.push(y+w-s)}}return d(e,t,n,i,0),(o||l)(h,u,a)}class rJ{constructor(){this.map=new WeakMap}setBuffer(e,t,n){let i=this.map.get(e);i||this.map.set(e,i=new Map),i.set(t,n)}getBuffer(e,t){let n=this.map.get(e);return n&&n.get(t)}set(e,t){e instanceof sh?this.setBuffer(e.context.buffer,e.index,t):e instanceof Cs&&this.map.set(e.tree,t)}get(e){return e instanceof sh?this.getBuffer(e.context.buffer,e.index):e instanceof Cs?this.map.get(e.tree):void 0}cursorSet(e,t){e.buffer?this.setBuffer(e.buffer.buffer,e.index,t):this.map.set(e.tree,t)}cursorGet(e){return e.buffer?this.getBuffer(e.buffer.buffer,e.index):this.map.get(e.tree)}}let id=class y1{constructor(e,t,n,i,s=!1,a=!1){this.from=e,this.to=t,this.tree=n,this.offset=i,this.open=(s?1:0)|(a?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(e,t=[],n=!1){let i=[new y1(0,e.length,e,0,!1,n)];for(let s of t)s.to>e.length&&i.push(s);return i}static applyChanges(e,t,n=128){if(!t.length)return e;let i=[],s=1,a=e.length?e[0]:null;for(let o=0,l=0,f=0;;o++){let c=o<t.length?t[o]:null,h=c?c.fromA:1e9;if(h-l>=n)for(;a&&a.from<h;){let u=a;if(l>=u.from||h<=u.to||f){let d=Math.max(u.from,l)-f,p=Math.min(u.to,h)-f;u=d>=p?null:new y1(d,p,u.tree,u.offset+f,o>0,!!c)}if(u&&i.push(u),a.to>h)break;a=s<e.length?e[s++]:null}if(!c)break;l=c.toA,f=c.toA-c.toB}return i}},nJ=class{startParse(e,t,n){return typeof e=="string"&&(e=new iJ(e)),n=n?n.length?n.map(i=>new rm(i.from,i.to)):[new rm(0,0)]:[new rm(0,e.length)],this.createParse(e,t||[],n)}parse(e,t,n){let i=this.startParse(e,t,n);for(;;){let s=i.advance();if(s)return s}}},iJ=class{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,t){return this.string.slice(e,t)}};new nr({perNode:!0});var nm;const gl=new nr;function zE(r){return Le.define({combine:r?e=>e.concat(r):void 0})}const jx=new nr;let Zi=class{constructor(e,t,n=[],i=""){this.data=e,this.name=i,lt.prototype.hasOwnProperty("tree")||Object.defineProperty(lt.prototype,"tree",{get(){return Hl(this)}}),this.parser=t,this.extension=[Yl.of(this),lt.languageData.of((s,a,o)=>{let l=y_(s,a,o),f=l.type.prop(gl);if(!f)return[];let c=s.facet(f),h=l.type.prop(jx);if(h){let u=l.resolve(a-l.from,o);for(let d of h)if(d.test(u,s)){let p=s.facet(d.facet);return d.type=="replace"?p:p.concat(c)}}return c})].concat(n)}isActiveAt(e,t,n=-1){return y_(e,t,n).type.prop(gl)==this.data}findRegions(e){let t=e.facet(Yl);if((t==null?void 0:t.data)==this.data)return[{from:0,to:e.doc.length}];if(!t||!t.allowsNesting)return[];let n=[],i=(s,a)=>{if(s.prop(gl)==this.data){n.push({from:a,to:a+s.length});return}let o=s.prop(nr.mounted);if(o){if(o.tree.prop(gl)==this.data){if(o.overlay)for(let l of o.overlay)n.push({from:l.from+a,to:l.to+a});else n.push({from:a,to:a+s.length});return}else if(o.overlay){let l=n.length;if(i(o.tree,o.overlay[0].from+a),n.length>l)return}}for(let l=0;l<s.children.length;l++){let f=s.children[l];f instanceof ii&&i(f,s.positions[l]+a)}};return i(Hl(e),0),n}get allowsNesting(){return!0}};Zi.setState=ot.define();function y_(r,e,t){let n=r.facet(Yl),i=Hl(r).topNode;if(!n||n.allowsNesting)for(let s=i;s;s=s.enter(e,t,Gr.ExcludeBuffers))s.type.isTop&&(i=s);return i}let sJ=class w1 extends Zi{constructor(e,t,n){super(e,t,[],n),this.parser=t}static define(e){let t=zE(e.languageData);return new w1(t,e.parser.configure({props:[gl.add(n=>n.isTop?t:void 0)]}),e.name)}configure(e,t){return new w1(this.data,this.parser.configure(e),t||this.name)}get allowsNesting(){return this.parser.hasWrappers()}};function Hl(r){let e=r.field(Zi.state,!1);return e?e.tree:ii.empty}let aJ=class{constructor(e){this.doc=e,this.cursorPos=0,this.string="",this.cursor=e.iter()}get length(){return this.doc.length}syncTo(e){return this.string=this.cursor.next(e-this.cursorPos).value,this.cursorPos=e+this.string.length,this.cursorPos-this.string.length}chunk(e){return this.syncTo(e),this.string}get lineChunks(){return!0}read(e,t){let n=this.cursorPos-this.string.length;return e<n||t>=this.cursorPos?this.doc.sliceString(e,t):this.string.slice(e-n,t-n)}},Qf=null,oJ=class b1{constructor(e,t,n=[],i,s,a,o,l){this.parser=e,this.state=t,this.fragments=n,this.tree=i,this.treeLen=s,this.viewport=a,this.skipped=o,this.scheduleOn=l,this.parse=null,this.tempSkipped=[]}static create(e,t,n){return new b1(e,t,[],ii.empty,0,n,[],null)}startParse(){return this.parser.startParse(new aJ(this.state.doc),this.fragments)}work(e,t){return t!=null&&t>=this.state.doc.length&&(t=void 0),this.tree!=ii.empty&&this.isDone(t??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var n;if(typeof e=="number"){let i=Date.now()+e;e=()=>Date.now()>i}for(this.parse||(this.parse=this.startParse()),t!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>t)&&t<this.state.doc.length&&this.parse.stopAt(t);;){let i=this.parse.advance();if(i)if(this.fragments=this.withoutTempSkipped(id.addTree(i,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(n=this.parse.stoppedAt)!==null&&n!==void 0?n:this.state.doc.length,this.tree=i,this.parse=null,this.treeLen<(t??this.state.doc.length))this.parse=this.startParse();else return!0;if(e())return!1}})}takeTree(){let e,t;this.parse&&(e=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>e)&&this.parse.stopAt(e),this.withContext(()=>{for(;!(t=this.parse.advance()););}),this.treeLen=e,this.tree=t,this.fragments=this.withoutTempSkipped(id.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(e){let t=Qf;Qf=this;try{return e()}finally{Qf=t}}withoutTempSkipped(e){for(let t;t=this.tempSkipped.pop();)e=w_(e,t.from,t.to);return e}changes(e,t){let{fragments:n,tree:i,treeLen:s,viewport:a,skipped:o}=this;if(this.takeTree(),!e.empty){let l=[];if(e.iterChangedRanges((f,c,h,u)=>l.push({fromA:f,toA:c,fromB:h,toB:u})),n=id.applyChanges(n,l),i=ii.empty,s=0,a={from:e.mapPos(a.from,-1),to:e.mapPos(a.to,1)},this.skipped.length){o=[];for(let f of this.skipped){let c=e.mapPos(f.from,1),h=e.mapPos(f.to,-1);c<h&&o.push({from:c,to:h})}}}return new b1(this.parser,t,n,i,s,a,o,this.scheduleOn)}updateViewport(e){if(this.viewport.from==e.from&&this.viewport.to==e.to)return!1;this.viewport=e;let t=this.skipped.length;for(let n=0;n<this.skipped.length;n++){let{from:i,to:s}=this.skipped[n];i<e.to&&s>e.from&&(this.fragments=w_(this.fragments,i,s),this.skipped.splice(n--,1))}return this.skipped.length>=t?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(e,t){this.skipped.push({from:e,to:t})}static getSkippingParser(e){return new class extends nJ{createParse(t,n,i){let s=i[0].from,a=i[i.length-1].to;return{parsedPos:s,advance(){let l=Qf;if(l){for(let f of i)l.tempSkipped.push(f);e&&(l.scheduleOn=l.scheduleOn?Promise.all([l.scheduleOn,e]):e)}return this.parsedPos=a,new ii(Ts.none,[],[],a-s)},stoppedAt:null,stopAt(){}}}}}isDone(e){e=Math.min(e,this.state.doc.length);let t=this.fragments;return this.treeLen>=e&&t.length&&t[0].from==0&&t[0].to>=e}static get(){return Qf}};function w_(r,e,t){return id.applyChanges(r,[{fromA:e,toA:t,fromB:e,toB:t}])}let _1=class k1{constructor(e){this.context=e,this.tree=e.tree}apply(e){if(!e.docChanged&&this.tree==this.context.tree)return this;let t=this.context.changes(e.changes,e.state),n=this.context.treeLen==e.startState.doc.length?void 0:Math.max(e.changes.mapPos(this.context.treeLen),t.viewport.to);return t.work(20,n)||t.takeTree(),new k1(t)}static init(e){let t=Math.min(3e3,e.doc.length),n=oJ.create(e.facet(Yl).parser,e,{from:0,to:t});return n.work(20,t)||n.takeTree(),new k1(n)}};Zi.state=Cr.define({create:_1.init,update(r,e){for(let t of e.effects)if(t.is(Zi.setState))return t.value;return e.startState.facet(Yl)!=e.state.facet(Yl)?_1.init(e.state):r.apply(e)}});let GE=r=>{let e=setTimeout(()=>r(),500);return()=>clearTimeout(e)};typeof requestIdleCallback<"u"&&(GE=r=>{let e=-1,t=setTimeout(()=>{e=requestIdleCallback(r,{timeout:400})},100);return()=>e<0?clearTimeout(t):cancelIdleCallback(e)});const im=typeof navigator<"u"&&(!((nm=navigator.scheduling)===null||nm===void 0)&&nm.isInputPending)?()=>navigator.scheduling.isInputPending():null,lJ=gr.fromClass(class{constructor(e){this.view=e,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(e){let t=this.view.state.field(Zi.state).context;(t.updateViewport(e.view.viewport)||this.view.viewport.to>t.treeLen)&&this.scheduleWork(),(e.docChanged||e.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(t)}scheduleWork(){if(this.working)return;let{state:e}=this.view,t=e.field(Zi.state);(t.tree!=t.context.tree||!t.context.isDone(e.doc.length))&&(this.working=GE(this.work))}work(e){this.working=null;let t=Date.now();if(this.chunkEnd<t&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=t+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:n,viewport:{to:i}}=this.view,s=n.field(Zi.state);if(s.tree==s.context.tree&&s.context.isDone(i+1e5))return;let a=Date.now()+Math.min(this.chunkBudget,100,e&&!im?Math.max(25,e.timeRemaining()-5):1e9),o=s.context.treeLen<i&&n.doc.length>i+1e3,l=s.context.work(()=>im&&im()||Date.now()>a,i+(o?0:1e5));this.chunkBudget-=Date.now()-t,(l||this.chunkBudget<=0)&&(s.context.takeTree(),this.view.dispatch({effects:Zi.setState.of(new _1(s.context))})),this.chunkBudget>0&&!(l&&!o)&&this.scheduleWork(),this.checkAsyncSchedule(s.context)}checkAsyncSchedule(e){e.scheduleOn&&(this.workScheduled++,e.scheduleOn.then(()=>this.scheduleWork()).catch(t=>Jr(this.view.state,t)).then(()=>this.workScheduled--),e.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),Yl=Le.define({combine(r){return r.length?r[0]:null},enables:r=>[Zi.state,lJ,Be.contentAttributes.compute([r],e=>{let t=e.facet(r);return t&&t.name?{"data-language":t.name}:{}})]});let fJ=class{constructor(e,t=[]){this.language=e,this.support=t,this.extension=[e,t]}};const cJ=Le.define({combine:r=>{if(!r.length)return"  ";let e=r[0];if(!e||/\S/.test(e)||Array.from(e).some(t=>t!=e[0]))throw new Error("Invalid indent unit: "+JSON.stringify(r[0]));return e}}),hJ=new nr;function uJ(r){let e=r.node,t=e.childAfter(e.from),n=e.lastChild;if(!t)return null;let i=r.options.simulateBreak,s=r.state.doc.lineAt(t.from),a=i==null||i<=s.from?s.to:Math.min(s.to,i);for(let o=t.to;;){let l=e.childAfter(o);if(!l||l==n)return null;if(!l.type.isSkipped){if(l.from>=a)return null;let f=/^ */.exec(s.text.slice(t.to-s.from))[0].length;return{from:t.from,to:t.to+f}}o=l.to}}function dJ({closing:r,align:e=!0,units:t=1}){return n=>pJ(n,e,t,r)}function pJ(r,e,t,n,i){let s=r.textAfter,a=s.match(/^\s*/)[0].length,o=n&&s.slice(a,a+n.length)==n||i==r.pos+a,l=e?uJ(r):null;return l?o?r.column(l.from):r.column(l.to):r.baseIndent+(o?0:r.unit*t)}const mJ=r=>r.baseIndent;function sm({except:r,units:e=1}={}){return t=>{let n=r&&r.test(t.textAfter);return t.baseIndent+(n?0:e*t.unit)}}const gJ=new nr;function OJ(r){let e=r.firstChild,t=r.lastChild;return e&&e.to<t.from?{from:e.to,to:t.type.isError?r.to:t.from}:null}let xJ=class HE{constructor(e,t){this.specs=e;let n;function i(o){let l=Tn.newName();return(n||(n=Object.create(null)))["."+l]=o,l}const s=typeof t.all=="string"?t.all:t.all?i(t.all):void 0,a=t.scope;this.scope=a instanceof Zi?o=>o.prop(gl)==a.data:a?o=>o==a:void 0,this.style=pf(e.map(o=>({tag:o.tag,class:o.class||i(Object.assign({},o,{tag:null}))})),{all:s}).style,this.module=n?new Tn(n):null,this.themeType=t.themeType}static define(e,t){return new HE(e,t||{})}};B.meta,B.link,B.heading,B.emphasis,B.strong,B.strikethrough,B.keyword,B.atom,B.bool,B.url,B.contentSeparator,B.labelName,B.literal,B.inserted,B.string,B.deleted,B.regexp,B.escape,B.string,B.variableName,B.variableName,B.typeName,B.namespace,B.className,B.variableName,B.macroName,B.propertyName,B.comment,B.invalid;const vJ=Object.create(null),b_=[Ts.none],__=[],k_=Object.create(null),yJ=Object.create(null);for(let[r,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])yJ[r]=wJ(vJ,e);function am(r,e){__.indexOf(r)>-1||(__.push(r),console.warn(e))}function wJ(r,e){let t=[];for(let o of e.split(" ")){let l=[];for(let f of o.split(".")){let c=r[f]||B[f];c?typeof c=="function"?l.length?l=l.map(c):am(f,`Modifier ${f} used at start of tag`):l.length?am(f,`Tag ${f} used as modifier`):l=Array.isArray(c)?c:[c]:am(f,`Unknown highlighting tag ${f}`)}for(let f of l)t.push(f)}if(!t.length)return 0;let n=e.replace(/ /g,"_"),i=n+" "+t.map(o=>o.id),s=k_[i];if(s)return s.id;let a=k_[i]=Ts.define({id:b_.length,name:n,props:[sa({[n]:t})]});return b_.push(a),a.id}Rt.RTL,Rt.LTR;function S_(r){let e=Object.keys(r).join(""),t=/\w/.test(e);return t&&(e=e.replace(/\w/g,"")),`[${t?"\\w":""}${e.replace(/[^\w\s]/g,"\\$&")}]`}function bJ(r){let e=Object.create(null),t=Object.create(null);for(let{label:i}of r){e[i[0]]=!0;for(let s=1;s<i.length;s++)t[i[s]]=!0}let n=S_(e)+S_(t)+"*$";return[new RegExp("^"+n),new RegExp(n)]}function _J(r){let e=r.map(i=>typeof i=="string"?{label:i}:i),[t,n]=e.every(i=>/^\w+$/.test(i.label))?[/\w*$/,/\w+$/]:bJ(e);return i=>{let s=i.matchBefore(n);return s||i.explicit?{from:s?s.from:i.pos,options:e,validFor:t}:null}}function kJ(r,e){return t=>{for(let n=Hl(t.state).resolveInner(t.pos,-1);n;n=n.parent){if(r.indexOf(n.name)>-1)return null;if(n.type.isTop)break}return e(t)}}const SJ=Fs.define(),TJ=Be.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'""',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"400px",boxSizing:"border-box",whiteSpace:"pre-line"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:"30px"},".cm-completionInfo.cm-completionInfo-right-narrow":{left:"30px"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"''"}},".cm-completionIcon-class":{"&:after":{content:"''"}},".cm-completionIcon-interface":{"&:after":{content:"''"}},".cm-completionIcon-variable":{"&:after":{content:"''"}},".cm-completionIcon-constant":{"&:after":{content:"''"}},".cm-completionIcon-type":{"&:after":{content:"''"}},".cm-completionIcon-enum":{"&:after":{content:"''"}},".cm-completionIcon-property":{"&:after":{content:"''"}},".cm-completionIcon-keyword":{"&:after":{content:"''"}},".cm-completionIcon-namespace":{"&:after":{content:"''"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}});class CJ{constructor(e,t,n,i){this.field=e,this.line=t,this.from=n,this.to=i}}class zx{constructor(e,t,n){this.field=e,this.from=t,this.to=n}map(e){let t=e.mapPos(this.from,-1,hn.TrackDel),n=e.mapPos(this.to,1,hn.TrackDel);return t==null||n==null?null:new zx(this.field,t,n)}}class Gx{constructor(e,t){this.lines=e,this.fieldPositions=t}instantiate(e,t){let n=[],i=[t],s=e.doc.lineAt(t),a=/^\s*/.exec(s.text)[0];for(let l of this.lines){if(n.length){let f=a,c=/^\t*/.exec(l)[0].length;for(let h=0;h<c;h++)f+=e.facet(cJ);i.push(t+f.length-c),l=f+l.slice(c)}n.push(l),t+=l.length+1}let o=this.fieldPositions.map(l=>new zx(l.field,i[l.line]+l.from,i[l.line]+l.to));return{text:n,ranges:o}}static parse(e){let t=[],n=[],i=[],s;for(let a of e.split(/\r\n?|\n/)){for(;s=/[#$]\{(?:(\d+)(?::([^}]*))?|((?:\\[{}]|[^}])*))\}/.exec(a);){let o=s[1]?+s[1]:null,l=s[2]||s[3]||"",f=-1,c=l.replace(/\\[{}]/g,h=>h[1]);for(let h=0;h<t.length;h++)(o!=null?t[h].seq==o:c&&t[h].name==c)&&(f=h);if(f<0){let h=0;for(;h<t.length&&(o==null||t[h].seq!=null&&t[h].seq<o);)h++;t.splice(h,0,{seq:o,name:c}),f=h;for(let u of i)u.field>=f&&u.field++}i.push(new CJ(f,n.length,s.index,s.index+c.length)),a=a.slice(0,s.index)+l+a.slice(s.index+s[0].length)}a=a.replace(/\\([{}])/g,(o,l,f)=>{for(let c of i)c.line==n.length&&c.from>f&&(c.from--,c.to--);return l}),n.push(a)}return new Gx(n,i)}}let AJ=ze.widget({widget:new class extends ia{toDOM(){let r=document.createElement("span");return r.className="cm-snippetFieldPosition",r}ignoreEvent(){return!1}}}),EJ=ze.mark({class:"cm-snippetField"});class Of{constructor(e,t){this.ranges=e,this.active=t,this.deco=ze.set(e.map(n=>(n.from==n.to?AJ:EJ).range(n.from,n.to)))}map(e){let t=[];for(let n of this.ranges){let i=n.map(e);if(!i)return null;t.push(i)}return new Of(t,this.active)}selectionInsideField(e){return e.ranges.every(t=>this.ranges.some(n=>n.field==this.active&&n.from<=t.from&&n.to>=t.to))}}const Nh=ot.define({map(r,e){return r&&r.map(e)}}),PJ=ot.define(),ah=Cr.define({create(){return null},update(r,e){for(let t of e.effects){if(t.is(Nh))return t.value;if(t.is(PJ)&&r)return new Of(r.ranges,t.value)}return r&&e.docChanged&&(r=r.map(e.changes)),r&&e.selection&&!r.selectionInsideField(e.selection)&&(r=null),r},provide:r=>Be.decorations.from(r,e=>e?e.deco:ze.none)});function Hx(r,e){return xe.create(r.filter(t=>t.field==e).map(t=>xe.range(t.from,t.to)))}function RJ(r){let e=Gx.parse(r);return(t,n,i,s)=>{let{text:a,ranges:o}=e.instantiate(t.state,i),{main:l}=t.state.selection,f={changes:{from:i,to:s==l.from?l.to:s,insert:Nt.of(a)},scrollIntoView:!0,annotations:n?[SJ.of(n),Br.userEvent.of("input.complete")]:void 0};if(o.length&&(f.selection=Hx(o,0)),o.some(c=>c.field>0)){let c=new Of(o,0),h=f.effects=[Nh.of(c)];t.state.field(ah,!1)===void 0&&h.push(ot.appendConfig.of([ah,DJ,MJ,TJ]))}t.dispatch(t.state.update(f))}}function YE(r){return({state:e,dispatch:t})=>{let n=e.field(ah,!1);if(!n||r<0&&n.active==0)return!1;let i=n.active+r,s=r>0&&!n.ranges.some(a=>a.field==i+r);return t(e.update({selection:Hx(n.ranges,i),effects:Nh.of(s?null:new Of(n.ranges,i)),scrollIntoView:!0})),!0}}const QJ=({state:r,dispatch:e})=>r.field(ah,!1)?(e(r.update({effects:Nh.of(null)})),!0):!1,FJ=YE(1),$J=YE(-1),NJ=[{key:"Tab",run:FJ,shift:$J},{key:"Escape",run:QJ}],T_=Le.define({combine(r){return r.length?r[0]:NJ}}),DJ=za.highest(W0.compute([T_],r=>r.facet(T_)));function Bn(r,e){return Object.assign(Object.assign({},e),{apply:RJ(r)})}const MJ=Be.domEventHandlers({mousedown(r,e){let t=e.state.field(ah,!1),n;if(!t||(n=e.posAtCoords({x:r.clientX,y:r.clientY}))==null)return!1;let i=t.ranges.find(s=>s.from<=n&&s.to>=n);return!i||i.field==t.active?!1:(e.dispatch({selection:Hx(t.ranges,i.field),effects:Nh.of(t.ranges.some(s=>s.field>i.field)?new Of(t.ranges,i.field):null),scrollIntoView:!0}),!0)}}),KE=new class extends zs{};KE.startSide=1;KE.endSide=-1;const JE=[Bn("function ${name}(${params}) {\n	${}\n}",{label:"function",detail:"definition",type:"keyword"}),Bn("for (let ${index} = 0; ${index} < ${bound}; ${index}++) {\n	${}\n}",{label:"for",detail:"loop",type:"keyword"}),Bn("for (let ${name} of ${collection}) {\n	${}\n}",{label:"for",detail:"of loop",type:"keyword"}),Bn("do {\n	${}\n} while (${})",{label:"do",detail:"loop",type:"keyword"}),Bn("while (${}) {\n	${}\n}",{label:"while",detail:"loop",type:"keyword"}),Bn(`try {
	\${}
} catch (\${error}) {
	\${}
}`,{label:"try",detail:"/ catch block",type:"keyword"}),Bn("if (${}) {\n	${}\n}",{label:"if",detail:"block",type:"keyword"}),Bn(`if (\${}) {
	\${}
} else {
	\${}
}`,{label:"if",detail:"/ else block",type:"keyword"}),Bn(`class \${name} {
	constructor(\${params}) {
		\${}
	}
}`,{label:"class",detail:"definition",type:"keyword"}),Bn('import {${names}} from "${module}"\n${}',{label:"import",detail:"named",type:"keyword"}),Bn('import ${name} from "${module}"\n${}',{label:"import",detail:"default",type:"keyword"})],IJ=JE.concat([Bn("interface ${name} {\n	${}\n}",{label:"interface",detail:"definition",type:"keyword"}),Bn("type ${name} = ${type}",{label:"type",detail:"definition",type:"keyword"}),Bn("enum ${name} {\n	${}\n}",{label:"enum",detail:"definition",type:"keyword"})]),C_=new rJ,eP=new Set(["Script","Block","FunctionExpression","FunctionDeclaration","ArrowFunction","MethodDeclaration","ForStatement"]);function Ff(r){return(e,t)=>{let n=e.node.getChild("VariableDefinition");return n&&t(n,r),!0}}const LJ=["FunctionDeclaration"],BJ={FunctionDeclaration:Ff("function"),ClassDeclaration:Ff("class"),ClassExpression:()=>!0,EnumDeclaration:Ff("constant"),TypeAliasDeclaration:Ff("type"),NamespaceDeclaration:Ff("namespace"),VariableDefinition(r,e){r.matchContext(LJ)||e(r,"variable")},TypeDefinition(r,e){e(r,"type")},__proto__:null};function tP(r,e){let t=C_.get(e);if(t)return t;let n=[],i=!0;function s(a,o){let l=r.sliceString(a.from,a.to);n.push({label:l,type:o})}return e.cursor(Gr.IncludeAnonymous).iterate(a=>{if(i)i=!1;else if(a.name){let o=BJ[a.name];if(o&&o(a,s)||eP.has(a.name))return!1}else if(a.to-a.from>8192){for(let o of tP(r,a.node))n.push(o);return!1}}),C_.set(e,n),n}const A_=/^[\w$\xa1-\uffff][\w$\d\xa1-\uffff]*$/,rP=["TemplateString","String","RegExp","LineComment","BlockComment","VariableDefinition","TypeDefinition","Label","PropertyDefinition","PropertyName","PrivatePropertyDefinition","PrivatePropertyName",".","?."];function ZJ(r){let e=Hl(r.state).resolveInner(r.pos,-1);if(rP.indexOf(e.name)>-1)return null;let t=e.name=="VariableName"||e.to-e.from<20&&A_.test(r.state.sliceDoc(e.from,e.to));if(!t&&!r.explicit)return null;let n=[];for(let i=e;i;i=i.parent)eP.has(i.name)&&(n=n.concat(tP(r.state.doc,i)));return{options:n,from:t?e.from:r.pos,validFor:A_}}const ko=sJ.define({name:"javascript",parser:jK.configure({props:[hJ.add({IfStatement:sm({except:/^\s*({|else\b)/}),TryStatement:sm({except:/^\s*({|catch\b|finally\b)/}),LabeledStatement:mJ,SwitchBody:r=>{let e=r.textAfter,t=/^\s*\}/.test(e),n=/^\s*(case|default)\b/.test(e);return r.baseIndent+(t?0:n?1:2)*r.unit},Block:dJ({closing:"}"}),ArrowFunction:r=>r.baseIndent+r.unit,"TemplateString BlockComment":()=>null,"Statement Property":sm({except:/^{/}),JSXElement(r){let e=/^\s*<\//.test(r.textAfter);return r.lineIndent(r.node.from)+(e?0:r.unit)},JSXEscape(r){let e=/\s*\}/.test(r.textAfter);return r.lineIndent(r.node.from)+(e?0:r.unit)},"JSXOpenTag JSXSelfClosingTag"(r){return r.column(r.node.from)+r.unit}}),gJ.add({"Block ClassBody SwitchBody EnumBody ObjectExpression ArrayExpression ObjectType":OJ,BlockComment(r){return{from:r.from+2,to:r.to-2}}})]}),languageData:{closeBrackets:{brackets:["(","[","{","'",'"',"`"]},commentTokens:{line:"//",block:{open:"/*",close:"*/"}},indentOnInput:/^\s*(?:case |default:|\{|\}|<\/)$/,wordChars:"$"}}),nP={test:r=>/^JSX/.test(r.name),facet:zE({commentTokens:{block:{open:"{/*",close:"*/}"}}})},WJ=ko.configure({dialect:"ts"},"typescript"),UJ=ko.configure({dialect:"jsx",props:[jx.add(r=>r.isTop?[nP]:void 0)]}),XJ=ko.configure({dialect:"jsx ts",props:[jx.add(r=>r.isTop?[nP]:void 0)]},"typescript");let iP=r=>({label:r,type:"keyword"});const sP="break case const continue default delete export extends false finally in instanceof let new return static super switch this throw true typeof var yield".split(" ").map(iP),VJ=sP.concat(["declare","implements","private","protected","public"].map(iP));function qJ(r={}){let e=r.jsx?r.typescript?XJ:UJ:r.typescript?WJ:ko,t=r.typescript?IJ.concat(VJ):JE.concat(sP);return new fJ(e,[ko.data.of({autocomplete:kJ(rP,_J(t))}),ko.data.of({autocomplete:ZJ}),r.jsx?GJ:[]])}function jJ(r){for(;;){if(r.name=="JSXOpenTag"||r.name=="JSXSelfClosingTag"||r.name=="JSXFragmentTag")return r;if(r.name=="JSXEscape"||!r.parent)return null;r=r.parent}}function E_(r,e,t=r.length){for(let n=e==null?void 0:e.firstChild;n;n=n.nextSibling)if(n.name=="JSXIdentifier"||n.name=="JSXBuiltin"||n.name=="JSXNamespacedName"||n.name=="JSXMemberExpression")return r.sliceString(n.from,Math.min(n.to,t));return""}const zJ=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),GJ=Be.inputHandler.of((r,e,t,n,i)=>{if((zJ?r.composing:r.compositionStarted)||r.state.readOnly||e!=t||n!=">"&&n!="/"||!ko.isActiveAt(r.state,e,-1))return!1;let s=i(),{state:a}=s,o=a.changeByRange(l=>{var f;let{head:c}=l,h=Hl(a).resolveInner(c-1,-1),u;if(h.name=="JSXStartTag"&&(h=h.parent),!(a.doc.sliceString(c-1,c)!=n||h.name=="JSXAttributeValue"&&h.to>c)){if(n==">"&&h.name=="JSXFragmentTag")return{range:l,changes:{from:c,insert:"</>"}};if(n=="/"&&h.name=="JSXStartCloseTag"){let d=h.parent,p=d.parent;if(p&&d.from==c-2&&((u=E_(a.doc,p.firstChild,c))||((f=p.firstChild)===null||f===void 0?void 0:f.name)=="JSXFragmentTag")){let m=`${u}>`;return{range:xe.cursor(c+m.length,-1),changes:{from:c,insert:m}}}}else if(n==">"){let d=jJ(h);if(d&&d.name=="JSXOpenTag"&&!/^\/?>|^<\//.test(a.doc.sliceString(c,c+2))&&(u=E_(a.doc,d,c)))return{range:l,changes:{from:c,insert:`</${u}>`}}}}return{range:l}});return o.changes.empty?!1:(r.dispatch([s,a.update(o,{userEvent:"input.complete",scrollIntoView:!0})]),!0)}),HJ=sa({String:B.string,Number:B.number,"True False":B.bool,PropertyName:B.propertyName,Null:B.null,", :":B.separator,"[ ]":B.squareBracket,"{ }":B.brace}),YJ=Io.deserialize({version:14,states:"$bOVQPOOOOQO'#Cb'#CbOnQPO'#CeOvQPO'#ClOOQO'#Cr'#CrQOQPOOOOQO'#Cg'#CgO}QPO'#CfO!SQPO'#CtOOQO,59P,59PO![QPO,59PO!aQPO'#CuOOQO,59W,59WO!iQPO,59WOVQPO,59QOqQPO'#CmO!nQPO,59`OOQO1G.k1G.kOVQPO'#CnO!vQPO,59aOOQO1G.r1G.rOOQO1G.l1G.lOOQO,59X,59XOOQO-E6k-E6kOOQO,59Y,59YOOQO-E6l-E6l",stateData:"#O~OeOS~OQSORSOSSOTSOWQO_ROgPO~OVXOgUO~O^[O~PVO[^O~O]_OVhX~OVaO~O]bO^iX~O^dO~O]_OVha~O]bO^ia~O",goto:"!kjPPPPPPkPPkqwPPPPk{!RPPP!XP!e!hXSOR^bQWQRf_TVQ_Q`WRg`QcZRicQTOQZRQe^RhbRYQR]R",nodeNames:" JsonText True False Null Number String } { Object Property PropertyName : , ] [ Array",maxTerm:25,nodeProps:[["isolate",-2,6,11,""],["openedBy",7,"{",14,"["],["closedBy",8,"}",15,"]"]],propSources:[HJ],skippedNodes:[0],repeatNodeCount:2,tokenData:"(|~RaXY!WYZ!W]^!Wpq!Wrs!]|}$u}!O$z!Q!R%T!R![&c![!]&t!}#O&y#P#Q'O#Y#Z'T#b#c'r#h#i(Z#o#p(r#q#r(w~!]Oe~~!`Wpq!]qr!]rs!xs#O!]#O#P!}#P;'S!];'S;=`$o<%lO!]~!}Og~~#QXrs!]!P!Q!]#O#P!]#U#V!]#Y#Z!]#b#c!]#f#g!]#h#i!]#i#j#m~#pR!Q![#y!c!i#y#T#Z#y~#|R!Q![$V!c!i$V#T#Z$V~$YR!Q![$c!c!i$c#T#Z$c~$fR!Q![!]!c!i!]#T#Z!]~$rP;=`<%l!]~$zO]~~$}Q!Q!R%T!R![&c~%YRT~!O!P%c!g!h%w#X#Y%w~%fP!Q![%i~%nRT~!Q![%i!g!h%w#X#Y%w~%zR{|&T}!O&T!Q![&Z~&WP!Q![&Z~&`PT~!Q![&Z~&hST~!O!P%c!Q![&c!g!h%w#X#Y%w~&yO[~~'OO_~~'TO^~~'WP#T#U'Z~'^P#`#a'a~'dP#g#h'g~'jP#X#Y'm~'rOR~~'uP#i#j'x~'{P#`#a(O~(RP#`#a(U~(ZOS~~(^P#f#g(a~(dP#i#j(g~(jP#X#Y(m~(rOQ~~(wOW~~(|OV~",tokenizers:[0],topRules:{JsonText:[0,1]},tokenPrec:0}),KJ=1024;let JJ=0,om=class{constructor(e,t){this.from=e,this.to=t}},ir=class{constructor(e={}){this.id=JJ++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof e!="function"&&(e=As.match(e)),t=>{let n=e(t);return n===void 0?null:[this,n]}}};ir.closedBy=new ir({deserialize:r=>r.split(" ")});ir.openedBy=new ir({deserialize:r=>r.split(" ")});ir.group=new ir({deserialize:r=>r.split(" ")});ir.isolate=new ir({deserialize:r=>{if(r&&r!="rtl"&&r!="ltr"&&r!="auto")throw new RangeError("Invalid value for isolate: "+r);return r||"auto"}});ir.contextHash=new ir({perNode:!0});ir.lookAhead=new ir({perNode:!0});ir.mounted=new ir({perNode:!0});let u0=class{constructor(e,t,n){this.tree=e,this.overlay=t,this.parser=n}static get(e){return e&&e.props&&e.props[ir.mounted.id]}};const eee=Object.create(null);let As=class aP{constructor(e,t,n,i=0){this.name=e,this.props=t,this.id=n,this.flags=i}static define(e){let t=e.props&&e.props.length?Object.create(null):eee,n=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(e.name==null?8:0),i=new aP(e.name||"",t,e.id,n);if(e.props){for(let s of e.props)if(Array.isArray(s)||(s=s(i)),s){if(s[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");t[s[0].id]=s[1]}}return i}prop(e){return this.props[e.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(e){if(typeof e=="string"){if(this.name==e)return!0;let t=this.prop(ir.group);return t?t.indexOf(e)>-1:!1}return this.id==e}static match(e){let t=Object.create(null);for(let n in e)for(let i of n.split(" "))t[i]=e[n];return n=>{for(let i=n.prop(ir.group),s=-1;s<(i?i.length:0);s++){let a=t[s<0?n.name:i[s]];if(a)return a}}}};As.none=new As("",Object.create(null),0,8);const Tu=new WeakMap,P_=new WeakMap;var on;(function(r){r[r.ExcludeBuffers=1]="ExcludeBuffers",r[r.IncludeAnonymous=2]="IncludeAnonymous",r[r.IgnoreMounts=4]="IgnoreMounts",r[r.IgnoreOverlays=8]="IgnoreOverlays"})(on||(on={}));let si=class S1{constructor(e,t,n,i,s){if(this.type=e,this.children=t,this.positions=n,this.length=i,this.props=null,s&&s.length){this.props=Object.create(null);for(let[a,o]of s)this.props[typeof a=="number"?a:a.id]=o}}toString(){let e=u0.get(this);if(e&&!e.overlay)return e.tree.toString();let t="";for(let n of this.children){let i=n.toString();i&&(t&&(t+=","),t+=i)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(t.length?"("+t+")":""):t}cursor(e=0){return new A1(this.topNode,e)}cursorAt(e,t=0,n=0){let i=Tu.get(this)||this.topNode,s=new A1(i);return s.moveTo(e,t),Tu.set(this,s._tree),s}get topNode(){return new Wa(this,0,0,null)}resolve(e,t=0){let n=oh(Tu.get(this)||this.topNode,e,t,!1);return Tu.set(this,n),n}resolveInner(e,t=0){let n=oh(P_.get(this)||this.topNode,e,t,!0);return P_.set(this,n),n}resolveStack(e,t=0){return iee(this,e,t)}iterate(e){let{enter:t,leave:n,from:i=0,to:s=this.length}=e,a=e.mode||0,o=(a&on.IncludeAnonymous)>0;for(let l=this.cursor(a|on.IncludeAnonymous);;){let f=!1;if(l.from<=s&&l.to>=i&&(!o&&l.type.isAnonymous||t(l)!==!1)){if(l.firstChild())continue;f=!0}for(;f&&n&&(o||!l.type.isAnonymous)&&n(l),!l.nextSibling();){if(!l.parent())return;f=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let t in this.props)e.push([+t,this.props[t]]);return e}balance(e={}){return this.children.length<=8?this:Kx(As.none,this.children,this.positions,0,this.children.length,0,this.length,(t,n,i)=>new S1(this.type,t,n,i,this.propValues),e.makeTree||((t,n,i)=>new S1(As.none,t,n,i)))}static build(e){return see(e)}};si.empty=new si(As.none,[],[],0);let tee=class oP{constructor(e,t){this.buffer=e,this.index=t}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new oP(this.buffer,this.index)}},Kl=class lP{constructor(e,t,n){this.buffer=e,this.length=t,this.set=n}get type(){return As.none}toString(){let e=[];for(let t=0;t<this.buffer.length;)e.push(this.childString(t)),t=this.buffer[t+3];return e.join(",")}childString(e){let t=this.buffer[e],n=this.buffer[e+3],i=this.set.types[t],s=i.name;if(/\W/.test(s)&&!i.isError&&(s=JSON.stringify(s)),e+=4,n==e)return s;let a=[];for(;e<n;)a.push(this.childString(e)),e=this.buffer[e+3];return s+"("+a.join(",")+")"}findChild(e,t,n,i,s){let{buffer:a}=this,o=-1;for(let l=e;l!=t&&!(fP(s,i,a[l+1],a[l+2])&&(o=l,n>0));l=a[l+3]);return o}slice(e,t,n){let i=this.buffer,s=new Uint16Array(t-e),a=0;for(let o=e,l=0;o<t;){s[l++]=i[o++],s[l++]=i[o++]-n;let f=s[l++]=i[o++]-n;s[l++]=i[o++]-e,a=Math.max(a,f)}return new lP(s,a,this.set)}};function fP(r,e,t,n){switch(r){case-2:return t<e;case-1:return n>=e&&t<e;case 0:return t<e&&n>e;case 1:return t<=e&&n>e;case 2:return n>e;case 4:return!0}}function oh(r,e,t,n){for(var i;r.from==r.to||(t<1?r.from>=e:r.from>e)||(t>-1?r.to<=e:r.to<e);){let a=!n&&r instanceof Wa&&r.index<0?null:r.parent;if(!a)return r;r=a}let s=n?0:on.IgnoreOverlays;if(n)for(let a=r,o=a.parent;o;a=o,o=a.parent)a instanceof Wa&&a.index<0&&((i=o.enter(e,t,s))===null||i===void 0?void 0:i.from)!=a.from&&(r=o);for(;;){let a=r.enter(e,t,s);if(!a)return r;r=a}}let cP=class{cursor(e=0){return new A1(this,e)}getChild(e,t=null,n=null){let i=R_(this,e,t,n);return i.length?i[0]:null}getChildren(e,t=null,n=null){return R_(this,e,t,n)}resolve(e,t=0){return oh(this,e,t,!1)}resolveInner(e,t=0){return oh(this,e,t,!0)}matchContext(e){return T1(this.parent,e)}enterUnfinishedNodesBefore(e){let t=this.childBefore(e),n=this;for(;t;){let i=t.lastChild;if(!i||i.to!=t.to)break;i.type.isError&&i.from==i.to?(n=t,t=i.prevSibling):t=i}return n}get node(){return this}get next(){return this.parent}},Wa=class sd extends cP{constructor(e,t,n,i){super(),this._tree=e,this.from=t,this.index=n,this._parent=i}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,t,n,i,s=0){for(let a=this;;){for(let{children:o,positions:l}=a._tree,f=t>0?o.length:-1;e!=f;e+=t){let c=o[e],h=l[e]+a.from;if(fP(i,n,h,h+c.length)){if(c instanceof Kl){if(s&on.ExcludeBuffers)continue;let u=c.findChild(0,c.buffer.length,t,n-h,i);if(u>-1)return new C1(new ree(a,c,e,h),null,u)}else if(s&on.IncludeAnonymous||!c.type.isAnonymous||Yx(c)){let u;if(!(s&on.IgnoreMounts)&&(u=u0.get(c))&&!u.overlay)return new sd(u.tree,h,e,a);let d=new sd(c,h,e,a);return s&on.IncludeAnonymous||!d.type.isAnonymous?d:d.nextChild(t<0?c.children.length-1:0,t,n,i)}}}if(s&on.IncludeAnonymous||!a.type.isAnonymous||(a.index>=0?e=a.index+t:e=t<0?-1:a._parent._tree.children.length,a=a._parent,!a))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}enter(e,t,n=0){let i;if(!(n&on.IgnoreOverlays)&&(i=u0.get(this._tree))&&i.overlay){let s=e-this.from;for(let{from:a,to:o}of i.overlay)if((t>0?a<=s:a<s)&&(t<0?o>=s:o>s))return new sd(i.tree,i.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,t,n)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}};function R_(r,e,t,n){let i=r.cursor(),s=[];if(!i.firstChild())return s;if(t!=null){for(let a=!1;!a;)if(a=i.type.is(t),!i.nextSibling())return s}for(;;){if(n!=null&&i.type.is(n))return s;if(i.type.is(e)&&s.push(i.node),!i.nextSibling())return n==null?s:[]}}function T1(r,e,t=e.length-1){for(let n=r;t>=0;n=n.parent){if(!n)return!1;if(!n.type.isAnonymous){if(e[t]&&e[t]!=n.name)return!1;t--}}return!0}let ree=class{constructor(e,t,n,i){this.parent=e,this.buffer=t,this.index=n,this.start=i}},C1=class rc extends cP{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(e,t,n){super(),this.context=e,this._parent=t,this.index=n,this.type=e.buffer.set.types[e.buffer.buffer[n]]}child(e,t,n){let{buffer:i}=this.context,s=i.findChild(this.index+4,i.buffer[this.index+3],e,t-this.context.start,n);return s<0?null:new rc(this.context,this,s)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}enter(e,t,n=0){if(n&on.ExcludeBuffers)return null;let{buffer:i}=this.context,s=i.findChild(this.index+4,i.buffer[this.index+3],t>0?1:-1,e-this.context.start,t);return s<0?null:new rc(this.context,this,s)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,t=e.buffer[this.index+3];return t<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new rc(this.context,this._parent,t):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,t=this._parent?this._parent.index+4:0;return this.index==t?this.externalSibling(-1):new rc(this.context,this._parent,e.findChild(t,this.index,-1,0,4))}get tree(){return null}toTree(){let e=[],t=[],{buffer:n}=this.context,i=this.index+4,s=n.buffer[this.index+3];if(s>i){let a=n.buffer[this.index+1];e.push(n.slice(i,s,a)),t.push(0)}return new si(this.type,e,t,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}};function hP(r){if(!r.length)return null;let e=0,t=r[0];for(let s=1;s<r.length;s++){let a=r[s];(a.from>t.from||a.to<t.to)&&(t=a,e=s)}let n=t instanceof Wa&&t.index<0?null:t.parent,i=r.slice();return n?i[e]=n:i.splice(e,1),new nee(i,t)}let nee=class{constructor(e,t){this.heads=e,this.node=t}get next(){return hP(this.heads)}};function iee(r,e,t){let n=r.resolveInner(e,t),i=null;for(let s=n instanceof Wa?n:n.context.parent;s;s=s.parent)if(s.index<0){let a=s.parent;(i||(i=[n])).push(a.resolve(e,t)),s=a}else{let a=u0.get(s.tree);if(a&&a.overlay&&a.overlay[0].from<=e&&a.overlay[a.overlay.length-1].to>=e){let o=new Wa(a.tree,a.overlay[0].from+s.from,-1,s);(i||(i=[n])).push(oh(o,e,t,!1))}}return i?hP(i):n}let A1=class{get name(){return this.type.name}constructor(e,t=0){if(this.mode=t,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,e instanceof Wa)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let n=e._parent;n;n=n._parent)this.stack.unshift(n.index);this.bufferNode=e,this.yieldBuf(e.index)}}yieldNode(e){return e?(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0):!1}yieldBuf(e,t){this.index=e;let{start:n,buffer:i}=this.buffer;return this.type=t||i.set.types[i.buffer[e]],this.from=n+i.buffer[e+1],this.to=n+i.buffer[e+2],!0}yield(e){return e?e instanceof Wa?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,t,n){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,t,n,this.mode));let{buffer:i}=this.buffer,s=i.findChild(this.index+4,i.buffer[this.index+3],e,t-this.buffer.start,n);return s<0?!1:(this.stack.push(this.index),this.yieldBuf(s))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,t,n=this.mode){return this.buffer?n&on.ExcludeBuffers?!1:this.enterChild(1,e,t):this.yield(this._tree.enter(e,t,n))}parent(){if(!this.buffer)return this.yieldNode(this.mode&on.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&on.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode)):!1;let{buffer:t}=this.buffer,n=this.stack.length-1;if(e<0){let i=n<0?0:this.stack[n]+4;if(this.index!=i)return this.yieldBuf(t.findChild(i,this.index,-1,0,4))}else{let i=t.buffer[this.index+3];if(i<(n<0?t.buffer.length:t.buffer[this.stack[n]+3]))return this.yieldBuf(i)}return n<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let t,n,{buffer:i}=this;if(i){if(e>0){if(this.index<i.buffer.buffer.length)return!1}else for(let s=0;s<this.index;s++)if(i.buffer.buffer[s+3]<this.index)return!1;({index:t,parent:n}=i)}else({index:t,_parent:n}=this._tree);for(;n;{index:t,_parent:n}=n)if(t>-1)for(let s=t+e,a=e<0?-1:n._tree.children.length;s!=a;s+=e){let o=n._tree.children[s];if(this.mode&on.IncludeAnonymous||o instanceof Kl||!o.type.isAnonymous||Yx(o))return!1}return!0}move(e,t){if(t&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,t=0){for(;(this.from==this.to||(t<1?this.from>=e:this.from>e)||(t>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,t););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,t=null,n=0;if(e&&e.context==this.buffer)e:for(let i=this.index,s=this.stack.length;s>=0;){for(let a=e;a;a=a._parent)if(a.index==i){if(i==this.index)return a;t=a,n=s+1;break e}i=this.stack[--s]}for(let i=n;i<this.stack.length;i++)t=new C1(this.buffer,t,this.stack[i]);return this.bufferNode=new C1(this.buffer,t,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,t){for(let n=0;;){let i=!1;if(this.type.isAnonymous||e(this)!==!1){if(this.firstChild()){n++;continue}this.type.isAnonymous||(i=!0)}for(;;){if(i&&t&&t(this),i=this.type.isAnonymous,!n)return;if(this.nextSibling())break;this.parent(),n--,i=!0}}}matchContext(e){if(!this.buffer)return T1(this.node.parent,e);let{buffer:t}=this.buffer,{types:n}=t.set;for(let i=e.length-1,s=this.stack.length-1;i>=0;s--){if(s<0)return T1(this._tree,e,i);let a=n[t.buffer[this.stack[s]]];if(!a.isAnonymous){if(e[i]&&e[i]!=a.name)return!1;i--}}return!0}};function Yx(r){return r.children.some(e=>e instanceof Kl||!e.type.isAnonymous||Yx(e))}function see(r){var e;let{buffer:t,nodeSet:n,maxBufferLength:i=KJ,reused:s=[],minRepeatType:a=n.types.length}=r,o=Array.isArray(t)?new tee(t,t.length):t,l=n.types,f=0,c=0;function h(y,b,O,T,k,Q){let{id:A,start:_,end:N,size:U}=o,z=c,K=f;for(;U<0;)if(o.next(),U==-1){let ae=s[A];O.push(ae),T.push(_-y);return}else if(U==-3){f=A;return}else if(U==-4){c=A;return}else throw new RangeError(`Unrecognized record size: ${U}`);let re=l[A],ge,V,he=_-y;if(N-_<=i&&(V=g(o.pos-b,k))){let ae=new Uint16Array(V.size-V.skip),E=o.pos-V.size,L=ae.length;for(;o.pos>E;)L=v(V.start,ae,L);ge=new Kl(ae,N-V.start,n),he=V.start-y}else{let ae=o.pos-U;o.next();let E=[],L=[],I=A>=a?A:-1,Z=0,ee=N;for(;o.pos>ae;)I>=0&&o.id==I&&o.size>=0?(o.end<=ee-i&&(p(E,L,_,Z,o.end,ee,I,z,K),Z=E.length,ee=o.end),o.next()):Q>2500?u(_,ae,E,L):h(_,ae,E,L,I,Q+1);if(I>=0&&Z>0&&Z<E.length&&p(E,L,_,Z,_,ee,I,z,K),E.reverse(),L.reverse(),I>-1&&Z>0){let ne=d(re,K);ge=Kx(re,E,L,0,E.length,0,N-_,ne,ne)}else ge=m(re,E,L,N-_,z-N,K)}O.push(ge),T.push(he)}function u(y,b,O,T){let k=[],Q=0,A=-1;for(;o.pos>b;){let{id:_,start:N,end:U,size:z}=o;if(z>4)o.next();else{if(A>-1&&N<A)break;A<0&&(A=U-i),k.push(_,N,U),Q++,o.next()}}if(Q){let _=new Uint16Array(Q*4),N=k[k.length-2];for(let U=k.length-3,z=0;U>=0;U-=3)_[z++]=k[U],_[z++]=k[U+1]-N,_[z++]=k[U+2]-N,_[z++]=z;O.push(new Kl(_,k[2]-N,n)),T.push(N-y)}}function d(y,b){return(O,T,k)=>{let Q=0,A=O.length-1,_,N;if(A>=0&&(_=O[A])instanceof si){if(!A&&_.type==y&&_.length==k)return _;(N=_.prop(ir.lookAhead))&&(Q=T[A]+_.length+N)}return m(y,O,T,k,Q,b)}}function p(y,b,O,T,k,Q,A,_,N){let U=[],z=[];for(;y.length>T;)U.push(y.pop()),z.push(b.pop()+O-k);y.push(m(n.types[A],U,z,Q-k,_-Q,N)),b.push(k-O)}function m(y,b,O,T,k,Q,A){if(Q){let _=[ir.contextHash,Q];A=A?[_].concat(A):[_]}if(k>25){let _=[ir.lookAhead,k];A=A?[_].concat(A):[_]}return new si(y,b,O,T,A)}function g(y,b){let O=o.fork(),T=0,k=0,Q=0,A=O.end-i,_={size:0,start:0,skip:0};e:for(let N=O.pos-y;O.pos>N;){let U=O.size;if(O.id==b&&U>=0){_.size=T,_.start=k,_.skip=Q,Q+=4,T+=4,O.next();continue}let z=O.pos-U;if(U<0||z<N||O.start<A)break;let K=O.id>=a?4:0,re=O.start;for(O.next();O.pos>z;){if(O.size<0)if(O.size==-3)K+=4;else break e;else O.id>=a&&(K+=4);O.next()}k=re,T+=U,Q+=K}return(b<0||T==y)&&(_.size=T,_.start=k,_.skip=Q),_.size>4?_:void 0}function v(y,b,O){let{id:T,start:k,end:Q,size:A}=o;if(o.next(),A>=0&&T<a){let _=O;if(A>4){let N=o.pos-(A-4);for(;o.pos>N;)O=v(y,b,O)}b[--O]=_,b[--O]=Q-y,b[--O]=k-y,b[--O]=T}else A==-3?f=T:A==-4&&(c=T);return O}let w=[],x=[];for(;o.pos>0;)h(r.start||0,r.bufferStart||0,w,x,-1,0);let S=(e=r.length)!==null&&e!==void 0?e:w.length?x[0]+w[0].length:0;return new si(l[r.topID],w.reverse(),x.reverse(),S)}const Q_=new WeakMap;function ad(r,e){if(!r.isAnonymous||e instanceof Kl||e.type!=r)return 1;let t=Q_.get(e);if(t==null){t=1;for(let n of e.children){if(n.type!=r||!(n instanceof si)){t=1;break}t+=ad(r,n)}Q_.set(e,t)}return t}function Kx(r,e,t,n,i,s,a,o,l){let f=0;for(let p=n;p<i;p++)f+=ad(r,e[p]);let c=Math.ceil(f*1.5/8),h=[],u=[];function d(p,m,g,v,w){for(let x=g;x<v;){let S=x,y=m[x],b=ad(r,p[x]);for(x++;x<v;x++){let O=ad(r,p[x]);if(b+O>=c)break;b+=O}if(x==S+1){if(b>c){let O=p[S];d(O.children,O.positions,0,O.children.length,m[S]+w);continue}h.push(p[S])}else{let O=m[x-1]+p[x-1].length-y;h.push(Kx(r,p,m,S,x,y,O,null,l))}u.push(y+w-s)}}return d(e,t,n,i,0),(o||l)(h,u,a)}let od=class E1{constructor(e,t,n,i,s=!1,a=!1){this.from=e,this.to=t,this.tree=n,this.offset=i,this.open=(s?1:0)|(a?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(e,t=[],n=!1){let i=[new E1(0,e.length,e,0,!1,n)];for(let s of t)s.to>e.length&&i.push(s);return i}static applyChanges(e,t,n=128){if(!t.length)return e;let i=[],s=1,a=e.length?e[0]:null;for(let o=0,l=0,f=0;;o++){let c=o<t.length?t[o]:null,h=c?c.fromA:1e9;if(h-l>=n)for(;a&&a.from<h;){let u=a;if(l>=u.from||h<=u.to||f){let d=Math.max(u.from,l)-f,p=Math.min(u.to,h)-f;u=d>=p?null:new E1(d,p,u.tree,u.offset+f,o>0,!!c)}if(u&&i.push(u),a.to>h)break;a=s<e.length?e[s++]:null}if(!c)break;l=c.toA,f=c.toA-c.toB}return i}},aee=class{startParse(e,t,n){return typeof e=="string"&&(e=new oee(e)),n=n?n.length?n.map(i=>new om(i.from,i.to)):[new om(0,0)]:[new om(0,e.length)],this.createParse(e,t||[],n)}parse(e,t,n){let i=this.startParse(e,t,n);for(;;){let s=i.advance();if(s)return s}}},oee=class{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,t){return this.string.slice(e,t)}};new ir({perNode:!0});var lm;const Ol=new ir;function lee(r){return Le.define({combine:r?e=>e.concat(r):void 0})}const fee=new ir;let Wi=class{constructor(e,t,n=[],i=""){this.data=e,this.name=i,lt.prototype.hasOwnProperty("tree")||Object.defineProperty(lt.prototype,"tree",{get(){return R1(this)}}),this.parser=t,this.extension=[Jl.of(this),lt.languageData.of((s,a,o)=>{let l=F_(s,a,o),f=l.type.prop(Ol);if(!f)return[];let c=s.facet(f),h=l.type.prop(fee);if(h){let u=l.resolve(a-l.from,o);for(let d of h)if(d.test(u,s)){let p=s.facet(d.facet);return d.type=="replace"?p:p.concat(c)}}return c})].concat(n)}isActiveAt(e,t,n=-1){return F_(e,t,n).type.prop(Ol)==this.data}findRegions(e){let t=e.facet(Jl);if((t==null?void 0:t.data)==this.data)return[{from:0,to:e.doc.length}];if(!t||!t.allowsNesting)return[];let n=[],i=(s,a)=>{if(s.prop(Ol)==this.data){n.push({from:a,to:a+s.length});return}let o=s.prop(ir.mounted);if(o){if(o.tree.prop(Ol)==this.data){if(o.overlay)for(let l of o.overlay)n.push({from:l.from+a,to:l.to+a});else n.push({from:a,to:a+s.length});return}else if(o.overlay){let l=n.length;if(i(o.tree,o.overlay[0].from+a),n.length>l)return}}for(let l=0;l<s.children.length;l++){let f=s.children[l];f instanceof si&&i(f,s.positions[l]+a)}};return i(R1(e),0),n}get allowsNesting(){return!0}};Wi.setState=ot.define();function F_(r,e,t){let n=r.facet(Jl),i=R1(r).topNode;if(!n||n.allowsNesting)for(let s=i;s;s=s.enter(e,t,on.ExcludeBuffers))s.type.isTop&&(i=s);return i}let cee=class P1 extends Wi{constructor(e,t,n){super(e,t,[],n),this.parser=t}static define(e){let t=lee(e.languageData);return new P1(t,e.parser.configure({props:[Ol.add(n=>n.isTop?t:void 0)]}),e.name)}configure(e,t){return new P1(this.data,this.parser.configure(e),t||this.name)}get allowsNesting(){return this.parser.hasWrappers()}};function R1(r){let e=r.field(Wi.state,!1);return e?e.tree:si.empty}let hee=class{constructor(e){this.doc=e,this.cursorPos=0,this.string="",this.cursor=e.iter()}get length(){return this.doc.length}syncTo(e){return this.string=this.cursor.next(e-this.cursorPos).value,this.cursorPos=e+this.string.length,this.cursorPos-this.string.length}chunk(e){return this.syncTo(e),this.string}get lineChunks(){return!0}read(e,t){let n=this.cursorPos-this.string.length;return e<n||t>=this.cursorPos?this.doc.sliceString(e,t):this.string.slice(e-n,t-n)}},$f=null,uee=class Q1{constructor(e,t,n=[],i,s,a,o,l){this.parser=e,this.state=t,this.fragments=n,this.tree=i,this.treeLen=s,this.viewport=a,this.skipped=o,this.scheduleOn=l,this.parse=null,this.tempSkipped=[]}static create(e,t,n){return new Q1(e,t,[],si.empty,0,n,[],null)}startParse(){return this.parser.startParse(new hee(this.state.doc),this.fragments)}work(e,t){return t!=null&&t>=this.state.doc.length&&(t=void 0),this.tree!=si.empty&&this.isDone(t??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var n;if(typeof e=="number"){let i=Date.now()+e;e=()=>Date.now()>i}for(this.parse||(this.parse=this.startParse()),t!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>t)&&t<this.state.doc.length&&this.parse.stopAt(t);;){let i=this.parse.advance();if(i)if(this.fragments=this.withoutTempSkipped(od.addTree(i,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(n=this.parse.stoppedAt)!==null&&n!==void 0?n:this.state.doc.length,this.tree=i,this.parse=null,this.treeLen<(t??this.state.doc.length))this.parse=this.startParse();else return!0;if(e())return!1}})}takeTree(){let e,t;this.parse&&(e=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>e)&&this.parse.stopAt(e),this.withContext(()=>{for(;!(t=this.parse.advance()););}),this.treeLen=e,this.tree=t,this.fragments=this.withoutTempSkipped(od.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(e){let t=$f;$f=this;try{return e()}finally{$f=t}}withoutTempSkipped(e){for(let t;t=this.tempSkipped.pop();)e=$_(e,t.from,t.to);return e}changes(e,t){let{fragments:n,tree:i,treeLen:s,viewport:a,skipped:o}=this;if(this.takeTree(),!e.empty){let l=[];if(e.iterChangedRanges((f,c,h,u)=>l.push({fromA:f,toA:c,fromB:h,toB:u})),n=od.applyChanges(n,l),i=si.empty,s=0,a={from:e.mapPos(a.from,-1),to:e.mapPos(a.to,1)},this.skipped.length){o=[];for(let f of this.skipped){let c=e.mapPos(f.from,1),h=e.mapPos(f.to,-1);c<h&&o.push({from:c,to:h})}}}return new Q1(this.parser,t,n,i,s,a,o,this.scheduleOn)}updateViewport(e){if(this.viewport.from==e.from&&this.viewport.to==e.to)return!1;this.viewport=e;let t=this.skipped.length;for(let n=0;n<this.skipped.length;n++){let{from:i,to:s}=this.skipped[n];i<e.to&&s>e.from&&(this.fragments=$_(this.fragments,i,s),this.skipped.splice(n--,1))}return this.skipped.length>=t?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(e,t){this.skipped.push({from:e,to:t})}static getSkippingParser(e){return new class extends aee{createParse(t,n,i){let s=i[0].from,a=i[i.length-1].to;return{parsedPos:s,advance(){let l=$f;if(l){for(let f of i)l.tempSkipped.push(f);e&&(l.scheduleOn=l.scheduleOn?Promise.all([l.scheduleOn,e]):e)}return this.parsedPos=a,new si(As.none,[],[],a-s)},stoppedAt:null,stopAt(){}}}}}isDone(e){e=Math.min(e,this.state.doc.length);let t=this.fragments;return this.treeLen>=e&&t.length&&t[0].from==0&&t[0].to>=e}static get(){return $f}};function $_(r,e,t){return od.applyChanges(r,[{fromA:e,toA:t,fromB:e,toB:t}])}let F1=class $1{constructor(e){this.context=e,this.tree=e.tree}apply(e){if(!e.docChanged&&this.tree==this.context.tree)return this;let t=this.context.changes(e.changes,e.state),n=this.context.treeLen==e.startState.doc.length?void 0:Math.max(e.changes.mapPos(this.context.treeLen),t.viewport.to);return t.work(20,n)||t.takeTree(),new $1(t)}static init(e){let t=Math.min(3e3,e.doc.length),n=uee.create(e.facet(Jl).parser,e,{from:0,to:t});return n.work(20,t)||n.takeTree(),new $1(n)}};Wi.state=Cr.define({create:F1.init,update(r,e){for(let t of e.effects)if(t.is(Wi.setState))return t.value;return e.startState.facet(Jl)!=e.state.facet(Jl)?F1.init(e.state):r.apply(e)}});let uP=r=>{let e=setTimeout(()=>r(),500);return()=>clearTimeout(e)};typeof requestIdleCallback<"u"&&(uP=r=>{let e=-1,t=setTimeout(()=>{e=requestIdleCallback(r,{timeout:400})},100);return()=>e<0?clearTimeout(t):cancelIdleCallback(e)});const fm=typeof navigator<"u"&&(!((lm=navigator.scheduling)===null||lm===void 0)&&lm.isInputPending)?()=>navigator.scheduling.isInputPending():null,dee=gr.fromClass(class{constructor(e){this.view=e,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(e){let t=this.view.state.field(Wi.state).context;(t.updateViewport(e.view.viewport)||this.view.viewport.to>t.treeLen)&&this.scheduleWork(),(e.docChanged||e.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(t)}scheduleWork(){if(this.working)return;let{state:e}=this.view,t=e.field(Wi.state);(t.tree!=t.context.tree||!t.context.isDone(e.doc.length))&&(this.working=uP(this.work))}work(e){this.working=null;let t=Date.now();if(this.chunkEnd<t&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=t+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:n,viewport:{to:i}}=this.view,s=n.field(Wi.state);if(s.tree==s.context.tree&&s.context.isDone(i+1e5))return;let a=Date.now()+Math.min(this.chunkBudget,100,e&&!fm?Math.max(25,e.timeRemaining()-5):1e9),o=s.context.treeLen<i&&n.doc.length>i+1e3,l=s.context.work(()=>fm&&fm()||Date.now()>a,i+(o?0:1e5));this.chunkBudget-=Date.now()-t,(l||this.chunkBudget<=0)&&(s.context.takeTree(),this.view.dispatch({effects:Wi.setState.of(new F1(s.context))})),this.chunkBudget>0&&!(l&&!o)&&this.scheduleWork(),this.checkAsyncSchedule(s.context)}checkAsyncSchedule(e){e.scheduleOn&&(this.workScheduled++,e.scheduleOn.then(()=>this.scheduleWork()).catch(t=>Jr(this.view.state,t)).then(()=>this.workScheduled--),e.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),Jl=Le.define({combine(r){return r.length?r[0]:null},enables:r=>[Wi.state,dee,Be.contentAttributes.compute([r],e=>{let t=e.facet(r);return t&&t.name?{"data-language":t.name}:{}})]});let pee=class{constructor(e,t=[]){this.language=e,this.support=t,this.extension=[e,t]}};const mee=new ir;function N_({except:r,units:e=1}={}){return t=>{let n=r&&r.test(t.textAfter);return t.baseIndent+(n?0:e*t.unit)}}const gee=new ir;function Oee(r){let e=r.firstChild,t=r.lastChild;return e&&e.to<t.from?{from:e.to,to:t.type.isError?r.to:t.from}:null}let xee=class dP{constructor(e,t){this.specs=e;let n;function i(o){let l=Tn.newName();return(n||(n=Object.create(null)))["."+l]=o,l}const s=typeof t.all=="string"?t.all:t.all?i(t.all):void 0,a=t.scope;this.scope=a instanceof Wi?o=>o.prop(Ol)==a.data:a?o=>o==a:void 0,this.style=pf(e.map(o=>({tag:o.tag,class:o.class||i(Object.assign({},o,{tag:null}))})),{all:s}).style,this.module=n?new Tn(n):null,this.themeType=t.themeType}static define(e,t){return new dP(e,t||{})}};B.meta,B.link,B.heading,B.emphasis,B.strong,B.strikethrough,B.keyword,B.atom,B.bool,B.url,B.contentSeparator,B.labelName,B.literal,B.inserted,B.string,B.deleted,B.regexp,B.escape,B.string,B.variableName,B.variableName,B.typeName,B.namespace,B.className,B.variableName,B.macroName,B.propertyName,B.comment,B.invalid;const vee=Object.create(null),D_=[As.none],M_=[],I_=Object.create(null),yee=Object.create(null);for(let[r,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])yee[r]=wee(vee,e);function cm(r,e){M_.indexOf(r)>-1||(M_.push(r),console.warn(e))}function wee(r,e){let t=[];for(let o of e.split(" ")){let l=[];for(let f of o.split(".")){let c=r[f]||B[f];c?typeof c=="function"?l.length?l=l.map(c):cm(f,`Modifier ${f} used at start of tag`):l.length?cm(f,`Tag ${f} used as modifier`):l=Array.isArray(c)?c:[c]:cm(f,`Unknown highlighting tag ${f}`)}for(let f of l)t.push(f)}if(!t.length)return 0;let n=e.replace(/ /g,"_"),i=n+" "+t.map(o=>o.id),s=I_[i];if(s)return s.id;let a=I_[i]=As.define({id:D_.length,name:n,props:[sa({[n]:t})]});return D_.push(a),a.id}Rt.RTL,Rt.LTR;const bee=cee.define({name:"json",parser:YJ.configure({props:[mee.add({Object:N_({except:/^\s*\}/}),Array:N_({except:/^\s*\]/})}),gee.add({"Object Array":Oee})]}),languageData:{closeBrackets:{brackets:["[","{",'"']},indentOnInput:/^\s*[\}\]]$/}});function _ee(){return new pee(bee)}const N1=1,kee=2,See=3,Tee=4,Cee=5,Aee=36,Eee=37,Pee=38,Ree=11,Qee=13;function Fee(r){return r==45||r==46||r==58||r>=65&&r<=90||r==95||r>=97&&r<=122||r>=161}function $ee(r){return r==9||r==10||r==13||r==32}let L_=null,B_=null,Z_=0;function D1(r,e){let t=r.pos+e;if(B_==r&&Z_==t)return L_;for(;$ee(r.peek(e));)e++;let n="";for(;;){let i=r.peek(e);if(!Fee(i))break;n+=String.fromCharCode(i),e++}return B_=r,Z_=t,L_=n||null}function W_(r,e){this.name=r,this.parent=e}const Nee=new BE({start:null,shift(r,e,t,n){return e==N1?new W_(D1(n,1)||"",r):r},reduce(r,e){return e==Ree&&r?r.parent:r},reuse(r,e,t,n){let i=e.type.id;return i==N1||i==Qee?new W_(D1(n,1)||"",r):r},strict:!1}),Dee=new Ha((r,e)=>{if(r.next==60){if(r.advance(),r.next==47){r.advance();let t=D1(r,0);if(!t)return r.acceptToken(Cee);if(e.context&&t==e.context.name)return r.acceptToken(kee);for(let n=e.context;n;n=n.parent)if(n.name==t)return r.acceptToken(See,-2);r.acceptToken(Tee)}else if(r.next!=33&&r.next!=63)return r.acceptToken(N1)}},{contextual:!0});function Jx(r,e){return new Ha(t=>{let n=0,i=e.charCodeAt(0);e:for(;!(t.next<0);t.advance(),n++)if(t.next==i){for(let s=1;s<e.length;s++)if(t.peek(s)!=e.charCodeAt(s))continue e;break}n&&t.acceptToken(r)})}const Mee=Jx(Aee,"-->"),Iee=Jx(Eee,"?>"),Lee=Jx(Pee,"]]>"),Bee=sa({Text:B.content,"StartTag StartCloseTag EndTag SelfCloseEndTag":B.angleBracket,TagName:B.tagName,"MismatchedCloseTag/TagName":[B.tagName,B.invalid],AttributeName:B.attributeName,AttributeValue:B.attributeValue,Is:B.definitionOperator,"EntityReference CharacterReference":B.character,Comment:B.blockComment,ProcessingInst:B.processingInstruction,DoctypeDecl:B.documentMeta,Cdata:B.special(B.string)}),Zee=Io.deserialize({version:14,states:",lOQOaOOOrOxO'#CfOzOpO'#CiO!tOaO'#CgOOOP'#Cg'#CgO!{OrO'#CrO#TOtO'#CsO#]OpO'#CtOOOP'#DT'#DTOOOP'#Cv'#CvQQOaOOOOOW'#Cw'#CwO#eOxO,59QOOOP,59Q,59QOOOO'#Cx'#CxO#mOpO,59TO#uO!bO,59TOOOP'#C|'#C|O$TOaO,59RO$[OpO'#CoOOOP,59R,59ROOOQ'#C}'#C}O$dOrO,59^OOOP,59^,59^OOOS'#DO'#DOO$lOtO,59_OOOP,59_,59_O$tOpO,59`O$|OpO,59`OOOP-E6t-E6tOOOW-E6u-E6uOOOP1G.l1G.lOOOO-E6v-E6vO%UO!bO1G.oO%UO!bO1G.oO%dOpO'#CkO%lO!bO'#CyO%zO!bO1G.oOOOP1G.o1G.oOOOP1G.w1G.wOOOP-E6z-E6zOOOP1G.m1G.mO&VOpO,59ZO&_OpO,59ZOOOQ-E6{-E6{OOOP1G.x1G.xOOOS-E6|-E6|OOOP1G.y1G.yO&gOpO1G.zO&gOpO1G.zOOOP1G.z1G.zO&oO!bO7+$ZO&}O!bO7+$ZOOOP7+$Z7+$ZOOOP7+$c7+$cO'YOpO,59VO'bOpO,59VO'mO!bO,59eOOOO-E6w-E6wO'{OpO1G.uO'{OpO1G.uOOOP1G.u1G.uO(TOpO7+$fOOOP7+$f7+$fO(]O!bO<<GuOOOP<<Gu<<GuOOOP<<G}<<G}O'bOpO1G.qO'bOpO1G.qO(hO#tO'#CnO(vO&jO'#CnOOOO1G.q1G.qO)UOpO7+$aOOOP7+$a7+$aOOOP<<HQ<<HQOOOPAN=aAN=aOOOPAN=iAN=iO'bOpO7+$]OOOO7+$]7+$]OOOO'#Cz'#CzO)^O#tO,59YOOOO,59Y,59YOOOO'#C{'#C{O)lO&jO,59YOOOP<<G{<<G{OOOO<<Gw<<GwOOOO-E6x-E6xOOOO1G.t1G.tOOOO-E6y-E6y",stateData:")z~OPQOSVOTWOVWOWWOXWOiXOyPO!QTO!SUO~OvZOx]O~O^`Oz^O~OPQOQcOSVOTWOVWOWWOXWOyPO!QTO!SUO~ORdO~P!SOteO!PgO~OuhO!RjO~O^lOz^O~OvZOxoO~O^qOz^O~O[vO`sOdwOz^O~ORyO~P!SO^{Oz^O~OteO!P}O~OuhO!R!PO~O^!QOz^O~O[!SOz^O~O[!VO`sOd!WOz^O~Oa!YOz^O~Oz^O[mX`mXdmX~O[!VO`sOd!WO~O^!]Oz^O~O[!_Oz^O~O[!aOz^O~O[!cO`sOd!dOz^O~O[!cO`sOd!dO~Oa!eOz^O~Oz^O{!gO}!hO~Oz^O[ma`madma~O[!kOz^O~O[!lOz^O~O[!mO`sOd!nO~OW!qOX!qO{!sO|!qO~OW!tOX!tO}!sO!O!tO~O[!vOz^O~OW!qOX!qO{!yO|!qO~OW!tOX!tO}!yO!O!tO~O",goto:"%cxPPPPPPPPPPyyP!PP!VPP!`!jP!pyyyP!v!|#S$[$k$q$w$}%TPPPP%ZXWORYbXRORYb_t`qru!T!U!bQ!i!YS!p!e!fR!w!oQdRRybXSORYbQYORmYQ[PRn[Q_QQkVjp_krz!R!T!X!Z!^!`!f!j!oQr`QzcQ!RlQ!TqQ!XsQ!ZtQ!^{Q!`!QQ!f!YQ!j!]R!o!eQu`S!UqrU![u!U!bR!b!TQ!r!gR!x!rQ!u!hR!z!uQbRRxbQfTR|fQiUR!OiSXOYTaRb",nodeNames:" StartTag StartCloseTag MissingCloseTag StartCloseTag StartCloseTag Document Text EntityReference CharacterReference Cdata Element EndTag OpenTag TagName Attribute AttributeName Is AttributeValue CloseTag SelfCloseEndTag SelfClosingTag Comment ProcessingInst MismatchedCloseTag DoctypeDecl",maxTerm:50,context:Nee,nodeProps:[["closedBy",1,"SelfCloseEndTag EndTag",13,"CloseTag MissingCloseTag"],["openedBy",12,"StartTag StartCloseTag",19,"OpenTag",20,"StartTag"],["isolate",-6,13,18,19,21,22,24,""]],propSources:[Bee],skippedNodes:[0],repeatNodeCount:9,tokenData:"!)v~R!YOX$qXY)iYZ)iZ]$q]^)i^p$qpq)iqr$qrs*vsv$qvw+fwx/ix}$q}!O0[!O!P$q!P!Q2z!Q![$q![!]4n!]!^$q!^!_8U!_!`!#t!`!a!$l!a!b!%d!b!c$q!c!}4n!}#P$q#P#Q!'W#Q#R$q#R#S4n#S#T$q#T#o4n#o%W$q%W%o4n%o%p$q%p&a4n&a&b$q&b1p4n1p4U$q4U4d4n4d4e$q4e$IS4n$IS$I`$q$I`$Ib4n$Ib$Kh$q$Kh%#t4n%#t&/x$q&/x&Et4n&Et&FV$q&FV;'S4n;'S;:j8O;:j;=`)c<%l?&r$q?&r?Ah4n?Ah?BY$q?BY?Mn4n?MnO$qi$zXVP|W!O`Or$qrs%gsv$qwx'^x!^$q!^!_(o!_;'S$q;'S;=`)c<%lO$qa%nVVP!O`Ov%gwx&Tx!^%g!^!_&o!_;'S%g;'S;=`'W<%lO%gP&YTVPOv&Tw!^&T!_;'S&T;'S;=`&i<%lO&TP&lP;=`<%l&T`&tS!O`Ov&ox;'S&o;'S;=`'Q<%lO&o`'TP;=`<%l&oa'ZP;=`<%l%gX'eWVP|WOr'^rs&Tsv'^w!^'^!^!_'}!_;'S'^;'S;=`(i<%lO'^W(ST|WOr'}sv'}w;'S'};'S;=`(c<%lO'}W(fP;=`<%l'}X(lP;=`<%l'^h(vV|W!O`Or(ors&osv(owx'}x;'S(o;'S;=`)]<%lO(oh)`P;=`<%l(oi)fP;=`<%l$qo)t`VP|W!O`zUOX$qXY)iYZ)iZ]$q]^)i^p$qpq)iqr$qrs%gsv$qwx'^x!^$q!^!_(o!_;'S$q;'S;=`)c<%lO$qk+PV{YVP!O`Ov%gwx&Tx!^%g!^!_&o!_;'S%g;'S;=`'W<%lO%g~+iast,n![!]-r!c!}-r#R#S-r#T#o-r%W%o-r%p&a-r&b1p-r4U4d-r4e$IS-r$I`$Ib-r$Kh%#t-r&/x&Et-r&FV;'S-r;'S;:j/c?&r?Ah-r?BY?Mn-r~,qQ!Q![,w#l#m-V~,zQ!Q![,w!]!^-Q~-VOX~~-YR!Q![-c!c!i-c#T#Z-c~-fS!Q![-c!]!^-Q!c!i-c#T#Z-c~-ug}!O-r!O!P-r!Q![-r![!]-r!]!^/^!c!}-r#R#S-r#T#o-r$}%O-r%W%o-r%p&a-r&b1p-r1p4U-r4U4d-r4e$IS-r$I`$Ib-r$Je$Jg-r$Kh%#t-r&/x&Et-r&FV;'S-r;'S;:j/c?&r?Ah-r?BY?Mn-r~/cOW~~/fP;=`<%l-rk/rW}bVP|WOr'^rs&Tsv'^w!^'^!^!_'}!_;'S'^;'S;=`(i<%lO'^k0eZVP|W!O`Or$qrs%gsv$qwx'^x}$q}!O1W!O!^$q!^!_(o!_;'S$q;'S;=`)c<%lO$qk1aZVP|W!O`Or$qrs%gsv$qwx'^x!^$q!^!_(o!_!`$q!`!a2S!a;'S$q;'S;=`)c<%lO$qk2_X!PQVP|W!O`Or$qrs%gsv$qwx'^x!^$q!^!_(o!_;'S$q;'S;=`)c<%lO$qm3TZVP|W!O`Or$qrs%gsv$qwx'^x!^$q!^!_(o!_!`$q!`!a3v!a;'S$q;'S;=`)c<%lO$qm4RXdSVP|W!O`Or$qrs%gsv$qwx'^x!^$q!^!_(o!_;'S$q;'S;=`)c<%lO$qo4{!P`S^QVP|W!O`Or$qrs%gsv$qwx'^x}$q}!O4n!O!P4n!P!Q$q!Q![4n![!]4n!]!^$q!^!_(o!_!c$q!c!}4n!}#R$q#R#S4n#S#T$q#T#o4n#o$}$q$}%O4n%O%W$q%W%o4n%o%p$q%p&a4n&a&b$q&b1p4n1p4U4n4U4d4n4d4e$q4e$IS4n$IS$I`$q$I`$Ib4n$Ib$Je$q$Je$Jg4n$Jg$Kh$q$Kh%#t4n%#t&/x$q&/x&Et4n&Et&FV$q&FV;'S4n;'S;:j8O;:j;=`)c<%l?&r$q?&r?Ah4n?Ah?BY$q?BY?Mn4n?MnO$qo8RP;=`<%l4ni8]Y|W!O`Oq(oqr8{rs&osv(owx'}x!a(o!a!b!#U!b;'S(o;'S;=`)]<%lO(oi9S_|W!O`Or(ors&osv(owx'}x}(o}!O:R!O!f(o!f!g;e!g!}(o!}#ODh#O#W(o#W#XLp#X;'S(o;'S;=`)]<%lO(oi:YX|W!O`Or(ors&osv(owx'}x}(o}!O:u!O;'S(o;'S;=`)]<%lO(oi;OV!QP|W!O`Or(ors&osv(owx'}x;'S(o;'S;=`)]<%lO(oi;lX|W!O`Or(ors&osv(owx'}x!q(o!q!r<X!r;'S(o;'S;=`)]<%lO(oi<`X|W!O`Or(ors&osv(owx'}x!e(o!e!f<{!f;'S(o;'S;=`)]<%lO(oi=SX|W!O`Or(ors&osv(owx'}x!v(o!v!w=o!w;'S(o;'S;=`)]<%lO(oi=vX|W!O`Or(ors&osv(owx'}x!{(o!{!|>c!|;'S(o;'S;=`)]<%lO(oi>jX|W!O`Or(ors&osv(owx'}x!r(o!r!s?V!s;'S(o;'S;=`)]<%lO(oi?^X|W!O`Or(ors&osv(owx'}x!g(o!g!h?y!h;'S(o;'S;=`)]<%lO(oi@QY|W!O`Or?yrs@psv?yvwA[wxBdx!`?y!`!aCr!a;'S?y;'S;=`Db<%lO?ya@uV!O`Ov@pvxA[x!`@p!`!aAy!a;'S@p;'S;=`B^<%lO@pPA_TO!`A[!`!aAn!a;'SA[;'S;=`As<%lOA[PAsOiPPAvP;=`<%lA[aBQSiP!O`Ov&ox;'S&o;'S;=`'Q<%lO&oaBaP;=`<%l@pXBiX|WOrBdrsA[svBdvwA[w!`Bd!`!aCU!a;'SBd;'S;=`Cl<%lOBdXC]TiP|WOr'}sv'}w;'S'};'S;=`(c<%lO'}XCoP;=`<%lBdiC{ViP|W!O`Or(ors&osv(owx'}x;'S(o;'S;=`)]<%lO(oiDeP;=`<%l?yiDoZ|W!O`Or(ors&osv(owx'}x!e(o!e!fEb!f#V(o#V#WIr#W;'S(o;'S;=`)]<%lO(oiEiX|W!O`Or(ors&osv(owx'}x!f(o!f!gFU!g;'S(o;'S;=`)]<%lO(oiF]X|W!O`Or(ors&osv(owx'}x!c(o!c!dFx!d;'S(o;'S;=`)]<%lO(oiGPX|W!O`Or(ors&osv(owx'}x!v(o!v!wGl!w;'S(o;'S;=`)]<%lO(oiGsX|W!O`Or(ors&osv(owx'}x!c(o!c!dH`!d;'S(o;'S;=`)]<%lO(oiHgX|W!O`Or(ors&osv(owx'}x!}(o!}#OIS#O;'S(o;'S;=`)]<%lO(oiI]V|W!O`yPOr(ors&osv(owx'}x;'S(o;'S;=`)]<%lO(oiIyX|W!O`Or(ors&osv(owx'}x#W(o#W#XJf#X;'S(o;'S;=`)]<%lO(oiJmX|W!O`Or(ors&osv(owx'}x#T(o#T#UKY#U;'S(o;'S;=`)]<%lO(oiKaX|W!O`Or(ors&osv(owx'}x#h(o#h#iK|#i;'S(o;'S;=`)]<%lO(oiLTX|W!O`Or(ors&osv(owx'}x#T(o#T#UH`#U;'S(o;'S;=`)]<%lO(oiLwX|W!O`Or(ors&osv(owx'}x#c(o#c#dMd#d;'S(o;'S;=`)]<%lO(oiMkX|W!O`Or(ors&osv(owx'}x#V(o#V#WNW#W;'S(o;'S;=`)]<%lO(oiN_X|W!O`Or(ors&osv(owx'}x#h(o#h#iNz#i;'S(o;'S;=`)]<%lO(oi! RX|W!O`Or(ors&osv(owx'}x#m(o#m#n! n#n;'S(o;'S;=`)]<%lO(oi! uX|W!O`Or(ors&osv(owx'}x#d(o#d#e!!b#e;'S(o;'S;=`)]<%lO(oi!!iX|W!O`Or(ors&osv(owx'}x#X(o#X#Y?y#Y;'S(o;'S;=`)]<%lO(oi!#_V!SP|W!O`Or(ors&osv(owx'}x;'S(o;'S;=`)]<%lO(ok!$PXaQVP|W!O`Or$qrs%gsv$qwx'^x!^$q!^!_(o!_;'S$q;'S;=`)c<%lO$qo!$wX[UVP|W!O`Or$qrs%gsv$qwx'^x!^$q!^!_(o!_;'S$q;'S;=`)c<%lO$qk!%mZVP|W!O`Or$qrs%gsv$qwx'^x!^$q!^!_(o!_!`$q!`!a!&`!a;'S$q;'S;=`)c<%lO$qk!&kX!RQVP|W!O`Or$qrs%gsv$qwx'^x!^$q!^!_(o!_;'S$q;'S;=`)c<%lO$qk!'aZVP|W!O`Or$qrs%gsv$qwx'^x!^$q!^!_(o!_#P$q#P#Q!(S#Q;'S$q;'S;=`)c<%lO$qk!(]ZVP|W!O`Or$qrs%gsv$qwx'^x!^$q!^!_(o!_!`$q!`!a!)O!a;'S$q;'S;=`)c<%lO$qk!)ZXxQVP|W!O`Or$qrs%gsv$qwx'^x!^$q!^!_(o!_;'S$q;'S;=`)c<%lO$q",tokenizers:[Dee,Mee,Iee,Lee,0,1,2,3,4],topRules:{Document:[0,6]},tokenPrec:0}),Wee=1024;let Uee=0,hm=class{constructor(e,t){this.from=e,this.to=t}},Jt=class{constructor(e={}){this.id=Uee++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof e!="function"&&(e=Es.match(e)),t=>{let n=e(t);return n===void 0?null:[this,n]}}};Jt.closedBy=new Jt({deserialize:r=>r.split(" ")});Jt.openedBy=new Jt({deserialize:r=>r.split(" ")});Jt.group=new Jt({deserialize:r=>r.split(" ")});Jt.isolate=new Jt({deserialize:r=>{if(r&&r!="rtl"&&r!="ltr"&&r!="auto")throw new RangeError("Invalid value for isolate: "+r);return r||"auto"}});Jt.contextHash=new Jt({perNode:!0});Jt.lookAhead=new Jt({perNode:!0});Jt.mounted=new Jt({perNode:!0});let d0=class{constructor(e,t,n){this.tree=e,this.overlay=t,this.parser=n}static get(e){return e&&e.props&&e.props[Jt.mounted.id]}};const Xee=Object.create(null);let Es=class pP{constructor(e,t,n,i=0){this.name=e,this.props=t,this.id=n,this.flags=i}static define(e){let t=e.props&&e.props.length?Object.create(null):Xee,n=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(e.name==null?8:0),i=new pP(e.name||"",t,e.id,n);if(e.props){for(let s of e.props)if(Array.isArray(s)||(s=s(i)),s){if(s[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");t[s[0].id]=s[1]}}return i}prop(e){return this.props[e.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(e){if(typeof e=="string"){if(this.name==e)return!0;let t=this.prop(Jt.group);return t?t.indexOf(e)>-1:!1}return this.id==e}static match(e){let t=Object.create(null);for(let n in e)for(let i of n.split(" "))t[i]=e[n];return n=>{for(let i=n.prop(Jt.group),s=-1;s<(i?i.length:0);s++){let a=t[s<0?n.name:i[s]];if(a)return a}}}};Es.none=new Es("",Object.create(null),0,8);const Cu=new WeakMap,U_=new WeakMap;var ln;(function(r){r[r.ExcludeBuffers=1]="ExcludeBuffers",r[r.IncludeAnonymous=2]="IncludeAnonymous",r[r.IgnoreMounts=4]="IgnoreMounts",r[r.IgnoreOverlays=8]="IgnoreOverlays"})(ln||(ln={}));let ai=class M1{constructor(e,t,n,i,s){if(this.type=e,this.children=t,this.positions=n,this.length=i,this.props=null,s&&s.length){this.props=Object.create(null);for(let[a,o]of s)this.props[typeof a=="number"?a:a.id]=o}}toString(){let e=d0.get(this);if(e&&!e.overlay)return e.tree.toString();let t="";for(let n of this.children){let i=n.toString();i&&(t&&(t+=","),t+=i)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(t.length?"("+t+")":""):t}cursor(e=0){return new B1(this.topNode,e)}cursorAt(e,t=0,n=0){let i=Cu.get(this)||this.topNode,s=new B1(i);return s.moveTo(e,t),Cu.set(this,s._tree),s}get topNode(){return new Ua(this,0,0,null)}resolve(e,t=0){let n=lh(Cu.get(this)||this.topNode,e,t,!1);return Cu.set(this,n),n}resolveInner(e,t=0){let n=lh(U_.get(this)||this.topNode,e,t,!0);return U_.set(this,n),n}resolveStack(e,t=0){return zee(this,e,t)}iterate(e){let{enter:t,leave:n,from:i=0,to:s=this.length}=e,a=e.mode||0,o=(a&ln.IncludeAnonymous)>0;for(let l=this.cursor(a|ln.IncludeAnonymous);;){let f=!1;if(l.from<=s&&l.to>=i&&(!o&&l.type.isAnonymous||t(l)!==!1)){if(l.firstChild())continue;f=!0}for(;f&&n&&(o||!l.type.isAnonymous)&&n(l),!l.nextSibling();){if(!l.parent())return;f=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let t in this.props)e.push([+t,this.props[t]]);return e}balance(e={}){return this.children.length<=8?this:tv(Es.none,this.children,this.positions,0,this.children.length,0,this.length,(t,n,i)=>new M1(this.type,t,n,i,this.propValues),e.makeTree||((t,n,i)=>new M1(Es.none,t,n,i)))}static build(e){return Gee(e)}};ai.empty=new ai(Es.none,[],[],0);let Vee=class mP{constructor(e,t){this.buffer=e,this.index=t}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new mP(this.buffer,this.index)}},ef=class gP{constructor(e,t,n){this.buffer=e,this.length=t,this.set=n}get type(){return Es.none}toString(){let e=[];for(let t=0;t<this.buffer.length;)e.push(this.childString(t)),t=this.buffer[t+3];return e.join(",")}childString(e){let t=this.buffer[e],n=this.buffer[e+3],i=this.set.types[t],s=i.name;if(/\W/.test(s)&&!i.isError&&(s=JSON.stringify(s)),e+=4,n==e)return s;let a=[];for(;e<n;)a.push(this.childString(e)),e=this.buffer[e+3];return s+"("+a.join(",")+")"}findChild(e,t,n,i,s){let{buffer:a}=this,o=-1;for(let l=e;l!=t&&!(OP(s,i,a[l+1],a[l+2])&&(o=l,n>0));l=a[l+3]);return o}slice(e,t,n){let i=this.buffer,s=new Uint16Array(t-e),a=0;for(let o=e,l=0;o<t;){s[l++]=i[o++],s[l++]=i[o++]-n;let f=s[l++]=i[o++]-n;s[l++]=i[o++]-e,a=Math.max(a,f)}return new gP(s,a,this.set)}};function OP(r,e,t,n){switch(r){case-2:return t<e;case-1:return n>=e&&t<e;case 0:return t<e&&n>e;case 1:return t<=e&&n>e;case 2:return n>e;case 4:return!0}}function lh(r,e,t,n){for(var i;r.from==r.to||(t<1?r.from>=e:r.from>e)||(t>-1?r.to<=e:r.to<e);){let a=!n&&r instanceof Ua&&r.index<0?null:r.parent;if(!a)return r;r=a}let s=n?0:ln.IgnoreOverlays;if(n)for(let a=r,o=a.parent;o;a=o,o=a.parent)a instanceof Ua&&a.index<0&&((i=o.enter(e,t,s))===null||i===void 0?void 0:i.from)!=a.from&&(r=o);for(;;){let a=r.enter(e,t,s);if(!a)return r;r=a}}let xP=class{cursor(e=0){return new B1(this,e)}getChild(e,t=null,n=null){let i=X_(this,e,t,n);return i.length?i[0]:null}getChildren(e,t=null,n=null){return X_(this,e,t,n)}resolve(e,t=0){return lh(this,e,t,!1)}resolveInner(e,t=0){return lh(this,e,t,!0)}matchContext(e){return I1(this.parent,e)}enterUnfinishedNodesBefore(e){let t=this.childBefore(e),n=this;for(;t;){let i=t.lastChild;if(!i||i.to!=t.to)break;i.type.isError&&i.from==i.to?(n=t,t=i.prevSibling):t=i}return n}get node(){return this}get next(){return this.parent}},Ua=class ld extends xP{constructor(e,t,n,i){super(),this._tree=e,this.from=t,this.index=n,this._parent=i}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,t,n,i,s=0){for(let a=this;;){for(let{children:o,positions:l}=a._tree,f=t>0?o.length:-1;e!=f;e+=t){let c=o[e],h=l[e]+a.from;if(OP(i,n,h,h+c.length)){if(c instanceof ef){if(s&ln.ExcludeBuffers)continue;let u=c.findChild(0,c.buffer.length,t,n-h,i);if(u>-1)return new L1(new qee(a,c,e,h),null,u)}else if(s&ln.IncludeAnonymous||!c.type.isAnonymous||ev(c)){let u;if(!(s&ln.IgnoreMounts)&&(u=d0.get(c))&&!u.overlay)return new ld(u.tree,h,e,a);let d=new ld(c,h,e,a);return s&ln.IncludeAnonymous||!d.type.isAnonymous?d:d.nextChild(t<0?c.children.length-1:0,t,n,i)}}}if(s&ln.IncludeAnonymous||!a.type.isAnonymous||(a.index>=0?e=a.index+t:e=t<0?-1:a._parent._tree.children.length,a=a._parent,!a))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}enter(e,t,n=0){let i;if(!(n&ln.IgnoreOverlays)&&(i=d0.get(this._tree))&&i.overlay){let s=e-this.from;for(let{from:a,to:o}of i.overlay)if((t>0?a<=s:a<s)&&(t<0?o>=s:o>s))return new ld(i.tree,i.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,t,n)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}};function X_(r,e,t,n){let i=r.cursor(),s=[];if(!i.firstChild())return s;if(t!=null){for(let a=!1;!a;)if(a=i.type.is(t),!i.nextSibling())return s}for(;;){if(n!=null&&i.type.is(n))return s;if(i.type.is(e)&&s.push(i.node),!i.nextSibling())return n==null?s:[]}}function I1(r,e,t=e.length-1){for(let n=r;t>=0;n=n.parent){if(!n)return!1;if(!n.type.isAnonymous){if(e[t]&&e[t]!=n.name)return!1;t--}}return!0}let qee=class{constructor(e,t,n,i){this.parent=e,this.buffer=t,this.index=n,this.start=i}},L1=class nc extends xP{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(e,t,n){super(),this.context=e,this._parent=t,this.index=n,this.type=e.buffer.set.types[e.buffer.buffer[n]]}child(e,t,n){let{buffer:i}=this.context,s=i.findChild(this.index+4,i.buffer[this.index+3],e,t-this.context.start,n);return s<0?null:new nc(this.context,this,s)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}enter(e,t,n=0){if(n&ln.ExcludeBuffers)return null;let{buffer:i}=this.context,s=i.findChild(this.index+4,i.buffer[this.index+3],t>0?1:-1,e-this.context.start,t);return s<0?null:new nc(this.context,this,s)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,t=e.buffer[this.index+3];return t<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new nc(this.context,this._parent,t):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,t=this._parent?this._parent.index+4:0;return this.index==t?this.externalSibling(-1):new nc(this.context,this._parent,e.findChild(t,this.index,-1,0,4))}get tree(){return null}toTree(){let e=[],t=[],{buffer:n}=this.context,i=this.index+4,s=n.buffer[this.index+3];if(s>i){let a=n.buffer[this.index+1];e.push(n.slice(i,s,a)),t.push(0)}return new ai(this.type,e,t,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}};function vP(r){if(!r.length)return null;let e=0,t=r[0];for(let s=1;s<r.length;s++){let a=r[s];(a.from>t.from||a.to<t.to)&&(t=a,e=s)}let n=t instanceof Ua&&t.index<0?null:t.parent,i=r.slice();return n?i[e]=n:i.splice(e,1),new jee(i,t)}let jee=class{constructor(e,t){this.heads=e,this.node=t}get next(){return vP(this.heads)}};function zee(r,e,t){let n=r.resolveInner(e,t),i=null;for(let s=n instanceof Ua?n:n.context.parent;s;s=s.parent)if(s.index<0){let a=s.parent;(i||(i=[n])).push(a.resolve(e,t)),s=a}else{let a=d0.get(s.tree);if(a&&a.overlay&&a.overlay[0].from<=e&&a.overlay[a.overlay.length-1].to>=e){let o=new Ua(a.tree,a.overlay[0].from+s.from,-1,s);(i||(i=[n])).push(lh(o,e,t,!1))}}return i?vP(i):n}let B1=class{get name(){return this.type.name}constructor(e,t=0){if(this.mode=t,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,e instanceof Ua)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let n=e._parent;n;n=n._parent)this.stack.unshift(n.index);this.bufferNode=e,this.yieldBuf(e.index)}}yieldNode(e){return e?(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0):!1}yieldBuf(e,t){this.index=e;let{start:n,buffer:i}=this.buffer;return this.type=t||i.set.types[i.buffer[e]],this.from=n+i.buffer[e+1],this.to=n+i.buffer[e+2],!0}yield(e){return e?e instanceof Ua?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,t,n){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,t,n,this.mode));let{buffer:i}=this.buffer,s=i.findChild(this.index+4,i.buffer[this.index+3],e,t-this.buffer.start,n);return s<0?!1:(this.stack.push(this.index),this.yieldBuf(s))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,t,n=this.mode){return this.buffer?n&ln.ExcludeBuffers?!1:this.enterChild(1,e,t):this.yield(this._tree.enter(e,t,n))}parent(){if(!this.buffer)return this.yieldNode(this.mode&ln.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&ln.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode)):!1;let{buffer:t}=this.buffer,n=this.stack.length-1;if(e<0){let i=n<0?0:this.stack[n]+4;if(this.index!=i)return this.yieldBuf(t.findChild(i,this.index,-1,0,4))}else{let i=t.buffer[this.index+3];if(i<(n<0?t.buffer.length:t.buffer[this.stack[n]+3]))return this.yieldBuf(i)}return n<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let t,n,{buffer:i}=this;if(i){if(e>0){if(this.index<i.buffer.buffer.length)return!1}else for(let s=0;s<this.index;s++)if(i.buffer.buffer[s+3]<this.index)return!1;({index:t,parent:n}=i)}else({index:t,_parent:n}=this._tree);for(;n;{index:t,_parent:n}=n)if(t>-1)for(let s=t+e,a=e<0?-1:n._tree.children.length;s!=a;s+=e){let o=n._tree.children[s];if(this.mode&ln.IncludeAnonymous||o instanceof ef||!o.type.isAnonymous||ev(o))return!1}return!0}move(e,t){if(t&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,t=0){for(;(this.from==this.to||(t<1?this.from>=e:this.from>e)||(t>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,t););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,t=null,n=0;if(e&&e.context==this.buffer)e:for(let i=this.index,s=this.stack.length;s>=0;){for(let a=e;a;a=a._parent)if(a.index==i){if(i==this.index)return a;t=a,n=s+1;break e}i=this.stack[--s]}for(let i=n;i<this.stack.length;i++)t=new L1(this.buffer,t,this.stack[i]);return this.bufferNode=new L1(this.buffer,t,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,t){for(let n=0;;){let i=!1;if(this.type.isAnonymous||e(this)!==!1){if(this.firstChild()){n++;continue}this.type.isAnonymous||(i=!0)}for(;;){if(i&&t&&t(this),i=this.type.isAnonymous,!n)return;if(this.nextSibling())break;this.parent(),n--,i=!0}}}matchContext(e){if(!this.buffer)return I1(this.node.parent,e);let{buffer:t}=this.buffer,{types:n}=t.set;for(let i=e.length-1,s=this.stack.length-1;i>=0;s--){if(s<0)return I1(this._tree,e,i);let a=n[t.buffer[this.stack[s]]];if(!a.isAnonymous){if(e[i]&&e[i]!=a.name)return!1;i--}}return!0}};function ev(r){return r.children.some(e=>e instanceof ef||!e.type.isAnonymous||ev(e))}function Gee(r){var e;let{buffer:t,nodeSet:n,maxBufferLength:i=Wee,reused:s=[],minRepeatType:a=n.types.length}=r,o=Array.isArray(t)?new Vee(t,t.length):t,l=n.types,f=0,c=0;function h(y,b,O,T,k,Q){let{id:A,start:_,end:N,size:U}=o,z=c,K=f;for(;U<0;)if(o.next(),U==-1){let ae=s[A];O.push(ae),T.push(_-y);return}else if(U==-3){f=A;return}else if(U==-4){c=A;return}else throw new RangeError(`Unrecognized record size: ${U}`);let re=l[A],ge,V,he=_-y;if(N-_<=i&&(V=g(o.pos-b,k))){let ae=new Uint16Array(V.size-V.skip),E=o.pos-V.size,L=ae.length;for(;o.pos>E;)L=v(V.start,ae,L);ge=new ef(ae,N-V.start,n),he=V.start-y}else{let ae=o.pos-U;o.next();let E=[],L=[],I=A>=a?A:-1,Z=0,ee=N;for(;o.pos>ae;)I>=0&&o.id==I&&o.size>=0?(o.end<=ee-i&&(p(E,L,_,Z,o.end,ee,I,z,K),Z=E.length,ee=o.end),o.next()):Q>2500?u(_,ae,E,L):h(_,ae,E,L,I,Q+1);if(I>=0&&Z>0&&Z<E.length&&p(E,L,_,Z,_,ee,I,z,K),E.reverse(),L.reverse(),I>-1&&Z>0){let ne=d(re,K);ge=tv(re,E,L,0,E.length,0,N-_,ne,ne)}else ge=m(re,E,L,N-_,z-N,K)}O.push(ge),T.push(he)}function u(y,b,O,T){let k=[],Q=0,A=-1;for(;o.pos>b;){let{id:_,start:N,end:U,size:z}=o;if(z>4)o.next();else{if(A>-1&&N<A)break;A<0&&(A=U-i),k.push(_,N,U),Q++,o.next()}}if(Q){let _=new Uint16Array(Q*4),N=k[k.length-2];for(let U=k.length-3,z=0;U>=0;U-=3)_[z++]=k[U],_[z++]=k[U+1]-N,_[z++]=k[U+2]-N,_[z++]=z;O.push(new ef(_,k[2]-N,n)),T.push(N-y)}}function d(y,b){return(O,T,k)=>{let Q=0,A=O.length-1,_,N;if(A>=0&&(_=O[A])instanceof ai){if(!A&&_.type==y&&_.length==k)return _;(N=_.prop(Jt.lookAhead))&&(Q=T[A]+_.length+N)}return m(y,O,T,k,Q,b)}}function p(y,b,O,T,k,Q,A,_,N){let U=[],z=[];for(;y.length>T;)U.push(y.pop()),z.push(b.pop()+O-k);y.push(m(n.types[A],U,z,Q-k,_-Q,N)),b.push(k-O)}function m(y,b,O,T,k,Q,A){if(Q){let _=[Jt.contextHash,Q];A=A?[_].concat(A):[_]}if(k>25){let _=[Jt.lookAhead,k];A=A?[_].concat(A):[_]}return new ai(y,b,O,T,A)}function g(y,b){let O=o.fork(),T=0,k=0,Q=0,A=O.end-i,_={size:0,start:0,skip:0};e:for(let N=O.pos-y;O.pos>N;){let U=O.size;if(O.id==b&&U>=0){_.size=T,_.start=k,_.skip=Q,Q+=4,T+=4,O.next();continue}let z=O.pos-U;if(U<0||z<N||O.start<A)break;let K=O.id>=a?4:0,re=O.start;for(O.next();O.pos>z;){if(O.size<0)if(O.size==-3)K+=4;else break e;else O.id>=a&&(K+=4);O.next()}k=re,T+=U,Q+=K}return(b<0||T==y)&&(_.size=T,_.start=k,_.skip=Q),_.size>4?_:void 0}function v(y,b,O){let{id:T,start:k,end:Q,size:A}=o;if(o.next(),A>=0&&T<a){let _=O;if(A>4){let N=o.pos-(A-4);for(;o.pos>N;)O=v(y,b,O)}b[--O]=_,b[--O]=Q-y,b[--O]=k-y,b[--O]=T}else A==-3?f=T:A==-4&&(c=T);return O}let w=[],x=[];for(;o.pos>0;)h(r.start||0,r.bufferStart||0,w,x,-1,0);let S=(e=r.length)!==null&&e!==void 0?e:w.length?x[0]+w[0].length:0;return new ai(l[r.topID],w.reverse(),x.reverse(),S)}const V_=new WeakMap;function fd(r,e){if(!r.isAnonymous||e instanceof ef||e.type!=r)return 1;let t=V_.get(e);if(t==null){t=1;for(let n of e.children){if(n.type!=r||!(n instanceof ai)){t=1;break}t+=fd(r,n)}V_.set(e,t)}return t}function tv(r,e,t,n,i,s,a,o,l){let f=0;for(let p=n;p<i;p++)f+=fd(r,e[p]);let c=Math.ceil(f*1.5/8),h=[],u=[];function d(p,m,g,v,w){for(let x=g;x<v;){let S=x,y=m[x],b=fd(r,p[x]);for(x++;x<v;x++){let O=fd(r,p[x]);if(b+O>=c)break;b+=O}if(x==S+1){if(b>c){let O=p[S];d(O.children,O.positions,0,O.children.length,m[S]+w);continue}h.push(p[S])}else{let O=m[x-1]+p[x-1].length-y;h.push(tv(r,p,m,S,x,y,O,null,l))}u.push(y+w-s)}}return d(e,t,n,i,0),(o||l)(h,u,a)}let cd=class Z1{constructor(e,t,n,i,s=!1,a=!1){this.from=e,this.to=t,this.tree=n,this.offset=i,this.open=(s?1:0)|(a?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(e,t=[],n=!1){let i=[new Z1(0,e.length,e,0,!1,n)];for(let s of t)s.to>e.length&&i.push(s);return i}static applyChanges(e,t,n=128){if(!t.length)return e;let i=[],s=1,a=e.length?e[0]:null;for(let o=0,l=0,f=0;;o++){let c=o<t.length?t[o]:null,h=c?c.fromA:1e9;if(h-l>=n)for(;a&&a.from<h;){let u=a;if(l>=u.from||h<=u.to||f){let d=Math.max(u.from,l)-f,p=Math.min(u.to,h)-f;u=d>=p?null:new Z1(d,p,u.tree,u.offset+f,o>0,!!c)}if(u&&i.push(u),a.to>h)break;a=s<e.length?e[s++]:null}if(!c)break;l=c.toA,f=c.toA-c.toB}return i}},Hee=class{startParse(e,t,n){return typeof e=="string"&&(e=new Yee(e)),n=n?n.length?n.map(i=>new hm(i.from,i.to)):[new hm(0,0)]:[new hm(0,e.length)],this.createParse(e,t||[],n)}parse(e,t,n){let i=this.startParse(e,t,n);for(;;){let s=i.advance();if(s)return s}}},Yee=class{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,t){return this.string.slice(e,t)}};new Jt({perNode:!0});var um;const xl=new Jt;function Kee(r){return Le.define({combine:r?e=>e.concat(r):void 0})}const Jee=new Jt;let Ui=class{constructor(e,t,n=[],i=""){this.data=e,this.name=i,lt.prototype.hasOwnProperty("tree")||Object.defineProperty(lt.prototype,"tree",{get(){return fh(this)}}),this.parser=t,this.extension=[tf.of(this),lt.languageData.of((s,a,o)=>{let l=q_(s,a,o),f=l.type.prop(xl);if(!f)return[];let c=s.facet(f),h=l.type.prop(Jee);if(h){let u=l.resolve(a-l.from,o);for(let d of h)if(d.test(u,s)){let p=s.facet(d.facet);return d.type=="replace"?p:p.concat(c)}}return c})].concat(n)}isActiveAt(e,t,n=-1){return q_(e,t,n).type.prop(xl)==this.data}findRegions(e){let t=e.facet(tf);if((t==null?void 0:t.data)==this.data)return[{from:0,to:e.doc.length}];if(!t||!t.allowsNesting)return[];let n=[],i=(s,a)=>{if(s.prop(xl)==this.data){n.push({from:a,to:a+s.length});return}let o=s.prop(Jt.mounted);if(o){if(o.tree.prop(xl)==this.data){if(o.overlay)for(let l of o.overlay)n.push({from:l.from+a,to:l.to+a});else n.push({from:a,to:a+s.length});return}else if(o.overlay){let l=n.length;if(i(o.tree,o.overlay[0].from+a),n.length>l)return}}for(let l=0;l<s.children.length;l++){let f=s.children[l];f instanceof ai&&i(f,s.positions[l]+a)}};return i(fh(e),0),n}get allowsNesting(){return!0}};Ui.setState=ot.define();function q_(r,e,t){let n=r.facet(tf),i=fh(r).topNode;if(!n||n.allowsNesting)for(let s=i;s;s=s.enter(e,t,ln.ExcludeBuffers))s.type.isTop&&(i=s);return i}let ete=class W1 extends Ui{constructor(e,t,n){super(e,t,[],n),this.parser=t}static define(e){let t=Kee(e.languageData);return new W1(t,e.parser.configure({props:[xl.add(n=>n.isTop?t:void 0)]}),e.name)}configure(e,t){return new W1(this.data,this.parser.configure(e),t||this.name)}get allowsNesting(){return this.parser.hasWrappers()}};function fh(r){let e=r.field(Ui.state,!1);return e?e.tree:ai.empty}let tte=class{constructor(e){this.doc=e,this.cursorPos=0,this.string="",this.cursor=e.iter()}get length(){return this.doc.length}syncTo(e){return this.string=this.cursor.next(e-this.cursorPos).value,this.cursorPos=e+this.string.length,this.cursorPos-this.string.length}chunk(e){return this.syncTo(e),this.string}get lineChunks(){return!0}read(e,t){let n=this.cursorPos-this.string.length;return e<n||t>=this.cursorPos?this.doc.sliceString(e,t):this.string.slice(e-n,t-n)}},Nf=null,rte=class U1{constructor(e,t,n=[],i,s,a,o,l){this.parser=e,this.state=t,this.fragments=n,this.tree=i,this.treeLen=s,this.viewport=a,this.skipped=o,this.scheduleOn=l,this.parse=null,this.tempSkipped=[]}static create(e,t,n){return new U1(e,t,[],ai.empty,0,n,[],null)}startParse(){return this.parser.startParse(new tte(this.state.doc),this.fragments)}work(e,t){return t!=null&&t>=this.state.doc.length&&(t=void 0),this.tree!=ai.empty&&this.isDone(t??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var n;if(typeof e=="number"){let i=Date.now()+e;e=()=>Date.now()>i}for(this.parse||(this.parse=this.startParse()),t!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>t)&&t<this.state.doc.length&&this.parse.stopAt(t);;){let i=this.parse.advance();if(i)if(this.fragments=this.withoutTempSkipped(cd.addTree(i,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(n=this.parse.stoppedAt)!==null&&n!==void 0?n:this.state.doc.length,this.tree=i,this.parse=null,this.treeLen<(t??this.state.doc.length))this.parse=this.startParse();else return!0;if(e())return!1}})}takeTree(){let e,t;this.parse&&(e=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>e)&&this.parse.stopAt(e),this.withContext(()=>{for(;!(t=this.parse.advance()););}),this.treeLen=e,this.tree=t,this.fragments=this.withoutTempSkipped(cd.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(e){let t=Nf;Nf=this;try{return e()}finally{Nf=t}}withoutTempSkipped(e){for(let t;t=this.tempSkipped.pop();)e=j_(e,t.from,t.to);return e}changes(e,t){let{fragments:n,tree:i,treeLen:s,viewport:a,skipped:o}=this;if(this.takeTree(),!e.empty){let l=[];if(e.iterChangedRanges((f,c,h,u)=>l.push({fromA:f,toA:c,fromB:h,toB:u})),n=cd.applyChanges(n,l),i=ai.empty,s=0,a={from:e.mapPos(a.from,-1),to:e.mapPos(a.to,1)},this.skipped.length){o=[];for(let f of this.skipped){let c=e.mapPos(f.from,1),h=e.mapPos(f.to,-1);c<h&&o.push({from:c,to:h})}}}return new U1(this.parser,t,n,i,s,a,o,this.scheduleOn)}updateViewport(e){if(this.viewport.from==e.from&&this.viewport.to==e.to)return!1;this.viewport=e;let t=this.skipped.length;for(let n=0;n<this.skipped.length;n++){let{from:i,to:s}=this.skipped[n];i<e.to&&s>e.from&&(this.fragments=j_(this.fragments,i,s),this.skipped.splice(n--,1))}return this.skipped.length>=t?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(e,t){this.skipped.push({from:e,to:t})}static getSkippingParser(e){return new class extends Hee{createParse(t,n,i){let s=i[0].from,a=i[i.length-1].to;return{parsedPos:s,advance(){let l=Nf;if(l){for(let f of i)l.tempSkipped.push(f);e&&(l.scheduleOn=l.scheduleOn?Promise.all([l.scheduleOn,e]):e)}return this.parsedPos=a,new ai(Es.none,[],[],a-s)},stoppedAt:null,stopAt(){}}}}}isDone(e){e=Math.min(e,this.state.doc.length);let t=this.fragments;return this.treeLen>=e&&t.length&&t[0].from==0&&t[0].to>=e}static get(){return Nf}};function j_(r,e,t){return cd.applyChanges(r,[{fromA:e,toA:t,fromB:e,toB:t}])}let X1=class V1{constructor(e){this.context=e,this.tree=e.tree}apply(e){if(!e.docChanged&&this.tree==this.context.tree)return this;let t=this.context.changes(e.changes,e.state),n=this.context.treeLen==e.startState.doc.length?void 0:Math.max(e.changes.mapPos(this.context.treeLen),t.viewport.to);return t.work(20,n)||t.takeTree(),new V1(t)}static init(e){let t=Math.min(3e3,e.doc.length),n=rte.create(e.facet(tf).parser,e,{from:0,to:t});return n.work(20,t)||n.takeTree(),new V1(n)}};Ui.state=Cr.define({create:X1.init,update(r,e){for(let t of e.effects)if(t.is(Ui.setState))return t.value;return e.startState.facet(tf)!=e.state.facet(tf)?X1.init(e.state):r.apply(e)}});let yP=r=>{let e=setTimeout(()=>r(),500);return()=>clearTimeout(e)};typeof requestIdleCallback<"u"&&(yP=r=>{let e=-1,t=setTimeout(()=>{e=requestIdleCallback(r,{timeout:400})},100);return()=>e<0?clearTimeout(t):cancelIdleCallback(e)});const dm=typeof navigator<"u"&&(!((um=navigator.scheduling)===null||um===void 0)&&um.isInputPending)?()=>navigator.scheduling.isInputPending():null,nte=gr.fromClass(class{constructor(e){this.view=e,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(e){let t=this.view.state.field(Ui.state).context;(t.updateViewport(e.view.viewport)||this.view.viewport.to>t.treeLen)&&this.scheduleWork(),(e.docChanged||e.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(t)}scheduleWork(){if(this.working)return;let{state:e}=this.view,t=e.field(Ui.state);(t.tree!=t.context.tree||!t.context.isDone(e.doc.length))&&(this.working=yP(this.work))}work(e){this.working=null;let t=Date.now();if(this.chunkEnd<t&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=t+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:n,viewport:{to:i}}=this.view,s=n.field(Ui.state);if(s.tree==s.context.tree&&s.context.isDone(i+1e5))return;let a=Date.now()+Math.min(this.chunkBudget,100,e&&!dm?Math.max(25,e.timeRemaining()-5):1e9),o=s.context.treeLen<i&&n.doc.length>i+1e3,l=s.context.work(()=>dm&&dm()||Date.now()>a,i+(o?0:1e5));this.chunkBudget-=Date.now()-t,(l||this.chunkBudget<=0)&&(s.context.takeTree(),this.view.dispatch({effects:Ui.setState.of(new X1(s.context))})),this.chunkBudget>0&&!(l&&!o)&&this.scheduleWork(),this.checkAsyncSchedule(s.context)}checkAsyncSchedule(e){e.scheduleOn&&(this.workScheduled++,e.scheduleOn.then(()=>this.scheduleWork()).catch(t=>Jr(this.view.state,t)).then(()=>this.workScheduled--),e.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),tf=Le.define({combine(r){return r.length?r[0]:null},enables:r=>[Ui.state,nte,Be.contentAttributes.compute([r],e=>{let t=e.facet(r);return t&&t.name?{"data-language":t.name}:{}})]});let ite=class{constructor(e,t=[]){this.language=e,this.support=t,this.extension=[e,t]}};const ste=new Jt,ate=new Jt;let ote=class wP{constructor(e,t){this.specs=e;let n;function i(o){let l=Tn.newName();return(n||(n=Object.create(null)))["."+l]=o,l}const s=typeof t.all=="string"?t.all:t.all?i(t.all):void 0,a=t.scope;this.scope=a instanceof Ui?o=>o.prop(xl)==a.data:a?o=>o==a:void 0,this.style=pf(e.map(o=>({tag:o.tag,class:o.class||i(Object.assign({},o,{tag:null}))})),{all:s}).style,this.module=n?new Tn(n):null,this.themeType=t.themeType}static define(e,t){return new wP(e,t||{})}};B.meta,B.link,B.heading,B.emphasis,B.strong,B.strikethrough,B.keyword,B.atom,B.bool,B.url,B.contentSeparator,B.labelName,B.literal,B.inserted,B.string,B.deleted,B.regexp,B.escape,B.string,B.variableName,B.variableName,B.typeName,B.namespace,B.className,B.variableName,B.macroName,B.propertyName,B.comment,B.invalid;const lte=new Jt,fte=Object.create(null),z_=[Es.none],G_=[],H_=Object.create(null),cte=Object.create(null);for(let[r,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])cte[r]=hte(fte,e);function pm(r,e){G_.indexOf(r)>-1||(G_.push(r),console.warn(e))}function hte(r,e){let t=[];for(let o of e.split(" ")){let l=[];for(let f of o.split(".")){let c=r[f]||B[f];c?typeof c=="function"?l.length?l=l.map(c):pm(f,`Modifier ${f} used at start of tag`):l.length?pm(f,`Tag ${f} used as modifier`):l=Array.isArray(c)?c:[c]:pm(f,`Unknown highlighting tag ${f}`)}for(let f of l)t.push(f)}if(!t.length)return 0;let n=e.replace(/ /g,"_"),i=n+" "+t.map(o=>o.id),s=H_[i];if(s)return s.id;let a=H_[i]=Es.define({id:z_.length,name:n,props:[sa({[n]:t})]});return z_.push(a),a.id}Rt.RTL,Rt.LTR;function hd(r,e){let t=e&&e.getChild("TagName");return t?r.sliceString(t.from,t.to):""}function mm(r,e){let t=e&&e.firstChild;return!t||t.name!="OpenTag"?"":hd(r,t)}function ute(r,e,t){let n=e&&e.getChildren("Attribute").find(s=>s.from<=t&&s.to>=t),i=n&&n.getChild("AttributeName");return i?r.sliceString(i.from,i.to):""}function gm(r){for(let e=r&&r.parent;e;e=e.parent)if(e.name=="Element")return e;return null}function dte(r,e){var t;let n=fh(r).resolveInner(e,-1),i=null;for(let s=n;!i&&s.parent;s=s.parent)(s.name=="OpenTag"||s.name=="CloseTag"||s.name=="SelfClosingTag"||s.name=="MismatchedCloseTag")&&(i=s);if(i&&(i.to>e||i.lastChild.type.isError)){let s=i.parent;if(n.name=="TagName")return i.name=="CloseTag"||i.name=="MismatchedCloseTag"?{type:"closeTag",from:n.from,context:s}:{type:"openTag",from:n.from,context:gm(s)};if(n.name=="AttributeName")return{type:"attrName",from:n.from,context:i};if(n.name=="AttributeValue")return{type:"attrValue",from:n.from,context:i};let a=n==i||n.name=="Attribute"?n.childBefore(e):n;return(a==null?void 0:a.name)=="StartTag"?{type:"openTag",from:e,context:gm(s)}:(a==null?void 0:a.name)=="StartCloseTag"&&a.to<=e?{type:"closeTag",from:e,context:s}:(a==null?void 0:a.name)=="Is"?{type:"attrValue",from:e,context:i}:a?{type:"attrName",from:e,context:i}:null}else if(n.name=="StartCloseTag")return{type:"closeTag",from:e,context:n.parent};for(;n.parent&&n.to==e&&!(!((t=n.lastChild)===null||t===void 0)&&t.type.isError);)n=n.parent;return n.name=="Element"||n.name=="Text"||n.name=="Document"?{type:"tag",from:e,context:n.name=="Element"?n:gm(n)}:null}let pte=class{constructor(e,t,n){this.attrs=t,this.attrValues=n,this.children=[],this.name=e.name,this.completion=Object.assign(Object.assign({type:"type"},e.completion||{}),{label:this.name}),this.openCompletion=Object.assign(Object.assign({},this.completion),{label:"<"+this.name}),this.closeCompletion=Object.assign(Object.assign({},this.completion),{label:"</"+this.name+">",boost:2}),this.closeNameCompletion=Object.assign(Object.assign({},this.completion),{label:this.name+">"}),this.text=e.textContent?e.textContent.map(i=>({label:i,type:"text"})):[]}};const Om=/^[:\-\.\w\u00b7-\uffff]*$/;function Y_(r){return Object.assign(Object.assign({type:"property"},r.completion||{}),{label:r.name})}function K_(r){return typeof r=="string"?{label:`"${r}"`,type:"constant"}:/^"/.test(r.label)?r:Object.assign(Object.assign({},r),{label:`"${r.label}"`})}function mte(r,e){let t=[],n=[],i=Object.create(null);for(let l of e){let f=Y_(l);t.push(f),l.global&&n.push(f),l.values&&(i[l.name]=l.values.map(K_))}let s=[],a=[],o=Object.create(null);for(let l of r){let f=n,c=i;l.attributes&&(f=f.concat(l.attributes.map(u=>typeof u=="string"?t.find(d=>d.label==u)||{label:u,type:"property"}:(u.values&&(c==i&&(c=Object.create(c)),c[u.name]=u.values.map(K_)),Y_(u)))));let h=new pte(l,f,c);o[h.name]=h,s.push(h),l.top&&a.push(h)}a.length||(a=s);for(let l=0;l<s.length;l++){let f=r[l],c=s[l];if(f.children)for(let h of f.children)o[h]&&c.children.push(o[h]);else c.children=s}return l=>{var f;let{doc:c}=l.state,h=dte(l.state,l.pos);if(!h||h.type=="tag"&&!l.explicit)return null;let{type:u,from:d,context:p}=h;if(u=="openTag"){let m=a,g=mm(c,p);if(g){let v=o[g];m=(v==null?void 0:v.children)||s}return{from:d,options:m.map(v=>v.completion),validFor:Om}}else if(u=="closeTag"){let m=mm(c,p);return m?{from:d,to:l.pos+(c.sliceString(l.pos,l.pos+1)==">"?1:0),options:[((f=o[m])===null||f===void 0?void 0:f.closeNameCompletion)||{label:m+">",type:"type"}],validFor:Om}:null}else if(u=="attrName"){let m=o[hd(c,p)];return{from:d,options:(m==null?void 0:m.attrs)||n,validFor:Om}}else if(u=="attrValue"){let m=ute(c,p,d);if(!m)return null;let g=o[hd(c,p)],v=((g==null?void 0:g.attrValues)||i)[m];return!v||!v.length?null:{from:d,to:l.pos+(c.sliceString(l.pos,l.pos+1)=='"'?1:0),options:v,validFor:/^"[^"]*"?$/}}else if(u=="tag"){let m=mm(c,p),g=o[m],v=[],w=p&&p.lastChild;m&&(!w||w.name!="CloseTag"||hd(c,w)!=m)&&v.push(g?g.closeCompletion:{label:"</"+m+">",type:"type",boost:2});let x=v.concat(((g==null?void 0:g.children)||(p?s:a)).map(S=>S.openCompletion));if(p&&(g!=null&&g.text.length)){let S=p.firstChild;S.to>l.pos-20&&!/\S/.test(l.state.sliceDoc(S.to,l.pos))&&(x=x.concat(g.text))}return{from:d,options:x,validFor:/^<\/?[:\-\.\w\u00b7-\uffff]*$/}}else return null}}const q1=ete.define({name:"xml",parser:Zee.configure({props:[ste.add({Element(r){let e=/^\s*<\//.test(r.textAfter);return r.lineIndent(r.node.from)+(e?0:r.unit)},"OpenTag CloseTag SelfClosingTag"(r){return r.column(r.node.from)+r.unit}}),ate.add({Element(r){let e=r.firstChild,t=r.lastChild;return!e||e.name!="OpenTag"?null:{from:e.to,to:t.name=="CloseTag"?t.from:r.to}}}),lte.add({"OpenTag CloseTag":r=>r.getChild("TagName")})]}),languageData:{commentTokens:{block:{open:"<!--",close:"-->"}},indentOnInput:/^\s*<\/$/}});function J_(r={}){let e=[q1.data.of({autocomplete:mte(r.elements||[],r.attributes||[])})];return r.autoCloseTags!==!1&&e.push(gte),new ite(q1,e)}function e2(r,e,t=r.length){if(!e)return"";let n=e.firstChild,i=n&&n.getChild("TagName");return i?r.sliceString(i.from,Math.min(i.to,t)):""}const gte=Be.inputHandler.of((r,e,t,n,i)=>{if(r.composing||r.state.readOnly||e!=t||n!=">"&&n!="/"||!q1.isActiveAt(r.state,e,-1))return!1;let s=i(),{state:a}=s,o=a.changeByRange(l=>{var f,c,h;let{head:u}=l,d=a.doc.sliceString(u-1,u)==n,p=fh(a).resolveInner(u,-1),m;if(d&&n==">"&&p.name=="EndTag"){let g=p.parent;if(((c=(f=g.parent)===null||f===void 0?void 0:f.lastChild)===null||c===void 0?void 0:c.name)!="CloseTag"&&(m=e2(a.doc,g.parent,u))){let v=u+(a.doc.sliceString(u,u+1)===">"?1:0),w=`</${m}>`;return{range:l,changes:{from:u,to:v,insert:w}}}}else if(d&&n=="/"&&p.name=="StartCloseTag"){let g=p.parent;if(p.from==u-2&&((h=g.lastChild)===null||h===void 0?void 0:h.name)!="CloseTag"&&(m=e2(a.doc,g,u))){let v=u+(a.doc.sliceString(u,u+1)===">"?1:0),w=`${m}>`;return{range:xe.cursor(u+w.length,-1),changes:{from:u,to:v,insert:w}}}}return{range:l}});return o.changes.empty?!1:(r.dispatch([s,a.update(o,{userEvent:"input.complete",scrollIntoView:!0})]),!0)}),Ote=1024;let xte=0;class xm{constructor(e,t){this.from=e,this.to=t}}class sr{constructor(e={}){this.id=xte++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof e!="function"&&(e=Ri.match(e)),t=>{let n=e(t);return n===void 0?null:[this,n]}}}sr.closedBy=new sr({deserialize:r=>r.split(" ")});sr.openedBy=new sr({deserialize:r=>r.split(" ")});sr.group=new sr({deserialize:r=>r.split(" ")});sr.isolate=new sr({deserialize:r=>{if(r&&r!="rtl"&&r!="ltr"&&r!="auto")throw new RangeError("Invalid value for isolate: "+r);return r||"auto"}});sr.contextHash=new sr({perNode:!0});sr.lookAhead=new sr({perNode:!0});sr.mounted=new sr({perNode:!0});class p0{constructor(e,t,n){this.tree=e,this.overlay=t,this.parser=n}static get(e){return e&&e.props&&e.props[sr.mounted.id]}}const vte=Object.create(null);class Ri{constructor(e,t,n,i=0){this.name=e,this.props=t,this.id=n,this.flags=i}static define(e){let t=e.props&&e.props.length?Object.create(null):vte,n=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(e.name==null?8:0),i=new Ri(e.name||"",t,e.id,n);if(e.props){for(let s of e.props)if(Array.isArray(s)||(s=s(i)),s){if(s[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");t[s[0].id]=s[1]}}return i}prop(e){return this.props[e.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(e){if(typeof e=="string"){if(this.name==e)return!0;let t=this.prop(sr.group);return t?t.indexOf(e)>-1:!1}return this.id==e}static match(e){let t=Object.create(null);for(let n in e)for(let i of n.split(" "))t[i]=e[n];return n=>{for(let i=n.prop(sr.group),s=-1;s<(i?i.length:0);s++){let a=t[s<0?n.name:i[s]];if(a)return a}}}}Ri.none=new Ri("",Object.create(null),0,8);const Au=new WeakMap,t2=new WeakMap;var fn;(function(r){r[r.ExcludeBuffers=1]="ExcludeBuffers",r[r.IncludeAnonymous=2]="IncludeAnonymous",r[r.IgnoreMounts=4]="IgnoreMounts",r[r.IgnoreOverlays=8]="IgnoreOverlays"})(fn||(fn={}));class bn{constructor(e,t,n,i,s){if(this.type=e,this.children=t,this.positions=n,this.length=i,this.props=null,s&&s.length){this.props=Object.create(null);for(let[a,o]of s)this.props[typeof a=="number"?a:a.id]=o}}toString(){let e=p0.get(this);if(e&&!e.overlay)return e.tree.toString();let t="";for(let n of this.children){let i=n.toString();i&&(t&&(t+=","),t+=i)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(t.length?"("+t+")":""):t}cursor(e=0){return new z1(this.topNode,e)}cursorAt(e,t=0,n=0){let i=Au.get(this)||this.topNode,s=new z1(i);return s.moveTo(e,t),Au.set(this,s._tree),s}get topNode(){return new Ei(this,0,0,null)}resolve(e,t=0){let n=ch(Au.get(this)||this.topNode,e,t,!1);return Au.set(this,n),n}resolveInner(e,t=0){let n=ch(t2.get(this)||this.topNode,e,t,!0);return t2.set(this,n),n}resolveStack(e,t=0){return bte(this,e,t)}iterate(e){let{enter:t,leave:n,from:i=0,to:s=this.length}=e,a=e.mode||0,o=(a&fn.IncludeAnonymous)>0;for(let l=this.cursor(a|fn.IncludeAnonymous);;){let f=!1;if(l.from<=s&&l.to>=i&&(!o&&l.type.isAnonymous||t(l)!==!1)){if(l.firstChild())continue;f=!0}for(;f&&n&&(o||!l.type.isAnonymous)&&n(l),!l.nextSibling();){if(!l.parent())return;f=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let t in this.props)e.push([+t,this.props[t]]);return e}balance(e={}){return this.children.length<=8?this:iv(Ri.none,this.children,this.positions,0,this.children.length,0,this.length,(t,n,i)=>new bn(this.type,t,n,i,this.propValues),e.makeTree||((t,n,i)=>new bn(Ri.none,t,n,i)))}static build(e){return _te(e)}}bn.empty=new bn(Ri.none,[],[],0);class rv{constructor(e,t){this.buffer=e,this.index=t}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new rv(this.buffer,this.index)}}class Xa{constructor(e,t,n){this.buffer=e,this.length=t,this.set=n}get type(){return Ri.none}toString(){let e=[];for(let t=0;t<this.buffer.length;)e.push(this.childString(t)),t=this.buffer[t+3];return e.join(",")}childString(e){let t=this.buffer[e],n=this.buffer[e+3],i=this.set.types[t],s=i.name;if(/\W/.test(s)&&!i.isError&&(s=JSON.stringify(s)),e+=4,n==e)return s;let a=[];for(;e<n;)a.push(this.childString(e)),e=this.buffer[e+3];return s+"("+a.join(",")+")"}findChild(e,t,n,i,s){let{buffer:a}=this,o=-1;for(let l=e;l!=t&&!(bP(s,i,a[l+1],a[l+2])&&(o=l,n>0));l=a[l+3]);return o}slice(e,t,n){let i=this.buffer,s=new Uint16Array(t-e),a=0;for(let o=e,l=0;o<t;){s[l++]=i[o++],s[l++]=i[o++]-n;let f=s[l++]=i[o++]-n;s[l++]=i[o++]-e,a=Math.max(a,f)}return new Xa(s,a,this.set)}}function bP(r,e,t,n){switch(r){case-2:return t<e;case-1:return n>=e&&t<e;case 0:return t<e&&n>e;case 1:return t<=e&&n>e;case 2:return n>e;case 4:return!0}}function ch(r,e,t,n){for(var i;r.from==r.to||(t<1?r.from>=e:r.from>e)||(t>-1?r.to<=e:r.to<e);){let a=!n&&r instanceof Ei&&r.index<0?null:r.parent;if(!a)return r;r=a}let s=n?0:fn.IgnoreOverlays;if(n)for(let a=r,o=a.parent;o;a=o,o=a.parent)a instanceof Ei&&a.index<0&&((i=o.enter(e,t,s))===null||i===void 0?void 0:i.from)!=a.from&&(r=o);for(;;){let a=r.enter(e,t,s);if(!a)return r;r=a}}class _P{cursor(e=0){return new z1(this,e)}getChild(e,t=null,n=null){let i=r2(this,e,t,n);return i.length?i[0]:null}getChildren(e,t=null,n=null){return r2(this,e,t,n)}resolve(e,t=0){return ch(this,e,t,!1)}resolveInner(e,t=0){return ch(this,e,t,!0)}matchContext(e){return j1(this.parent,e)}enterUnfinishedNodesBefore(e){let t=this.childBefore(e),n=this;for(;t;){let i=t.lastChild;if(!i||i.to!=t.to)break;i.type.isError&&i.from==i.to?(n=t,t=i.prevSibling):t=i}return n}get node(){return this}get next(){return this.parent}}class Ei extends _P{constructor(e,t,n,i){super(),this._tree=e,this.from=t,this.index=n,this._parent=i}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,t,n,i,s=0){for(let a=this;;){for(let{children:o,positions:l}=a._tree,f=t>0?o.length:-1;e!=f;e+=t){let c=o[e],h=l[e]+a.from;if(bP(i,n,h,h+c.length)){if(c instanceof Xa){if(s&fn.ExcludeBuffers)continue;let u=c.findChild(0,c.buffer.length,t,n-h,i);if(u>-1)return new Ea(new yte(a,c,e,h),null,u)}else if(s&fn.IncludeAnonymous||!c.type.isAnonymous||nv(c)){let u;if(!(s&fn.IgnoreMounts)&&(u=p0.get(c))&&!u.overlay)return new Ei(u.tree,h,e,a);let d=new Ei(c,h,e,a);return s&fn.IncludeAnonymous||!d.type.isAnonymous?d:d.nextChild(t<0?c.children.length-1:0,t,n,i)}}}if(s&fn.IncludeAnonymous||!a.type.isAnonymous||(a.index>=0?e=a.index+t:e=t<0?-1:a._parent._tree.children.length,a=a._parent,!a))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}enter(e,t,n=0){let i;if(!(n&fn.IgnoreOverlays)&&(i=p0.get(this._tree))&&i.overlay){let s=e-this.from;for(let{from:a,to:o}of i.overlay)if((t>0?a<=s:a<s)&&(t<0?o>=s:o>s))return new Ei(i.tree,i.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,t,n)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}}function r2(r,e,t,n){let i=r.cursor(),s=[];if(!i.firstChild())return s;if(t!=null){for(let a=!1;!a;)if(a=i.type.is(t),!i.nextSibling())return s}for(;;){if(n!=null&&i.type.is(n))return s;if(i.type.is(e)&&s.push(i.node),!i.nextSibling())return n==null?s:[]}}function j1(r,e,t=e.length-1){for(let n=r;t>=0;n=n.parent){if(!n)return!1;if(!n.type.isAnonymous){if(e[t]&&e[t]!=n.name)return!1;t--}}return!0}class yte{constructor(e,t,n,i){this.parent=e,this.buffer=t,this.index=n,this.start=i}}class Ea extends _P{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(e,t,n){super(),this.context=e,this._parent=t,this.index=n,this.type=e.buffer.set.types[e.buffer.buffer[n]]}child(e,t,n){let{buffer:i}=this.context,s=i.findChild(this.index+4,i.buffer[this.index+3],e,t-this.context.start,n);return s<0?null:new Ea(this.context,this,s)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}enter(e,t,n=0){if(n&fn.ExcludeBuffers)return null;let{buffer:i}=this.context,s=i.findChild(this.index+4,i.buffer[this.index+3],t>0?1:-1,e-this.context.start,t);return s<0?null:new Ea(this.context,this,s)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,t=e.buffer[this.index+3];return t<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new Ea(this.context,this._parent,t):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,t=this._parent?this._parent.index+4:0;return this.index==t?this.externalSibling(-1):new Ea(this.context,this._parent,e.findChild(t,this.index,-1,0,4))}get tree(){return null}toTree(){let e=[],t=[],{buffer:n}=this.context,i=this.index+4,s=n.buffer[this.index+3];if(s>i){let a=n.buffer[this.index+1];e.push(n.slice(i,s,a)),t.push(0)}return new bn(this.type,e,t,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function kP(r){if(!r.length)return null;let e=0,t=r[0];for(let s=1;s<r.length;s++){let a=r[s];(a.from>t.from||a.to<t.to)&&(t=a,e=s)}let n=t instanceof Ei&&t.index<0?null:t.parent,i=r.slice();return n?i[e]=n:i.splice(e,1),new wte(i,t)}class wte{constructor(e,t){this.heads=e,this.node=t}get next(){return kP(this.heads)}}function bte(r,e,t){let n=r.resolveInner(e,t),i=null;for(let s=n instanceof Ei?n:n.context.parent;s;s=s.parent)if(s.index<0){let a=s.parent;(i||(i=[n])).push(a.resolve(e,t)),s=a}else{let a=p0.get(s.tree);if(a&&a.overlay&&a.overlay[0].from<=e&&a.overlay[a.overlay.length-1].to>=e){let o=new Ei(a.tree,a.overlay[0].from+s.from,-1,s);(i||(i=[n])).push(ch(o,e,t,!1))}}return i?kP(i):n}class z1{get name(){return this.type.name}constructor(e,t=0){if(this.mode=t,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,e instanceof Ei)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let n=e._parent;n;n=n._parent)this.stack.unshift(n.index);this.bufferNode=e,this.yieldBuf(e.index)}}yieldNode(e){return e?(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0):!1}yieldBuf(e,t){this.index=e;let{start:n,buffer:i}=this.buffer;return this.type=t||i.set.types[i.buffer[e]],this.from=n+i.buffer[e+1],this.to=n+i.buffer[e+2],!0}yield(e){return e?e instanceof Ei?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,t,n){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,t,n,this.mode));let{buffer:i}=this.buffer,s=i.findChild(this.index+4,i.buffer[this.index+3],e,t-this.buffer.start,n);return s<0?!1:(this.stack.push(this.index),this.yieldBuf(s))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,t,n=this.mode){return this.buffer?n&fn.ExcludeBuffers?!1:this.enterChild(1,e,t):this.yield(this._tree.enter(e,t,n))}parent(){if(!this.buffer)return this.yieldNode(this.mode&fn.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&fn.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode)):!1;let{buffer:t}=this.buffer,n=this.stack.length-1;if(e<0){let i=n<0?0:this.stack[n]+4;if(this.index!=i)return this.yieldBuf(t.findChild(i,this.index,-1,0,4))}else{let i=t.buffer[this.index+3];if(i<(n<0?t.buffer.length:t.buffer[this.stack[n]+3]))return this.yieldBuf(i)}return n<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let t,n,{buffer:i}=this;if(i){if(e>0){if(this.index<i.buffer.buffer.length)return!1}else for(let s=0;s<this.index;s++)if(i.buffer.buffer[s+3]<this.index)return!1;({index:t,parent:n}=i)}else({index:t,_parent:n}=this._tree);for(;n;{index:t,_parent:n}=n)if(t>-1)for(let s=t+e,a=e<0?-1:n._tree.children.length;s!=a;s+=e){let o=n._tree.children[s];if(this.mode&fn.IncludeAnonymous||o instanceof Xa||!o.type.isAnonymous||nv(o))return!1}return!0}move(e,t){if(t&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,t=0){for(;(this.from==this.to||(t<1?this.from>=e:this.from>e)||(t>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,t););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,t=null,n=0;if(e&&e.context==this.buffer)e:for(let i=this.index,s=this.stack.length;s>=0;){for(let a=e;a;a=a._parent)if(a.index==i){if(i==this.index)return a;t=a,n=s+1;break e}i=this.stack[--s]}for(let i=n;i<this.stack.length;i++)t=new Ea(this.buffer,t,this.stack[i]);return this.bufferNode=new Ea(this.buffer,t,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,t){for(let n=0;;){let i=!1;if(this.type.isAnonymous||e(this)!==!1){if(this.firstChild()){n++;continue}this.type.isAnonymous||(i=!0)}for(;;){if(i&&t&&t(this),i=this.type.isAnonymous,!n)return;if(this.nextSibling())break;this.parent(),n--,i=!0}}}matchContext(e){if(!this.buffer)return j1(this.node.parent,e);let{buffer:t}=this.buffer,{types:n}=t.set;for(let i=e.length-1,s=this.stack.length-1;i>=0;s--){if(s<0)return j1(this._tree,e,i);let a=n[t.buffer[this.stack[s]]];if(!a.isAnonymous){if(e[i]&&e[i]!=a.name)return!1;i--}}return!0}}function nv(r){return r.children.some(e=>e instanceof Xa||!e.type.isAnonymous||nv(e))}function _te(r){var e;let{buffer:t,nodeSet:n,maxBufferLength:i=Ote,reused:s=[],minRepeatType:a=n.types.length}=r,o=Array.isArray(t)?new rv(t,t.length):t,l=n.types,f=0,c=0;function h(y,b,O,T,k,Q){let{id:A,start:_,end:N,size:U}=o,z=c,K=f;for(;U<0;)if(o.next(),U==-1){let ae=s[A];O.push(ae),T.push(_-y);return}else if(U==-3){f=A;return}else if(U==-4){c=A;return}else throw new RangeError(`Unrecognized record size: ${U}`);let re=l[A],ge,V,he=_-y;if(N-_<=i&&(V=g(o.pos-b,k))){let ae=new Uint16Array(V.size-V.skip),E=o.pos-V.size,L=ae.length;for(;o.pos>E;)L=v(V.start,ae,L);ge=new Xa(ae,N-V.start,n),he=V.start-y}else{let ae=o.pos-U;o.next();let E=[],L=[],I=A>=a?A:-1,Z=0,ee=N;for(;o.pos>ae;)I>=0&&o.id==I&&o.size>=0?(o.end<=ee-i&&(p(E,L,_,Z,o.end,ee,I,z,K),Z=E.length,ee=o.end),o.next()):Q>2500?u(_,ae,E,L):h(_,ae,E,L,I,Q+1);if(I>=0&&Z>0&&Z<E.length&&p(E,L,_,Z,_,ee,I,z,K),E.reverse(),L.reverse(),I>-1&&Z>0){let ne=d(re,K);ge=iv(re,E,L,0,E.length,0,N-_,ne,ne)}else ge=m(re,E,L,N-_,z-N,K)}O.push(ge),T.push(he)}function u(y,b,O,T){let k=[],Q=0,A=-1;for(;o.pos>b;){let{id:_,start:N,end:U,size:z}=o;if(z>4)o.next();else{if(A>-1&&N<A)break;A<0&&(A=U-i),k.push(_,N,U),Q++,o.next()}}if(Q){let _=new Uint16Array(Q*4),N=k[k.length-2];for(let U=k.length-3,z=0;U>=0;U-=3)_[z++]=k[U],_[z++]=k[U+1]-N,_[z++]=k[U+2]-N,_[z++]=z;O.push(new Xa(_,k[2]-N,n)),T.push(N-y)}}function d(y,b){return(O,T,k)=>{let Q=0,A=O.length-1,_,N;if(A>=0&&(_=O[A])instanceof bn){if(!A&&_.type==y&&_.length==k)return _;(N=_.prop(sr.lookAhead))&&(Q=T[A]+_.length+N)}return m(y,O,T,k,Q,b)}}function p(y,b,O,T,k,Q,A,_,N){let U=[],z=[];for(;y.length>T;)U.push(y.pop()),z.push(b.pop()+O-k);y.push(m(n.types[A],U,z,Q-k,_-Q,N)),b.push(k-O)}function m(y,b,O,T,k,Q,A){if(Q){let _=[sr.contextHash,Q];A=A?[_].concat(A):[_]}if(k>25){let _=[sr.lookAhead,k];A=A?[_].concat(A):[_]}return new bn(y,b,O,T,A)}function g(y,b){let O=o.fork(),T=0,k=0,Q=0,A=O.end-i,_={size:0,start:0,skip:0};e:for(let N=O.pos-y;O.pos>N;){let U=O.size;if(O.id==b&&U>=0){_.size=T,_.start=k,_.skip=Q,Q+=4,T+=4,O.next();continue}let z=O.pos-U;if(U<0||z<N||O.start<A)break;let K=O.id>=a?4:0,re=O.start;for(O.next();O.pos>z;){if(O.size<0)if(O.size==-3)K+=4;else break e;else O.id>=a&&(K+=4);O.next()}k=re,T+=U,Q+=K}return(b<0||T==y)&&(_.size=T,_.start=k,_.skip=Q),_.size>4?_:void 0}function v(y,b,O){let{id:T,start:k,end:Q,size:A}=o;if(o.next(),A>=0&&T<a){let _=O;if(A>4){let N=o.pos-(A-4);for(;o.pos>N;)O=v(y,b,O)}b[--O]=_,b[--O]=Q-y,b[--O]=k-y,b[--O]=T}else A==-3?f=T:A==-4&&(c=T);return O}let w=[],x=[];for(;o.pos>0;)h(r.start||0,r.bufferStart||0,w,x,-1,0);let S=(e=r.length)!==null&&e!==void 0?e:w.length?x[0]+w[0].length:0;return new bn(l[r.topID],w.reverse(),x.reverse(),S)}const n2=new WeakMap;function ud(r,e){if(!r.isAnonymous||e instanceof Xa||e.type!=r)return 1;let t=n2.get(e);if(t==null){t=1;for(let n of e.children){if(n.type!=r||!(n instanceof bn)){t=1;break}t+=ud(r,n)}n2.set(e,t)}return t}function iv(r,e,t,n,i,s,a,o,l){let f=0;for(let p=n;p<i;p++)f+=ud(r,e[p]);let c=Math.ceil(f*1.5/8),h=[],u=[];function d(p,m,g,v,w){for(let x=g;x<v;){let S=x,y=m[x],b=ud(r,p[x]);for(x++;x<v;x++){let O=ud(r,p[x]);if(b+O>=c)break;b+=O}if(x==S+1){if(b>c){let O=p[S];d(O.children,O.positions,0,O.children.length,m[S]+w);continue}h.push(p[S])}else{let O=m[x-1]+p[x-1].length-y;h.push(iv(r,p,m,S,x,y,O,null,l))}u.push(y+w-s)}}return d(e,t,n,i,0),(o||l)(h,u,a)}class So{constructor(e,t,n,i,s=!1,a=!1){this.from=e,this.to=t,this.tree=n,this.offset=i,this.open=(s?1:0)|(a?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(e,t=[],n=!1){let i=[new So(0,e.length,e,0,!1,n)];for(let s of t)s.to>e.length&&i.push(s);return i}static applyChanges(e,t,n=128){if(!t.length)return e;let i=[],s=1,a=e.length?e[0]:null;for(let o=0,l=0,f=0;;o++){let c=o<t.length?t[o]:null,h=c?c.fromA:1e9;if(h-l>=n)for(;a&&a.from<h;){let u=a;if(l>=u.from||h<=u.to||f){let d=Math.max(u.from,l)-f,p=Math.min(u.to,h)-f;u=d>=p?null:new So(d,p,u.tree,u.offset+f,o>0,!!c)}if(u&&i.push(u),a.to>h)break;a=s<e.length?e[s++]:null}if(!c)break;l=c.toA,f=c.toA-c.toB}return i}}class kte{startParse(e,t,n){return typeof e=="string"&&(e=new Ste(e)),n=n?n.length?n.map(i=>new xm(i.from,i.to)):[new xm(0,0)]:[new xm(0,e.length)],this.createParse(e,t||[],n)}parse(e,t,n){let i=this.startParse(e,t,n);for(;;){let s=i.advance();if(s)return s}}}class Ste{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,t){return this.string.slice(e,t)}}new sr({perNode:!0});var vm;const vl=new sr;function Tte(r){return Le.define({combine:r?e=>e.concat(r):void 0})}const Cte=new sr;class Xi{constructor(e,t,n=[],i=""){this.data=e,this.name=i,lt.prototype.hasOwnProperty("tree")||Object.defineProperty(lt.prototype,"tree",{get(){return hh(this)}}),this.parser=t,this.extension=[nf.of(this),lt.languageData.of((s,a,o)=>{let l=i2(s,a,o),f=l.type.prop(vl);if(!f)return[];let c=s.facet(f),h=l.type.prop(Cte);if(h){let u=l.resolve(a-l.from,o);for(let d of h)if(d.test(u,s)){let p=s.facet(d.facet);return d.type=="replace"?p:p.concat(c)}}return c})].concat(n)}isActiveAt(e,t,n=-1){return i2(e,t,n).type.prop(vl)==this.data}findRegions(e){let t=e.facet(nf);if((t==null?void 0:t.data)==this.data)return[{from:0,to:e.doc.length}];if(!t||!t.allowsNesting)return[];let n=[],i=(s,a)=>{if(s.prop(vl)==this.data){n.push({from:a,to:a+s.length});return}let o=s.prop(sr.mounted);if(o){if(o.tree.prop(vl)==this.data){if(o.overlay)for(let l of o.overlay)n.push({from:l.from+a,to:l.to+a});else n.push({from:a,to:a+s.length});return}else if(o.overlay){let l=n.length;if(i(o.tree,o.overlay[0].from+a),n.length>l)return}}for(let l=0;l<s.children.length;l++){let f=s.children[l];f instanceof bn&&i(f,s.positions[l]+a)}};return i(hh(e),0),n}get allowsNesting(){return!0}}Xi.setState=ot.define();function i2(r,e,t){let n=r.facet(nf),i=hh(r).topNode;if(!n||n.allowsNesting)for(let s=i;s;s=s.enter(e,t,fn.ExcludeBuffers))s.type.isTop&&(i=s);return i}class m0 extends Xi{constructor(e,t,n){super(e,t,[],n),this.parser=t}static define(e){let t=Tte(e.languageData);return new m0(t,e.parser.configure({props:[vl.add(n=>n.isTop?t:void 0)]}),e.name)}configure(e,t){return new m0(this.data,this.parser.configure(e),t||this.name)}get allowsNesting(){return this.parser.hasWrappers()}}function hh(r){let e=r.field(Xi.state,!1);return e?e.tree:bn.empty}class Ate{constructor(e){this.doc=e,this.cursorPos=0,this.string="",this.cursor=e.iter()}get length(){return this.doc.length}syncTo(e){return this.string=this.cursor.next(e-this.cursorPos).value,this.cursorPos=e+this.string.length,this.cursorPos-this.string.length}chunk(e){return this.syncTo(e),this.string}get lineChunks(){return!0}read(e,t){let n=this.cursorPos-this.string.length;return e<n||t>=this.cursorPos?this.doc.sliceString(e,t):this.string.slice(e-n,t-n)}}let Df=null;class g0{constructor(e,t,n=[],i,s,a,o,l){this.parser=e,this.state=t,this.fragments=n,this.tree=i,this.treeLen=s,this.viewport=a,this.skipped=o,this.scheduleOn=l,this.parse=null,this.tempSkipped=[]}static create(e,t,n){return new g0(e,t,[],bn.empty,0,n,[],null)}startParse(){return this.parser.startParse(new Ate(this.state.doc),this.fragments)}work(e,t){return t!=null&&t>=this.state.doc.length&&(t=void 0),this.tree!=bn.empty&&this.isDone(t??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var n;if(typeof e=="number"){let i=Date.now()+e;e=()=>Date.now()>i}for(this.parse||(this.parse=this.startParse()),t!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>t)&&t<this.state.doc.length&&this.parse.stopAt(t);;){let i=this.parse.advance();if(i)if(this.fragments=this.withoutTempSkipped(So.addTree(i,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(n=this.parse.stoppedAt)!==null&&n!==void 0?n:this.state.doc.length,this.tree=i,this.parse=null,this.treeLen<(t??this.state.doc.length))this.parse=this.startParse();else return!0;if(e())return!1}})}takeTree(){let e,t;this.parse&&(e=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>e)&&this.parse.stopAt(e),this.withContext(()=>{for(;!(t=this.parse.advance()););}),this.treeLen=e,this.tree=t,this.fragments=this.withoutTempSkipped(So.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(e){let t=Df;Df=this;try{return e()}finally{Df=t}}withoutTempSkipped(e){for(let t;t=this.tempSkipped.pop();)e=s2(e,t.from,t.to);return e}changes(e,t){let{fragments:n,tree:i,treeLen:s,viewport:a,skipped:o}=this;if(this.takeTree(),!e.empty){let l=[];if(e.iterChangedRanges((f,c,h,u)=>l.push({fromA:f,toA:c,fromB:h,toB:u})),n=So.applyChanges(n,l),i=bn.empty,s=0,a={from:e.mapPos(a.from,-1),to:e.mapPos(a.to,1)},this.skipped.length){o=[];for(let f of this.skipped){let c=e.mapPos(f.from,1),h=e.mapPos(f.to,-1);c<h&&o.push({from:c,to:h})}}}return new g0(this.parser,t,n,i,s,a,o,this.scheduleOn)}updateViewport(e){if(this.viewport.from==e.from&&this.viewport.to==e.to)return!1;this.viewport=e;let t=this.skipped.length;for(let n=0;n<this.skipped.length;n++){let{from:i,to:s}=this.skipped[n];i<e.to&&s>e.from&&(this.fragments=s2(this.fragments,i,s),this.skipped.splice(n--,1))}return this.skipped.length>=t?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(e,t){this.skipped.push({from:e,to:t})}static getSkippingParser(e){return new class extends kte{createParse(t,n,i){let s=i[0].from,a=i[i.length-1].to;return{parsedPos:s,advance(){let l=Df;if(l){for(let f of i)l.tempSkipped.push(f);e&&(l.scheduleOn=l.scheduleOn?Promise.all([l.scheduleOn,e]):e)}return this.parsedPos=a,new bn(Ri.none,[],[],a-s)},stoppedAt:null,stopAt(){}}}}}isDone(e){e=Math.min(e,this.state.doc.length);let t=this.fragments;return this.treeLen>=e&&t.length&&t[0].from==0&&t[0].to>=e}static get(){return Df}}function s2(r,e,t){return So.applyChanges(r,[{fromA:e,toA:t,fromB:e,toB:t}])}class rf{constructor(e){this.context=e,this.tree=e.tree}apply(e){if(!e.docChanged&&this.tree==this.context.tree)return this;let t=this.context.changes(e.changes,e.state),n=this.context.treeLen==e.startState.doc.length?void 0:Math.max(e.changes.mapPos(this.context.treeLen),t.viewport.to);return t.work(20,n)||t.takeTree(),new rf(t)}static init(e){let t=Math.min(3e3,e.doc.length),n=g0.create(e.facet(nf).parser,e,{from:0,to:t});return n.work(20,t)||n.takeTree(),new rf(n)}}Xi.state=Cr.define({create:rf.init,update(r,e){for(let t of e.effects)if(t.is(Xi.setState))return t.value;return e.startState.facet(nf)!=e.state.facet(nf)?rf.init(e.state):r.apply(e)}});let SP=r=>{let e=setTimeout(()=>r(),500);return()=>clearTimeout(e)};typeof requestIdleCallback<"u"&&(SP=r=>{let e=-1,t=setTimeout(()=>{e=requestIdleCallback(r,{timeout:400})},100);return()=>e<0?clearTimeout(t):cancelIdleCallback(e)});const ym=typeof navigator<"u"&&(!((vm=navigator.scheduling)===null||vm===void 0)&&vm.isInputPending)?()=>navigator.scheduling.isInputPending():null,Ete=gr.fromClass(class{constructor(e){this.view=e,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(e){let t=this.view.state.field(Xi.state).context;(t.updateViewport(e.view.viewport)||this.view.viewport.to>t.treeLen)&&this.scheduleWork(),(e.docChanged||e.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(t)}scheduleWork(){if(this.working)return;let{state:e}=this.view,t=e.field(Xi.state);(t.tree!=t.context.tree||!t.context.isDone(e.doc.length))&&(this.working=SP(this.work))}work(e){this.working=null;let t=Date.now();if(this.chunkEnd<t&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=t+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:n,viewport:{to:i}}=this.view,s=n.field(Xi.state);if(s.tree==s.context.tree&&s.context.isDone(i+1e5))return;let a=Date.now()+Math.min(this.chunkBudget,100,e&&!ym?Math.max(25,e.timeRemaining()-5):1e9),o=s.context.treeLen<i&&n.doc.length>i+1e3,l=s.context.work(()=>ym&&ym()||Date.now()>a,i+(o?0:1e5));this.chunkBudget-=Date.now()-t,(l||this.chunkBudget<=0)&&(s.context.takeTree(),this.view.dispatch({effects:Xi.setState.of(new rf(s.context))})),this.chunkBudget>0&&!(l&&!o)&&this.scheduleWork(),this.checkAsyncSchedule(s.context)}checkAsyncSchedule(e){e.scheduleOn&&(this.workScheduled++,e.scheduleOn.then(()=>this.scheduleWork()).catch(t=>Jr(this.view.state,t)).then(()=>this.workScheduled--),e.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),nf=Le.define({combine(r){return r.length?r[0]:null},enables:r=>[Xi.state,Ete,Be.contentAttributes.compute([r],e=>{let t=e.facet(r);return t&&t.name?{"data-language":t.name}:{}})]});class Pte{constructor(e,t=[]){this.language=e,this.support=t,this.extension=[e,t]}}const Rte=new sr;function Qte({except:r,units:e=1}={}){return t=>{let n=r&&r.test(t.textAfter);return t.baseIndent+(n?0:e*t.unit)}}const Fte=new sr;class sv{constructor(e,t){this.specs=e;let n;function i(o){let l=Tn.newName();return(n||(n=Object.create(null)))["."+l]=o,l}const s=typeof t.all=="string"?t.all:t.all?i(t.all):void 0,a=t.scope;this.scope=a instanceof Xi?o=>o.prop(vl)==a.data:a?o=>o==a:void 0,this.style=pf(e.map(o=>({tag:o.tag,class:o.class||i(Object.assign({},o,{tag:null}))})),{all:s}).style,this.module=n?new Tn(n):null,this.themeType=t.themeType}static define(e,t){return new sv(e,t||{})}}B.meta,B.link,B.heading,B.emphasis,B.strong,B.strikethrough,B.keyword,B.atom,B.bool,B.url,B.contentSeparator,B.labelName,B.literal,B.inserted,B.string,B.deleted,B.regexp,B.escape,B.string,B.variableName,B.variableName,B.typeName,B.namespace,B.className,B.variableName,B.macroName,B.propertyName,B.comment,B.invalid;const $te=Object.create(null),a2=[Ri.none],o2=[],l2=Object.create(null),Nte=Object.create(null);for(let[r,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])Nte[r]=Dte($te,e);function wm(r,e){o2.indexOf(r)>-1||(o2.push(r),console.warn(e))}function Dte(r,e){let t=[];for(let o of e.split(" ")){let l=[];for(let f of o.split(".")){let c=r[f]||B[f];c?typeof c=="function"?l.length?l=l.map(c):wm(f,`Modifier ${f} used at start of tag`):l.length?wm(f,`Tag ${f} used as modifier`):l=Array.isArray(c)?c:[c]:wm(f,`Unknown highlighting tag ${f}`)}for(let f of l)t.push(f)}if(!t.length)return 0;let n=e.replace(/ /g,"_"),i=n+" "+t.map(o=>o.id),s=l2[i];if(s)return s.id;let a=l2[i]=Ri.define({id:a2.length,name:n,props:[sa({[n]:t})]});return a2.push(a),a.id}Rt.RTL,Rt.LTR;function f2(r){let e=Object.keys(r).join(""),t=/\w/.test(e);return t&&(e=e.replace(/\w/g,"")),`[${t?"\\w":""}${e.replace(/[^\w\s]/g,"\\$&")}]`}function Mte(r){let e=Object.create(null),t=Object.create(null);for(let{label:i}of r){e[i[0]]=!0;for(let s=1;s<i.length;s++)t[i[s]]=!0}let n=f2(e)+f2(t)+"*$";return[new RegExp("^"+n),new RegExp(n)]}function Ite(r){let e=r.map(i=>typeof i=="string"?{label:i}:i),[t,n]=e.every(i=>/^\w+$/.test(i.label))?[/\w*$/,/\w+$/]:Mte(e);return i=>{let s=i.matchBefore(n);return s||i.explicit?{from:s?s.from:i.pos,options:e,validFor:t}:null}}function Lte(r,e){return t=>{for(let n=hh(t.state).resolveInner(t.pos,-1);n;n=n.parent){if(r.indexOf(n.name)>-1)return null;if(n.type.isTop)break}return e(t)}}const TP=new class extends zs{};TP.startSide=1;TP.endSide=-1;const Bte=36,c2=1,Zte=2,al=3,bm=4,Wte=5,Ute=6,Xte=7,Vte=8,qte=9,jte=10,zte=11,Gte=12,Hte=13,Yte=14,Kte=15,Jte=16,ere=17,h2=18,tre=19,CP=20,AP=21,u2=22,rre=23,nre=24;function G1(r){return r>=65&&r<=90||r>=97&&r<=122||r>=48&&r<=57}function ire(r){return r>=48&&r<=57||r>=97&&r<=102||r>=65&&r<=70}function lo(r,e,t){for(let n=!1;;){if(r.next<0)return;if(r.next==e&&!n){r.advance();return}n=t&&!n&&r.next==92,r.advance()}}function sre(r,e){e:for(;;){if(r.next<0)return;if(r.next==36){r.advance();for(let t=0;t<e.length;t++){if(r.next!=e.charCodeAt(t))continue e;r.advance()}if(r.next==36){r.advance();return}}else r.advance()}}function are(r,e){let t="[{<(".indexOf(String.fromCharCode(e)),n=t<0?e:"]}>)".charCodeAt(t);for(;;){if(r.next<0)return;if(r.next==n&&r.peek(1)==39){r.advance(2);return}r.advance()}}function H1(r,e){for(;!(r.next!=95&&!G1(r.next));)e!=null&&(e+=String.fromCharCode(r.next)),r.advance();return e}function ore(r){if(r.next==39||r.next==34||r.next==96){let e=r.next;r.advance(),lo(r,e,!1)}else H1(r)}function d2(r,e){for(;r.next==48||r.next==49;)r.advance();e&&r.next==e&&r.advance()}function p2(r,e){for(;;){if(r.next==46){if(e)break;e=!0}else if(r.next<48||r.next>57)break;r.advance()}if(r.next==69||r.next==101)for(r.advance(),(r.next==43||r.next==45)&&r.advance();r.next>=48&&r.next<=57;)r.advance()}function m2(r){for(;!(r.next<0||r.next==10);)r.advance()}function ao(r,e){for(let t=0;t<e.length;t++)if(e.charCodeAt(t)==r)return!0;return!1}const _m=` 	\r
`;function EP(r,e,t){let n=Object.create(null);n.true=n.false=Wte,n.null=n.unknown=Ute;for(let i of r.split(" "))i&&(n[i]=CP);for(let i of e.split(" "))i&&(n[i]=AP);for(let i of(t||"").split(" "))i&&(n[i]=nre);return n}const lre="array binary bit boolean char character clob date decimal double float int integer interval large national nchar nclob numeric object precision real smallint time timestamp varchar varying ",fre="absolute action add after all allocate alter and any are as asc assertion at authorization before begin between both breadth by call cascade cascaded case cast catalog check close collate collation column commit condition connect connection constraint constraints constructor continue corresponding count create cross cube current current_date current_default_transform_group current_transform_group_for_type current_path current_role current_time current_timestamp current_user cursor cycle data day deallocate declare default deferrable deferred delete depth deref desc describe descriptor deterministic diagnostics disconnect distinct do domain drop dynamic each else elseif end end-exec equals escape except exception exec execute exists exit external fetch first for foreign found from free full function general get global go goto grant group grouping handle having hold hour identity if immediate in indicator initially inner inout input insert intersect into is isolation join key language last lateral leading leave left level like limit local localtime localtimestamp locator loop map match method minute modifies module month names natural nesting new next no none not of old on only open option or order ordinality out outer output overlaps pad parameter partial path prepare preserve primary prior privileges procedure public read reads recursive redo ref references referencing relative release repeat resignal restrict result return returns revoke right role rollback rollup routine row rows savepoint schema scroll search second section select session session_user set sets signal similar size some space specific specifictype sql sqlexception sqlstate sqlwarning start state static system_user table temporary then timezone_hour timezone_minute to trailing transaction translation treat trigger under undo union unique unnest until update usage user using value values view when whenever where while with without work write year zone ",Y1={backslashEscapes:!1,hashComments:!1,spaceAfterDashes:!1,slashComments:!1,doubleQuotedStrings:!1,doubleDollarQuotedStrings:!1,unquotedBitLiterals:!1,treatBitsAsBytes:!1,charSetCasts:!1,plsqlQuotingMechanism:!1,operatorChars:"*+-%<>!=&|~^/",specialVar:"?",identifierQuotes:'"',caseInsensitiveIdentifiers:!1,words:EP(fre,lre)};function cre(r,e,t,n){let i={};for(let s in Y1)i[s]=(r.hasOwnProperty(s)?r:Y1)[s];return e&&(i.words=EP(e,t||"",n)),i}function PP(r){return new Ha(e=>{var t;let{next:n}=e;if(e.advance(),ao(n,_m)){for(;ao(e.next,_m);)e.advance();e.acceptToken(Bte)}else if(n==36&&r.doubleDollarQuotedStrings){let i=H1(e,"");e.next==36&&(e.advance(),sre(e,i),e.acceptToken(al))}else if(n==39||n==34&&r.doubleQuotedStrings)lo(e,n,r.backslashEscapes),e.acceptToken(al);else if(n==35&&r.hashComments||n==47&&e.next==47&&r.slashComments)m2(e),e.acceptToken(c2);else if(n==45&&e.next==45&&(!r.spaceAfterDashes||e.peek(1)==32))m2(e),e.acceptToken(c2);else if(n==47&&e.next==42){e.advance();for(let i=1;;){let s=e.next;if(e.next<0)break;if(e.advance(),s==42&&e.next==47){if(i--,e.advance(),!i)break}else s==47&&e.next==42&&(i++,e.advance())}e.acceptToken(Zte)}else if((n==101||n==69)&&e.next==39)e.advance(),lo(e,39,!0),e.acceptToken(al);else if((n==110||n==78)&&e.next==39&&r.charSetCasts)e.advance(),lo(e,39,r.backslashEscapes),e.acceptToken(al);else if(n==95&&r.charSetCasts)for(let i=0;;i++){if(e.next==39&&i>1){e.advance(),lo(e,39,r.backslashEscapes),e.acceptToken(al);break}if(!G1(e.next))break;e.advance()}else if(r.plsqlQuotingMechanism&&(n==113||n==81)&&e.next==39&&e.peek(1)>0&&!ao(e.peek(1),_m)){let i=e.peek(1);e.advance(2),are(e,i),e.acceptToken(al)}else if(n==40)e.acceptToken(Xte);else if(n==41)e.acceptToken(Vte);else if(n==123)e.acceptToken(qte);else if(n==125)e.acceptToken(jte);else if(n==91)e.acceptToken(zte);else if(n==93)e.acceptToken(Gte);else if(n==59)e.acceptToken(Hte);else if(r.unquotedBitLiterals&&n==48&&e.next==98)e.advance(),d2(e),e.acceptToken(u2);else if((n==98||n==66)&&(e.next==39||e.next==34)){const i=e.next;e.advance(),r.treatBitsAsBytes?(lo(e,i,r.backslashEscapes),e.acceptToken(rre)):(d2(e,i),e.acceptToken(u2))}else if(n==48&&(e.next==120||e.next==88)||(n==120||n==88)&&e.next==39){let i=e.next==39;for(e.advance();ire(e.next);)e.advance();i&&e.next==39&&e.advance(),e.acceptToken(bm)}else if(n==46&&e.next>=48&&e.next<=57)p2(e,!0),e.acceptToken(bm);else if(n==46)e.acceptToken(Yte);else if(n>=48&&n<=57)p2(e,!1),e.acceptToken(bm);else if(ao(n,r.operatorChars)){for(;ao(e.next,r.operatorChars);)e.advance();e.acceptToken(Kte)}else if(ao(n,r.specialVar))e.next==n&&e.advance(),ore(e),e.acceptToken(ere);else if(ao(n,r.identifierQuotes))lo(e,n,!1),e.acceptToken(tre);else if(n==58||n==44)e.acceptToken(Jte);else if(G1(n)){let i=H1(e,String.fromCharCode(n));e.acceptToken(e.next==46||e.peek(-i.length-1)==46?h2:(t=r.words[i.toLowerCase()])!==null&&t!==void 0?t:h2)}})}const RP=PP(Y1),hre=Io.deserialize({version:14,states:"%vQ]QQOOO#wQRO'#DSO$OQQO'#CwO%eQQO'#CxO%lQQO'#CyO%sQQO'#CzOOQQ'#DS'#DSOOQQ'#C}'#C}O'UQRO'#C{OOQQ'#Cv'#CvOOQQ'#C|'#C|Q]QQOOQOQQOOO'`QQO'#DOO(xQRO,59cO)PQQO,59cO)UQQO'#DSOOQQ,59d,59dO)cQQO,59dOOQQ,59e,59eO)jQQO,59eOOQQ,59f,59fO)qQQO,59fOOQQ-E6{-E6{OOQQ,59b,59bOOQQ-E6z-E6zOOQQ,59j,59jOOQQ-E6|-E6|O+VQRO1G.}O+^QQO,59cOOQQ1G/O1G/OOOQQ1G/P1G/POOQQ1G/Q1G/QP+kQQO'#C}O+rQQO1G.}O)PQQO,59cO,PQQO'#Cw",stateData:",[~OtOSPOSQOS~ORUOSUOTUOUUOVROXSOZTO]XO^QO_UO`UOaPObPOcPOdUOeUOfUOgUOhUO~O^]ORvXSvXTvXUvXVvXXvXZvX]vX_vX`vXavXbvXcvXdvXevXfvXgvXhvX~OsvX~P!jOa_Ob_Oc_O~ORUOSUOTUOUUOVROXSOZTO^tO_UO`UOa`Ob`Oc`OdUOeUOfUOgUOhUO~OWaO~P$ZOYcO~P$ZO[eO~P$ZORUOSUOTUOUUOVROXSOZTO^QO_UO`UOaPObPOcPOdUOeUOfUOgUOhUO~O]hOsoX~P%zOajObjOcjO~O^]ORkaSkaTkaUkaVkaXkaZka]ka_ka`kaakabkackadkaekafkagkahka~Oska~P'kO^]O~OWvXYvX[vX~P!jOWnO~P$ZOYoO~P$ZO[pO~P$ZO^]ORkiSkiTkiUkiVkiXkiZki]ki_ki`kiakibkickidkiekifkigkihki~Oski~P)xOWkaYka[ka~P'kO]hO~P$ZOWkiYki[ki~P)xOasObsOcsO~O",goto:"#hwPPPPPPPPPPPPPPPPPPPPPPPPPPx||||!Y!^!d!xPPP#[TYOZeUORSTWZbdfqT[OZQZORiZSWOZQbRQdSQfTZgWbdfqQ^PWk^lmrQl_Qm`RrseVORSTWZbdfq",nodeNames:" LineComment BlockComment String Number Bool Null ( ) { } [ ] ; . Operator Punctuation SpecialVar Identifier QuotedIdentifier Keyword Type Bits Bytes Builtin Script Statement CompositeIdentifier Parens Braces Brackets Statement",maxTerm:38,nodeProps:[["isolate",-4,1,2,3,19,""]],skippedNodes:[0,1,2],repeatNodeCount:3,tokenData:"RORO",tokenizers:[0,RP],topRules:{Script:[0,25]},tokenPrec:0});function K1(r){let e=r.cursor().moveTo(r.from,-1);for(;/Comment/.test(e.name);)e.moveTo(e.from,-1);return e.node}function uh(r,e){let t=r.sliceString(e.from,e.to),n=/^([`'"])(.*)\1$/.exec(t);return n?n[2]:t}function O0(r){return r&&(r.name=="Identifier"||r.name=="QuotedIdentifier")}function ure(r,e){if(e.name=="CompositeIdentifier"){let t=[];for(let n=e.firstChild;n;n=n.nextSibling)O0(n)&&t.push(uh(r,n));return t}return[uh(r,e)]}function g2(r,e){for(let t=[];;){if(!e||e.name!=".")return t;let n=K1(e);if(!O0(n))return t;t.unshift(uh(r,n)),e=K1(n)}}function dre(r,e){let t=hh(r).resolveInner(e,-1),n=mre(r.doc,t);return t.name=="Identifier"||t.name=="QuotedIdentifier"||t.name=="Keyword"?{from:t.from,quoted:t.name=="QuotedIdentifier"?r.doc.sliceString(t.from,t.from+1):null,parents:g2(r.doc,K1(t)),aliases:n}:t.name=="."?{from:e,quoted:null,parents:g2(r.doc,t),aliases:n}:{from:e,quoted:null,parents:[],empty:!0,aliases:n}}const pre=new Set("where group having order union intersect except all distinct limit offset fetch for".split(" "));function mre(r,e){let t;for(let i=e;!t;i=i.parent){if(!i)return null;i.name=="Statement"&&(t=i)}let n=null;for(let i=t.firstChild,s=!1,a=null;i;i=i.nextSibling){let o=i.name=="Keyword"?r.sliceString(i.from,i.to).toLowerCase():null,l=null;if(!s)s=o=="from";else if(o=="as"&&a&&O0(i.nextSibling))l=uh(r,i.nextSibling);else{if(o&&pre.has(o))break;a&&O0(i)&&(l=uh(r,i))}l&&(n||(n=Object.create(null)),n[l]=ure(r,a)),a=/Identifier$/.test(i.name)?i:null}return n}function gre(r,e){return r?e.map(t=>Object.assign(Object.assign({},t),{label:t.label[0]==r?t.label:r+t.label+r,apply:void 0})):e}const Ore=/^\w*$/,xre=/^[`'"]?\w*[`'"]?$/;function O2(r){return r.self&&typeof r.self.label=="string"}class av{constructor(e,t){this.idQuote=e,this.idCaseInsensitive=t,this.list=[],this.children=void 0}child(e){let t=this.children||(this.children=Object.create(null)),n=t[e];return n||(e&&!this.list.some(i=>i.label==e)&&this.list.push(x2(e,"type",this.idQuote,this.idCaseInsensitive)),t[e]=new av(this.idQuote,this.idCaseInsensitive))}maybeChild(e){return this.children?this.children[e]:null}addCompletion(e){let t=this.list.findIndex(n=>n.label==e.label);t>-1?this.list[t]=e:this.list.push(e)}addCompletions(e){for(let t of e)this.addCompletion(typeof t=="string"?x2(t,"property",this.idQuote,this.idCaseInsensitive):t)}addNamespace(e){Array.isArray(e)?this.addCompletions(e):O2(e)?this.addNamespace(e.children):this.addNamespaceObject(e)}addNamespaceObject(e){for(let t of Object.keys(e)){let n=e[t],i=null,s=t.replace(/\\?\./g,o=>o=="."?"\0":o).split("\0"),a=this;O2(n)&&(i=n.self,n=n.children);for(let o=0;o<s.length;o++)i&&o==s.length-1&&a.addCompletion(i),a=a.child(s[o].replace(/\\\./g,"."));a.addNamespace(n)}}}function x2(r,e,t,n){return new RegExp("^[a-z_][a-z_\\d]*$",n?"i":"").test(r)?{label:r,type:e}:{label:r,type:e,apply:t+r+t}}function vre(r,e,t,n,i,s){var a;let o=((a=s==null?void 0:s.spec.identifierQuotes)===null||a===void 0?void 0:a[0])||'"',l=new av(o,!!(s!=null&&s.spec.caseInsensitiveIdentifiers)),f=i?l.child(i):null;return l.addNamespace(r),e&&(f||l).addCompletions(e),t&&l.addCompletions(t),f&&l.addCompletions(f.list),n&&l.addCompletions((f||l).child(n).list),c=>{let{parents:h,from:u,quoted:d,empty:p,aliases:m}=dre(c.state,c.pos);if(p&&!c.explicit)return null;m&&h.length==1&&(h=m[h[0]]||h);let g=l;for(let x of h){for(;!g.children||!g.children[x];)if(g==l&&f)g=f;else if(g==f&&n)g=g.child(n);else return null;let S=g.maybeChild(x);if(!S)return null;g=S}let v=d&&c.state.sliceDoc(c.pos,c.pos+1)==d,w=g.list;return g==l&&m&&(w=w.concat(Object.keys(m).map(x=>({label:x,type:"constant"})))),{from:u,to:v?c.pos+1:void 0,options:gre(d,w),validFor:d?xre:Ore}}}function yre(r){return r==AP?"type":r==CP?"keyword":"variable"}function wre(r,e,t){let n=Object.keys(r).map(i=>t(e?i.toUpperCase():i,yre(r[i])));return Lte(["QuotedIdentifier","SpecialVar","String","LineComment","BlockComment","."],Ite(n))}let bre=hre.configure({props:[Rte.add({Statement:Qte()}),Fte.add({Statement(r,e){return{from:Math.min(r.from+100,e.doc.lineAt(r.from).to),to:r.to}},BlockComment(r){return{from:r.from+2,to:r.to-2}}}),sa({Keyword:B.keyword,Type:B.typeName,Builtin:B.standard(B.name),Bits:B.number,Bytes:B.string,Bool:B.bool,Null:B.null,Number:B.number,String:B.string,Identifier:B.name,QuotedIdentifier:B.special(B.string),SpecialVar:B.special(B.name),LineComment:B.lineComment,BlockComment:B.blockComment,Operator:B.operator,"Semi Punctuation":B.punctuation,"( )":B.paren,"{ }":B.brace,"[ ]":B.squareBracket})]});class ov{constructor(e,t,n){this.dialect=e,this.language=t,this.spec=n}get extension(){return this.language.extension}static define(e){let t=cre(e,e.keywords,e.types,e.builtin),n=m0.define({name:"sql",parser:bre.configure({tokenizers:[{from:RP,to:PP(t)}]}),languageData:{commentTokens:{line:"--",block:{open:"/*",close:"*/"}},closeBrackets:{brackets:["(","[","{","'",'"',"`"]}}});return new ov(t,n,e)}}function _re(r,e){return{label:r,type:e,boost:-1}}function kre(r,e=!1,t){return wre(r.dialect.words,e,t||_re)}function Sre(r){return r.schema?vre(r.schema,r.tables,r.schemas,r.defaultTable,r.defaultSchema,r.dialect||lv):()=>null}function Tre(r){return r.schema?(r.dialect||lv).language.data.of({autocomplete:Sre(r)}):[]}function Cre(r={}){let e=r.dialect||lv;return new Pte(e.language,[Tre(r),e.language.data.of({autocomplete:kre(e,r.upperCaseKeywords,r.keywordCompletion)})])}const lv=ov.define({});var Are=(r,e)=>{e()},Ere=J("<option> </option>"),Pre=J('<i class="fa-solid fa-triangle-exclamation"></i>'),Rre=J('<div class="field is-horizontal"><div class="field-label is-small"><label class="label">Language</label></div> <div class="field-body"><div class="field is-narrow"><div class="control has-icons-left"><div><select></select> <span class="icon is-small is-left"><!></span></div></div></div></div></div>'),Qre=J('<div class="control"><div class="tags has-addons"><span class="tag is-dark">Format</span> <span> </span></div></div>'),Fre=async(r,e)=>{await e()},$re=J('<button class="button is-small">Format</button>'),Nre=(r,e)=>{e()},Dre=J('<button class="button is-small"><span class="icon is-small"><i class="fa-solid fa-rotate-left"></i></span> <span>Reset</span></button>'),Mre=(r,e)=>{e(!e())},Ire=J('<i class="fa-solid fa-eye-slash"></i>'),Lre=J('<i class="fa-solid fa-eye"></i>'),Bre=J('<button title="Hide or show Code" class="button is-small"><span class="icon is-small"><!></span></button>'),Zre=J("<!> <!> <!>",1),Wre=J("<!> <div></div>",1);function ui(r,e){Ot(e,!0);const t=V=>{var he=Ae(),ae=ye(he);{var E=I=>{var Z=Rre(),ee=te(R(Z),2),ne=R(ee),de=R(ne),fe=R(de),pe=R(fe);pe.__change=[Are,A],Pr(pe,21,()=>S,Lr,(Ve,Te)=>{var Ne=Ere(),ve={},ct=R(Ne,!0);P(Ne),Re(()=>{ve!==(ve=C(Te).value)&&(Ne.value=(Ne.__value=C(Te).value)==null?"":C(Te).value),Ge(ct,C(Te).label)}),W(Ve,Ne)}),P(pe);var Me=te(pe,2),q=R(Me);{var He=Ve=>{var Te=Pre();W(Ve,Te)};se(q,Ve=>{C(g)&&Ve(He)})}P(Me),P(fe),P(de),P(ne),P(ee),P(Z),Re(()=>ft(fe,`select is-small ${(C(g)?"is-danger":"")??""}`)),Fl(pe,o),W(I,Z)},L=I=>{var Z=Qre(),ee=R(Z),ne=te(R(ee),2),de=R(ne,!0);P(ne),P(ee),P(Z),Re(()=>{ft(ne,`tag ${(C(g)?"is-danger":"is-success")??""}`),Ge(de,o())}),W(I,Z)};se(ae,I=>{f()?I(E):I(L,!1)})}W(V,he)},n=V=>{var he=Zre(),ae=ye(he);{var E=ne=>{var de=$re();de.__click=[Fre,_],W(ne,de)};se(ae,ne=>{l()&&o()=="json"&&ne(E)})}var L=te(ae,2);{var I=ne=>{var de=Dre();de.__click=[Nre,T],W(ne,de)};se(L,ne=>{u()&&ne(I)})}var Z=te(L,2);{var ee=ne=>{var de=Bre();de.__click=[Mre,d];var fe=R(de),pe=R(fe);{var Me=He=>{var Ve=Ire();W(He,Ve)},q=He=>{var Ve=Lre();W(He,Ve)};se(pe,He=>{d()?He(Me):He(q,!1)})}P(fe),P(de),W(ne,de)};se(Z,ne=>{h()&&ne(ee)})}W(V,he)};let i,s,a=me(e,"code",15,""),o=me(e,"lang",15,"json"),l=me(e,"showFormat",11,!1),f=me(e,"showSelectLang",11,!1),c=me(e,"isReadOnly",11,!1),h=me(e,"showHiddenButton",11,!0),u=me(e,"showResetButton",11,!1),d=me(e,"showCode",15,!0),p=me(e,"onchange",3,V=>{}),m="",g=be(!1),v="",w;const x={js:qJ(),json:_ee(),html:J_(),sql:Cre(),xml:J_()};let S=Y([{label:"None",value:"none"},{label:"HTML",value:"html"},{label:"Javascript",value:"js"},{label:"JSON",value:"json"},{label:"SQL",value:"sql"},{label:"XML",value:"xml"},{label:"Text",value:"text"}]),y;Js(()=>{k()});function b(V){a(V)}function O(){try{return H(g,!1),o()==="json"?JSON.parse(i.state.doc.toString()):i.state.doc.toString()}catch{return H(g,!0),i.state.doc.toString()}}function T(){v=m,k()}function k(){m=a();let V=N(m);H(g,Y(V.error)),v=V.code,Q(v)}function Q(V){if(i&&i.state&&V!=i.state.doc.toString()){const he=i.state.update({changes:{from:0,to:i.state.doc.length,insert:V}});i.dispatch(he)}}function A(){if(s){i&&i.destroy(),_();let V=x[o()]?x[o()]:[];i=new Be({doc:v,extensions:[JY,c()?lt.readOnly.of(!0):[],V,Be.updateListener.of(async he=>{he.changes&&he.changedRanges.length>0&&(v=he.state.doc.toString(),clearTimeout(w),w=setTimeout(()=>{if(_(),!C(g))try{o()==="json"?a(JSON.parse(v)):a(v),k(),p()(Ht({lang:o(),code:a()}))}catch(ae){console.log(ae)}},750))})],parent:s})}}function _(){if(i&&i.state){let V=N(i.state.doc.toString());H(g,Y(V.error)),v=V.code}}function N(V){let he={code:V,error:void 0};if(o()=="json")try{typeof V=="object"?he.code=JSON.stringify(V,null,2):he.code=JSON.stringify(JSON.parse(V),null,2)}catch(ae){he.error=ae}else he.code=typeof V!="string"?JSON.stringify(V):V;return he}It(()=>{A()}),ea(()=>{clearTimeout(w),clearTimeout(y)});var U=Wre(),z=ye(U),K=Pa(()=>[e.left,t]),re=Pa(()=>[e.right,n]);Nl(z,{get left(){return C(K)},get right(){return C(re)}});var ge=te(z,2);return R2(ge,V=>s=V,()=>s),Re(()=>ft(ge,oi(d()?"":"is-hidden"))),W(r,U),xt({setCode:b,getCode:O,reset:T})}Or(["change","click"]);function Ure(r,e,t){e()({value:t()})}var Xre=J("<option> </option>"),Vre=J("<div><select><!></select></div>");function km(r,e){Ot(e,!0);let t=me(e,"option",15,""),n=me(e,"options",27,()=>Y([{id:"TEST",value:"TEST",enabled:!0}])),i=me(e,"css_class",11," is-small "),s=me(e,"onselect",3,c=>{});var a=Vre(),o=R(a);o.__change=[Ure,s,t];var l=R(o);{var f=c=>{var h=Ae(),u=ye(h);Pr(u,17,n,Lr,(d,p)=>{var m=Xre(),g={},v=R(m,!0);P(m),Re(()=>{g!==(g=C(p).id)&&(m.value=(m.__value=C(p).id)==null?"":C(p).id),Ge(v,C(p).value)}),W(d,m)}),W(c,h)};se(l,c=>{n()&&Array.isArray(n())&&c(f)})}P(o),P(a),Re(()=>ft(a,`select ${i()??""}`)),Fl(o,t),W(r,a),xt()}Or(["change"]);var qre=J('<div><div class="overlay svelte-10va6op"><div class="overlay-content box svelte-10va6op"><!></div></div></div>');function jre(r,e){Ot(e,!0);let t=me(e,"show",11,!1);var n=qre(),i=R(n),s=R(i),a=R(s);pd(a,()=>e.children??dd),P(s),P(i),P(n),Re(()=>Ra(i,"style",`width: ${(t()?"100%":"0%")??""};`)),W(r,n),xt()}function J1(r,e){Ot(e,!0);let t=me(e,"data",15),n={enabled:{label:"Enabled",decorator:{component:bc,props:{ontrue:{label:"Enabled"},onfalse:{label:"Unabled"},editInline:!0}}},key:{label:"Key",decorator:{component:Zm,props:{editInline:!0}}},value:{label:"Value",decorator:{component:Zm,props:{editInline:!0}}}};function i(){!t()||!Array.isArray(t())?(t([]),t().push({enabled:!1,key:"",value:""})):t()&&Array.isArray(t())&&!t().find(s=>s.key=="")&&t().push({enabled:!0,key:"",value:""})}It(()=>{i()}),Th(r,{columns:n,ShowNewButton:!0,ShowDeleteButton:!0,onnewrow:()=>{i()},get RawDataTable(){return t()},set RawDataTable(s){t(s)}}),xt()}const zre=r=>{var e=Gre();W(r,e)};var Gre=J('<label class="label is-small">No Authentication Selected</label>'),Hre=J('<div class="control has-icons-left has-icons-right"><input class="input is-small" type="text" placeholder="Username"> <span class="icon is-small is-left"><i class="fa-solid fa-user"></i></span></div>'),Yre=J('<div class="control has-icons-left has-icons-right"><input class="input is-small" type="text" placeholder="Password"> <span class="icon is-small is-left"><i class="fa-solid fa-key"></i></span></div>'),Kre=J('<div><div class="field"><label class="label is-small">Username</label> <!></div> <div class="field"><label class="label is-small">Password</label> <!></div></div>'),Jre=J('<textarea class="textarea is-small" placeholder="Token"></textarea>'),ene=J('<div><div class="field"><label class="label is-small">Token</label> <div class="control"><!></div></div></div>');function tne(r,e){Ot(e,!0);const t=c=>{var h=Ae(),u=ye(h);{var d=p=>{var m=Kre(),g=R(m),v=te(R(g),2);{var w=b=>{var O=Hre(),T=R(O);Et(T),Lt(2),P(O),Xt(T,()=>i().basic.username,k=>i(i().basic.username=k,!0)),W(b,O)};se(v,b=>{i()&&i().basic&&b(w)})}P(g);var x=te(g,2),S=te(R(x),2);{var y=b=>{var O=Yre(),T=R(O);Et(T),Lt(2),P(O),Xt(T,()=>i().basic.passsword,k=>i(i().basic.passsword=k,!0)),W(b,O)};se(S,b=>{i()&&i().basic&&b(y)})}P(x),P(m),W(p,m)};se(u,p=>{i()&&p(d)})}W(c,h)},n=c=>{var h=Ae(),u=ye(h);{var d=p=>{var m=ene(),g=R(m),v=te(R(g),2),w=R(v);{var x=S=>{var y=Jre();x0(y),Xt(y,()=>i().bearer.token,b=>i(i().bearer.token=b,!0)),W(S,y)};se(w,S=>{i()&&i().bearer&&S(x)})}P(v),P(g),P(m),W(p,m)};se(u,p=>{i()!=null&&p(d)})}W(c,h)};let i=me(e,"data",31,()=>Y({selection:0,basic:{username:"",passsword:""},bearer:{token:""}})),s=be(Y([{label:"None",component:zre},{label:"Basic",component:t},{label:"Bearer",component:n}]));function a(){i()==null&&i({basic:{username:"",passsword:""},bearer:{token:""}}),i()&&i().basic==null&&i(i().basic={username:"",passsword:""},!0),i()&&i().bearer==null&&i(i().bearer={token:""},!0),i()&&i().selection==null&&i(i().selection=0,!0)}It(()=>{a()});var o=Ae(),l=ye(o);{var f=c=>{Mn(c,{get tabs(){return C(s)},set tabs(h){H(s,Y(h))},get active(){return i().selection},set active(h){i(i().selection=h,!0)}})};se(l,c=>{i()!=null&&c(f)})}W(r,o),xt()}var rne=J("<div><!></div>"),nne=J('<textarea class="textarea is-small" placeholder="Content"></textarea>'),ine=J('<div><div class="field"><label class="label is-small">Content</label> <div class="control"><!></div></div></div>'),sne=J("<div><!></div>"),ane=(r,e)=>{r.target.files.length>0&&H(e,Y(r.target.files[0].name))},one=J('<div><div class="file has-name is-small"><label class="file-label"><input class="file-input is-small" type="file" name="resume"> <span class="file-cta"><span class="file-icon is-small"><i class="fas fa-upload"></i></span> <span class="file-label">Choose a file</span></span> <span class="file-name"> </span></label></div></div>');function lne(r,e){Ot(e,!0);const t=g=>{var v=rne(),w=R(v);{var x=S=>{ui(S,{lang:"json",get code(){return o().json.code},set code(y){o(o().json.code=y,!0)}})};se(w,S=>{o()&&o().json&&S(x)})}P(v),W(g,v)},n=g=>{var v=Ae(),w=ye(v);{var x=S=>{ui(S,{lang:"xml",get code(){return o().xml.code},set code(y){o(o().xml.code=y,!0)}})};se(w,S=>{o()&&o().xml&&S(x)})}W(g,v)},i=g=>{var v=Ae(),w=ye(v);{var x=S=>{var y=ine(),b=R(y),O=te(R(b),2),T=R(O);{var k=Q=>{var A=nne();x0(A),Xt(A,()=>o().text.value,_=>o(o().text.value=_,!0)),W(Q,A)};se(T,Q=>{o()&&o().text&&Q(k)})}P(O),P(b),P(y),W(S,y)};se(w,S=>{o()&&S(x)})}W(g,v)},s=g=>{var v=Ae(),w=ye(v);{var x=S=>{var y=sne(),b=R(y);J1(b,{}),P(y),W(S,y)};se(w,S=>{o()&&S(x)})}W(g,v)},a=g=>{var v=Ae(),w=ye(v);{var x=S=>{var y=one(),b=R(y),O=R(b),T=R(O);T.__change=[ane,l];var k=te(T,4),Q=R(k,!0);P(k),P(O),P(b),P(y),Re(()=>Ge(Q,C(l))),W(S,y)};se(w,S=>{o()&&S(x)})}W(g,v)};let o=me(e,"data",31,()=>Y({selection:0,json:{code:{}},xml:{code:""},text:{}})),l=be(""),f=be(Y([{label:"JSON",component:t},{label:"XML",disabled:!0,component:n},{label:"Text",disabled:!0,component:i},{label:"Form-Encode",disabled:!0,component:s},{label:"Binary",disabled:!0,component:a}]));function c(){}function h(){}function u(){o()||o({selection:0,json:{code:{}},xml:{code:""},text:{}}),o()&&!o().json&&o(o().json={},!0),o()&&o().json&&!o().json.code&&o(o().json.code={},!0),o()&&!o().xml&&o(o().xml={},!0),o()&&o().xml&&!o().xml.code&&o(o().xml.code="",!0),o()&&!o().text&&o(o().text={},!0),o()&&!o().selection&&o(o().selection=0,!0)}It(()=>{u()});var d=Ae(),p=ye(d);{var m=g=>{Mn(g,{get tabs(){return C(f)},set tabs(v){H(f,Y(v))},get active(){return o().selection},set active(v){o(o().selection=v,!0)}})};se(p,g=>{o()&&g(m)})}return W(r,d),xt({getCode:c,reset:h})}Or(["change"]);var fne=J('<div class="box"><code><!></code></div>');function zi(r,e){Ot(e,!0);let t=me(e,"jsonObject",27,()=>Y({}));function n(f){return JSON.stringify(f,null,2).replace(/\n/g,"<br/>").replace(/ /g,"&nbsp;")}var i=fne(),s=R(i),a=R(s);{var o=f=>{var c=Ae(),h=ye(c);F2(h,()=>n(t())),W(f,c)},l=f=>{var c=ms();Re(()=>Ge(c,t())),W(f,c)};se(a,f=>{t()&&typeof t()=="object"?f(o):f(l,!1)})}P(s),P(i),W(r,i),xt()}var cne=J('<span class="tag"> </span>'),hne=J('<span class="tag"></span>'),une=J('<span class="tag"> </span>'),dne=J('<span class="tag"></span>'),pne=J('<span class="tag"> </span>'),mne=J('<span class="tag"></span>'),gne=J('<span class="tag"> </span>'),One=J('<span class="tag">ms</span>'),xne=J('<span class="tag"> </span>'),vne=J('<span class="tag">KB</span>'),yne=J("<code> </code>"),wne=(r,e,t,n)=>{C(e)=="json"?t(JSON.stringify(C(n)),"response.json","text/json"):C(e)=="text"&&t(C(n),"response.txt","text/plain")},bne=J('<div class="container is-max-tablet is-small"><p class="block"> </p> <div class="is-align-content-center"><button class="button is-link is-outlined is-small">Download</button></div></div>'),_ne=J('<div class="field is-grouped is-grouped-multiline"><div class="control"><div class="tags has-addons"><span>Status</span> <!></div></div> <div class="control"><div class="tags has-addons"><span>Status Text</span> <!></div></div> <div class="control"><div class="tags has-addons"><span>Ok</span> <!></div></div> <div class="control"><div class="tags has-addons"><span class="tag is-dark">Time</span> <!></div></div> <div class="control"><div class="tags has-addons"><span>Size</span> <!></div></div></div> <div><!></div>',1),kne=J("<option> </option>"),Sne=J("<option> </option>"),Tne=async(r,e,t,n,i,s,a,o,l,f,c,h,u,d,p,m,g)=>{if(H(e,4),C(t))alert("There is an execution in progress");else{H(t,!0);let v={};try{if(n()=="GET"||n()=="HEAD"||n()=="OPTIONS"||n()=="CONNECT"||n()=="TRACE")v=i(s().query);else if(n()=="POST"||n()=="PUT"||n()=="PATCH"){let S=a();S?v=S:v=i(s().query)}o();let w=Date.now();H(l,Y(await f[n()]({url:c(),data:v,headers:h(s().headers)})));let x=Date.now();if(H(u,x-w),console.warn(C(l)),C(l).ok)switch(C(d)){case"json":H(p,Y(await C(l).json())),H(m,Y(g(C(p))));break;case"text":H(p,Y(await C(l).text()));break;case"datatable":H(p,Y(await C(l).json())),H(m,Y(g(C(p))));break;default:H(p,""),H(m,-1);break}else H(p,Y(await C(l).json()))}catch(w){H(t,!1),console.error(w),H(p,Y(w)),alert(w)}H(t,!1)}},Cne=J('<i class="fa-solid fa-cog fa-spin"></i>'),Ane=J('<i class="fa-solid fa-play"></i>'),Ene=J('<div class="block block_marg svelte-1ndugcm"><div class="columns"><div class="column is-half"><div class="field has-addons"><p class="control"><a class="button is-static is-small">Url</a></p> <p class="control is-expanded"><input class="input is-small is-expanded" type="text" placeholder="URL"></p></div></div> <div class="column"><nav class="level"><div class="level-right"><span class="level-item"><div class="field has-addons"><p class="control"><button class="button is-static is-small">Method:</button></p> <p class="control"><span class="select is-small"><select></select></span></p></div></span> <span class="level-item"><div class="field has-addons"><p class="control"><button class="button is-static is-small">Show as:</button></p> <p class="control"><span class="select is-small"><select></select></span></p></div></span> <span class="level-item"><button class="button is-success is-small is-outlined"><span class="icon is-small"><!></span> <span>Execute</span></button></span></div></nav></div></div> <!></div>');function aa(r,e){Ot(e,!0);const t=Qe=>{var Xe=Ae(),De=ye(Xe);{var ke=Ee=>{J1(Ee,{get data(){return h().query},set data(Ft){h(h().query=Ft,!0)}})};se(De,Ee=>{h()&&Ee(ke)})}W(Qe,Xe)},n=Qe=>{var Xe=Ae(),De=ye(Xe);{var ke=Ee=>{J1(Ee,{get data(){return h().headers},set data(Ft){h(h().headers=Ft,!0)}})};se(De,Ee=>{h()!=null&&Ee(ke)})}W(Qe,Xe)},i=Qe=>{var Xe=Ae(),De=ye(Xe);{var ke=Ee=>{tne(Ee,{get data(){return h().auth},set data(Ft){h(h().auth=Ft,!0)}})};se(De,Ee=>{h()!=null&&Ee(ke)})}W(Qe,Xe)},s=Qe=>{var Xe=Ae(),De=ye(Xe);{var ke=Ee=>{lne(Ee,{get data(){return h().body},set data(Ft){h(h().body=Ft,!0)}})};se(De,Ee=>{h()&&Ee(ke)})}W(Qe,Xe)},a=Qe=>{var Xe=_ne(),De=ye(Xe),ke=R(De),Ee=R(ke),Ft=R(Ee),xr=te(Ft,2);{var Vt=D=>{var M=cne(),X=R(M,!0);P(M),Re(()=>Ge(X,C(d).status)),W(D,M)},Ke=D=>{var M=hne();W(D,M)};se(xr,D=>{C(d)&&C(d).status?D(Vt):D(Ke,!1)})}P(Ee),P(ke);var zt=te(ke,2),tr=R(zt),ur=R(tr),di=te(ur,2);{var Ya=D=>{var M=une(),X=R(M,!0);P(M),Re(()=>Ge(X,C(d).statusText)),W(D,M)},xf=D=>{var M=dne();W(D,M)};se(di,D=>{C(d)&&C(d).statusText?D(Ya):D(xf,!1)})}P(tr),P(zt);var la=te(zt,2),Ka=R(la),Ja=R(Ka),fa=te(Ja,2);{var jo=D=>{var M=pne(),X=R(M,!0);P(M),Re(()=>Ge(X,C(d).ok)),W(D,M)},eo=D=>{var M=mne();W(D,M)};se(fa,D=>{C(d)&&C(d).ok?D(jo):D(eo,!1)})}P(Ka),P(la);var ns=te(la,2),ca=R(ns),zo=te(R(ca),2);{var Go=D=>{var M=gne(),X=R(M);P(M),Re(()=>Ge(X,`${C(p)??""} ms`)),W(D,M)},vf=D=>{var M=One();W(D,M)};se(zo,D=>{C(p)?D(Go):D(vf,!1)})}P(ca),P(ns);var Ce=te(ns,2),qe=R(Ce),pt=R(qe),ut=te(pt,2);{var tt=D=>{var M=xne(),X=R(M);P(M),Re(()=>Ge(X,`${C(x)??""} KB`)),W(D,M)},mt=D=>{var M=vne();W(D,M)};se(ut,D=>{C(x)?D(tt):D(mt,!1)})}P(qe),P(Ce),P(De);var dr=te(De,2),Zr=R(dr);{var F=D=>{var M=Ae(),X=ye(M);{var G=ue=>{zi(ue,{get jsonObject(){return C(v)},set jsonObject(ie){H(v,Y(ie))}})},oe=ue=>{var ie=Ae(),le=ye(ie);{var ce=Pe=>{zi(Pe,{get jsonObject(){return C(v)},set jsonObject(We){H(v,Y(We))}})},_e=Pe=>{var We=Ae(),Se=ye(We);{var Ze=Je=>{var nt=yne(),Tt=R(nt,!0);P(nt),Re(()=>Ge(Tt,C(v))),W(Je,nt)},rt=Je=>{var nt=Ae(),Tt=ye(nt);{var ar=vt=>{Th(vt,{get RawDataTable(){return C(v)},set RawDataTable(vr){H(v,Y(vr))}})};se(Tt,vt=>{C(m)=="datatable"&&C(v)&&vt(ar)},!0)}W(Je,nt)};se(Se,Je=>{C(m)=="text"&&C(v)?Je(Ze):Je(rt,!1)},!0)}W(Pe,We)};se(le,Pe=>{C(m)=="json"&&C(v)?Pe(ce):Pe(_e,!1)},!0)}W(ue,ie)};se(X,ue=>{C(d)&&!C(d).ok&&C(v)?ue(G):ue(oe,!1)})}W(D,M)},j=D=>{var M=bne(),X=R(M),G=R(X);P(X);var oe=te(X,2),ue=R(oe);ue.__click=[wne,m,A,v],P(oe),P(M),Re(()=>Ge(G,`The response exceeds ${f()??""} KB, it cannot be displayed in the view.`)),W(D,M)};se(Zr,D=>{Number(C(x))<Number(f())?D(F):D(j,!1)})}P(dr),Re(()=>{ft(Ft,`tag ${(C(d)&&C(d).ok?"is-success":"is-danger")??""}`),ft(ur,`tag ${(C(d)&&C(d).ok?"is-success":"is-dark")??""}`),ft(Ja,`tag ${(C(d)&&C(d).ok?"is-success":"is-dark")??""}`),ft(pt,`tag ${(C(x)>f()?"is-danger":"is-dark")??""}  `)}),W(Qe,Xe)};let o=me(e,"url",15),l=me(e,"method",15,"GET"),f=me(e,"limitSizeResponseView",11,2e4),c=me(e,"methodDisabled",11,!1),h=me(e,"data",31,()=>Y({query:[],headers:[],auth:{},body:{}}));me(e,"onchange",3,()=>{});let u=new es,d=be(void 0),p=be(void 0),m=be("json"),g=be(0),v=be(""),w=be(!1),x=be(0),S=[{method:"CONNECT",label:"CONNECT"},{method:"DELETE",label:"DELETE"},{method:"GET",label:"GET"},{method:"HEAD",label:"HEAD"},{method:"OPTIONS",label:"OPTIONS"},{method:"POST",label:"POST"},{method:"PATCH",label:"PATCH"},{method:"PUT",label:"PUT"},{method:"TRACE",label:"TRACE"}],y=[{as:"json",label:"JSON"},{as:"datatable",label:"Table"},{as:"text",label:"Text"}],b=be(Y([{label:"Query Parameters",isActive:!0,component:t},{label:"HTTP Headers",component:n},{label:"Auth",component:i},{label:"Body",component:s},{label:"Result",component:a}])),O;function T(){h()==null&&h({}),h()&&h().auth==null&&h(h().auth={selection:0},!0),h()&&h().auth&&h().auth.selection==null&&h(h().auth.selection=0,!0),h()&&h().body==null&&h(h().body={selection:0},!0),h()&&h().body&&h().body.selection==null&&h(h().body.selection=0,!0),h()&&h().query==null&&h(h().query={},!0),h()&&h().headers==null&&h(h().headers={},!0)}function k(Qe){const Xe=JSON.stringify(Qe);return Q(Xe)}function Q(Qe){return(new TextEncoder().encode(Qe).length/1024).toFixed(4)}function A(Qe,Xe,De="text/plain"){const ke=new Blob([Qe],{type:De}),Ee=URL.createObjectURL(ke),Ft=document.createElement("a");Ft.href=Ee,Ft.download=Xe,document.body.appendChild(Ft),Ft.click(),document.body.removeChild(Ft),URL.revokeObjectURL(Ee)}function _(){H(d,Y({})),H(v,void 0),H(p,void 0)}function N(){var Xe,De,ke;let Qe;switch(h().body.selection){case 0:try{let Ee=((ke=(De=(Xe=h())==null?void 0:Xe.body)==null?void 0:De.json)==null?void 0:ke.code)??void 0;typeof Ee=="object"?Qe=Ee:Qe=JSON.parse(Ee)}catch(Ee){console.warn(Ee),Qe={}}break;default:Qe=void 0;break}return Qe}function U(Qe){let Xe={};if(Qe&&Array.isArray(Qe))for(let De=0;De<Qe.length;De++)Qe[De].enabled&&Qe[De].key&&Qe[De].key.length>0&&(Xe[Qe[De].key]=Qe[De].value);return Xe}function z(Qe){let Xe={};if(Qe&&Array.isArray(Qe))for(let De=0;De<Qe.length;De++)Qe[De].enabled&&Qe[De].key&&Qe[De].key.length>0&&(Xe[Qe[De].key]=Qe[De].value);return Xe}It(()=>{T()}),ea(()=>{clearTimeout(O)});var K=Ene(),re=R(K),ge=R(re),V=R(ge),he=te(R(V),2),ae=R(he);Et(ae),P(he),P(V),P(ge);var E=te(ge,2),L=R(E),I=R(L),Z=R(I),ee=R(Z),ne=te(R(ee),2),de=R(ne),fe=R(de);Pr(fe,21,()=>S,Lr,(Qe,Xe)=>{var De=kne(),ke={},Ee=R(De,!0);P(De),Re(()=>{ke!==(ke=C(Xe).method)&&(De.value=(De.__value=C(Xe).method)==null?"":C(Xe).method),Ge(Ee,C(Xe).label)}),W(Qe,De)}),P(fe),P(de),P(ne),P(ee),P(Z);var pe=te(Z,2),Me=R(pe),q=te(R(Me),2),He=R(q),Ve=R(He);Pr(Ve,21,()=>y,Lr,(Qe,Xe)=>{var De=Sne(),ke={},Ee=R(De,!0);P(De),Re(()=>{ke!==(ke=C(Xe).as)&&(De.value=(De.__value=C(Xe).as)==null?"":C(Xe).as),Ge(Ee,C(Xe).label)}),W(Qe,De)}),P(Ve),P(He),P(q),P(Me),P(pe);var Te=te(pe,2),Ne=R(Te);Ne.__click=[Tne,g,w,l,z,h,N,_,d,u,o,U,p,m,v,x,k];var ve=R(Ne),ct=R(ve);{var bt=Qe=>{var Xe=Cne();W(Qe,Xe)},Bt=Qe=>{var Xe=Ane();W(Qe,Xe)};se(ct,Qe=>{C(w)?Qe(bt):Qe(Bt,!1)})}P(ve),Lt(2),P(Ne),P(Te),P(I),P(L),P(E),P(re);var er=te(re,2);Mn(er,{get tabs(){return C(b)},set tabs(Qe){H(b,Y(Qe))},get active(){return C(g)},set active(Qe){H(g,Y(Qe))}}),P(K),Re(()=>fe.disabled=c()),Xt(ae,o),Fl(fe,l),Fl(Ve,()=>C(m),Qe=>H(m,Qe)),W(r,K),xt()}Or(["click"]);async function QP(r){let e={result:!1,error:void 0};if(navigator.clipboard&&navigator.clipboard.writeText)try{await navigator.clipboard.writeText(r),e.result=!0}catch{e.error=err}else{let t=document.createElement("input");t.style.position="absolute",t.style.left="-9999px",t.setAttribute("readonly","true"),t.value=r,document.body.appendChild(t),t.select(),t.setSelectionRange(0,99999);try{document.execCommand("copy"),e.result=!0}catch(n){e.error=n}document.body.removeChild(t)}return e}var Pne=J('<span class="icon-text"><span><i></i></span> <span> </span></span>');function FP(r,e){let t=me(e,"color",11,""),n=me(e,"label",11," Label "),i=me(e,"icon",11,"fas fa-home");var s=Pne(),a=R(s),o=R(a);P(a);var l=te(a,2),f=R(l,!0);P(l),P(s),Re(()=>{ft(a,`icon has-text-${t()??""}`),ft(o,oi(i())),Ge(f,n())}),W(r,s)}var Rne=J("<td><!></td>");function Qne(r,e){Ot(e,!0);let t=me(e,"value",15,""),n=be(""),i=be("fas fa-home");function s(f){let c=Z2[f];c?(H(n,Y(c.color)),H(i,Y(c.icon))):(H(n,""),H(i,""))}It(()=>{s(t())});var a=Rne(),o=R(a);{var l=f=>{FP(f,{get color(){return C(n)},set color(c){H(n,Y(c))},get label(){return t()},set label(c){t(c)},get icon(){return C(i)},set icon(c){H(i,Y(c))}})};se(o,f=>{t()!=null&&f(l)})}P(a),W(r,a),xt()}function Fne(r,e,t){e()(t())}var $ne=J("<option> </option>"),Nne=J('<div class="control"><div><select><!></select></div></div>');function Y0(r,e){Ot(e,!0);let t=me(e,"onchange",3,()=>{}),n=me(e,"option",15,"NA"),i=me(e,"css_class",11," is-small "),s=me(e,"options",27,()=>Y([{id:"TEST",value:"TEST",enabled:!0}]));var a=Nne(),o=R(a),l=R(o);l.__change=[Fne,t,n];var f=R(l);{var c=h=>{var u=Ae(),d=ye(u);Pr(d,17,s,Lr,(p,m)=>{var g=$ne(),v={},w=R(g,!0);P(g),Re(()=>{v!==(v=C(m).id)&&(g.value=(g.__value=C(m).id)==null?"":C(m).id),Ge(w,C(m).value)}),W(p,g)}),W(h,u)};se(f,h=>{s()&&s().length>0&&h(c)})}P(l),P(o),P(a),Re(()=>ft(o,`select ${i()??""}`)),Fl(l,n),W(r,a),xt()}Or(["change"]);var Dne=J("<td><!></td>");function Mne(r,e){Ot(e,!0);let t=me(e,"value",15);It(()=>{});var n=Dne(),i=R(n);Y0(i,{options:B2,onselect:s=>{console.log("Cambia",s,t())},get option(){return t()},set option(s){t(s)}}),P(n),W(r,n),xt()}var Ine=J("<td><!></td>");function Lne(r,e){Ot(e,!0);let t=be(""),n=be(""),i=be("fas fa-home");function s(f){let c=Qm[f];c?(H(n,Y(c.color)),H(i,Y(c.icon))):(H(n,""),H(i,"")),c&&c.label?H(t,Y(c.label)):H(t,Y(e.value))}It(()=>{s(e.value)});var a=Ine(),o=R(a);{var l=f=>{FP(f,{get color(){return C(n)},set color(c){H(n,Y(c))},get label(){return C(t)},set label(c){H(t,Y(c))},get icon(){return C(i)},set icon(c){H(i,Y(c))}})};se(o,f=>{e.row.method!=="WS"&&f(l)})}P(a),W(r,a),xt()}var Bne=J('<span class="tag is-info"> </span>'),Zne=J('<span class="tag is-success"> </span>'),Wne=J('<span class="tag is-primary"> </span>'),Une=J('<span class="tag is-warning"> </span>'),Xne=J('<span class="tag is-danger"> </span>'),Vne=J('<span class="tag is-dark"> </span>'),qne=J('<div class="control"><div class="tags has-addons"><!> <span class="tag is-dark"> </span></div></div>'),jne=J('<div class="field is-grouped is-grouped-multiline"></div>'),zne=J("<td><!></td>");function Gne(r,e){Ot(e,!0);let t=be(Y({}));L2.subscribe(a=>{if(e.row&&e.row.endpoint){let o=`${e.row.endpoint.toLowerCase()}|${e.row.method}`;if(a&&Array.isArray(a))if(a.length>0){let l=a.find(f=>f[o]);l&&l[o]?H(t,Y(l[o])):H(t,Y([]))}else H(t,Y([]))}}),It(()=>{});var n=zne(),i=R(n);{var s=a=>{var o=Ae(),l=ye(o);{var f=c=>{var h=jne();Pr(h,21,()=>Object.keys(C(t)),Lr,(u,d)=>{var p=qne(),m=R(p),g=R(m);{var v=y=>{var b=Bne(),O=R(b,!0);P(b),Re(()=>Ge(O,C(d))),W(y,b)},w=y=>{var b=Ae(),O=ye(b);{var T=Q=>{var A=Zne(),_=R(A,!0);P(A),Re(()=>Ge(_,C(d))),W(Q,A)},k=Q=>{var A=Ae(),_=ye(A);{var N=z=>{var K=Wne(),re=R(K,!0);P(K),Re(()=>Ge(re,C(d))),W(z,K)},U=z=>{var K=Ae(),re=ye(K);{var ge=he=>{var ae=Une(),E=R(ae,!0);P(ae),Re(()=>Ge(E,C(d))),W(he,ae)},V=he=>{var ae=Ae(),E=ye(ae);{var L=Z=>{var ee=Xne(),ne=R(ee,!0);P(ee),Re(()=>Ge(ne,C(d))),W(Z,ee)},I=Z=>{var ee=Vne(),ne=R(ee,!0);P(ee),Re(()=>Ge(ne,C(d))),W(Z,ee)};se(E,Z=>{C(d)>=500&&C(d)<600?Z(L):Z(I,!1)},!0)}W(he,ae)};se(re,he=>{C(d)>=400&&C(d)<500?he(ge):he(V,!1)},!0)}W(z,K)};se(_,z=>{C(d)>=300&&C(d)<400?z(N):z(U,!1)},!0)}W(Q,A)};se(O,Q=>{C(d)>=200&&C(d)<300?Q(T):Q(k,!1)},!0)}W(y,b)};se(g,y=>{C(d)>=100&&C(d)<200?y(v):y(w,!1)})}var x=te(g,2),S=R(x,!0);P(x),P(m),P(p),Re(()=>Ge(S,C(t)[C(d)])),W(u,p)}),P(h),W(c,h)};se(l,c=>{C(t)&&c(f)})}W(a,o)};se(i,a=>{e.row.method!=="WS"&&a(s)})}P(n),W(r,n),xt()}var Hne=J("<span><i></i></span>"),Yne=J('<span class="icon"><i class="fa-solid fa-question"></i></span>'),Kne=J('<td><div class="icon-text"><!> <span> </span></div></td>');function Jne(r,e){Ot(e,!0),It(()=>{});var t=Kne(),n=R(t),i=R(n);{var s=f=>{var c=Hne(),h=R(c);P(c),Re(()=>{ft(c,`icon ${ac[e.row.environment].color??""}`),ft(h,oi(ac[e.row.environment].icon))}),W(f,c)},a=f=>{var c=Yne();W(f,c)};se(i,f=>{var c;(c=e.row)!=null&&c.environment&&ac[e.row.environment]?f(s):f(a,!1)})}var o=te(i,2),l=R(o,!0);P(o),P(n),P(t),Re(()=>Ge(l,e.value)),W(r,t),xt()}var eie=J('<a class="button is-small has-text-success"><span class="icon"><i class="fa-solid fa-star bolt fa-beat-fade" style="--fa-beat-fade-opacity: 0.1; --fa-beat-fade-scale: 1.25;"></i></span> <span> </span></a>'),tie=J('<a class="button is-small"><span class="icon"><i class="fa-regular fa-star"></i></span> <span>0.0000 KB</span></a>'),rie=J('<div class="field has-addons"><div class="control is-small"><input class="input is-small" type="number" placeholder="Cache time" step="1" min="0"></div> <div class="control"><a class="button is-small">seg.</a></div> <div class="control"><!></div></div>'),nie=J("<td><!></td>");function iie(r,e){Ot(e,!0);let t=me(e,"value",15),n=be(Y({}));I2.subscribe(o=>{if(o&&Array.isArray(o))if(o.length>0&&e.row){let l=o.find(f=>f.url.toLowerCase()==`${e.row.endpoint}|${e.row.method}`.toLowerCase());l?H(n,Y(l)):C(n).bytes=0}else C(n).bytes=0}),It(()=>{});var i=nie(),s=R(i);{var a=o=>{var l=rie(),f=R(l),c=R(f);Et(c),P(f);var h=te(f,4),u=R(h);{var d=m=>{var g=eie(),v=te(R(g),2),w=R(v);P(v),P(g),Re(()=>Ge(w,`${C(n).bytes??""} KB`)),W(m,g)},p=m=>{var g=tie();W(m,g)};se(u,m=>{e.row&&C(n)&&C(n).bytes&&C(n).bytes>0?m(d):m(p,!1)})}P(h),P(l),Xt(c,t),W(o,l)};se(s,o=>{e.row.method!=="WS"&&o(a)})}P(i),W(r,i),xt()}var sie=(r,e,t)=>{let n="$_VAR_"+C(e).toUpperCase();t()[n]?alert("Var "+n+" already exists."):t(t()[n]={},!0)},aie=J('<div class="field has-addons"><div class="control"><button class="button is-small is-static">$_VAR_</button></div> <div class="control"><input class="input is-small" type="text" placeholder="New app variable"></div> <div class="control"><button class="button is-success is-small">New</button></div></div>'),oie=J("<div><!></div>"),lie=J('<p class="control"><input class="input is-success is-small" type="text" placeholder="Edit variable name"></p> <p class="control"><button class="button is-small is-outlined is-success" title="Apply"><span class="icon is-small"><i class="fa-solid fa-check"></i></span></button></p> <p class="control"><button class="button is-small is-outlined is-danger" title="Cancel"><span class="icon is-small"><i class="fa-solid fa-xmark"></i></span></button></p>',1),fie=J('<p class="control"><button class="button is-small" title="Edit variable name"><span class="icon is-small"><i class="fa-solid fa-pen"></i></span></button></p>'),cie=async(r,e,t)=>{(await QP(C(e))).result&&(H(t,Y(C(e))),setTimeout(()=>{H(t,"")},1500))},hie=async(r,e,t,n)=>{(await QP(e()[C(t)]?JSON.stringify(e()[C(t)]):"")).result&&(H(n,Y(C(t))),setTimeout(()=>{H(n,"")},1500))},uie=J('<span><div class="field has-addons"><p class="control"><a class="button is-static is-small"> </a></p> <!> <p class="control"><button class="button is-small" title="Copy Name"><span class="icon is-small has-text-info"><i></i></span></button></p> <p class="control"><button class="button is-small has-text-success" title="Copy Value"><span class="icon is-small"><i></i></span></button></p></div></span>'),die=(r,e,t)=>{confirm("Are you sure you want to remove the variable "+C(e)+"?")&&t(C(e))},pie=J('<div class="field has-addons"><p class="control"><button class="button is-small is-outlined is-danger" title="Delete variable"><span class="icon is-small"><i class="fa-solid fa-trash"></i></span></button></p></div>'),mie=J("<span><!></span>"),gie=J('<!> <hr class="reset_margin svelte-192jd83">',1),Oie=J('<!> <div class="box"></div>',1);function Sm(r,e){Ot(e,!0);let t=me(e,"isReadOnly",11,!1),n=me(e,"showCode",11,!1),i=me(e,"appVars",31,()=>Y({})),s=me(e,"title",11,""),a=be(""),o={},l={},f=be(""),c=be("");function h(){return i()}function u(g){delete i()[g],i(i())}It(()=>{});var d=Ae(),p=ye(d);{var m=g=>{var v=Oie(),w=ye(v);{const S=b=>{Lt();var O=ms();Re(()=>Ge(O,s())),W(b,O)},y=b=>{var O=oie(),T=R(O);{var k=Q=>{var A=aie(),_=te(R(A),2),N=R(_);Et(N),P(_);var U=te(_,2),z=R(U);z.__click=[sie,a,i],P(U),P(A),Xt(N,()=>C(a),K=>H(a,K)),W(Q,A)};se(T,Q=>{t()||Q(k)})}P(O),W(b,O)};Nl(w,{left:[S],right:[y],l01:S,r01:y,$$slots:{l01:!0,r01:!0}})}var x=te(w,2);Pr(x,21,()=>Object.keys(i()),Lr,(S,y)=>{var b=Ae(),O=ye(b);{var T=k=>{var Q=gie(),A=ye(Q);{const _=U=>{var z=uie(),K=R(z),re=R(K),ge=R(re),V=R(ge,!0);P(ge),P(re);var he=te(re,2);{var ae=pe=>{var Me=Ae(),q=ye(Me);{var He=Te=>{var Ne=lie(),ve=ye(Ne),ct=R(ve);Et(ct),P(ve);var bt=te(ve,2),Bt=R(bt);Bt.__click=()=>{i(i()[o[C(y)]]={...o[C(y)]},!0),u(C(y))},P(bt);var er=te(bt,2),Qe=R(er);Qe.__click=()=>{l[C(y)]=!1},P(er),Xt(ct,()=>o[C(y)],Xe=>o[C(y)]=Xe),W(Te,Ne)},Ve=Te=>{var Ne=fie(),ve=R(Ne);ve.__click=()=>{l[C(y)]=!l[C(y)],o[C(y)]=C(y)},P(Ne),W(Te,Ne)};se(q,Te=>{l[C(y)]?Te(He):Te(Ve,!1)})}W(pe,Me)};se(he,pe=>{t()||pe(ae)})}var E=te(he,2),L=R(E);L.__click=[cie,y,f];var I=R(L),Z=R(I);P(I),P(L),P(E);var ee=te(E,2),ne=R(ee);ne.__click=[hie,i,y,c];var de=R(ne),fe=R(de);P(de),P(ne),P(ee),P(K),P(z),Re(()=>{Ge(V,C(y)),ft(Z,`fa-solid fa-copy ${(C(f)==C(y)?" fa-shake ":"")??""}`),ft(fe,`fa-regular fa-copy ${(C(c)==C(y)?" fa-shake ":"")??""}`)}),W(U,z)},N=U=>{var z=mie(),K=R(z);{var re=ge=>{var V=pie(),he=R(V),ae=R(he);ae.__click=[die,y,u],P(he),P(V),W(ge,V)};se(K,ge=>{t()||ge(re)})}P(z),W(U,z)};ui(A,{left:_,right:N,get showCode(){return n()},get isReadOnly(){return t()},get code(){return i()[C(y)]},set code(U){i(i()[C(y)]=U,!0)},left_Editor:_,right_Editor:N,$$slots:{left_Editor:!0,right_Editor:!0}})}Lt(2),W(k,Q)};se(O,k=>{i()[C(y)]&&k(T)})}W(S,b)}),P(x),W(g,v)};se(p,g=>{i()&&g(m)})}return W(r,d),xt({getCode:h})}Or(["click"]);var xie=J('<div class="column"><!></div>'),vie=J('<div class="column"><!></div>'),yie=J('<div class="column"><!></div>'),wie=J("<div><!> <!> <!></div>");function oa(r,e){Ot(e,!0);let t=me(e,"environment",11,"*"),n=me(e,"isReadOnly",11,!1);me(e,"onchanged",3,()=>{});let i=be(Y({}));hl.subscribe(u=>{H(i,Y(u||{}))}),It(()=>{});var s=wie(),a=R(s);{var o=u=>{var d=Ae(),p=ye(d);{var m=g=>{var v=xie(),w=R(v);Sm(w,{get appVars(){return C(i).dev},get isReadOnly(){return n()},title:"DEVELOPMENT"}),P(v),W(g,v)};se(p,g=>{C(i)&&C(i).dev&&g(m)})}W(u,d)};se(a,u=>{(t()=="dev"||t()=="*")&&u(o)})}var l=te(a,2);{var f=u=>{var d=Ae(),p=ye(d);{var m=g=>{var v=vie(),w=R(v);Sm(w,{get appVars(){return C(i).qa},get isReadOnly(){return n()},title:"QUALITY"}),P(v),W(g,v)};se(p,g=>{C(i)&&C(i).qa&&g(m)})}W(u,d)};se(l,u=>{(t()=="qa"||t()=="*")&&u(f)})}var c=te(l,2);{var h=u=>{var d=Ae(),p=ye(d);{var m=g=>{var v=yie(),w=R(v);Sm(w,{get appVars(){return C(i).prd},get isReadOnly(){return n()},title:"PRODUCTION"}),P(v),W(g,v)};se(p,g=>{C(i)&&C(i).prd&&g(m)})}W(u,d)};se(c,u=>{(t()=="prd"||t()=="*")&&u(h)})}P(s),W(r,s),xt()}var bie=(r,e)=>{e()},_ie=J('<div class="field"><label class="label">Url to make the request. The operation is similar to a proxy</label> <div class="control has-icons-right"><input class="input is-small" type="text" placeholder="http://your.url/path"> <span class="icon is-small is-right"><i class="fa-solid fa-globe"></i></span></div></div>'),kie=J("<div><!></div>");function Sie(r,e){Ot(e,!0);const t=c=>{var h=_ie(),u=te(R(h),2),d=R(u);Et(d),d.__change=[bie,f],Lt(2),P(u),P(h),Xt(d,()=>s().code,p=>s(s().code=p,!0)),W(c,h)},n=c=>{oa(c,{get environment(){return s().environment},isReadOnly:!0})},i=c=>{var h=kie(),u=R(h);aa(u,{get method(){return s().method},get url(){return s().endpoint},methodDisabled:!0,onchange:d=>{f()},get data(){return s().data_test},set data(d){s(s().data_test=d,!0)}}),P(h),W(c,h)};let s=me(e,"row",31,()=>Y({})),a=me(e,"onchange",3,()=>{}),o=be(Y([{label:"Url",isActive:!0,component:t},{label:"App Variables",component:n},{label:"Tester",component:i}]));function l(){return{code:Ht(s().code),data_test:Ht(s().data_test)}}function f(){a()(l())}It(()=>{}),Mn(r,{get tabs(){return C(o)},set tabs(c){H(o,Y(c))}}),xt()}Or(["change"]);var Tie=J(`<div class="content is-small"><h3>Predefined variables</h3> <ul><li><strong>$_RETURN_DATA_:</strong> Variable that returns the return of the function</li> <li><strong>$_UFETCH_:</strong> Instance of the uFetch class. More information at <a href="https://github.com/edwinspire/universal-fetch">universal-fetch</a></li> <li><strong>$_REQUEST_:</strong> Represents the HTTP request received by the server. Contains information
			about the request made by the client, such as URL parameters, headers, body data, and more.</li> <li><strong>$_GET_INTERNAL_URL_:</strong> Function that allows obtaining the full path of an OFAPI
			endpoint. <br> Example: <code>let relative_path = '/api/test/ap001'; <br>let fullURL = $_GET_INTERNAL_URL_(relative_path); <br>// $_GET_INTERNAL_URL_ return 'http://localhost:3000/api/test/ap001'</code></li> <li><strong>$_FETCH_OFAPI_:</strong> Build a <a href="https://github.com/edwinspire/universal-fetch/">uFetch</a> intance. <br> The url can be absolute or relative. When it is relative, it internally repoints to the port used
			by OFAPI. <br>Example: <code>let url = 'http://example.net/api/test'; <br> let fetch_instance = $_FETCH_OFAPI_(url);</code></li> <li><strong>$_SECUENTIAL_PROMISES_:</strong> PromiseSequence class. More information at <a href="https://github.com/edwinspire/sequential-promises">sequential-promises</a>.</li> <li><strong>$_EXCEPTION_:</strong> It interrupts the program flow and throws an exception. It has three parameters: <ul><li>message: The message that will be shown to the user. (required)</li> <li>data: An object of additional data to be sent to the user. (optional)</li> <li>statusCode: HTTP Status Code with which the request will be responded to. (optional.
					Default: 500)</li></ul> Example: <code>$_EXCEPTION_('A parameter has not been entered', $_REQUEST_.body, 400);</code></li> <li><strong>$_MONGOOSE_:</strong> Mongoose provides a straight-forward, schema-based solution to model your MongoDB. More information
			at <a href="https://mongoosejs.com/">Mongoose</a> <br> Example: <code><!></code></li></ul></div>`);function $P(r){let e=`$_MONGOOSE_.connect('mongodb://127.0.0.1:27017/test'); <br/>
					
					const Cat = $_MONGOOSE_.model('Cat', { name: String }); <br/>
					
					const kitty = new Cat({ name: 'Zildjian' }); <br/>
					kitty.save().then(() => console.log('meow')); <br/>`;var t=Tie(),n=te(R(t),2),i=te(R(n),14),s=te(R(i),6),a=R(s);F2(a,()=>e),P(s),P(i),P(n),P(t),W(r,t)}const Cie=r=>{$P(r)};var Aie=J("<div><!></div>");function Eie(r,e){Ot(e,!0);const t=d=>{ui(d,{lang:"js",onchange:p=>{h()},get code(){return C(o)},set code(p){H(o,Y(p))}})},n=d=>{oa(d,{get environment(){return s().environment},isReadOnly:!0})},i=d=>{var p=Aie(),m=R(p);aa(m,{get method(){return s().method},get url(){return s().endpoint},methodDisabled:!0,onchange:g=>{h()},get data(){return s().data_test},set data(g){s(s().data_test=g,!0)}}),P(p),W(d,p)};let s=me(e,"row",31,()=>Y({})),a=me(e,"onchange",3,()=>{}),o=be("");Js(()=>{var d;(d=s())!=null&&d.code&&f()});function l(){s()||s({code:{}}),s()&&!s().code&&s(s().code={},!0)}function f(){H(o,Y(s().code))}function c(){return{code:Ht(C(o)),data_test:Ht(s().data_test)}}function h(){a()(c())}let u=be(Y([{label:"Code",isActive:!0,classIcon:" fa-brands fa-node-js ",component:t},{label:"Predefined Variables",component:Cie},{label:"App Variables",component:n},{label:"Tester",component:i}]));It(()=>{l()}),Mn(r,{get tabs(){return C(u)},set tabs(d){H(u,Y(d))}}),xt()}var Pie=J(`<div class="block"><div class="icon-text"><span class="icon has-text-warning"><i class="fas fa-exclamationcode-triangle"></i></span> <span>Warning</span></div> <p class="block">The GET method is recommended only for simple requests where there are no input
					parameters, or failing which the parameters are key-value.</p></div>`),Rie=J("<div><div><div>Service connection parameters.</div></div> <!> <!></div>"),Qie=J(`<div>Enter the parameters in json format like the following example: <!> <div style="margin-top: 1em;">The variables with the following: <ul class="list_params svelte-enisc9"><li><strong>wsdl:</strong> url where the wsdl is located. (Required)</li> <li><strong>functionName:</strong> Function or method to call. Required when the method used
					is <strong>GET</strong>, in the <strong>POST</strong> method it can be passed as a parameter.</li> <li><strong>BasicAuthSecurity:</strong> Only if required. BearerSecurity is also supported.</li> <li><strong>RequestArgs:</strong> When you use the <strong>GET</strong> method, this parameter
					is replaced by the data sent in the Query. When using <strong>POST</strong> the parameter can
					be sent directly in the Body.</li> <li><strong>options:</strong> additional options passed to soap client. By example: <!></li></ul> <br> <div class="block"><div class="icon-text"><span class="icon has-text-warning"><i class="fas fa-exclamation-triangle"></i></span> <span>Warning: The parameters configured here will override those that the user sends through
						the service.</span></div></div> <br> <div class="block"><div class="icon-text"><span class="icon has-text-success"><i class="fas fa-info-circle"></i></span> <span>If you want to <strong>get description</strong> of the SOAP service, you can send the
						following JSON request: <code></code></span></div></div></div></div>`),Fie=J("<div><!></div>");function $ie(r,e){Ot(e,!0);const t=w=>{var x=Rie(),S=te(R(x),2);ui(S,{lang:"json",onchange:()=>{g()},get code(){return C(l)},set code(O){H(l,Y(O))}});var y=te(S,2);{var b=O=>{var T=Pie();W(O,T)};se(y,O=>{a().method==="GET"&&O(b)})}P(x),W(w,x)},n=w=>{var x=Qie(),S=te(R(x));zi(S,{get jsonObject(){return C(p)},set jsonObject(N){H(p,Y(N))}});var y=te(S,2),b=te(R(y)),O=te(R(b),8),T=te(R(O),2);zi(T,{get jsonObject(){return C(c)},set jsonObject(N){H(c,Y(N))}}),P(O),P(b);var k=te(b,8),Q=R(k),A=te(R(Q),2),_=te(R(A),3);_.textContent=f,P(A),P(Q),P(k),P(y),P(x),W(w,x)},i=w=>{oa(w,{get environment(){return a().environment},isReadOnly:!0})},s=w=>{var x=Fie(),S=R(x);aa(S,{get method(){return a().method},get url(){return a().endpoint},methodDisabled:!0,onchange:y=>{g()},get data(){return a().data_test},set data(y){a(a().data_test=y,!0)}}),P(x),W(w,x)};let a=me(e,"row",31,()=>Y({})),o=me(e,"onchange",3,()=>{}),l=be(""),f=JSON.stringify({"describe()":!0}),c=be(Y({wsdl_options:{strictSSL:!0,rejectUnauthorized:!1}})),h;Js(()=>{var w;(w=a())!=null&&w.code&&(clearTimeout(h),h=setTimeout(()=>{u()},500))});function u(){H(l,Y(a().code))}let d=be(Y([{label:"Parameters",isActive:!0,classIcon:" fa-solid fa-soap ",component:t},{label:"Information",isActive:!1,component:n},{label:"App Variables",component:i},{label:"Tester",component:s}])),p=be(Y({wsdl:"https://www.dataaccess.com/webservicesserver/numberconversion.wso?WSDL",functionName:"NumberToDollars",BasicAuthSecurity:{User:"any",Password:"any"},RequestArgs:{dNum:236.08}}));function m(){return C(l)}function g(){o()(v())}function v(){return{code:m(),data_test:Ht(a().data_test)}}It(()=>{}),ea(()=>{clearTimeout(h)}),Mn(r,{get tabs(){return C(d)},set tabs(w){H(d,Y(w))}}),xt()}var Nie=J(`<div><div><div class="content is-small">The parameters must have a name like <span style="font-style: oblique; font-weight: bold;">$nameparameter</span> to bind, or <span style="font-style: oblique; font-weight: bold;">:nameparameter</span> to
				replacements. The values you send in the request. For more information you can consult the <a href="https://sequelize.org/docs/v6/core-concepts/raw-queries/#bind-parameter">sequelize</a> documentation.</div></div></div> <!>`,1),Die=J(`<div class="block"><div class="icon-text"><span class="icon has-text-warning"><i class="fas fa-exclamation-triangle"></i></span> <span>GET Method - Warning</span></div> <p class="block">The GET method is recommended only for simple requests where there is no input parameters,
					or failing that the parameters are key-value on query request, which will be used to join
					with the variables of the SQL query.</p> <div class="block">If you send a parameter that is not present in the query you will get an error similar to: <code>Column index out of range</code></div></div>`),Mie=J(`<div class="block"><div class="icon-text"><span class="icon has-text-info"><i class="fa-solid fa-circle-exclamation"></i></span> <span>When you use the POST method, the input parameters must be sent in the BODY in JSON
						format, using the following example:</span></div> <br> <!> <br> <div class="icon-text"><span class="icon has-text-info"><i class="fa-solid fa-circle-exclamation"></i></span> <span>You can also use "replacements" used by sequelize., for example:</span></div> <br> <!></div> <div class="icon-text"><span class="icon has-text-warning"><i class="fa-solid fa-circle-exclamation"></i></span> <span>Only "bind" or "replacements" can be used at the same time.</span></div>`,1),Iie=J('<div class="content is-small"><p>In sequelize you can pass parameters using <strong>"bind"</strong> or <strong>"replacements"</strong> depending on the case. You can refer to <a href="https://sequelize.org/docs/v6/core-concepts/raw-queries/#bind-parameter">Sequelize Parameters</a> for more details.</p> <!></div>'),Lie=(r,e)=>{H(e,!1)},Bie=(r,e)=>{H(e,!0)},Zie=J('<div><div class="content is-small">Configuration parameters used by sequelize, visit <a href="https://sequelize.org/">https://sequelize.org/</a> for more information. <br> You can also use the name of an application variable to use it, for example <strong>$_VAR_NAME</strong>.</div></div> <div class="box"><div class="buttons has-addons"><button>JSON Parameters</button> <button>Use Variable</button></div> <!></div>',1),Wie=J("<div><!></div>");function Uie(r,e){Ot(e,!0);const t=b=>{var O=Nie(),T=te(ye(O),2);ui(T,{isReadOnly:!1,title:"Query to be executed",lang:"sql",onchange:k=>{x()},get code(){return C(g)},set code(k){H(g,Y(k))}}),W(b,O)},n=b=>{var O=Iie(),T=te(R(O),2);{var k=A=>{var _=Die();W(A,_)},Q=A=>{var _=Ae(),N=ye(_);{var U=z=>{var K=Mie(),re=ye(K),ge=te(R(re),4);zi(ge,{get jsonObject(){return C(d)},set jsonObject(he){H(d,Y(he))}});var V=te(ge,8);zi(V,{get jsonObject(){return C(p)},set jsonObject(he){H(p,Y(he))}}),P(re),Lt(2),W(z,K)};se(N,z=>{o().method==="POST"&&z(U)},!0)}W(A,_)};se(T,A=>{o().method==="GET"?A(k):A(Q,!1)})}P(O),W(b,O)},i=b=>{var O=Zie(),T=te(ye(O),2),k=R(T),Q=R(k);Q.__click=[Lie,f];var A=te(Q,2);A.__click=[Bie,f],P(k);var _=te(k,2);{var N=z=>{ui(z,{isReadOnly:!1,lang:"json",onchange:()=>{x()},get code(){return C(c)},set code(K){H(c,Y(K))}})},U=z=>{cC(z,{placeholder:"$_VAR_NAME",get options(){return C(u)},onselect:K=>{x()},get selectedValue(){return C(h)},set selectedValue(K){H(h,Y(K))}})};se(_,z=>{C(f)?z(U,!1):z(N)})}P(T),Re(()=>{ft(Q,`button is-small ${(C(f)?"":"is-active is-primary")??""}`),ft(A,`button is-small ${(C(f)?"is-active is-primary":"")??""}`)}),W(b,O)},s=b=>{oa(b,{get environment(){return o().environment},isReadOnly:!0})},a=b=>{var O=Wie(),T=R(O);aa(T,{get method(){return o().method},get url(){return o().endpoint},methodDisabled:!0,onchange:k=>{x()},get data(){return o().data_test},set data(k){o(o().data_test=k,!0)}}),P(O),W(b,O)};let o=me(e,"row",31,()=>Y({endpoint:"",method:"",environment:""})),l=me(e,"onchange",3,()=>{}),f=be(!1),c=be(Y({})),h=be(""),u=be(Y([]));hl.subscribe(b=>{H(u,Y(Object.keys(b[o().environment]).map(O=>({name:O,value:O}))))});let d=be(Y({bind:{your_param_01:"0002081614",your_param_02:123,your_param_03:"ABC"}})),p=be(Y({replacements:{your_param_01:["0002081614","986535OKE"]}})),m=be(Y([{label:"Query",isActive:!0,classIcon:" fa-solid fa-database ",component:t},{label:"Pass Parameters",component:n},{label:"Connection Parameters",component:i},{label:"App Variables",component:s},{label:"Tester",component:a}])),g=be("SELECT 1+1;"),v;Js(()=>{var b;(b=o())!=null&&b.code&&(clearTimeout(v),v=setTimeout(()=>{w()},750))});function w(){try{let b=JSON.parse(o().code||"{}");b&&b.query&&H(g,Y(b.query)),b&&b.config&&(typeof b.config=="object"?(H(c,Y(b.config)),H(f,!1)):(H(h,Y(b.config)),H(f,!0)))}catch(b){H(c,Y({})),H(h,""),H(g,"SELECT 1;"),console.error("Error",b)}}function x(){l()(S())}function S(){return{code:y(),data_test:Ht(o().data_test)}}function y(){let b={},O={};try{C(f)?b=C(h):b=typeof C(c)=="object"?C(c):JSON.parse(C(c))}catch(T){console.warn("No se pudo parsear getCode SQL",T,C(h),C(c)),b=""}try{return O.config=b,O.query=C(g),JSON.stringify(O,null,2)}catch(T){return console.warn(T),code}}It(()=>{w()}),ea(()=>{clearTimeout(v)}),Mn(r,{get tabs(){return C(m)},set tabs(b){H(m,Y(b))}}),xt()}Or(["click"]);var Xie=(r,e)=>{e()},Vie=J(`<div><br> <div class="control"><input class="input is-small" type="text" placeholder="Table name"></div> <br></div> <div class="content is-small"><h4>Bulk INSERT</h4> <div>Performs a bulk insert into a SQL database table.</div> <div>The necessary parameters are the "table name" and an array with the data.<br> The data you send must contain a JSON where the key must contain the exact name of the database
			field. <br> <details><summary>For example, the following JSON represents a list of rows to be inserted:</summary> <!></details></div> <div><span class="icon-text"><span class="icon has-text-warning"><i class="fas fa-exclamation-triangle fa-fade"></i></span> <span class="label is-small">Depending on the database engine you may have a <strong>lock</strong> on the table during
					the bulk insert process.</span></span></div></div>`,1),qie=(r,e)=>{H(e,!1)},jie=(r,e)=>{H(e,!0)},zie=(r,e)=>{e()},Gie=J('<div class="control has-icons-left"><input class="input is-small" type="text" placeholder="$_VAR_NAME"> <span class="icon is-small is-left"><i class="fa-regular fa-keyboard"></i></span></div>'),Hie=J('<div><div class="content is-small">Configuration parameters used by sequelize, visit <a href="https://sequelize.org/">https://sequelize.org/</a> for more information. <br> You can also use the name of an application variable to use it, for example <strong>$_VAR_NAME</strong>.</div></div> <div class="box"><div class="buttons has-addons"><button>JSON Parameters</button> <button>Use Variable</button></div> <!></div>',1),Yie=J("<div><!></div>");function Kie(r,e){Ot(e,!0);const t=w=>{var x=Vie(),S=ye(x),y=te(R(S),2),b=R(y);Et(b),b.__change=[Xie,g],P(y),Lt(2),P(S);var O=te(S,2),T=te(R(O),4),k=te(R(T),5),Q=te(R(k),2);zi(Q,{get jsonObject(){return C(u)},set jsonObject(A){H(u,Y(A))}}),P(k),P(T),Lt(2),P(O),Xt(b,()=>C(d),A=>H(d,A)),W(w,x)},n=w=>{var x=Hie(),S=te(ye(x),2),y=R(S),b=R(y);b.__click=[qie,l];var O=te(b,2);O.__click=[jie,l],P(y);var T=te(y,2);{var k=A=>{ui(A,{isReadOnly:!1,lang:"json",onchange:_=>{g()},get code(){return C(f)},set code(_){H(f,Y(_))}})},Q=A=>{var _=Gie(),N=R(_);Et(N),N.__change=[zie,g],Lt(2),P(_),Xt(N,()=>C(c),U=>H(c,U)),W(A,_)};se(T,A=>{C(l)?A(Q,!1):A(k)})}P(S),Re(()=>{ft(b,`button is-small ${(C(l)?"":"is-active is-primary")??""}`),ft(O,`button is-small ${(C(l)?"is-active is-primary":"")??""}`)}),W(w,x)},i=w=>{oa(w,{get environment(){return a().environment},isReadOnly:!0})},s=w=>{var x=Yie(),S=R(x);aa(S,{get method(){return a().method},get url(){return a().endpoint},methodDisabled:!0,onchange:y=>{g()},get data(){return a().data_test},set data(y){a(a().data_test=y,!0)}}),P(x),W(w,x)};let a=me(e,"row",31,()=>Y({endpoint:"",method:"",environment:""})),o=me(e,"onchange",3,()=>{}),l=be(!1),f=be(Y({})),c=be(""),h=be(Y([{label:"Table Name",isActive:!0,classIcon:" fa-solid fa-database ",component:t},{label:"Connection Parameters",component:n},{label:"App Variables",component:i},{label:"Tester",component:s}])),u=be(Y({data:[{field01:1,field02:"demo",field03:new Date},{field01:2,field02:"test",field03:new Date},{field01:5,field02:"app",field03:new Date},{field01:12,field02:"red",field03:new Date},{field01:20,field02:"dog",field03:new Date},{field01:3,field02:"edwinspire",field03:new Date}]})),d=be("");function p(){try{let w=JSON.parse(a().code||"{}");w&&w.table_name&&H(d,Y(w.table_name)),w&&w.config&&(typeof w.config=="object"?(H(f,Y(w.config)),H(l,!1)):(H(c,Y(w.config)),H(l,!0)))}catch(w){H(f,Y({})),H(c,""),H(d,""),console.error("Error",w)}}function m(){return{code:Ht(v()),data_test:Ht(a().data_test)}}function g(){o()(m())}function v(){let w={},x={};try{C(l)?w=C(c):w=JSON.parse(C(f))}catch(S){console.warn("No se pudo parsear getCode SQL",S,C(c),C(f)),w=""}try{return x.config=w,x.table_name=C(d),JSON.stringify(x,null,2)}catch(S){return console.warn(S),code}}It(()=>{p()}),Mn(r,{get tabs(){return C(h)},set tabs(w){H(h,Y(w))}}),xt()}Or(["change","click"]);var Jie=J(`<div><div><div><div class="content is-small"><span style="font-style: oblique; font-weight: bold;">$nameparameter</span> to bind, or <span style="font-style: oblique; font-weight: bold;">:nameparameter</span> to
					use array bind. The values you send in the request. For more information go to the "Pass
					parameters" tab.</div></div></div> <!></div>`),ese=J(`<div class="block"><div class="icon-text"><span class="icon has-text-warning"><i class="fas fa-exclamation-triangle"></i></span> <span>GET Method - Warning</span></div> <div class="block">The GET method is recommended only for simple requests where there is no input
						parameters, or failing that the parameters are key-value on query request, which will be
						used to bind with the variables of the SQL query.</div></div>`),tse=J(`<div class="block"><div class="icon-text"><span class="icon has-text-info"><i class="fa-solid fa-circle-exclamation"></i></span> <span>When you use the POST method, the input parameters must be sent in the BODY in JSON
							format, using the following example:</span></div> <br> <!></div>`),rse=J(`<div><div class="content is-small"><p>This "handler" uses <a href="https://help.sap.com/docs/HANA_SERVICE_CF/1efad1691c1f496b8b580064a6536c2d/a5c332936d9f47d8b820a4ecc427352c.html">@sap/hana-client internally</a>. However, the way the parameters are passed is a little different in order to facilitate
				its use.</p> <div class="block"><h4>Parameter name</h4> <div class="block">If in the query you use the parameter with the prefix <strong>"$"</strong> (<code>$param_name</code>), it is expected that this variable corresponds to a value that will be injected into
					the query. <br> <div class="block">For example the following query: <br> <code></code> <br> Internally the query becomes:: <br> <code></code></div></div> <div class="block">If in the query you use the parameter with the prefix <strong>":"</strong> (<code>:param_name</code>), this variable is expected to contain an array of values that will be injected into
					the query. <br> <div class="block">For example the following query: <br> <code></code> <br> The parameters you must send should look like the following example: <br> <!> <br> Internally the query becomes: <br> <code></code></div></div> <div class="icon-text"><span class="icon has-text-warning"><i class="fa-solid fa-circle-exclamation"></i></span> <span>Note that parameter names when sent in the request should not include the prefix.</span></div> <div class="icon-text"><span class="icon has-text-warning"><i class="fas fa-exclamation-triangle"></i></span> <span>If you send a parameter that is not present in the query you will get an error similar
						to: <code>There are missing parameters.</code></span></div></div> <!></div></div>`),nse=(r,e)=>{H(e,!1)},ise=(r,e)=>{H(e,!0)},sse=J('<div class="content is-small"><details><summary>By example, in most cases the following connection parameters are sufficient:</summary> <!></details></div> <!>',1),ase=(r,e)=>{e()},ose=J('<div class="content is-small">You can also use the name of an application variable to use it, for example <strong>$_VAR_NAME</strong>.</div> <div class="control has-icons-left"><input class="input is-small" type="text" placeholder="$_VAR_NAME"> <span class="icon is-small is-left"><i class="fa-regular fa-keyboard"></i></span></div>',1),lse=J('<div><div><div class="content is-small">Configuration parameters used by @sap/hana-client, visit <a href="https://help.sap.com/docs/HANA_SERVICE_CF/1efad1691c1f496b8b580064a6536c2d/4fe9978ebac44f35b9369ef5a4a26f4c.html">@sap/hana-client</a> for more information.</div></div> <div class="box"><div class="buttons has-addons"><button>JSON Parameters</button> <button>Use Variable</button></div> <!></div></div>'),fse=J("<div><!></div>");function cse(r,e){Ot(e,!0);const t=k=>{var Q=Jie(),A=te(R(Q),2);ui(A,{isReadOnly:!1,lang:"sql",onchange:_=>{b()},get code(){return C(x)},set code(_){H(x,Y(_))}}),P(Q),W(k,Q)},n=k=>{var Q=rse(),A=R(Q),_=te(R(A),2),N=te(R(_),2),U=te(R(N),7),z=te(R(U),3);z.textContent=d;var K=te(z,6);K.textContent=p,P(U),P(N);var re=te(N,2),ge=te(R(re),7),V=te(R(ge),3);V.textContent=m;var he=te(V,6);zi(he,{get jsonObject(){return C(v)},set jsonObject(Z){H(v,Y(Z))}});var ae=te(he,6);ae.textContent=g,P(ge),P(re),Lt(4),P(_);var E=te(_,2);{var L=Z=>{var ee=ese();W(Z,ee)},I=Z=>{var ee=Ae(),ne=ye(ee);{var de=fe=>{var pe=tse(),Me=te(R(pe),4);zi(Me,{get jsonObject(){return C(v)},set jsonObject(q){H(v,Y(q))}}),P(pe),W(fe,pe)};se(ne,fe=>{o().method==="POST"&&fe(de)},!0)}W(Z,ee)};se(E,Z=>{o().method==="GET"?Z(L):Z(I,!1)})}P(A),P(Q),W(k,Q)},i=k=>{var Q=lse(),A=te(R(Q),2),_=R(A),N=R(_);N.__click=[nse,f];var U=te(N,2);U.__click=[ise,f],P(_);var z=te(_,2);{var K=ge=>{var V=sse(),he=ye(V),ae=R(he),E=te(R(ae),2);zi(E,{get jsonObject(){return C(u)},set jsonObject(I){H(u,Y(I))}}),P(ae),P(he);var L=te(he,2);ui(L,{isReadOnly:!1,lang:"json",onchange:I=>{b()},get code(){return C(c)},set code(I){H(c,Y(I))}}),W(ge,V)},re=ge=>{var V=ose(),he=te(ye(V),2),ae=R(he);Et(ae),ae.__change=[ase,b],Lt(2),P(he),Xt(ae,()=>C(h),E=>H(h,E)),W(ge,V)};se(z,ge=>{C(f)?ge(re,!1):ge(K)})}P(A),P(Q),Re(()=>{ft(N,`button is-small ${(C(f)?"":"is-active is-primary")??""}`),ft(U,`button is-small ${(C(f)?"is-active is-primary":"")??""}`)}),W(k,Q)},s=k=>{oa(k,{get environment(){return o().environment},isReadOnly:!0})},a=k=>{var Q=fse(),A=R(Q);aa(A,{get method(){return o().method},get url(){return o().endpoint},methodDisabled:!0,onchange:_=>{b()},get data(){return o().data_test},set data(_){o(o().data_test=_,!0)}}),P(Q),W(k,Q)};let o=me(e,"row",31,()=>Y({})),l=me(e,"onchange",3,()=>{}),f=be(!1),c=be(Y({})),h=be(""),u=be(Y({host:"<host-name>",port:"<port>",user:"SYSTEM",password:"manager",pooling:!0})),d="SELECT * FROM YOUR_TABLE WHERE FIELD_01 = $value_01;",p="SELECT * FROM YOUR_TABLE WHERE FIELD_01 = ?;",m="SELECT * FROM YOUR_TABLE WHERE FIELD_01 = $value_01 AND FIELD_02 IN (:list_your_values);",g="SELECT * FROM YOUR_TABLE WHERE FIELD_01 = ? AND FIELD_02 IN (?, ?);",v=be(Y({params:{value_01:1234,list_your_values:["0002000157","0002000158"]}})),w=be(Y([{label:"Query",isActive:!0,classIcon:" fa-solid fa-database ",component:t},{label:"Pass Parameters",component:n},{label:"Connection Parameters",component:i},{label:"App Variables",component:s},{label:"Tester",component:a}])),x=be(""),S;Js(()=>{var k;(k=o())!=null&&k.code&&(clearTimeout(S),S=setTimeout(()=>{y()},750))});function y(){try{let k=JSON.parse(o().code||"{}");k&&k.query&&H(x,Y(k.query)),k&&k.config&&(typeof k.config=="object"?(H(c,Y(k.config)),H(f,!1)):(H(h,Y(k.config)),H(f,!0)))}catch(k){H(c,Y({})),H(h,""),H(x,"SELECT 1;"),console.error("Error",k)}}function b(){l()(O())}function O(){let k={code:T(),data_test:Ht(o().data_test)};return console.log("getData >>>>>>>>>>>>>>> ",k),k}function T(){let k={},Q={};try{C(f)?k=C(h):k=typeof C(c)=="object"?C(c):JSON.parse(C(c))}catch(A){console.warn("No se pudo parsear getCode SQL",A,C(h),C(c)),k=""}try{return Q.config=k,Q.query=C(x),JSON.stringify(Q,null,2)}catch(A){return console.warn(A),code}}It(()=>{y()}),ea(()=>{clearTimeout(S)}),Mn(r,{get tabs(){return C(w)},set tabs(k){H(w,Y(k))}}),xt()}Or(["click","change"]);var hse=J('<div><div><div><div class="field is-horizontal"><div class="field-label is-small"><label class="label">MIME Type</label></div> <div class="field-body"><div class="field is-narrow"><div class="control"><div class="is-fullwidth"><!></div></div></div></div></div> <div class="content is-small">Plain Text that will be returned by the Endpoint.</div></div></div> <!></div>'),use=J("<div><!></div>");function dse(r,e){Ot(e,!0);const t=g=>{var v=hse(),w=R(v),x=R(w),S=R(x),y=te(R(S),2),b=R(y),O=R(b),T=R(O),k=R(T);Y0(k,{onchange:A=>{let _=C(o).find(N=>N.id==C(f));_?H(h,Y(_.editor)):H(h,"text")},get options(){return C(o)},set options(A){H(o,Y(A))},get option(){return C(f)},set option(A){H(f,Y(A))}}),P(T),P(O),P(b),P(y),P(S),Lt(2),P(x),P(w);var Q=te(w,2);ui(Q,{onchange:A=>{m()},get lang(){return C(h)},set lang(A){H(h,Y(A))},get code(){return C(c)},set code(A){H(c,Y(A))}}),P(v),W(g,v)},n=g=>{oa(g,{get environment(){return s().environment},isReadOnly:!0})},i=g=>{var v=use(),w=R(v);aa(w,{get method(){return s().method},get url(){return s().endpoint},methodDisabled:!0,onchange:x=>{m()},get data(){return s().data_test},set data(x){s(s().data_test=x,!0)}}),P(v),W(g,v)};let s=me(e,"row",31,()=>Y({})),a=me(e,"onchange",3,()=>{}),o=be(Y([{id:"text/plain",value:"text/plain",enabled:!0,editor:"text"},{id:"text/html",value:"text/html",enabled:!0,editor:"html"},{id:"text/css",value:"text/css",enabled:!0,editor:"text"},{id:"text/javascript",value:"text/javascript",enabled:!0,editor:"js"},{id:"text/xml",value:"text/xml",enabled:!0,editor:"xml"},{id:"application/wsdl+xml",value:"application/wsdl+xml",enabled:!0,editor:"xml"},{id:"text/csv",value:"text/csv",enabled:!0,editor:"text"},{id:"text/markdown",value:"text/markdown",enabled:!0,editor:"text"},{id:"text/cache-manifest",value:"text/cache-manifest",enabled:!0,editor:"text"},{id:"text/calendar",value:"text/calendar",enabled:!0,editor:"text"},{id:"text/vnd.sun.j2me.app-descriptor",value:"text/vnd.sun.j2me.app-descriptor",enabled:!0,editor:"text"},{id:"text/vnd.wap.wml",value:"text/vnd.wap.wml",enabled:!0,editor:"text"},{id:"text/vnd.wap.wmlscript",value:"text/vnd.wap.wmlscript",enabled:!0,editor:"text"},{id:"text/x-asm",value:"text/x-asm",enabled:!0,editor:"text"},{id:"text/x-c",value:"text/x-c",enabled:!0,editor:"text"},{id:"text/x-fortran",value:"text/x-fortran",enabled:!0,editor:"text"},{id:"text/x-java-source",value:"text/x-java-source",enabled:!0,editor:"text"},{id:"text/x-markdown",value:"text/x-markdown",enabled:!0,editor:"text"},{id:"text/x-nfo",value:"text/x-nfo",enabled:!0,editor:"text"},{id:"text/x-opml",value:"text/x-opml",enabled:!0,editor:"text"},{id:"text/x-pascal",value:"text/x-pascal",enabled:!0,editor:"text"},{id:"text/x-script",value:"text/x-script",enabled:!0,editor:"text"},{id:"text/x-script.perl",value:"text/x-script.perl",enabled:!0,editor:"text"},{id:"text/x-script.python",value:"text/x-script.python",enabled:!0,editor:"text"},{id:"text/x-server-parsed-html",value:"text/x-server-parsed-html",enabled:!0,editor:"html"},{id:"text/x-setext",value:"text/x-setext",enabled:!0,editor:"text"},{id:"text/x-sfv",value:"text/x-sfv",enabled:!0,editor:"text"},{id:"text/x-uuencode",value:"text/x-uuencode",enabled:!0,editor:"text"},{id:"text/x-vcalendar",value:"text/x-vcalendar",enabled:!0,editor:"text"},{id:"text/x-vcard",value:"text/x-vcard",enabled:!0,editor:"text"},{id:"text/troff",value:"text/troff",enabled:!0,editor:"text"},{id:"text/x-component",value:"text/x-component",enabled:!0,editor:"text"}])),l=be(Y([{label:"Payload",isActive:!0,component:t},{label:"App Variables",component:n},{label:"Tester",component:i}])),f=be("text/plain"),c=be(""),h=be("txt");Js(()=>{var g;(g=s())!=null&&g.code&&u()});function u(){try{let g=JSON.parse(s().code||"{}");g&&g.payload&&H(c,Y(g.payload)),g&&g.mimeType&&H(f,Y(g.mimeType))}catch(g){H(f,"text/plain"),H(c,""),console.error("Error",g)}}function d(){let g={};try{return g.mimeType=C(f),g.payload=C(c),JSON.stringify(g,null,2)}catch{return s().code}}function p(){return{code:Ht(d()),data_test:Ht(s().data_test)}}function m(){a()(p())}It(()=>{u()}),Mn(r,{get tabs(){return C(l)},set tabs(g){H(l,Y(g))}}),xt()}const pse=r=>{$P(r)};var mse=J('<div><div><div class="content is-small">For more information you can consult the <a href="https://mongoosejs.com/">MONGOOSE</a> and <a href="https://www.mongodb.com/products/updates/version-release">MongoDB</a> documentation.</div></div></div> <!>',1),gse=(r,e)=>{H(e,!1)},Ose=(r,e)=>{H(e,!0)},xse=(r,e)=>{e()},vse=J('<div class="control has-icons-left"><input class="input is-small" type="text" placeholder="$_VAR_NAME"> <span class="icon is-small is-left"><i class="fa-regular fa-keyboard"></i></span></div>'),yse=J('<div><div class="content is-small">Configuration parameters used by mongoosejs, visit <a href="https://mongoosejs.com/">Mongoose</a> for more information. <br> <details><summary>Example of configuration parameters:</summary> <!></details> <br> You can also use the name of an application variable to use it, for example <strong>$_VAR_NAME</strong>.</div></div> <div class="box"><div class="buttons has-addons"><button>JSON Parameters</button> <button>Use Variable</button></div> <!></div>',1),wse=J("<div><!></div>");function bse(r,e){Ot(e,!0);const t=x=>{var S=mse(),y=te(ye(S),2);ui(y,{isReadOnly:!1,lang:"js",onchange:b=>{g()},get code(){return C(u)},set code(b){H(u,Y(b))}}),W(x,S)},n=x=>{var S=yse(),y=ye(S),b=R(y),O=te(R(b),5),T=te(R(O),2);zi(T,{jsonObject:p}),P(O),Lt(5),P(b),P(y);var k=te(y,2),Q=R(k),A=R(Q);A.__click=[gse,l];var _=te(A,2);_.__click=[Ose,l],P(Q);var N=te(Q,2);{var U=K=>{ui(K,{isReadOnly:!1,lang:"json",onchange:()=>{g()},get code(){return C(f)},set code(re){H(f,Y(re))}})},z=K=>{var re=vse(),ge=R(re);Et(ge),ge.__change=[xse,g],Lt(2),P(re),Xt(ge,()=>C(c),V=>H(c,V)),W(K,re)};se(N,K=>{C(l)?K(z,!1):K(U)})}P(k),Re(()=>{ft(A,`button is-small ${(C(l)?"":"is-active is-primary")??""}`),ft(_,`button is-small ${(C(l)?"is-active is-primary":"")??""}`)}),W(x,S)},i=x=>{oa(x,{get environment(){return a().environment},isReadOnly:!0})},s=x=>{var S=wse(),y=R(S);aa(y,{get method(){return a().method},get url(){return a().endpoint},methodDisabled:!0,onchange:b=>{g()},get data(){return a().data_test},set data(b){a(a().data_test=b,!0)}}),P(S),W(x,S)};let a=me(e,"row",31,()=>Y({endpoint:"",method:"",environment:""})),o=me(e,"onchange",3,()=>{}),l=be(!1),f=be(Y({})),c=be(""),h=be(Y([{label:"Code",isActive:!0,classIcon:" fa-brands fa-node-js ",component:t},{label:"Predefined Variables",component:pse},{label:"Connection Parameters",component:n},{label:"App Variables",component:i},{label:"Tester",component:s}])),u=be("let test = 1;"),d,p={host:"localhost",port:27017,dbName:"my_db",user:"",pass:"",options:{useNewUrlParser:!0,useUnifiedTopology:!0,useCreateIndex:!0,useFindAndModify:!1}};Js(()=>{var x;(x=a())!=null&&x.code&&(clearTimeout(d),d=setTimeout(()=>{m()},750))});function m(){try{let x=JSON.parse(a().code||"{}");x&&x.code&&H(u,Y(x.code)),x&&x.config&&(typeof x.config=="object"?(H(f,Y(x.config)),H(l,!1)):(H(c,Y(x.config)),H(l,!0)))}catch(x){H(f,Y({})),H(c,""),H(u,"SELECT 1;"),console.error("Error",x)}}function g(){o()(v())}function v(){return{code:w(),data_test:Ht(a().data_test)}}function w(){let x={},S={};try{C(l)?x=C(c):x=typeof C(f)=="object"?C(f):JSON.parse(C(f))}catch(y){console.warn("No se pudo parsear getCode SQL",y,C(c),C(f)),x=""}try{return S.config=x,S.code=C(u),JSON.stringify(S,null,2)}catch(y){return console.warn(y),code}}It(()=>{m()}),ea(()=>{clearTimeout(d)}),Mn(r,{get tabs(){return C(h)},set tabs(x){H(h,Y(x))}}),xt()}Or(["click","change"]);var _se=J('<div class="content is-small">Use the selected function to return a response.</div> <div class="field is-horizontal"><div class="field-label is-normal"><label class="label is-small">Function</label></div> <div class="field-body"><div class="field is-narrow"><!></div></div></div>',1),kse=J("<div><!></div>");function Sse(r,e){Ot(e,!0);const t=d=>{var p=_se(),m=te(ye(p),2),g=te(R(m),2),v=R(g),w=R(v);Y0(w,{onchange:x=>{u()},get options(){return C(a)},set options(x){H(a,Y(x))},get option(){return i().code},set option(x){i(i().code=x,!0)}}),P(v),P(g),P(m),W(d,p)},n=d=>{var p=kse(),m=R(p);aa(m,{get method(){return i().method},get url(){return i().endpoint},methodDisabled:!0,onchange:g=>{u()},get data(){return i().data_test},set data(g){i(i().data_test=g,!0)}}),P(p),W(d,p)};let i=me(e,"row",31,()=>Y({})),s=me(e,"onchange",3,()=>{}),a=be(Y([])),o=[],l=[],f=[],c=be(Y([{label:"Function",isActive:!0,component:t},{label:"Tester",component:n}]));function h(){return{code:Ht(i().code),data_test:Ht(i().data_test)}}function u(){s()(h())}Em.subscribe(d=>{o=d}),Pm.subscribe(d=>{l=d}),Rm.subscribe(d=>{f=d}),It(()=>{switch(i().environment){case"dev":H(a,Y(o));break;case"qa":H(a,Y(l));break;case"prd":H(a,Y(f));break}}),Mn(r,{get tabs(){return C(c)},set tabs(d){H(c,Y(d))}}),xt()}var Tse=J('<div class="icon-text is-small"><span class="icon has-text-success"><i class="fas fa-check-square"></i></span> <span>Url Success</span></div>'),Cse=J('<div class="icon-text is-small"><span class="icon has-text-danger"><i class="fas fa-ban"></i></span> <span>Url Invalid</span></div>'),Ase=J('<div class="icon-text is-small"><span class="icon has-text-success"><i class="fas fa-check-square"></i></span> <span>Available URL</span></div>'),Ese=J('<div class="icon-text is-small"><span class="icon has-text-danger"><i class="fas fa-ban"></i></span> <span>Url not available</span></div>'),Pse=J('<div><input class="input" type="hidden" placeholder="Name"> <div class="field is-horizontal"><div class="field-label is-small"><label class="label">Enabled</label></div> <div class="field-body"><div class="field"><div class="control"><label class="checkbox"><input type="checkbox"></label></div></div></div></div> <div class="field is-horizontal"><div class="field-label is-small"><label class="label">Method</label></div> <div class="field-body"><div class="field"><div class="control"><!></div></div></div></div> <div class="field is-horizontal"><div class="field-label is-small"><label class="label">Access</label></div> <div class="field-body"><div class="field"><div class="control"><!></div></div></div></div> <div class="field is-horizontal"><div class="field-label is-small"><label class="label">Handler</label></div> <div class="field-body"><div class="field"><div class="control"><!></div></div></div></div> <div class="field"><div class="field is-horizontal"><div class="field-label is-small"><strong>API Resource:</strong></div> <div class="field-body"><div class="field is-expanded"><div class="field has-addons"><p class="control"><a class="button is-small is-static"> </a></p> <p class="control is-expanded"><input class="input is-small" type="text" placeholder="Resourse"></p> <p class="control"><a class="button is-small is-static">/</a></p> <p class="control"><!></p></div> <div class="help"><!> <!></div></div></div></div></div> <div class="field"><label class="label is-small">Description</label> <div class="control"><textarea class="textarea is-small" placeholder="Textarea"></textarea></div></div></div>');function Rse(r,e){Ot(e,!0);let t=me(e,"environment_list",31,()=>Y([])),n=me(e,"row",31,()=>Y({method:"X",access:0})),i=me(e,"app",27,()=>Y({})),s=me(e,"validateResource",15,!1),a=me(e,"availableURL",15,!1),o=be(Y([])),l=be(Y([])),f=new es;Am.subscribe(ke=>{H(o,Y(ke))}),md.subscribe(ke=>{f.setBearerAuthorization(ke.token)}),Cm.subscribe(ke=>{H(l,Y(ke))}),Js(()=>{s(D3(n().resource)),a(c()),n(n().endpoint=M3(n().method,i().app,n().resource,n().environment),!0)});function c(){return!i().endpoints.some(Ee=>n().resource==Ee.resource&&n().environment==Ee.environment&&n().method==Ee.method&&n().idendpoint!=Ee.idendpoint)}async function h(){try{let Ee=await(await f.GET({url:vn.listEnv})).json();Ee&&Array.isArray(Ee)&&Ee.length>0?t(Ee.map(Ft=>({id:Ft.id,value:Ft.text}))):t([])}catch(ke){alert(ke.message)}}It(async()=>{await h()});var u=Pse(),d=R(u);Et(d);var p=te(d,2),m=te(R(p),2),g=R(m),v=R(g),w=R(v),x=R(w);Et(x),P(w),P(v),P(g),P(m),P(p);var S=te(p,2),y=te(R(S),2),b=R(y),O=R(b),T=R(O);{var k=ke=>{km(ke,{onselect:Ee=>{console.log("Row",n())},get options(){return C(l)},set options(Ee){H(l,Y(Ee))},get option(){return n().method},set option(Ee){n(n().method=Ee,!0)}})};se(T,ke=>{n()&&n().method&&ke(k)})}P(O),P(b),P(y),P(S);var Q=te(S,2),A=te(R(Q),2),_=R(A),N=R(_),U=R(N);{var z=ke=>{km(ke,{options:B2,onselect:Ee=>{console.log("Row",n())},get option(){return n().access},set option(Ee){n(n().access=Ee,!0)}})};se(U,ke=>{n()&&ke(z)})}P(N),P(_),P(A),P(Q);var K=te(Q,2),re=te(R(K),2),ge=R(re),V=R(ge),he=R(V);{var ae=ke=>{km(ke,{onselect:Ee=>{console.log("Row",n())},get options(){return C(o)},set options(Ee){H(o,Y(Ee))},get option(){return n().handler},set option(Ee){n(n().handler=Ee,!0)}})};se(he,ke=>{n()&&n().handler&&ke(ae)})}P(V),P(ge),P(re),P(K);var E=te(K,2),L=R(E),I=te(R(L),2),Z=R(I),ee=R(Z),ne=R(ee),de=R(ne),fe=R(de);P(de),P(ne);var pe=te(ne,2),Me=R(pe);Et(Me),P(pe);var q=te(pe,4),He=R(q);{var Ve=ke=>{Y0(ke,{onselect:Ee=>{},get options(){return t()},set options(Ee){t(Ee)},get option(){return n().environment},set option(Ee){n(n().environment=Ee,!0)}})};se(He,ke=>{n()&&n().environment&&ke(Ve)})}P(q),P(ee);var Te=te(ee,2),Ne=R(Te);{var ve=ke=>{var Ee=Tse();W(ke,Ee)},ct=ke=>{var Ee=Cse();W(ke,Ee)};se(Ne,ke=>{s()?ke(ve):ke(ct,!1)})}var bt=te(Ne,2);{var Bt=ke=>{var Ee=Ase();W(ke,Ee)},er=ke=>{var Ee=Ae(),Ft=ye(Ee);{var xr=Vt=>{var Ke=Ese();W(Vt,Ke)};se(Ft,Vt=>{s()&&!a()&&Vt(xr)},!0)}W(ke,Ee)};se(bt,ke=>{s()&&a()?ke(Bt):ke(er,!1)})}P(Te),P(Z),P(I),P(L),P(E);var Qe=te(E,2),Xe=te(R(Qe),2),De=R(Xe);x0(De),P(Xe),P(Qe),P(u),Re(()=>Ge(fe,`${(n().method=="WS"?"/ws/":"/api/")??""}${i().app??""}`)),Xt(d,()=>n().idendpoint,ke=>n(n().idendpoint=ke,!0)),D2(x,()=>n().enabled,ke=>n(n().enabled=ke,!0)),Xt(Me,()=>n().resource,ke=>n(n().resource=ke,!0)),Xt(De,()=>n().description,ke=>n(n().description=ke,!0)),W(r,u),xt()}function Qse(r,e){Ot(e,!0);let t=me(e,"users",31,()=>Y({})),n=be(Y([])),i=[],s=be(Y({auth:{label:"Authorization",decorator:{component:bc,props:{ontrue:{label:"Enabled"},onfalse:{label:"Unabled"},editInline:!0}}},iduser:{label:"iduser",hidden:!0},enabled:{label:"Enabled",decorator:{component:bc,props:{ontrue:{label:"Enabled"},onfalse:{label:"Unabled"},editInline:!1}}},name:{label:"name"},username:{label:"username"},email:{label:"email"}})),a;Qu.subscribe(f=>{i=f,l()});function o(){t()||t([])}function l(){o(),i&&Array.isArray(i)&&H(n,Y(i.map(f=>({auth:t().includes(f.iduser),...f}))))}It(()=>{o()}),ea(()=>{clearTimeout(a)}),Th(r,{get RawDataTable(){return C(n)},set RawDataTable(f){H(n,Y(f))},get columns(){return C(s)},set columns(f){H(s,Y(f))}}),xt()}var Fse=J("<option> </option>"),$se=J('<span><div class="field is-horizontal"><div class="field-body"><div class="field"><div class="control"><div class="select is-fullwidth is-small"><select><!></select></div></div> <span class="help is-success"><div><!></div></span></div></div></div></span>'),Nse=J("<div><!></div>");function Mf(r,e){Ot(e,!0);let t=me(e,"level",15,0);me(e,"ondata",3,l=>{});let n=Y([{id:0,value:"Disabled",enabled:!0},{id:1,value:"Basic",enabled:!0},{id:2,value:"Normal",enabled:!0},{id:3,value:"Full",enabled:!0}]);function i(){t()==null&&t(0)}It(()=>{i()});var s=Nse(),a=R(s);{var o=l=>{var f=$se(),c=R(f),h=R(c),u=R(h),d=R(u),p=R(d),m=R(p),g=R(m);{var v=O=>{var T=Ae(),k=ye(T);Pr(k,17,()=>n,Lr,(Q,A)=>{var _=Fse(),N={},U=R(_,!0);P(_),Re(()=>{N!==(N=C(A).id)&&(_.value=(_.__value=C(A).id)==null?"":C(A).id),Ge(U,C(A).value)}),W(Q,_)}),W(O,T)};se(g,O=>{n&&n.length>0&&O(v)})}P(m),P(p),P(d);var w=te(d,2),x=R(w),S=R(x);{var y=O=>{var T=ms("Does not save any log.");W(O,T)},b=O=>{var T=Ae(),k=ye(T);{var Q=_=>{var N=ms("Save the minimum data.");W(_,N)},A=_=>{var N=Ae(),U=ye(N);{var z=re=>{var ge=ms("Save the most useful data.");W(re,ge)},K=re=>{var ge=Ae(),V=ye(ge);{var he=ae=>{var E=ms("Saves all request and response data.");W(ae,E)};se(V,ae=>{t()==3&&ae(he)},!0)}W(re,ge)};se(U,re=>{t()==2?re(z):re(K,!1)},!0)}W(_,N)};se(k,_=>{t()==1?_(Q):_(A,!1)},!0)}W(O,T)};se(S,O=>{t()==0?O(y):O(b,!1)})}P(x),P(w),P(u),P(h),P(c),P(f),Fl(m,t),W(l,f)};se(a,l=>{t()>=0&&l(o)})}P(s),W(r,s),xt()}var Dse=J(`<div class="content is-small"><table class="table is-bordered is-striped is-hoverable"><thead><tr><th><span>Log Level</span></th><th><span>HTTP Status Codes</span></th><th><span>Description</span></th></tr></thead><tbody><tr><td><!></td><td><div>1XX</div></td><td><details><summary>Informational</summary> <div>They indicate that the request has been received and is being processed.</div> <div><ul><li>100 (Continue)</li> <li>101 (Switching Protocols)</li> <li>102 (Processing)</li></ul></div></details></td></tr><tr><td><!></td><td><div>2XX</div></td><td><details><summary>Success</summary> <div>The request has been received, understood and processed correctly.</div> <div><ul><li>200 (OK)</li> <li>201 (Created)</li> <li>202 (Accepted)</li> <li>203 (Non-Authoritative Information)</li> <li>204 (No Content)</li> <li>205 (Reset Content)</li> <li>206 (Partial Content)</li> <li>207 (Multi-Status)</li> <li>208 (Already Reported)</li> <li>226 (IM Used)</li></ul></div></details></td></tr><tr><td><!></td><td><div>3XX</div></td><td><details><summary>Redirection</summary> <div>The customer must take additional actions to complete the request.</div> <div><ul><li>300 (Multiple Choices)</li> <li>301 (Moved Permanently)</li> <li>302 (Found)</li> <li>303 (See Other)</li> <li>304 (Not Modified)</li> <li>305 (Use Proxy)</li> <li>307 (Temporary Redirect)</li> <li>308 (Permanent Redirect)</li></ul></div></details></td></tr><tr><td><!></td><td><div>4XX</div></td><td><details><summary>Client error</summary> <div>The request contains an error or cannot be processed.</div> <div><ul><li>400 (Bad Request)</li> <li>401 (Unauthorized)</li> <li>402 (Payment Required)</li> <li>403 (Forbidden)</li> <li>404 (Not Found)</li> <li>405 (Method Not Allowed)</li> <li>406 (Not Acceptable)</li> <li>407 (Proxy Authentication Required)</li> <li>408 (Request Timeout)</li> <li>409 (Conflict)</li> <li>410 (Gone)</li> <li>411 (Length Required)</li> <li>412 (Precondition Failed)</li> <li>413 (Payload Too Large)</li> <li>414 (URI Too Long)</li> <li>415 (Unsupported Media Type)</li> <li>416 (Range Not Satisfiable)</li> <li>417 (Expectation Failed)</li> <li>418 (I'm a teapot)</li> <li>421 (Misdirected Request)</li> <li>422 (Unprocessable Entity)</li> <li>423 (Locked)</li> <li>424 (Failed Dependency)</li> <li>425 (Too Early)</li> <li>426 (Upgrade Required)</li> <li>428 (Precondition Required)</li> <li>429 (Too Many Requests)</li> <li>431 (Request Header Fields Too Large)</li> <li>451 (Unavailable For Legal Reasons)</li></ul></div></details></td></tr><tr><td><!></td><td><div>5XX</div></td><td><details><summary>Server error</summary> <div>The server was unable to fulfill an apparently valid request.</div> <div><ul><li>500 (Internal Server Error)</li> <li>501 (Not Implemented)</li> <li>502 (Bad Gateway)</li> <li>503 (Service Unavailable)</li> <li>504 (Gateway Timeout)</li> <li>505 (HTTP Version Not Supported)</li> <li>506 (Variant Also Negotiates)</li> <li>507 (Insufficient Storage)</li> <li>508 (Loop Detected)</li> <li>510 (Not Extended)</li> <li>511 (Network Authentication Required)</li></ul></div></details></td></tr></tbody></table></div>`),Mse=J('<div class="field has-addons has-addons-centered"><span class="control"><input class="input is-small" type="datetime-local" placeholder="Start"></span> <span class="control"><a class="button is-static is-small">Start</a></span></div>'),Ise=J('<div class="field has-addons has-addons-centered"><span class="control"><input class="input is-small" type="datetime-local" placeholder="Start"></span> <span class="control"><a class="button is-static is-small">End</a></span></div>'),Lse=J('<div class="field has-addons has-addons-centered"><span class="control"><input class="input is-small" type="number" placeholder="Limit"></span> <span class="control"><a class="button is-static is-small">Limit</a></span></div>');function Bse(r,e){Ot(e,!0);const t=p=>{var m=Dse(),g=R(m),v=te(R(g)),w=R(v),x=R(w),S=R(x);{var y=E=>{Mf(E,{get level(){return s().status_info},set level(L){s(s().status_info=L,!0)}})};se(S,E=>{s().status_info>=0&&E(y)})}P(x),Lt(2),P(w);var b=te(w),O=R(b),T=R(O);{var k=E=>{Mf(E,{get level(){return s().status_success},set level(L){s(s().status_success=L,!0)}})};se(T,E=>{s().status_success>=0&&E(k)})}P(O),Lt(2),P(b);var Q=te(b),A=R(Q),_=R(A);{var N=E=>{Mf(E,{get level(){return s().status_redirect},set level(L){s(s().status_redirect=L,!0)}})};se(_,E=>{s().status_redirect>=0&&E(N)})}P(A),Lt(2),P(Q);var U=te(Q),z=R(U),K=R(z);{var re=E=>{Mf(E,{get level(){return s().status_client_error},set level(L){s(s().status_client_error=L,!0)}})};se(K,E=>{s().status_client_error>=0&&E(re)})}P(z),Lt(2),P(U);var ge=te(U),V=R(ge),he=R(V);{var ae=E=>{Mf(E,{get level(){return s().status_server_error},set level(L){s(s().status_server_error=L,!0)}})};se(he,E=>{s().status_server_error>=0&&E(ae)})}P(V),Lt(2),P(ge),P(v),P(g),P(m),W(p,m)},n=p=>{{const m=w=>{var x=Mse(),S=R(x),y=R(S);Et(y),P(S),Lt(2),P(x),Xt(y,()=>C(h).params.startDate,b=>C(h).params.startDate=b),W(w,x)},g=w=>{var x=Ise(),S=R(x),y=R(S);Et(y),P(S),Lt(2),P(x),Xt(y,()=>C(h).params.endDate,b=>C(h).params.endDate=b),W(w,x)},v=w=>{var x=Lse(),S=R(x),y=R(S);Et(y),P(S),Lt(2),P(x),Xt(y,()=>C(h).params.limit,b=>C(h).params.limit=b),W(w,x)};Th(p,{right_items:[m,g,v],get requestData(){return C(h)},set requestData(w){H(h,Y(w))},rt1:m,rt2:g,rt3:v,$$slots:{rt1:!0,rt2:!0,rt3:!0}})}};let i=me(e,"row",27,()=>Y({})),s=me(e,"log",31,()=>Y({status_info:1,status_success:1,status_redirect:1,status_client_error:2,status_server_error:3}));me(e,"ondata",3,p=>{});const a=st.local(),o=a.toFormat("yyyy-MM-dd'T'HH:mm"),f=a.minus({hours:24}).toFormat("yyyy-MM-dd'T'HH:mm");let c=be(0),h=be(Y({url:vn.getLogs,params:{startDate:f,endDate:o,idendpoint:i().idendpoint,limit:1e3,timezone:st.local().z}})),u=be(Y([{label:"Parametrization",classIcon:"fa-solid fa-rectangle-list",slot:"parameterization",isActive:!0,component:t},{label:"Registered logs",classIcon:"fa-solid fa-file-lines",slot:"logs",isActive:!1,component:n}]));function d(){s()==null&&s({status_info:1,status_success:1,status_redirect:1,status_client_error:2,status_server_error:2}),s()&&s().status_info==null&&s(s().status_info=1,!0),s()&&s().status_success==null&&s(s().status_success=1,!0),s()&&s().status_redirect==null&&s(s().status_redirect=1,!0),s()&&s().status_client_error==null&&s(s().status_client_error=2,!0),s()&&s().status_server_error==null&&s(s().status_server_error=3,!0)}It(()=>{d()}),Mn(r,{get tabs(){return C(u)},set tabs(p){H(u,Y(p))},get active(){return C(c)},set active(p){H(c,Y(p))}}),xt()}var Zse=J('<nav class="level"><div class="level-left"><div class="level-item"><h4 class="subtitle is-5"><div class="icon-text"><span class="icon has-text-info"><i class="fa-solid fa-link"></i></span> <span> </span></div></h4></div></div> <div class="level-right"><span class="level-item"><div class="field is-grouped is-grouped-multiline"><div class="control"><div class="tags has-addons"><span class="tag is-dark">Method</span> <span> </span></div></div> <div class="control"><div class="tags has-addons"><span class="tag is-dark">Handler</span> <span> </span></div></div> <div class="control"><div class="tags has-addons"><span class="tag is-dark">Env</span> <span> </span></div></div></div></span></div></nav>');function Wse(r,e){Ot(e,!0);let t=me(e,"environment",11,"?"),n=me(e,"endpoint",11,"?"),i=me(e,"method",11,"?"),s=me(e,"handler",11,"?");var a=Zse(),o=R(a),l=R(o),f=R(l),c=R(f),h=te(R(c),2),u=R(h,!0);P(h),P(c),P(f),P(l),P(o);var d=te(o,2),p=R(d),m=R(p),g=R(m),v=R(g),w=te(R(v),2),x=R(w,!0);P(w),P(v),P(g);var S=te(g,2),y=R(S),b=te(R(y),2),O=R(b,!0);P(b),P(y),P(S);var T=te(S,2),k=R(T),Q=te(R(k),2),A=R(Q,!0);P(Q),P(k),P(T),P(m),P(p),P(d),P(a),Re(()=>{var _,N,U,z,K;Ge(u,n()),ft(w,`tag is-${((_=Z2[i()])==null?void 0:_.color)??""}`),Ge(x,i()),ft(b,`tag is-${((N=Qm[s()])==null?void 0:N.color)??""}`),Ge(O,(U=Qm[s()])==null?void 0:U.label),ft(Q,`tag is-${((z=ac[t()])==null?void 0:z.background)??""}`),Ge(A,(K=ac[t()])==null?void 0:K.label)}),W(r,a),xt()}var Use=J("<div>No Handler</div>"),Xse=J("<div><!></div>"),Vse=(r,e,t)=>{e({}),t(!1)},qse=J('<div class="field has-addons"><p class="control"><button class="button is-success is-small"><span class="icon is-small"><i class="fa-solid fa-check"></i></span> <span>Accept</span></button></p> <p class="control"><button class="button is-small"><span class="icon is-small"><i class="fa-solid fa-xmark"></i></span> <span>Cancel</span></button></p></div>'),jse=J("<!> <!>",1);function zse(r,e){Ot(e,!0);const t=g=>{var v=Ae(),w=ye(v);{var x=S=>{Rse(S,{get row(){return o()},set row(y){o(y)},get app(){return l()},set app(y){l(y)},get validateResource(){return C(h)},set validateResource(y){H(h,Y(y))},get availableURL(){return C(u)},set availableURL(y){H(u,Y(y))}})};se(w,S=>{o()&&l()&&S(x)})}W(g,v)},n=g=>{var v=Ae(),w=ye(v);{var x=S=>{var y=Xse(),b=R(y);{var O=k=>{Eie(k,{onchange:Q=>{c[o().handler]=Q},get row(){return o()},set row(Q){o(Q)}})},T=k=>{var Q=Ae(),A=ye(Q);{var _=U=>{$ie(U,{onchange:z=>{c[o().handler]=z},get row(){return o()},set row(z){o(z)}})},N=U=>{var z=Ae(),K=ye(z);{var re=V=>{Uie(V,{onchange:he=>{c[o().handler]=he},get row(){return o()},set row(he){o(he)}})},ge=V=>{var he=Ae(),ae=ye(he);{var E=I=>{cse(I,{onchange:Z=>{c[o().handler]=Z},get row(){return o()},set row(Z){o(Z)}})},L=I=>{var Z=Ae(),ee=ye(Z);{var ne=fe=>{Kie(fe,{onchange:pe=>{c[o().handler]=pe},get row(){return o()},set row(pe){o(pe)}})},de=fe=>{var pe=Ae(),Me=ye(pe);{var q=Ve=>{Sie(Ve,{onchange:Te=>{c[o().handler]=Te},get row(){return o()},set row(Te){o(Te)}})},He=Ve=>{var Te=Ae(),Ne=ye(Te);{var ve=bt=>{Sse(bt,{onchange:Bt=>{c[o().handler]=Bt},get row(){return o()},set row(Bt){o(Bt)}})},ct=bt=>{var Bt=Ae(),er=ye(Bt);{var Qe=De=>{dse(De,{onchange:ke=>{c[o().handler]=ke},get row(){return o()},set row(ke){o(ke)}})},Xe=De=>{var ke=Ae(),Ee=ye(ke);{var Ft=Vt=>{bse(Vt,{onchange:Ke=>{c[o().handler]=Ke},get row(){return o()},set row(Ke){o(Ke)}})},xr=Vt=>{var Ke=Use();W(Vt,Ke)};se(Ee,Vt=>{o()&&o().handler=="MONGODB"?Vt(Ft):Vt(xr,!1)},!0)}W(De,ke)};se(er,De=>{o()&&o().handler=="TEXT"?De(Qe):De(Xe,!1)},!0)}W(bt,Bt)};se(Ne,bt=>{o()&&o().handler=="FUNCTION"?bt(ve):bt(ct,!1)},!0)}W(Ve,Te)};se(Me,Ve=>{o()&&o().handler=="FETCH"?Ve(q):Ve(He,!1)},!0)}W(fe,pe)};se(ee,fe=>{o()&&o().handler=="SQL_BULK_I"?fe(ne):fe(de,!1)},!0)}W(I,Z)};se(ae,I=>{o()&&o().handler=="HANA"?I(E):I(L,!1)},!0)}W(V,he)};se(K,V=>{o()&&o().handler=="SQL"?V(re):V(ge,!1)},!0)}W(U,z)};se(A,U=>{o()&&o().handler=="SOAP"?U(_):U(N,!1)},!0)}W(k,Q)};se(b,k=>{o()&&o().handler=="JS"?k(O):k(T,!1)})}P(y),W(S,y)};se(w,S=>{o()&&S(x)})}W(g,v)},i=g=>{var v=Ae(),w=ye(v);{var x=S=>{Qse(S,{get users(){return o().ctrl.users},set users(y){o(o().ctrl.users=y,!0)}})};se(w,S=>{o()&&o().ctrl&&S(x)})}W(g,v)},s=g=>{var v=Ae(),w=ye(v);{var x=S=>{Bse(S,{get log(){return o().ctrl.log},set log(y){o(o().ctrl.log=y,!0)},get row(){return o()},set row(y){o(y)}})};se(w,S=>{o()&&o().ctrl&&S(x)})}W(g,v)};let a=me(e,"showEditor",15,!1),o=me(e,"row",31,()=>Y({})),l=me(e,"app",31,()=>Y({})),f=me(e,"ondata",3,g=>{}),c=[],h=be(!1),u=be(!1),d=be(Y([{label:"Endpoint",isActive:!0,component:t},{label:"Configuration",component:n},{label:"Authorizations",component:i},{label:"Logs",component:s}]));function p(){m();let g={row:Ht(o()),validateResource:C(h),availableURL:C(u)};console.log("ACCEPT => ",g),f()(g)}function m(){o()||o({}),o()&&!o().environment&&o(o().environment="?",!0),o()&&!o().endpoint&&o(o().endpoint="",!0),o()&&!o().method&&o(o().method="",!0),o()&&!o().handler&&o(o().handler="",!0),o()&&o().ctrl==null&&o(o().ctrl={},!0),o()&&o().ctrl.users==null&&o(o().ctrl.users=[],!0),o()&&o().ctrl.log==null&&o(o().ctrl.log={},!0),l()==null&&l({endpoints:[]}),l()&&l().endpoints==null&&l(l().endpoints=[],!0)}It(()=>{m()}),jre(r,{get show(){return a()},set show(g){a(g)},children:(g,v)=>{var w=jse(),x=ye(w);{const y=O=>{Wse(O,{get endpoint(){return o().endpoint},set endpoint(T){o(o().endpoint=T,!0)},get environment(){return o().environment},set environment(T){o(o().environment=T,!0)},get method(){return o().method},set method(T){o(o().method=T,!0)},get handler(){return o().handler},set handler(T){o(o().handler=T,!0)}})},b=O=>{var T=qse(),k=R(T),Q=R(k);Q.__click=()=>{if(!C(h))alert("URL is invalid.");else if(!C(u))alert("URL already exists.");else{let N=c[o().handler];N&&(o(o().data_test=N.data_test,!0),o(o().code=N.code,!0)),p(),a(!1)}},P(k);var A=te(k,2),_=R(A);_.__click=[Vse,o,a],P(A),P(T),W(O,T)};Nl(x,{left:[y],right:[b],endpoint_path:y,r01:b,$$slots:{endpoint_path:!0,r01:!0}})}var S=te(x,2);Mn(S,{onselect:()=>{m()},get tabs(){return C(d)},set tabs(y){H(d,Y(y))}}),W(g,w)},$$slots:{default:!0}}),xt()}Or(["click"]);var Gse=J('<textarea class="textarea is-small" placeholder="Description"></textarea>'),Hse=(r,e)=>{e()},Yse=J('<span><button class="button is-small"><span class="icon is-small"><i class="fa-solid fa-eraser"></i></span> <span>Cache</span></button></span>'),Kse=J("<div><!></div>"),Jse=(r,e,t)=>{H(e,Y({app:"",idapp:null})),H(t,Y([]))},eae=J('<button class="button is-small is-primary is-outlined"><span class="icon is-small"><i class="fab fa-github"></i></span> <span>New App</span></button>'),tae=J('<input class="input is-small" type="text" placeholder="Application name">'),rae=J('<div class="field has-addons"><p class="control"><a class="button is-static is-small">Application</a></p> <p class="control"><!></p></div>'),nae=(r,e)=>{C(e).enabled=!C(e).enabled},iae=J('<input type="button">'),sae=J('<div class="field has-addons"><p class="control"><a class="button is-static is-small">Enabled</a></p> <p class="control"><!></p></div>'),aae=J('<button class="button is-small is-link is-outlined"><span class="icon is-small"><i class="fab fa-github"></i></span> <span>Save & Deploy</span></button>'),oae=J('<button class="button is-small"><span class="icon is-small"><i class="fa-solid fa-file-export"></i></span> <span>Download</span></button>'),lae=J('<div class="field has-addons"><p class="control file"><input class="input is-small" type="file" accept=".json"></p> <p class="control"><button class="button is-small"><span class="icon is-small"><i class="fas fa-align-left"></i></span> <span>Upload</span></button></p></div>'),fae=J("<div><!> <!></div>"),cae=J("<!> <!> <!>",1);function Poe(r,e){Ot(e,!0);const t=d3(),n=()=>p3(md,"$userStore",t),i=E=>{var L=Gse();x0(L),Xt(L,()=>C(y).description,I=>C(y).description=I),W(E,L)},s=E=>{oa(E,{isReadOnly:!1,onchanged:L=>{f=L}})},a=E=>{var L=Kse(),I=R(L);{const Z=ne=>{Lt();var de=ms("Endpoints");W(ne,de)},ee=ne=>{var de=Yse(),fe=R(de);fe.__click=[Hse,k],P(de),W(ne,de)};R2(Th(I,{ShowNewButton:"true",ShowEditButton:"true",ShowDeleteButton:"true",left_items:[Z],right_items:[ee],ondeleterow:ne=>{confirm("Do you want to delete the endpoints selected?")&&H(h,Y(C(h).filter(de=>!ne.rows.some(fe=>fe.idendpoint==de.idendpoint))))},onnewrow:()=>{C(y)&&C(y).idapp&&C(y).idapp.length>0?(H(p,Y(rp())),H(d,!0)):alert("No App selected")},oneditrow:ne=>{H(p,Y(rp(ne))),H(d,!0)},get RawDataTable(){return C(h)},set RawDataTable(ne){H(h,Y(ne))},get columns(){return C(w)},set columns(ne){H(w,Y(ne))},get SelectionType(){return C(m)},set SelectionType(ne){H(m,Y(ne))},lt01:Z,rt1:ee,$$slots:{lt01:!0,rt1:!0}}),ne=>H(g,Y(ne)),()=>C(g))}P(L),W(E,L)};let o=0,l,f,c,h=be(Y([])),u=[],d=be(!1),p=be(Y(rp())),m=be(0),g=be(void 0),v=be(0),w=be(Y({enabled:{label:"Enabled",decorator:{component:bc,props:{custom:{ontrue:{label:"Enabled"},onfalse:{label:"Unabled"},editInline:!0}}}},endpoint:{label:"Endpoint",decorator:{component:Jne}},method:{decorator:{component:Qne},label:"Method"},handler:{decorator:{component:Lne},label:"Handler"},access:{label:"Access",decorator:{component:Mne}},cache_time:{label:"Cache Time",decorator:{component:iie}},ctrl:{hidden:!0,label:"Users"},resource:{hidden:!0},code:{label:"Code",hidden:!0},idapp:{hidden:!0},rowkey:{decorator:{component:Gne},label:"Status Code"},app:{hidden:!0},namespace:{hidden:!0},name:{hidden:!0},version:{hidden:!0},description:{hidden:!0},vars:{hidden:!0},idendpoint:{hidden:!0},cors:{hidden:!0},headers_test:{hidden:!0},data_test:{hidden:!0},latest_updater:{hidden:!0},environment:{hidden:!0},cache_size:{hidden:!0}})),x=be(Y([{label:"Endpoints",classIcon:"fa-solid fa-rectangle-list",component:a},{label:"Description",classIcon:"fa-solid fa-file-lines",slot:"description",isActive:!1,component:i},{label:"Application variables",classIcon:"fa-solid fa-box-archive",slot:"vars",isActive:!1,component:s},{label:"Application parameters",classIcon:"fa-regular fa-rectangle-list",slot:"parameters",isActive:!1}])),S=be(Y([])),y=be(Y(wv())),b=new es;function O(){window.location.reload()}async function T(){try{let L=await(await b.GET({url:vn.listEnv})).json();L&&Array.isArray(L)&&L.length>0?u=L.map(I=>({id:I.id,value:I.text})):u=[]}catch(E){alert(E.message)}}async function k(){let E=C(g).GetSelectedRows().map(L=>`${L.endpoint}|${L.method}`);try{if(E&&Array.isArray(E)&&E.length>0){let I=await(await b.POST({url:vn.clearCache,data:E})).json();alert("Cache deleted")}else alert("You must select at least one record."),H(m,2)}catch(L){alert(L.message)}}async function Q(){try{let L=await(await b.GET({url:vn.listApps})).json();L&&Array.isArray(L)&&L.length>0?H(S,Y(L.map(I=>({name:I.app,value:I.idapp})))):H(S,Y([]))}catch(E){alert(E.message)}}function A(E){if(E&&E.length>0){if(H(v,0),H(y,Y(wv(E[0]))),console.log(E[0],C(y)),C(y)&&C(y).vars&&typeof C(y).vars=="object")hl.set(C(y).vars);else if(C(y)&&C(y).vars&&typeof C(y).vars=="string")try{hl.set(JSON.parse(C(y).vars))}catch(L){console.error(L),hl.set({})}else hl.set({});P3(n().token,C(y).app,C(y).environment),C(y).endpoints&&(H(h,Y(C(y).endpoints.map(L=>({endpoint:`${L.method=="WS"?"/ws/":"/api/"}${C(y).app}${L.resource}/${L.environment}`,...L})))),H(h,Y(C(h))))}}async function _(){if(f=void 0,console.log("getapp",o,C(y)),o)try{await E3();let L=await(await b.GET({url:vn.getApp,data:{idapp:o,raw:!1}})).json();A(L)}catch(E){console.error(E),alert(E.message)}}md.subscribe(E=>{b.setBearerAuthorization(E.token)});function N(){let E={...C(y)};return E.endpoints=C(h),console.log("appToStore >>>> ",Ht(E)),Ht(E)}async function U(){var E,L;try{let I=await b.POST({url:vn.saveApp,data:N()});if(I.status==200){let Z=await I.json();o=(E=Z==null?void 0:Z.app)==null?void 0:E.idapp,o?(alert(((L=Z==null?void 0:Z.app)==null?void 0:L.app)+" saved successfully."),_()):alert("Could not get idapp."),await Q()}else I.status==401?(alert("The session has expired."),O()):alert("Error: "+I.status)}catch(I){alert(I.message)}}function z(){return!(c&&c.app&&c.app==C(y).app)}It(async()=>{await Q(),await T(),l=setInterval(async()=>{var E;(E=C(y))!=null&&E.app&&(await $3(C(y).app,n().token),await N3(C(y).app,n().token))},5e3)}),ea(()=>{clearInterval(l)});var K=cae(),re=ye(K);{const E=I=>{var Z=Ae(),ee=ye(Z);{var ne=de=>{var fe=eae();fe.__click=[Jse,y,h],W(de,fe)};se(ee,de=>{n()&&de(ne)})}W(I,Z)},L=I=>{cC(I,{label:"Application: ",classLabel:"is-small",classInput:"is-small",onselect:Z=>{console.log("PredictiveInput =>> ",n(),Z),n()?(o=Z.value,_()):alert("You do not have authorization")},get options(){return C(S)},set options(Z){H(S,Y(Z))}})};Nl(re,{right:[L,E],r1:E,r2:L,$$slots:{r1:!0,r2:!0}})}var ge=te(re,2);{var V=E=>{var L=fae(),I=R(L);{const ee=Me=>{var q=rae(),He=te(R(q),2),Ve=R(He);{var Te=Ne=>{var ve=tae();Et(ve),Xt(ve,()=>C(y).app,ct=>C(y).app=ct),W(Ne,ve)};se(Ve,Ne=>{C(y)&&Ne(Te)})}P(He),P(q),W(Me,q)},ne=Me=>{var q=sae(),He=te(R(q),2),Ve=R(He);{var Te=Ne=>{var ve=iae();Et(ve),ve.__click=[nae,y],Re(()=>ft(ve,oi(C(y).enabled?"button is-success is-selected is-small":"button is-danger is-small"))),Xt(ve,()=>C(y).enabled,ct=>C(y).enabled=ct),W(Ne,ve)};se(Ve,Ne=>{C(y)&&Ne(Te)})}P(He),P(q),W(Me,q)},de=Me=>{var q=Ae(),He=ye(q);{var Ve=Te=>{var Ne=aae();Ne.__click=()=>{confirm("Do you want to save the application data?")&&(f&&(C(y).vars=f),U())},W(Te,Ne)};se(He,Te=>{n()&&Te(Ve)})}W(Me,q)},fe=Me=>{var q=Ae(),He=ye(q);{var Ve=Te=>{var Ne=oae();Ne.__click=()=>{const ve=new Date,ct=ve.getFullYear(),bt=String(ve.getMonth()+1).padStart(2,"0"),Bt=String(ve.getDate()).padStart(2,"0"),er=String(ve.getHours()).padStart(2,"0"),Qe=String(ve.getMinutes()).padStart(2,"0"),Xe=JSON.stringify(N(),null,2),De=new Blob([Xe],{type:"application/json"}),ke=window.URL.createObjectURL(De),Ee=document.createElement("a");Ee.href=ke,Ee.download=`app_${C(y).app}_${ct}${bt}${Bt}_${er}${Qe}.json`,Ee.click(),window.URL.revokeObjectURL(ke)},W(Te,Ne)};se(He,Te=>{n()&&Te(Ve)})}W(Me,q)},pe=Me=>{var q=Ae(),He=ye(q);{var Ve=Te=>{var Ne=lae(),ve=R(Ne),ct=R(ve);ct.__change=er=>{const Qe=er.target.files[0];if(!Qe){alert("Por favor, selecciona un archivo JSON vlido.");return}const Xe=new FileReader;Xe.onload=function(De){const ke=De.target.result;try{c=JSON.parse(ke),z()&&alert("The file does not correspond to the same application.")}catch(Ee){console.error("Error al analizar el archivo JSON:",Ee)}},Xe.readAsText(Qe)},P(ve);var bt=te(ve,2),Bt=R(bt);Bt.__click=()=>{if(z())alert("The file does not correspond to the same application.");else if(c){if(confirm("Are you sure to merge the file with your data?")&&c.endpoints&&Array.isArray(c.endpoints)){c.endpoints=c.endpoints.map(Qe=>{let Xe=C(y).endpoints.find(De=>De.environment==Qe.environment&&De.method==Qe.method&&De.resource==Qe.resource);return Xe&&(Qe.idendpoint=Xe.idendpoint),Qe});const er=C(y).endpoints.filter(Qe=>!c.endpoints.some(Xe=>Qe.idendpoint===Xe.idendpoint));c.endpoints=c.endpoints.concat(er),A([c]),c=null}}else alert("Please new select file!")},P(bt),P(Ne),W(Te,Ne)};se(He,Te=>{n()&&Te(Ve)})}W(Me,q)};Nl(I,{left:[ee,ne],right:[pe,fe,de],l01:ee,l02:ne,r01:de,r02:fe,r03:pe,$$slots:{l01:!0,l02:!0,r01:!0,r02:!0,r03:!0}})}var Z=te(I,2);Mn(Z,{get tabs(){return C(x)},set tabs(ee){H(x,Y(ee))},get active(){return C(v)},set active(ee){H(v,Y(ee))}}),P(L),W(E,L)};se(ge,E=>{n()&&E(V)})}var he=te(ge,2);{var ae=E=>{zse(E,{ondata:L=>{let I=L.row;if(I.idendpoint&&I.idendpoint.length>10){let Z=C(h).findIndex(ee=>ee.idendpoint==I.idendpoint);Z>=0&&(C(h)[Z]={...I})}else{let Z=C(h).findIndex(ee=>ee.endpoint==I.endpoint);Z>=0?C(h)[Z]={...I}:C(h).unshift({idapp:C(y).idapp,idendpoint:void 0,endpoint:I.endpoint,resource:I.resource,enabled:I.enabled,access:I.access,environment:I.environment,resource:I.resource,method:I.method,handler:I.handler,cors:I.cors,code:I.code,description:I.description,headers_test:I.headers_test,data_test:I.data_test,rowkey:0,latest_updater:n().iduser,cache_time:I.cache_time}),H(h,Y([...C(h)])),console.log("Con nuevo endpoint:::::> ",C(h))}},get showEditor(){return C(d)},set showEditor(L){H(d,Y(L))},get row(){return C(p)},set row(L){H(p,Y(L))},get app(){return C(y)},set app(L){H(y,Y(L))}})};se(he,E=>{C(y)&&E(ae)})}W(r,K),xt()}Or(["click","change"]);export{Poe as A,vae as L,Ra as s};
